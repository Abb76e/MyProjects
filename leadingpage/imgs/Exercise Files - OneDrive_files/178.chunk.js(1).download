/*! For license information please see 178.chunk.js.LICENSE.txt */
(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["178","51","60","344","367","374","423"],Array(527).concat([function(e,t,n){"use strict";n.r(t);n.d(t,"getLocaleNumberString",function(){return s});var r=n(425),i=n(22);n.d(t,"format",function(){return i.format});n.d(t,"formatToArray",function(){return i.formatToArray});n.d(t,"doesStringEndWith",function(){return i.doesStringEndWith});n.d(t,"doesStringStartWith",function(){return i.doesStringStartWith});n.d(t,"rightPad",function(){return i.rightPad});n.d(t,"leftPad",function(){return i.leftPad});n.d(t,"findOneOf",function(){return i.findOneOf});n.d(t,"equalsCaseInsensitive",function(){return i.equalsCaseInsensitive});n.d(t,"capitalize",function(){return i.capitalize});n.d(t,"decapitalize",function(){return i.decapitalize});n.d(t,"pluralSelect",function(){return i.pluralSelect});n.d(t,"getLocalizedCountValue",function(){return i.getLocalizedCountValue});n.d(t,"formatWithLocalizedCountValue",function(){return i.formatWithLocalizedCountValue});n.d(t,"repeat",function(){return i.repeat});n.d(t,"padData",function(){return i.padData});function s(e,t,n){var i=n,s=r.e.language;if(e)try{i=e.toLocaleString(s,t)}catch(n){i=e.toLocaleString([],t)}return i}}],Array(468),[function(e,t,n){"use strict";n.d(t,"r",function(){return x});n.d(t,"t",function(){return T});n.d(t,"i",function(){return N});n.d(t,"s",function(){return k});n.d(t,"e",function(){return L});n.d(t,"n",function(){return A});n.d(t,"o",function(){return O});var r,i,s,o,u,a,f,l,c,h,p=n(0),d=n(536),v=n(1909),m=n(425),g=n(22),y=n(249),b=n(300),w=n(257),E=void 0,S={ODB:1469,ODC:"ChromiumDateFix"};function x(e,t){void 0===t&&(t=!1);return b.n(e,M(m.e.language),t)}function T(e,t,n,r,i,s){void 0===t&&(t=!1);void 0===n&&(n=!1);void 0===r&&(r=!1);var o=Date.now()-e.getTime(),u=(function(){var e=new Date;e.setHours(0,0,0,0);return e})(),a=H(u,-1),f=H(u,-6),l=i||{},c=l.displayMinutesToOneHour,h=void 0===c||c,p=l.displayHoursToOneDay,g=void 0===p||p,y=l.displayHoursInDates,E=void 0===y||y,S=l.displayShortenedWeekday,x=void 0===S||S,T=M(s||m.e.language);if(h&&o<-5*w.n)return e.toLocaleDateString(T,j({month:"short",day:"numeric"},r));if(o<w.o)return n?v.n:v.t;if(h&&o<w.t)return B(o,v.i,w.n);if(w.l(u,e))return g?B(o,v.r,w.t):b.t("Today",n);if(e>=a)return t||!E?b.t("Yesterday",n):b.t("YesterdayAndTime",n).replace("{0}",e.toLocaleTimeString(T,j({hour:"numeric",minute:"2-digit"},r)));if(e>=f){var N=e.toLocaleDateString(T,j({weekday:"short"},r));return t?N:x||E?d.RelativeDateTime_DayAndTime.replace("{0}",N).replace("{1}",e.toLocaleTimeString(T,j({hour:"numeric",minute:"2-digit"},r))):e.toLocaleDateString(T,j({weekday:"long"},r))}return w.c(u,e)?T.match(/(^ja$)|(^ja-{1})/i)?e.toLocaleDateString(T,j({month:"long",day:"numeric"},r)):e.toLocaleDateString(T,j({month:"short",day:"numeric"},r)):e.toLocaleDateString(T,j({month:"short",day:"numeric",year:"numeric"},r))}function N(e){return b.r(e,M(m.e.language))}function C(){var e=r(),t=_();if(window.Intl&&window.Intl.DateTimeFormat){var n={},i={hour:"2-digit",minute:"2-digit"};s=new Intl.DateTimeFormat(e,n);o=new Intl.DateTimeFormat(e,i);if(t){n.timeZone="UTC";i.timeZone="UTC"}u=new Intl.DateTimeFormat(e,n);a=new Intl.DateTimeFormat(e,i);f=s.format;l=o.format;c=u.format;h=a.format}else{f=c=function(t){return t.toLocaleDateString(e)};l=h=function(t){return t.toLocaleTimeString(e)}}}function k(e,t){if(!e)return"";f||C();var n=w.l(new Date,e);return(t?n?h:c:n?l:f)(e)}function L(e,t){if(!e)return"";f||C();return(t?c:f)(e).replace(/[:\/\\]/g,"-")}function A(e,t){f||C();var n=t?c(e):f(e),r=t?h(e):l(e);return Object(g.format)(v.e,n,r)}function O(e,t){return w.p(e,M(m.e.language),t)}function M(e){if(void 0===E)try{E=y.e.isFeatureEnabled(S)}catch(e){E=!1}return E&&(function(e){void 0===P&&(function(){P={};var e=new Date(1900,0,1);try{for(var t={month:"long"},n=0,r=D;n<r.length;n++){var i=r[n];e.toLocaleDateString(i,t).match("M[0-9][0-9]")&&(P[i]=!0)}}catch(e){}})();if(e){e=e.toLowerCase();return P[e]}return})(e)?"en":e}r=function(){for(var e,t=0,n=[window.$Config&&window.$Config.mkt,m.e.language,navigator.language,"en"].filter(function(e){return!!e});t<n.length;t++){var i=n[t];try{(new Date).toLocaleDateString(i);e=i;break}catch(e){}}e=M(e);r=function(){return e};return e};function _(){if(void 0===i)try{var e=r();(new Date).toLocaleDateString(e,{timeZone:"UTC"});i=!0}catch(e){i=!1}return i}var D=["eu-es","af-za","az-latn-az","bs-latn-ba","cy-gb","ga-ie","gl-es","ha-latn-ng","hy-am","ig-ng","is-is","ka-ge","kk-kz","km-kh","ky-kg","mk-mk","mn-mn","mt-mt","ne-np","nn-no","or-in","pa-in","si-lk","sq-al","ur-pk","uz-latn-uz","yo-ng","zu-za","pa-arab-pk","ku-arab-iq","be-by","rw-rw","ti-et","tg-cyrl-tj","eu","af","az","bs","cy","ga","gl","ha","hy","ig","is","ka","kk","km","ky","mk","mn","mt","ne","nn","or","pa","si","sq","ur","uz","yo","zu","pa","ku","be","rw","ti"],P=void 0;function H(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function B(e,t,n){var r=Math.round(e/n);return t.replace("{0}",String(r))}function j(e,t){return _()&&t&&e?Object(p.__assign)(Object(p.__assign)({},e),{timeZone:"UTC"}):e}}],Array(502),[function(e,t,n){"use strict";n.r(t);n.d(t,"encodeItemSetParentKeyKey",function(){return L});n.d(t,"resourceKey",function(){return O});var r=n(0),i=(n(1681),n(1649)),s=n(1733),o=n(1698),u=n(1669),a=n(52),f=n(391),l=n(76),c=n(616),h=n(1686),p=n(1754),d=n(1692),v=n(1800),m=n(1901);function g(e,t){for(var n=t.start,r=Math.min(t.end,e.length),i=n;i<r;i++)if(!e[i])return!1;return!0}var y=n(1353),b=n(7),w=n(11),E=n(1690),S=n(197),x=n(1890),T=n("knockout-lib"),N=n(46),C=(function(){function e(e,t,n,r){this._context=e;this._store=t;this._isTokenBaseApi=n;this._tokenBasedExtraItemCount=r}e.prototype.initialize=function(e,t){this._skipDataFetch=!1;if(!this._context.group&&this._context.noIndexBasedDataFetch){var n=e&&e.content.peek().groupings,r=n&&n.length&&n[0].itemGroups;this._context.group=this._getGroupStartingOnIndex(t,r)}e&&e.isExpired&&(this._context.group=null);this._isExpandingGroup=this._context.noIndexBasedDataFetch&&this._context.group&&"__next__"!==this._context.group.groupingId&&!this._context.groupReplace;this._isFetchingNextGroup=this._context.group&&this._isTokenBaseApi&&"__next__"===this._context.group.groupingId;var i=e&&e.content.peek().groupings;this._isAllCollapsedQuery=i&&i.length>0&&i[0].isAllCollapsed&&i[0].isAllCollapsed.peek()&&!this._isExpandingGroup};e.prototype.isResultSetValid=function(e,t){var n=this._skipDataFetch;n||(n=this._isAllCollapsedQuery?!this._isExpandingGroup&&!this._context.requestToken:(this._isTokenBaseApi||!this._context.skipInMemoryCache)&&g(e,t)&&!(this._isFetchingNextGroup&&this._context.endIndex>e.length));return n};e.prototype.computeNewChildren=function(e,t,n,r,i){var s,o=!1;this._context.groupReplace&&(this._isFetchingNextGroup=!!e.nextRequestToken);s=i&&!n.isExpired?n.content.peek().items:[];if(e.nextRequestToken){!t.requestToken&&s.length>e.totalChildren&&(s[e.totalChildren]=null);e.totalChildren+=this._tokenBasedExtraItemCount;this._store.setNextRequestToken(t.parentKey,r,e.nextRequestToken);o=!0;n&&(n.isTokenBasedApi=o)}else this._store.setNextRequestToken(t.parentKey,r,"end");if(t.requestToken){t.startIndex=s.length-this._tokenBasedExtraItemCount;e.totalChildren+=s.length-this._tokenBasedExtraItemCount}if(this._isFetchingNextGroup||this._isAllCollapsedQuery){var u=e.children.length,a=e.startIndex+u;e.nextRequestToken&&(a+=this._tokenBasedExtraItemCount);e.totalChildren=Math.max(e.totalChildren,Math.max(s.length,a))}if(e.item&&e.totalChildren>=0){this._isExpandingGroup||(s.length>0&&0===e.totalChildren?s=[]:s.length=e.totalChildren);var f=void 0;f=t.groupReplace?t.startIndex:void 0!==e.startIndex?e.startIndex:this._isExpandingGroup?t.group.startIndex:t.startIndex;for(var l=0,c=0;l<s.length;l++)if(l>=f&&c<e.children.length){s[l]=this._store.getItem(e.children[c].key);if(Object(N.isFeatureEnabled)(N.SupportMountPointInMoveCopyPanel)&&(t.remoteItem||t.isMountPointFolder)){s[l].peek().isMountPointFolder=!0;s[l].peek().remoteWebUrl=t.isMountPointFolder?t.remoteWebUrl:t.remoteItem.SiteUrl}c++}}return{allChildren:s,hasNextRequestToken:o}};e.prototype.computeNewGroupings=function(e,t,n,r,i){var s=this._isExpandingGroup?r.group:null,o=r.itemsPerGroup,u=e&&e.length>0?e[0].itemGroups:null,a=null;u&&u.length>0&&u[u.length-1].isPlaceholder&&(a=u.pop());var f=this._mergeGroupings(e,t,i,n);if(s&&f){f[0].isAllCollapsed(!1);s.state({isCollapsed:!1})}if(n&&n.length>0&&!n[n.length-1]&&(u=f&&f.length>0?f[0].itemGroups:null)&&u.length>0){var l=u[u.length-1];this._context.groupReplace&&this._isFetchingNextGroup&&(l.hasMoreData=!0);var c=n[l.startIndex+(-1!==o?Math.min(l.count,o):l.count)-1]&&!(this._context.groupReplace&&l.count<o),h=f[0].isAllCollapsed.peek();if(c||this._isFetchingNextGroup||h){var p=l.startIndex+l.count;a?a.startIndex=p:a={groupingId:"__next__",startIndex:p,count:1,isPlaceholder:!0,state:T.observable({isCollapsed:!1})};n.length<p&&(n.length=p+1);u.push(a)}}return f};e.prototype._mergeGroupings=function(e,t,n,r){var i=e;if(i&&i.length>0){if(t&&t.length>0)for(var s=0;s<t.length;s++){var o=i[s].isAllCollapsed.peek();i[s].itemGroups=n?this._retainItemGroupState(i[s].itemGroups,t[s].itemGroups):this._mergeItemGroups(i[s].itemGroups,t[s].itemGroups,o,null,r)}}else i=t;return i};e.prototype._mergeItemGroups=function(e,t,n,r,i){var s=e;if(e&&e.length>0){if(t&&t.length>0)for(var o=function(e){var t=!1;n&&e.state({isCollapsed:!0});for(var o=function(i){var o=s[i];if(e.groupingId===o.groupingId){if(u._context.noIndexBasedDataFetch||!u._context.isTokenBasedApi){if(u._context.groupReplace){o.count+=e.count;o.hasMoreData&&i<s.length-1&&(o.hasMoreData=!1)}else o.count=e.count;o.children=u._mergeItemGroups(o.children,e.children,n,o);if(0===i)o.startIndex=r?r.startIndex:0;else{var a=s[i-1],f=a.startIndex+a.count-o.startIndex;o.startIndex+=f;o.children&&o.children.forEach(function(e){e.startIndex+=f})}}else{var l=e.startIndex+u._context.startIndex,c=e.startIndex+u._context.startIndex+e.count;o.startIndex=Math.min(o.startIndex,l);o.count=Math.max(c,o.startIndex+o.count)-o.startIndex}t=!0;return"break"}},a=0;a<s.length;a++){if("break"===o(a))break}if(!t){var f=s[s.length-1],l=f.startIndex+f.count-e.startIndex;e.startIndex+=l;e.children&&e.children.forEach(function(e){e.startIndex+=l});var c=Math.min(e.count,30),h=0;if(i)for(var p=e.startIndex;p<e.startIndex+c;p++)i[p]||h++;h&&(e.emptyItemCount=h);s.push(e)}},u=this,a=0,f=t;a<f.length;a++){o(f[a])}}else s=t;return s};e.prototype._retainItemGroupState=function(e,t,n){var r=t;if(t&&t.length>0&&e&&e.length>0){for(var i={},s=0,o=e;s<o.length;s++){var u=o[s];i[u.groupingId]=u}for(var a=0,f=r;a<f.length;a++){var l=f[a],c=i[l.groupingId];if(c){l.state(c.state.peek());l.children=this._retainItemGroupState(c.children,l.children,c)}}}return r};e.prototype._getGroupStartingOnIndex=function(e,t){if(t&&t.length>0)for(var n=0;n<t.length;n++){var r=t[n];if(!(r&&r.startIndex<=e))break;var i=r.startIndex+r.count-1;if(r.children){if(i>=e)return this._getGroupStartingOnIndex(e,r.children)}else{if(r.startIndex===e)return r.state.peek().isCollapsed?null:r;if(i>=e){var s=n<t.length-1?t[n+1]:null;if(s&&!s.state.peek().isCollapsed){this._skipDataFetch=!0;return null}}}}return null};return e})(),k=n(3),L=new b.t({name:"ItemProvider.encodeItemSetParentKey",factory:new b.e(Object(k.Wi)(k.Ci))}),A=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._registeredProjections={};r._pendingGetItemRequests={};r._store=n.itemsStore;r._operationProvider=n.operationProvider;r._schemaDataSource=n.schemaDataSource;r._updateQuota=n.updateQuota;r._groupThrottle=n.groupThrottle;r._encodeItemSetParentKey=n.encodeItemSetParentKey||!1;r._smartFiltersStore=n.smartFiltersStore;return r}t.prototype.getItem=function(e){return this._getItem(e)};t.prototype.getItemSetKey=function(e,t){var n="parentKey="+(this._encodeItemSetParentKey?encodeURIComponent(e.parentKey):e.parentKey);function r(e,t){t&&(n+="&"+e+"="+t)}r("ownerId",e.ownerId);r("groupingType",e.groupingType);n+="&sortField="+(e.sortField||"");n+="&isAscending="+("boolean"==typeof e.isAscending?e.isAscending:"");var i=e.filters;if(i)for(var s in i)n+="&"+s+"="+i[s];r("groupBy",e.groupBy);r("viewId",e.baseViewId);r("viewXml",e.viewXml);r("additionalFiltersXml",e.additionalFiltersXml);var o=!t&&e.itemSetProjections;if(o){var u="";for(var a in o)u+=a+"_"+o[a];n+="&projection="+u}e.supportsNestedGroups&&(n+="&ng=1");return n};t.prototype.getSpecifiedItems=function(e){e&&e.needToClearParentSmartFiltersInfo&&e.parentKey&&this._smartFiltersStore&&this._smartFiltersStore.invalidate(e.parentKey);return this._getItemDataSource().then(function(t){return t.getSpecifiedItems(e)})};t.prototype.getItemSync=function(e){var t=this.getItemSetKey(e),n=e.parentKey,r=this._store.getItem(n),i=this._getItemSet(t,e);if(!r){var s=new o.e(n),u=e.queryType,a=void 0===u?s.queryType:u;s.queryType=a;this._store.setItem(s);r=this._store.getItem(n)}if(!i){var f=r.peek(),l=f&&f.folder,c=l&&l.childCount||0;(i=new m.e(t,e,c)).item=r;var h=e.needSchema;if(void 0===h||h){var p=this._schemaDataSource,d=p&&p.getColumns(f);d&&d.length>0&&i.schema(d)}this._store.setItemSet(t,i)}return i};t.prototype.invalidateItem=function(e,t){var n=void 0===t?{}:t,i=n.triggerFetch,s=void 0!==i&&i,o=n.emptyAllOtherSets,u=void 0!==o&&o,a=n.refreshSchema,f=void 0!==a&&a,l=n.updateGrouping,c=void 0!==l&&l,h=n.purgeCache,p=void 0!==h&&h;u&&this._store.emptyAllOtherSets([e]);if(f){(d=this._store.getItemSetFromItemKey(e))&&d.schema([])}c||this._store.invalidateItem(e,{purgeCache:p});this._smartFiltersStore&&this._smartFiltersStore.invalidate(e);if(s){var d=this._store.getItemSetFromItemKey(e);this._getItem(Object(r.__assign)(Object(r.__assign)({parentKey:e},d&&d.context||{}),{skipCache:!0,updateGrouping:c}))}};t.prototype.removeFromRecent=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromRecent(e)}).then(function(n){n&&t.invalidateItem(e.parentKey);return n})};t.prototype.removeMountPoint=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeMountPoint(e)}).then(function(n){n&&t.invalidateItem(e.parentKey);return n})};t.prototype.createMountPoint=function(e){return this._getItemDataSource().then(function(t){return t.createMountPoint(e)}).then(function(e){return e},function(e){return a.n.wrapError(e)})};t.prototype.createDocument=function(e,t,n,r,i){var s=this;return this._getItemDataSource().then(function(o){return o.createDocument(e,t,n,r).then(function(t){if(i&&o.updateContentType){var n=t.match(/{(.*)}/),r=n&&n[1];return r?o.updateContentType(e,r,i).then(function(){s.invalidateItem(e);s._updateQuota(!0);return t}):t}s.invalidateItem(e);s._updateQuota(!0);return t})})};t.prototype.createCustomDocument=function(e,t,n){var r=this;return this._getItemDataSource().then(function(r){return r.createCustomDocument(e,t,n)}).then(function(t){if(!t)return a.n.wrapError();r.invalidateItem(e);r._updateQuota(!0);return r.getItem({parentKey:e}).then(function(e){return r.peekUnwrapObservable(r._store.getItem(t))})})};t.prototype.updateBundle=function(e,t){var n=this,r=[new E.e(e.item.key,e.item)];t.update(r);return this._getItemDataSource().then(function(t){return t.updateBundle(e)}).then(function(){n.invalidateItem(e.item.parent?e.item.parent.key:e.item.key);r=r.map(function(e){return e.succeed()});t.update(r)},function(i){n.invalidateItem(e.item.parent?e.item.parent.key:e.item.key);var s=new Error(i);r=r.map(function(e){return e.fail(s)});t.update(r);return a.n.wrapError(s)})};t.prototype.removeFromSharedList=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromSharedList(e)}).then(function(n){t.invalidateItem(e.parentKey);return n})};t.prototype.updateViewCount=function(e){return this._getItemDataSource().then(function(t){return t.updateViewCount(e)})};t.prototype.reportAbuse=function(e){var t=new p.e,n=this._operationProvider.register({name:e.item.name||"",type:d.e.reportAbuse,payloads:{reportAbuse:{item:e.item}},iconName:e.item.iconName,batch:t}),r=this._getItemDataSource().then(function(t){return t.reportAbuse(e)});n.state(h.e.started);n.progress.maximum(1);return r.then(function(e){n.state(h.e.completed);n.progress.current(1);return e},function(e){n.state(h.e.failed);n.error(new v.e({message:e}));return a.n.wrapError(e)})};t.prototype.requestReview=function(e){for(var t=this,n=new p.e,r=e.items.map(function(e){var r=t._operationProvider.register({name:e.name||"",type:d.e.requestReview,payloads:{requestReview:{item:e}},iconName:e.iconName,batch:n});r.progress.maximum(1);r.progress.current(0);return r}),i=this._getItemDataSource().then(function(t){return t.requestReview(e)}),s=0,o=r;s<o.length;s++){o[s].state(h.e.started)}return i.then(function(n){for(var i=0,s=r;i<s.length;i++){var o=s[i];o.progress.current(1);o.state(h.e.completed)}var u=e.items[0].parent;u&&t.invalidateItem(u.key);return n},function(e){for(var t=0,n=r;t<n.length;t++){var i=n[t];i.error(new v.e({message:e}));i.state(h.e.failed)}return a.n.wrapError(e)})};t.prototype.saveSortOrder=function(e){return this._getItemDataSource().then(function(t){return t.saveSortOrder(e)}).then(function(e){return e},function(e){})};t.prototype.addCoverPhotos=function(e){return this._updateCoverPhotos(e,d.e.addCoverPhotos,this._addCoverPhotos)};t.prototype.removeCoverPhotos=function(e){return this._updateCoverPhotos(e,d.e.removeCoverPhotos,this._removeCoverPhotos)};t.prototype.changeFolderType=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.changeFolderType(e)}).then(function(n){t.invalidateItem(e.item.key,{triggerFetch:!0});return n})};t.prototype.updateItemProperty=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.updateItemProperty(e)}).then(function(n){t.invalidateItem(e.item.key,{triggerFetch:!0});return n})};t.prototype.getOpenInClientDetails=function(e){return this._getItemDataSource().then(function(t){return t.getOpenInClientDetails(e)}).then(function(e){return e},function(e){})};t.prototype.getWorkProgress=function(e){return this._getItemDataSource().then(function(t){return t.getWorkProgress(e)})};t.prototype.processReferral=function(e,t){return this._getItemDataSource().then(function(n){return n.processReferral(e,t)})};t.prototype.getItemOcrTextContent=function(e){return this._getItemDataSource().then(function(t){return t.getItemOcrTextContent(e)})};t.prototype.updateItemOcrInfo=function(e,t,n){var r=this;return this._getItemDataSource().then(function(r){return r.updateItemOcrInfo(e,t,n)}).then(function(t){r.invalidateItem(e.key,{triggerFetch:!0});return t},function(e){return e})};t.prototype.rotateItems=function(e,t){var n=this,r={},i=e.items.map(function(e){return r[e.key]=new E.e(e.key,e)});t.update(i);return this._getItemDataSource().then(function(t){return t.rotateItems(e)}).then(function(){i=i.map(function(e){return e.succeed()});t.update(i)},function(e){var s=e.data||[];i=[];for(var o=0,u=s;o<u.length;o++){var a=u[o],f=r[a.key];n._store.setItem(f.input);delete r[a.key];i.push(f.fail(a.error))}for(var l in r){f=r[l];delete r[l];i.push(f.succeed())}t.update(i)})};t.prototype.registerProjection=function(e,t){this._registeredProjections[e]=t};t.prototype.computeProjectedItemSet=function(e,t,n,r){var i=n.itemSetProjections,s=r?null:this._store.getItemSet(e),o=!s||s.isPlaceholder||s.isExpired||s.version!==t.version;if(!s||o){if(!s){(s=new m.e(e,n)).item=t.item;s.isTokenBasedApi=t.isTokenBasedApi;s.isPlaceholder=t.isPlaceholder;s.isExpired=t.isExpired;s.version=t.version}for(var u in i){var a=this._registeredProjections[u];a&&a.projectItemSet(s,t,i[u])}r||this._store.setItemSet(e,s)}return s};t.prototype.redeemPermissionToken=function(e){return this._getItemDataSource().then(function(t){return t.redeemPermissionToken(e)})};t.prototype._getItem=function(e){var n,i=this,s=y.e(e),o=this._store;if(e.keyAlias){n=this.getItemSync({parentKey:e.keyAlias}).item;e.parentKey=n.peek().key}else n=this.getItemSync(e).item;var u=e.skipCache,f=void 0!==u&&u,c=this.getItemSetKey(e),h=e.itemSetProjections?this.getItemSetKey(e,!0):c,p=this._getItemSet(c,e),d=p&&p.content.peek().items,v=e.isTokenBasedApi||!!p&&!!p.isTokenBasedApi,b=!f&&n&&!n.peek().revision&&p&&!p.isExpired&&!p.isPlaceholder&&(!e.requestAllChildren||g(d,{start:0,end:d.length})),w=e.startIndex,E=void 0===w?0:w,x=e.pageSize,T=void 0===x?100:x,N=e.endIndex||E+T;N=d&&d.length>0&&!v?Math.min(d.length,N):N;E=Math.max(0,Math.min(N,E));var k=o.getNextRequestToken(h);e.requestToken="end"===k?"":k;var L=new C(e,o,v,t.TOKEN_BASED_API_EXTRA_ITEMS);L.initialize(p,E);var A=!1,O=p&&p.content.peek();if(O&&(1===O.partialResultStatus||2===O.partialResultStatus)){A=!0;1===O.partialResultStatus&&p.content({items:O.items,groupings:O.groupings,partialResultRequestCount:0,partialResultStatus:2})}if(b&&!A&&L.isResultSetValid(d,{start:E,end:N}))return a.n.wrap(p);if(n&&n.peek().isStub){var M=e.startKey;if(M){if(o.getItem(M)){p.content.peek().items=[o.getItem(M)];p.isPlaceholder=!0;p.isExpired=!1;var _=this._schemaDataSource,D=_&&_.getColumns(n.peek());D&&D.length>0&&p.schema(D);p.content.valueHasMutated&&p.content.valueHasMutated()}}return a.n.wrap(p)}var P=p&&!p.isExpired&&p.content.peek().groupings;P&&P.length>0&&(e.isGrouped=!0);this._normalizeContext(e,d,E,N,!b);var H=this._getRequestKey(e),B=this._pendingGetItemRequests[H];if(B)return e.itemSetProjections?B.getPromise().then(function(t){return i.computeProjectedItemSet(c,t,e)}):B.getPromise();v&&!k&&(e.startIndex=0);this._pendingGetItemRequests[H]=B=new S.e;this.resources.consumeAsync(l.y.bypass).then(function(t){return t.getItem(Object(r.__assign)(Object(r.__assign)({},e),{itemSetKey:c}))}).then(function(t){if(s.updateContextBasedOnResult&&e.updateContextBasedOnResult){s.updateContextBasedOnResult(s,t);e.updateContextBasedOnResult(e,t);c=i.getItemSetKey(s)}var r=e.itemSetProjections?i.getItemSetKey(e,!0):c;n=o.getItem(e.parentKey);var u=o.getItemSet(r);b=!(!n||!u);var a=L.computeNewChildren(t,e,u,r,!!b),f=a.allChildren,l=a.hasNextRequestToken;l&&(v=l);if(t.item&&!e.ignoreChildren&&!e.skipStoreResults){if(!b){(u=new m.e(r,e)).item=o.getItem(e.parentKey);u.isTokenBasedApi=v;o.setItemSet(r,u)}var h=!!u.isExpired;u.sortField=t.sortField;u.isAscending=t.isAscending;u.isPlaceholder=!1;u.isExpired=!1;var p=e.needSchema;if(void 0===p||p){var d=t.schema;u.schema(d&&d.length>0&&d||[]);t.customViewRenderer?u.customViewRenderer=i.observables.create(t.customViewRenderer):u.customViewRenderer=i.observables.create(void 0)}var w=t.groupings;v&&e.mergeGroupings&&(w=L.computeNewGroupings(u.content.peek().groupings,t.groupings,f,e,h));t.contentTypes&&u.contentTypes&&u.contentTypes(t.contentTypes);var E=u.content.peek(),S=E.partialResultStatus,x=E.partialResultRequestCount,T=void 0===x?0:x;if(!(w&&w.length&&!!w[0])){if(l&&(t.children&&t.children.length<30||!t.children)){var N=T+1;N<=5?T=N:S=1}else void 0===S||0===S||l?2===S&&t.children&&30===t.children.length&&(S=0):S=3}u.content({items:f,groupings:w,partialResultRequestCount:T,partialResultStatus:S});var C=u.version,k=void 0===C?0:C;u.version=k+1}delete i._pendingGetItemRequests[H];if(e.requestAllChildren&&!g(f,{start:0,end:t.totalChildren})){var A=y.e(e),O=A.startIndex,M=void 0===O?0:O;A.startIndex=M+100;return i._getItem(A)}if(t.isFromBrowserCache){s.skipCache=!0;return i._getItem(s)}e.itemSetProjections&&(u=i.computeProjectedItemSet(c,u,e));return u},function(e){delete i._pendingGetItemRequests[H];return a.n.wrapError(e)}).then(function(e){B.complete(e)},function(t){i._groupThrottle&&!i._groupThrottle()&&t&&t.errorCode===Number(-2147024860)&&!e.noGroupReplace?i._groupThrottle(!0):B.error(t)});return B.getPromise()};t.prototype._normalizeContext=function(e,t,n,r,i){var s=e.pageSize||100;if(!e.avoidSeamSnapping){if(!i&&!(n-n%s==r-r%s)&&t)for(;n<r&&t[n];)n++;e.startIndex=n-n%s}"number"!=typeof e.pageSize&&(e.pageSize=100);for(var o=e.startIndex,u=void 0===o?0:o;r-u>e.pageSize;)e.pageSize+=100};t.prototype._getRequestKey=function(e){var t=this.getItemSetKey(e,!0);e.requestToken?t+=e.requestToken:t+="&startIndex="+e.startIndex;return t+="&pageSize="+e.pageSize};t.prototype._getItemSet=function(e,t){var n=this._store,r=n.getItemSet(e);if(t.itemSetProjections){var i=this.getItemSetKey(t,!0),s=n.getItemSet(i);s&&(r=this.computeProjectedItemSet(e,s,t))}return r};t.prototype._updateCoverPhotos=function(e,t,n){for(var r=this,i=new p.e,s=e.target,o=e.items.map(function(e){var n=r._operationProvider.register({name:e.name||"",type:t,payloads:{coverPhotos:{parent:s,item:e}},iconName:e.iconName,batch:i});n.progress.maximum(1);n.progress.current(0);return n}),u=n.call(this,e),a=0,f=o;a<f.length;a++){f[a].state(h.e.started)}return u.then(function(t){r.invalidateItem(s.key);(null==e?void 0:e.itemsScopeInvalidate)&&r.resources.consumeAsync(l._).then(function(e){e.invalidateItems(null==s?void 0:s.key)});for(var n=0,i=o;n<i.length;n++){var u=i[n];u.progress.current(1);u.state(h.e.completed)}return t},function(){for(var e=0,t=o;e<t.length;e++){t[e].state(h.e.failed)}})};t.prototype._addCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.addCoverPhotos(e)})};t.prototype._removeCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.removeCoverPhotos(e)})};t.prototype._getItemDataSource=function(){return this.resources.consumeAsync(l.H)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{groupThrottle:f.g.optional,schemaDataSource:l.ee.optional,itemsStore:u.t,operationProvider:s.resourceKey,smartFiltersStore:c.e.optional,updateQuota:x.e,encodeItemSetParentKey:L.optional});t.TOKEN_BASED_API_EXTRA_ITEMS=2;return t})(i.n),O=(t.default=A,Object(w.s)("ItemProvider",A))}],Array(159),[function(e,t,n){"use strict";n.d(t,"t",function(){return c});var r=n(0),i=n(1649),s=n(7),o=n(11),u={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},a={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0},f=new s.t({name:"ResponsiveUI.breakpoints",factory:new s.e(a)}),l=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._containerElement=t.containerElement||window;var i=r.observables;r._breakpoints=i.wrap(n.breakpoints);r.events.on(r._containerElement,"resize, orientationchange",r._onContainerResize);r.windowWidth=i.create(0);r.windowHeight=i.create(0);r.formFactorSize=i.pureCompute(r._computeFormFactorSize);r.isHamburgerVisible=i.pureCompute(r._computeIsHamburgerVisible);r.showLabels=i.pureCompute(r._computeShowLabels);r.cssClass=i.pureCompute(r._computeCssClass);r._onContainerResize();return r}t.reduceBreakpoints=function(e,t){return{Small:t,Medium:e.Small,Large:e.Medium,XLarge:e.Large,XXLarge:e.XLarge,XXXLarge:e.XXLarge,XXXXLarge:1/0}};t.determineWindowSize=function(e,t){void 0===t&&(t=a);if(0===e)return"Medium";for(var n in a)if(e<t[n])return n};t.determineCssClass=function(e){return u[e]};t.getScrollbarWidth=function(){var e=document.createElement("div"),t=e.style;t.visibility="hidden";t.width="100px";t.msOverflowStyle="scrollbar";document.body.appendChild(e);var n=e.offsetWidth;t.overflow="scroll";var r=document.createElement("div");r.style.width="100%";e.appendChild(r);var i=r.offsetWidth;e.parentNode.removeChild(e);var s=n-i;this.getScrollbarWidth=function(){return s};return s};t.prototype.compareSize=function(e,t){var n=this._breakpoints();return n[e]-n[t]};t.prototype._onContainerResize=function(e){var t=this._containerElement,n=document.body,r=document.documentElement,i=t.clientWidth||r.clientWidth||t.innerWidth||n.clientWidth,s=t.clientHeight||r.clientHeight||t.innerHeight||n.clientHeight;this.windowWidth(i);this.windowHeight(s)};t.prototype._computeFormFactorSize=function(){var e=this._breakpoints(),n=this.windowWidth();return this._containerElement===window?t.determineWindowSize(n,e):"Medium"};t.prototype._computeCssClass=function(){return t.determineCssClass(this.formFactorSize())};t.prototype._computeShowLabels=function(){return this.compareSize(this.formFactorSize(),"Medium")>0};t.prototype._computeIsHamburgerVisible=function(){return this.windowWidth()<a.Large};t.dependencies={breakpoints:f};t.DEFAULT_BREAKPOINTS=a;t.MAC_SCROLL_BAR_WIDTH=8;return t})(i.n);t.e=l;var c=Object(o.s)("ResponsiveUI",l)},function(e,t,n){"use strict";var r=(function(){function e(){}e.init=function(e,t,n,r,i){t()(e)};return e})();t.e=r},function(e,t,n){"use strict";var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t,n){return e.call(this,t,n)||this}return t})(n(1894).e);t.e=i},function(e,t,n){"use strict";var r=n(0),i=n(1650),s=n(156),o=n(1677),u=n(425),a=n(1710),f={Left:"Right",Right:"Left"},l={Esc:!0},c=(function(e){Object(r.__extends)(t,e);function t(n){var r=e.call(this,n)||this,i=r.valueAccessor();if(i instanceof Array)for(var s=function(e){return function(){return e}},u=function(e){new(r.managed(t))({element:r.element,valueAccessor:s(e),bindingContext:r.bindingContext,allBindingsAccessor:r.allBindingsAccessor})},a=0,f=i;a<f.length;a++){u(f[a])}else{if("object"!=typeof i)throw new Error("KeyboardBinding only accepts an object for input. See documentation.");var l=i.mappings&&i||{mappings:i},c=l.target||r.element,h=l.useCapture,p=void 0!==h&&h;r._options=l;r.events.on(c,"keydown",r._onKeyDown,p);r._isActive=l.isActive||r.observables.create(!1);new(r.managed(o.t))({element:r.element,bindingContext:r.bindingContext,allBindingsAccessor:r.allBindingsAccessor,valueAccessor:function(){return{isActive:r._isActive}}})}return r}t.prototype._onKeyDown=function(e){var t=this._options,n=t.allowInputEvents,r=t.allowButtonEvents,i=t.context,o=void 0===i?this.bindingContext.$data:i,c=t.preventDefault,h=t.eventFilter,p=e.target,d=(function(e){var t;t=(function(e){var t;if(e>=65&&e<=91)t=String.fromCharCode(e);else switch(e){case 8:t="Backspace";break;case 9:t="Tab";break;case 13:t="Enter";break;case 27:t="Esc";break;case 32:t="Space";break;case 37:t="Left";break;case 38:t="Up";break;case 39:t="Right";break;case 40:t="Down";break;case 46:t="Delete";break;case 113:t="F2";break;case 117:t="F6";break;case 191:t="/";break;case 121:t="F10";break;default:t=""}return t})(e.keyCode);e.metaKey&&(t="Meta"+t);e.ctrlKey&&(t="Ctrl"+t);e.altKey&&(t="Alt"+t);e.shiftKey&&(t="Shift"+t);return t})(e),v=!r&&p!==this.element&&a.e(p),m=!l[d]&&!n&&p!==this.element&&a.t(p),g=t.target===document&&!this._isActive.peek(),y=(function(e,t){for(;e!==t&&t;){if(t.hasAttribute("data-suppresskeyboardbinding"))return!0;t=t.parentElement}return!1})(this.element,p);if(v||m||g||y)return!0;var b=(function(e,t){var n=!!e.useRtlMappings&&u.e.isRightToLeft&&f[t]||t;return e.mappings[n]})(t,d);if(b){c&&e.preventDefault&&e.preventDefault();if(h&&!h(d,o,e))return!0;for(var w=0,E=b instanceof Array?b:[b];w<E.length;w++){if(!1===E[w].call(o,o,e)){s.t.stopPropagation(e);return!1}}}return!0};return t})(i.t);t.e=c},,function(e,t,n){"use strict";var r=n(0),i=n(1793),s=n(619),o=n(1649),u=n(76),a=n(52),f=n(71),l=n(44),c=n(23),h=n(48),p=n(218),d=n(888),v=n(53),m=n(2105),g=n(184),y=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="BaseAction";var i=r,s=i.resources,o=i.observables,a=n.urlDataSource,f=void 0===a?s.consume(u.ve.optional):a,l=n.instrumentationProvider,c=void 0===l?s.consume(p.u.optional):l;r._BaseAction_urlDataSource=f;r._BaseAction_instrumentationProvider=c;r.isQosLogged=!0;r.logStartEnd=!1;r.enableCustomerPromiseLogging=!1;r._executingInstanceCount=o.create(0);var h={deferEvaluation:!0};r.isAvailable=o.pureCompute(r._computeIsAvailable,h);r.isToggled=o.pureCompute(r._computeIsToggled,h);r.isExecuting=o.pureCompute(r._computeIsExecuting,h);return r}t.prototype.execute=function(e){var t,n,r=this,i=this.isQosLogged?this.onCreateQosEvent(e):void 0,s=i?this.getEngagement():void 0;try{if(i){this._logEngagementEvent(i.data.extraData,s);this.trackUserAction(this.name)}if(!(t=this.instrumentOnExecutionWithCustomerPromise(this.onExecute(e,i))))throw new Error("Action did not return a promise")}catch(e){f.e.log(e);n=e}if(t){this._executingInstanceCount(this._executingInstanceCount.peek()+1);t.then(function(e){r._executingInstanceCount(r._executingInstanceCount.peek()-1);i&&i.end(e)},function(t){r._executingInstanceCount(r._executingInstanceCount.peek()-1);t&&!a.n.isCanceled(t)&&f.e.log(t);i&&i.end(r.onCreateErrorEventArg(e,t,!1))})}else{i&&i.end(this.onCreateErrorEventArg(e,n,!0));t=a.n.reject(n)}return t};t.prototype.onCreateQosEvent=function(e){var t=this._BaseAction_urlDataSource;return new i.e({name:this.name,pageType:t&&l.e[t.getPageType()]||"",queryType:t&&c.e[t.getQueryType()]||"",logStartEnd:this.logStartEnd})};t.prototype.onCreateErrorEventArg=function(e,t,n){return t&&a.n.isCanceled(t)?{resultType:h.e.ExpectedFailure,resultCode:"Canceled"}:t instanceof v.e?{resultType:t.isExpected?h.e.ExpectedFailure:h.e.Failure,resultCode:t.code,error:t.message,extraData:{CorrelationId:t.correlationId}}:{resultType:h.e.Failure,resultCode:n?"NoPromiseReturned":"PromiseFailed",error:t?""+(t.message||""):void 0}};t.prototype.onExecute=function(e,t){var n={resultType:h.e.Failure};return a.n.resolve(n)};t.prototype.instrumentOnExecutionWithCustomerPromise=function(e){var t=e;if(this.enableCustomerPromiseLogging){var n=this._BaseAction_urlDataSource,i=new m.e({scenario:this.name,extraData:{pageType:n&&l.e[n.getPageType()]||"",queryType:n&&c.e[n.getQueryType()]||""}});t=e.then(function(e){var t=e.resultCode,n=e.resultType,s=e.error,o=e.extraData;i.end({resultType:n,errorCode:t,extraData:Object(r.__assign)(Object(r.__assign)({},o),{error:s})});return e}).catch(function(e){var t;if(a.n.isCanceled(e))t={resultType:h.e.ExpectedFailure,errorCode:"Canceled"};else{var n=Object(g.e)(e),s=n.resultType,o=n.resultCode,u=n.error,f=n.extraData;t={resultType:s,errorCode:o,extraData:Object(r.__assign)(Object(r.__assign)({},f),{error:u})}}i.end(t);throw e})}return t};t.prototype.onIsAvailable=function(){return!0};t.prototype.onIsToggled=function(){return!1};t.prototype.getEngagement=function(){return this.resources.consume(d.e)};t.prototype.trackUserAction=function(e){var t=this._BaseAction_instrumentationProvider;if(t){var n=this.getEngagement();t.userExecuteAction({name:e,engagement:n})}};t.prototype._computeIsAvailable=function(){return!!this.onIsAvailable()};t.prototype._computeIsToggled=function(){return!!this.onIsToggled()};t.prototype._computeIsExecuting=function(){return this._executingInstanceCount()>0};t.prototype._logEngagementEvent=function(e,t){void 0===t&&(t=this.isQosLogged?this.getEngagement():void 0);if(t){var n=this._BaseAction_instrumentationProvider;t.logData({name:this.name,isIntentional:this.isExecutionIntentional,location:"NA",usageType:s.e[s.e.Click],currentPage:n&&n.currentPageName()||"NA",previousPage:n&&n.previousPageName()||"NA",extraData:Object(r.__assign)(Object(r.__assign)({},e||{}),n&&n.getEngagementData()||{})})}};t.dependencies=Object(r.__assign)(Object(r.__assign)({},o.n.dependencies),{urlDataSource:u.ve,instrumentationProvider:p.u.optional});return t})(o.n);t.e=y},function(e,t,n){"use strict";n.d(t,"u",function(){return d});n.d(t,"O",function(){return v});n.d(t,"M",function(){return m});n.d(t,"A",function(){return g});n.d(t,"e",function(){return r});n.d(t,"_",function(){return y});n.d(t,"P",function(){return b});n.d(t,"D",function(){return w});n.d(t,"L",function(){return S});n.d(t,"x",function(){return x});n.d(t,"S",function(){return T});n.d(t,"T",function(){return N});n.d(t,"N",function(){return C});n.d(t,"g",function(){return k});n.d(t,"m",function(){return L});n.d(t,"f",function(){return A});n.d(t,"a",function(){return O});n.d(t,"b",function(){return M});n.d(t,"s",function(){return D});n.d(t,"w",function(){return P});n.d(t,"h",function(){return H});n.d(t,"E",function(){return B});n.d(t,"k",function(){return j});n.d(t,"c",function(){return F});n.d(t,"d",function(){return I});n.d(t,"y",function(){return q});n.d(t,"p",function(){return R});n.d(t,"r",function(){return U});n.d(t,"i",function(){return z});n.d(t,"C",function(){return W});n.d(t,"l",function(){return X});n.d(t,"o",function(){return V});n.d(t,"v",function(){return $});n.d(t,"t",function(){return J});n.d(t,"n",function(){return K});var r,i=n(0),s=n(2429),o=n(2298),u=n(2367),a=n(22),f=n(1654),l=n(1667),c=n(1679),h=n(1771),p=n(1688),d=[f.So,f.kn,f.ko,f.qo,f.Co,f.Ht,f.ys],v=[f.so,f.eo,f.uo,f.ao,f.oo,f.Js,f.ro],m=[f.Ks,f.$s,f.Ys,f.Ws,f.Zs,f.Gs,f.Qs,f.Xs,f.io,f.no,f.to,f.Vs],g=[f.en,f.At,f.bn,f.R,f.En,f.nn,f.tn,f.Y,f.ks,f.fr,f.ar,f.Ve];(function(e){e[e.none=0]="none";e[e.pastDate=1]="pastDate";e[e.adminPolicy=2]="adminPolicy";e[e.overMax=3]="overMax";e[e.adminRequired=4]="adminRequired"})(r||(r={}));function y(e){return E(e,26)}function b(e,t){return E(e,t=t||25)}function w(e,t){return E(e,t=t||20)}function E(e,t){if(!e)return"";var n=t,r=n/2;return e.length<=n?e:e.slice(0,r)+"..."+e.slice(e.length-r)}function S(e){return e.userRole===s.e.none&&0===e.defaultLinkKind}function x(e,t){switch(e){case"anonymous":return t?5:4;case"organization":return t?3:2;case"users":return 6;default:return 1}}function T(e){switch(e){case"anonymous":return o.e.anyone;case"organization":return o.e.organization;case"users":return o.e.specificPeople;default:return o.e.existing}}function N(e){switch(e){case 5:case 4:return"anonymous";case 3:case 2:return"organization";case 6:return"users";default:return"existingAccess"}}function C(e){switch(e){case 1:return"created";case 2:return"updated";default:return"uninitialized"}}function k(e,t,n){var r=t.sharingLinkKind,i=t.audience,s="https://static2.sharepointonline.com/files/fabric/assets/icons/sharing",u=l.f(e)?"directrecipients.svg":"peopleinchat.svg";switch(r){case 2:case 3:return s+"/companyonly.svg";case 4:case 5:return s+"/anyone.svg";case 6:return t.audience===o.e.customLabeledSpecificPeople?n&&n.iconUrl||s+"/"+u:s+"/specificpeople.svg";default:return i===o.e.customLabeledSpecificPeople?n&&n.iconUrl||s+"/"+u:s+"/existingaccess.svg?v2"}}function L(e){if(e.isCreateOnlyLink)return"FileRequest";switch(e.sharingLinkKind){case 2:case 3:return"Work";case 4:case 5:return"Globe";case 6:return e.audience===o.e.anyone?"Globe":e.audience===o.e.organization?"Work":"PeopleAdd";default:return"Link"}}function A(){return{palette:{themePrimary:"#3A96DD",themeLighterAlt:"#eff6fc",themeLighter:"#deecf9",themeLight:"#c7e0f4",themeTertiary:"#71afe5",themeSecondary:"#2b88d8",themeDarkAlt:"#106ebe",themeDark:"#004578",themeDarker:"#34365c",neutralLighterAlt:"#292827",neutralLighter:"#323130",neutralLight:"#3B3A39",neutralQuaternaryAlt:"#484644",neutralQuaternary:"#605E5C",neutralTertiaryAlt:"#484644",neutralTertiary:"#A19F9D",neutralSecondary:"#BEBBB8",neutralPrimaryAlt:"#E1DFDD",neutralPrimary:"#F3F2F1",neutralDark:"#FAF9F8",redDark:"#FF4343",black:"#FFFFFF",white:"#252423",primaryBackground:"#f9f8f7",primaryText:"#252423",bodyBackground:"#252423",bodyText:"#252423",disabledBackground:"#3B3A39",disabledText:"#c8c8c8"}}}function O(e,t,n,r){var i=l.f(e);switch(n&&n.audienceType||i&&"recipient"){case"channel":switch(t){case"edit":return f.zr;case"review":return c.t[r]?f.Wr:f.Xr;default:return f.Vr}case"team":switch(t){case"edit":return f.Gr;case"review":return c.t[r]?f.Yr:f.Zr;default:return f.ei}case"recipient":switch(t){case"edit":return f.Zi;case"review":return c.t[r]?f.es:f.ts;default:return f.ns}default:switch(t){case"edit":return f.$r;case"review":return c.t[r]?f.Jr:f.Kr;default:return f.Qr}}}function M(e,t,n,r,i){var s=e.sharingLinkKind,u=e.audience;if(e.isCreateOnlyLink)return!e.allowsAnonymousAccess&&t?a.format(f.Ot,t):f.Mt;switch(s){case 2:return a.format(f.qe,t);case 3:return a.format(f.je,t);case 4:return f.H;case 5:return f.L;case 1:return u===o.e.customLabeledSpecificPeople?e.isReview?r&&r.entityName?a.format(f.We,r.entityName):O(n,"review",r,i):e.isEdit?r&&r.entityName?a.format(f.ze,r.entityName):O(n,"edit",r):r&&r.entityName?a.format(f.Xe,r.entityName):O(n,"view",r):f.at;case 6:return u===o.e.existing?f.at:u===o.e.anyone?e.blockDownload?e.hasPassword?f.j:f.B:e.hasPassword?e.isReview?c.t[i]?f.M:f._:e.isEdit?f.O:f.D:e.isReview?c.t[i]?f.A:f.P:e.isEdit?f.L:f.H:u===o.e.customLabeledSpecificPeople?e.isReview?r&&r.entityName?a.format(f.We,r.entityName):O(n,"review",r,i):e.isEdit?r&&r.entityName?a.format(f.ze,r.entityName):O(n,"edit",r):r&&r.entityName?a.format(f.Xe,r.entityName):O(n,"view",r):e.audience===o.e.organization?e.blockDownload?a.format(f.Re,t):e.isReview?c.t[i]?a.format(f.Fe,t):a.format(f.Ie,t):e.isEdit?a.format(f.je,t):a.format(f.qe,t):e.blockDownload?f.po:e.isReview?c.t[i]?f.Hi:f.Bi:e.isEdit?f.Pi:f.ji;default:return""}}function _(e){return{principalId:e.id,name:e.primaryText,image:e.imageUrl,isResolved:!0,principalName:e.loginName,userId:e.loginName,email:e.email,job:e.secondaryText,isExternal:e.isExternal,principalType:e.type}}function D(e){return{id:e.principalId,primaryText:e.name,imageUrl:e.image,loginName:e.userId,email:e.email,secondaryText:e.job,isExternal:e.isExternal,type:e.principalType}}function P(e){for(var t=[],n=e.principals,r=e.invitees,i=0,s=n;i<s.length;i++){var o=s[i];t.push(_(o))}for(var u=function(e){0===(!0===e.isExternal?t.filter(function(t){return t.email===e.email}):t.filter(function(t){return t.principalName===e.loginName})).length&&t.push(_(e))},a=0,f=r;a<f.length;a++){u(f[a])}return t}function H(e){if(!e)return 0;var t=0,n=e.length,r=0,i=!1;if(0===e.length)return 0;for(var s="&#160;",o="<br />",u="&quot;&quot;&quot;",a="&amp;",f="&#39;",l="&lt;",c="&gt;",h=" ";r<n;){var p=null,d=e[r];if(" "===d)p=r+1<n&&" "===e[r+1]||i?s:" ";else if("\n"===d){p=o;i=!0}else{'"'===d?p=u:"&"===d?p=a:"'"===d?p=f:"<"===d?p=l:">"===d?p=c:"\r"===d&&(p=h);i=!1}t+=null!==p?p.length:1;r++}return t}function B(e){var t,n;switch(e){case s.e.manageList:case s.e.edit:t="Edit";n=f.ie;break;case s.e.view:t="Uneditable2";n=f.he;break;case s.e.review:t="Feedback";n=f.ae;break;case s.e.owner:t="Signin";n=f.Bt}return{name:t,title:n}}function j(e){return e===s.e.edit||Object(p.u)()&&e===s.e.manageList}function F(e,t){var n;return Object(p.u)()&&l.n(e)&&(null===(n=t)||void 0===n?void 0:n.sharedObjectType)===h.e.list?s.e.manageList:s.e.edit}function I(e,t){var n=r.none,i=t;if(!e||e.getTime()===new Date(0).getTime())return n;var s=new Date;s.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());var o=Math.floor((e.getTime()-s.getTime())/864e5);o<1?n=r.pastDate:o>730?n=r.overMax:o>i&&-1!==i&&(n=r.adminPolicy);return n}function q(e,t){return e===o.e.anyone?t?5:4:e===o.e.organization?t?3:2:e===o.e.specificPeople||e===o.e.existing?1:6}function R(e,t){switch(e){case r.pastDate:return f.Rr;case r.adminPolicy:return a.format(f.T,t);case r.overMax:return a.format(f.wn,730);case r.adminRequired:return f.hs;default:return""}}function U(e){return e.canAddExternalPrincipal||e.canAddInternalPrincipal}function z(e){return!!(e&&e.organizationLinkAbilities&&e.organizationLinkAbilities.canManageReadLink)&&e.organizationLinkAbilities.canManageReadLink.enabled}function W(e,t,n){return l.f(e)||t===u.e.linkSettings&&l.c(e)&&n&&(!!n.entityName||!!n.audienceType)}function X(e){var t=e;if(-1===t)return null;var n=new Date;n.setDate(n.getDate()+t);return n}function V(e,t,n){return Object(i.__awaiter)(this,void 0,void 0,function(){var r,s,o;return Object(i.__generator)(this,function(i){switch(i.label){case 0:r=!1;if(l.s(e))return[3,4];try{t.focus();t.setSelectionRange(0,t.value.length);r=document.execCommand("copy")}catch(e){}if(r||!window.navigator||!window.navigator.clipboard)return[3,4];i.label=1;case 1:i.trys.push([1,3,,4]);return[4,window.navigator.clipboard.writeText(t.value)];case 2:i.sent();r=!0;return[3,4];case 3:i.sent();return[3,4];case 4:try{s=window.external;o=s.CopyToClipboard(n);r=o||void 0===o}catch(e){}return[2,r]}})})}function $(e){switch(e){case"2":case"NotAdult":case"MinorWithParentalConsent":case"MinorWithoutParentalConsent":return!0;case"3":case"Adult":case"MinorNoParentalConsentRequired":default:return!1}}var J=340,K=480},,function(e,t,n){"use strict";n.d(t,"u",function(){return i});n.d(t,"o",function(){return s});n.d(t,"n",function(){return o});n.d(t,"f",function(){return u});n.d(t,"i",function(){return a});n.d(t,"t",function(){return f});n.d(t,"s",function(){return l});n.d(t,"v",function(){return c});n.d(t,"m",function(){return h});n.d(t,"e",function(){return p});n.d(t,"p",function(){return d});n.d(t,"r",function(){return v});n.d(t,"l",function(){return m});n.d(t,"h",function(){return g});n.d(t,"a",function(){return y});n.d(t,"c",function(){return b});n.d(t,"g",function(){return w});n.d(t,"d",function(){return E});var r=n(2090);function i(e){return d(e)||m(e)||v(e)||g(e)||y(e)||(function(e){return e===r.e.officemobileIos||e===r.e.officemobileAndroid})(e)}function s(e){return e===r.e.odb||e===r.e.sharePoint||e===r.e.odc||e===r.e.consumerList}function o(e){return e===r.e.consumerList}function u(e){return e===r.e.outlookWeb||e===r.e.outlookWindows||e===r.e.outlookMac}function a(e){return e===r.e.odIos||e===r.e.wordIos||e===r.e.excelIos||e===r.e.visioIos||e===r.e.onenoteIos||e===r.e.powerpointIos||e===r.e.teamsIos||e===r.e.officemobileIos||e===r.e.listsIos}function f(e){return e===r.e.odAndroid||e===r.e.wordAndroid||e===r.e.excelAndroid||e===r.e.visioAndroid||e===r.e.onenoteAndroid||e===r.e.powerpointAndroid||e===r.e.teamsAndroid||e===r.e.officemobileAndroid}function l(e){return a(e)||f(e)}function c(e){return s(e)||e===r.e.onenoteWeb||e===r.e.outlookWeb||e===r.e.officecom||e===r.e.teams||e===r.e.sample||e===r.e.outlookGroupsWeb||e===r.e.fluid||e===r.e.odcWac||e===r.e.wac||e===r.e.listPart||e===r.e.listsHome||e===r.e.shareDemo||l(e)}function h(e){return s(e)||e===r.e.officecom||e===r.e.wac}function p(e){return l(e)||b(e)}function d(e){return e===r.e.word||e===r.e.wordAndroid||e===r.e.wordIos}function v(e){return e===r.e.excel||e===r.e.excelAndroid||e===r.e.excelIos}function m(e){return e===r.e.powerpoint||e===r.e.powerpointAndroid||e===r.e.powerpointIos}function g(e){return e===r.e.visio||e===r.e.visioIos||e===r.e.visioAndroid}function y(e){return e===r.e.onenote||e===r.e.onenoteWeb||e===r.e.onenoteUWP||e===r.e.onenoteIos||e===r.e.onenoteAndroid}function b(e){return e===r.e.teams||e===r.e.teamsIos||e===r.e.teamsAndroid}function w(e){return e===r.e.odc}function E(e){return e===r.e.word||e===r.e.excel||e===r.e.powerpoint||e===r.e.ngsc||e===r.e.visio}},function(e,t,n){"use strict";n.d(t,"t",function(){return s});var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;!1!==t.valueAccessor()&&n.element.setAttribute("data-is-scrollable","true");return n}return t})(n(1650).t);t.e=i;function s(e){for(var t=e;t&&t!==document.body;){if(t.getAttribute&&"true"===t.getAttribute("data-is-scrollable"))return t;t=t.parentElement}t&&t!==document.body||(t=window);return t}},function(e,t,n){"use strict";n.d(t,"t",function(){return b});var r=n(0),i=n(1698),s=n(103),o=n(1673),u=n(7),a=n(11),f=n(291),l=n(1657),c=n(219),h=n(1849),p=n(998),d=n(46),v=Object(d.isFeatureEnabled)(d.ReadOnlyItemsStore);function m(e){return e&&e.item&&e.item.peek().key}function g(e){e.isExpired=!0;var t=e.content,n=t.peek();n.groupings=null;n.items=[];t.valueHasMutated()}var y=(function(e){Object(r.__extends)(t,e);function t(){var t=e.call(this,"ItemsStore")||this;t._itemSetsKeys={};t._observables=new o.e({owner:t});t._vaultItemsToPurge=[];window.odstore=t;return t}t.prototype.dispose=function(){this._observables.dispose()};t.prototype.setItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this._handleSetItem.apply(this,Object(r.__spreadArrays)([e],t))};t.prototype.getItem=function(e){return this.getValue("item="+e)};t.prototype.setItemSet=function(e,t){var n="result="+e;this.setValue(n,t);this._itemSetsKeys[n]=1};t.prototype.getItemSetFromItemKey=function(e){var t;for(var n in this._itemSetsKeys){var r=(t=this.getValue(n)).content&&t.content.peek(),i=r&&r.items;if(i)for(var s=0,o=i;s<o.length;s++){var u=o[s];if(u&&u.peek().parentKey===e)return t}}};t.prototype.getItemSet=function(e){return this.getValue("result="+e)};t.prototype.getAllItemSetKeys=function(){var e=[];for(var t in this._itemSetsKeys)e.push(t.slice("result=".length));return e};t.prototype.setNextRequestToken=function(e,t,n){var r="token="+t;n?this.setValue(r,n):this.remove(r)};t.prototype.getNextRequestToken=function(e){return this.getValue("token="+e)};t.prototype.invalidateItem=function(e,t){var n=(void 0===t?{}:t).purgeCache,r=void 0!==n&&n;return this._handleItemInvalidation(e,this.getItem(e),r)};t.prototype.invalidateItemSet=function(e){var t=this.getValue("result="+e);t&&g(t)};t.prototype.emptyAllOtherSets=function(e){var t;for(var n in this._itemSetsKeys)(t=this.getValue(n)).item&&(0===e.length||e.indexOf(t.item.peek().key)<0)&&g(t)};t.prototype.invalidateLocation=function(e){var t;for(var n in this._itemSetsKeys){var r=m(t=this.getValue(n));if(r){var i=f.e(r),s=i&&i.locationFilter;s&&s.indexOf(e)>=0&&(t.isExpired=!0)}}};t.prototype.invalidateTag=function(e){var t;for(var n in this._itemSetsKeys){var r=m(t=this.getValue(n));if(r){var i=f.e(r);i&&i.tagFilter===e&&(t.isExpired=!0)}}};t.prototype.invalidateAllPhotos=function(){var e;for(var t in this._itemSetsKeys){var n=(e=this.getValue(t)).item&&e.item.peek();if(n&&n.key&&n.key.indexOf("allmyphotos")>=0){e.isExpired=!0;this._invalidateItem(n)}}};t.prototype.invalidateAllVault=function(){for(var e=0,t=Object(r.__spreadArrays)(this._vaultItemsToPurge);e<t.length;e++){var n=t[e],s=void 0;if(n.vault&&n.vault.root){(s=new i.e(n.key)).name=n.name;s.displayName=n.displayName;s.dateModified=" ";s.folder={};s.vault={isLocked:!0,root:{}}}this._purgeItem(n,s)}this._vaultItemsToPurge=[]};t.prototype._handleItemInvalidation=function(e,t,n){var r=this;if(t){var i=t.peek(),s=!1,o=[];if(i){o.push(i);switch(i.type){case c.e.Folder:case c.e.Media:s=!0}}for(var u in this._itemSetsKeys){var a=this.getValue(u),f=a.item&&a.item.peek(),l=f&&f.key;if(l&&(l===e||s&&l.indexOf("allmyphotos")>-1)){l===e?this.setNextRequestToken(e,a.key,""):o.push(f);a.isExpired=!0}}o.forEach(n?function(e){return r._purgeItem(e)}:function(e){return r._invalidateItem(e)})}};t.prototype._purgeItem=function(e,t){var n=t||new i.e(e.key);this.setItem(n)};t.prototype._invalidateItem=function(e){var t=new i.e(e.key);Object(p.default)(t,e);Object(p.default)(t,{revision:e.revision+1});this.setItem(t)};t.prototype._handleSetItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=[];v&&!Object.isFrozen(e)&&Object.freeze(e);e.vault&&this._vaultItemsToPurge.push(e);for(var s=function(t){var n="item="+t,r=v?"item_write="+t:n,s=o.getValue(n),u=o.getValue(r);if(u)u(e);else{(u=o._observables.create(e)).equalityComparer=l.n;o.setValue(r,u);s=v?o._observables.pureCompute(function(){return u()}):u;o.setValue(n,s)}i.push(s)},o=this,u=0,a=Object(h.e)(Object(r.__spreadArrays)([e.key],t));u<a.length;u++){var f=a[u];s(f)}return i[0]};return t})(s.e),b=new u.t({name:"ItemsStore",factory:new a.i(y)});t.e=y},function(e,t,n){"use strict";n.d(t,"n",function(){return r});n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r,i,s;(function(e){e[e.tiny=0]="tiny";e[e.extraExtraSmall=1]="extraExtraSmall";e[e.extraSmall=2]="extraSmall";e[e.small=3]="small";e[e.regular=4]="regular";e[e.large=5]="large";e[e.extraLarge=6]="extraLarge";e[e.size8=17]="size8";e[e.size10=9]="size10";e[e.size16=8]="size16";e[e.size24=10]="size24";e[e.size28=7]="size28";e[e.size32=11]="size32";e[e.size40=12]="size40";e[e.size48=13]="size48";e[e.size56=16]="size56";e[e.size72=14]="size72";e[e.size100=15]="size100";e[e.size120=18]="size120"})(r||(r={}));(function(e){e[e.none=0]="none";e[e.offline=1]="offline";e[e.online=2]="online";e[e.away=3]="away";e[e.dnd=4]="dnd";e[e.blocked=5]="blocked";e[e.busy=6]="busy"})(i||(i={}));(function(e){e[e.lightBlue=0]="lightBlue";e[e.blue=1]="blue";e[e.darkBlue=2]="darkBlue";e[e.teal=3]="teal";e[e.lightGreen=4]="lightGreen";e[e.green=5]="green";e[e.darkGreen=6]="darkGreen";e[e.lightPink=7]="lightPink";e[e.pink=8]="pink";e[e.magenta=9]="magenta";e[e.purple=10]="purple";e[e.black=11]="black";e[e.orange=12]="orange";e[e.red=13]="red";e[e.darkRed=14]="darkRed";e[e.transparent=15]="transparent";e[e.violet=16]="violet";e[e.lightRed=17]="lightRed";e[e.gold=18]="gold";e[e.burgundy=19]="burgundy";e[e.warmGray=20]="warmGray";e[e.coolGray=21]="coolGray";e[e.gray=22]="gray";e[e.cyan=23]="cyan";e[e.rust=24]="rust"})(s||(s={}))},,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(1669),i=n(11),s=(function(){function e(e,t){this._itemsStore=t.itemsStore}e.prototype.getParent=function(e){if(e){var t=this._itemsStore.getItem(e.key),n=t&&t.peek(),r=n&&(n.parentKey||n.parent&&n.parent.key);return r?this._itemsStore.getItem(r):void 0}};e.prototype.getFacetedAncestorOrSelf=function(e,t,n){void 0===n&&(n="");return this.getAncestorOrSelf(e,function(e){return n?e[t]&&e[t][n]:!!e[t]})};e.prototype.getAncestorOrSelf=function(e,t){for(var n,r=e&&e.key;r;){var i=this._itemsStore.getItem(r),s=i&&i.peek();if(!s)break;if(t(s)){n=i;break}r=s&&(s.parentKey||s.parent&&s.parent.key)}return n};e.dependencies={itemsStore:r.t};return e})(),o=Object(i.s)("ItemParentHelper",s)},,function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(52),s=n(1649),o=n(391),u=n(1785),a=n(11),f=n(1698),l=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=r,s=i.resources,a=i.observables,l=n.getCurrentItem,c=void 0===l?s.consume(o.s.lazy.optional):l,h=n.getItemSetSelectionModel,p=void 0===h?s.consume(o.C.lazy.optional):h,d=n.getSelectionHelper,v=void 0===d?s.consume(u.t.lazy.optional):d,m=t.allowMultiSelect,g=void 0!==m&&m,y=t.canFallback,b=void 0!==y&&y,w=t.ignoreSelection,E=void 0!==w&&w,S=t.overrideItem,x=t.useCurrentSelectionGroup,T=void 0!==x&&x;r._allowMultiSelect=g;r._overrideItem=S;r._ignoreSelection=E;r._useCurrentSelectionGroup=T;r._placeholder=r.observables.create(new f.e);r._getSelectionModel=p;S||(r._selectionHelper=v&&v());b&&c&&(r._fallback=c());r.selection=a.pureCompute(r._computeSelection);r.firstItem=a.pureCompute(r._computeFirstItem);r.currentItem=a.pureCompute(function(){return(c&&c()||r._placeholder)()});return r}t.prototype.filterItems=function(e){var t=this.selection();if(!t.length)return!1;for(var n=this.observables,r=0,i=t;r<i.length;r++){var s=i[r],o=n.unwrap(s);if(!o)return!0;if(!e(o))return!1}return!0};t.prototype.resolveSelection=function(){var e=this;return this._resolveSelection().then(function(t){if(t&&t.length)return t;if(e._fallback){var n=e._fallback.peek();if(n)return[n]}return[]})};t.prototype.resolveFirst=function(){var e=this;return this._resolveSelection().then(function(t){return t&&t.length?t[0]:e._fallback?e._fallback.peek():void 0})};t.prototype.selectItems=function(e){var t=this._getSelectionModel();t&&t.setSelectedKeys(e.map(function(e){return e.key}))};t.prototype.clearSelection=function(){var e=this._getSelectionModel();e&&e.clear()};t.prototype.selectAll=function(){var e=this._getSelectionModel();e&&e.selectAll()};t.prototype._computeSelection=function(){var e=this._getCurrentSelection();return!this._allowMultiSelect&&e.length>1?[]:e||[]};t.prototype._computeFirstItem=function(){var e=this.selection();return e&&e[0]&&e[0]()};t.prototype._getCurrentSelection=function(){if(this._overrideItem)return[this._overrideItem];var e,t=this._getSelectionModel();if(t){if(this._useCurrentSelectionGroup&&t.getSelectionModelGroup()){var n=t.getSelectionModelGroup().currentSelection();n&&(t=n)}e=t.selection()}else e=[];(0===e.length||this._ignoreSelection)&&this._fallback&&(e=[this._fallback]);return e};t.prototype._resolveSelection=function(){var e=this;if(this._overrideItem)return i.n.resolve([this._overrideItem.peek()]);var t=this.observables.ignore(function(){return e._computeSelection()});if(this._ignoreSelection||!t.length)return i.n.resolve([]);var n=this._selectionHelper;return n?n.resolveSelection():i.n.reject(new Error("Unable to resolve selection."))};return t})(s.n),c=Object(a.o)("ItemSelectionHelper",l,Object(r.__assign)(Object(r.__assign)({},s.n.dependencies),{currentItem:o.s.lazy.optional,itemSetSelectionModel:o.C.lazy.optional,selectionHelper:u.t.lazy.optional}))},function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});n.d(t,"r",function(){return u});n.d(t,"i",function(){return a});n.d(t,"n",function(){return f});var r,i,s,o=n(1670);(function(e){e.size8="20px";e.size10="20px";e.size16="16px";e.size24="24px";e.size28="28px";e.size32="32px";e.size40="40px";e.size48="48px";e.size56="56px";e.size72="72px";e.size100="100px";e.size120="120px"})(i||(i={}));(function(e){e.size6="6px";e.size8="8px";e.size12="12px";e.size16="16px";e.size20="20px";e.size28="28px";e.size32="32px";e.border="2px"})(s||(s={}));var u=function(e){return{isSize8:e===o.n.size8,isSize10:e===o.n.size10||e===o.n.tiny,isSize16:e===o.n.size16,isSize24:e===o.n.size24||e===o.n.extraExtraSmall,isSize28:e===o.n.size28||e===o.n.extraSmall,isSize32:e===o.n.size32,isSize40:e===o.n.size40||e===o.n.small,isSize48:e===o.n.size48||e===o.n.regular,isSize56:e===o.n.size56,isSize72:e===o.n.size72||e===o.n.large,isSize100:e===o.n.size100||e===o.n.extraLarge,isSize120:e===o.n.size120}},a=((r={})[o.n.tiny]=10,r[o.n.extraExtraSmall]=24,r[o.n.extraSmall]=28,r[o.n.small]=40,r[o.n.regular]=48,r[o.n.large]=72,r[o.n.extraLarge]=100,r[o.n.size8]=8,r[o.n.size10]=10,r[o.n.size16]=16,r[o.n.size24]=24,r[o.n.size28]=28,r[o.n.size32]=32,r[o.n.size40]=40,r[o.n.size48]=48,r[o.n.size56]=56,r[o.n.size72]=72,r[o.n.size100]=100,r[o.n.size120]=120,r),f=function(e){return{isAvailable:e===o.t.online,isAway:e===o.t.away,isBlocked:e===o.t.blocked,isBusy:e===o.t.busy,isDoNotDisturb:e===o.t.dnd,isOffline:e===o.t.offline}}},,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(1650),s=n(1697),o=n("knockout-lib"),u=n(269),a="InteractionScopeBinding_scope",f=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t)||this;r._parentScope=(function(e){var t,n=e;for(;!(t=o.utils.domData.get(n,a))&&n!==document.body&&Object(u.e)(n);)n=Object(u.e)(n);return n!==document.body&&t||void 0})(r.element);var i=r.valueAccessor(),f=i.isScope,l=void 0!==f&&f,c=i.isRoot,h=void 0!==c&&c;if(l){r._childScopes=o.observableArray();r._hasFocus=o.observable(!1);r._isRoot=h;r._isActive=r.createPureComputed(r._computeIsActive,{deferEvaluation:!0});r._isDescendantActive=r.createPureComputed(r._computeIsDescendantActive,{deferEvaluation:!0});r._scope={isActive:r._isActive,isDescendantActive:r._isDescendantActive,isDescendantOrSelfActive:r.createComputed(r._computeIsDescendantOrSelfActive),register:function(e){return r._registerScope(e)},_owner:r};o.utils.domData.set(r.element,a,r._scope);var p=n.ChildFocusBinding,d=void 0===p?s.e:p;new(r.managed(d))({element:r.element,bindingContext:r.bindingContext,allBindingsAccessor:r.allBindingsAccessor,valueAccessor:function(){return r._hasFocus}});r._parentScope&&r.addDisposable(r._parentScope.register(r._scope))}else if(r._parentScope){r._isActive=r._parentScope.isActive;r._isDescendantActive=r._parentScope.isDescendantActive}else{r._isActive=o.observable(!0);r._isDescendantActive=o.observable(!1)}i.isActive&&r.createComputed(function(){return i.isActive(r._isActive())});i.isDescendantActive&&r.createComputed(function(){return i.isDescendantActive(r._isDescendantActive())});return r}t.prototype._registerScope=function(e){var t=this;this._childScopes.push(e);return{dispose:function(){t._childScopes.remove(e)}}};t.prototype._computeIsDescendantOrSelfActive=function(){var e=this._hasFocus(),t=this._isDescendantActive();return e||t};t.prototype._computeIsActive=function(){var e=this._hasFocus(),t=this._isDescendantActive();return(this._isRoot||e)&&!t};t.prototype._computeIsDescendantActive=function(){for(var e=!1,t=0,n=this._childScopes();t<n.length;t++){n[t].isDescendantOrSelfActive()&&(e=!0)}return e};return t})(i.t);t.t=f},function(e,t,n){"use strict";var r=n(0),i=n(1650),s=n(1711),o=n("knockout-lib"),u=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;new(n.managed(s.e))({element:n.element,bindingContext:n.bindingContext,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return n._onReceiveComponentParentContext.bind(n)}});var r=n._componentParentContent,i=n.valueAccessor(),u=(function(e){return"object"==typeof e})(i)?i:{},a=u.data,f=void 0===a?n.bindingContext.$data:a,l=u.afterRender;o.applyBindingsToNode(n.element,{template:{nodes:r.templateNodes,afterRender:l}},r.bindingContext.extend({$host:f,$hostContext:n.bindingContext}));n.controlsDescendantBindings=!0;return n}t.prototype._onReceiveComponentParentContext=function(e){this._componentParentContent=e};t.supportsVirtualElements=!0;return t})(i.t);t.e=u},function(e,t,n){"use strict";n.d(t,"u",function(){return c});n.d(t,"i",function(){return h});n.d(t,"s",function(){return p});n.d(t,"n",function(){return d});n.d(t,"o",function(){return v});n.d(t,"e",function(){return m});n.d(t,"t",function(){return g});n.d(t,"r",function(){return b});var r,i="ms-word",s="onenote|UsePlain",o="ms-powerpoint",u="ms-excel",a="ms-visio",f="ms-publisher",l="ms-project",c=i,h=s,p=o,d=u,v=a,m={"ms-access":["accdb"],"ms-word":["doc","docm","docx","dot","dotm","dotx","odt"],"ms-project":["mpp"],"onenote|UsePlain":["one","onepkg","onetoc2","notebook","oneNote"],"ms-powerpoint":["odp","pot","potm","potx","ppa","ppam","pps","ppsm","ppsx","ppt","pptm","pptx"],"ms-publisher":["pub"],"ms-excel":["csv","ods","xla","xlam","xll","xls","xlsb","xlsm","xlsx","xlt","xltm","xltx"],"ms-visio":["vdw","vsd","vsdm","vsdx","vsl","vss","vssm","vssx","vst","vstm","vstx"]},g={accdb:"ms-access",csv:u,doc:i,docm:i,docx:i,dot:i,dotm:i,dotx:i,odp:o,ods:u,odt:i,one:s,onepkg:s,onetoc2:s,mpp:l,notebook:s,pot:o,potm:o,potx:o,ppa:o,ppam:o,pps:o,ppsm:o,ppsx:o,ppt:o,pptm:o,pptx:o,pub:f,vdw:a,vsd:a,vsdm:a,vsdx:a,vsl:a,vss:a,vssm:a,vssx:a,vst:a,vstm:a,vstx:a,xla:u,xlam:u,xll:u,xls:u,xlsb:u,xlsm:u,xlsx:u,xlt:u,xltm:u,xltx:u},y=((r={})["ms-access"]="Access",r[i]="Word",r[s]="OneNote",r[o]="PowerPoint",r[u]="Excel",r[a]="Visio",r[f]="Publisher",r[l]="Project",r);function b(e){return y[e]||e}},,,function(e,t,n){"use strict";n.d(t,"e",function(){return v});var r=n(0),i=n(1649),s=n(11),o=n("knockout-lib"),u=n(52),a=n(197),f=n(129),l=n(1859),c=function(){this.icon=null;this.isAvailable=o.observable(!0);this.isVisible=o.observable(!0);this.isDefault=!1;this.automationId="";this.instrumentationId="";this.isExecuting=o.observable(!1);this.isLink=!1;this.execute=function(){return u.n.wrap(1)}},h=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.state=o.observable(1);var r=t.title,i=t.titleAction,s=t.titleIcon,u=t.titleIconAriaLabel,f=t.customCssClasses,h=t.actions,p=void 0===h?[]:h,d=t.component,v=t.control,m=t.isDismissable,g=void 0===m||m,y=t.isSoftDismissable,b=void 0===y||y,w=t.isDismissableOnResize,E=void 0!==w&&w,S=t.isDismissableOnScroll,x=void 0!==S&&S,T=t.size,N=void 0===T?"Small":T,C=t.automationId,k=t.executeDefaultAction,L=void 0===k||k,A=t.isCallout,O=t.isOverlayHidden,M=void 0!==O&&O,_=t.overlayColor,D=void 0===_?"rgba(255,255,255,.4)":_,P=t.invokerEvent,H=t.calloutHeight,B=t.instrumentationId,j=void 0===B?"":B,F=t.shouldPreserveFocus,I=void 0===F||F,q=t.stayAsPopup,R=void 0!==q&&q,U=t.template,z=void 0===U?1:U,W=t.style,X=void 0===W?l.e.normal:W,V=t.focusOnPrimaryAction,$=void 0!==V&&V,J=t.dismissOnEsc,K=void 0!==J&&J;n.title=o.isObservable(r)?r:o.observable(r);n.titleAction=i;n.titleIcon=s;n.titleIconAriaLabel=u;n.customCssClasses=f;n.actions=p;n.component=d;n.control=v;n.isDismissable=g;n.isSoftDismissable=b;n.isDismissableOnResize=E;n.isDismissableOnScroll=x;n.size=N;n.automationId=C||"";n.executeDefaultAction=L;n.isCallout=!!A&&!!P;n.isOverlayHidden=M;n.overlayColor=D;n.invokerEvent=P;n.calloutHeight=H;n.instrumentationId=j;n.shouldPreserveFocus=o.isObservable(I)?I:o.observable(I);n.stayAsPopup=R;n.template=z;n.style=X;n.focusOnPrimaryAction=$;n.dismissOnEsc=K;n.actions=n.actions.map(function(e){return o.utils.extend(new c,e)});n.actionsVisible=n.createComputed(function(){for(var e=!1,t=0,r=n.actions;t<r.length;t++){r[t].isVisible()&&(e=!0)}return e},{disposeWhen:function(){return 1!==n.state()}});var Q=new a.e;n.createComputed(function(){var e=n.state();1!==e&&(2===e?Q.complete():Q.cancel())});n._promise=Q.getPromise();n.events.on(document,"keydown",n._keyDownEvent);return n}t.prototype.complete=function(){this.state(2)};t.prototype.dismiss=function(){this.state(3)};t.prototype.wait=function(){return this._promise};t.prototype._keyDownEvent=function(e){e.keyCode===f.e.escape&&this.dismissOnEsc&&this.state(3)};return t})(i.n),p=n(1722),d=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._dialogs=[];r.currentDialog=r.observables.create();r._needsOverlayContent=n.needsOverlayContent;return r}t.prototype.requestDialog=function(e){this._needsOverlayContent.needsOverlayContent.set(!0);var t=this._dialogs;if(e.maxOneDialog&&t.length>0)return t[0];var n=this.currentDialog,r=new h(e);if(e.queueDialog){t.push(r);1===t.length&&n(r)}else{t.unshift(r);n(r)}var i=function(){var e=t.indexOf(r);if(e>=0){t.splice(e,1);n(t[0])}r.dispose()};r.wait().then(i,i);return r};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{needsOverlayContent:p.e});return t})(i.n),v=Object(s.s)("DialogProvider",d)},,,,function(e,t,n){"use strict";var r;(function(e){e[e.created=0]="created";e[e.started=1]="started";e[e.completed=2]="completed";e[e.failed=3]="failed";e[e.canceled=4]="canceled";e[e.expired=5]="expired"})(r||(r={}));t.e=r},,function(e,t,n){"use strict";n.d(t,"c",function(){return u});n.d(t,"a",function(){return a});n.d(t,"s",function(){return f});n.d(t,"u",function(){return l});n.d(t,"h",function(){return c});n.d(t,"m",function(){return h});n.d(t,"t",function(){return p});n.d(t,"i",function(){return d});n.d(t,"n",function(){return v});n.d(t,"f",function(){return m});n.d(t,"e",function(){return g});n.d(t,"r",function(){return y});n.d(t,"l",function(){return b});n.d(t,"o",function(){return w});n.d(t,"v",function(){return E});n.d(t,"p",function(){return S});n.d(t,"d",function(){return x});var r=n(70),i=n(249),s=window._spPageContextInfo,o=s&&"21"===s.webTemplate&&700===s.listBaseTemplate;function u(){return!0}function a(){return i.e.isFeatureEnabled({ODC:"OptimizeSharingStoreApiCallsKillswitch"})}function f(){return i.e.isFeatureEnabled({ODB:1977})}function l(){return i.e.isFeatureEnabled({ODB:60345})}function c(){return!r.t.isActivated("227ee00d-a46d-42cd-8beb-de7befc5cff7","4/27/2021","Deactivate require signin link clientid flag")}function h(){return o&&i.e.isFeatureEnabled({ODB:60533})}function p(){return r.t.isActivated("b011fecf-6da0-4c0e-8dd1-46fe2d478766","07/20/2021","Remove duplicated suggestions in PeoplePicker")}function d(){return i.e.isFeatureEnabled({ODC:"WacAgeGroup"})||!i.e.isFeatureEnabled({ECS:91527})}function v(){return!0}function m(){return!r.t.isActivated("1f314070-584b-454b-a8d4-b8378bcfa1d4","07/20/2021","A/B Experiment with Send Email")}function g(){return r.t.isActivated("f1bcbfe5-3183-4488-b087-2c390f95473c","08/06/2021","Add close button to manage access in WAC")}function y(){return!r.t.isActivated("8da0a512-655d-47ba-9e0c-edf9846bb7de","08/13/2021","Uses Direct Link for Share Target")}function b(){return!r.t.isActivated("be78e09f-3a06-4c6b-8eee-f946ec0f6aea","08/13/2021","Refactored OnClick functions for Share Targets")}function w(){return r.t.isActivated("c650441c-dcb2-4f64-94a6-5f8ed8247a6b","08/17/2021","hide facepile")||i.e.isFeatureEnabled({ECS:93635})}function E(){return!r.t.isActivated("2fbff34d-008f-4a8c-ab13-30a64e53c629","09/22/2021","Iframe can dismiss dialog in wac")}function S(){return r.t.isActivated("4b80dfbd-dadd-43e7-83b7-8fb6cf2bb88c","09/23/2021","userPhotoBaseUrl")}function x(){return r.t.isActivated("F85E07B9-8012-4F0B-BF2B-46AE5F954119","09/28/2021","userPhotoBaseUrl1")||i.e.isFeatureEnabled({ECS:98570})}},,function(e,t,n){"use strict";var r=(function(){function e(e,t){if((function(e){return!!e&&"object"==typeof e})(e)){this.key=e.key;this.input=e.input;this.output=e.output;this.status=e.status;this.error=e.error}else{this.key=e;this.input=t;this.status=0}}e.prototype.succeed=function(t){var n=new e(this);n.output=t;n.status=1;delete n.error;return n};e.prototype.fail=function(t){var n=new e(this);n.error=t;n.status=2;return n};e.prototype.cancel=function(){var t=new e(this);delete t.error;t.status=3;return t};e.prototype.restart=function(){return new e(this.key,this.input)};e.prototype.changeInput=function(t){var n=t(this.input),r=new e(this.key,n);r.output=this.output;r.status=this.status;r.error=this.error;return r};e.prototype.changeOutput=function(t){var n=t(this.output),r=new e(this.key,this.input);r.output=n;r.status=this.status;r.error=this.error;return r};e.prototype.compare=function(e){return!e||this.input!==e.input||this.output!==e.output||this.error!==e.error||this.status!==e.status?{previous:e,current:this}:null};return e})();t.e=r},,function(e,t,n){"use strict";var r;(function(e){e[e.multiple=0]="multiple";e[e.renameItems=1]="renameItems";e[e.deleteItems=2]="deleteItems";e[e.pointInTimeRestore=3]="pointInTimeRestore";e[e.restoreItems=4]="restoreItems";e[e.uploadItems=5]="uploadItems";e[e.moveItems=6]="moveItems";e[e.copyItems=7]="copyItems";e[e.rotateItems=8]="rotateItems";e[e.addItemsToAlbum=9]="addItemsToAlbum";e[e.addCoverPhotos=10]="addCoverPhotos";e[e.removeCoverPhotos=11]="removeCoverPhotos";e[e.createAlbumFromFolder=12]="createAlbumFromFolder";e[e.createColumn=13]="createColumn";e[e.editColumn=14]="editColumn";e[e.deleteColumn=15]="deleteColumn";e[e.checkInItem=16]="checkInItem";e[e.checkOutItem=17]="checkOutItem";e[e.undoCheckOutItem=18]="undoCheckOutItem";e[e.createFolder=19]="createFolder";e[e.updateBundle=20]="updateBundle";e[e.shareItem=21]="shareItem";e[e.reportAbuse=22]="reportAbuse";e[e.requestReview=23]="requestReview";e[e.setAlbumCoverPhoto=24]="setAlbumCoverPhoto";e[e.createAlbum=25]="createAlbum";e[e.uploadVideos=26]="uploadVideos";e[e.saveItem=27]="saveItem";e[e.createItem=28]="createItem";e[e.publishItem=29]="publishItem";e[e.unPublishItem=30]="unPublishItem";e[e.applyOfficeLens=31]="applyOfficeLens";e[e.removeOfficeLens=32]="removeOfficeLens";e[e.updateMetadata=33]="updateMetadata";e[e.makeHomepage=34]="makeHomepage";e[e.triggerFlow=35]="triggerFlow";e[e.downloadAsZip=36]="downloadAsZip";e[e.saveAutoAlbum=37]="saveAutoAlbum";e[e.discardAutoAlbum=38]="discardAutoAlbum";e[e.addToOneDrive=39]="addToOneDrive";e[e.removeFromSharedList=40]="removeFromSharedList";e[e.setupApprovalFlow=41]="setupApprovalFlow";e[e.setupReminderFlow=42]="setupReminderFlow";e[e.sharepointPointInTimeRestore=43]="sharepointPointInTimeRestore";e[e.sharingReport=44]="sharingReport";e[e.editViewColumns=45]="editViewColumns";e[e.runModelOnItems=46]="runModelOnItems";e[e.importModel=47]="importModel"})(r||(r={}));t.e=r},,,,,function(e,t,n){"use strict";var r=n(0),i=n(991),s=n(1650),o=n(1700),u=(function(e){Object(r.__extends)(t,e);function t(t){var n,r,i,s=e.call(this,t)||this,u=t.valueAccessor();if((function(e){return"object"==typeof e})(u)){n=u.isBodyActive;r=u.activeElement;i=u.isDescendantOrSelfActive}else i=u;s._focusTracker=s.resources.consume(o.e);var a=s.observables;if(i){var f=a.pureCompute(s._computeIsDescendantOrSelfActive);a.compute(function(){i(f())}).extend({deferred:!0})}if(n){var l=a.pureCompute(s._computeIsBodyActive);a.compute(function(){n(l())}).extend({deferred:!0})}if(r){var c=a.pureCompute(s._computeActiveElement);a.compute(function(){r(c())}).extend({deferred:!0})}return s}t.prototype._computeIsDescendantOrSelfActive=function(){var e=this.element,t=this._focusTracker.activeElement();return!!t&&(e===t||Object(i.e)(e,t))};t.prototype._computeIsBodyActive=function(){var e=this._focusTracker.activeElement();return!e||e===document.body};t.prototype._computeActiveElement=function(){return this._focusTracker.activeElement()};return t})(s.t);t.e=u},function(e,t,n){"use strict";var r=n(23),i=function(e){void 0===e&&(e="");this.isDropEnabled=!1;this.permissions={High:0,Low:0};this.key=e;this.revision=0;this.queryType=r.e.Files;this.displayType=r.e.Files;this.isPlaceholder=!0;this.properties={};this.recycleBinProperties={};this.reputationProperties={};this.statistics={views:0,viewsUnique:0,viewsLast2Weeks:0,viewsLast2WeeksUnique:0,viewsLastWeek:0,viewsLastWeekUnique:0,viewsLastMonth:0,viewsLastMonthUnique:0};this.urls={};this.state={upload:{status:5},removing:!1}};t.e=i},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.normal=0]="normal";e[e.largeHeader=1]="largeHeader";e[e.close=2]="close"})(r||(r={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(0),i=n(1649),s=n(1657),o=n(11),u=n(181),a=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=r.observables;r._activeElement=i.create({});r.activeElement=i.pureCompute(r._computeActiveElement);r.activeElement.equalityComparer=s.n;r.isWindowActive=i.create(!0);r._isWithinWindowBlur=!1;r._platform=n.platFormDetection;var o=r.async.throttle(function(){r._activeElement({})},350),u=r._platform&&r._platform.isEdge,a=r._platform&&r._platform.isIE;if(u||a){var f=new MutationObserver(o);f.observe(document.body,{childList:!0,subtree:!0});r.scope.attach({dispose:function(){f&&f.disconnect()}})}r.events.onAll(window,{focus:r._onWindowFocus,blur:r._onWindowBlur},!1);r.events.onAll(document.body,{focus:r._onDocumentFocus,blur:r._onDocumentBlur},!0);return r}t.prototype._computeActiveElement=function(){this._activeElement();return document.activeElement};t.prototype._onWindowFocus=function(e){this.async.clearTimeout(this._windowBlurTimeout);this._isWithinWindowBlur=!1;this.isWindowActive(!0)};t.prototype._onDocumentFocus=function(e){if(!this._isWithinWindowBlur){this.isWindowActive(!0);var t=document.activeElement;this.async.clearTimeout(this._blurTimeout);window.__debugFocus&&console.log("[focus] active:",t);this._activeElement({})}};t.prototype._onWindowBlur=function(e){var t=this;this._isWithinWindowBlur=!0;this.isWindowActive(!1);this._windowBlurTimeout=this.async.setTimeout(function(){t._isWithinWindowBlur=!1},10)};t.prototype._onDocumentBlur=function(e){var t=this;if(!this._isWithinWindowBlur){this.isWindowActive(!0);var n=document.activeElement;this.async.clearTimeout(this._blurTimeout);if(n&&n!==document.body){window.__debugFocus&&console.log("[focus] blur:",n);this._activeElement({})}else{window.__debugFocus&&console.log("[focus] wait:",n);this._blurTimeout=this.async.setTimeout(function(){window.__debugFocus&&console.log("[focus] blur:",n);t._activeElement({})},0)}}};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{platFormDetection:u.e});return t})(i.n),f=Object(o.s)("FocusTracker",a,Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{platFormDetection:u.e}))},,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(1651),s=n(1663),o=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this,o=Object(r.__assign)(Object(r.__assign)({},t.props||{}),{hostViewModel:i});i.addBindingHandlers({react:s.t});i.reactBindingParams=Object(r.__assign)({props:o,error:t.error},(function(e){return"string"==typeof e.component})(t)?{componentPath:t.component,getModule:t.getComponentModule}:{componentType:t.component});return i}return t})(i.t);function u(e,t,n,i){return{tagName:e,template:'<div data-bind="react:reactBindingParams"></div>',viewModel:{createViewModel:function(e,s){return new(e.resources.injected(o))(Object(r.__assign)(Object(r.__assign)({},"string"==typeof t?{component:t,getComponentModule:n}:{component:t}),{error:e.reactRenderError,props:Object(r.__assign)(Object(r.__assign)({},i||{}),e)}),s)}},synchronous:!0}}},function(e,t,n){"use strict";var r=n(0),i=n(1650),s=n(269),o=n(1662),u=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.valueAccessor(),i=(function(e){return"object"==typeof e})(r)?r:{close:r},s=i.timeout,u=void 0===s?1e3:s,a=i.close,f=i.isAutomatic,l=void 0!==f&&f,c=i.isOpen,h=i.isEnabled,p=void 0===h||h,d=i.dismissOnResize,v=void 0!==d&&d,m=i.dismissOnScroll,g=void 0!==m&&m,y=i.useLocalEvents,b=void 0!==y&&y,w=i.disableEscape,E=void 0!==w&&w;n._options={timeout:u,close:a,isAutomatic:l,isOpen:c,dismissOnResize:v,dismissOnScroll:g,useLocalEvents:b,disableEscape:E};var S=n.observables;n._isAutomatic=S.wrap(l);n._isEnabled=S.wrap(p);n._isActive=S.create(!0);n._isOpenAndNotActive=S.pureCompute(n._computeIsOpenAndNotActive);S.backgroundCompute(n._computeDismissIfOpenAndNotActive).extend({rateLimit:{timeout:n._options.timeout,method:"notifyWhenChangesStop"}});n._options.isOpen&&S.backgroundCompute(n._computeDeactivateIfOpen);n.events.on(document,"click, mousemove, touchmove, pointermove, MSPointerMove, keydown",n._onEvent,!0);n.events.on(document,"click",n._onClick,!0);new(n.managed(o.e))({element:n.element,bindingContext:n.bindingContext,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return{mappings:{Esc:function(e,t){return!!n._options.disableEscape||n._onEscape(t)}},target:n._options.useLocalEvents?void 0:document,useCapture:!n._options.useLocalEvents,allowInputEvents:!0,allowButtonEvents:!0,context:n.bindingContext.$data}}});n._options.dismissOnResize&&n.events.on(window,"resize",n._onResizeOrScroll,!0);n._options.dismissOnScroll&&n.events.on(window,"scroll",n._onResizeOrScroll,!0);return n}t.prototype._dismiss=function(){var e=this._options,t=e.isOpen,n=e.close;t&&t(!1);if(n){var r=this.bindingContext.$data;if(!1===n.call(r,r))return!1}return!0};t.prototype._onClick=function(e){if(!a(this.element,e)&&!(function(e){var t,n=e.target;return"none"===(null===(t=null==n?void 0:n.style)||void 0===t?void 0:t.display)})(e)){this._isActive(!1);this._isOpenAndNotActive.peek()&&this._isEnabled.peek()&&this._dismiss()}return!0};t.prototype._onEscape=function(e){if(a(this.element,e)){this._isActive(!1);if(this._isOpenAndNotActive.peek()&&this._isEnabled.peek()){e.stopImmediatePropagation();e.stopPropagation();this._dismiss();return!1}}return!0};t.prototype._onEvent=function(e){a(this.element,e)?this._isActive(!0):this._isActive(!1);return!0};t.prototype._onResizeOrScroll=function(e){if(!a(this.element,e)){this._isActive(!1);this._isOpenAndNotActive.peek()&&this._isEnabled.peek()&&this._dismiss()}return!0};t.prototype._computeDismissIfOpenAndNotActive=function(){this._isAutomatic()&&this._isOpenAndNotActive()&&this._isEnabled.peek()&&this._dismiss()};t.prototype._computeIsOpenAndNotActive=function(){var e=this._isActive(),t=this._options.isOpen;return(!t||t())&&!e};t.prototype._computeDeactivateIfOpen=function(){this._options.isOpen()&&this._isActive(!1)};return t})(i.t);t.e=u;function a(e,t){try{for(var n=t.target;n!==e&&Object(s.e)(n);)n=Object(s.e)(n);return n===e}catch(e){return!1}}},,function(e,t,n){"use strict";n(1780);var r,i=n(52),s=n(109),o=n(48);(function(e){e[e.InteractionRequired=10013]="InteractionRequired"})(r||(r={}));var u=(function(){function e(e,t){void 0===e&&(e={});this._dataSource=t.oAuthTokenDataSource}e.prototype.getToken=function(e,t){var n=new s.e({name:"getToken"});return this._dataSource.getToken(e,t).then(function(e){n.end({resultType:o.e.Success});return e},function(e){n.end({resultType:o.e.Failure});return i.n.reject(e)})};e.prototype.getInstrumentedToken=function(e,t){var n=new s.e({name:"getToken"});return this._dataSource.getInstrumentedToken(e,t).then(function(e){n.end({resultType:o.e.Success});return e},function(e){n.end({resultType:o.e.Failure});return i.n.reject(e)})};return e})();t.e=u},function(e,t,n){"use strict";var r=n(138);Object(r.n)([{rawString:".od-Overlay{height:0;width:0;overflow:hidden}"}]);var i=n(1717),s=n(1652),o=n(0),u=n(1651),a=n(1769),f=n(1660),l=n(1678),c=n(1649),h=n("knockout-lib"),p=(function(e){Object(o.__extends)(t,e);function t(t){var n=e.call(this,{})||this,r=t.topTab,i=t.bottomTab,s=t.animation,o=void 0===s?{}:s,u=t.alignToParent,a=void 0===u?h.observable(!0):u,f=t.parentElement,l=t.isOpen;n.topTab=r;n.bottomTab=i;n.animation=o;n.alignToParent=a;n.parentElement=f;n.isOpen=l;return n}return t})(c.n),d=(function(e){Object(o.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.transclusionContentTagName=i.e.tagName;var s=n.overlayProvider,o=void 0===s?r.resources.consume(a.e):s,u=t.animation,c=t.alignToParent,h=void 0!==c&&c,d=t.parentElement,v=t.virtualParentElement;r.addBindingHandlers({host:l.e,element:f.e});r.overlayProvider=o;r.topTab=r.createObservable(null);r.bottomTab=r.createObservable(null);r.isOpen=r.createObservable(!1);r.virtualParentElement=v;r.overlay=new p({alignToParent:r.wrapObservable(h),parentElement:d,animation:u,topTab:r.topTab,bottomTab:r.bottomTab,isOpen:r.isOpen});return r}return t})(u.t),v=s.e({tagName:"od-overlay",template:'<a href="javascript:;" class="ms-accessible" role="presentation" data-bind="element:topTab"></a><div class="od-Overlay ms-accessible" role="presentation" data-bind="component:{name:transclusionContentTagName,params:{provider:overlayProvider,parentElement:virtualParentElement||$element.parentElement,options:overlay}}">\x3c!--ko host:{}--\x3e\x3c!--/ko--\x3e</div><a href="javascript:;" class="ms-accessible" role="presentation" data-bind="element:bottomTab"></a>',viewModel:d,synchronous:!0});t.e=v},function(e,t,n){"use strict";var r,i=n(0),s=n(1650),o=n(1649),u=n(197),a=n(11),f=n(1013),l=n(1746),c=n(896),h=n(109);(function(e){e[e.none=0]="none";e[e.queue=1]="queue";e[e.server=2]="server"})(r||(r={}));var p=r,d=Object(c.e)({eventName:"ImageLoad,Qos,",shortEventName:"ImageLoad"},{loadType:{typeRef:r,type:6}},h.e),v=n(48),m=n(1708),g=n(53),y=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._semaphore=new l.e(16);r._thumbnailCache=n.thumbnailCache;return r}t.prototype.loadImage=function(e){var t=this,n=e.url,r=e.imageElement,i=void 0===r?document.createElement("img"):r,s=e.scenarioName,o={url:n,width:0,height:0},u=this._thumbnailCache,a=function(){return f.e.authenticate(n).then(function(){return t._waitForImageLoad(i,n,s)}).then(function(e){u.record(o);if(i.complete&&!e)return t._waitForTimeout(300)}).then(function(){var e=i.naturalWidth||i.width,t=i.naturalHeight||i.height;return{url:n,width:e,height:t}})};return u.isLoaded(o)?a():this._semaphore.enqueue(a)};t.prototype._waitForImageLoad=function(e,t,n){var r,i,s,o=this.async,a=this.events,f=function(){s&&o.clearTimeout(s);a.off(e)},l=new u.e(function(){f();e.setAttribute("src","")}),c=t&&t.indexOf("&encodeFailures=1")>=0;a.onAll(e,{load:function(){f();if(c&&1===e.naturalWidth&&e.naturalHeight>6e4){var t=e.naturalHeight-6e4,n=406===t||412===t;i&&i.end({resultType:n?v.e.ExpectedFailure:v.e.Failure,resultCode:""+t,error:"Encoded failure"});l.error(new g.e({code:""+t,isExpected:n,message:"Server returned encoded failure "+t}))}else{i&&i.end({resultType:v.e.Success});l.complete(r)}},error:function(){f();i&&i.end({resultType:v.e.Failure});l.error(new Error("Image '"+t+"' failed to load"))}});s=o.setTimeout(function(){l.cancel()},3e4);n&&(i=new d({name:n,loadType:p.server}));e.setAttribute("src",t);r=!!e.complete;return this.trackPromise(l.getPromise())};t.prototype._waitForTimeout=function(e){var t,n=this.async,r=new u.e(function(){t&&n.clearTimeout(t)});t=n.setTimeout(function(){r.complete()},e);return r.getPromise()};t.dependencies=Object(i.__assign)(Object(i.__assign)({},o.n.dependencies),{thumbnailCache:m.e});return t})(o.n),b=Object(a.s)("ImageLoader",y),w=n(1656),E=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t)||this;r._debouncer=new w.e;r._imageLoader=r.resources.consume(b);var i=r.valueAccessor(),s=i.src,o=i.image,u=i.error,a=i.isLoaded,f=i.isError,l=i.actualSize,c=i.scenarioName;r._src=r.wrapObservable(s);r._image=r.wrapObservable(o);r._error=r.wrapObservable(u);r._scenarioName=c;var h=n.outputExtenders,p=void 0===h?{deferred:!0}:h;r.createComputed(r._computeLoadImage);r.createBackgroundComputed(function(){var e=r._image();a&&a(!!e);if(l){var t=void 0;if(e){t={width:e.width,height:e.height}}l(t)}o&&o(e)}).extend(p);r.createBackgroundComputed(function(){var e=r._error();u&&u(e);f&&f(!!e)}).extend(p);return r}t.prototype._computeLoadImage=function(){var e,t=this,n=this.unwrapObservable(this._src);this._image(void 0);this._scenarioName&&(e=new d({name:this._scenarioName,loadType:p.queue}));this._debouncer.debounce(this.trackPromise(this._imageLoader.loadImage({url:n,imageElement:this.element,scenarioName:this._scenarioName}))).then(function(n){t._image(n);t._error(void 0);e&&e.end({resultType:v.e.Success})},function(n){t._error(n);e&&e.end({resultType:n.isExpected?v.e.ExpectedFailure:v.e.Failure})})};return t})(s.t);t.e=E},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(1649),s=n(11),o=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r._recordsByThumbnailKey={};r._bucketsByImageKey={};var i=r.observables;r.lastAccessedDate=i.create(new Date);var s=n.pruneThumbnailsExtenders,o=void 0===s?{rateLimit:{timeout:6e5}}:s;i.backgroundCompute(r._pruneThumbnails).extend(o);return r}t.prototype.getCoveragePercent=function(e,t){var n=l(e),r=l(t);return Math.sqrt(r/n)};t.prototype.register=function(e,t,n,r){void 0===n&&(n=t);void 0===r&&(r=!0);var i=this.lastAccessedDate;i(new Date);var s=f(this.getCoveragePercent(e,n)),o=a(e),u=a(t),l=this._recordsByThumbnailKey,c=this._bucketsByImageKey,h=l[o]||{lastAccessed:void 0,buckets:{}};h.lastAccessed=i.peek();var p=h.buckets[s];if(!p||this.getCoveragePercent(p.size,n)>1){p&&delete c[p.key];p=h.buckets[s]={key:u,size:n,image:t,isLoaded:r,lastAccessed:i.peek()}}c[u]=p;l[o]=h};t.prototype.record=function(e){var t=this.lastAccessedDate;t(new Date);var n=a(e),r=this._bucketsByImageKey,i=r[n];i?i.isLoaded=!0:r[n]={key:n,size:e,image:e,isLoaded:!0,lastAccessed:t.peek()}};t.prototype.isLoaded=function(e){var t=this.lastAccessedDate;t(new Date);var n=a(e),r=this._bucketsByImageKey[n];r&&(r.lastAccessed=t.peek());return!!r&&r.isLoaded};t.prototype.retrieve=function(e,t,n){void 0===t&&(t=1);void 0===n&&(n=t);var r=a(e),i=this._recordsByThumbnailKey[r],s=this.lastAccessedDate;s(new Date);if(i){var o=i.buckets;i.lastAccessed=s.peek();var u=f(t),l=f(n),c=-1/0,h=!1;for(var p in o){var d=Number(p);if(d<=u&&d>=l&&o[d].isLoaded){c=Math.max(c,d);h=!0}}var v=h&&o[c];return v&&v.image}};t.prototype._pruneThumbnails=function(){var e=this.lastAccessedDate().getTime();c(this._recordsByThumbnailKey,e);c(this._bucketsByImageKey,e)};return t})(i.n),u=Object(s.s)("ThumbnailCache",o);function a(e){var t=e.url,n=e.width,r=e.height;return JSON.stringify({url:t,width:n,height:r})}function f(e){return Math.floor(Math.log(e)/Math.log(2)*4)}function l(e){return e.width*e.height}function c(e,t){for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];t-e[i].lastAccessed.getTime()>432e5&&delete e[i]}}},function(e,t,n){"use strict";var r;(function(e){e[e.none=0]="none";e[e.user=1]="user";e[e.distributionList=2]="distributionList";e[e.securityGroup=4]="securityGroup";e[e.sharePointGroup=8]="sharePointGroup";e[e.all=15]="all"})(r||(r={}));t.e=r},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r={INPUT:!0,TEXTAREA:!0},i={A:!0,BUTTON:!0};function s(e){var t=e;return!!(t&&(t.tagName in r||t.isContentEditable))}function o(e){return!!(e&&e.tagName in i)}},,function(e,t,n){"use strict";n.d(t,"h",function(){return l});n.d(t,"o",function(){return c});n.d(t,"u",function(){return h});n.d(t,"a",function(){return p});n.d(t,"s",function(){return d});n.d(t,"n",function(){return v});n.d(t,"f",function(){return m});n.d(t,"c",function(){return g});n.d(t,"l",function(){return y});n.d(t,"t",function(){return b});n.d(t,"i",function(){return w});n.d(t,"r",function(){return E});n.d(t,"e",function(){return S});n.d(t,"p",function(){return x});n.d(t,"v",function(){return T});n.d(t,"d",function(){return N});var r=n(7),i=n(137),s=new(n(5).e)("photosExperimentHelperKeyFacet",{}).serialize({}),o=new(n(2).e)("photosExperimentHelper"),u=n(46);n(12),n(108);var a=n(3),f=n(181),l=new r.t({name:"ItemsScopeFeature.key.isItemsScopeEnabled",factory:{dependencies:{},create:function(e){return{instance:a.Vi?Object(a.Wi)(a.vi)||Object(a.Wi)(a.Ei):Object(a.Wi)(a.Si)}}}}),c=new r.t({name:"ItemsScopeFeature.key.isItemsScopeEnabledInFilesPivot",factory:{dependencies:{},create:function(){return{instance:a.Vi?Object(a.Wi)(a.vi):Object(a.Wi)(a.Si)}}}}),h=new r.t({name:"ItemsScopeFeature.key.isItemsScopeEnabledInRecentPivot",factory:{dependencies:{},create:function(){return{instance:Object(a.Wi)(a.Ue)}}}}),p=new r.t({name:"ItemsScopeFeature.key.isItemsScopeEnabledInSharedPivot",factory:{dependencies:{},create:function(){return{instance:Object(a.Wi)(a.gi)}}}}),d=new r.t({name:"ItemsScopeFeature.key.isItemsScopeEnabledInCrossSitePivots",factory:{dependencies:{},create:function(){return{instance:!!a.Vi&&Object(a.Wi)(a.Ei)}}}}),v=new r.t({name:"ItemsScopeFeature.key.isItemsScopeEnabledInAllPhotosPivot",factory:{dependencies:{platformDetection:f.e},create:function(e){return{instance:Object(a.Wi)(a.fi)&&(!e.platformDetection.isIE||Object(a.Wi)(a.li))&&(!e.platformDetection.isSafari||Object(a.Wi)(a.pi))&&(!e.platformDetection.isMobile||Object(a.Wi)(a.hi))}}}}),m=new r.t({name:"ItemsScopeFeature.key.isItemsScopeEnabledInSingleAlbumView",factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:v},create:function(e){return{instance:Object(a.Wi)(a.yi)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),g=new r.t({name:"ItemsScopeFeature.key.isItemsScopeEnabledInSingleTagView",factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:v},create:function(e){return{instance:Object(a.Wi)(a.wi)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),y=new r.t({name:"ItemsScopeFeature.key.isItemsScopeEnabledInSinglePlace",factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:v},create:function(e){return{instance:Object(a.Wi)(a.bi)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),b=new r.t({name:"ItemsScopeFeature.key.isItemsScopeEnabledInAllPhotosFilePicker",factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:v},create:function(e){return{instance:Object(a.Wi)(a.ci)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),w=new r.t({name:"ItemsScopeFeature.key.isItemsScopeEnabledInAllTagsPivot",factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:v},create:function(e){return{instance:Object(a.Wi)(a.di)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),E=new r.t({name:"ItemsScopeFeature.key.isItemsScopeEnabledInAllPlacesPivot",factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:v},create:function(e){return{instance:Object(a.Wi)(a.mi)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),S=new r.t({name:"ItemsScopeFeature.key.isItemsScopeEnabledInAllAlbumsPivot",factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:v},create:function(e){return{instance:Object(a.Wi)(a.ai)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),x=new r.t({name:"ItemsScopeFeature.key.isVroomEnabledInAllPhotosPivot",factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:v},create:function(e){return{instance:function(e){var t=e(Object(i.e)(function(e){return e.demandItemFacet(o,s)}));return Object(u.isFeatureEnabled)(u.UseVroomInItemsScopeAllPhotos)||Boolean(t&&t.isUseVroomInItemsScopeAllPhotosOtdExpOn())}&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),T=new r.t({name:"ItemsScopeFeature.key.isVroomEnabledInSingleTagView",factory:{dependencies:{isItemsScopeEnabledInSingleTagView:g},create:function(e){return{instance:Object(a.Wi)(a.Fi)&&e.isItemsScopeEnabledInSingleTagView}}}}),N=new r.t({name:"ItemsScopeFeature.key.isVroomEnabledInSinglePlaceView",factory:{dependencies:{isItemsScopeEnabledInSinglePlaceView:y},create:function(e){return{instance:Object(a.Wi)(a.ji)&&e.isItemsScopeEnabledInSinglePlaceView}}}})},function(e,t,n){"use strict";var r=(function(){function e(){this.R=0;this.G=0;this.B=0;this.A=e.maxComponent}e.clone=function(t){return e.fromRgba(t.R,t.G,t.B,t.A)};e.equals=function(e,t){var n=!e,r=!t;return n||r?n&&r:e.R===t.R&&e.G===t.G&&e.B===t.B&&e.A===t.A};e.fromRgba=function(t,n,r,i){var s=new e;s.R=Math.round(t);s.G=Math.round(n);s.B=Math.round(r);s.A=null!=i?Math.round(i):e.maxComponent;return s};e.fromRgbaString=function(t){var n=new e;if(/^rgb.+/.test(t)){var r=t.match(/[\d.]+/g);n=e.fromRgba(Number(r[0]),Number(r[1]),Number(r[2]),4===r.length?Number(r[3])*e.maxComponent:null)}return n};e.fromHtmlColor=function(t){function n(e,t,n){return parseInt(e.charAt(t)+e.charAt(n),16)}var r=new e;if("string"==typeof t&&"#"===t.charAt(0))switch(t.length){case 9:r.A=n(t,1,2);r.R=n(t,3,4);r.G=n(t,5,6);r.B=n(t,7,8);break;case 7:r.R=n(t,1,2);r.G=n(t,3,4);r.B=n(t,5,6);break;case 4:r.R=n(t,1,1);r.G=n(t,2,2);r.B=n(t,3,3)}else/^rgb.+/.test(t)&&(r=e.fromRgbaString(t));return r};e.toHtmlString=function(t,n){function r(t){var n=Number(t);if(!(n>=0&&n<=e.maxComponent))throw new Error("Argument must be a Number in [0, 255]");var r=n.toString(16);n<16&&(r="0"+r);return r}return t.A<e.maxComponent&&!n?"rgba("+t.R.toString(10)+", "+t.G.toString(10)+", "+t.B.toString(10)+", "+(t.A/e.maxComponent).toFixed(2)+")":"#"+(n?r(t.A):"")+r(t.R)+r(t.G)+r(t.B)};e.maxComponent=255;return e})();t.e=r},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.smallFluid=0]="smallFluid";e[e.smallFixedFar=1]="smallFixedFar";e[e.smallFixedNear=2]="smallFixedNear";e[e.medium=3]="medium";e[e.large=4]="large";e[e.largeFixed=5]="largeFixed";e[e.extraLarge=6]="extraLarge";e[e.custom=7]="custom";e[e.customNear=8]="customNear"})(r||(r={}))},function(e,t,n){"use strict";var r=n(0),i=n("knockout-lib"),s=n(1728),o=n(1650);function u(e){var t=document.createElement("div");t.tabIndex=0;t.className="ms-accessible";t.setAttribute("role","presentation");t.setAttribute("aria-hidden","true");t.setAttribute("data-focus-trap",e);return t}var a=s.focusNextTabStop,f=s.focusPreviousTabStop,l=i.virtualElements,c=i.applyBindingsToNode,h=i.applyBindingsToDescendants,p=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.controlsDescendantBindings=!0;var r=n,i=r.events,s=r.observables,o=r.bindingContext,a=r.element,f=t.valueAccessor()||{},p=f,d=p.isEnabled,v=p.invert,m=n._beforeHook=u("begin"),g=n._afterHook=u("end");n._invert=v;if(d){c(m,{visible:d},o);c(g,{visible:d},o)}var y=l.childNodes(a);l.prepend(a,m);l.insertAfter(a,g,y[y.length-1]);h(o,a);var b=f,w=b.before,E=void 0===w?s.create(g):w,S=b.after,x=void 0===S?s.create(m):S;n._before=s.wrap(E);n._after=s.wrap(x);i.on(m,"focus",n._onFocusBeforeHook);i.on(g,"focus",n._onFocusAfterHook);!v&&f.after&&n._initializeBeforeAndAfter();return n}t.prototype._onFocusBeforeHook=function(){this._invert?a(this._afterHook):f(this._before.peek())};t.prototype._onFocusAfterHook=function(){this._invert?f(this._beforeHook):a(this._after.peek())};t.prototype._onFocusBefore=function(){a(this._beforeHook)};t.prototype._onFocusAfter=function(){f(this._afterHook)};t.prototype._initializeBeforeAndAfter=function(){var e,t,n=this,r=this.events;this.observables.backgroundCompute(function(){var i=n._before(),s=n._after();if(i!==e){e&&r.off(e);i&&r.on(i,"focus",n._onFocusBefore);e=i}if(s!==t){t&&r.off(t);s&&r.on(s,"focus",n._onFocusAfter);t=s}})};t.supportsVirtualElements=!0;return t})(o.t);t.e=p},,,function(e,t,n){"use strict";var r=n(0),i=n("knockout-lib"),s=n(1650),o=n(1697),u=n(1700),a=n(1668),f=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r._focusTracker=r.resources.consume(u.e);r._hasFocus=r.createObservable(!1);r._hasChildFocus=r.createObservable(!1);r._isBodyActive=r.createObservable(!1);r._value=r.createPureComputed(r._computeValue);r._isEnabled=r.createPureComputed(r._computeIsEnabled);r._onlyRecoverFromBody=r.createPureComputed(r._computeOnlyRecoverFromBody);r._shouldRecoverFocus=r.createPureComputed(r._computeShouldRecoverFocus);var s=n.ChildFocusBinding,f=void 0===s?o.e:s,l=n.applyBindingsToNode,c=void 0===l?i.applyBindingsToNode:l,h=n.recoverFocusExtenders,p=void 0===h?{rateLimit:{timeout:300,method:"notifyWhenChangesStop"}}:h;new(r.managed(f))({element:r.element,bindingContext:r.bindingContext,allBindingsAccessor:r.allBindingsAccessor,valueAccessor:function(){return{isDescendantOrSelfActive:r._hasChildFocus,isBodyActive:r._isBodyActive}}});c(r.element,{hasFocus:r._hasFocus},r.bindingContext);r._scrollContainer=Object(a.t)(r.element);r.createBackgroundComputed(r._computeRecoverFocus).extend(p);return r}t.prototype._computeValue=function(){return this.valueAccessor()||{}};t.prototype._computeIsEnabled=function(){var e=this._value().isEnabled,t=void 0===e||e;return this.unwrapObservable(t)};t.prototype._computeOnlyRecoverFromBody=function(){var e=this._value().onlyRecoverFromBody,t=void 0!==e&&e;return this.unwrapObservable(t)};t.prototype._computeShouldRecoverFocus=function(){return this._isEnabled()&&!this._hasChildFocus()&&(!this._onlyRecoverFromBody()||this._isBodyActive())&&this._focusTracker.isWindowActive.peek()};t.prototype._computeRecoverFocus=function(){this._shouldRecoverFocus()&&this._recoverFocus()};t.prototype._recoverFocus=function(){var e=this._scrollContainer,t=e.scrollTop,n=e.scrollLeft;this._hasFocus(!0);e.scrollTop!==t&&(e.scrollTop=t);e.scrollLeft!==n&&(e.scrollLeft=n)};return t})(s.t);t.e=f},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(269),i=n(994);function s(e,t,n){void 0===n&&(n=!0);for(;e&&e!==document.body;){if(i.e.hasClass(e,t))return e;e=Object(r.e)(e,n)}return null}},,function(e,t,n){"use strict";n.d(t,"n",function(){return a});n.d(t,"e",function(){return f});n.d(t,"t",function(){return l});n.d(t,"r",function(){return c});var r,i=n(999),s=n(612),o=n(181),u=n(716);(function(e){e.vaultOpen="vaultopen";e.vaultClosed="vaultclosed"})(r||(r={}));function a(e,t,n){var r=s.e[t]&&s.e[t].iconType||"png",i=e&&"png"===r;return""+u.n+n+(i?"_2x":"")+"/"+t+"."+r}function f(e,t,n){return a(e.consume(o.e).isRetinaSupported,t,n)}function l(e,t,n){return f(e,i.t(t),n)}function c(e,t,n){if(n&&n.vault&&n.vault.root){return f(e,n.vault.isLocked?r.vaultClosed:r.vaultOpen,t)}if(n&&n.folder&&"SamsungGallery"===n.specialFolderCanonicalName)return f(e,"samsunggallery",t)}},,function(e,t,n){"use strict";var r=n(0),i=(n(1681),n(1787)),s=n(1651),o=n(1779),u=n(1703),a=n(1660),f=n(1650),l=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.valueAccessor();n._callback=r.callback;n._delay=r.delay||400;n.events.on(n.element,"mouseenter",n._onMouseEnter);n.events.on(n.element,"mouseleave",n._onMouseLeave);return n}t.prototype._clearTimer=function(){if(this._timerID){this.async.clearTimeout(this._timerID);this._timerID=void 0}};t.prototype._onMouseEnter=function(e){this._clearTimer();this._timerID=this.async.setTimeout(this._onHoverTimer,this._delay)};t.prototype._onMouseLeave=function(e){this._clearTimer()};t.prototype._onHoverTimer=function(){this._timerID=void 0;this._callback&&this._callback()};return t})(f.t),c=n(1782),h=n(1749),p=n("knockout-lib"),d=n(156),v=(function(){function e(){}e.init=function(e,t){var n=p.utils.unwrapObservable(t()),r=n.eventName||"dataChange",i=n.eventArgs,s=p.isObservable(n.data)?n.data:p.observable(),o=n.bubbleEvent||!1;s.subscribe(function(){d.t.raise(e,r,i,o)})};return e})(),m=n(1788),g=n(425),y=n(133),b=n(888),w=n(1791),E=n(195),S=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._insertNewElement();n.controlsDescendantBindings=!0;return n}t.prototype.dispose=function(){if(this._previousElement){p.cleanNode(this._previousElement);delete this._previousElement}e.prototype.dispose.call(this)};t.prototype._insertNewElement=function(){var e=this.valueAccessor(),t=this._createInputElement(e.isFolderUpload);this._applyBindings(t,e);p.virtualElements.setDomNodeChildren(this.element,[t]);this._previousElement=t};t.prototype._createInputElement=function(e){var t=document.createElement("input");t.type="file";t.tabIndex=-1;if(e){t.webkitdirectory=!0;t.directory=!0}else t.multiple=!0;return t};t.prototype._applyBindings=function(e,t){var n=this;p.applyBindingsToNode(e,{class:t.class,css:t.css,style:t.style,event:{change:function(e,r){t.onInputChange.call(e,r);n._insertNewElement()}}},this.bindingContext)};t.supportsVirtualElements=!0;return t})(f.t),x=n(1795),T=n(49),N=n(1649),C=((function(){function e(){}e.Search="Search"})(),(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getBuckets=function(){return t.getBuckets(this.resources)};t.getBuckets=function(e){return e&&e.isExposed(T.f)?e.consume(T.f):p.observable([])};t.prototype.getLoggingContextData=function(){return t.getLoggingContextData(this.resources)};t.getLoggingContextData=function(e){var n=null;e&&e.isExposed(T.a)&&(n=e.consume(T.a));return n?n.get(t.getBuckets(e).peek()):{}};t.prototype.addBuckets=function(e){return t.addBuckets(this.resources,e)};t.addBuckets=function(e,t){if(e){var n=[];e.isExposed(T.f)&&(n=e.consume(T.f).peek());t.forEach(function(e){n.indexOf(e)<0&&n.push(e)});e.isExposed(T.f)||e.expose(T.f,p.observable(n))}};return t})(N.n)),k=n(1653),L=n(1659),A=n(293),O=n(25),M=0;var _=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,(function(e){e.id=e.id||""+M++;return e})(t),n)||this;r.ActionInputType=x.e;r._defaultMenuOffset=new E.e(0,o.e.size/2+4);r.addBindingHandlers({dismiss:u.e,raiseEventOnChange:v,measure:c.e,longHover:l,element:a.e,teachingBubble:m.e,fileInput:S,tooltip:h.e,control:k.n});var s=r,f=s.observables,p=s.resources,d=n.engagement,g=void 0===d?p&&p.consume(b.e.optional):d,y=n.responsiveUI,w=void 0===y?p&&p.consume(L.t.optional):y;r._isOpenRequested=r.createObservable(!1);r.isActive=r.createObservable(!1);r.isToggled=r.createObservable(!1);r.focused=r.createObservable(!1);r.menuFocus=r.createObservable(!1);r.fileInputElement=r.createObservable();var T=t.text,N=void 0===T?"":T,C=t.automateExperimentText,O=t.subtext,_=void 0===O?"":O,D=t.classSuffix,P=void 0===D?r.createObservable():D,H=t.collapsedText,B=void 0===H?r.createObservable():H,j=t.location,F=void 0===j?11:j,I=t.renderLabel,q=void 0===I?1:I,R=t.isCurrentView,U=void 0===R?null:R,z=t.hasIconOnly,W=void 0!==z&&z,X=t.positionIconRight,V=void 0!==X&&X,$=t.icon,J=t.iconUrl,K=t.iconSize,Q=void 0===K?16:K,G=t.appIconName,Y=t.ariaControls,Z=t.ariaExpanded,ee=t.ariaHasPopup,te=t.keys,ne=void 0===te?[]:te,re=t.isToggleable,ie=void 0!==re&&re,se=t.isHidden,oe=void 0===se?r.createObservable():se,ue=t.isDisabled,ae=t.isInvisibleWhenDisabled,fe=void 0!==ae&&ae,le=t.tooltip,ce=void 0===le?null:le,he=t.accessibleLabel,pe=void 0===he?"":he,de=t.prependTextToAccessibleLabel,ve=void 0===de||de,me=t.sectionAccessibleLabel,ge=void 0===me?"":me,ye=t.role,be=void 0===ye?"":ye,we=t.teachingBubble,Ee=t.iconBadge,Se=t.isPermanent,xe=void 0!==Se&&Se,Te=t.state,Ne=void 0===Te?r.createObservable(i.e.initialized):Te,Ce=t.requiredChildren,ke=void 0===Ce?0:Ce,Le=t.collapseSingleChildCommands,Ae=void 0===Le||Le,Oe=t.hasLineBreakBefore,Me=void 0!==Oe&&Oe,_e=t.hasLineBreakAfter,De=void 0!==_e&&_e,Pe=t.action,He=t.callback,Be=t.onCoachmarkOpen,je=t.menuAlignment,Fe=void 0===je?r.createObservable(0):je,Ie=t.menuOffset,qe=void 0===Ie?r.createObservable(r._defaultMenuOffset):Ie,Re=t.isMenuBeakVisible,Ue=void 0===Re?r.createObservable(!0):Re,ze=t.payload,We=t.enableRecoverFocusBinding,Xe=void 0!==We&&We,Ve=t.engagementName,$e=t.source,Je=t.experiment,Ke=t.isLastPivot,Qe=void 0!==Ke&&Ke,Ge=t.hasAnimation,Ye=void 0!==Ge&&Ge,Ze=t.hidesMenuChevron,et=void 0!==Ze&&Ze,tt=t.children,nt=void 0===tt?r.observables.createArray():tt,rt=t.isStrong,it=void 0===rt?r.createObservable(!1):rt,st=t.hasDeferredChildren,ot=void 0!==st&&st,ut=t.hasDynamicText,at=void 0!==ut&&ut,ft=t.reportClickingTime,lt=t.beakColor,ct=void 0===lt?A.e.white:lt,ht=t.isContentType,pt=t.overrideTabIndex;r.text=r.wrapObservable(N);r.automateExperimentText=r.wrapObservable(C);r.subtext=r.wrapObservable(_);r.commandClass=r.wrapObservable(P);r.collapsedText=B;0;r.isLabelVisible=2===q?w.showLabels:f.create(1===q);r.isToggleable=ie;r.location=F;r.isPermanent=r.wrapObservable(xe);r.requiredChildren=ke;r.collapseSingleChildCommands=Ae;r.hasLineBreakAfter=r.wrapObservable(De);r.hasLineBreakBefore=r.wrapObservable(Me);r.action=Pe;r.ariaControls=Y;r.ariaExpanded=Z;r.ariaHasPopup=ee;r.callback=He;r.onCoachmarkOpen=Be;r.hidesMenuChevron=et;r.isStrong=it;r.isClipped=r.createObservable(!1);r.hasDynamicText=at;r._reportClickingTime=ft;r.beakColor=ct;r.isContentType=ht;r._engagement=g;r.action&&r.action.inputType?r.inputType=r.createPureComputed(r._computeInputType):r.inputType=r.createObservable(x.e.none);r._initializeIcons($,J,Q,Ee,G);r.tooltip=r.wrapObservable(ce);r.accessibleLabel=r.wrapObservable(pe);r.prependTextToAccessibleLabel=ve;r.sectionAccessibleLabel=r.wrapObservable(ge);r.role=be||(ie?"menuitemcheckbox":"menuitem");we&&(r.teachingBubble=r.wrapObservable(we));ue&&(r.isDisabled=ue);r.isInvisibleWhenDisabled=fe;r._isHidden=r.wrapObservable(oe);r.bounds=r.createObservable();r.measurementReady=function(e){r.onMeasurementReady(e)};r.payload=ze;r.enableRecoverFocusBinding=Xe;r.keys=ne;r.children=nt instanceof Array?r.observables.createArray(nt):nt;r.addDisposable(r.children.map({mappingWithDisposeCallback:function(e){e.parentCommand=r;return{mappedValue:e,dispose:function(){e.parentCommand=null}}}}));r.visibleChildren=r.addDisposable(r.children.filter(function(e){return e.isVisible()}));r.hasDeferredChildren=ot;r.isToggled=r.createComputed(r._computeIsToggled);r.hasAnimation=Ye;r.isVisible=r.createComputed(r._computeIsVisible);r.state=r.wrapObservable(Ne);r.isCurrentView=U;r.isLastPivot=Qe;r.isCollapsed=r.createComputed(function(){return r.collapseSingleChildCommands&&1===r.visibleChildren().length});r.menuAlignment=r.wrapObservable(Fe);r.menuOffset=r.wrapObservable(qe);r.isMenuBeakVisible=r.wrapObservable(Ue);r.targetCommand=r.createComputed(function(){if(r.isCollapsed()){return r.visibleChildren()[0]}return r});r.label=r.createComputed(r._computeLabel);r.computedAccessibleLabel=r.createPureComputed(function(){return r._computeAccessibleLabel()});r.hasIconOnly=r.wrapObservable(W);r.positionIconRight=V;r.isOpen=r.createComputed({read:function(){return r._isOpenRequested()&&(r.visibleChildren().length>0||!(!r.payload||!r.payload.control()))},write:function(e){r._isOpenRequested(e)},pure:!0});r.subscribe(r.isOpen,function(e){e||r.children().forEach(function(e){e.children().length>0&&e.isOpen(!1)})});var dt=r.addDisposable(r.visibleChildren.filter(function(e){return e.isOpen()})),vt=r.createComputed(function(){return dt().length>0});r.subscribe(vt,function(e){e||r.async.setImmediate(function(){document.activeElement&&document.activeElement!==document.body||r.focused(!0)})});r.tabindex=r.createObservable(0);r.createComputed(function(){if(!r.isOpen()&&r.focused()){r.tabindex(0);r.isActive(!0)}else r.isActive()||r.tabindex(pt?0:-1)});r.isDisabled||(r.isDisabled=r.createComputed(function(){return r.targetCommand()!==r?r.targetCommand().isDisabled():r.requiredChildren>0?r.visibleChildren().length<r.requiredChildren:!(r.visibleChildren().length||r.action&&(r.action.isAvailable()||r.isToggleable&&r.action.isToggled())||r.callback)}));r.layoutChanged=r.createObservable();r.createComputed(function(){r.isLabelVisible();r.text();r.layoutChanged.notifySubscribers()});r.engagementName=Ve;r.source=r.wrapObservable($e);r.experiment=Je;return r}t.prototype.getKey=function(){return this.id};t.prototype.hasVisibleChildren=function(){return this.visibleChildren().length>0};t.prototype.hasVisibleOrDeferredChildren=function(){return this.hasVisibleChildren()||this.hasDeferredChildren};t.prototype.onMeasurementReady=function(e){this.bounds(e)};t.prototype.onClick=function(e,t){var n,s=this,o=t&&t.type||"unknown",u=["CommandView",w.t(o)],a=!1;this._reportClickingTime&&this._reportClickingTime();if((0===this.location||this.isVisible.peek())&&!this.isDisabled.peek()){var f=this.isCollapsed.peek()?this.visibleChildren.peek()[0]:this,l=f.visibleChildren.peek().length&&(f.icon||f.text),c=f.action&&f.action.isAvailable.peek(),h=e.engagementName,p=e.source;if(h){u=[h,w.e];p&&p.peek()&&(u[0]+=p.peek());n=u.join(".")}else if(l){var d=f.icon&&f.icon.peek(),v=d?d.toString():f.visibleChildren.peek()[0]&&f.visibleChildren.peek()[0].engagementName?f.visibleChildren.peek()[0].engagementName:"Unknown";u.splice(1,0,"Parent"+w.t(v));n=u.join(".")}else if(c){u.splice(1,0,w.t(f.action.name));n=u.join(".")}f.payload&&f.payload.control.peek()&&f.isOpen.peek()&&f.isOpen(!1);if(n){var m=this._engagement,g={name:n,isIntentional:!0,experiment:e.experiment,extraData:Object(r.__assign)({action:w.t(o)},C.getLoggingContextData(this.resources))};m?m.logData(g):y.e.logData(g)}if(l){f.closeSiblingCommands();f.parentCommand?f.isOpen(!0):f.isOpen(!f.isOpen.peek());f.isOpen.peek()&&f.focused(!0);f.callback&&f.callback();a=!0}else if(c){if(!e.isDisabled||!e.isDisabled.peek()){if(f.fileInputElement.peek()&&f.action.isAvailable.peek()){f.fileInputElement.peek().click()}else{this.state(i.e.executed);f.action.execute(t).done(function(){s.state(i.e.initialized)},function(e){s.state(i.e.failed)})}"MoveCopy"===f.action.name&&e.isDisabled(!0)}a=!0}else if(f.callback){f.callback();a=!0}}this.isDisabled.peek()&&t.preventDefault();a&&t&&t.stopPropagation();return!a};t.prototype.onDismiss=function(){var e=this.visibleChildren.peek();(this.payload&&this.payload.control.peek()||e&&e.length)&&this.isOpen(!1)};t.prototype.onInputChange=function(e){var t=this.targetCommand();if(t&&t.action){t.action.execute(e);this.closeParentCommands()}};t.prototype.openMenu=function(){var e=this.visibleChildren();if(e&&e.length){this.isOpen(!0);return!0}return!1};t.prototype.getIcon=function(e){var t=e;this.icon&&this.icon()&&(t+=" "+this.icon().getClass());return t};t.prototype.getChevron=function(){var e=g.e.isRightToLeft?"ChevronLeft":"ChevronRight";return Object(O.C)(e)};t.prototype.getChevronDown=function(e){return Object(O.C)("ChevronDown")};t.prototype.closeParentCommands=function(){for(var e=this.parentCommand;e;){e.isOpen(!1);e=e.parentCommand}};t.prototype.closeSiblingCommands=function(){var e=this;this.parentCommand&&this.parentCommand.children().forEach(function(t){t!==e&&t.isOpen(!1)})};t.prototype._initializeIcons=function(e,t,n,r,i){var s=this,o=this.createPureComputed(function(){return s.isCollapsed()?s.targetCommand().icon():void 0}),u=this.createPureComputed(function(){return s.isCollapsed()?s.targetCommand().iconUrl():void 0}),a=this.wrapObservable(e);this.icon=this.createPureComputed(function(){if(s.isCollapsed()){var e=o();if(e)return e;if(u())return}return a()});var f=this.wrapObservable(t);this.iconUrl=this.createPureComputed(function(){if(s.isCollapsed()){if(o())return;return u()||f()}return f()});this.iconSize=this.wrapObservable(n);var l=this.wrapObservable(r);this.iconBadge=this.createPureComputed(function(){return s.isCollapsed()&&s.targetCommand().iconBadge()||l()});this.appIconName=i};t.prototype._computeIsToggled=function(){return this.isCurrentView?this.isCurrentView():!!this.action&&this.action.isToggled()};t.prototype._computeIsVisible=function(){return 0!==this.location&&(!this._isHidden()&&(this.requiredChildren>0?this.visibleChildren().length>=this.requiredChildren:!this.action||(this.isPermanent()||this.action.isAvailable()||this.isToggleable&&this.action.isToggled())))};t.prototype._computeLabel=function(){return this.isCollapsed()?this.targetCommand().collapsedText()||this.targetCommand().text():this.text()};t.prototype._computeAccessibleLabel=function(){var e,t=this.accessibleLabel(),n=this.sectionAccessibleLabel()||"",r=this.label(),i=t;e=i&&r&&i!==r&&this.prependTextToAccessibleLabel?r+". "+i:i||r||"";return n&&e?n+". "+e:e||n};t.prototype._computeInputType=function(){return this.action&&this.action.inputType&&this.action.inputType()||x.e.none};t.dependencies=Object(r.__assign)(Object(r.__assign)({},s.t.dependencies),{engagement:b.e,responsiveUI:L.t.optional});return t})(s.t);t.e=_},,function(e,t,n){"use strict";n.d(t,"i",function(){return a});n.d(t,"e",function(){return f});n.d(t,"t",function(){return l});n.d(t,"n",function(){return c});n.d(t,"r",function(){return h});n.d(t,"s",function(){return p});var r=n(22),i=n("react-lib"),s=n(1635),o=n(1654),u=n(1709);function a(e){var t,n,r;return!("UNVALIDATED_EMAIL_ADDRESS"!==(null===(r=null===(n=null===(t=e)||void 0===t?void 0:t.rawPersonData)||void 0===n?void 0:n.EntityData)||void 0===r?void 0:r.PrincipalType))}function f(e){return e&&0!==e.length?e.filter(function(e){return 1===e.entityType}).length:0}function l(e){return e&&0!==e.length?e.filter(function(e){return 4===e.entityType}).length:0}function c(e){var t=e.filter(function(e){return 1===e.entityType}),n=t.length,r=t.map(function(e){return e.name});if(2===n){var i=(s=r.join(", ")).lastIndexOf(",");return s.substring(0,i)+" "+o.k+" "+s.substring(i+1)+" "+o.br}if(n>2){var s;i=(s=r.join(", ")).lastIndexOf(",");return s.substring(0,i+1)+" "+o.k+" "+s.substring(i+1)+" "+o.br}return 1===n?r[0]+" "+o.wr:""}function h(e,t){var n=e.filter(function(e){return 2===e.entityType}).length,i="";1===n?i=o.dr:n>1&&(i=r.format(o.On,n));t>=1e3?i+=" "+o.Wt:t>=25&&(i+=" "+r.format(o.zt,t));return i}function p(e){for(var t,n,r,a,f,l=e.selectedItems,c=e.sharingLinkKind,h=e.canAddExternalPrincipal,p=e.sharingInformation,v=e.viewPolicyTipCallback,m=e.permissionsMap,g=i.createElement("div",null,i.createElement("span",null,o.Fi," "),i.createElement(s.e,{onClick:v},o.Yi)),y=p.item.hasDlpPolicy||p.sharingAbilities&&p.sharingAbilities.directSharingAbilities&&7===p.sharingAbilities.directSharingAbilities.canAddExternalPrincipal.disabledReason,b=0,w=l;b<w.length;b++){var E=w[b];if(!E.isResolved)return y&&!h?g:E.rawData?d(E.rawData,p.customizedExternalSharingServiceUrl):i.createElement("span",null,o.Hn);if(E.isExternal&&y&&!h)return g;if(E.isExternal&&!h&&!(t=E,n=void 0,r=void 0,a=void 0,f=void 0,(null===(n=t)||void 0===n?void 0:n.isExternal)&&"GUEST_USER"===(null===(f=null===(a=null===(r=t)||void 0===r?void 0:r.rawPersonData)||void 0===a?void 0:a.EntityData)||void 0===f?void 0:f.PrincipalType)))return i.createElement("span",null,o.ri);if(E.isExternal&&E.principalType===u.e.distributionList&&2===E.entityType)return i.createElement("span",null,o.ni);var S=3===c||2===c;if(E.isExternal&&S)return i.createElement("span",null,o.ti)}if(m&&1===c){var x=0;for(var T in m)1===m[T]&&x++;var N="";1===x?N=o.Kt:x>1&&(N=o.Qt);var C=e.onShareHintClick?i.createElement("a",{className:"od-Share-PeoplePicker-error-changeTypeLink",onClick:e.onShareHintClick,href:"javascript:void(0)"},o.ye):void 0;if(N)return i.createElement("div",null,i.createElement("span",null,N),C)}return p.peoplePickerError?i.createElement("span",null,p.peoplePickerError):null}function d(e,t){var n=e.EntityData&&e.EntityData.BlockingSharingPolicy||0;return 0===n?i.createElement("span",null,e.Description):n>=401&&n<=404?t?i.createElement("div",null,r.formatToArray(o.Et,n,i.createElement("a",{href:t,target:"_blank"},o.Bn))):i.createElement("span",null,r.format(o.wt,n)):n>=200&&n<=209||n>=301&&n<=305?t?i.createElement("div",null,r.formatToArray(o.xt,n,i.createElement("a",{href:t,target:"_blank"},o.Bn))):i.createElement("span",null,r.format(o.St,n)):void 0}},function(e,t,n){"use strict";var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.text=t.text;return n}return t})(n(1651).t),s=n(1652).e({tagName:"ms-text-container",template:'<div class="TextContainer" data-bind="text:text"></div>',viewModel:i});t.e=s},,function(e,t,n){"use strict";n.r(t);n.d(t,"focusFirstTabStop",function(){return i});n.d(t,"focusLastTabStop",function(){return s});n.d(t,"focusNextTabStop",function(){return o});n.d(t,"focusPreviousTabStop",function(){return u});n.d(t,"getFirstTabStop",function(){return a});n.d(t,"getLastTabStop",function(){return f});n.d(t,"getNextTabStop",function(){return l});n.d(t,"getPreviousTabStop",function(){return c});n.d(t,"isTabStop",function(){return h});var r=n(269);function i(e,t){p(e,a,t)}function s(e,t){p(e,f,t)}function o(e,t){p(e,l,t)}function u(e,t){p(e,c,t)}function a(e,t){return e&&g(e,t)}function f(e,t){return e&&y(e,t)}function l(e,t){return e&&(m(e.firstElementChild,d,g,t)||b(e,d,g,t))}function c(e,t){return e&&b(e,v,y,t)}function h(e,t){return!(!e||!E(e,t))}function p(e,t,n){var r=t(e,n);r&&r.focus()}function d(e){return e.nextElementSibling}function v(e){return e.previousElementSibling}function m(e,t,n,r){for(;e;e=t(e)){var i=n(e);if(i)return i}}function g(e,t){return E(e,t)||m(e.firstElementChild,d,g)}function y(e,t){return m(e.lastElementChild,v,y)||E(e,t)}function b(e,t,n,i){for(;e;e=Object(r.e)(e)){var s=m(t(e),t,n);if(s)return s}}var w={a:1,input:1,area:1,button:1,select:1,textarea:1,object:1};function E(e,t){var n=e.tagName.toLowerCase();if((n in w||void 0!==e.attributes.tabindex)&&(-1!==e.tabIndex||t)&&"true"!==e.getAttribute("aria-hidden")&&"none"!==e.style.display.toLowerCase()&&"hidden"!==e.style.visibility.toLowerCase()&&!(0===e.offsetWidth&&0===e.offsetHeight||e.disabled||"input"===n&&"hidden"===e.type.toLowerCase()))return e}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){return{clientId:e.clientId,scenarioId:e.scenarioId,correlationId:e.correlationId,hostOptions:e.hostOptions}}},function(e,t,n){"use strict";var r=n(715);n.d(t,"e",function(){return r.e});n.d(t,"t",function(){return r.t});n.d(t,"n",function(){return r.r})},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(1735),s=n(7),o=(function(){function e(e,t){this._componentType=e;this.dependencies=Object(r.__assign)(Object(r.__assign)({},e.dependencies||{}),t||{})}e.prototype.create=function(e){return{instance:Object(i.t)(this._componentType,e)}};return e})();(function(){function e(e,t){this._statelessComponent=e;this.dependencies=t}e.prototype.create=function(e){return{instance:Object(i.n)(this._statelessComponent,e)}}})();function u(e,t,n){return new s.t({name:e,factory:new o(t,n)})}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=n(4).e},function(e,t,n){"use strict";n.r(t);n.d(t,"OperationProvider",function(){return p});n.d(t,"resourceKey",function(){return d});var r=n(0),i=n(1649),s=n(1686),o=n(1754),u=n(1692),a=n(1847),f=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{})||this,i=n.observables;n.name=t.name;n.iconName=t.iconName;n.state=i.create(s.e.created);n.warning=i.create("");n.error=i.create();n.count=i.create(1);var a=Object(r.__assign)({minimum:0,maximum:0,current:0},t.progress||{});n.progress={minimum:i.create(a.minimum),maximum:i.create(a.maximum),current:i.create(a.current)};n.type=i.create(t.type||u.e.multiple);n.batch=t.batch||new o.e;n._initializeActions(t.actions);n.payloads=i.create(t.payloads||{});n.visibility=i.create(t.visibility||0);return n}t.prototype.dispose=function(){this.actions({});this.payloads({});e.prototype.dispose.call(this)};t.prototype._initializeActions=function(e){void 0===e&&(e={});var t={};for(var n in e){var r=e[n];t[n]=this.scope.attach(new a.e({key:n,operation:this,isAvailable:r.isAvailable,onExecute:r.execute}))}this.actions=this.observables.create(t)};return t})(i.n),l=n(1942),c=n(1848),h=n(11),p=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this,i=r.observables,s=new o.e;r._observers=i.createArray();var u=r.operations=i.createArray(),a=r.scope.attached(l.e),f=r.groups=r.addDisposable(c.e.group(u,function(e){return e.batch}).map({mappingWithDisposeCallback:function(e){var t=new a({batch:e.key,operations:e.values});return{mappedValue:t,dispose:function(){t.dispose()}}}}));r.overall=new(r.managed(l.e))({batch:s,operations:f});r.isLocked=r.createPureComputed(r._computeIsLocked);r.createBackgroundComputed(r._computeRemoveAllWhenUnlocked).extend({deferred:!0});return r}t.prototype.lock=function(){var e=this,t={};this._observers.push(t);return{dispose:function(){e._observers.remove(t)}}};t.prototype.register=function(e){var t=new f(e);2!==t.visibility.peek()&&this.operations.push(t);return t};t.prototype.deleteGroupOperation=function(e){var t=Object(r.__spreadArrays)(e.operations.peek());this.operations.removeAll(t);t.forEach(function(e){e.dispose()})};t.prototype.cleanup=function(e){void 0===e&&(e=!1);for(var t=[],n=0,r=this.groups.peek();n<r.length;n++){var i=r[n],o=i.state.peek();if(o===s.e.completed||!e&&(o===s.e.expired||o===s.e.canceled||o===s.e.failed))for(var u=i.operations.peek(),a=void 0,f=0;f<u.length;f++){a=!0;var l=u[f];if(o===s.e.failed&&l.actions)for(var c=l.actions.peek(),h=Object.keys(c),p=0;p<h.length;p++)if("cancel"!==h[p]&&c[h[p]].isAvailable.peek()){a=!1;break}a&&t.push(u[f])}}this.operations.removeAll(t);t.forEach(function(e){e.dispose()})};t.prototype._computeRemoveAllWhenUnlocked=function(){this.isLocked()||this.cleanup()};t.prototype._computeIsLocked=function(){return this._observers().length>0};return t})(i.n),d=Object(h.s)("OperationProvider",p);t.default=p},,function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});n.d(t,"n",function(){return a});var r=n(0),i=n("react-lib"),s=n("prop-types-lib"),o={dependencies:s.object.isRequired};function u(e,t){var n=e,s={dependencies:Object(r.__assign)({},t||{})};return(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getChildContext=function(){return s};t.prototype.render=function(){return i.createElement(n,Object(r.__assign)({},this.props))};t.childContextTypes=Object(r.__assign)({},o);return t})(i.Component)}function a(e,t){var n=e.contextTypes,i=void 0===n?{}:n,s=(i.dependencies,Object(r.__rest)(i,["dependencies"])),o=function(n,i){return e(n,Object(r.__assign)(Object(r.__assign)({},i),{dependencies:t}))};o.contextTypes=s;return o}},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.info=0]="info";e[e.error=1]="error";e[e.blocked=2]="blocked";e[e.severeWarning=3]="severeWarning";e[e.success=4]="success";e[e.warning=5]="warning"})(r||(r={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=(function(){function e(e){this._cachedRect={width:0,height:0,top:0,left:0,bottom:0,right:0};this._resizeCallback=e;this._callbackDelayMilliseconds=20}e.prototype.checkSizeChangeForRef=function(e){e&&e.current&&this.checkSizeChange(e.current)};e.prototype.checkSizeChange=function(e){var t=this;if(e&&this._resizeCallback){var n=e.getBoundingClientRect();this._cachedRect.width===n.width&&this._cachedRect.height===n.height&&this._cachedRect.top===n.top&&this._cachedRect.right===n.right&&this._cachedRect.left===n.left&&this._cachedRect.bottom===n.bottom||(this._callbackDelayMilliseconds?setTimeout(function(){t._resizeCallback()},this._callbackDelayMilliseconds):this._resizeCallback());this._cachedRect=n}};return e})()},function(e,t,n){"use strict";n.d(t,"e",function(){return h});var r=n(1419),i=n(4),s=n("react-lib"),o=n(472),u=n(886),a=Object(o.e)(),f=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;Object(u.e)(n);return n}t.prototype.render=function(){var e=this.props,t=e.className,n=e.styles,r=e.theme;this._classNames=a(n,{theme:r,className:t});return s.createElement("div",{className:this._classNames.actions},s.createElement("div",{className:this._classNames.actionsRight},this._renderChildrenAsActions()))};t.prototype._renderChildrenAsActions=function(){var e=this;return s.Children.map(this.props.children,function(t){return t?s.createElement("span",{className:e._classNames.action},t):null})};return t})(s.Component),l=n(25),c={actions:"ms-Dialog-actions",action:"ms-Dialog-action",actionsRight:"ms-Dialog-actionsRight"},h=Object(r.e)(f,function(e){var t=e.className,n=e.theme,r=Object(l.x)(c,n);return{actions:[r.actions,{position:"relative",width:"100%",minHeight:"24px",lineHeight:"24px",margin:"16px 0 0",fontSize:"0",selectors:{".ms-Button":{lineHeight:"normal"}}},t],action:[r.action,{margin:"0 4px"}],actionsRight:[r.actionsRight,{textAlign:"right",marginRight:"-4px",fontSize:"0"}]}},void 0,{scope:"DialogFooter"})},,function(e,t,n){"use strict";n.d(t,"e",function(){return l});n.d(t,"t",function(){return h});var r=n(52),i=n(109),s=n(48),o=n(1430),u=n(103),a=n(63),f=n(471),l="https://outlook.office.com/search",c={ODB:1286},h=(function(){function e(e,t){this._dataRequestor=new o.e({},{});this._pageContext=t.pageContext;this._oAuthTokenProvider=t.oAuthTokenProvider;this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._substrateToken=this._sharingContextInformation.additionalTokens.substrateToken);this.initializeDataStore()}e.prototype.canUseSubstrate=function(){if(this._substrateToken)return!0;var e=!1;if(this._pageContext&&!this._pageContext.isSPO)return e;if(this._pageContext&&this._pageContext.authToken)return e;this._pageContext&&this._oAuthTokenProvider&&f.n.isFeatureEnabled(c)&&(e=!0);this._dataStore&&(e=e&&!this._dataStore.getValue("DisableSubstrateSearch",a.e.session));return e};e.prototype.disableSubstrateCallsForPicker=function(){this.initializeDataStore();this._dataStore.setValue("DisableSubstrateSearch",!0,a.e.session)};e.prototype.getSubstrateToken=function(){var e=this;if(this._substrateToken)return r.n.resolve(this._substrateToken);if(this._oAuthTokenProvider){var t=new i.e({name:"PeoplePicker.GetSubstrateToken"});return this._oAuthTokenProvider.getToken(l).then(function(e){t.end({resultType:s.e.Success});return e},function(n){if(r.n.isCanceled(n)){t.end({resultType:s.e.ExpectedFailure,resultCode:"Canceled"});return r.n.reject(n)}t.end({resultCode:"PeoplePicker.GetSubstrateTokenError",resultType:s.e.Failure,extraData:{serverErrorCode:n._serverErrorCode,message:n.message}});e.disableSubstrateCallsForPicker();return null})}return null};e.prototype.init=function(e){var t=l+"/api/v1/init?scenario=documentshare";this._dataRequestor.send({apiName:"Substrate.PeopleSearch.Init",path:t,headers:{Authorization:"Bearer "+e},needsAuthorization:!1})};e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new u.e("PeoplePicker",a.e.session))};return e})()},function(e,t,n){"use strict";var r=n(0),i=n(1728),s=n(1650),o=n(269),u=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=n.valueAccessor(),i=n.wrapObservable(void 0===r||r);n._shouldRestoreFocus=i;var s=null;try{s=document.activeElement}catch(e){}n._activeElement=s;n._preserveActiveElementAncestors=[];for(;s&&s!==document.body;){n._preserveActiveElementAncestors.push(s);s=Object(o.e)(s)}return n}t.prototype.dispose=function(){if(this._shouldRestoreFocus.peek()){var t=null;try{t=document.activeElement}catch(e){}if(!t||t===document.body||this._isAncestorOrSelf(t,this.element))for(var n=0,r=this._preserveActiveElementAncestors;n<r.length;n++){var s=r[n];if(s&&s.focus&&(Object(i.isTabStop)(s,!0)||s===this._activeElement)&&document.body.contains(s)){s.focus();break}}}this._preserveActiveElementAncestors=[];delete this._activeElement;e.prototype.dispose.call(this)};t.prototype._isAncestorOrSelf=function(e,t){for(;e;){if(e===t)return!0;e=Object(o.e)(e)}return!1};return t})(s.t);t.e=u},function(e,t,n){"use strict";n.d(t,"t",function(){return s});var r=n(1723);n.d(t,"e",function(){return r.e});var i=n(11),s=Object(i.o)("Command",r.e)},function(e,t,n){"use strict";var r=n(138);Object(r.n)([{rawString:".od-LoadingSpinner{white-space:nowrap}.od-LoadingSpinner-loadingText{vertical-align:top}.od-LoadingSpinner-loadingGif{vertical-align:bottom}"}]);var i=n(0),s=n("knockout-lib"),o=n(1651),u=n(1707),a=n(1815),f=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;t&&void 0!==t.loadingText?n.loadingText=t.loadingText:n.loadingText=a.e;n.addBindingHandlers({imageLoader:u.e});n.isVisible=s.observable(!0);n.isImageLoaded=s.observable(!1);n.loadingImageUrl=window.require.toUrl("odsp-media/images/loading/loadingspinner.gif");return n}t.prototype.hideSpinner=function(){this.isVisible(!1)};return t})(o.t),l=n(1652).e({tagName:"ms-loadingSpinner",template:'<div class="od-LoadingSpinner" data-automationid="ms-loadingSpinner"><img class="od-LoadingSpinner-loadingGif" role="presentation" data-bind="click:hideSpinner,visible:isVisible,imageLoader:{src:loadingImageUrl,isLoaded:isImageLoaded}"><span class="od-LoadingSpinner-loadingText" data-bind="text:loadingText"></span></div>',viewModel:f,synchronous:!0});t.e=l},function(e,t,n){"use strict";n.d(t,"e",function(){return g});var r=n(0),i=n(138);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareHeader{-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding:4px;border-bottom-style:solid;border-bottom-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-bottom-width:1px}.isFluent .od-ShareHeader{padding:16px 16px 12px;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;border-bottom-width:0}[dir='ltr'] .isFluent .od-ShareHeader.od-ShareHeader-withBackButton{padding-left:48px}[dir='rtl'] .isFluent .od-ShareHeader.od-ShareHeader-withBackButton{padding-right:48px}.od-ShareHeader-linkSettings{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";display:-webkit-box;display:-ms-flexbox;display:flex;padding:0;margin-bottom:5px;font-size:1.125rem;font-weight:700}[dir='ltr'] .od-ShareHeader-linkSettings{margin-left:20px}[dir='rtl'] .od-ShareHeader-linkSettings{margin-right:20px}.teams .od-ShareHeader-linkSettings{font-weight:700;margin-top:32px}.od-ShareHeader-backgroundColor{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}.isFluent .od-ShareHeader-backgroundColor{background-color:transparent}.teams .od-ShareHeader-backgroundColor{background-color:transparent}.od-ShareHeader-moreContextualMenu .is-open{border:none;width:auto}.od-ShareHeader-buttons-left{padding-top:16px;position:absolute;top:0}[dir='ltr'] .od-ShareHeader-buttons-left{padding-left:8px}[dir='rtl'] .od-ShareHeader-buttons-left{padding-right:8px}[dir='ltr'] .od-ShareHeader-buttons-left{left:0}[dir='rtl'] .od-ShareHeader-buttons-left{right:0}.od-ShareHeader-buttons-left.od-ShareHeader-buttons-fabric{padding-top:8px}.od-ShareHeader-buttons-right{padding-top:16px;position:absolute;top:0}[dir='ltr'] .od-ShareHeader-buttons-right{padding-right:8px}[dir='rtl'] .od-ShareHeader-buttons-right{padding-left:8px}[dir='ltr'] .od-ShareHeader-buttons-right{right:0}[dir='rtl'] .od-ShareHeader-buttons-right{left:0}.od-ShareHeader-buttons-right.od-ShareHeader-buttons-fabric{padding-top:8px}.od-ShareHeader-buttons-right-wac{padding-top:8px;position:absolute;top:0}[dir='ltr'] .od-ShareHeader-buttons-right-wac{padding-right:8px}[dir='rtl'] .od-ShareHeader-buttons-right-wac{padding-left:8px}[dir='ltr'] .od-ShareHeader-buttons-right-wac{right:0}[dir='rtl'] .od-ShareHeader-buttons-right-wac{left:0}.od-ShareHeader-moreOptionsIcon{font-size:1rem}.od-ShareHeader-closeButtonIcon{font-size:1rem}.od-ShareHeader-button{z-index:10}.od-ShareHeader-button:not(.od-ShareHeader-button-fabric){outline:transparent;position:relative;background:none;border:none;padding:0px;width:1.875rem;cursor:pointer;font:-apple-system-body}.od-ShareHeader-button:not(.od-ShareHeader-button-fabric)::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareHeader-button:not(.od-ShareHeader-button-fabric):focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ShareHeader-button:not(.od-ShareHeader-button-fabric):focus:after{border-color:ActiveBorder}}.od-ShareHeader-button.od-ShareHeader-button-fabric{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:1rem;width:1.875rem;height:1.875rem}.od-ShareHeader-title{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.isFluent .od-ShareHeader-title{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.od-ShareHeader-viewName{font-size:1.125rem;font-weight:400;font:-apple-system-headline;margin:0px 2rem 0px 2rem}[dir='rtl'] .od-ShareHeader-viewName{margin:0px 2rem 0px 2rem}.isFluent .od-ShareHeader-viewName{margin:0px 2rem 0px 0px;font-size:1.25rem;font-weight:600;margin-bottom:4px}[dir='rtl'] .isFluent .od-ShareHeader-viewName{margin:0px 0px 0px 2rem}.od-ShareHeader-itemName{font-size:.625rem;font-weight:400;text-align:initial;width:100%;font:-apple-system-caption2}.isFluent .od-ShareHeader-itemName{font-size:.75rem}@media screen and (-ms-high-contrast: active){.od-Share .od-ShareHeader-button{outline:1px solid "},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}}.od-ShareHeader-button:focus,.od-ShareHeader-button:hover{outline:1px solid black}@media (forced-colors: active) and (prefers-color-scheme: dark){.od-ShareHeader-closeButtonIcon:hover,.od-ShareHeader-closeButtonIcon:focus{color:white}}@media (forced-colors: active) and (prefers-color-scheme: light){.od-ShareHeader-closeButtonIcon:hover,.od-ShareHeader-closeButtonIcon:focus{color:black}}\n"}]);var s=n(1508),o=n(1552),u=n(2367),a=n("react-lib"),f=n("prop-types-lib"),l=n(22),c=n(1667),h=n(1665),p=n(1654),d=n(97),v=n(1753),m=n(1688),g=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._closeButtonRef=Object(a.createRef)();r._dismissComponent=function(e){e.stopPropagation();e.preventDefault();r._onDismiss()};r.state={showContextualMenu:!1,target:null};r._onDismiss=n.onDismiss;r._platformDetection=n.platformDetection;r._store=n.sharingStore;r._onDismissMoreContextualMenu=r._onDismissMoreContextualMenu.bind(r);r._onManageExistingAccessClick=r._onManageExistingAccessClick.bind(r);r._onMoreClick=r._onMoreClick.bind(r);return r}t.prototype.render=function(){var e,t=this.props,n=this.props.mode!==u.e.manageAccess||m.e()?"od-ShareHeader-buttons-right":"od-ShareHeader-buttons-right-wac";if(t.mode===u.e.linkSettings||t.mode===u.e.manageAccess&&!m.e())return a.createElement("h3",{className:"od-ShareHeader-linkSettings"},this._getViewName(),a.createElement("div",{className:n},this._renderCloseButton()));var r=4===t.viewState||7===t.viewState||9===t.viewState,i=(c.s(this.props.clientId)||this._platformDetection.isMobile,r?"":" od-ShareHeader-backgroundColor"),s=this.props.hasBackButton?" od-ShareHeader-withBackButton":"",o=this.props.title||(null===(e=this.props.hostOptions)||void 0===e?void 0:e.customHeaderString)||this._getViewName(),f=r?"":a.createElement("div",{className:"od-ShareHeader"+i+s},a.createElement("div",{className:"od-ShareHeader-title"},a.createElement("h1",{className:"od-ShareHeader-viewName",id:"od-shareHeader-viewTitle"},o),this._renderItemName()));return a.createElement("div",null,f,this._renderRightHeaderButtons(!1,r,t.viewState),this._renderContextualMenu())};t.prototype._renderMoreButton=function(){if(!(0!==this.props.viewState&&10!==this.props.viewState||this.props.hideShareDialogOverflowButton||this._store.isBundleShare())){var e={items:[{key:"manageaccess",text:p.yn,ariaLabel:p.yn,onClick:this._onManageExistingAccessClick}]},t=a.createElement(s.e,{className:"od-ShareHeader-button od-ShareHeader-button-fabric",ariaLabel:p.An,menuIconProps:{iconName:"More",className:"od-ShareHeader-moreOptionsIcon"},menuProps:e});return this._platformDetection.isMobile?t:v.t(t,p.An,{position:d.e.bottomRightEdge})}};t.prototype._renderCloseButton=function(){var e,t,n,r=null!=(n=null===(t=null===(e=this.props)||void 0===e?void 0:e.hostOptions)||void 0===t?void 0:t.showCloseButton)?n:c.v(this.props.clientId);if(this._onDismiss&&r){var i=a.createElement(s.e,{componentRef:this._closeButtonRef,className:"od-ShareHeader-button od-ShareHeader-button-fabric","aria-label":p.Se,onClick:this._dismissComponent,iconProps:{iconName:"Cancel",className:"od-ShareHeader-closeButtonIcon"}});return this._platformDetection.isMobile?i:v.t(i,p.Se,{position:d.e.bottomRightEdge})}};t.prototype._renderRightHeaderButtons=function(e,t,n){var r="od-ShareHeader-buttons-right od-ShareHeader-buttons-fabric";return e&&!t&&0===n?a.createElement("div",{className:r},this._renderMoreButton()):e&&(t||0!==n)?"":a.createElement("div",{className:r},this._renderMoreButton(),this._renderCloseButton())};t.prototype._renderItemName=function(){var e=this.props.item;if(e){var t=e.childCount>1?" ("+l.format(p.Pt,e.childCount)+")":"";return a.createElement("div",{className:"od-ShareHeader-itemName"},h._(e.name+" "+t))}};t.prototype._renderContextualMenu=function(){var e=[];e.push({key:"editable",name:p.yn,onClick:this._onManageExistingAccessClick});if(this.state.showContextualMenu)return a.createElement(o.e,{ariaLabel:p.An,className:"od-ShareHeader-moreContextualMenu",items:e,onDismiss:this._onDismissMoreContextualMenu,target:this.state.target,isBeakVisible:!0})};t.prototype._onMoreClick=function(e){this.setState({showContextualMenu:!this.state.showContextualMenu,target:e.nativeEvent.target})};t.prototype._onDismissMoreContextualMenu=function(){this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{showContextualMenu:!1}))};t.prototype._onManageExistingAccessClick=function(){this.props.onManageExistingAccessClick&&this.props.onManageExistingAccessClick()};t.prototype._getViewName=function(){switch(this.props.viewState){case 0:return p._s;case 2:return p.Nn;case 12:return p.Cn;case 3:return p.yn;case 6:return p.Ni;case 5:return p.Rt;case 10:return p.y;default:return p._s}};t.prototype.focusCloseButton=function(){if(this._closeButtonRef.current){this._closeButtonRef.current.focus();this.props.closeButtonOnFocus&&this.props.closeButtonOnFocus()}};t.contextTypes={onDismiss:f.func,platformDetection:f.object.isRequired,sharingStore:f.object.isRequired};return t})(a.Component)},function(e,t,n){"use strict";var r=n(52),i=n(197),s=(function(){function e(e){this.concurrency=e||1;this._running=0;this._queue=[];this._promiseComplete=this._promiseComplete.bind(this)}e.prototype.enqueue=function(e){var t;if(this._running<this.concurrency){this._running++;(t=e()).then(this._promiseComplete,this._promiseComplete)}else{var n={callback:e,signal:null,canceled:!1,result:null};n.signal=new i.e(function(){n.canceled=!0;r.n.is(n.result)&&n.result.cancel()});this._queue.push(n);t=n.signal.getPromise()}return r.n.resolve(t)};e.prototype._promiseComplete=function(){var e=this;this._running--;if(this._running<this.concurrency&&this._queue.length){for(var t=this._queue.shift();t&&t.canceled;)t=this._queue.length?this._queue.shift():null;if(t){this._running++;t.result=t.callback();t.result.then(function(n){t.signal.complete(n);e._promiseComplete()},function(n){t.signal.error(n);e._promiseComplete()})}}};return e})();t.e=s},function(e,t,n){"use strict";n.d(t,"n",function(){return p});n.d(t,"r",function(){return d});n.d(t,"s",function(){return v});n.d(t,"u",function(){return m});n.d(t,"t",function(){return g});n.d(t,"e",function(){return y});n.d(t,"o",function(){return b});n.d(t,"a",function(){return w});n.d(t,"i",function(){return E});var r=n(2298),i=n(2367),s=n(249),o=n(1679),u=n(1021),a=n(2429),f=n(1771),l=n(1665),c={ODB:772},h={ODB:1935};function p(e){return"anyoneLinkAbilities"===e||"anonymousLinkAbilities"===e?r.e.anyone:"organizationLinkAbilities"===e?r.e.organization:"peopleSharingLinkAbilities"===e?r.e.specificPeopleFlex:void 0}function d(e,t){return e===r.e.anyone?t.anyoneLinkAbilities?t.anyoneLinkAbilities:t.anonymousLinkAbilities:e===r.e.organization?t.organizationLinkAbilities:e===r.e.specificPeopleFlex||e===r.e.customLabeledSpecificPeople?t.peopleSharingLinkAbilities:t.directSharingAbilities}function v(e,t){var n,r,i=d(e,t);return(null===(n=i)||void 0===n?void 0:n.canManageEditLink)?i.canManageEditLink.enabled:!!(null===(r=i)||void 0===r?void 0:r.canAddInternalPrincipal)&&i.canAddInternalPrincipal.enabled}function m(e,t,n){var r,i;if(s.e.isFeatureEnabled(c)&&!o.t[n]){var u=d(e,t);return(null===(r=u)||void 0===r?void 0:r.canManageReviewLink)?u.canManageReviewLink.enabled:!!(null===(i=u)||void 0===i?void 0:i.supportsReviewPermission)&&u.supportsReviewPermission.enabled}return!1}function g(e){var t=e.sharingInformation,n=e.audience,s=e.mode,o=!1,u=!1,c=!1,h=!1;if(!Object(l.L)(t)){o=t.sharedObjectType===f.e.list;u=(function(e){var t,n=e.audience,i=e.sharingAbilities,s=e.sharingRole,o=d(n,i);return(null===(t=o)||void 0===t?void 0:t.canManageManageListLink)?o.canManageManageListLink.enabled:n===r.e.existing&&(s===a.e.manageList||s===a.e.owner)})({audience:n,sharingAbilities:t.sharingAbilities,sharingRole:t.userRole});h=m(n,t.sharingAbilities,t.fileExtension);c=v(n,t.sharingAbilities)}return{fullControl:{enabled:!1,shouldDisplay:!1},manageList:{enabled:u,shouldDisplay:o},review:{enabled:h,shouldDisplay:h},edit:{enabled:s===i.e.addPeople||s===i.e.manageAccess||c,shouldDisplay:!0},view:{enabled:!0,shouldDisplay:!0}}}function y(e){var t=e.sharingInformation,n=!1,r=!1,i=!1;if(!Object(l.L)(t)){n=t.sharedObjectType===f.e.list;r=(function(e){var t=e.sharingRole;return t===a.e.manageList||t===a.e.owner})({sharingRole:t.userRole});i=(function(e,t){var n=e.sharedObjectType===f.e.list;return t&&n&&e.userRole===a.e.owner})(t,!0)}return{fullControl:{enabled:i,shouldDisplay:i},manageList:{enabled:r,shouldDisplay:n},review:{enabled:!1,shouldDisplay:!1},edit:{enabled:!0,shouldDisplay:!0},view:{enabled:!0,shouldDisplay:!0}}}function b(e,t,n){if(o.u===o.t[n]){var r=d(e,t);return r.canManageReviewLink?r.canManageReviewLink.enabled:!!r.supportsReviewPermission&&r.supportsReviewPermission.enabled}return!1}function w(e,t){var n=d(e,t);return!!n.supportsRestrictedView&&n.supportsRestrictedView.enabled}function E(e,t){var n=[],r=new u.t({name:"RedeemedUserShareUI",startDate:"05/05/2020",version:u.e.v2});if(s.e.isFeatureEnabled(h)&&r.IsExperimentOn())for(var i=0,o=t;i<o.length;i++){var a=o[i];if(a.linkDetails&&a.linkDetails.shareId){var f=d(a.linkDetails.audience,e);if(!(!!f.canManageEditLink&&f.canManageEditLink.enabled||!!f.canManageReviewLink&&f.canManageReviewLink.enabled||!!f.canManageReadLink&&f.canManageReadLink.enabled)){!!(a.linkDetails.expiration&&a.linkDetails.expiration<new Date(Date.now()))||n.push(a.linkDetails)}}}return n}},function(e,t,n){"use strict";var r,i=n(0),s=(function(){function e(){}e.tokenCacheSessionStorageId="tokenCache";e.aboutToExpireIntervalSeconds=600;e.apiUrl="/_api/SP.OAuth.Token/Acquire";e.retries=3;e.retriableErrorCodes=[10006,10008];e.unexpectedErrorCodeFormat="Expected error code format is <numericCode>, <exception class name>";e.unexpectedTokenMessageFormat="Your token request succeedeed but the token could not be parsed from the response.This is most probably caused by a change in the server response format";e.npmPackageVersion="0.1.5";return e})();(function(e){e[e.unknownError=0]="unknownError";e[e.malformedResponseBody=1]="malformedResponseBody";e[e.serverError=2]="serverError"})(r||(r={}));var o=(function(e){Object(i.__extends)(t,e);function t(n,r){var i=e.call(this,r.message)||this;i.__proto__=t.prototype;i._type=n;i._httpResponseStatus=r.httpResponseStatus;i._cultureName=r.cultureName;i._message=r.message;i._serverErrorCode=r.serverErrorCode;i._correlationId=r.correlationId;i._redirectUrl=r.redirectUrl;return i}Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"serverErrorCode",{get:function(){if(this.type!==r.serverError)throw new Error("ServerErrorCode can only be obtained for errors of type serverError");return this._serverErrorCode},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"httpResponseStatus",{get:function(){return this._httpResponseStatus},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"message",{get:function(){return this._message},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"cultureName",{get:function(){return this._cultureName},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"correlationId",{get:function(){return this._correlationId},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"redirectUrl",{get:function(){return this._redirectUrl},enumerable:!0,configurable:!0});return t})(Error),u=(function(){function e(e){var t=this;this._context=e;this._dispose=this._dispose.bind(this);window.addEventListener("unload",this._dispose);window._spPageOnMediaTokenReceived=function(){t._receiveMediaServiceFlushedToken()};window._spMSBTLoaded=function(){t._receiveMediaServiceFlushedToken()}}e._getCorrelationId=function(e){return e.headers.get("sprequestguid")};e._extractRealError=function(e){return e.hasOwnProperty("error")?e.error:e};e.prototype.getOAuthToken=function(e,t){return this.getInstrumentedOAuthToken(e,t).then(function(e){if(e)return e.tokenInfo})};e.prototype.getInstrumentedOAuthToken=function(e,t){var n=this;this._receiveMediaServiceFlushedToken();var r=this._getCachedTokenData(e);if(r&&!this._isExpiring(r)){var i={token:r.accessToken,isGuest:!1,expirationTimeMs:r.expiresOn};return Promise.resolve({tokenInfo:i,spRequestId:r.correlationId,spRequestTimestamp:r.requestTimestamp})}return this._retriableFetchWithDigest(e,s.retries,t).then(function(t){n._storeTokenData(e,t);return{tokenInfo:{token:t.accessToken,isGuest:!1,expirationTimeMs:t.expiresOn},spRequestId:t.correlationId,spRequestTimestamp:t.requestTimestamp}})};e.prototype.clearCachedToken=function(e){var t=this._getCacheKey(e);window.sessionStorage.removeItem(t);var n=this._resourceKeys.indexOf(t);!isNaN(n)&&n>-1&&this._resourceKeys.splice(n)};Object.defineProperty(e.prototype,"_resourceKeys",{get:function(){this._keysToDispose||(this._keysToDispose=new Array);return this._keysToDispose},enumerable:!0,configurable:!0});e.prototype._retriableFetchWithDigest=function(t,n,i){var s=this,u=this._context.qosMonitor(),a=Date.now();return this._context.fetchWithDigest(this._buildTokenRequest(t,i)).then(function(f){if(200!==f.status){s._context.logger.logError("fetchWithDigest failed. Server responded with "+f.statusText);var l=new o(r.unknownError,{httpResponseStatus:f.status,message:f.statusText,correlationId:e._getCorrelationId(f)});if(400!==f.status){u.writeUnexpectedFailure("UnknownError",l);return Promise.reject(l)}return f.json().then(function(r){var o=e._extractRealError(r),a=s._getErrorCodeFromResponseCode(o);if(!s._isRetriableError(a)||0===n){var f=s._buildErrorFromResponse(o);u.writeUnexpectedFailure("SharepointServerError",f);return Promise.reject(f)}s._context.logger.logError("fetchWithDigest failed. Retrying. Retries left: "+n);return s._retriableFetchWithDigest(t,n-1,i)})}return s._instrumentedParseResponseData(f,u,a)})};e.prototype._getCachedTokenData=function(e){return JSON.parse(window.sessionStorage.getItem(this._getCacheKey(e)))};e.prototype._storeTokenData=function(e,t){window.sessionStorage.setItem(this._getCacheKey(e),JSON.stringify(t))};e.prototype._getCacheKey=function(e){var t=["sp-client-shared",s.npmPackageVersion,"OAuthUtility",e].join(";");-1===this._resourceKeys.indexOf(t)&&this._resourceKeys.push(t);return t};e.prototype._isExpiring=function(e){return e.expiresOn-Date.now()/1e3<s.aboutToExpireIntervalSeconds};e.prototype._isRetriableError=function(e){return-1!==s.retriableErrorCodes.indexOf(e)};e.prototype._buildTokenRequest=function(e,t){var n=new Headers;n.append("Content-Type","application/json; charset=utf-8");n.append("Odata-Version","4.0");n.append("Accept","application/json;odata.metadata=minimal");var r={method:"POST",headers:n,body:JSON.stringify(this._buildRequestBody(e))},i=t;i&&i.lastIndexOf("/")===i.length-1&&(i=i.substr(0,i.length-1));return new Request(i+s.apiUrl,r)};e.prototype._buildRequestBody=function(e){return{resource:e}};e.prototype._buildErrorFromResponse=function(e){var t,n,i=this._getErrorCodeFromResponseCode(e);if(void 0===i)return new o(r.malformedResponseBody,{httpResponseStatus:400,message:s.unexpectedErrorCodeFormat,correlationId:e.correlationId});if(e.message)if("string"==typeof e.message)t=e.message;else{t=e.message.value;n=e.message.lang}return new o(r.serverError,{httpResponseStatus:400,message:t,cultureName:n,serverErrorCode:i,correlationId:e.correlationId,redirectUrl:e["error.redirectUrl"]||e["@error.redirectUrl"]})};e.prototype._getErrorCodeFromResponseCode=function(e){var t=e.code,n=Number(t);if(isNaN(n)&&"string"==typeof e.message){var r=t.indexOf(",");-1!==r&&(n=Number(t.substr(0,r)))}return n};e.prototype._instrumentedParseResponseData=function(t,n,i){try{return t.json().then(function(r){n.writeSuccess();return{accessToken:r.access_token,expiresOn:Number(r.expires_on),notBefore:Number(r.not_before),resource:r.resource,tokenType:r.token_type,correlationId:e._getCorrelationId(t),requestTimestamp:i}})}catch(i){n.writeUnexpectedFailure("ResponseParseError",i);return Promise.reject(new o(r.malformedResponseBody,{httpResponseStatus:200,message:s.unexpectedTokenMessageFormat,correlationId:e._getCorrelationId(t)}))}};e.prototype._dispose=function(e){window.removeEventListener("unload",this._dispose);for(var t=0,n=this._resourceKeys;t<n.length;t++){var r=n[t];window.sessionStorage.removeItem(r)}};e.prototype._receiveMediaServiceFlushedToken=function(){if(window._spMSBT){var e={tokenType:window._spMSBT.TokenType,expiresOn:window._spMSBT.ExpiresOn,notBefore:void 0,resource:window._spMSBT.Resource,accessToken:window._spMSBT.AccessToken};this._storeTokenData(e.resource,e);window._spMSBT=void 0}};return e})(),a=n(997),f=n(52),l=n(289),c=n(109),h=n(48),p=(function(){function e(){this._qos=new c.e({name:"OAuthTokenDataSource"})}e.prototype.writeSuccess=function(){this._qos.end({resultType:h.e.Success})};e.prototype.writeUnexpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:h.e.Failure,error:JSON.stringify(t)})};e.prototype.writeExpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:h.e.ExpectedFailure,error:JSON.stringify(t)})};return e})(),d=(function(){function e(){}e.prototype.logWarning=function(e){};e.prototype.logError=function(e){};return e})(),v=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,{},{pageContext:t})||this;r.logger=new d;if(n){n.logger&&(r.logger=n.logger);n.useAbsoluteUrlForOAuth&&(r._useAbsoluteUrlForOAuth=n.useAbsoluteUrlForOAuth)}r._oAuthUtility=new u(r);return r}t.prototype.qosMonitor=function(){return new p};Object.defineProperty(t.prototype,"webUrl",{get:function(){return this._useAbsoluteUrlForOAuth?this._pageContext.webAbsoluteUrl:Object(l.n)(this._pageContext)},enumerable:!0,configurable:!0});t.prototype.fetchWithDigest=function(e){var t=this;return e.text().then(function(n){var r=e.headers.get("Content-Type");e.headers.delete("Content-Type");return t._odspPromiseToEs6Promise(t.getData(function(){return e.url},function(e,t){return new Response(e,{status:t.getStatus(),headers:t.getResponseHeadersDictionary()})},"DelegationTokenDataSource",function(){return n},"POST",t._getRequestHeadersDictionary(e),r,void 0,!0).then(function(e){return e},function(e){return new Response(JSON.stringify(e),{status:e.status})}))})};t.prototype.getToken=function(e,t){t&&this._oAuthUtility.clearCachedToken(e);return this._es6PromiseToOdspPromise(this._oAuthUtility.getOAuthToken(e,this.webUrl).then(function(e){return e.token}))};t.prototype.getInstrumentedToken=function(e,t){t&&this._oAuthUtility.clearCachedToken(e);return this._es6PromiseToOdspPromise(this._oAuthUtility.getInstrumentedOAuthToken(e,this.webUrl))};t.prototype._getRequestHeadersDictionary=function(e){var t=e.headers,n={};t.forEach(function(e,t){n[t]=e});return n};t.prototype._odspPromiseToEs6Promise=function(e){return new Promise(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})};t.prototype._es6PromiseToOdspPromise=function(e){return new f.n(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})};return t})(a.t);t.e=v},function(e,t,n){"use strict";var r=n(0),i=n("knockout-lib"),s=n(1650),o=n(52),u=n(1702),a=Object(u.e)("ms-react-tooltip","./TooltipContainer",function(){return o.n.resolve(n.ee(["264"],4247))},{calloutProps:{gapSpace:0},styles:{content:{fontSize:"0.75rem"}}});i.components.isRegistered(a.tagName)||i.components.register(a.tagName,a);var f,l=a,c=n(129),h=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=n.valueAccessor();n.createComputed(function(){n.unwrapObservable(r.isTooltipDisabled);n._removeTooltip()});n.events.onAll(n.element,{mouseenter:n._insertTooltip,mouseleave:n._removeTooltip,focusin:n._insertTooltip,focusout:n._removeTooltip,click:n._removeTooltip,keydown:n._onKeyDown});n.addDisposable({dispose:function(){n._removeTooltip()}});return n}t.prototype._insertTooltip=function(e){var t=this;if(!(e&&e.relatedTarget&&this.element.contains(e.relatedTarget))){this._removeTooltip();var n=this.valueAccessor();if(n&&n.content&&!this.peekUnwrapObservable(n.isTooltipDisabled)&&this.peekUnwrapObservable(n.content)){var r=f=this._createTooltip(n);i.tasks.schedule(function(){f===r&&t.element.appendChild(f)})}}};t.prototype._createTooltip=function(e){var t=document.createElement("span"),n={content:this.peekUnwrapObservable(e.content),targetElement:this.element},r={component:{name:l.tagName,params:n}};i.applyBindingsToNode(t,r);return t};t.prototype._removeTooltip=function(e){if(!(e&&e.relatedTarget&&this.element.contains(e.relatedTarget))&&f){i.removeNode(f);f=null}};t.prototype._onKeyDown=function(e){if(e&&("Escape"===e.code||e.keyCode===c.e.escape)){this._removeTooltip(e);e.stopPropagation()}};return t})(s.t);t.e=h},,,,function(e,t,n){"use strict";n.d(t,"t",function(){return l});n.d(t,"e",function(){return c});var r=n(0),i=n(1547),s=n(97),o=n("react-lib"),u={gapSpace:0},a={styles:{content:{fontSize:"0.75rem"}},maxWidth:"300px"},f=0;function l(e,t,n){var l=(n=n||{}).tooltipId?n.tooltipId:"od-Share-tooltip-"+f;f++;var c=n.targetElementId?Object(r.__assign)(Object(r.__assign)({},u),{target:"#"+n.targetElementId}):u;return o.createElement(i.e,{id:l,content:t,directionalHint:void 0===n.position?s.e.topCenter:n.position,calloutProps:c,tooltipProps:a},e)}function c(e,t,n,r){return o.createElement("span",{tabIndex:-1,"aria-hidden":!!r,className:"od-Share-screenReaderOnly","aria-live":t,role:n},e||"")}},function(e,t,n){"use strict";var r=(function(){function e(){this.id=++e._lastBatchId}e._lastBatchId=0;return e})();t.e=r},function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e,t){return void 0!==e[t]&&null!==e[t]}},,,function(e,t,n){"use strict";n.d(t,"t",function(){return l});n.d(t,"n",function(){return c});n.d(t,"d",function(){return h});n.d(t,"v",function(){return p});n.d(t,"i",function(){return d});n.d(t,"e",function(){return v});n.d(t,"f",function(){return m});n.d(t,"a",function(){return g});n.d(t,"l",function(){return b});n.d(t,"m",function(){return w});n.d(t,"h",function(){return E});n.d(t,"p",function(){return S});n.d(t,"c",function(){return x});n.d(t,"u",function(){return T});n.d(t,"o",function(){return N});n.d(t,"r",function(){return C});n.d(t,"s",function(){return k});n(0);var r=n(2090),i=n(2367),s=n(2298),o=n(109),u=n(48),a=n(1665),f=(n(52),!1);function l(){window.parent.postMessage(JSON.stringify({name:"share_copyLinkClicked"}),"*")}function c(){try{window.external.Dismiss()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_dismiss"}),"*")}}function h(e,t){try{window.external.ShareCompleted(e)}catch(r){var n={name:"share_completed",shareType:e,scope:t};window.parent.postMessage(JSON.stringify(n),"*")}}function p(e,t,n){var r=t?t.length:0;try{window.external.SendLinkViaTeams(e.url)}catch(t){var i={name:"share_teamsClicked",sharingLink:e.url};window.parent.postMessage(JSON.stringify(i),"*")}try{window.external.SendLinkViaTeamsWithContext(e.url,t,r,n)}catch(i){var s={name:"share_teamsClickedWithContext",sharingLink:e.url,recipients:t,numRecipients:r,body:n};window.parent.postMessage(JSON.stringify(s),"*")}}function d(e){try{window.external.GrantAccessCompleted(e)}catch(n){var t={name:"share_grantAccessCompleted",successful:e};window.parent.postMessage(JSON.stringify(t),"*")}}function v(e,t){void 0===t&&(t="");try{window.external.AddPeopleCompleted(e,t)}catch(r){var n={name:"share_addPeopleCompleted",successful:e,completionMessage:t};window.parent.postMessage(JSON.stringify(n),"*")}}function m(e,t,n,s,a,l){if(f){(function(e,t,n,s,a,f){var l=r.e[t]||"unknown";new o.e({name:"ShareV3."+i.e[n]+".AfterPageLoad",startTimeOverride:e||void 0}).end({resultType:a?u.e.Failure:u.e.Success,extraData:{clientId:l,scenario:s,isError:!!a,correlationId:f,error:a}})})(e,t,n,s,a.isStubFile?"file uploading":a.errorMessage||"unknown error",l)}else{y(e,t,n,s,a.errorMessage||"unknown error",l);f=!0}try{window.external.PageError(a.error,a.errorCategory,a.errorMessage,a.debugErrorMessage)}catch(e){var c={name:"share_error",error:a.error,errorCategory:a.errorCategory,errorMessage:a.errorMessage,debugErrorMessage:a.debugErrorMessage};window.parent.postMessage(JSON.stringify(c),"*")}}function g(){window.parent.postMessage(JSON.stringify({name:"share_outlookClicked"}),"*")}function y(e,t,n,s,a,f){if(e){var l=r.e[t]||"unknown";new o.e({name:"ShareV3."+i.e[n]+".PageLoaded",startTimeOverride:e}).end({resultType:a?u.e.Failure:u.e.Success,extraData:{clientId:l,scenario:s,isError:!!a,correlationId:f,error:a}})}}function b(e,t,n,r,i){if(!f){y(e,t,n,r,void 0,i);try{window.external.PageFinishedLoading()}catch(e){var s=new o.e({name:"Sharing.post_share_ready"});try{window.parent.postMessage(JSON.stringify({name:"share_ready"}),"*");s.end({resultType:u.e.Success})}catch(e){s.end({resultType:u.e.Failure,resultCode:"post_share_ready_failure"})}}f=!0}}function w(){try{window.external.UIReady()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_uiReady"}),"*")}}function E(){window.parent.postMessage(JSON.stringify({name:"share_readyForRecipients"}),"*")}function S(){window.parent.postMessage(JSON.stringify({name:"share_sendClicked"}),"*")}function x(){try{window.external.PeoplePickerFocused()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_peoplePickerFocused"}),"*")}}function T(e,t,n,r){var i,o=Object(a.g)(r,e,n),u=Object(a.b)(e,t,r,n),f=Object(a.T)(e.sharingLinkKind),l=Object(a.N)(e.status),c=e.audience===s.e.existing?"00000000-0000-0000-0000-000000000000":e.shareId,h=!1;try{window.external.LinkSettingsCompleted(c,e.url,o,u,f);h=!0}catch(e){}var p={id:c,expirationDateTime:null===(i=e.expiration)||void 0===i?void 0:i.toISOString(),hasPassword:!!e.hasPassword,link:{type:e.isReview?"review":e.isEdit?"edit":"view",blocksDownload:!!e.blockDownload,preventsDownload:!!e.blockDownload,createOnly:!!e.isCreateOnlyLink,iconUrl:o,localizedDescription:u,webUrl:e.url,scope:f,customLabeledAudience:e.audience===s.e.customLabeledSpecificPeople,status:l,createdDateTime:e.created}};try{window.external.LinkSettingsCompletedV2(JSON.stringify(p));h=!0}catch(e){}if(!h){var d={name:"share_linkSettingsCompleted",type:e.isReview?"review":e.isEdit?"edit":"view",shareId:c,linkUrl:e.url,iconUrl:o,linkDescription:u,scope:f,blocksDownload:!!e.blockDownload,customLabeledAudience:e.audience===s.e.customLabeledSpecificPeople};window.parent.postMessage(JSON.stringify(d),"*");window.parent.postMessage(JSON.stringify({name:"share_linkSettingsCompletedV2",permissions:p}),"*")}}function N(){var e=!1;try{e=window.external.IsDarkMode()}catch(e){}return e}function C(){var e=void 0;try{e=window.parent.GetShareDialogTheme()}catch(e){}return e}function k(){window.parent.postMessage(JSON.stringify({name:"share_manageAccessClicked"}),"*")}},,function(e,t,n){"use strict";n.d(t,"e",function(){return l});n.d(t,"t",function(){return c});var r=n(52),i=n(471),s=n(109),o=n(48),u=n(103),a=n(63),f={ODB:387},l="https://graph.microsoft.com",c=(function(){function e(e,t){this._pageContext=t.pageContext;this._sharingContextInformation=t.sharingContextInformation;this._oAuthTokenProvider=t.oAuthTokenProvider;this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._graphToken=this._sharingContextInformation.additionalTokens.graphToken);this.initializeDataStore()}e.prototype.canUseGraph=function(){if(this._graphToken)return!0;if(this._pageContext&&!this._pageContext.isSPO)return!1;if(this._pageContext&&this._pageContext.authToken)return!1;var e=this._pageContext&&this._oAuthTokenProvider&&i.n.isFeatureEnabled(f);this._dataStore&&(e=e&&!this._dataStore.getValue("DisableGraph",a.e.session));return e};e.prototype.disableGraphCallsForPicker=function(){this.initializeDataStore();this._dataStore.setValue("DisableGraph",!0,a.e.session)};e.prototype.getGraphToken=function(){var e=this;if(this._graphToken)return r.n.resolve(this._graphToken);if(this._oAuthTokenProvider){var t=new s.e({name:"PeoplePicker.GetGraphToken"});return this._oAuthTokenProvider.getToken(l).then(function(e){t.end({resultType:o.e.Success});return e},function(n){if(r.n.isCanceled(n)){t.end({resultType:o.e.ExpectedFailure,resultCode:"Canceled"});return r.n.reject(n)}t.end({resultCode:"PeoplePicker.GetGraphTokenError",resultType:o.e.Failure,extraData:{serverErrorCode:n._serverErrorCode,message:n.message}});e.disableGraphCallsForPicker();return null})}return null};e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new u.e("PeoplePicker",a.e.session))};return e})()},,,,function(e,t,n){"use strict";var r=n(0),i=n(355),s=n(195),o=n(880),u=n(1649),a=n(994),f=n(1659),l=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._responsiveUI=n.resources.consume(f.t);return n}t.calculateParentRect=function(e,t){var n=e,r=[];do{if("none"===n.style.display){r.push(n);n.style.display=""}else n=n.parentElement;t=a.e.calculateRect(e)}while(0===t.x&&n!==document.body);r.forEach(function(e){e.style.display="none"});return t};t.prototype.assignAlignment=function(e){var t=e.alignment;return t?"string"==typeof t?this.createObservable(i.e[t]):this.wrapObservable(t):this.createObservable(i.e.Left|i.e.Top)};t.prototype.computePositioningStyles=function(e){var t=this,n=e.renderedTemplate,r=e.clientRect,i=e.style,u=e.contentStyle,a=e.trigger,f=e.hasExplicitAlignment,l=e.alignment,c=e.allowMenuNudging,h=e.left,p=e.top,d=e.beak,v=e.isScrollable,m=e.userOffset;this.createComputed(function(){var e=new s.e(h(),p()),g=new o.e(0,0,t._responsiveUI.windowWidth(),t._responsiveUI.windowHeight()),y="",b="";g=g.inflate(-4,-4);if(n()&&r()){var w=-parseFloat(""+Number(!!i().marginLeft)),E=-parseFloat(""+Number(!!i().marginRight)),S=r().translate(w,E);a();e=e.add(m());var x=l();f||(x=t._determineBestFitAlignment(S,x));e=t._transformMenuCoordinate(e,S,x);var T=void 0;if(0===Object.keys(i()).length){i({left:Math.floor(e.x)+"px",top:Math.floor(e.y)+"px"});T=new o.e(S.x+e.x,S.y+e.y,S.width,S.height)}else T=new o.e(S.x+parseInt(i().left,10),S.y+parseInt(i().top,10),S.width,S.height);var N=g.contains(new s.e(T.x,T.y)),C=g.contains(new s.e(T.x+T.width,T.y));if(!N||!C){var k=c?T.nudge(g):T;if(!g.contains(k)){y=(k=k.clip(g)).width+"px";b=k.height+"px";v(!0)}e=e.add(new s.e(k.x-T.x,k.y-T.y));i({left:Math.floor(e.x)+"px",top:Math.floor(e.y)+"px"})}v(!1);t.async.setTimeout(function(){d({})},200)}u({width:y,height:b})}).extend({deferred:!0})};t.prototype._determineBestFitAlignment=function(e,t){var n=t,r=e.getPoint();if(e.width<=document.body.clientWidth&&e.height<=document.body.clientHeight){var s=this._transformMenuCoordinate(r,e,n);(s.x<0||s.x+e.width>document.body.clientWidth)&&(n^=i.e.Right);(s.y<0||s.y+e.height>document.body.clientHeight)&&(n^=i.e.Bottom)}return n};t.prototype._transformMenuCoordinate=function(e,t,n){var r=new s.e(e.x,e.y);if(n){(n&i.e.Right)===i.e.Right?r.x-=t.width:(n&i.e.Center)===i.e.Center&&(r.x-=t.width/2);(n&i.e.Bottom)===i.e.Bottom?r.y-=t.height:(n&i.e.VerticalCenter)===i.e.VerticalCenter&&(r.y-=t.height/2)}return r};return t})(u.n);t.e=l},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(1670),i=[r.e.lightBlue,r.e.blue,r.e.darkBlue,r.e.teal,r.e.green,r.e.darkGreen,r.e.lightPink,r.e.pink,r.e.magenta,r.e.purple,r.e.orange,r.e.lightRed,r.e.darkRed,r.e.violet,r.e.gold,r.e.burgundy,r.e.warmGray,r.e.cyan,r.e.rust,r.e.coolGray],s=i.length;function o(e){var t=e.primaryText,n=e.text,o=e.initialsColor;return"string"==typeof o?o:(function(e){switch(e){case r.e.lightBlue:return"#4F6BED";case r.e.blue:return"#0078D4";case r.e.darkBlue:return"#004E8C";case r.e.teal:return"#038387";case r.e.lightGreen:case r.e.green:return"#498205";case r.e.darkGreen:return"#0B6A0B";case r.e.lightPink:return"#C239B3";case r.e.pink:return"#E3008C";case r.e.magenta:return"#881798";case r.e.purple:return"#5C2E91";case r.e.orange:return"#CA5010";case r.e.red:return"#EE1111";case r.e.lightRed:return"#D13438";case r.e.darkRed:return"#A4262C";case r.e.transparent:return"transparent";case r.e.violet:return"#8764B8";case r.e.gold:return"#986F0B";case r.e.burgundy:return"#750B1C";case r.e.warmGray:return"#7A7574";case r.e.cyan:return"#005B70";case r.e.rust:return"#8E562E";case r.e.coolGray:return"#69797E";case r.e.black:return"#1D1D1D";case r.e.gray:return"#393939"}})(o=void 0!==o?o:(function(e){var t=r.e.blue;if(!e)return t;for(var n=0,o=e.length-1;o>=0;o--){var u=e.charCodeAt(o),a=o%8;n^=(u<<a)+(u>>8-a)}return t=i[n%s]})(n||t))}},function(e,t,n){"use strict";n.d(t,"r",function(){return u});n.d(t,"n",function(){return a});n.d(t,"e",function(){return f});n.d(t,"t",function(){return l});n.d(t,"i",function(){return c});n.d(t,"c",function(){return h});n.d(t,"h",function(){return p});n.d(t,"p",function(){return d});n.d(t,"o",function(){return v});n.d(t,"u",function(){return m});n.d(t,"s",function(){return g});n.d(t,"a",function(){return y});n.d(t,"f",function(){return b});n.d(t,"l",function(){return w});var r=n(2002),i=n(22),s=n(2003),o=n(46),u="_ComplianceTag",a="D4B6480A-4BED-4094-9A52-30181EA38F1D",f="ComplianceAssetId",l="_ComplianceFlags",c=200;function h(e){return!!(e&&e.schema&&(t=e.schema.FieldType,n=e.schema.Id,t&&"lookup"===t.toLowerCase()&&n&&n.toLowerCase()===a.toLowerCase()));var t,n}function p(e){return!!(e&&e.schema&&(t=e.schema.FieldType,n=e.schema.Id,t&&"boolean"===t.toLowerCase()&&n&&n.toLowerCase()==="96BE7325-AFA4-48CF-8503-9258F0A7817D".toLowerCase()));var t,n}function d(e){return!!(256&e)}function v(e){return g(e)?r.t:r.e}function m(e){if(e.properties.hasOwnProperty("_ComplianceFlags")){if(4&+e.properties._ComplianceFlags)return!0}return!1}function g(e){if(e.properties.hasOwnProperty("_ComplianceFlags")){var t=+e.properties._ComplianceFlags;if(Object(o.isFeatureEnabled)(o.IPRecordVersioningClient)){if(4&t||256&t)return!0}else if(4&t&&1&t)return!0}return!1}function y(){return s.RecordLabelHoverText}function b(e){if(!e.HasRetentionAction)return"";if(0===e.TagDuration)return e.BlockDelete?s.RetainForeverText:"";var t=E(e.TagDuration);return e.BlockDelete?i.format(s.PreserveTagText,t):e.AutoDelete?i.format(s.DeleteTagText,t):""}function w(e){if(e.Notes)return e.Notes;if(!e.HasRetentionAction)return s.NoRetentionTooltip;if(0===e.TagDuration)return e.BlockDelete?s.PreserveForeverTooltip:s.NoRetentionTooltip;var t=E(e.TagDuration),n="",r="";if(e.BlockDelete){n="PreserveTag"+e.TagRetentionBasedOn+"Tooltip";e.BlockEdit&&(r=s.PreserveIsRecordTooltipModifier);e.ReviewerEmail?r+=s.ReviewTooltip:r+=e.AutoDelete?s.PreserveAutoDeleteTooltipModifier:s.PreserveNoDeleteTooltipModifier}else e.AutoDelete&&(n="DeleteTag"+e.TagRetentionBasedOn+"Tooltip");var o=s[n];return o?i.format(o,t)+r:null}function E(e){var t="";if(e>0){var n=Math.floor(e/365);if(n>0){var r=n>1?s.RetentionPeriodYears:s.RetentionPeriodYear;t=i.format(r,n)}else{var o=Math.floor(e/30);if(o>0){var u=o>1?s.RetentionPeriodMonths:s.RetentionPeriodMonth;t=i.format(u,o)}else{var a=e>1?s.RetentionPeriodDays:s.RetentionPeriodDay;t=i.format(a,e)}}}return t}},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r;(function(e){e[e.none=0]="none";e[e.right=1]="right";e[e.flip=2]="flip";e[e.left=3]="left"})(r||(r={}));var i=r},function(e,t,n){"use strict";n.d(t,"t",function(){return a});var r=n(0),i=n(1649),s=n(2210),o=n(11),u=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=n.itemCommandProvider,o=void 0===i?r.resources.consume(s.e):i;r._itemCommandProvider=o;return r}t.prototype.isCommandSupported=function(e,t){var n=this._itemCommandProvider;return!n||!!n.getCommand(e,t)};t.prototype.getCommandBehavior=function(e,t){var n=this._itemCommandProvider,r=n&&n.getCommand(e,t);return r&&r.behavior};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{itemCommandProvider:s.e});return t})(i.n);t.e=u;var a=Object(o.s)("ItemCommandHelper",u)},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(7),i=n(1757),s=new r.t({name:"OverlayProvider.key",factory:i.e})},function(e,t,n){"use strict";n.d(t,"f",function(){return b});n.d(t,"l",function(){return E});n.d(t,"r",function(){return x});n.d(t,"i",function(){return T});n.d(t,"t",function(){return k});n.d(t,"a",function(){return L});n.d(t,"o",function(){return A});n.d(t,"u",function(){return O});var r,i,s,o,u,a=n(1679),f=n(1661),l=n(1666);n.d(t,"e",function(){return a.t});n.d(t,"n",function(){return a.n});n.d(t,"s",function(){return a.r});n.d(t,"c",function(){return a.s});n.d(t,"h",function(){return a.o});n.d(t,"p",function(){return a.u});var c="ms-word",h="onenote|UsePlain",p="ms-powerpoint",d="ms-excel",v="ms-visio",m="ms-publisher",g="ms-project",y=((r={})[c]=l.OpenInWordOnline,r[h]=l.OpenInOneNoteOnline,r[p]=l.OpenInPowerPointOnline,r[d]=l.OpenInExcelOnline,r[v]=l.OpenInVisioOnline,r);function b(e){return y[e]||""}var w=((i={})[c]=l.OpenInWord,i[h]=l.OpenInOneNote,i[p]=l.OpenInPowerPoint,i[d]=l.OpenInExcel,i[v]=l.OpenInVisio,i[m]=l.OpenInPublisher,i[g]=l.OpenInProject,i["ms-infopath"]=l.OpenInInfoPath,i);function E(e){return w[e]}var S=((s={})[c]="Word",s[h]="OneNote",s[p]="PowerPoint",s[g]="Project",s[v]="Visio",s[d]="Excel",s);function x(e){var t=e.extension;return t&&".pdf"===t.toLowerCase()?"WordPdf":S[e.appMap]||"Word"}function T(e){return S[e]}var N=((o={})[c]="WordLogo",o[h]="OneNoteLogo",o[p]="PowerPointLogo",o[d]="ExcelLogo",o[v]="VisioLogo",o[m]="Page",o),C=((u={})[c]="svg/word_16x1.svg",u[h]="svg/onenote_16x1.svg",u[p]="svg/powerpoint_16x1.svg",u[d]="svg/excel_16x1.svg",u[v]="svg/visio_16x1.svg",u[m]="Page",u),k={"svg/word_16x1.svg":"svg/word_white_stroke_18x1.svg","svg/onenote_16x1.svg":"svg/onenote_white_stroke_18x1.svg","svg/powerpoint_16x1.svg":"svg/powerpoint_white_stroke_18x1.svg","svg/excel_16x1.svg":"svg/excel_white_stroke_18x1.svg","svg/visio_16x1.svg":"svg/visio_white_stroke_18x1.svg"};function L(e){var t=N[e];return t&&new f.e(t)}function A(e){var t=C[e];return t&&new f.e(t)}function O(e){var t=a.e;return-1!==t["ms-word"].lastIndexOf(e)?"ms-word":-1!==t["ms-powerpoint"].lastIndexOf(e)?"ms-powerpoint":-1!==t["ms-excel"].lastIndexOf(e)?"ms-excel":-1!==t["ms-visio"].lastIndexOf(e)?"ms-visio":-1!==t["onenote|UsePlain"].lastIndexOf(e)?"onenote|UsePlain":-1!==t["ms-access"].lastIndexOf(e)?"ms-access":-1!==t["ms-project"].lastIndexOf(e)?"ms-project":-1!==t["ms-publisher"].lastIndexOf(e)?"ms-publisher":void 0}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.unknown=0]="unknown";e[e.file=1]="file";e[e.folder=2]="folder";e[e.item=3]="item";e[e.list=4]="list";e[e.web=5]="web";e[e.max=6]="max"})(r||(r={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(4),i=n("react-lib"),s=n(1486),o=n(1484),u=n(1503),a=(function(e){Object(r.r)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return i.createElement(u.e,Object(r.e)({},this.props,{primary:!0,onRenderDescription:s.t}))};return t=Object(r.n)([Object(o.e)("PrimaryButton",["theme","styles"],!0)],t)})(i.Component)},function(e,t,n){"use strict";n.d(t,"e",function(){return w});var r=n(0),i=n(1649),s=n(103),o=n(63),u=n(11),a=n(76),f=n(71),l=n(1770),c=n(46),h=n(1438),p=n(70);function d(e,t){return e.preferences[(t||"").toLowerCase()]}function v(e){return!!(e=e&&e.toLowerCase().replace(".",""))&&!l.e[e]||"pdf"===e}function m(e,t,n,i){var s=d(e,t);if(s)for(var o=0,u=Object(r.__spreadArrays)(s.preview,s.open).filter(g);o<u.length;o++){var a=u[o],f=n&&a[n]||i&&a.handler[i];if(f)return f}}function g(e){return!e.handler.isPromoted}function y(e){return e.filter(g)[0]}var b=(function(e){Object(r.__extends)(t,e);function t(t,n){var r,i=e.call(this,t,n)||this,u=Object(c.isFeatureEnabled)(c.FileHandlersV2),l=new s.e("FileHandlers",o.e.session);if(u)try{var d=l.getValue("data");r=d&&JSON.parse(d)}catch(e){}var v=i.observables,m=i.data=v.create(r);m.equalityComparer=h.e;if(!r||4!==r.version||!u){m({actions:{custom:[],create:[],open:[],preview:[]},preferences:{},version:4});l.setValue("data",JSON.stringify(m.peek()))}u&&v.backgroundCompute(function(){i.trackPromise(i.resources.consumeAsync(a.p.optional).then(function(e){if(e)return e.getFileHandlerData({includePromotedApp:!0})}).then(function(e){return e||i.resources.consumeAsync(a.h.optional).then(function(e){if(e)return p.t.isActivated("a9c8b4cd-bc43-466c-aeeb-106eec05d057","07/07/2021","Will try to use cookie to get filehandler instead of tokens.")?e.getFileHandlerData({includePromotedApp:!0}):e.getFileHandlerData({includePromotedApp:!0,allowCookies:!0})})}).then(function(e){if(e){l.setValue("data",JSON.stringify(e));m(e)}},function(e){f.e.logError(e)}))});return i}t.prototype.getFileTypeIconUrl=function(e,t){return v(e)?this.getIconUrl(m(this._getData(t),e||"","icon","fileTypeIcon")):void 0};t.prototype.getFileTypeName=function(e,t){return v(e)?m(this._getData(t),e||"",void 0,"fileTypeDisplayName"):void 0};t.prototype.getIconUrl=function(e){var t=window.devicePixelRatio||1;return e&&(e.svg||t>=1.75&&e.png2x||t>=1.25&&e.png1_5x||e.png1x)};t.prototype.getDefaultOpenHandler=function(e,t){var n=d(this._getData(t),e||"");return n&&y(n.open)};t.prototype.getDefaultPreviewHandler=function(e,t){var n=d(this._getData(t),e||"");return n&&y(n.preview)};t.prototype.isActionForExtension=function(e,t){var n=e.availableOn.file,r=n&&n.extensions;return!!n&&(!r||r.indexOf(t.toLowerCase())>=0||r.indexOf(".*")>=0)};t.prototype._getData=function(e){return e?this.data.peek():this.data()};return t})(i.n),w=Object(u.s)("FileHandlerProvider",b)},function(e,t,n){"use strict";var r;(function(e){e[e.Public=0]="Public";e[e.PublicUnlisted=2]="PublicUnlisted";e[e.Shared=3]="Shared";e[e.Private=4]="Private";e[e.Unknown=5]="Unknown"})(r||(r={}));t.e=r},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r={auto:0,top:1,bottom:2,center:3}},function(e,t,n){"use strict";var r=n(138);Object(r.n)([{rawString:".Beak-container{position:absolute;width:100%;height:100%}.Beak-container .Beak-arrow.Beak--themePrimary{background:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.Beak-container .Beak-arrow.Beak--white{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.Beak-container .Beak-arrow.Beak--neutralLighterAlt{background:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}.Beak-container .Beak-arrow.Beak--themeTertiary{background:"},{theme:"themeTertiary",defaultValue:"#71afe5"},{rawString:"}.Beak-arrow{box-shadow:0 0 5px 0 "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";width:16px;position:relative;transform:rotate(45deg);height:16px;transition:left 1s ease-in-out,right 1s ease-in-out}.Beak-arrow--centered{transform:translateX(-50%) rotate(45deg)!important}html[dir=ltr] .Beak-arrow--centered{left:50%}html[dir=rtl] .Beak-arrow--centered{right:50%}html[dir=rtl] .Beak-arrow--centered{transform:translateX(50%) rotate(45deg)!important}"}]);var i=n("knockout-lib"),s=n(994),o=n(1719),u=n(425),a=n(293),f=n(1764),l=n(480),c=(function(){function e(){}e.init=function(t,n){var r,l=i.utils.unwrapObservable(n())||{},c=i.utils.unwrapObservable(l.anchorElement),h=l.isVisible,p=void 0===h?i.observable(!0):h,d=l.beakColorVariation,v=l.isBeakCenterAligned,m=void 0===v?i.observable(!1):v,g=l.beakSize,y=void 0===g?e.size:g;(c||(c=Object(o.e)(t,"beak-anchor")))&&i.computed(function(){i.utils.unwrapObservable(l.trigger);r&&i.removeNode(r);(r=document.createElement("div")).className="Beak-container";var n=document.createElement("div");n.className="Beak-arrow";var o=s.e.calculateRect(t),h=s.e.calculateRect(c);0===h.x&&(h=f.e.calculateParentRect(c,h));var v,g,b=y/2,w=e.determineBeakDirection(o,h),E=0;if(0===w||1===w){E=h.getCenter().y-o.getTop();E=e.clamp(E,2*y,o.height-2*y)}else{E=u.e.isRightToLeft?o.getRight()-h.getCenter().x:h.getCenter().x-o.getLeft();o.width>2&&(E=e.clamp(E,2*y,o.width-2*y))}switch(w){case 0:g=-b;v=E-y;break;case 1:g=o.width-y-b;v=E-y;break;case 2:g=E-y;v=-b;break;case 3:g=E-y;v=o.height-y-b}i.utils.unwrapObservable(m)?n.className+=" Beak-arrow--centered":u.e.isRightToLeft?n.style.right=g+"px":n.style.left=g+"px";n.style.top=v+"px";switch(d){case a.e.themePrimary:n.className+=" Beak--themePrimary";break;case a.e.neutralLighterAlt:n.className+=" Beak--neutralLighterAlt";break;case a.e.themeTertiary:n.className+=" Beak--themeTertiary";break;default:n.className+=" Beak--white"}r.appendChild(n);t.insertBefore(r,t.firstChild);r.style.display=p()?"":"none"},null,{disposeWhenNodeIsRemoved:t})};e.clamp=function(e,t,n){return Math.max(Math.min(e,n),t)};e.determineBeakDirection=function(e,t){var n=e.getCenter(),r=t.getCenter();return r.y>=e.getTop()&&r.y<e.getBottom()?r.x<n.x?0:1:r.y<n.y?2:3};e.after=["component"];e.size=l.e;return e})();t.e=c},function(e,t){(function(e){"use strict";if(!e.fetch){var t="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,r="FileReader"in e&&"Blob"in e&&(function(){try{new Blob;return!0}catch(e){return!1}})(),i="FormData"in e,s="ArrayBuffer"in e;if(s)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=function(e){return e&&DataView.prototype.isPrototypeOf(e)},a=ArrayBuffer.isView||function(e){return e&&o.indexOf(Object.prototype.toString.call(e))>-1};d.prototype.append=function(e,t){e=c(e);t=h(t);var n=this.map[e];this.map[e]=n?n+","+t:t};d.prototype.delete=function(e){delete this.map[c(e)]};d.prototype.get=function(e){e=c(e);return this.has(e)?this.map[e]:null};d.prototype.has=function(e){return this.map.hasOwnProperty(c(e))};d.prototype.set=function(e,t){this.map[c(e)]=h(t)};d.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)};d.prototype.keys=function(){var e=[];this.forEach(function(t,n){e.push(n)});return p(e)};d.prototype.values=function(){var e=[];this.forEach(function(t){e.push(t)});return p(e)};d.prototype.entries=function(){var e=[];this.forEach(function(t,n){e.push([n,t])});return p(e)};n&&(d.prototype[Symbol.iterator]=d.prototype.entries);var f=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];w.prototype.clone=function(){return new w(this,{body:this._bodyInit})};b.call(w.prototype);b.call(x.prototype);x.prototype.clone=function(){return new x(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})};x.error=function(){var e=new x(null,{status:0,statusText:""});e.type="error";return e};var l=[301,302,303,307,308];x.redirect=function(e,t){if(-1===l.indexOf(t))throw new RangeError("Invalid status code");return new x(null,{status:t,headers:{location:e}})};e.Headers=d;e.Request=w;e.Response=x;e.fetch=function(e,t){return new Promise(function(n,i){var s=new w(e,t),o=new XMLHttpRequest;o.onload=function(){var e={status:o.status,statusText:o.statusText,headers:S(o.getAllResponseHeaders()||"")};e.url="responseURL"in o?o.responseURL:e.headers.get("X-Request-URL");var t="response"in o?o.response:o.responseText;n(new x(t,e))};o.onerror=function(){i(new TypeError("Network request failed"))};o.ontimeout=function(){i(new TypeError("Network request failed"))};o.open(s.method,s.url,!0);"include"===s.credentials&&(o.withCredentials=!0);"responseType"in o&&r&&(o.responseType="blob");s.headers.forEach(function(e,t){o.setRequestHeader(t,e)});o.send(void 0===s._bodyInit?null:s._bodyInit)})};e.fetch.polyfill=!0}function c(e){"string"!=typeof e&&(e=String(e));if(/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function h(e){"string"!=typeof e&&(e=String(e));return e}function p(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};n&&(t[Symbol.iterator]=function(){return t});return t}function d(e){this.map={};e instanceof d?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function v(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function m(e){return new Promise(function(t,n){e.onload=function(){t(e.result)};e.onerror=function(){n(e.error)}})}function g(e){var t=new FileReader,n=m(t);t.readAsArrayBuffer(e);return n}function y(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);t.set(new Uint8Array(e));return t.buffer}function b(){this.bodyUsed=!1;this._initBody=function(e){this._bodyInit=e;if(e)if("string"==typeof e)this._bodyText=e;else if(r&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(i&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(s&&r&&u(e)){this._bodyArrayBuffer=y(e.buffer);this._bodyInit=new Blob([this._bodyArrayBuffer])}else{if(!s||!ArrayBuffer.prototype.isPrototypeOf(e)&&!a(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=y(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))};if(r){this.blob=function(){var e=v(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))};this.arrayBuffer=function(){return this._bodyArrayBuffer?v(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(g)}}this.text=function(){var e=v(this);if(e)return e;if(this._bodyBlob)return(function(e){var t=new FileReader,n=m(t);t.readAsText(e);return n})(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve((function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")})(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)};i&&(this.formData=function(){return this.text().then(E)});this.json=function(){return this.text().then(JSON.parse)};return this}function w(e,t){var n,r,i=(t=t||{}).body;if(e instanceof w){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url;this.credentials=e.credentials;t.headers||(this.headers=new d(e.headers));this.method=e.method;this.mode=e.mode;if(!i&&null!=e._bodyInit){i=e._bodyInit;e.bodyUsed=!0}}else this.url=String(e);this.credentials=t.credentials||this.credentials||"omit";!t.headers&&this.headers||(this.headers=new d(t.headers));this.method=(n=t.method||this.method||"GET",r=n.toUpperCase(),f.indexOf(r)>-1?r:n);this.mode=t.mode||this.mode||null;this.referrer=null;if(("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function E(e){var t=new FormData;e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}});return t}function S(e){var t=new d;e.split(/\r?\n/).forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}});return t}function x(e,t){t||(t={});this.type="default";this.status="status"in t?t.status:200;this.ok=this.status>=200&&this.status<300;this.statusText="statusText"in t?t.statusText:"OK";this.headers=new d(t.headers);this.url=t.url||"";this._initBody(e)}})("undefined"!=typeof self?self:this)},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(1649),s=n(11),o=n(52),u=n("knockout-lib"),a=(function(){function e(e){var t=this,n=e.noTitle,r=void 0!==n&&n,i=e.title,s=void 0===i?u.observable(""):i,a=e.elementDescribedBy,f=void 0===a?"":a,l=e.hasCommandBar,c=void 0!==l&&l,h=e.size,p=void 0===h?"Small":h,d=e.scrollMode,v=void 0===d?"auto":d,m=e.showCloseButton,g=void 0===m||m,y=e.includePadding,b=void 0===y||y,w=e.preserveLightDismiss,E=void 0!==w&&w,S=e.stickyCloseButton,x=void 0!==S&&S,T=e.component,N=void 0===T?null:T,C=e.maximizePanelContent,k=void 0!==C&&C,L=e.panelContentSize,A=void 0===L?u.observable({width:0,height:0}):L,O=e.isBlocking,M=e.disableEscape,_=void 0!==M&&M,D=e.overridePanelStyle;this.size=p;this.title=u.isObservable(s)?s:u.observable(s);this.elementDescribedBy=f;this.maximizePanelContent=k;this.panelContentSize=A;this.noTitle=r;this.hasCommandBar=c;this.component=N;this.scrollMode=v;this.showCloseButton=g;this.includePadding=b;this.preserveLightDismiss=E;this.stickyCloseButton=x;this.isBlocking=O;this.disableEscape=_;this.overridePanelStyle=D;this.state=u.observable(0);this._promise=new o.n(function(e){var n=u.computed(function(){if(1===t.state()){e(!0);n.dispose()}},t)})}e.prototype.wait=function(){return this._promise};return e})(),f=n(1722),l=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.currentPanels=r.observables.createArray();r._needsOverlayContent=n.needsOverlayContent;return r}t.prototype.requestPanel=function(e){this._needsOverlayContent.needsOverlayContent.set(!0);var t=new a(e),n=this.currentPanels;n.push(t);var r=function(){return n.remove(t)};t.wait().then(r,r);return t};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{needsOverlayContent:f.e});return t})(i.n),c=Object(s.s)("PanelProvider",l)},function(e,t,n){"use strict";var r=n(0),i=n("knockout-lib"),s=n(994),o=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.valueAccessor();if(r){n._measureCallback=r.measure||r;n._parentRelative=r.parentRelative}n.createComputed(function(){if(n._measureCallback){i.utils.unwrapObservable(r.trigger);r.async?n.async.setImmediate(function(){n._updateMeasurement()}):n._updateMeasurement()}});return n}t.prototype._updateMeasurement=function(){var e=s.e.calculateRect(this.element);if(this._parentRelative&&this.element.parentElement){var t=s.e.calculateRect(this.element.parentElement);e=e.translate(t.getPoint().negate())}this._measureCallback(e)};return t})(n(1650).t);t.e=o},,function(e,t,n){"use strict";n.d(t,"e",function(){return y});n(1780);var r=n(49),i=n(7),s=n(11),o=n(1705),u=n(1748),a=n(76),f=n(537),l=n(1760),c=n(1741),h=n(52),p=n(53),d=(function(){function e(e,t){this._getIdentityDataSource=t.getIdentityDataSource}e.prototype.getToken=function(e,t){return this.getInstrumentedToken(e,t).then(function(e){return e.tokenInfo.token})};e.prototype.getInstrumentedToken=function(e,t){var n=Date.now();return h.n.resolve(this._getIdentityDataSource().then(function(t){return e===l.e&&t.getGraphToken?t.getGraphToken({resource:e}):e===c.e&&t.getSubstrateToken?t.getSubstrateToken(f.e.Default):t.getOAuthSessionToken?t.getOAuthSessionToken(e):void 0}).then(function(e){var t=null==e?void 0:e.accessToken;if(!e||!t)throw new p.e({code:"UnableToResolveToken"});return{tokenInfo:{token:t,isGuest:!1,expirationTimeMs:e.tokenExpiry},spRequestId:e.correlationId||"",spRequestTimestamp:n}}))};return e})(),v=Object(s.s)("OAuthTokenDataSource",d,{getIdentityDataSource:a.S.async.lazy}),m=n(70),g=new i.t({name:"OAuthTokenProvider.dataSource",factory:{dependencies:{pageContext:r.h},create:function(e){var t=new u.e(e.pageContext);return{instance:t,disposable:t}}}}),y=Object(s.s)("OAuthTokenProvider",o.e,{oAuthTokenDataSource:m.t.isActivated("E2CC4464-F5D6-4A52-91AA-D952DBA16336","05/13/2021","Updating OAuthTokenProvider to use IdentityDataSource")?g:v})},function(e,t,n){"use strict";n.d(t,"e",function(){return v});n.d(t,"t",function(){return m});var r=n(0),i=n(1649),s=n(1682),o=n(1726),u=n(52),a=n(1666),f=n(1984),l=n(1661),c=n(391),h=n(1673),p=n(11),d=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._dialogProvider=n.dialogProvider;r._promiseTracker=n.promiseTracker;r._itemSetSelectionModel=n.itemSetSelectionModel;return r}t.prototype.resolveSelection=function(){var e,t,n=this.createObservable(f.e),r=this.createObservable(!0),i=this.createObservable(!1),s=this._shouldShowDialog();if(this._itemSetSelectionModel){t=this._itemSetSelectionModel.resolveSelection().then(function(t){s=!1;e&&e.state(2);return t},function(t){if(e){n(f.t);r(!1);i(!0)}return u.n.wrapError(t)});s&&(e=this._createDialog(n,r,i)).wait().done(void 0,function(){t.cancel()});this._promiseTracker&&this._promiseTracker.registerPromise(t)}else t=u.n.wrap([]);return t};t.prototype._createDialog=function(e,t,n){return this._dialogProvider.requestDialog({title:f.n,isDismissable:!1,component:{name:o.e.tagName,params:{text:e}},actions:[{name:a.cancelActionText,execute:function(){return u.n.wrap(3)},isVisible:t,icon:new l.e("Cancel"),isDefault:!0},{name:a.ok,execute:function(){return u.n.wrap(3)},isVisible:n,icon:new l.e("Cancel"),isDefault:!0}]})};t.prototype._shouldShowDialog=function(){for(var e=0,t=this._itemSetSelectionModel.selection.peek();e<t.length;e++){var n=t[e];if(!this.peekUnwrapObservable(n))return!0}return!1};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{dialogProvider:s.e,promiseTracker:c.O.optional,itemSetSelectionModel:c.C});return t})(i.n);function v(e){var t=e.selection();if(1===t.length){var n=Object(h.i)(t[0]);return n.appMap?n.appMap:"nonOfficeApp"}}var m=Object(p.s)("SelectionHelper",d)},function(e,t,n){"use strict";n.d(t,"n",function(){return f});n.d(t,"e",function(){return l});n.d(t,"t",function(){return h});var r=n(4),i=n("react-lib"),s=n(990),o=n(86),u=n(705),a=n(1732);function f(e,t){for(var n=[],s=2;s<arguments.length;s++)n[s-2]=arguments[s];var o=e;return o.isSlot?0===(n=i.Children.toArray(n)).length?o(t):o(Object(r.e)(Object(r.e)({},t),{children:n})):i.createElement.apply(i,Object(r.o)([e,t],n))}function l(e,t){void 0===t&&(t={});var n=t.defaultProp,o=void 0===n?"children":n;return function(t,n,f,l,c){if(i.isValidElement(n))return n;var h=(function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];for(var i={},o=[],f=0,l=n;f<l.length;f++){var c=l[f];o.push(c&&c.className);Object(a.e)(i,c)}i.className=Object(s.e)([e,o],{rtl:Object(u.e)(t)});return i})(l,c,t,(function(e,t){var n,r;r="string"==typeof t||"number"==typeof t||"boolean"==typeof t?((n={})[e]=t,n):t;return r})(o,n));if(f){if(f.component){var p=f.component;return i.createElement(p,Object(r.e)({},h))}if(f.render)return f.render(h,e)}return i.createElement(e,Object(r.e)({},h))}}var c=Object(o.t)(function(e){return l(e)});function h(e,t){var n={},r=e,i=function(e){if(t.hasOwnProperty(e)){var i=function(n){for(var i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];if(i.length>0)throw new Error("Any module using getSlots must use withSlots. Please see withSlots javadoc for more info.");return p(t[e],n,r[e],r.slots&&r.slots[e],r._defaultStyles&&r._defaultStyles[e],r.theme)};i.isSlot=!0;n[e]=i}};for(var s in t)i(s);return n}function p(e,t,n,r,i,s){return void 0!==e.create?e.create(t,n,r,i):c(e)(t,n,r,i,s)}},function(e,t,n){"use strict";var r;(function(e){e[e.initialized=0]="initialized";e[e.executed=1]="executed";e[e.failed=2]="failed"})(r||(r={}));t.e=r},function(e,t,n){"use strict";var r=n(0),i=n(218),s=n(1650),o=n(1011),u=n(717),a=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=n.resources.consume(i.T.optional);if(!r)return n;n.teachingBubbleProvider=r;n._value=n.valueAccessor();n._firstRunExperienceStatus=n.resources.consume(o.e);n._firstRunExperienceStatusKO=n.observables.create(n._firstRunExperienceStatus.get());n._firstRunExperienceStatus.subscribe(function(){n._firstRunExperienceStatusKO(n._firstRunExperienceStatus.get())});n.createBackgroundComputed(n._computeAddTeachingBubble);return n}t.prototype._computeAddTeachingBubble=function(){var e=this.unwrapObservable(this._value);if(e){var t=this.unwrapObservable(e.campaign);if(this._firstRunExperienceStatusKO()===u.e.notVisible&&t){this._campaign&&t.campaignGuid!==this._campaign.campaignGuid&&this.teachingBubbleProvider.currentBubble.get()&&this.teachingBubbleProvider.currentBubble.get().campaign===this._campaign&&this.teachingBubbleProvider.clearCurrentBubble();this._campaign=t;this.teachingBubbleProvider.addBubble({bubble:t,element:this.element})}}};return t})(s.t);t.e=a},function(e,t,n){"use strict";var r=n(0),i=n(1650),s=n(220),o=n(156),u=new s.e,a=new o.t(window),f=0,l=[],c={};a.onAll(window,{resize:u.debounce(h,50),scroll:u.throttle(h,50,{leading:!1})});a.on(document,"transitionend",u.debounce(h,300),!0);function h(){for(var e in c)d(c[e])}function p(){for(;l.length;){var e=l.pop();if(!e.isDisposed){c[e.id]=e;d(e)}}}function d(e){if(void 0!==e.element.getBoundingClientRect){var t=e.element.getBoundingClientRect(),n=t.top<window.innerHeight&&t.bottom>=0;(e.allowHiddenSizeUpdates||n)&&e.size&&e.size(e.includePosition?{bottom:t.bottom,left:t.left,right:t.right,top:t.top,height:t.height,width:t.width}:{height:t.height,width:t.width});e.isOnScreen&&e.isOnScreen(n)}}var v=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=n.valueAccessor(),i={id:f++,element:n.element,isDisposed:!1,size:r.size,isOnScreen:r.isOnScreen,allowHiddenSizeUpdates:r.allowHiddenSizeUpdates,includePosition:!!r.includePosition};r.trigger&&n.createComputed(function(){r.trigger();d(i)});l.push(i);u.setTimeout(p,0);n.addDisposable({dispose:function(){i.isDisposed=!0;delete c[i.id]}});return n}return t})(i.t);t.e=v},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return i});var r="Click";function i(e){return e.charAt(0).toUpperCase()+e.slice(1)}},,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(896),i=n(109),s=Object(r.e)({eventName:"Action,Qos,",shortEventName:"Action",samplingFeature:{ODB:!0,ODC:"ActionEventLogging",Fallback:!1}},{pageType:1,queryType:1,logStartEnd:3},i.e)},function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return v});var r=n(0),i=n(221),s=n(11),o=n(76),u=n(218),a=n(1499),f=n(108),l=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._dataSource=n.sharingDataSource;return r}t.prototype.share=function(e,t,n){return this._dataSource.share(e,t)};t.dependencies={sharingDataSource:o.ie};return t})(i.e),c=Object(s.s)("ShareItemHelper",l),h=n(52),p=(function(){function e(e,t){this.item=e.item;this._dataSource=t.dataSource}e.prototype.getSettings=function(){var e=this;if(!this._settingsPromise){this._settingsPromise=this._dataSource.getSettings(this);this._settingsPromise.done(null,function(t){if(h.n.isCanceled(t)){e._settingsPromise=null;e._rawResponse=null}})}return this._settingsPromise};e.prototype.getPermissions=function(e){this._permissionsPromise&&!e||(this._permissionsPromise=this._dataSource.getPermissions(this));return this._permissionsPromise};e.prototype.cancelGetPermissionsPromise=function(){if(this._permissionsPromise){this._permissionsPromise.cancel();this._cleanCacheIfCancel()}};e.prototype.getLinks=function(){var e=this;this._linksPromise||(this._linksPromise=this._dataSource.getLinks(this).then(function(t){e._linksData=t;return t}));return this._linksPromise};e.prototype.cancelGetLinksPromise=function(){if(this._linksPromise){this._linksPromise.cancel();this._cleanCacheIfCancel()}};e.prototype.getBestSharingLink=function(e){return this._dataSource.getBestSharingLink(this,e)};e.prototype.setLink=function(e){var t=this._linksData;if(e&&t){var n=t.filter(function(t){return t&&t.role===e.role&&t.type===e.type});if(0===n.length)t.push(e);else{var r=n[0];r.url=e.url;r.expiration=e.expiration;r.isActive=e.isActive}}};e.prototype.doSharingScopesContainLinks=function(){return this._dataSource.doSharingScopesContainLinks()};e.prototype.getRawResponse=function(){var e=this;if(!this._rawResponse){this._rawResponse=this._dataSource.getRawResponse(this);this._rawResponse.done(null,function(t){h.n.isCanceled(t)&&(e._rawResponse=null)})}return this._rawResponse};e.prototype._cleanCacheIfCancel=function(){this._linksPromise=null;this._settingsPromise=null;this._permissionsPromise=null;this._rawResponse=null};return e})(),d=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._dataSource=n.sharingDataSource;r._sharingDataDataSource=n.sharingDataDataSource;r._itemProvider=n.externallySharedItemProvider||n.itemProvider;r._shareDataCache={};r._shareItemHelper=n.shareItemHelper;return r}t.prototype.getSharingInformation=function(e,t,n,r,i){return this._dataSource.getSharingInformation(e,t,n,r,"",i)};t.prototype.shareLink=function(e){var t=this;return this._dataSource.shareLink(e).then(function(n){if(n.link){t._invalidateCachedItem(e.items[0]);t._invalidateItem(e.items[0])}return n})};t.prototype.unshareLink=function(e){var t=this;return this._dataSource.unshareLink(e).then(function(n){t._invalidateCachedItem(e.item);t._invalidateItem(e.item);return n})};t.prototype.updatePermissions2=function(e,t,n){var r=this;return this._dataSource.updatePermissions2(e,t,n).then(function(e){r._invalidateCachedItem(t);r._invalidateItem(t);return e})};t.prototype.updatePermissionsMultiple=function(e,t,n,r,i){var s=this;return this._dataSource.updatePermissionsMultiple(e,t,n,r,i).then(function(e){s._invalidateCachedItem(t);s._invalidateItem(t);return e})};t.prototype.supportsExistingAccessOption=function(e){return this._dataSource.supportsExistingAccessOption(e)};t.prototype.getClientId=function(){return this._dataSource.getClientId()};t.prototype.parseRawSharingInformation=function(e){return this._dataSource.parseRawSharingInformation(e)};t.prototype.emailWithoutPermissioning=function(e,t,n){return this._dataSource.emailWithoutPermissioning(e,t,n)};t.prototype.checkPermissions=function(e,t){return this._dataSource.checkPermissions(e,t)};t.prototype.setAddressBarLinkCapability=function(e,t){return this._dataSource.setAddressBarLinkCapability(e,t)};t.prototype.getSharingData=function(e,t){var n=this._shareDataCache[e.id],r=n&&n.data;if(!r||e.eTag!==n.eTag||t){r=this.scope.attach(new p({item:e},{dataSource:this._sharingDataDataSource}));this._shareDataCache[e.id]={eTag:e.eTag,data:r}}return r};t.prototype.share=function(e,t){var n=this;return this._shareItemHelper.share(e,t).then(function(e){n._invalidateCache();return e})};t.prototype.unshare=function(e){var t=this;return this._dataSource.unshare(e).then(function(n){t._invalidateCache();var r=t._itemProvider;if(r){r.invalidateItem(e.parent.key);r.invalidateItem(e.key)}return n})};t.prototype.updatePermissions=function(e,t,n,r){var i=this;return this._dataSource.updatePermissions(e,t,n,r).then(function(e){i._invalidateCache();i._itemProvider&&i._itemProvider.invalidateItem(t.parent.key);return e})};t.prototype.manageSharingLinks=function(e,t){var n=this;if(t&&t.link&&t.link.shareId&&!t.create){var r={item:e[0],kind:t.link.kind,shareId:t.link.shareId};return this._dataSource.unshareLink(r).then(function(e){n._invalidateCachedItem(r.item);n._invalidateItem(r.item);return[]})}var i=(e=e&&e.length?e:[]).map(function(e){return n.getSharingData(e)});return this._dataSource.manageSharingLinks(i,t).then(function(t){n._invalidateCache();var r=e[0]&&e[0].parent&&e[0].parent.key;r&&n._itemProvider.invalidateItem(r);return t})};t.prototype._invalidateCache=function(){this._shareDataCache={}};t.prototype._invalidateCachedItem=function(e){e&&e.id&&this._shareDataCache[e.id]&&(this._shareDataCache[e.id]=null)};t.prototype._invalidateItem=function(e){this._itemProvider&&e&&e.parent&&e.parent.key&&this._itemProvider.invalidateItem(e.parent.key)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.e.dependencies),{sharingDataSource:o.ie,sharingDataDataSource:o.se.optional,navigation:f.e,externallySharedItemProvider:u.r.optional,itemProvider:a.resourceKey.optional,shareItemHelper:c});return t})(i.e),v=(t.default=d,Object(s.s)("SharingProvider",d))},function(e,t,n){"use strict";var r;(function(e){e[e.none=0]="none";e[e.htmlFileUpload=1]="htmlFileUpload";e[e.folderUpload=2]="folderUpload";e[e.downlevelUpload=3]="downlevelUpload";e[e.silverlightUpload=4]="silverlightUpload"})(r||(r={}));t.e=r},,function(e,t,n){"use strict";n.d(t,"n",function(){return d});n.d(t,"e",function(){return v});n.d(t,"t",function(){return m});n.d(t,"i",function(){return g});n.d(t,"r",function(){return y});var r=n(1016),i=n(1007),s=n(22),o=n(1766),u=n(1870),a=n(1833),f=n(23),l=n(219),c=n(1820),h=n(1836),p=n(1774);function d(e,t){switch(e.queryType){case f.e.Recent:return(function(e){var t=[],n=m(e)||e.name;n&&t.push(n);var r=e.displayPath;if(r){var i=r.segments.join(" "+u.u+" ");t.push(u.o+": "+i)}var s=e.dateAccessed;s&&t.push(a.p+" "+s);return t.join(", ")||void 0})(e);case f.e.Files:default:return(function(e,t){var n=[],r=m(e)||e.name,a=(function(e){if(e.dateDeleted&&(e.queryType===f.e.RecycleBin||e.queryType===f.e.SecondStageRecycleBin))return s.format(c.dateDeletedLabelFormat,e.dateDeleted);if(e.dateModified)return s.format(c.dateModifiedLabelFormat,e.dateModified);return})(e)||e.dateModified,l=e.defaultSubText,d=e.size,v=Object(h.e)(e.lifeCycleStatus);r&&n.push(r);v>0&&n.push((function(e){var t;return((t={})[3]=u.f,t[2]=u.i,t[4]=u.r,t[1]=u.n,t)[e]||""})(v));a&&n.push(a);l&&n.push(l);d&&n.push(i.e.getDisplayString(d,{ignoreZero:!0}));if(e.folder){var g=e.folder.totalCount,y=void 0===g?e.childCount:g;n.push(s.format(s.getLocalizedCountValue(c.itemCountFormat,c.itemCountIntervals,y),y))}e.sharingType===p.e.Shared?n.push(u.a):e.sharingType!==p.e.Unknown&&n.push(u.s);if(o.s(e)){var b=o.a();n.push(b)}t&&n.push(c.selected);return n.join(", ")||void 0})(e)}}function v(e){var t=e.extension,n=[];if(e.type===l.e.Folder)n.push(r.n(e.sharingType)?c.fileTypeSharedFolder:c.fileTypeFolder);else{var i=e.appMap;if(i){var o=i.toLowerCase();-1!==o.indexOf("ms-word")?n.push(c.fileTypeDoc):-1!==o.indexOf("ms-excel")?n.push(c.fileTypeXls):-1!==o.indexOf("ms-powerpoint")?n.push(c.fileTypePpt):-1!==o.indexOf("onenote")&&n.push(c.fileTypeOneNotebook)}else if(e.type===l.e.Media&&e.photo)n.push(s.format(c.fileTypeImage,t||"").trim());else if(t){var u="."===t[0]?t.substring(1):t;n.push(s.format(c.fileTypeUnknown,u))}else e.type===l.e.App&&e.properties&&e.properties.appTypeString?n.push(s.format(a.c,e.properties.appTypeString)):e.type===l.e.Subsite&&e.name&&n.push(s.format(a.c,e.name));var f=g(e);f&&n.push(f)}return n.join(", ")}function m(e){var t=[],n=v(e);t.push(e.name);n&&t.push(n);return t.join(", ")}function g(e){var t=[];e.itemStatus?t.push(c.sharedViolationWarningViewer):e.isViolation&&t.push(c.sharedViolationWarning);e.policyTip&&(2&e.policyTip?t.push(c.policyTipBlockText):1===e.policyTip&&t.push(c.policyTipNotifyText));e.hasMissingMetadata&&t.push(c.missingMetadataText);if(o.s(e)){var n=o.a();t.push(n)}var r=e.properties.CheckoutUser,i=(void 0===r?[]:r)[0],u=(void 0===i?{}:i).title,a=void 0===u?void 0:u;a&&t.push(s.format(c.checkedOutTo,a));return t.join(" ")}function y(){return c.toggleSelection}},function(e,t,n){"use strict";var r=n(52),i=n("knockout-lib"),s=n(1702),o=Object(s.e)("ms-contextual-menu","./react/ReactContextualMenu",function(){return r.n.resolve(n.ee(["176"],4396))});o.template='\x3c!--ko component:{name:\'od-overlay\',params:{alignToParent:false}}--\x3e<div role="application" data-bind="react:reactBindingParams"></div>\x3c!--/ko--\x3e';i.components.isRegistered(o.tagName)||i.components.register(o.tagName,o)},,function(e,t,n){"use strict";var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.errorType=t.errorType||0;n.payloads=t.payloads||{};return n}return t})(n(53).e);t.e=i},,function(e,t,n){"use strict";n.d(t,"e",function(){return M});var r=n(1419),i=n(4),s=n("react-lib"),o=n(472),u=n(86),a=n(705),f=n(1957),l=n(270),c=n(25),h=n(993),p=n(1670),d=n(1675),v=Object(o.e)({cacheSize:100}),m=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;n._onRenderIcon=function(e,t){return s.createElement(h.e,{className:e,iconName:g(n.props.presence,n.props.isOutOfOffice),style:t})};return n}t.prototype.render=function(){var e=this.props,t=e.coinSize,n=e.isOutOfOffice,r=e.styles,i=e.presence,o=e.theme,u=e.presenceTitle,a=e.presenceColors,f=Object(d.r)(this.props.size),l=!(f.isSize8||f.isSize10||f.isSize16||f.isSize24||f.isSize28||f.isSize32)&&(!t||t>32),c=t?t/3<40?t/3+"px":"40px":"",h=t?{fontSize:t?t/6<20?t/6+"px":"20px":"",lineHeight:c}:void 0,m=t?{width:c,height:c}:void 0,g=v(r,{theme:o,presence:i,size:this.props.size,isOutOfOffice:n,presenceColors:a});return i===p.t.none?null:s.createElement("div",{role:"presentation",className:g.presence,style:m,title:u},l&&this._onRenderIcon(g.presenceIcon,h))};return t})(s.Component);function g(e,t){if(e){switch(p.t[e]){case"online":return"SkypeCheck";case"away":return t?"SkypeArrow":"SkypeClock";case"dnd":return"SkypeMinus";case"offline":return t?"SkypeArrow":""}return""}}var y={presence:"ms-Persona-presence",presenceIcon:"ms-Persona-presenceIcon"};function b(e){return{color:e,borderColor:e}}function w(e,t){return{selectors:{":before":{border:e+" solid "+t}}}}function E(e){return{height:e,width:e}}function S(e){return{backgroundColor:e}}var x=Object(r.e)(m,function(e){var t,n,r,s,o,u,a=e.theme,f=e.presenceColors,l=a.semanticColors,h=a.fonts,p=Object(c.x)(y,a),v=Object(d.r)(e.size),m=Object(d.n)(e.presence),g=f&&f.available||"#6BB700",x=f&&f.away||"#FFAA44",T=f&&f.busy||"#C43148",N=f&&f.dnd||"#C50F1F",C=f&&f.offline||"#8A8886",k=f&&f.oof||"#B4009E",L=f&&f.background||l.bodyBackground,A=m.isOffline||e.isOutOfOffice&&(m.isAvailable||m.isBusy||m.isAway||m.isDoNotDisturb),O=v.isSize72||v.isSize100?"2px":"1px";return{presence:[p.presence,Object(i.e)(Object(i.e)({position:"absolute",height:d.e.size12,width:d.e.size12,borderRadius:"50%",top:"auto",right:"-2px",bottom:"-2px",border:"2px solid "+L,textAlign:"center",boxSizing:"content-box",backgroundClip:"content-box"},Object(c.T)()),{selectors:(t={},t[c.s]={borderColor:"Window",backgroundColor:"WindowText"},t)}),(v.isSize8||v.isSize10)&&{right:"auto",top:"7px",left:0,border:0,selectors:(n={},n[c.s]={top:"9px",border:"1px solid WindowText"},n)},(v.isSize8||v.isSize10||v.isSize24||v.isSize28||v.isSize32)&&E(d.e.size8),(v.isSize40||v.isSize48)&&E(d.e.size12),v.isSize16&&{height:d.e.size6,width:d.e.size6,borderWidth:"1.5px"},v.isSize56&&E(d.e.size16),v.isSize72&&E(d.e.size20),v.isSize100&&E(d.e.size28),v.isSize120&&E(d.e.size32),m.isAvailable&&{backgroundColor:g,selectors:(r={},r[c.s]=S("Highlight"),r)},m.isAway&&S(x),m.isBlocked&&[{selectors:(s={":after":v.isSize40||v.isSize48||v.isSize72||v.isSize100?{content:'""',width:"100%",height:O,backgroundColor:T,transform:"translateY(-50%) rotate(-45deg)",position:"absolute",top:"50%",left:0}:void 0},s[c.s]={selectors:{":after":{width:"calc(100% - 4px)",left:"2px",backgroundColor:"Window"}}},s)}],m.isBusy&&S(T),m.isDoNotDisturb&&S(N),m.isOffline&&S(C),(A||m.isBlocked)&&[{backgroundColor:L,selectors:(o={":before":{content:'""',width:"100%",height:"100%",position:"absolute",top:0,left:0,border:O+" solid "+T,borderRadius:"50%",boxSizing:"border-box"}},o[c.s]={backgroundColor:"WindowText",selectors:{":before":{width:"calc(100% - 2px)",height:"calc(100% - 2px)",top:"1px",left:"1px",borderColor:"Window"}}},o)}],A&&m.isAvailable&&w(O,g),A&&m.isBusy&&w(O,T),A&&m.isAway&&w(O,k),A&&m.isDoNotDisturb&&w(O,N),A&&m.isOffline&&w(O,C),A&&m.isOffline&&e.isOutOfOffice&&w(O,k)],presenceIcon:[p.presenceIcon,{color:L,fontSize:"6px",lineHeight:d.e.size12,verticalAlign:"top",selectors:(u={},u[c.s]={color:"Window"},u)},v.isSize56&&{fontSize:"8px",lineHeight:d.e.size16},v.isSize72&&{fontSize:h.small.fontSize,lineHeight:d.e.size20},v.isSize100&&{fontSize:h.medium.fontSize,lineHeight:d.e.size28},v.isSize120&&{fontSize:h.medium.fontSize,lineHeight:d.e.size32},m.isAway&&{position:"relative",left:A?void 0:"1px"},A&&m.isAvailable&&b(g),A&&m.isBusy&&b(T),A&&m.isAway&&b(k),A&&m.isDoNotDisturb&&b(N),A&&m.isOffline&&b(C),A&&m.isOffline&&e.isOutOfOffice&&b(k)]}},void 0,{scope:"PersonaPresence"}),T=n(869),N=n(106),C=n(1765),k=Object(o.e)({cacheSize:100}),L=Object(u.t)(function(e,t,n,r,i,s){return Object(c.H)(e,!s&&{backgroundColor:Object(C.e)({text:r,initialsColor:t,primaryText:i}),color:n})}),A=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;n._onRenderCoin=function(e){var t=n.props,r=t.coinSize,i=t.styles,o=t.imageUrl,u=t.imageAlt,a=t.imageShouldFadeIn,f=t.imageShouldStartVisible,l=t.theme,c=t.showUnknownPersonaCoin;if(!o)return null;var h=n.props.size,p=k(i,{theme:l,size:h,showUnknownPersonaCoin:c}),v=r||d.i[h];return s.createElement(T.e,{className:p.image,imageFit:N.t.cover,src:o,width:v,height:v,alt:u,shouldFadeIn:a,shouldStartVisible:f,onLoadingStateChange:n._onPhotoLoadingStateChange})};n._onRenderInitials=function(e){var t=e.imageInitials,r=e.allowPhoneInitials;if(e.showUnknownPersonaCoin)return s.createElement(h.e,{iconName:"Help"});var i=Object(a.e)(n.props.theme);return""!==(t=t||Object(f.e)(n._getText(),i,r))?s.createElement("span",null,t):s.createElement(h.e,{iconName:"Contact"})};n._onPhotoLoadingStateChange=function(e){n.setState({isImageLoaded:e===N.n.loaded,isImageError:e===N.n.error});n.props.onPhotoLoadingStateChange&&n.props.onPhotoLoadingStateChange(e)};0;n.state={isImageLoaded:!1,isImageError:!1};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.imageUrl!==this.props.imageUrl&&this.setState({isImageLoaded:!1,isImageError:!1})};t.prototype.render=function(){var e=this.props,t=e.className,n=e.coinProps,r=e.showUnknownPersonaCoin,o=e.coinSize,u=e.styles,a=e.imageUrl,f=e.initialsColor,c=e.initialsTextColor,d=e.isOutOfOffice,v=e.onRenderCoin,m=void 0===v?this._onRenderCoin:v,g=e.onRenderPersonaCoin,y=void 0===g?m:g,b=e.onRenderInitials,w=void 0===b?this._onRenderInitials:b,E=e.presence,S=e.presenceTitle,T=e.presenceColors,N=e.primaryText,C=e.showInitialsUntilImageLoads,A=e.text,O=e.theme,M=this.props.size,_=Object(l.u)(this.props,l.s),D=Object(l.u)(n||{},l.s),P=o?{width:o,height:o}:void 0,H=r,B={coinSize:o,isOutOfOffice:d,presence:E,presenceTitle:S,presenceColors:T,size:M,theme:O},j=k(u,{theme:O,className:n&&n.className?n.className:t,size:M,coinSize:o,showUnknownPersonaCoin:r}),F=Boolean(!this.state.isImageLoaded&&(C&&a||!a||this.state.isImageError||H));return s.createElement("div",Object(i.e)({role:"presentation"},_,{className:j.coin}),M!==p.n.size8&&M!==p.n.size10&&M!==p.n.tiny?s.createElement("div",Object(i.e)({role:"presentation"},D,{className:j.imageArea,style:P}),F&&s.createElement("div",{className:L(j.initials,f,c,A,N,r),style:P,"aria-hidden":"true"},w(this.props,this._onRenderInitials)),!H&&y(this.props,this._onRenderCoin),s.createElement(x,Object(i.e)({},B))):this.props.presence?s.createElement(x,Object(i.e)({},B)):s.createElement(h.e,{iconName:"Contact",className:j.size10WithoutPresenceIcon}),this.props.children)};t.prototype._getText=function(){return this.props.text||this.props.primaryText||""};t.defaultProps={size:p.n.size48,presence:p.t.none,imageAlt:""};return t})(s.Component),O={coin:"ms-Persona-coin",imageArea:"ms-Persona-imageArea",image:"ms-Persona-image",initials:"ms-Persona-initials",size8:"ms-Persona--size8",size10:"ms-Persona--size10",size16:"ms-Persona--size16",size24:"ms-Persona--size24",size28:"ms-Persona--size28",size32:"ms-Persona--size32",size40:"ms-Persona--size40",size48:"ms-Persona--size48",size56:"ms-Persona--size56",size72:"ms-Persona--size72",size100:"ms-Persona--size100",size120:"ms-Persona--size120"},M=Object(r.e)(A,function(e){var t,n=e.className,r=e.theme,s=e.coinSize,o=r.palette,u=r.fonts,a=Object(d.r)(e.size),f=Object(c.x)(O,r),l=s||e.size&&d.i[e.size]||48;return{coin:[f.coin,u.medium,a.isSize8&&f.size8,a.isSize10&&f.size10,a.isSize16&&f.size16,a.isSize24&&f.size24,a.isSize28&&f.size28,a.isSize32&&f.size32,a.isSize40&&f.size40,a.isSize48&&f.size48,a.isSize56&&f.size56,a.isSize72&&f.size72,a.isSize100&&f.size100,a.isSize120&&f.size120,n],size10WithoutPresenceIcon:{fontSize:u.xSmall.fontSize,position:"absolute",top:"5px",right:"auto",left:0},imageArea:[f.imageArea,{position:"relative",textAlign:"center",flex:"0 0 auto",height:l,width:l},l<=10&&{overflow:"visible",background:"transparent",height:0,width:0}],image:[f.image,{marginRight:"10px",position:"absolute",top:0,left:0,width:"100%",height:"100%",border:0,borderRadius:"50%",perspective:"1px"},l<=10&&{overflow:"visible",background:"transparent",height:0,width:0},l>10&&{height:l,width:l}],initials:[f.initials,{borderRadius:"50%",color:e.showUnknownPersonaCoin?"rgb(168, 0, 0)":o.white,fontSize:u.large.fontSize,fontWeight:c.i.semibold,lineHeight:48===l?46:l,height:l,selectors:(t={},t[c.s]=Object(i.e)(Object(i.e)({border:"1px solid WindowText"},Object(c.T)()),{color:"WindowText",boxSizing:"border-box",backgroundColor:"Window !important"}),t.i={fontWeight:c.i.semibold},t)},e.showUnknownPersonaCoin&&{backgroundColor:"rgb(234, 234, 234)"},l<32&&{fontSize:u.xSmall.fontSize},l>=32&&l<40&&{fontSize:u.medium.fontSize},l>=40&&l<56&&{fontSize:u.mediumPlus.fontSize},l>=56&&l<72&&{fontSize:u.xLarge.fontSize},l>=72&&l<100&&{fontSize:u.xxLarge.fontSize},l>=100&&{fontSize:u.superLarge.fontSize}]}},void 0,{scope:"PersonaCoin"})},,function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(0),i=n("react-lib");function s(e,t){return{definitionKey:e,props:t}}var o=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=n.props,i=r.specification,s=r.placeholder,o=r.resources;n.state={componentType:i&&(u(i)?i.componentType:o.consume(i.definitionKey.optional)),placeholderType:s&&(u(s)?s.componentType:o.consume(s.definitionKey.optional))};return n}t.prototype.componentDidMount=function(){var e=this,t=this.props.specification;this.state.componentType||t&&!u(t)&&(this._resolveSpecificationPromise=this.props.resources.consumeAsync(t.definitionKey).then(function(t){e.setState({componentType:t})}))};t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.specification,n=e.placeholder,r=e.resources;t===this.props.specification&&r===this.props.resources||this.setState({componentType:t&&(u(t)?t.componentType:this.props.resources.consume(t.definitionKey.optional))});n===this.props.placeholder&&r===this.props.resources||this.setState({placeholderType:n&&(u(n)?n.componentType:r.consume(n.definitionKey.optional))})};t.prototype.componentDidUpdate=function(e,t){var n=this,r=this.props,i=r.specification,s=r.resources;if(i!==e.specification||s!==this.props.resources){if(this._resolveSpecificationPromise){this._resolveSpecificationPromise.cancel();this._resolveSpecificationPromise=void 0}this.state.componentType||i&&!u(i)&&(this._resolveSpecificationPromise=this.props.resources.consumeAsync(i.definitionKey).then(function(e){n.setState({componentType:e})}))}};t.prototype.componentWillUnmount=function(){this._resolveSpecificationPromise&&this._resolveSpecificationPromise.cancel()};t.prototype.render=function(){var e=this.state,t=e.componentType,n=e.placeholderType;return t?i.createElement(t,Object(r.__assign)({key:"content"},this.props.specification.props)):n?i.createElement(n,Object(r.__assign)({key:"placeholder"},this.props.placeholder.props)):null};return t})(i.Component);function u(e){return!!e.componentType}},,function(e,t,n){"use strict";n.d(t,"e",function(){return d});var r=n(1419),i=n(4),s=n("react-lib"),o=n(472),u=n(886),a=n(881),f=n(270),l=Object(o.e)(),c=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;Object(u.e)(n);var r=n.props.allowTouchBodyScroll,i=void 0!==r&&r;n._allowTouchBodyScroll=i;return n}t.prototype.componentDidMount=function(){!this._allowTouchBodyScroll&&Object(a.n)()};t.prototype.componentWillUnmount=function(){!this._allowTouchBodyScroll&&Object(a.r)()};t.prototype.render=function(){var e=this.props,t=e.isDarkThemed,n=e.className,r=e.theme,o=e.styles,u=Object(f.u)(this.props,f.s),a=l(o,{theme:r,className:n,isDark:t});return s.createElement("div",Object(i.e)({},u,{className:a.root}))};return t})(s.Component),h=n(25),p={root:"ms-Overlay",rootDark:"ms-Overlay--dark"},d=Object(r.e)(c,function(e){var t,n=e.className,r=e.theme,i=e.isNone,s=e.isDark,o=r.palette,u=Object(h.x)(p,r);return{root:[u.root,r.fonts.medium,{backgroundColor:o.whiteTranslucent40,top:0,right:0,bottom:0,left:0,position:"absolute",selectors:(t={},t[h.s]={border:"1px solid WindowText",opacity:0},t)},i&&{visibility:"hidden"},s&&[u.rootDark,{backgroundColor:o.blackTranslucent40}],n]}},void 0,{scope:"Overlay"})},,function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(4),i=n("react-lib"),s=n(1786),o=n(1956),u=n(270),a=n(25),f={root:"ms-StackItem"},l={start:"flex-start",end:"flex-end"},c=Object(o.e)(function(e){var t=e.children,n=Object(u.u)(e,u.a);if(i.Children.count(t)<1)return null;var o=Object(s.t)(e,{root:"div"});return Object(s.n)(o.root,Object(r.e)({},n),t)},{displayName:"StackItem",styles:function(e,t,n){var r=e.grow,i=e.shrink,s=e.disableShrink,o=e.align,u=e.verticalFill,c=e.order,h=e.className,p=Object(a.x)(f,t);return{root:[t.fonts.medium,p.root,{margin:n.margin,padding:n.padding,height:u?"100%":"auto",width:"auto"},r&&{flexGrow:!0===r?1:r},(s||!r&&!i)&&{flexShrink:0},i&&!s&&{flexShrink:1},o&&{alignSelf:l[o]||o},c&&{order:c},h]}}})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(138);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ActivityIndicator{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);z-index:2;text-align:center}.od-ActivityIndicator .ms-Spinner{display:inline-block;width:1.75rem}.od-ActivityIndicator span{font-size:1rem}\n"}]);var s=n("react-lib"),o=n(1637),u=n(390),a=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return s.createElement("div",{className:"od-ActivityIndicator","aria-hidden":this.props.ariaHidden,"aria-live":"assertive"},s.createElement("div",null,s.createElement(o.e,{type:u.t.large,styles:{circle:{width:"1.75rem",height:"1.75rem",borderWidth:"0.09375rem"},label:{fontSize:"0.75rem"}}})),s.createElement("span",{role:"alert"},this.props.message))};return t})(s.Component)},,,function(e,t,n){"use strict";var r=n(0),i=n(1649),s=n(530),o=n(49),u=n(135),a=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,void 0,n)||this;r._pageContext=t||r.resources.consume(o.h);var i=null==n?void 0:n.dataRequestorType;r._makeDataRequestor=i?function(e){return new i(e)}:function(e){return new s.e(e,{pageContext:r._pageContext})};r.dataRequestor=r._makeDataRequestor({qosName:r.getDataSourceName()});return r}t.prototype.getDataSourceName=function(){return"DataSource"};t.prototype.updateContext=function(e){u.e(this._pageContext,e);this.dataRequestor=this._makeDataRequestor({qosName:this.getDataSourceName()})};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{dataRequestorType:s.n});return t})(i.n);t.e=a},,function(e,t,n){"use strict";n.d(t,"e",function(){return b});var r=n(0),i=n(289),s=n(471),o=n(997),u=n(1709),a=n(52),f=n(1741),l=n(532),c=n(144),h=n(1854),p=n(1430),d=n(611),v=n(70),m=n(1825),g=n(66),y={ODB:60307},b=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=this,i=w(t)?t:n.pageContext;r=e.call(this,{},{pageContext:i})||this;var s=w(t)?t.apiUrlHelper:n.apiUrlHelper;r._apiUrlHelper=s||new l.e({},{itemUrlHelper:new c.e({},{pageContext:i}),pageContext:i});r._capabilities={supportsMruCaching:!0};if(n){r._dataRequestor=n.dataRequestor;r._graphPeoplePickerHelper=n.graphPeoplePickerHelper;r._substratePeoplePickerHelper=n.substratePeoplePickerHelper;r._livePeoplePickerHelper=n.livePeoplePickerHelper;r._getAuthToken=n.getAuthToken}r._webAbsoluteUrl=i.webAbsoluteUrl;return r}t.prototype.getCapabilities=function(){return this._capabilities};t.prototype.getPersonaDetails=function(e){var t=this;return a.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("sp.publishing.personmagazine.GetPersonMagazineUserProfileDataForUser").parameter("accountName",e).toString(),qosName:"GetPersonaDetails",authToken:n,parseResponse:function(e){var n=function(e){return{name:e.DisplayName,email:e.Email,userId:e.AccountName,office:e.Office,image:e.PictureUrl,job:e.Title,department:e.DepartmentName,phone:e.Phone,sip:e.Lync}},r=JSON.parse(e).d.GetPersonMagazineUserProfileDataForUser,s={personDetails:n(r.Primary),managerChain:r.ManagerChain.results.map(n),directReports:r.DirectReports.results.map(n)};s.personDetails.profilePage=Object(i.r)(t._pageContext)+"/_layouts/15/me.aspx?p="+encodeURIComponent(s.personDetails.sip)+"&origin=ProfileODBCard";return s}})})};t.prototype.getPickerEntityInformation=function(e){var t=this,n=0;e.principalType===u.e.sharePointGroup&&(n=Number(e.rawPersonData.EntityData.SPGroupID));var r=JSON.stringify({entityInformationRequest:{PrincipalType:e.principalType,EmailAddress:e.email,GroupId:n}});return a.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.GetPickerEntityInformation").toString(),additionalPostData:r,qosName:"getPickerEntityInformation",authToken:n,noRedirect:!0,parseResponse:function(t){return{totalMemberCount:JSON.parse(t).d.TotalMemberCount,person:e}}})})};t.prototype.resolve=function(e,t){var n=this;return a.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(r){return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerResolveUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Resolve",authToken:r,parseResponse:function(e){var r=JSON.parse(e),i=JSON.parse(r.d.ClientPeoplePickerResolveUser),s=[];s[0]=i;i.IsResolved||i.EntityData.IsBlockedOnODB&&"true"===i.EntityData.IsBlockedOnODB.toLowerCase()||(s[0].DisplayText=i.Key);var o=(s=n._transformData(s,t.filterExternalUsers))[0];if(t.filterExternalUsers&&o&&1===o.entityType){o.isResolved=!1;o.entityType=0}else if(t.blockViaPolicy&&!t.filterExternalUsers&&o&&!o.isResolved&&0===o.multipleMatches.length){o.isResolved=!0;o.isExternal=!0;o.entityType=1}if(t.isGraphDistributionList&&t.useGraph&&o.isExternal){o.entityType=2;o.principalType=u.e.distributionList}return o}})})};t.prototype.canUseGraph=function(e){var t=e&&e.useGraph&&this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();t&&!this._dataRequestor&&(this._dataRequestor=new p.t({},{}));return t};t.prototype.canUseSubstrate=function(e){var t=e.useSubstrate&&this._substratePeoplePickerHelper&&this._substratePeoplePickerHelper.canUseSubstrate();t&&!this._dataRequestor&&(this._dataRequestor=new p.t({},{}));return t};t.prototype.getLivePersonaPickerHelper=function(){return this._livePeoplePickerHelper};t.prototype.search=function(e,t){return this.canUseSubstrate(t)?this._substrateSearch(e,t):this.canUseGraph(t)?this._graphSearch(e,t):this.sharePointSearch(e,t)};t.prototype.sharePointSearch=function(e,t){var n=this;t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!1);return a.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(r){return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerSearchUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Search",authToken:r,parseResponse:function(r){var i=t.allowSharePointGroups,s=void 0===i||i,o=t.filterExternalUsers,a=JSON.parse(r),f=JSON.parse(a.d.ClientPeoplePickerSearchUser),l=n._transformData(f,o);o&&(l=l.filter(function(e){return 1!==e.entityType}));l=l.filter(function(e){return e.principalType===u.e.sharePointGroup?s:e.principalType===u.e.securityGroup?s||n._isValidEmail(e.email,!0):n._isValidEmail(e.email,!1)});if(!1!==t.resolveEmailIfNoResults&&0===l.length&&n._isValidEmail(e,!1)){var c={Key:e,IsResolved:!1};l.push({email:e,entityType:1,isResolved:!1,job:!1===t.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:c,rawPersonData:c,isExternal:!0})}return l}})})};t.prototype.subscribePresence=function(e,t){var n=this;try{this._ensureSkypePresence();if(!O365Shell_Shim.SkypeIntegration.isAvailable())return null;var r=function(e){try{switch(e){case 0:t(0);break;case 1:t(1);break;case 2:t(2);break;case 3:t(3);break;case 4:t(4);break;case 5:t(5);break;case 6:t(6);break;case 8:t(7);break;default:t(0)}}catch(e){}};this._skypeIntegration.TrackPresence(e,r);return{dispose:function(){try{n._skypeIntegration.UntrackPresence(e,r)}catch(e){}}}}catch(e){}return null};t.prototype.sendSourceName=function(){return"PeoplePickerDataSource"};t.prototype._constructPostBody=function(e,t){var n={queryParams:{QueryString:e,MaximumEntitySuggestions:t.maximumEntitySuggestions,AllowEmailAddresses:t.allowEmailAddresses,AllowOnlyEmailAddresses:t.allowOnlyEmailAddresses,PrincipalType:t.principalType,PrincipalSource:t.principalSource,UseSubstrateSearch:t.useSubstrateSearch,SharePointGroupID:t.groupID,QuerySettings:t.querySettings}};return JSON.stringify(n)};t.prototype._ensureSkypePresence=function(){var e=this;try{if(!Boolean(this._skypeIntegration)){var t=new O365Shell_Shim.SkypeIntegration;t.OnApiReady(function(){e._skypeIntegration=t})}}catch(e){}};t.prototype._graphSearch=function(e,n){var r=this;return this._graphPeoplePickerHelper.getGraphToken().then(function(i){if(!i)return r.sharePointSearch(e,n);var s=new g.t("https://graph.microsoft.com/v1.0/me/people");if(e){s.setQueryFromObject({$search:'"'+e+'"',$top:"30",$select:"displayName,scoredEmailAddresses,personType,department,jobTitle,userPrincipalName"});if(v.t.isActivated("08c31a2f-5109-4dd9-b6ab-d6ea8fec0d9f","09/29/2020","Fix bug: Should correctly handle PrincipalType in Graph query filter."))!1!==n.filterPublicDistributionList&&s.setQueryParameter("$filter","personType/subclass ne 'PublicDistributionList'");else{var o=t._getPersonTypeFilter(n);o&&s.setQueryParameter("$filter",o)}}return r._dataRequestor.send({apiName:"Graph.PeopleSearch",path:s.toString(),headers:{Authorization:"Bearer "+i,"X-PeopleQuery-QuerySources":"Mailbox,Directory"},needsAuthorization:!1}).then(function(t){n.onToggleGetMoreResults&&n.onToggleGetMoreResults(!0);if(!t||!t.value||0===t.value.length)return r.sharePointSearch(e,n);var i=t.value,s=[];i.forEach(function(e){if(!e.personType.subclass||!r._isIgnorablePeopleSubType(e.personType.subclass)){var t=e.scoredEmailAddresses[0]?e.scoredEmailAddresses[0].address:"",i=e.userPrincipalName&&r._isValidEmail(e.userPrincipalName,!1)?e.userPrincipalName:t,o={Key:i,IsResolved:!1},a="ImplicitContact"===e.personType.subclass,f="OrganizationUser"===e.personType.subclass,l="Group"===e.personType.class&&"UnifiedGroup"===e.personType.subclass,c="PublicDistributionList"===e.personType.subclass,p=Object(h.n)(r._webAbsoluteUrl,t),d={department:e.department,email:t,image:a?void 0:p,job:!1===n.fallbackToEmailIfNoJob?e.jobTitle:e.jobTitle||t,name:e.displayName,providerName:f?"Provider":void 0,userId:i,rawData:o,rawPersonData:o,isExternal:!f,aadObjectId:e.id};if(f){d.entityType=0;d.principalType=u.e.user;d.isResolved=!0}else if(l){d.entityType=2;d.principalType=u.e.securityGroup;d.isResolved=!1;d.userId=e.id}else{d.principalType=c?u.e.distributionList:u.e.none;d.entityType="Group"===e.personType.class?2:1;d.isResolved=!1;d.providerName=void 0}d.userId&&s.push(d)}});if(!1!==n.resolveEmailIfNoResults&&0===s.length&&r._isValidEmail(e,!1)){var o={Key:e,IsResolved:!1};s.push({email:e,entityType:1,isResolved:!1,job:!1===n.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:o,rawPersonData:o,isExternal:!0})}return s},function(t){if(Object(d.s)(t))switch(t.status){case 400:case 401:case 403:case 404:r._graphPeoplePickerHelper.disableGraphCallsForPicker();return r.sharePointSearch(e,n);default:return r.sharePointSearch(e,n)}else"Canceled"!==t.name&&r._graphPeoplePickerHelper.disableGraphCallsForPicker();return"Canceled"===t.name?null:r.sharePointSearch(e,n)})})};t.prototype._substrateSearch=function(e,t){var n=this;return this._substratePeoplePickerHelper.getSubstrateToken().then(function(r){if(!r)return n.sharePointSearch(e,t);var i=null;t.siteIBSegmentIDs&&t.siteIBSegmentIDs.length>0&&(i=t.siteIBSegmentIDs);var o=["Mailbox","Directory"],a={Authorization:"Bearer "+r},l="";l=s.n.isFeatureEnabled(y)&&!v.t.isActivated("0576d3d3-42b4-4c60-a920-0e10e34a19a0","05/13/2021","Pass SiteIBMode to 3S.")?JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:o,Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],InformationBarrierMode:t.siteIBMode,Filter:i?{Or:i.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}}):JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:o,Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],Filter:i?{Or:i.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}});return n._dataRequestor.send({apiName:"Substrate.PeopleSearch",path:f.e+"/api/v1/suggestions",headers:a,needsAuthorization:!1,requestType:"POST",postData:l}).then(function(r){t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!0);var i=r.Groups[0]?r.Groups[0].Suggestions:[],s=[];i.forEach(function(e){if(!e.PeopleSubtype||!n._isIgnorablePeopleSubType(e.PeopleSubtype)){var r=e.EmailAddresses[0]||e.QueryText||"",i=e.UserPrincipalName&&n._isValidEmail(e.UserPrincipalName,!1)?e.UserPrincipalName:r,o={Key:i,IsResolved:!1},a="ImplicitContact"===e.PeopleSubtype,f="OrganizationUser"===e.PeopleSubtype,l="LinkedIn"===e.PeopleSubtype,c="Group"===e.PeopleType&&"UnifiedGroup"===e.PeopleSubtype,p="PublicDistributionList"===e.PeopleSubtype,d=Object(h.n)(n._webAbsoluteUrl,r),v={department:e.Department,office:e.OfficeLocation,email:r,image:a?void 0:d,job:!1===t.fallbackToEmailIfNoJob?e.JobTitle:e.JobTitle||r,name:e.DisplayName,providerName:"Provider",userId:i,rawData:o,rawPersonData:o,isExternal:!f};if(f){v.entityType=0;v.principalType=u.e.user;v.isResolved=!0}else if(c){v.entityType=2;v.principalType=u.e.securityGroup;v.isResolved=!1;v.providerName=void 0}else if(l)v.entityType=4;else{v.principalType=p?u.e.distributionList:u.e.none;v.entityType="Group"===e.PeopleType?2:1;v.isResolved=!1;v.providerName=void 0}v.userId&&s.push(v)}});if(!1!==t.resolveEmailIfNoResults&&0===s.length&&n._isValidEmail(e,!1)){var o={Key:e,IsResolved:!1};s.push({email:e,entityType:1,isResolved:!1,job:!1===t.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:o,rawPersonData:o,isExternal:!0})}return s},function(r){if("Canceled"!==r.name){n._substratePeoplePickerHelper.disableSubstrateCallsForPicker();n.sharePointSearch(e,t)}return null})})};t.prototype._isValidEmail=function(e,t){return e?!(e.indexOf(" ")>-1||e.indexOf(";")>-1)&&m.e.isValidEmailSyntax(e,!1):!t};t._getPersonTypeFilter=function(e){if(e.principalType===u.e.user)return"personType/class ne 'Group'";var t="";e.principalType&u.e.distributionList||(t+="personType/subclass ne 'PublicDistributionList'");if(!(e.principalType&u.e.securityGroup)){t&&(t+=" and ");t+="personType/subclass ne 'UnifiedGroup'"}return t||(!1!==e.filterPublicDistributionList?"personType/subclass ne 'PublicDistributionList'":"")};t.prototype._isIgnorablePeopleSubType=function(e){if(!e)return!1;return["PersonalDistributionList","ImplicitGroup","Unknown"].some(function(t){return t===e})};t.prototype._transformData=function(e,t){var n=this;return e.map(function(e){var r=e.EntityData,i={name:e.DisplayText,email:r.Email,userId:e.Key,job:r.Title,department:r.Department,phone:r.MobilePhone,providerName:e.ProviderDisplayName,entityType:e.EntityType,isResolved:e.IsResolved,multipleMatches:e.MultipleMatches,rawPersonData:e,rawData:e};if(i.multipleMatches.length>0){i.multipleMatches=n._transformData(i.multipleMatches,t);t&&(i.multipleMatches=i.multipleMatches.filter(function(e){return 1!==e.entityType}))}var s=i.email;i.isResolved&&(i.image=s?Object(h.n)(n._webAbsoluteUrl,s):null);var o=r.PrincipalType||e.EntityType;switch(o){case"UNVALIDATED_EMAIL_ADDRESS":case"GUEST_USER":i.entityType=1;i.principalType=u.e.user;i.isExternal=!0;break;case"SecGroup":case"SharePointGroup":case"FormsRole":i.entityType=2;i.principalType="SharePointGroup"===o?u.e.sharePointGroup:u.e.securityGroup;break;default:i.entityType=0;i.principalType=u.e.user}return i})};return t})(o.t);function w(e){return!!e.webAbsoluteUrl}},,function(e,t,n){"use strict";var r=n(138);Object(r.n)([{rawString:".od-ImageFrame{display:block;position:absolute;top:0;left:0;bottom:0;right:0}"}]);var i=n(1652),s=n(0),o=n(1651),u=n(1767),a=n(22),f=n(1708),l=n(1730),c=n(1438);function h(e,t){return e===t||(!e&&!t||!(!e||!t)&&e.url===t.url)}Object(r.n)([{rawString:".od-ImageStack{display:block;position:absolute;top:0;left:0;bottom:0;right:0;overflow:hidden}.od-ImageStack-tile{display:block;position:absolute;top:0;left:0;bottom:0;right:0;opacity:0}.od-ImageStack-tile--isLoaded{opacity:1}.od-ImageStack--fade .od-ImageStack-tile--isLoaded{transition:opacity 217ms linear 50ms}"}]);n(1681);var p=n(1649),d=n(1880),v=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.hasAnimated,i=t.fadeIn,s=t.image,o=t.referenceImage,u=t.referenceRotation;n._fadeIn=i;n._image=s;n._referenceImage=o;n._referenceRotation=u;n.isLoaded=n.createObservable(!1);n._hasAnimated=n._getHasAnimated();n.rotation=n.createPureComputed(n._computeRotation);n.createBackgroundComputed(function(){return r(n._hasAnimated())});return n}t.prototype._getHasAnimated=function(){var e=this,t=this.createObservable(!1);return this.createPureComputed(function(){var n;if(e.isLoaded.peek())(n=t())||e.async.setTimeout(function(){return t(!0)},e._fadeIn.peek()?2e3:50);else{e.isLoaded();n=!1}return n})};t.prototype._computeRotation=function(){var e=this.rotation.peek();(h(this._image,this._referenceImage())||void 0===e)&&(e=this._referenceRotation());return e};return t})(p.n),m=(function(e){Object(s.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.imageTileTagName=d.e.tagName;var i=t.image,s=t.rotation,o=t.desiredSize,u=t.scale,a=void 0===u?1:u,f=t.fadeIn,l=void 0===f||f,p=t.allowLoading,m=void 0===p||p,g=t.isLoaded,y=t.isCurrent,b=t.alignment,w=t.position,E=t.loadedImage,S=t.error,x=t.loadImageScenarioName,T=n.outputExtenders,N=void 0===T?{deferred:!0}:T,C=n.AnimationTracker,k=void 0===C?v:C;r._animationTrackerType=k;r._image=r.wrapObservable(i);r._rotation=r.wrapObservable(s);r._desiredSize=o;r._scale=a;r.fadeIn=r.wrapObservable(l);r._allowLoading=r.wrapObservable(m);r._alignment=b;r._scenarioName=x;r._tileDefinitions=r.createPureComputed(r._computeTileDefinitions);r._position=r.createPureComputed(r._computePosition);r._position.equalityComparer=c.e;r._loadedImage=r.createPureComputed(r._computeLoadedImage);r._loadedImage.equalityComparer=h;r._error=r.createPureComputed(r._computeError);r._error.equalityComparer=c.e;r.tiles=r._getTiles();w&&r.createBackgroundComputed(function(){return w(r._position())}).extend(N);E&&r.createBackgroundComputed(function(){return E(r._loadedImage())}).extend(N);g&&r.createBackgroundComputed(function(){return g(!!r._loadedImage())}).extend(N);y&&r.createBackgroundComputed(function(){return y(h(r._loadedImage(),r._image()))}).extend(N);S&&r.createBackgroundComputed(function(){return S(r._error())}).extend(N);return r}t.prototype._computeError=function(){for(var e,t=this.tiles(),n=t.length-1;n>=0;n--){var r=t[n],i=r.isLoaded,s=r.error;if(i())break;if(s()){e=s();break}}return e};t.prototype._computePosition=function(){for(var e,t=this.tiles(),n=t.length-1;n>=0;n--){var r=t[n],i=r.isLoaded,s=r.position;if(i()){e=s();break}}return e};t.prototype._computeLoadedImage=function(){for(var e,t=this.tiles(),n=t.length-1;n>=0;n--){var r=t[n],i=r.isLoaded,s=r.image;if(i()){e=this.unwrapObservable(s);break}}return e};t.prototype._computeTileDefinitions=function(){var e=this._image(),t=this._tileDefinitions.peek(),n=void 0===t?[]:t;if(e){if(this._allowLoading()){var r=void 0,i=void 0,o=void 0,u=n[n.length-1];if(u){r=h(u.image,e);i=u.hasAnimated.peek();o=!!u.error.peek()}else{r=!1;i=!1}if(r)i?n=[u]:u.hasAnimated();else{if(!u||i||o){u={image:e,error:this.createObservable(),hasAnimated:this.createObservable(!1)};n=Object(s.__spreadArrays)(n,[u])}u.hasAnimated();u.error()}}}else n=[];return n};t.prototype._getTiles=function(){var e=this,t=this.observables.createArray(),n=this.addDisposable(t.map({mappingWithDisposeCallback:function(t){var n=t.image,r=t.error,i=t.hasAnimated,s=new(e.managed(e._animationTrackerType))({hasAnimated:i,image:n,referenceRotation:e._rotation,referenceImage:e._image,fadeIn:e.fadeIn});return{mappedValue:{image:n,rotation:s.rotation,isLoaded:s.isLoaded,error:r,scale:e._scale,desiredSize:e._desiredSize,alignment:e._alignment,position:e.createObservable(),loadImageScenarioName:e._scenarioName},dispose:function(){s.dispose()}}}}));this.createBackgroundComputed(function(){t.splice.apply(t,Object(s.__spreadArrays)([0,t.peek().length],e._tileDefinitions()))});return n};return t})(o.t),g=Object(i.e)({tagName:"od-image-stack",template:'<span class="od-ImageStack" data-bind="css:{\'od-ImageStack--fade\':fadeIn},template:{foreach:tiles}"><span class="od-ImageStack-tile" data-bind="css:{\'od-ImageStack-tile--isLoaded\':$data.isLoaded},component:{name:$component.imageTileTagName,params:$data}"></span></span>',viewModel:m,synchronous:!0}),y=n(70),b=(function(e){Object(s.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.imageStackTagName=g.tagName;var i=t.image,s=t.rotation,o=void 0===s?u.e.none:s,a=t.alignment,p=t.desiredSize,d=t.isLoaded,v=t.isCurrent,m=t.error,b=t.coverage,w=void 0===b?{minimum:1,maximum:1}:b,E=t.scale,S=t.fadeIn,x=t.allowLoading,T=t.position,N=t.loadImageScenarioName,C=n.thumbnailCache,k=void 0===C?r.resources.consume(f.e):C,L=n.outputExtenders,A=void 0===L?{deferred:!0}:L;r._thumbnailCache=k;r._image=r.wrapObservable(i);r._rotation=r.wrapObservable(o);r._alignment=l.n(a);r._desiredSize=r.wrapObservable(p);r._isLoaded=d;r._coverage=r.wrapObservable(w);r._loadedImage=r.createObservable();r._blobImage=r.createObservable();r._isNoCacheTriggered=!1;r._effectiveDesiredSize=r.createPureComputed(r._computeEffectiveDesiredSize);r._effectiveDesiredSize.equalityComparer=c.e;r._idealSize=r.createPureComputed(r._computeIdealSize);r._idealSize.equalityComparer=c.e;r._idealImage=r.createPureComputed(r._computeIdealImage);r._idealImage.equalityComparer=h;r._fallbackImage=r.createPureComputed(r._computeFallbackImage);r._fallbackImage.equalityComparer=h;r._cachedImage=r.createPureComputed(r._computeCachedImage);r._cachedImage.equalityComparer=h;r._currentImage=r.createPureComputed(r._computeCurrentImage);r._currentImage.equalityComparer=h;r._isCurrent=r.createPureComputed(r._computeIsCurrent);r.imageStackParams={image:r._currentImage,rotation:r._rotation,desiredSize:r._desiredSize,loadedImage:r._loadedImage,isLoaded:r._isLoaded,error:m,scale:E,alignment:r._alignment,fadeIn:S,allowLoading:x,position:T,loadImageScenarioName:N};v&&r.createBackgroundComputed(function(){return v(r._isCurrent())}).extend(A);y.t.isActivated("f4bfd21f-f2f1-4d89-94f9-242765ec8a9a","07/16/2021","one up thumbnail link not secure (pre auth)")||r.addDisposable({dispose:function(){r._blobImage.peek()&&r._blobImage.peek().url&&URL.revokeObjectURL(r._blobImage.peek().url)}});return r}t.prototype._computeIsCurrent=function(){return h(this._loadedImage(),this._idealImage())};t.prototype._computeCurrentImage=function(){var e=this._loadedImage(),t=this._idealImage(),n=this._cachedImage(),r=this._fallbackImage();return e?h(e,t)?this._currentImage.peek():t:n||r||t};t.prototype._computeEffectiveDesiredSize=function(){var e,t=this._desiredSize(),n=window.devicePixelRatio||1;t&&(e={width:t.width*n,height:t.height*n});return e};t.prototype._computeIdealSize=function(){var e,t=this._image();if(t){var n=t.width,r=t.height,i=this._effectiveDesiredSize();if(i&&i.width&&i.height){if(n&&r){var s=this._alignment.getTransform(t,i);e={width:s.scale*t.width,height:s.scale*t.height}}}else e={width:n,height:r}}return e};t.prototype._computeIdealImage=function(){var e,t=this._image(),n=this._idealSize();if(!y.t.isActivated("f4bfd21f-f2f1-4d89-94f9-242765ec8a9a","07/16/2021","one up thumbnail link not secure (pre auth)")&&this._blobImage())return this._blobImage.peek();if(t){n?(e=this._getDerivedImage(t,n))!==this._idealImage.peek()&&this._thumbnailCache.register(t,e,n,!1):e=t.getAligned?t.getAligned(this._effectiveDesiredSize(),this._alignment):t;y.t.isActivated("f4bfd21f-f2f1-4d89-94f9-242765ec8a9a","07/16/2021","one up thumbnail link not secure (pre auth)")||this._convertImageUrlToBlobUrlViaXhttp(e)}return e};t.prototype._convertImageUrlToBlobUrlViaXhttp=function(e){var t=this;if(e&&e.url&&-1!==e.url.indexOf("access_token")){var n=new XMLHttpRequest;n.onload=function(){if(n.status>=200&&n.status<300&&n.response){var r=URL.createObjectURL(n.response);t._blobImage(Object(s.__assign)(Object(s.__assign)({},e),{url:r}));t._isNoCacheTriggered=!1}};n.onerror=function(){if(!t._isNoCacheTriggered){t._isNoCacheTriggered=!0;t._convertImageUrlToBlobUrlViaXhttp(e)}};n.open("GET",e.url,!0);n.responseType="blob";if(this._isNoCacheTriggered){n.setRequestHeader("cache-control","no-cache");n.setRequestHeader("pragma","no-cache")}n.send()}};t.prototype._computeFallbackImage=function(){var e,t=this._image(),n=this._idealSize();if(n&&t&&t.width){var r=(this._coverage()||{}).fallback,i=void 0===r?0:r;if(i){var s={width:n.width*i,height:n.height*i};(e=this._getDerivedImage(t,s))!==this._fallbackImage.peek()&&this._thumbnailCache.register(t,e,s,!1)}}return e};t.prototype._computeCachedImage=function(){var e,t=this._image(),n=this._idealSize();if(n&&t&&t.width){var r=this._thumbnailCache.getCoveragePercent(t,n),i=this._coverage()||{},s=i.minimum,o=void 0===s?1:s,u=i.maximum,a=o*r,f=(void 0===u?1:u)*r;e=this._thumbnailCache.retrieve(t,f,a)}return e};t.prototype._getDerivedImage=function(e,t){return{url:e.getAligned?e.getAligned(t,this._alignment).url:a.format(e.url,Math.ceil(t.width),Math.ceil(t.height)),width:e.width,height:e.height}};return t})(o.t),w=Object(i.e)({tagName:"od-image-frame",template:'<span class="od-ImageFrame" data-bind="component:{name:$component.imageStackTagName,params:$component.imageStackParams}"></span>',viewModel:b,synchronous:!0});t.e=w},,,function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return k});n.d(t,"clearCache",function(){return L});n.d(t,"isProvisioning",function(){return A});var r=n(197),i=n(103),s=n(63),o=n(11),u=n(1968),a=n(1861),f=n(0),l=n(899),c=n(71),h=(function(){function e(){}e.prototype.OnFlexPaneVisibilityChanged=function(e){try{return O365Shell.FlexPane.OnFlexPaneVisibilityChanged(e)}catch(e){c.e.log(e,"FlexPaneWrapper","OnFlexPaneVisibilityChanged")}};e.prototype.OpenFlexPaneForProvider=function(e){try{O365Shell.FlexPane.OpenFlexPaneForProvider(e)}catch(e){c.e.log(e,"FlexPaneWrapper","OpenFlexPaneForProvider")}};e.prototype.CloseFlexPaneForProvider=function(e){try{O365Shell.FlexPane.CloseFlexPaneForProvider(e)}catch(e){c.e.log(e,"FlexPaneWrapper","CloseFlexPaneForProvider")}};e.prototype.RemoveOnFlexPaneVisibilityChanged=function(e){try{O365Shell.FlexPane.RemoveOnFlexPaneVisibilityChanged(e)}catch(e){c.e.log(e,"FlexPaneWrapper","RemoveOnFlexPaneVisibilityChanged")}};return e})(),p=(function(){function e(){}e.prototype.OnLinkClick=function(e){try{O365Shell.Navigation.OnLinkClick(e)}catch(e){c.e.log(e,"NavigationWrapper","OnLinkClick")}};e.prototype.OnHamburgerButtonClick=function(e){try{O365Shell.Navigation.OnHamburgerButtonClick(e)}catch(e){c.e.log(e,"NavigationWrapper","OnHamburgerButtonClick")}};e.prototype.RemoveOnLinkClick=function(e){try{O365Shell.Navigation.OnLinkClick(e)}catch(e){c.e.log(e,"NavigationWrapper","RemoveOnLinkClick")}};e.prototype.EnterAccessibilityLoopInShell=function(){try{O365Shell.Navigation.EnterAccessibilityLoopInShell()}catch(e){c.e.log(e,"NavigationWrapper","EnterAccessibilityLoopInShell")}};e.prototype.ReverseEnterAccessibilityLoopInShell=function(){try{O365Shell.Navigation.ReverseEnterAccessibilityLoopInShell()}catch(e){c.e.log(e,"NavigationWrapper","ReverseEnterAccessibilityLoopInShell")}};e.prototype.SetForwardAccessibilityLoopOutsideHeaderElementId=function(e){try{O365Shell.Navigation.SetForwardAccessibilityLoopOutsideHeaderElementId(e)}catch(e){c.e.log(e,"NavigationWrapper","SetForwardAccessibilityLoopOutsideHeaderElementId")}};e.prototype.SetReverseAccessibilityLoopOutsideHeaderElementId=function(e){try{O365Shell.Navigation.SetReverseAccessibilityLoopOutsideHeaderElementId(e)}catch(e){c.e.log(e,"NavigationWrapper","SetReverseAccessibilityLoopOutsideHeaderElementId")}};return e})(),d=(function(e){Object(f.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._flexPane=new h;t._navigation=new p;return t}Object.defineProperty(t.prototype,"FlexPane",{get:function(){return this._flexPane},enumerable:!1,configurable:!0});Object.defineProperty(t.prototype,"Navigation",{get:function(){return this._navigation},enumerable:!1,configurable:!0});return t})(l.e),v=n(1017),m=n(76),g=n(46),y=n(1865),b=n(52),w=n(994),E=n(133),S=n(109),x=n(48),T=n(1821),N=new i.e("odSuiteNav",s.e.local),C=(function(){function e(e,t){this._dataSource=t.dataSource;this._capabilities=this._dataSource.getCapabilities();this._cssLoaded=!1}Object.defineProperty(e.prototype,"suiteNavPlaceholder",{get:function(){return this._suiteNavPlaceholder},set:function(e){this._suiteNavPlaceholder||(this._suiteNavPlaceholder=e)},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"accountSwitchCallback",{get:function(){return this._dataSource.accountSwitchCallback},enumerable:!1,configurable:!0});e.prototype.getCapabilities=function(){return this._capabilities};e.prototype.clearCachedPromise=function(){this._modelPromise=void 0;this._shellSignal=void 0};e.prototype.getRenderSetting=function(e){return this._dataSource.getRenderSetting?this._dataSource.getRenderSetting(e):null};e.prototype.loadData=function(e){return this._loadModel(e).then(function(e){return e.data})};e.prototype.getO365Shell=function(){if(!this._capabilities.supportsRealSuiteNav)throw new Error("getO365Shell is only supported if supportsRealSuiteNav capability is true.");var e=this._shellSignal;if(!e){e=new r.e;var t=new S.e({name:"SuiteNavProvider.GetO365Shell"});this._getSuiteNavShell(e);e.getPromise().then(function(){t.end({resultType:x.e.Success})},function(e){t.end(_({error:e}))});this._shellSignal=e}return e.getPromise()};e.prototype.getMailUrl=function(){return this._loadModel().then(function(e){var t=e&&e.data&&e.data.WorkloadLinks;if(t)for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i&&i.Id===v.e.MAIL)return i.Url}})};e.prototype._getSuiteNavShell=function(e,t){var n=this;this._loadModel().then(function(r){if(!n._cssLoaded&&r.cssUrl){w.e.loadStylesheet(r.cssUrl);n._dataSource.onCssLoad&&n._dataSource.onCssLoad(r);n._cssLoaded=!0}var i=r.requireConfig,s=i&&i.paths;t&&s&&(s.shellcore+=".js?odb_cb="+(new Date).toISOString());T.e.addConfig(r.requireConfig);n._requestShellCore().then(function(t){e.complete(t)},function(t){if((t=_({error:t}))&&"RequireError"===t.resultCode&&n._isDataFromCache){E.e.logData({name:"SuiteNavProvider.O365ShellCacheFailed"});n._getSuiteNavShell(e)}else if(n._hasRetriedShell)e.error(t);else{n._hasRetriedShell=!0;n._cssLoaded=!1;E.e.logData({name:"SuiteNavProvider.O365ShellRetry"});n._getSuiteNavShell(e,!0)}})})};e.prototype._requestShellCore=function(){var e=this,t=new r.e,n=requirejs.toUrl("shellcore");window.require(["shellcore"],function(){(function(){var e=window._o365su;if(!e||!e.b)return;for(var t=0,n=["ThrowOnNull","ThrowOnUndefined","ThrowOnNullOrUndefined","ThrowOnNullOrEmpty","ThrowOnNullOrEmptyArray"];t<n.length;t++){var r=n[t];M(e.b,r)}})();var e=new d;e.Exists()?t.complete(e):t.error(_({error:{message:"O365Shell not defined after require() succeeded"},resultCode:"O365ShellNotDefined",extraData:{shellUrl:n}}))},function(r){e._capabilities.supportsCaching&&L();requirejs.undef("shellcore");e._modelPromise=void 0;t.error(_({error:r,resultCode:"RequireError",extraData:{shellUrl:n}}))});return t.getPromise()};e.prototype._loadModel=function(e){var t=this;if(!e&&this._modelPromise)return this._modelPromise;var n,r,o=this._capabilities.supportsCaching,u=this._dataSource,a=x.e.Failure,f=S.e.instrumentPromise({name:"SuiteNavProvider.LoadData"},function(){return new b.n(function(r,f){var l,c,h;!e&&o&&t._isCacheValid()&&(l=N.getValue("Data"));if(l&&l.data){E.e.logData({name:"SuiteNavProvider.DataFromCache"});u.updateDataForCurrentPage&&u.updateDataForCurrentPage(l.data);if(o&&(c=N.getValue("CachedThisSession",s.e.session),h=Date.parse(N.getValue("CacheDate")),i.e.hasStorageType(s.e.session)&&!c||Date.now()-h>=432e5)){E.e.logData({name:"SuiteNavProvider.RefreshCache"});u.loadData().done(O)}t._isDataFromCache=!0;r(l)}else{t._isDataFromCache=!1;e&&E.e.logData({name:"SuiteNavProvider.ForceUpdateData"});E.e.logData({name:"SuiteNavProvider.DataFromServer"});u.loadData(e).done(function(e){if(e)if(e.data){o&&!A(e)&&O(e);r(e)}else{n="NoModelData";f("Model with no data returned")}else{n="NoModel";f("No model returned")}},function(e){if(b.n.isCanceled(f)){n="Canceled";a=x.e.ExpectedFailure}else n="ServerLoadFailure";f(e)})}})},null,function(e){if(b.n.isCanceled(e)){a=x.e.ExpectedFailure;n="Canceled"}return{resultType:a,resultCode:n||"Other",error:e}});(r=Object(y.e)())?this._modelPromise=b.n.all({suiteNavModel:f,theme:r.loadThemeSlotsMap()}).then(function(e){var t=e.suiteNavModel,n=e.theme,r=t&&t.data,i=t&&t.hasCobranding,s=r&&r.UseSPOBehaviors,o=Object(g.isFeatureEnabled)(g.SuiteNavPrefersTenantTheme),u=n&&n.suiteBarBackground;!(u&&r&&s)||i&&o||(r.ThemeColors=[u,n.primaryText,u,n.suiteBarText,n.suiteBarDisabledText,n.topBarBackground,n.topBarText,n.topBarHoverText,n.primaryBackground,n.themeLighterAlt,n.dialogBorder]);return t}):this._modelPromise=f;return this._modelPromise};e.prototype._isCacheValid=function(){var e=N.getValue("Data"),t=N.getValue("CacheVersion"),n=Date.parse(N.getValue("CacheDate")),r=this._capabilities.supportsRealSuiteNav,i=this._dataSource,s=e&&e.data&&(!r||e.requireConfig)&&5===t&&e.userIdentifier===i.getUserIdentifier()&&e.cacheToken===i.getCacheToken()&&!isNaN(n)&&Date.now()-n<864e5;if(!s){var o={model:!!e,"model.data":e&&!!e.data,"model.requireConfig":e&&!!e.requireConfig,supportsRealSuiteNav:r,oldVersion:t,CACHE_VERSION:5,userIsIdentical:e&&e.userIdentifier===i.getUserIdentifier(),cacheToken:e&&e.cacheToken,dataSourceCacheToken:i.getCacheToken(),cacheDate:!isNaN(n),expired:Date.now()-n>=864e5};E.e.logData({name:"SuiteNavCacheDataInvalid",extraData:o})}return s};return e})(),k=(t.default=C,Object(g.isFeatureEnabled)(g.UnifiedSuiteNavComponent)?Object(o.s)("SuiteNavProvider",u.e,{dataSource:m.pe}):Object(o.s)("SuiteNavProvider",C,{dataSource:m.ce}));function L(){N.remove("Data");N.remove("CacheDate");N.remove("CacheVersion");N.remove("CachedThisSession",s.e.session)}function A(e){var t=e&&e.data&&e.data.WorkloadLinks;return!!t&&t.some(function(e){return e&&!e.Url})}function O(e){N.setValue("Data",e);N.setValue("CacheDate",new Date);N.setValue("CacheVersion",5);N.setValue("CachedThisSession",!0,s.e.session)}function M(e,t){var n=e[t];"function"==typeof n&&(e[t]=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];try{return n.apply(this,e)}catch(e){a.e.logData({message:e&&e.message||"",stack:e&&e.stack||"",type:t})}})}function _(e){var t=e.error;if(t&&t.resultCode)return t;var n=x.e.Failure;if(b.n.isCanceled(t)){n=x.e.ExpectedFailure;e.resultCode="Canceled"}return{resultType:n,resultCode:e.resultCode||"Other",error:t,extraData:e.extraData}}},,function(e,t,n){"use strict";var r=(function(){function e(){}e.addConfig=function(e){window.require.config(e)};e.addPaths=function(e){window.require.config({paths:e})};e.addShims=function(e){window.require.config({shim:e})};return e})();t.e=r},function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(4),i=n(25),s=n(86),o={root:"ms-TeachingBubble",body:"ms-TeachingBubble-body",bodyContent:"ms-TeachingBubble-bodycontent",closeButton:"ms-TeachingBubble-closebutton",content:"ms-TeachingBubble-content",footer:"ms-TeachingBubble-footer",header:"ms-TeachingBubble-header",headerIsCondensed:"ms-TeachingBubble-header--condensed",headerIsSmall:"ms-TeachingBubble-header--small",headerIsLarge:"ms-TeachingBubble-header--large",headline:"ms-TeachingBubble-headline",image:"ms-TeachingBubble-image",primaryButton:"ms-TeachingBubble-primaryButton",secondaryButton:"ms-TeachingBubble-secondaryButton",subText:"ms-TeachingBubble-subText",button:"ms-Button",buttonLabel:"ms-Button-label"},u=Object(s.t)(function(){return Object(i._)({"0%":{opacity:0,animationTimingFunction:i.n.easeFunction1,transform:"scale3d(.90,.90,.90)"},"100%":{opacity:1,transform:"scale3d(1,1,1)"}})}),a=function(e,t){var n=t||{},r=n.calloutWidth,i=n.calloutMaxWidth;return[{display:"block",maxWidth:364,border:0,outline:"transparent",width:r||"calc(100% + 1px)",animationName:""+u(),animationDuration:"300ms",animationTimingFunction:"linear",animationFillMode:"both"},e&&{maxWidth:i||456}]},f=function(e,t,n){return t?[e.headerIsCondensed,{marginBottom:14}]:[n&&e.headerIsSmall,!n&&e.headerIsLarge,{selectors:{":not(:last-child)":{marginBottom:14}}}]},l=function(e){var t,n,s,u=e.hasCondensedHeadline,l=e.hasSmallHeadline,c=e.hasCloseButton,h=e.hasHeadline,p=e.isWide,d=e.primaryButtonClassName,v=e.secondaryButtonClassName,m=e.theme,g=e.calloutProps,y=void 0===g?{className:void 0,theme:m}:g,b=!u&&!l,w=m.palette,E=m.semanticColors,S=m.fonts,x=Object(i.x)(o,m),T=Object(i.S)(m,{outlineColor:"transparent",borderColor:"transparent"});return{root:[x.root,S.medium,y.className],body:[x.body,c&&!h&&{marginRight:24},{selectors:{":not(:last-child)":{marginBottom:20}}}],bodyContent:[x.bodyContent,{padding:"20px 24px 20px 24px"}],closeButton:[x.closeButton,{position:"absolute",right:0,top:0,margin:"15px 15px 0 0",borderRadius:0,color:w.white,fontSize:S.small.fontSize,selectors:{":hover":{background:w.themeDarkAlt,color:w.white},":active":{background:w.themeDark,color:w.white},":focus":{border:"1px solid "+E.variantBorder}}}],content:Object(r.o)([x.content],a(p),[p&&{display:"flex"}]),footer:[x.footer,{display:"flex",flex:"auto",alignItems:"center",color:w.white,selectors:(t={},t["."+x.button+":not(:first-child)"]={marginLeft:10},t)}],header:Object(r.o)([x.header],f(x,u,l),[c&&{marginRight:24},(u||l)&&[S.medium,{fontWeight:i.i.semibold}]]),headline:[x.headline,{margin:0,color:w.white,fontWeight:i.i.semibold},b&&[{fontSize:S.xLarge.fontSize}]],imageContent:[x.header,x.image,p&&{display:"flex",alignItems:"center",maxWidth:154}],primaryButton:[x.primaryButton,d,T,{backgroundColor:w.white,borderColor:w.white,color:w.themePrimary,whiteSpace:"nowrap",selectors:(n={},n["."+x.buttonLabel]=S.medium,n[":hover"]={backgroundColor:w.themeLighter,borderColor:w.themeLighter,color:w.themePrimary},n[":focus"]={backgroundColor:w.themeLighter,border:"1px solid "+w.black,outline:"1px solid "+w.white,outlineOffset:"-2px"},n[":active"]={backgroundColor:w.white,borderColor:w.white,color:w.themePrimary},n)}],secondaryButton:[x.secondaryButton,v,{backgroundColor:w.themePrimary,borderColor:w.white,whiteSpace:"nowrap",selectors:(s={},s["."+x.buttonLabel]=[S.medium,{color:w.white}],s[":hover"]={backgroundColor:w.themeDarkAlt,borderColor:w.white},s[":focus"]={backgroundColor:w.themeDark,border:"1px solid "+w.black,outline:"1px solid "+w.white,outlineOffset:"-2px"},s[":active"]={backgroundColor:w.themePrimary,borderColor:w.white},s)}],subText:[x.subText,{margin:0,fontSize:S.medium.fontSize,color:w.white,fontWeight:i.i.regular}],subComponentStyles:{callout:{root:Object(r.o)(a(p,y),[S.medium]),beak:[{background:w.themePrimary}],calloutMain:[{background:w.themePrimary}]}}}}},function(e,t,n){"use strict";var r=n(0),i=(n(1798),n("knockout-lib")),s=n(994),o=n(355),u=n(391),a=n(1693),f=n(425),l=n(195),c=n(880),h=n(1650),p=n(888),d=n(1662),v=n(1626),m=n(269),g=n(1719),y=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.events.on(n.element,"contextmenu",n._onContextMenu);new(n.managed(d.e))({element:n.element,bindingContext:n.bindingContext,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return{mappings:{ShiftF10:function(e,t){n._onContextMenu(t);return!0}},preventDefault:!0,context:n.bindingContext.$data}}});return n}t.createContextMenu=function(e,t,n,r){var s=null,u=t.anchorElement||Object(g.e)(e.target,t.rootElementClass);if(u&&t.items&&t.items.length>0){var a=void 0;if(t.anchorElement||e.clientX<=0&&e.clientY<=0||!e.clientX&&!e.clientY){var h=(t.anchorElement?t.anchorElement:e.target).getBoundingClientRect();a=new l.e(h.left,h.bottom)}else a=new l.e(e.clientX,e.clientY);var p=i.observable(a.x+"px"),d=i.observable(a.y+"px"),m=t.alignment||o.e.Left|o.e.Top;f.e.isRightToLeft&&(m|=o.e.Right);var y=null;if(t.boundingElementClass){var b=Object(g.e)(e.target,t.boundingElementClass);y=new c.e(b.getBoundingClientRect())}var w=document.createElement("div");w.style.position="absolute";w.style.top="0px";w.style.left="0px";s=w;document.body.appendChild(w);Object(v.e)(w,u);r||(r=function(){if(s){i.removeNode(s);s=null}});var E={component:{name:"ms-contextual-menu",params:{items:t.items,left:p,top:d,alignment:i.observable(m),offset:i.observable(t.point||l.e.ORIGIN),launchEvent:e,target:e.target,bounds:y,hideIcons:t.shouldHideIcons,fromKeyboardEvent:0===e.pointerId,anchorElement:t.anchorElement,close:t.dismissOnClick?r:null,isOpen:t.isMenuOpen}}};i.applyBindingsToNode(w,E,n)}return s};t.prototype._onContextMenu=function(e){var n=this,r=i.utils.unwrapObservable(this.valueAccessor()),o=(r&&r.resources||a.e(this.bindingContext)).consume(u.C.optional),f=function(){if(t._contextMenu){i.removeNode(t._contextMenu);t._contextMenu=null}};f();var l=e.target,c=null,h=null,p=null;if(s.e.hasClass(l,"noContextMenu")||e.shiftKey&&e instanceof MouseEvent||!r)return!0;for(var d=r.anchorElement||Object(g.e)(l,r.rootElementClass);c!==d;){var v=i.dataFor(l);if(v){!p&&v.item&&(p=v.item);if(p)break}if((h=l?l.getAttribute("data-selection-index"):null)&&(p=o&&o.getItemByIndex(h)))break;c=l;l=Object(m.e)(l)}var y=!1,b=i.dataFor(l);if(o&&b){var w=null===o.maximumSelectedCount||void 0===o.maximumSelectedCount||o.maximumSelectedCount>0;if(!p||!o.isItemSelected(p)&&w){if(o.selectedCount()>0){o.clear();y=!0}else p&&(b.isSelected||h)&&(y=!0);if(y)var E=o.selection.subscribe(function(){E.dispose();d&&n._openMenu(e,r,f)});if(p&&(b.isSelected||h)){o.toggleItemSelected(p);o.setItemFocus(p)}}else p&&o.maximumSelectedCount<=0&&o.setItemFocus(p)}if(r){d&&!y&&this._openMenu(e,r,f);e.preventDefault();e.stopPropagation();return!1}return!0};t.prototype._openMenu=function(e,n,r){n.engagementSource&&this.resources.consume(p.e).logData({name:"RightClick."+n.engagementSource+".Click",isIntentional:!0});if(t._contextMenu){i.removeNode(t._contextMenu);t._contextMenu=null}t._contextMenu=t.createContextMenu(e,n,this.bindingContext,r)};return t})(h.t);t.e=y},,function(e,t,n){"use strict";var r=(function(){function e(t){var n;this._raw=t;if(t){t=(t=t.replace(/\u200e|\u200f/g,"")).trim();for(var r,i,s=new RegExp(e.EmailRegexPattern,"gi"),o=e.EmailMatchTypes.None,u=e.EmailMatchTypes.None;null!==(i=s.exec(t));){var a=i[0],f=a.charAt(0),l=a.charAt(a.length-1);if((u="<"===f&&">"===l?e.EmailMatchTypes.Bracketed:'"'===f&&'"'===l?e.EmailMatchTypes.Quoted:e.EmailMatchTypes.Bare)>o){r=i;o=u;if(u===e.EmailMatchTypes.Bracketed)break}}var c=t;if(r){n=r[0];var h=r.index,p=h+n.length,d=h>0?t.substr(0,h).trim():"",v=p<t.length?t.substr(p):"";if("'"===(n=e.StripBracketsAndQuotesRegex.exec(n)[1]).charAt(0)&&v&&"'"===v.charAt(0)){n=n.slice(1);v=v.slice(1).trim()}c=""===d?v:d;this._email=n.trim()}(c=c.replace(/^\s*"\s*/,"").trim()).length>1&&"/"!==c.charAt(c.length-2)&&(c=c.replace(/\s*"$/,""));""!==(c=c.replace(/\//g,""))&&c!==n&&(this._name=c)}}e.isValidEmailSyntax=function(t,n){return!!t&&!!(n?e.ValidEmailRegex:e.EmailRegex).exec(t.trim())};e.parse=function(t){if(!t)return[];for(var n=e._splitAddresses(t),r=[],i=0,s=n.length;i<s;i++)r.push(new e(n[i]));return r};e.endsWithDelimiter=function(t){if(t){var n=t.split(e.DelimiterRegex);return!n[n.length-1].trim()}return!1};e._splitAddresses=function(t){for(var n=t.split(e.DelimiterRegex),r=n.length-1;r>=0;r--){n[r]=n[r].trim();0===n[r].length&&n.splice(r,1)}return n};e.prototype.getEmail=function(){return this._email};e.prototype.getName=function(){return this._name};e.prototype.getRaw=function(){return this._raw};e.EmailRegexPattern="(?:[<\"]\\s*)?[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?\\.)+[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?(?:\\s*[>\"])?";e.EmailRegex=new RegExp(e.EmailRegexPattern,"i");e.ValidEmailRegexPattern="[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@((?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)";e.ValidEmailRegex=new RegExp(e.ValidEmailRegexPattern,"i");e.StripBracketsAndQuotesRegex=/^[<"]?([^<>"]*)[>"]?$/;e.DelimiterRegex=/[,;](?=(?:[^"]*"[^"]*")*(?![^"]*"))/;e.EmailMatchTypes={None:0,Quoted:1,Bare:2,Bracketed:3};return e})();t.e=r},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return h});var r=n(205),i=n(11),s=n(1649),o=n(1003),u=n(326),a=n(1657),f=n(704),l={itemCacheStore:o.e,observablesFactoryType:s.i,asyncType:s.t},c=(function(){function e(e,t){void 0===e&&(e={});var n=this._scope=new u.e,i=t.itemCacheStore;this._observables=n.attach(new t.observablesFactoryType({owner:this}));this._async=n.attach(new t.asyncType(this));this._itemCacheEvaluator=i.dispatch(r.t)}e.prototype.dispose=function(){this._scope.dispose()};e.prototype.pureCompute=function(e,t){void 0===t&&(t={});var n=t.suppressGetItems,r=void 0!==n&&n,i=this._observables,s=this._itemCacheEvaluator,o=this._scope.attach(new u.e),l=o.attach(i.create()),c=!0,h=function(t){return c?i.ignore(function(){return e(t,{})}):e(t,{})};h.selector=e;var p=s.createItemCacheSelector(h,{suppressGetItems:r}),d=o.attach(i.pureCompute(function(){p.markAsChanged();c=!1;var e=p.get();c=!0;return e}));d.equalityComparer=a.n;l(p.get());p.subscribe(function(){l(p.get());p.registerDemands()});var v=o.attach(i.pureCompute(function(){d();l();return p.get()}));v.equalityComparer=a.n;this._async.setImmediate(function(){p.registerDemands()});o.attach({dispose:function(){p.dispose()}});return Object(f.e)(v,function(){o.dispose()})};return e})(),h=Object(i.s)("ItemCacheObservable.new",c,l)},function(e,t,n){"use strict";n.d(t,"t",function(){return h});var r=n(52),i=n(11),s=n(76),o=n(0),u=n(103),a=n(63),f=(function(e){Object(o.__extends)(t,e);function t(){var n=e.call(this,t._Key,t._DataStoreCachingType)||this;n._MaxItems=200;n._Version=7;var r=window._sharingContextInfo;r&&(t._StorageKey=""+t._StorageKey+r.webAbsoluteUrl);n._buffer=n.getValue(t._StorageKey);n._buffer&&n._buffer.version===n._Version||n.initializeBuffer();n._data={};for(var i=0;i<n._buffer.dataArray.length;i++)n._data[n._buffer.dataArray[i].email]=n._buffer.dataArray[i];return n}t.clear=function(){new u.e(t._Key,t._DataStoreCachingType).remove(t._StorageKey)};t.isCacheEntryFresh=function(e,t){return e.name===t.name&&e.email===t.email&&e.job===t.job&&e.office===t.office&&e.department===t.department&&e.phone===t.phone};t.prototype.setItem=function(e){var n=this._data[e.email];if(n){if(t.isCacheEntryFresh(n,e))return;var r=this._buffer.dataArray.map(function(e){return e.userId}).indexOf(e.userId);this._buffer.dataArray[r]=e}else if(this._buffer.dataArray.length===this._MaxItems){this._buffer.index++;this._buffer.index>=this._MaxItems&&(this._buffer.index=0);var i=this._buffer.dataArray[this._buffer.index];delete this._data[i.email];this._buffer.dataArray[this._buffer.index]=e}else{this._buffer.dataArray.push(e);this._buffer.index++}this._data[e.email]=e;this.setValue(t._StorageKey,this._buffer)};t.prototype.getItems=function(e,t){for(var n=[],r=0;r<this._buffer.dataArray.length;r++){var i=(this._buffer.index-r+this._MaxItems)%this._MaxItems;!(this._buffer.dataArray[i].email&&this._buffer.dataArray[i].email.toLowerCase().indexOf(e.toLowerCase())>=0||this._buffer.dataArray[i].name&&this._buffer.dataArray[i].name.toLowerCase().indexOf(e.toLowerCase())>=0)||t&&1===this._buffer.dataArray[i].entityType||n.push(this._buffer.dataArray[i])}return n};t.prototype.containsItem=function(e){return!!this._data[e.email]};t.prototype.initializeBuffer=function(){this._buffer={};this._buffer.dataArray=[];this._buffer.index=-1;this._buffer.version=this._Version};t._Key="ClientPeoplePicker";t._StorageKey="MRU";t._DataStoreCachingType=a.e.local;return t})(u.e),l=n(46),c=(function(){function e(e,t){var n=(this._dataSource=t.dataSource).getCapabilities().supportsMruCaching;n&&(this._mruCache=new f);this.MaxCacheSuggestions=n?5:0}e.prototype.search=function(e,t){var n,i,s=this,o={cached:null,promise:null},u=Object(l.isFeatureEnabled)(l.PeoplePickerGraph)&&t.useGraph,a=Object(l.isFeatureEnabled)(l.PeoplePicker3S)&&t.useSubstrate;!this._mruCache||t.groupID||u||a||(i=this.searchMruCache(e,t&&t.filterExternalUsers)).length>0&&(o.cached=i);o.promise=new r.n(function(r,o){n=s._dataSource.search(e,t).then(function(e){if(e)if(i){i.length>0&&(i=s._removeStaleCacheResults(i,e));var t=i.map(function(e){return e.userId});r(e.filter(function(e){return t.indexOf(e.userId)<0}))}else r(e)},function(e){o(e)})},function(){n&&n.cancel()});return o};e.prototype.resolve=function(e,t){var n=this;return this._dataSource.resolve(e,t).then(function(e){n._mruCache&&e.isResolved&&n.addToMruCache(e);return e})};e.prototype.getPersonaDetails=function(e){return this._dataSource.getPersonaDetails(e).then(function(e){return e})};e.prototype.sharePointSearch=function(e,t){return this._dataSource.sharePointSearch(e,t)};e.prototype.subscribePresence=function(e,t){return this._dataSource.subscribePresence(e,t)};e.prototype.addToMruCache=function(e){var t=this._mruCache;t&&e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"!==e.rawPersonData.EntityData.PrincipalType&&t.setItem(e)};e.prototype.getPickerEntityInformation=function(e){return this._dataSource.getPickerEntityInformation(e)};e.prototype.getLivePersonaPickerHelper=function(){return this._dataSource.getLivePersonaPickerHelper&&this._dataSource.getLivePersonaPickerHelper()};e.prototype.searchMruCache=function(e,t){var n=[],r=this._mruCache;if(r){n=r.getItems(e,t);var i=this.MaxCacheSuggestions;n.length>i&&(n=n.splice(0,i))}return n};e.prototype._removeStaleCacheResults=function(e,t){var n=e.map(function(e){return e.userId}),r=[];t.forEach(function(t){var i=n.indexOf(t.userId);if(i>-1){var s=e[i];f.isCacheEntryFresh(s,t)&&r.push(s)}});return r};return e})(),h=(t.e=c,Object(i.s)("PeoplePickerProvider",c,{dataSource:s.z}))},,function(e,t,n){"use strict";var r=(function(){function e(t){this.id=""+ ++e._lastId;this.name=t}e.prototype.matches=function(e){return e===this};e._lastId=0;return e})();t.e=r},,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.normal=0]="normal";e[e.listBelow=1]="listBelow"})(r||(r={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){if(e&&Object.keys(e).length>0){if(e.isMalwareDetected)return 4;if(e.isExternal)return 1;if(e.isTrending)return 3;if(e.isNew)return 2}return 0}},,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return P});var r=n(1419),i=n(4),s=n("react-lib"),o=n(472),u=n(881),a=n(129),f=n(991),l=n(207),c=n(95),h=n(1377),p=n(653),d=n(1646),v=n(25),m=v.n.durationValue2,g={root:"ms-Modal",main:"ms-Dialog-main",scrollableContent:"ms-Modal-scrollableContent",isOpen:"is-open",layer:"ms-Modal-Layer"},y=n(1806),b=n(1493),w=n(1625),E=n(182),S=n(97),x=n(993),T=n(86),N=Object(T.t)(function(e,t){return{root:Object(v.H)(e,t&&{touchAction:"none",selectors:{"& *":{userSelect:"none"}}})}}),C=n(992),k={start:"touchstart",move:"touchmove",stop:"touchend"},L={start:"mousedown",move:"mousemove",stop:"mouseup"},A=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;n._currentEventType=L;n._events=[];n._onMouseDown=function(e){var t=s.Children.only(n.props.children).props.onMouseDown;t&&t(e);n._currentEventType=L;return n._onDragStart(e)};n._onMouseUp=function(e){var t=s.Children.only(n.props.children).props.onMouseUp;t&&t(e);n._currentEventType=L;return n._onDragStop(e)};n._onTouchStart=function(e){var t=s.Children.only(n.props.children).props.onTouchStart;t&&t(e);n._currentEventType=k;return n._onDragStart(e)};n._onTouchEnd=function(e){var t=s.Children.only(n.props.children).props.onTouchEnd;t&&t(e);n._currentEventType=k;n._onDragStop(e)};n._onDragStart=function(e){if("number"==typeof e.button&&0!==e.button)return!1;if(!(n.props.handleSelector&&!n._matchesSelector(e.target,n.props.handleSelector)||n.props.preventDragSelector&&n._matchesSelector(e.target,n.props.preventDragSelector))){n._touchId=n._getTouchId(e);var t=n._getControlPosition(e);if(void 0!==t){var r=n._createDragDataFromPosition(t);n.props.onStart&&n.props.onStart(e,r);n.setState({isDragging:!0,lastPosition:t});n._events=[Object(C.e)(document.body,n._currentEventType.move,n._onDrag,!0),Object(C.e)(document.body,n._currentEventType.stop,n._onDragStop,!0)]}}};n._onDrag=function(e){"touchmove"===e.type&&e.preventDefault();var t=n._getControlPosition(e);if(t){var r=n._createUpdatedDragData(n._createDragDataFromPosition(t)),i=r.position;n.props.onDragChange&&n.props.onDragChange(e,r);n.setState({position:i,lastPosition:t})}};n._onDragStop=function(e){if(n.state.isDragging){var t=n._getControlPosition(e);if(t){var r=n._createDragDataFromPosition(t);n.setState({isDragging:!1,lastPosition:void 0});n.props.onStop&&n.props.onStop(e,r);n.props.position&&n.setState({position:n.props.position});n._events.forEach(function(e){return e()})}}};n.state={isDragging:!1,position:n.props.position||{x:0,y:0},lastPosition:void 0};return n}t.prototype.componentDidUpdate=function(e){!this.props.position||e.position&&this.props.position===e.position||this.setState({position:this.props.position})};t.prototype.componentWillUnmount=function(){this._events.forEach(function(e){return e()})};t.prototype.render=function(){var e=s.Children.only(this.props.children),t=e.props,n=this.props.position,r=this.state,o=r.position,u=r.isDragging,a=o.x,f=o.y;if(n&&!u){a=n.x;f=n.y}return s.cloneElement(e,{style:Object(i.e)(Object(i.e)({},t.style),{transform:"translate("+a+"px, "+f+"px)"}),className:N(t.className,this.state.isDragging).root,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onTouchStart:this._onTouchStart,onTouchEnd:this._onTouchEnd})};t.prototype._getControlPosition=function(e){var t=this._getActiveTouch(e);if(void 0===this._touchId||t){var n=t||e;return{x:n.clientX,y:n.clientY}}};t.prototype._getActiveTouch=function(e){return e.targetTouches&&this._findTouchInTouchList(e.targetTouches)||e.changedTouches&&this._findTouchInTouchList(e.changedTouches)};t.prototype._getTouchId=function(e){var t=e.targetTouches&&e.targetTouches[0]||e.changedTouches&&e.changedTouches[0];if(t)return t.identifier};t.prototype._matchesSelector=function(e,t){if(!e||e===document.body)return!1;var n=e.matches||e.webkitMatchesSelector||e.msMatchesSelector;return!!n&&(n.call(e,t)||this._matchesSelector(e.parentElement,t))};t.prototype._findTouchInTouchList=function(e){if(void 0!==this._touchId)for(var t=0;t<e.length;t++)if(e[t].identifier===this._touchId)return e[t]};t.prototype._createDragDataFromPosition=function(e){var t=this.state.lastPosition;return void 0===t?{delta:{x:0,y:0},lastPosition:e,position:e}:{delta:{x:e.x-t.x,y:e.y-t.y},lastPosition:t,position:e}};t.prototype._createUpdatedDragData=function(e){var t=this.state.position;return{position:{x:t.x+e.delta.x,y:t.y+e.delta.y},delta:e.delta,lastPosition:t}};return t})(s.Component),O=n(886),M={eventBubblingEnabled:!1},_=Object(o.e)(),D=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;n._focusTrapZone=s.createRef();n._registerInitialModalPosition=function(){var e,t=document.querySelector("[data-id="+n.state.id+"]");if(t){var r=t.getBoundingClientRect();if((null===(e=n.props.dragOptions)||void 0===e?void 0:e.keepInBounds)&&!n._minClampedPosition&&!n._maxClampedPosition){n._minClampedPosition={x:-r.x,y:-r.y};n._maxClampedPosition={x:r.x,y:r.y}}n.setState({modalRectangleTop:r.top})}};n._allowScrollOnModal=function(e){e?n._allowTouchBodyScroll?Object(u.e)(e,n._events):Object(u.t)(e,n._events):n._events.off(n._scrollableContent);n._scrollableContent=e};n._onModalContextMenuClose=function(){n.setState({isModalMenuOpen:!1})};n._onModalClose=function(){n._lastSetX=0;n._lastSetY=0;n.setState({isModalMenuOpen:!1,isInKeyboardMoveMode:!1,isOpen:!1,x:0,y:0});n.props.dragOptions&&n._hasRegisteredKeyUp&&n._events.off(window,"keyup",n._onKeyUp,!0);n.props.onDismissed&&n.props.onDismissed()};n._onDragStart=function(){n.setState({isModalMenuOpen:!1,isInKeyboardMoveMode:!1})};n._onDrag=function(e,t){var r=n.state,i=r.x,s=r.y;n.setState(n._getClampedPosition({x:i+t.delta.x,y:s+t.delta.y}))};n._onDragStop=function(){n.focus()};n._onKeyUp=function(e){if(e.altKey&&e.ctrlKey&&e.keyCode===a.e.space&&Object(f.e)(n._scrollableContent,e.target)){n.setState({isModalMenuOpen:!n.state.isModalMenuOpen});e.preventDefault();e.stopPropagation()}};n._onKeyDown=function(e){if(e.altKey&&e.ctrlKey&&e.keyCode===a.e.space){e.preventDefault();e.stopPropagation()}else{n.state.isModalMenuOpen&&(e.altKey||e.keyCode===a.e.escape)&&n.setState({isModalMenuOpen:!1});if(n.state.isInKeyboardMoveMode&&(e.keyCode===a.e.escape||e.keyCode===a.e.enter)){n.setState({isInKeyboardMoveMode:!1});e.preventDefault();e.stopPropagation()}if(n.state.isInKeyboardMoveMode){var t=!0,r=n._getMoveDelta(e);switch(e.keyCode){case a.e.escape:n.setState({x:n._lastSetX,y:n._lastSetY});case a.e.enter:n._lastSetX=0;n._lastSetY=0;n.setState({isInKeyboardMoveMode:!1});break;case a.e.up:n.setState({y:n._getClampedPositionY(n.state.y-r)});break;case a.e.down:n.setState({y:n._getClampedPositionY(n.state.y+r)});break;case a.e.left:n.setState({x:n._getClampedPositionX(n.state.x-r)});break;case a.e.right:n.setState({x:n._getClampedPositionX(n.state.x+r)});break;default:t=!1}if(t){e.preventDefault();e.stopPropagation()}}}};n._onEnterKeyboardMoveMode=function(){n._lastSetX=n.state.x;n._lastSetY=n.state.y;n.setState({isInKeyboardMoveMode:!0,isModalMenuOpen:!1});n._events.on(window,"keydown",n._onKeyDown,!0)};n._onExitKeyboardMoveMode=function(){n._lastSetX=0;n._lastSetY=0;n.setState({isInKeyboardMoveMode:!1});n._events.off(window,"keydown",n._onKeyDown,!0)};n._registerForKeyUp=function(){if(!n._hasRegisteredKeyUp){n._events.on(window,"keyup",n._onKeyUp,!0);n._hasRegisteredKeyUp=!0}};n._async=new l.e(n);n._events=new c.e(n);Object(O.e)(n);Object(h.e)("Modal",t,{onLayerDidMount:"layerProps.onLayerDidMount"});n.state={id:Object(p.e)("Modal"),isOpen:t.isOpen,isVisible:t.isOpen,hasBeenOpened:t.isOpen,x:0,y:0};n._lastSetX=0;n._lastSetY=0;var r=n.props.allowTouchBodyScroll,i=void 0!==r&&r;n._allowTouchBodyScroll=i;return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){clearTimeout(this._onModalCloseTimer);if(e.isOpen)if(this.state.isOpen)this.setState({hasBeenOpened:!0,isVisible:!0});else{this.setState({isOpen:!0});e.dragOptions&&this._registerForKeyUp()}if(!e.isOpen&&this.state.isOpen){this._onModalCloseTimer=this._async.setTimeout(this._onModalClose,1e3*parseFloat(m));this.setState({isVisible:!1})}};t.prototype.componentDidMount=function(){var e=this;if(this.state.isOpen&&this.state.isVisible){this._registerForKeyUp();requestAnimationFrame(function(){return setTimeout(e._registerInitialModalPosition,0)})}};t.prototype.componentDidUpdate=function(e,t){var n=this;e.isOpen||t.isVisible||this.setState({isVisible:!0});!e.isOpen&&this.props.isOpen&&requestAnimationFrame(function(){return setTimeout(n._registerInitialModalPosition,0)})};t.prototype.componentWillUnmount=function(){this._async.dispose();this._events.dispose()};t.prototype.render=function(){var e=this.props,t=e.className,n=e.containerClassName,r=e.scrollableContentClassName,o=e.elementToFocusOnDismiss,u=e.firstFocusableSelector,a=e.forceFocusInsideTrap,f=e.ignoreExternalFocusing,l=e.isBlocking,c=e.isClickableOutsideFocusTrap,h=e.isDarkOverlay,p=e.onDismiss,v=e.layerProps,m=e.overlay,g=e.responsiveMode,T=e.titleAriaId,N=e.styles,C=e.subtitleAriaId,k=e.theme,L=e.topOffsetFixed,O=e.onLayerDidMount,D=e.isModeless,P=e.dragOptions,H=e.enableAriaHiddenSiblings,B=this.state,j=B.isOpen,F=B.isVisible,I=B.hasBeenOpened,q=B.modalRectangleTop,R=B.x,U=B.y,z=B.isInKeyboardMoveMode;if(!j)return null;var W=void 0===v?"":v.className,X=_(N,{theme:k,className:t,containerClassName:n,scrollableContentClassName:r,isOpen:j,isVisible:F,hasBeenOpened:I,modalRectangleTop:q,topOffsetFixed:L,isModeless:D,layerClassName:W,isDefaultDragHandle:P&&!P.dragHandleSelector}),V=Object(i.e)(Object(i.e)(Object(i.e)({},M),this.props.layerProps),{onLayerDidMount:v&&v.onLayerDidMount?v.onLayerDidMount:O,insertFirst:D,className:X.layer}),$=s.createElement(d.e,{"data-id":this.state.id,componentRef:this._focusTrapZone,className:X.main,elementToFocusOnDismiss:o,isClickableOutsideFocusTrap:D||c||!l,ignoreExternalFocusing:f,forceFocusInsideTrap:D?!D:a,firstFocusableSelector:u,focusPreviouslyFocusedInnerElement:!0,onBlur:z?this._onExitKeyboardMoveMode:void 0,enableAriaHiddenSiblings:H},P&&z&&s.createElement("div",{className:X.keyboardMoveIconContainer},P.keyboardMoveIconProps?s.createElement(x.e,Object(i.e)({},P.keyboardMoveIconProps)):s.createElement(x.e,{iconName:"move",className:X.keyboardMoveIcon})),s.createElement("div",{ref:this._allowScrollOnModal,className:X.scrollableContent,"data-is-scrollable":!0},P&&this.state.isModalMenuOpen&&s.createElement(P.menu,{items:[{key:"move",text:P.moveMenuItemText,onClick:this._onEnterKeyboardMoveMode},{key:"close",text:P.closeMenuItemText,onClick:this._onModalClose}],onDismiss:this._onModalContextMenuClose,alignTargetEdge:!0,coverTarget:!0,directionalHint:S.e.topLeftEdge,directionalHintFixed:!0,shouldFocusOnMount:!0,target:this._scrollableContent}),this.props.children));return g>=E.e.small?s.createElement(b.e,Object(i.e)({},V),s.createElement(w.e,{role:D||!l?"dialog":"alertdialog","aria-modal":!D,ariaLabelledBy:T,ariaDescribedBy:C,onDismiss:p,shouldRestoreFocus:!f},s.createElement("div",{className:X.root,role:D?void 0:"document"},!D&&s.createElement(y.e,Object(i.e)({isDarkThemed:h,onClick:l?void 0:p,allowTouchBodyScroll:this._allowTouchBodyScroll},m)),P?s.createElement(A,{handleSelector:P.dragHandleSelector||"."+X.main.split(" ")[0],preventDragSelector:"button",onStart:this._onDragStart,onDragChange:this._onDrag,onStop:this._onDragStop,position:{x:R,y:U}},$):$))):null};t.prototype.focus=function(){this._focusTrapZone.current&&this._focusTrapZone.current.focus()};t.prototype._getClampedPosition=function(e){return this.props.dragOptions&&this.props.dragOptions.keepInBounds?{x:this._getClampedPositionX(e.x),y:this._getClampedPositionY(e.y)}:e};t.prototype._getClampedPositionY=function(e){var t=this._minClampedPosition,n=this._maxClampedPosition;t&&(e=Math.max(t.y,e));n&&(e=Math.min(n.y,e));return e};t.prototype._getClampedPositionX=function(e){var t=this._minClampedPosition,n=this._maxClampedPosition;t&&(e=Math.max(t.x,e));n&&(e=Math.min(n.x,e));return e};t.prototype._getMoveDelta=function(e){var t=10;e.shiftKey?e.ctrlKey||(t=50):e.ctrlKey&&(t=1);return t};t.defaultProps={isOpen:!1,isDarkOverlay:!0,isBlocking:!1,className:"",containerClassName:""};return t=Object(i.n)([E.n],t)})(s.Component),P=Object(r.e)(D,function(e){var t,n=e.className,r=e.containerClassName,i=e.scrollableContentClassName,s=e.isOpen,o=e.isVisible,u=e.hasBeenOpened,a=e.modalRectangleTop,f=e.theme,l=e.topOffsetFixed,c=e.isModeless,h=e.layerClassName,p=e.isDefaultDragHandle,d=f.palette,y=f.effects,b=f.fonts,w=Object(v.x)(g,f);return{root:[w.root,b.medium,{backgroundColor:"transparent",position:c?"absolute":"fixed",height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",opacity:0,pointerEvents:"none",transition:"opacity "+m},l&&"number"==typeof a&&u&&{alignItems:"flex-start"},s&&w.isOpen,o&&{opacity:1,pointerEvents:"auto"},n],main:[w.main,{boxShadow:y.elevation64,borderRadius:y.roundedCorner2,backgroundColor:d.white,boxSizing:"border-box",position:"relative",textAlign:"left",outline:"3px solid transparent",maxHeight:"calc(100% - 32px)",maxWidth:"calc(100% - 32px)",minHeight:"176px",minWidth:"288px",overflowY:"auto",zIndex:c?v.g.Layer:void 0},l&&"number"==typeof a&&u&&{top:a},p&&{cursor:"move"},r],scrollableContent:[w.scrollableContent,{overflowY:"auto",flexGrow:1,maxHeight:"100vh",selectors:(t={},t["@supports (-webkit-overflow-scrolling: touch)"]={maxHeight:window.innerHeight},t)},i],layer:c&&[h,w.layer,{position:"static",width:"unset",height:"unset"}],keyboardMoveIconContainer:{position:"absolute",display:"flex",justifyContent:"center",width:"100%",padding:"3px 0px"},keyboardMoveIcon:{fontSize:b.xLargePlus.fontSize,width:"24px"}}},void 0,{scope:"Modal",fields:["theme","styles","enableAriaHiddenSiblings"]})},function(e,t,n){"use strict";n.d(t,"e",function(){return S});var r=n(0),i=n("react-lib"),s=n(2027),o=n(993),u=n(2429),a=n(1665),f=n(1654),l=n(22),c=n(138);Object(c.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-RoleSelectorLarge-wrapper{position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%}.od-RoleSelectorLarge-wrapper .ms-TooltipHost{position:absolute;top:9px;font-size:.75rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}[dir='ltr'] .od-RoleSelectorLarge-wrapper .ms-TooltipHost{right:0}[dir='rtl'] .od-RoleSelectorLarge-wrapper .ms-TooltipHost{left:0}.od-RoleSelectorLarge-wrapper .ms-Dropdown-container{width:100%}.od-RoleSelectorLarge-rolesDropdownOptionsCallout .ms-Dropdown-item{margin:0;height:auto}[dir='ltr'] .od-RoleSelectorLarge-rolesDropdownOptionsCallout .ms-Dropdown-item{padding-left:0}[dir='rtl'] .od-RoleSelectorLarge-rolesDropdownOptionsCallout .ms-Dropdown-item{padding-right:0}.od-RoleSelectorLarge-rolesDropdown{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title{border:none;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-radius:0px;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";height:2rem;line-height:1.875rem}[dir='ltr'] .isFluent .od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title{padding-left:0}[dir='rtl'] .isFluent .od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title{padding-right:0}.od-RoleSelectorLarge-rolesDropdown .ms-Dropdown-title .od-RoleSelectorLarge-roleDropdownOptionMainContent .od-RoleSelectorLarge-roleDropdownOptionText{font-size:.875rem}.od-RoleSelectorLarge-rolesDropdown .ms-Dropdown:focus::after{border:none;border-bottom:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";border-radius:0px}.od-RoleSelectorLarge-rolesDropdown:hover,.od-RoleSelectorLarge-rolesDropdown.is-open{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-RoleSelectorLarge-rolesDropdown.is-open .ms-Dropdown-title,.od-RoleSelectorLarge-rolesDropdown.is-open:hover .ms-Dropdown-title{border-bottom-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-RoleSelectorLarge-rolesDropdown.is-disabled .ms-Dropdown-title{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}[dir='ltr'] .od-RoleSelectorLarge-rolesDropdown.is-disabled .ms-Dropdown-caretDownWrapper{right:32px}[dir='rtl'] .od-RoleSelectorLarge-rolesDropdown.is-disabled .ms-Dropdown-caretDownWrapper{left:32px}.od-RoleSelector-infoTooltipContent{font-size:.875rem}.od-changePermissions--info i{vertical-align:middle}.od-RoleSelectorLarge-roleDropdownOption{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin:8px 0px}.od-RoleSelectorLarge-roleDropdownOption .od-RoleSelectorLarge-roleDropdownOptionMainContent{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.od-RoleSelectorLarge-roleDropdownOption .od-RoleSelectorLarge-roleDropdownOptionMainContent .od-RoleSelectorLarge-roleDropdownOptionText{font-weight:600;font-size:.875rem}.od-RoleSelectorLarge-roleDropdownOption .od-RoleSelectorLarge-roleDropdownOptionSubtext{font-size:.75rem;line-height:1.3}[dir='ltr'] .od-RoleSelectorLarge-roleDropdownOption .od-RoleSelectorLarge-roleDropdownOptionSubtext{text-align:left}[dir='rtl'] .od-RoleSelectorLarge-roleDropdownOption .od-RoleSelectorLarge-roleDropdownOptionSubtext{text-align:right}.od-RoleSelectorLarge-settingIcon{font-size:1.125rem}[dir='ltr'] .od-RoleSelectorLarge-settingIcon{padding-left:8px}[dir='rtl'] .od-RoleSelectorLarge-settingIcon{padding-right:8px}[dir='ltr'] .od-RoleSelectorLarge-settingIcon{padding-right:12px}[dir='rtl'] .od-RoleSelectorLarge-settingIcon{padding-left:12px}.isFluent .od-RoleSelectorLarge-settingIcon{font-size:.875rem}[dir='ltr'] .isFluent .od-RoleSelectorLarge-settingIcon{padding-left:0}[dir='rtl'] .isFluent .od-RoleSelectorLarge-settingIcon{padding-right:0}.ms-Dropdown .ms-Dropdown-title:focus{outline:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}\n"}]);var h=n(182),p=n(1547),d=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._onRenderTitle=function(e){var t=Object(a.E)(e[0].key);return i.createElement("div",{className:"od-RoleSelectorLarge-roleDropdownOptionMainContent"},i.createElement(o.e,{iconName:t.name,"aria-hidden":"true",title:t.name,className:"od-RoleSelectorLarge-settingIcon"}),i.createElement("span",{className:"od-RoleSelectorLarge-roleDropdownOptionText"}," ",e[0].text," "))};r._onRenderOption=function(e){var t=Object(a.E)(e.key),n={maxWidth:"300px",onRenderContent:function(){return i.createElement("div",{className:"od-RoleSelector-infoTooltipContent"},t.title)}};return i.createElement("div",{className:"od-RoleSelectorLarge-roleDropdownOption"},i.createElement(p.e,{calloutProps:{gapSpace:0},tooltipProps:n},i.createElement(o.e,{className:"od-RoleSelectorLarge-settingIcon",iconName:t.name})),i.createElement("div",{className:"od-RoleSelectorLarge-roleDropdownOptionMainContent"},i.createElement("span",{className:"od-RoleSelectorLarge-roleDropdownOptionText"}," ",e.text," "),i.createElement("span",{className:"od-RoleSelectorLarge-roleDropdownOptionSubtext"},e.data)))};r._onAllowRoleChange=function(e,t){r.props.onRoleChange(t.key)};return r}t.prototype.render=function(){var e=this.props,n=e.menuPermissionOptions,r=(e.showLinkSettings,e.showStopSharing,e.sharingRole),f=Object(a.E)(r),l=r;l!==u.e.review||n.review.enabled||(l=u.e.edit);l!==u.e.owner||n.fullControl.enabled||(l=u.e.edit);var c=[];if(n.fullControl.shouldDisplay){var d=t._fullControlDropdownOption;d.disabled=!n.fullControl.enabled;c.push(d)}if(n.manageList.shouldDisplay){var v=t._manageListDropdownOption;v.disabled=!n.manageList.enabled;c.push(v)}c.push(n.manageList.shouldDisplay&&n.manageList.enabled?t._editDropDownOptionForLists:t._editDropDownOption);if(n.review.shouldDisplay){var m=t._reviewDropdownOption;m.disabled=!n.review.enabled;c.push(m)}c.push(n.manageList.shouldDisplay&&n.manageList.enabled?t._viewDropdownOptionForLists:t._viewDropdownOption);var g={maxWidth:"300px",onRenderContent:function(){return i.createElement("div",{className:"od-RoleSelector-infoTooltipContent"},f.title)}};return i.createElement("div",{className:"od-RoleSelectorLarge-wrapper"},i.createElement(p.e,{calloutProps:{gapSpace:0},tooltipProps:g},i.createElement(o.e,{className:"od-RoleSelectorLarge-settingIcon",iconName:f.name})),i.createElement(s.e,{className:"od-RoleSelectorLarge-rolesDropdown",disabled:this.props.disabled,label:"",onRenderTitle:this._onRenderTitle,onRenderOption:this._onRenderOption,onChange:this._onAllowRoleChange,defaultSelectedKey:l,calloutProps:{className:"od-RoleSelectorLarge-rolesDropdownOptionsCallout"},responsiveMode:h.e.large,options:c,ariaLabel:this.props.ariaLabel}),this.props.children)};t._editDropDownOption={key:u.e.edit,text:f.ie,data:f.oe,ariaLabel:l.format(f.gs,f.ie,f.oe),title:l.format(f.gs,f.ie,f.oe)};t._editDropDownOptionForLists=Object(r.__assign)(Object(r.__assign)({},t._editDropDownOption),{text:f.se,data:f.ue,title:l.format(f.gs,f.se,f.ue)});t._reviewDropdownOption={key:u.e.review,text:f.ae,data:f.fe,ariaLabel:l.format(f.gs,f.ae,f.fe),title:l.format(f.gs,f.ae,f.fe)};t._viewDropdownOption={key:u.e.view,text:f.he,data:f.pe,ariaLabel:l.format(f.gs,f.he,f.pe),title:l.format(f.gs,f.he,f.pe)};t._viewDropdownOptionForLists=Object(r.__assign)(Object(r.__assign)({},t._viewDropdownOption),{data:f.de,title:l.format(f.gs,f.he,f.de)});t._fullControlDropdownOption={key:u.e.owner,text:f.Bt,data:f.jt,ariaLabel:l.format(f.gs,f.Bt,f.jt),title:l.format(f.gs,f.Bt,f.jt)};t._manageListDropdownOption={key:u.e.manageList,text:f.ne,data:f.re,ariaLabel:l.format(f.gs,f.ne,f.re),title:l.format(f.gs,f.ne,f.re)};return t})(i.Component),v=n(194),m=n(97),g=n(1508);Object(c.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-RoleSelectorCompact-permissionButton{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}[dir='ltr'] .od-RoleSelectorCompact-permissionButton{margin-left:8px}[dir='rtl'] .od-RoleSelectorCompact-permissionButton{margin-right:8px}.od-RoleSelectorCompact-permissionButton.is-expanded{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-RoleSelectorCompact-permissionButton:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-RoleSelectorCompact-permissionButton:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-RoleSelectorCompact-permissionButton:disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-RoleSelectorCompact-menuItem .od-RoleSelectorCompact-menuItem-textWrapper{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;margin:8px}[dir='ltr'] .od-RoleSelectorCompact-menuItem .od-RoleSelectorCompact-menuItem-textWrapper{text-align:left}[dir='rtl'] .od-RoleSelectorCompact-menuItem .od-RoleSelectorCompact-menuItem-textWrapper{text-align:right}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";line-height:2.25rem;height:3.25rem !important;font-size:.875rem}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link:active{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-link.is-disabled{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:transparent;font-size:1rem;width:1rem;max-height:unset}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon.is-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-itemText{font-size:.875rem;line-height:1.25rem}.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText{font-size:.75rem;line-height:1rem}.od-RoleSelectorCompact-menuItem.od-RoleSelectorCompact-settingsItem .ms-Icon-placeHolder{display:none}.od-RoleSelectorCompact-menuItem-stopSharing .ms-ContextualMenu-link{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-RoleSelectorCompact-menuItem-textWrapper.ms-ContextualMenu-secondaryText:hover{color:highlighttext}.ms-ContextualMenu-linkContent.ms-ContextualMenu-icon{color:highlighttext}@media screen and (-ms-high-contrast: active){.od-RoleSelectorCompact-menuItem-textWrapper.ms-ContextualMenu-secondaryText:hover{color:highlighttext}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-linkContent.ms-ContextualMenu-icon{color:highlighttext}}\n"}]);var y,b=n("prop-types-lib"),w=n(1753);(function(e){e.edit="edit";e.view="view";e.review="comment";e.fullControl="full-control";e.manageList="manage-list";e.divider="divider";e.stopSharing="stop-sharing";e.linkSettings="linkSettings"})(y||(y={}));var E=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._linkSettingsClickedInRoleSelector=function(){r.context.sharingStore.getEngagementHelper().log("RoleSelectorCompact.LinkSettingsClicked",{clientId:r.props.clientId,scenarioId:"",mode:r.props.mode});r.props.onLinkSettingsClicked()};r._onItemClicked=function(e,t){var n;r.props.sharingRole;switch(t.key){case y.fullControl:n=u.e.owner;break;case y.manageList:n=u.e.manageList;break;case y.edit:n=u.e.edit;break;case y.view:n=u.e.view;break;case y.review:n=u.e.review;break;default:n=u.e.none}r._selectedRole!==n&&r.props.onRoleChange(n)};r._selectedRole=r._parseRole(t.sharingRole);return r}t.prototype.render=function(){var e=this;this._selectedRole=this._parseRole(this.props.sharingRole);var n,r=this.props,s=r.menuPermissionOptions,o=r.showLinkSettings,a=r.showStopSharing,c=this._getMenuItems({menuPermissionOptions:s,showLinkSettings:o,showStopSharing:a}),h=c.filter(function(e){return e.itemType!==v.e.Divider}).length;switch(this.props.sharingRole){case u.e.owner:n=f.Bt;break;case u.e.edit:n=f.ie;break;case u.e.review:n=f.ae;break;case u.e.view:n=f.he;break;case u.e.manageList:n=f.ne;break;case u.e.none:n="";break;default:return null}var p={directionalHint:m.e.bottomRightEdge,shouldFocusOnMount:!0,items:c,isBeakVisible:!1,onItemClick:this._onItemClicked,onMenuOpened:function(){return e._logRoleSelectorClicked(e.context.sharingStore)},styles:t.menuItemStyles};return this.props.shimmer?i.createElement(g.e,{menuIconProps:{iconName:"ChevronDown",style:{fontSize:"16"}},iconProps:{iconName:"Stop"},className:"od-RoleSelectorCompact-permissionButton",menuProps:p,disabled:!0,styles:{root:{height:"2rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:{height:"2rem"}}}):w.t(i.createElement(g.e,{menuIconProps:{iconName:"ChevronDown",style:{fontSize:"16"}},iconProps:this.getRoleIconName(this.props.sharingRole),className:"od-RoleSelectorCompact-permissionButton",menuProps:p,disabled:this.props.disabled,ariaLabel:l.format(f.an,this.props.ariaLabel,n,h),styles:{root:{height:"2rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:{height:"2rem"}}}),n,{position:m.e.bottomRightEdge})};t.prototype._renderContent=function(e,t){return i.createElement(i.Fragment,null,t.renderCheckMarkIcon(e),t.renderItemIcon(e),i.createElement("div",{className:"od-RoleSelectorCompact-menuItem-textWrapper"},t.renderItemName(e),t.renderSecondaryText(e)),t.renderSubMenuIcon(e))};t.prototype._parseRole=function(e){return(e!==u.e.review||this.props.menuPermissionOptions.review.enabled)&&(e!==u.e.owner||this.props.menuPermissionOptions.fullControl.enabled)?e===u.e.restrictedview?u.e.view:e:u.e.edit};t.prototype._addRenderContent=function(e){var t=this;return e.map(function(e){return Object(r.__assign)(Object(r.__assign)({},e),{onRenderContent:t._renderContent})})};t.prototype._getMenuItems=function(e){var t=[],n=e.menuPermissionOptions,r=e.showLinkSettings,i=e.showStopSharing,s=n.fullControl,o=(s.enabled,s.shouldDisplay),u=void 0!==o&&o,a=n.review,c=(a.enabled,a.shouldDisplay),h=void 0!==c&&c,p=n.edit,d=p.enabled,m=void 0===d||d,g=p.shouldDisplay,b=void 0===g||g,w=n.view,E=(w.enabled,w.shouldDisplay),S=void 0===E||E,x=n.manageList,T=x.enabled,N=void 0!==T&&T,C=x.shouldDisplay,k=void 0!==C&&C,L={key:y.edit,text:k?f.se:f.ie,disabled:!m,secondaryText:k?f.ue:f.oe,ariaLabel:l.format(f.gs,k?f.se:f.ie,k?f.ue:f.oe),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Edit"}},A={key:y.view,text:f.he,secondaryText:k?f.de:f.pe,ariaLabel:l.format(f.gs,f.he,k?f.de:f.pe),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Uneditable2"}},O={key:y.fullControl,text:f.Bt,secondaryText:f.jt,ariaLabel:l.format(f.gs,f.Bt,f.jt),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Signin"}},M={key:y.manageList,text:f.ne,disabled:!N,secondaryText:f.re,ariaLabel:l.format(f.gs,f.ne,f.re),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"EditListPencil"}},_={key:y.review,text:f.ae,secondaryText:f.fe,ariaLabel:l.format(f.gs,f.ae,f.fe),className:"od-RoleSelectorCompact-menuItem",iconProps:{iconName:"Feedback"}},D={key:y.divider,itemType:v.e.Divider},P={key:y.stopSharing,text:f.mo,ariaLabel:f.mo,canCheck:!1,onClick:this.props.onStopSharing,className:"od-RoleSelectorCompact-menuItem od-RoleSelectorCompact-menuItem-stopSharing"},H={key:"linkSettings",text:f.Nn,onClick:this._linkSettingsClickedInRoleSelector,iconProps:{iconName:"Settings"},className:"od-RoleSelectorCompact-menuItem",ariaLabel:f.Nn};u&&t.push(O);k&&t.push(M);b&&t.push(L);h&&t.push(_);S&&t.push(A);i&&t.push(D,P);r&&t.push(D,H);return this._addRenderContent(t)};t.prototype._logRoleSelectorClicked=function(e){e.getEngagementHelper().log("RoleSelectorCompact.Clicked",{clientId:this.props.clientId,scenarioId:"",mode:this.props.mode})};t.prototype.getRoleIconName=function(e){var t;switch(e=this._parseRole(e)){case u.e.owner:t="Signin";break;case u.e.edit:t="Edit";break;case u.e.view:t="Uneditable2";break;case u.e.review:t="Feedback";break;case u.e.manageList:t="EditListPencil";break;case u.e.none:t="";break;default:throw new Error("Sharing role does not exist")}return{iconName:t}};t.contextTypes={sharingStore:b.object.isRequired};t.menuItemStyles={subComponentStyles:{menuItem:{root:{height:"52px !important"},label:{margin:"0",fontSize:"14px",fontWeight:"600",lineHeight:"20px"},secondaryText:{paddingLeft:"0",fontSize:"12px",lineHeight:"16px",textAlign:"left",whiteSpace:"normal"}}}};return t})(i.Component),S=(function(e){Object(r.__extends)(t,e);function t(t,n){return e.call(this,t)||this}t.prototype.render=function(){return this.props.compact?i.createElement(E,Object(r.__assign)({},this.props)):i.createElement(d,Object(r.__assign)({},this.props))};return t})(i.Component)},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(1419),i=n(4),s=n("react-lib"),o=n(270),u=n(472),a=Object(u.e)({cacheSize:100}),f=(function(e){Object(i.r)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.as,n=void 0===t?"label":t,r=e.children,u=e.className,f=e.disabled,l=e.styles,c=e.required,h=e.theme,p=a(l,{className:u,disabled:f,required:c,theme:h});return s.createElement(n,Object(i.e)({},Object(o.u)(this.props,o.s),{className:p.root}),r)};return t})(s.Component),l=n(25),c=Object(r.e)(f,function(e){var t,n=e.theme,r=e.className,s=e.disabled,o=e.required,u=n.semanticColors,a=l.i.semibold,f=u.bodyText,c=u.disabledBodyText,h=u.errorText;return{root:["ms-Label",n.fonts.medium,{fontWeight:a,color:f,boxSizing:"border-box",boxShadow:"none",margin:0,display:"block",padding:"5px 0",wordWrap:"break-word",overflowWrap:"break-word"},s&&{color:c,selectors:(t={},t[l.s]=Object(i.e)({color:"GrayText"},Object(l.T)()),t)},o&&{selectors:{"::after":{content:"' *'",color:h,paddingRight:12}}},r]}},void 0,{scope:"Label"})},,function(e,t,n){"use strict";var r=n(0),i=n(1649),s=n(52),o=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.key=t.key;var r=n.observables,i=t.count,s=void 0===i?r.create(1):i,o=t.isAvailable,a=void 0===o?r.create(!0):o,f=t.onExecute,l=void 0===f?u:f;n.count=s;n.isAvailable=a;n._onExecute=l.bind(t.operation);return n}t.prototype.dispose=function(){e.prototype.dispose.call(this);this._onExecute=u};t.prototype.execute=function(){return this._onExecute()};return t})(i.n);function u(){return s.n.wrap()}t.e=o},function(e,t,n){"use strict";n(1681);var r=n(704),i=n("knockout-lib"),s=(function(){function e(e,t){var n=this;this._source=e;this._getKey=t;this._groupsByKeyId={};this.groups=i.observableArray();this._initializeGroups();Object(r.e)(this.groups,function(){n._mapping.dispose()})}e.group=function(t,n){return new e(t,n).groups};e.prototype._initializeGroups=function(){var e=this;this._mapping=this._source.map({mappingWithDisposeCallback:function(t){var n=e._getKey(t),r=JSON.stringify(n),s=e._groupsByKeyId[r];if(s)s.values.push(t);else{s={key:n,values:i.observableArray([t])};e._groupsByKeyId[r]=s;e.groups.push(s)}return{mappedValue:r,dispose:function(){if(s.values.peek().length>1)s.values.remove(t);else{delete e._groupsByKeyId[r];e.groups.remove(s)}}}}})};return e})();t.e=s},function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){var t;t={};for(var n=[],r=0,i=e;r<i.length;r++){var s=i[r],o=""+s;if(!t[o]){t[o]=!0;n.push(s)}}return n}},function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(0),i=n(1649),s=n(76),o=n(1499),u=n(23),a=n(11),f=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._urlDataSource=n.urlDataSource;r._itemProvider=n.itemProvider;return r}t.prototype.createShortcut=function(e,t,n){var r=this;return this._getShortcutDataSource().then(function(r){return r.createShortcut(e,t,n)}).then(function(t){r._itemProvider.invalidateItem(e);return t})};t.prototype.getShortcutTargetData=function(e,t){return this._getShortcutDataSource().then(function(n){return n.getShortcutTargetData({url:e,avoidGetFileByUrlCall:t})})};t.prototype.getFileByUrl=function(e){return this._getShortcutDataSource().then(function(t){return t.getFileByUrl(e)})};t.prototype.getRecentFiles=function(){var e={parentKey:this._urlDataSource.getRootItemKey(u.e.Recent),startIndex:0,endIndex:5,queryType:u.e.Recent};return this._itemProvider.getItem(e)};t.prototype._getShortcutDataSource=function(){return this.resources.consumeAsync(s.oe)};return t})(i.n),l=Object(a.s)("ShortcutProvider",f,Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{urlDataSource:s.ve,itemProvider:o.resourceKey}))},function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(138);Object(s.n)([{rawString:".od-Share-LivePeoplePicker{max-height:150px;min-height:32px;overflow-y:auto}.od-Share-LivePeoplePicker-lpp{display:grid;display:-ms-grid;grid-template-columns:1fr auto;grid-template-rows:auto auto;row-gap:0;-ms-grid-columns:1fr auto;-ms-grid-rows:auto auto;-ms-row-gap:0}.od-Share-LivePeoplePicker-Adapter{grid-row:1;grid-column:1;-ms-grid-row:1;-ms-grid-column:1}.od-Share-LivePeoplePicker-RoleSelector{grid-row:1;grid-column:2;-ms-grid-row:1;-ms-grid-column:2;-ms-flex-item-align:end;align-self:end;-ms-grid-row-align:end}.od-Share-LivePeoplePicker-ErrorWarnings-wrapper{grid-row:2;grid-column:1;-ms-grid-row:2;-ms-grid-column:1}\n"}]);var o,u,a=n(1709),f=n(1825),l=n(1972),c=n("prop-types-lib"),h=!1,p=i.forwardRef(function(e,t){var r=Object(i.useState)(null),s=r[0],o=r[1];Object(i.useEffect)(function(){s||n.ee(["370"],4252,7).then(function(t){if(!h){t.initializeLivePersonaPicker(e.userPrincipalName,e.options);h=!0}o({LivePersonaPicker:t.getLivePersonaPickerWithRichTextInput(e.userPrincipalName),PersonaPillList:t.PersonaPillList})})},[s]);var u=Object(i.useState)(null),a=u[0],f=u[1],l=Object(i.useState)(!1),c=l[0],p=l[1];Object(i.useEffect)(function(){if(c&&a){a.focus();p(!1)}},[a,c]);Object(i.useImperativeHandle)(t,function(){return{focus:function(){p(!0)},getCurrentText:function(){return a.getCurrentText()}}});if(!s)return e.fallback||null;var d=s.LivePersonaPicker,v=s.PersonaPillList;return i.createElement("div",{className:e.className},i.createElement(v,{personaItems:e.selectedPersonas,onRemoveItem:e.onRemovePersona}),e.entryDisabled||i.createElement(d,{componentRef:function(e){f(e)},strings:e.strings,maxHeight:200,maxWidth:300,onSuggestionSelected:e.onSuggestionSelected,selectedSuggestions:e.selectedPersonas}))}),d=n(1637),v=n(390),m=n(1667),g=n(1654),y=n(1738),b=n(1844);(function(e){e.Person="Person";e.Group="Group"})(o||(o={}));(function(e){e.OrganizationUser="OrganizationUser";e.LinkedIn="LinkedIn";e.UnifiedGroup="UnifiedGroup";e.PublicDistributionList="PublicDistributionList"})(u||(u={}));var w=(function(e){Object(r.__extends)(t,e);function t(t,n){var s=e.call(this,t)||this;s._lppAdapterRef=Object(i.createRef)();s._wrapperDivRef=Object(i.createRef)();s._getHostAppSuggestions=function(e){return Object(r.__awaiter)(s,void 0,void 0,function(){var t,n,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=this.props.pickerSettings;n={principalSource:t.PrincipalSource,principalType:this._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!0,forceResolve:!0};return[4,this._peoplePickerProvider.sharePointSearch(e,n)];case 1:i=r.sent();return[2,i.map(function(e){return{Id:e.userId,Name:e.name,UserPrincipalName:e.rawPersonData.userPrincipalName||e.email,SuggestionType:e.name,SuggestionSubtype:e.name,EmailAddresses:[e.email||""],HostAppSuggestion:e}})]}})})};s._onSelectedPersonasChanged=function(){var e=s.state.selectedPersonas.map(function(e){return s._personaPillListItemToIPerson(e)});s.props.onChange(e)};s._onRemovePersona=function(e){s.setState(function(t,n){var i=s.state.selectedPersonas.filter(function(t){return t.Id!==e.Id});return Object(r.__assign)(Object(r.__assign)({},t),{selectedPersonas:i})},s._onSelectedPersonasChanged)};s._onSuggestionSelected=function(e){var t=Object(r.__assign)(Object(r.__assign)({},e),{validationState:"Pending"});s.setState(function(e){return Object(r.__assign)(Object(r.__assign)({},e),{selectedPersonas:Object(r.__spreadArrays)(e.selectedPersonas,[t])})});s._validateSuggestion(e).then(function(e){return s._onPersonaValidated(e)})};s._onKeyDown=function(e){"Backspace"===e.key&&s._lppAdapterRef.current&&""===s._lppAdapterRef.current.getCurrentText()&&s.setState(function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{selectedPersonas:e.selectedPersonas.slice(0,-1)})},s._onSelectedPersonasChanged)};s._validateSuggestion=function(e){return Object(r.__awaiter)(s,void 0,void 0,function(){var t,n,i;return Object(r.__generator)(this,function(s){switch(s.label){case 0:if(e.SuggestionSubtype===u.OrganizationUser)return[2,Object(r.__assign)(Object(r.__assign)({},e),{validationState:"Valid"})];t=this.props.pickerSettings;n={principalSource:t.PrincipalSource,principalType:this._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:t.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!0,forceResolve:!0};return[4,this._peoplePickerProvider.resolve(e.UserPrincipalName,n).then(function(e){!e.email&&e.rawData&&e.rawData.EntityData&&(e.email=e.rawData.EntityData.OtherMails);!e.name&&e.rawData&&e.rawData.EntityData&&(e.name=e.rawData.EntityData.OtherMails);return e})];case 1:i=s.sent();e.HostAppSuggestion=i;return[2,Object(r.__assign)(Object(r.__assign)({},e),{validationState:this._shouldShowErrorOnItem(i)?"Error":"Valid"})]}})})};s._peoplePickerProvider=n.peoplePickerProvider;s._resize=n.resize;s._platformDetection=n.platformDetection;s._hasTakenErrorFocus=!1;s._peoplePickerProvider=n.peoplePickerProvider;var a=t.defaultSelectedItems.map(function(e){return{Id:e.email,Name:e.name,UserPrincipalName:e.principalName,EmailAddresses:[e.email],SuggestionType:o.Person,SuggestionSubtype:u.OrganizationUser,HostAppSuggestion:e,Source:"HostApp",validationState:"Valid",SuggestionSource:"HostApp",SuggestionOrigin:"ZeroTerm"}});s.state={selectedPersonas:a};s._livePeoplePickerHelper=s._peoplePickerProvider._dataSource.getLivePersonaPickerHelper();s._resizeTracker=new y.e(n.resize);return s}t.prototype.render=function(){var e={emptyResults:g.In,loading:g.mn,error:g.n,allResults:g.e,limitedResults:g.t,suggestionsCalloutAccessibilityOnShow:g.Nt,useThisAddress:g.r,pickerModePlaceholderText:this._computePlaceholderText()};if(!(this.props.pickerSettings&&0!==Object.keys(this.props.pickerSettings).length))return i.createElement("div",{className:"od-Share-LivePeoplePicker-lpp"});var t=Object(r.__assign)(Object(r.__assign)({},this._livePeoplePickerHelper.getLppOptions()),{getHostAppSuggestions:this._getHostAppSuggestions}),n=this._livePeoplePickerHelper.getUserPrincipalName();return i.createElement("div",{className:"od-Share-LivePeoplePicker-lpp",ref:this._wrapperDivRef,onKeyDown:this._onKeyDown},i.createElement(p,{className:"od-Share-LivePeoplePicker-Adapter",ref:this._lppAdapterRef,userPrincipalName:n,options:t,strings:e,entryDisabled:!1,selectedPersonas:this.state.selectedPersonas,onSuggestionSelected:this._onSuggestionSelected,onRemovePersona:this._onRemovePersona,fallback:i.createElement(d.e,{size:v.e.small})}),this.props.renderRoleSelector&&i.createElement("div",{className:"od-Share-LivePeoplePicker-RoleSelector"},i.createElement(b.e,Object(r.__assign)({},this.props.roleSelectorProps))),i.createElement("div",{className:"od-Share-LivePeoplePicker-ErrorWarnings-wrapper"},this._renderError(),this._renderWarnings()))};t.prototype._renderError=function(){var e=this.props.error;if(e&&!this._isValidateInProgress()){if(!m.s(this.props.clientId)&&!this._hasTakenErrorFocus){this._focusInput();this._hasTakenErrorFocus=!0}return i.createElement("span",{className:"od-Share-PeoplePicker-error",role:"alert"},e)}};t.prototype._renderWarnings=function(){var e=this.props.oversharingExternalsWarning,t=this.props.oversharingGroupsWarning,n=[];if(!this.props.error){this.state.selectedPersonas.length>=this.props.selectionLimit&&n.push(i.createElement(l.e,{key:"peoplePickerLimitMessage",ariaLabel:g.ii},g.ii));e&&n.push(i.createElement(l.e,{key:"oversharingExternalsWarning",ariaLabel:e},e));t&&n.push(i.createElement(l.e,{key:"oversharingGroupsWarning",ariaLabel:t},t));return n.length>0?i.createElement("div",{"aria-live":"assertive",role:"status",className:"od-Share-PeoplePicker-warning"},n):void 0}};t.prototype.componentDidUpdate=function(e,t){this._resizeTracker?this._resizeTracker.checkSizeChangeForRef(this._wrapperDivRef):null!==this.props.error&&null===e.error&&this._resize();var n=t.selectedPersonas.length>=this.props.selectionLimit&&this.state.selectedPersonas.length<this.props.selectionLimit;this._hasInitialFocus&&!n||this._focusInput()};t.prototype.componentDidMount=function(){var e=this._platformDetection.isIE;m.s(this.props.clientId)||e||this._focusInput()};t.prototype._focusInput=function(){if(this._lppAdapterRef.current){this._lppAdapterRef.current.focus();this._hasInitialFocus=!0}};t.prototype._shouldShowErrorOnItem=function(e){var t=this._computeAllowExternalUsers(this.props.sharingLinkKind,this.props.sharingInformation.canAddExternalPrincipal),n=this.props.permissionsMap;return e.isExternal&&!t||1===this.props.sharingLinkKind&&n&&(1===n[e.email]||1===n[e.userId])||!e.isResolved&&!e.isResolving};t.prototype._computeAllowExternalUsers=function(e,t){return!(2===e||3===e)&&t};t.prototype._onPersonaValidated=function(e){this.setState(function(t,n){var i=t.selectedPersonas.filter(function(t){return t.Id!==e.Id});i.push(e);return Object(r.__assign)(Object(r.__assign)({},t),{selectedPersonas:i})},this._onSelectedPersonasChanged)};t.prototype._convertPrincipalType=function(e){if(!e)return a.e.none;for(var t=a.e.none,n=0,r=e.split(",");n<r.length;n++){var i=r[n];"User"===i&&(t|=a.e.user);"DL"===i&&(t|=a.e.distributionList);"SecGroup"===i&&(t|=a.e.securityGroup);"SPGroup"===i&&(t|=a.e.sharePointGroup)}return t};t.prototype._lppSuggestionToIPerson=function(e){if(e.HostAppSuggestion&&e.HostAppSuggestion.hasOwnProperty("userId"))return e.HostAppSuggestion;var t=e.EmailAddresses[0],n=e.UserPrincipalName&&f.e.isValidEmailSyntax(e.UserPrincipalName,!1)?e.UserPrincipalName:t,r={Key:n,IsResolved:!1},i=e.SuggestionSubtype===u.OrganizationUser,s=e.SuggestionSubtype===u.LinkedIn,l=e.SuggestionType===o.Group&&e.SuggestionSubtype===u.UnifiedGroup,c=e.SuggestionSubtype===u.PublicDistributionList,h={rawData:r,rawPersonData:r,userId:n,name:e.Name,email:t,isExternal:!i,isResolved:!0};if(i){h.entityType=0;h.principalType=a.e.user}else if(l){h.entityType=2;h.principalType=a.e.securityGroup}else if(s)h.entityType=4;else{h.principalType=c?a.e.distributionList:a.e.none;h.entityType=e.SuggestionType===o.Group?2:1;h.providerName=void 0}return h};t.prototype._personaPillListItemToIPerson=function(e){return Object(r.__assign)(Object(r.__assign)({},this._lppSuggestionToIPerson(e)),{isResolved:"Pending"!==e.validationState})};t.prototype._isValidateInProgress=function(){for(var e=0,t=this.state.selectedPersonas;e<t.length;e++){if("Pending"===t[e].validationState)return!0}return!1};t.prototype._computePlaceholderText=function(){return this.props.inputTextPlaceholder&&this.props.inputTextPlaceholder.length>0?this.props.inputTextPlaceholder:0===this.props.defaultSelectedItems.length?g.ui:g.fi};t.contextTypes={peoplePickerProvider:c.object.isRequired,resize:c.func.isRequired,platformDetection:c.object.isRequired};return t})(i.Component);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-Share-PeoplePickerContainer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:nowrap;flex-wrap:nowrap;overflow-y:auto;overflow-x:hidden}.od-Share-PeoplePickerContainer .od-Share-PeoplePicker-wrapper{max-width:calc(100% - 60px);-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.od-Share-PeoplePickerContainer .od-Share-PeoplePicker-wrapper#od-Share-PeoplePicker-wrapper-id .ms-BasePicker-text::after{content:none}.od-Share-PeoplePicker-ErrorWarnings-wrapper{grid-row:2;grid-column:1;-ms-grid-row:2;-ms-grid-column:1}.od-Share-PeoplePicker-RoleSelector{-ms-flex-item-align:end;align-self:flex-end;grid-row:1;grid-column:2;-ms-grid-row:1;-ms-grid-column:2;-ms-grid-row-align:end}.od-Share-PeoplePicker .ms-BasePicker-text{min-height:26px;border:none;padding:0px;border-bottom:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Share-PeoplePicker .ms-BasePicker-input{font-size:.75rem;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}[dir='ltr'] .od-Share-PeoplePicker .ms-BasePicker-input{padding-left:0}[dir='rtl'] .od-Share-PeoplePicker .ms-BasePicker-input{padding-right:0}.od-Share-PeoplePicker.ms-Share-PeoplePicker--error .ms-BasePicker-text{border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Share-PeoplePicker .ms-BasePicker-input::before{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline .ms-TextField-field{font-size:.75rem}.od-Share-PeoplePicker .ms-TextField-field{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-webkit-input-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:.75rem}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-moz-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:.75rem}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-ms-input-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:.75rem}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-moz-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:.75rem}.od-Share-PeoplePicker .ms-PickerPersona-container{border-radius:16px;margin-bottom:8px;max-width:208px}[dir='ltr'] .od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-left:1px}[dir='rtl'] .od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-right:1px}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-primaryText{font:-apple-system-body}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded{background-color:transparent;border:1px solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}[dir='ltr'] .od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-left:12px}[dir='rtl'] .od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-right:12px}.od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Button-icon{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-Share-PeoplePicker .ms-PickerItem-content{max-width:250px;border-radius:16px;font-size:1rem}.od-Share-PeoplePicker .ms-PickerItem-content.ms-Button--icon{width:2rem;height:100%}.od-Share-PeoplePicker .ms-PickerItem-content .ms-Button-flexContainer i.ms-Button-icon{font-size:1rem;height:1rem;line-height:1rem}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container{max-height:200px}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-primaryText{font:-apple-system-body}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions.od-Share-PeoplePicker-Suggestions-condensed .ms-Suggestions-container{max-height:150px}.od-Share-PeoplePicker-Suggestions button.ms-SearchMore-button{font-size:.75rem;height:2.5rem}.od-Share-PeoplePicker-Suggestions button.ms-SearchMore-button i.ms-Button-icon{font-size:1rem;width:1.5625rem}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-none{font-size:.75rem;line-height:1.875rem}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner{line-height:1.875rem}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner div.ms-Spinner-circle{width:1.25rem;height:1.25rem}.od-Share-PeoplePicker-Suggestions div.ms-Suggestions-spinner div.ms-Spinner-label{font-size:.75rem}.od-Share-PeoplePicker-error{font-size:.75rem;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";display:block;margin-bottom:4px;font:-apple-system-caption2}[dir='ltr'] .od-Share-PeoplePicker-error .od-Share-PeoplePicker-error-changeTypeLink{margin-left:5px}[dir='rtl'] .od-Share-PeoplePicker-error .od-Share-PeoplePicker-error-changeTypeLink{margin-right:5px}.od-Share-PeoplePicker-warning{word-break:break-word;font:-apple-system-caption2}.od-Share-PeoplePicker-warning .ms-MessageBar{display:block;padding:6px;-webkit-box-sizing:border-box;box-sizing:border-box}.od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-text{margin:0}.od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-icon{margin:0 5px 0 0}[dir='rtl'] .od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-icon{margin:0 0 0 5px}.od-Share-PeoplePicker-selectedItem--error .ms-PickerPersona-container{border-style:solid;border-width:1px;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";background-color:RGBA("},{theme:"redDark",defaultValue:"#a4262c"},{rawString:", 0.06);font:-apple-system-caption2}.od-Share-PeoplePicker-resolve-spinner{padding:3px}@media screen and (-ms-high-contrast: active){.od-Share-PeoplePicker-Suggestions .ms-Button.is-suggested .od-Share-PeoplePicker-Suggestions .ms-Persona .od-Share-PeoplePicker-Suggestions .ms-Persona-details .od-Share-PeoplePicker-Suggestions .ms-Persona-primaryText{color:HighlightText}}@media screen and (-ms-high-contrast: active){.od-Share-PeoplePicker-Suggestions .ms-Button:hover .od-Share-PeoplePicker-Suggestions .ms-Persona .od-Share-PeoplePicker-Suggestions .ms-Persona-details .od-Share-PeoplePicker-Suggestions .ms-Persona-primaryText{color:HighlightText}}@media screen and (-ms-high-contrast: active){.od-Share-PeoplePicker-Suggestions .ms-Suggestions-item:hover,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-personaContent:hover,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-pickerPersona:hover,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon:hover,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText:hover{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:highlighttext;forced-color-adjust:none}.od-Share-PeoplePicker-Suggestions .ms-Persona-secondaryText,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-personaContent,.od-Share-PeoplePicker-Suggestions .ms-PeoplePicker-pickerPersona,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText{color:inherit}}@media (forced-colors: active) and (prefers-color-scheme: dark){::-webkit-input-placeholder{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:white !important;forced-color-adjust:none}::-moz-placeholder{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:white !important;forced-color-adjust:none}::-ms-input-placeholder{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:white !important;forced-color-adjust:none}::placeholder{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:white !important;forced-color-adjust:none}}@media (forced-colors: active) and (prefers-color-scheme: light){::-webkit-input-placeholder,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:black !important;forced-color-adjust:none}::-moz-placeholder,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:black !important;forced-color-adjust:none}::-ms-input-placeholder,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:black !important;forced-color-adjust:none}::placeholder,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-icon,.od-RoleSelectorCompact-menuItem .ms-ContextualMenu-secondaryText{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:400;font-size:.75rem;color:black !important;forced-color-adjust:none}}.ms-BasePicker-input:focus{cursor:pointer}\n"}]);var E,S=n(1486),x=n(1881),T=n(1913),N=n(2367),C=n(22),k=n(1758),L=n(125),A=n(2051),O=n(1670),M=n(993),_=n(249),D=n(70),P=n(1725),H=n(1688),B=n(1753);(function(e){e[e.None=0]="None";e[e.Family=1]="Family";e[e.FamilyMember=2]="FamilyMember"})(E||(E={}));D.t.isActivated("c0f33ab5-b308-47d6-9537-a4b510e6093f","09/14/2021","Fix for button label in high contrast mode cause by .ms-Button-flexContainer:hover in PeoplePicker.scss.")||(function(){var e=document.createElement("style");e.innerHTML="\n  @media screen and (-ms-high-contrast: active) {\n    .ms-Button-flexContainer:hover {\n      font-size: inherit !important;\n      color: inherit !important;\n      forced-color-adjust: none;\n    }\n  }\n  ";document.head.insertAdjacentElement("beforeend",e)})();var j=(function(e){Object(r.__extends)(t,e);function t(t,n){var s=e.call(this,t)||this;s._onItemsChange=function(e){var t=s.state.selectedItems.concat(e);s.setState({selectedItems:t},function(){s.props.onChange(t)});e.forEach(function(e){s._onAutoResolve(e)})};s._onInputChange=function(e){s._hasTakenErrorFocus=!1;if(e&&e.indexOf(";")>-1){var t=e.split(";").map(function(e){var t=/<[^\]]*>/g.exec(e);t&&t[0]&&(e=t[0].substring(1,t[0].length-1));if(e=e.trim())return s._createGenericPerson(e)}).filter(function(e){return e});s._onItemsChange(t);s.props.onInputChange&&s.props.onInputChange("");return""}var n=/['"].*['"]/g.exec(e);if(n&&n[0])return n[0].substring(1,n[0].length-1);s.props.onInputChange&&s.props.onInputChange(e);return e};s._onGetMoreResults=function(e){var t=s.props.pickerSettings,n={principalSource:t.PrincipalSource,principalType:s._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:30,useSubstrateSearch:!1,allowSharePointGroups:!1,forceResolve:!0,useSubstrate:!!s.props.sharingInformation.enforceIBSegmentFiltering,siteIBSegmentIDs:s.props.sharingInformation.siteIBSegmentIDs};return s._peoplePickerProvider.sharePointSearch(e,n)};s._onSuggestionSelected=function(e){var t=s.props.pickerSettings,n={principalSource:t.PrincipalSource,principalType:s._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:t.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!1,forceResolve:!0};if(_.e.isFeatureEnabled({ODC:"FamilySharing"})&&m.g(s.props.clientId)){var r=s._store.getFamily(),i=s._store.getFamilyMembers();r&&i&&(e.userId===r.userId?s._store.getEngagementHelper().log("PeoplePicker.FamilyGroupSelected",{clientId:s.props.clientId,scenarioId:"",familySuggestionType:E[s.state.familyType],mode:N.e.share}):i.some(function(t){return t.userId===e.userId})&&s._store.getEngagementHelper().log("PeoplePicker.FamilyMemberSelected",{clientId:s.props.clientId,scenarioId:"",familySuggestionType:E[s.state.familyType],mode:N.e.share}))}if(!1===e.isExternal||e.isExternal&&e.providerName)return e;if(e.principalType===a.e.distributionList){n.isGraphDistributionList=!0;n.useGraph=!0}var o=Object(P.i)(e);return!e.isResolved||o?s._peoplePickerProvider.resolve(e.userId,n).then(function(t){!t.email&&t.rawData&&t.rawData.EntityData&&(t.email=t.rawData.EntityData.OtherMails);!t.name&&t.rawData&&t.rawData.EntityData&&(t.name=t.rawData.EntityData.OtherMails);4===e.entityType&&(t.entityType=e.entityType);return t}):e};s._onRenderItem=function(e){var t=s.props.permissionsMap,n=s._computeAllowExternalUsers(s.props.sharingLinkKind,s.props.sharingInformation.canAddExternalPrincipal),o=e.item.isExternal&&!n||1===s.props.sharingLinkKind&&t&&(void 0!==t[e.item.email]&&1===t[e.item.email]||void 0!==t[e.item.userId]&&1===t[e.item.userId])||!e.item.isResolved&&!e.item.isResolving,u=e.item.name;e.removeButtonAriaLabel=C.format(g.as,u);e.item.imageAlt=C.format(g.Fo,u);return o?i.createElement("div",{className:"od-Share-PeoplePicker-selectedItem--error"},i.createElement(x.t,Object(r.__assign)({},e))):e.item.isResolving?i.createElement(d.e,{className:"od-Share-PeoplePicker-resolve-spinner"}):i.createElement(x.t,Object(r.__assign)({},e))};s._onToggleGetMoreResults=function(e){s.state&&(e&&!s.state.searchForMoreText||!e&&s.state.searchForMoreText)&&s.setState({searchForMoreText:s._getSearchForMoreText(e)})};s._peoplePickerProvider=n.peoplePickerProvider;s._resize=n.resize;s._platformDetection=n.platformDetection;s._hasTakenErrorFocus=!1;s._store=n.sharingStore;s.state={selectedItems:t.defaultSelectedItems,searchForMoreText:s._getSearchForMoreText(t.sharingInformation.isGraphAvailable),addedUsers:[],removedUsers:[],familyType:E.None,familyResolveEventFired:!1};s._resizeTracker=new y.e(n.resize);return s}t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.defaultSelectedItems,n=this.props.defaultSelectedItems,r=[];n.forEach(function(e){var n=t.filter(function(t){return t.name===e.name});n.length>0&&(H.t()?r.push(n[0].name):r.push({name:n[0].name,userId:n[0].userId}))});this.setState({selectedItems:t,addedUsers:r})};t.prototype.componentDidUpdate=function(e,t){this._peoplePicker.scrollTop=this._peoplePicker.scrollHeight;var n=t.addedUsers,r=this.state.addedUsers,i=this.state.removedUsers;this._resizeTracker?this._resizeTracker.checkSizeChange(this._peoplePicker):null!==this.props.error&&null===e.error&&this._resize();if(n.length>r.length){i=n.filter(function(e){return-1===r.indexOf(e)});this.setState({removedUsers:i})}else n.length!==r.length&&i.length>0&&this.setState({removedUsers:[]})};t.prototype.componentDidMount=function(){var e=this._platformDetection.isIE;!this._peoplePickerControl||m.s(this.props.clientId)||e||this._peoplePickerControl.focusInput()};t.prototype.render=function(){var e=this,t={placeholder:this._computePlaceholderText(),onFocus:function(t){e._onFocus()},"aria-label":this._computeAddAnotherAriaLabel()},n=this.props.pickerSettings,s={principalSource:n.PrincipalSource,principalType:this._convertPrincipalType(n.PrincipalAccountType),querySettings:n.QuerySettings,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:30,useSubstrateSearch:n.UseSubstrateSearch,allowSharePointGroups:!!this.props.allowSPGroups,forceResolve:!0,useGraph:!this.props.disableGraph,useSubstrate:!!this.props.sharingInformation.enforceIBSegmentFiltering,onToggleGetMoreResults:this._onToggleGetMoreResults,conversationId:L.e.generate(),siteIBSegmentIDs:this.props.sharingInformation.siteIBSegmentIDs,siteIBMode:D.t.isActivated("078e2fe2-3740-4368-9f64-61a7032577f7","04/26/2021","Pass SiteIBMode to 3S.")?"":this.props.sharingInformation.siteIBMode},o=this.props.error?"od-Share-PeoplePicker ms-Share-PeoplePicker--error":"od-Share-PeoplePicker",u=m.s(this.props.clientId)||this._platformDetection.isMobile,a={preventDismissOnScroll:u,preventDismissOnResize:!0},f=u?g.Ct:g.Nt;return i.createElement("div",{className:"od-Share-PeoplePickerContainer"},i.createElement("div",{id:"od-Share-PeoplePicker-wrapper-id",className:"od-Share-PeoplePicker-wrapper",role:"presentation",ref:function(t){e._peoplePicker=t}},B.e(this._computePeopleAddOrRemoveMessage(),"assertive","alert",!0),i.createElement(T.e,{"aria-describedby":"inputErrorMessage",componentRef:this._resolveRef("_peoplePickerControl"),className:o,dataProvider:this._peoplePickerProvider,selectedItems:this.state.selectedItems,inputProps:t,loadingText:g.mn,noResultsFoundText:g.In,onSelectedPersonasChange:this.props.onChange,peoplePickerQueryParams:s,suggestionsClassName:"od-Share-PeoplePicker-Suggestions"+(this._peoplePickerProvider.sharePointSearch?" od-Share-PeoplePicker-Suggestions-condensed":""),onRenderItem:this._onRenderItem,onSuggestionSelected:this._onSuggestionSelected,onResolvedSuggestions:this._onResolvedSuggestions.bind(this),itemLimit:this.props.selectionLimit,onInputChange:this._onInputChange,onRenderSuggestionsItem:this._store.showEmailsInSuggestions()?this._onRenderSuggestionsItem:null,onGetMoreResults:this._peoplePickerProvider.sharePointSearch?this._onGetMoreResults:null,searchForMoreText:this._peoplePickerProvider.sharePointSearch?this.state.searchForMoreText:null,suggestionsAvailableAlertText:f,enableSelectedSuggestionAlert:this._platformDetection.isIE,role:"presentation",pickerCalloutProps:a}),i.createElement("div",{id:"inputErrorMessage",className:"od-Share-PeoplePicker-ErrorWarnings-wrapper"},this._renderError(),this._renderWarnings())),this.props.renderRoleSelector&&i.createElement("div",{className:"od-Share-PeoplePicker-RoleSelector"},i.createElement(b.e,Object(r.__assign)({},this.props.roleSelectorProps))))};t.prototype._onResolvedSuggestions=function(e,t){var n=this;if(_.e.isFeatureEnabled({ODC:"FamilySharing"})&&m.g(this.props.clientId)){var r=this._store.getFamily(),i=this._store.getFamilyMembers();if(r&&t.length>1){var s=0===g.kt.toLocaleLowerCase().indexOf(t.toLocaleLowerCase()),o=!1,u=E.None;if(s){u=E.Family;o=!0;e=[r].concat(i,e)}else{e.forEach(function(t,n){i.forEach(function(i){if(!o&&t.userId===i.userId||t.email===i.email){e.splice(n+1,0,r);o=!0}})});o&&(u=E.FamilyMember)}this.setState({familyType:u});if(o&&!this.state.familyResolveEventFired){this.setState({familyResolveEventFired:!0});this._store.getEngagementHelper().log("PeoplePicker.FamilyGroupResolved",{clientId:this.props.clientId,scenarioId:"",mode:N.e.share,familySuggestionType:E[u]})}}}var a=[],f=[this._store.getCurrentUserId()],l=[];e.forEach(function(e){if(-1===f.indexOf(e.userId)&&-1===a.indexOf(e.email)){H.t()?l.push(e):n.state.addedUsers.some(function(t){return t.name===e.name&&t.userId===e.userId})||l.push(e);e.userId&&f.push(e.userId);e.email&&a.push(e.email)}});try{return this.props.onResolvedSuggestions(l)}catch(e){return l}};t.prototype._createGenericPerson=function(e){return{userId:e,name:e,email:e,isResolving:!0}};t.prototype._onRenderSuggestionsItem=function(e){var t={text:e.name||"",imageUrl:e.image||"",tertiaryText:e.email&&e.email!==e.name?e.email:"",secondaryText:e.email||"",imageInitials:"",imageAlt:e.imageAlt,coinProps:{styles:{coin:{width:"2.5rem",height:"2.5rem",maxWidth:"75px",maxHeight:"75px"},image:{width:"2.5rem !important",height:"2.5rem !important",maxWidth:"75px",maxHeight:"75px"},imageArea:{width:"2.5rem",height:"2.5rem",maxWidth:"75px",maxHeight:"75px"}}},styles:{root:{height:"2.5rem"},primaryText:{fontSize:"0.875rem"},secondaryText:{fontSize:"0.75rem"}}};return i.createElement("div",{className:"ms-PeoplePicker-personaContent"},i.createElement(A.e,Object(r.__assign)({},t,{presence:O.t.none,size:O.n.size40,className:"ms-PeoplePicker-pickerPersona"})),4===e.entityType&&i.createElement(M.e,{className:"od-PeoplePicker-linkedInLogo",iconName:"LinkedInLogo"}))};t.prototype._onAutoResolve=function(e){var t=this,n=this.props.pickerSettings,i={principalSource:n.PrincipalSource,principalType:this._convertPrincipalType(n.PrincipalAccountType),querySettings:n.QuerySettings,allowEmailAddresses:n.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!1,forceResolve:!0};this._peoplePickerProvider.resolve(e.email,i).then(function(n){!n.email&&n.rawData&&n.rawData.EntityData&&(n.email=n.rawData.EntityData.OtherMails);!n.name&&n.rawData&&n.rawData.EntityData&&(n.name=n.rawData.EntityData.OtherMails);var r=[];t.state.selectedItems.forEach(function(t){t.email===e.email?r.push(n):r.push(t)});t.setState({selectedItems:r},function(){t.props.onChange(r)})}).catch(function(){var n=Object(r.__assign)(Object(r.__assign)({},e),{isResolving:!1}),i=[];t.state.selectedItems.forEach(function(t){t.email===e.email?i.push(n):i.push(t)});t.setState({selectedItems:i},function(){t.props.onChange(i)})})};t.prototype._isResolveInProgress=function(){for(var e=0,t=this.state.selectedItems;e<t.length;e++){if(t[e].isResolving)return!0}return!1};t.prototype._computePlaceholderText=function(){return this.props.inputTextPlaceholder&&this.props.inputTextPlaceholder.length>0?this.props.inputTextPlaceholder:0===this.props.defaultSelectedItems.length?g.ui:g.fi};t.prototype._computePeopleAddOrRemoveMessage=function(){var e=this.state,t=e.addedUsers,n=e.removedUsers,r=[];t.length>0&&(r=r.concat(t.map(function(e){return C.format(g.si,e)+". "+g.fi})));n.length>0&&(r=r.concat(n.map(function(e){return C.format(g.oi,e)})));return r.length>0?r.toString():""};t.prototype._convertPrincipalType=function(e){if(!e)return a.e.none;for(var t=a.e.none,n=0,r=e.split(",");n<r.length;n++){var i=r[n];"User"===i&&(t|=a.e.user);"DL"===i&&(t|=a.e.distributionList);"SecGroup"===i&&(t|=a.e.securityGroup);"SPGroup"===i&&(t|=a.e.sharePointGroup)}return t};t.prototype._computeAllowExternalUsers=function(e,t){return!(2===e||3===e)&&t};t.prototype._renderError=function(){var e=this.props.error;if(e&&!this._isResolveInProgress()){if(this._peoplePickerControl&&!m.s(this.props.clientId)&&!this._hasTakenErrorFocus){this._peoplePickerControl.focusInput();this._hasTakenErrorFocus=!0}return i.createElement("span",{className:"od-Share-PeoplePicker-error",role:"alert","aria-atomic":"true"},e)}};t.prototype._renderWarnings=function(){var e=this.props.oversharingExternalsWarning,t=this.props.oversharingGroupsWarning,n=[],r={icon:{fontSize:"1rem",minWidth:"1rem",minHeight:"1rem"},text:{fontSize:"0.75rem",lineHeight:"1rem"},innerText:{lineHeight:"1rem"}};if(!this.props.error){this.state.selectedItems.length===this.props.selectionLimit&&n.push(i.createElement(l.e,{ariaLabel:g.ii,styles:r},g.ii));e&&n.push(i.createElement(l.e,{ariaLabel:e,styles:r},e));t&&n.push(i.createElement(l.e,{ariaLabel:t,styles:r},t));return n.length>0?i.createElement("div",{"aria-live":"assertive",role:"status",className:"od-Share-PeoplePicker-warning"},n):void 0}};t.prototype._getSearchForMoreText=function(e){return e?g.ws:void 0};t.prototype._onFocus=function(){k.c()};t.prototype._computeAddAnotherAriaLabel=function(){return 0===this.props.defaultSelectedItems.length?g.Ss:g.Es};t.contextTypes={peoplePickerProvider:c.object.isRequired,resize:c.func.isRequired,platformDetection:c.object.isRequired,sharingStore:c.object.isRequired};return t})(S.e),F=n(2108),I=n(71),q=n(48),R=n(127);function U(e){e.onError;var t=e.componentName,n=Object(R.e)(function(e,n){I.e.logError(e,{"react.componentStack":n.componentStack,"react.component":t},{eventName:"ReactRenderError",resultCode:"",resultType:q.e.Failure})});return i.createElement(F.e,Object(r.__assign)({},e,{onError:n}))}var z=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._peoplePickerProvider=n.peoplePickerProvider;return r}t.prototype.render=function(){var e,t;return!!(null===(e=this._peoplePickerProvider)||void 0===e?void 0:e.getLivePersonaPickerHelper)&&!!(null===(t=this._peoplePickerProvider)||void 0===t?void 0:t.getLivePersonaPickerHelper())?i.createElement(w,Object(r.__assign)({},this.props,{selectionLimit:100})):D.t.isActivated("2898c580-055c-49c6-888b-10e3506606ad","04/10/2021","Error boundary for PeoplePicker.")?i.createElement(j,Object(r.__assign)({},this.props,{selectionLimit:100})):i.createElement(U,{componentName:"peoplePicker.peoplePickerWrapper"},i.createElement(j,Object(r.__assign)({},this.props,{selectionLimit:100})))};t.contextTypes={peoplePickerProvider:c.object.isRequired};return t})(i.Component);t.e=z},function(e,t,n){"use strict";var r=n("knockout-lib"),i=n(1856),s=(function(){function e(){this.handlers=[]}e.prototype.register=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0;n<e.length-1;n++)this.handlers.push({pattern:e[n],callback:e[e.length-1]})};e.prototype.match=function(e,t){for(var n=0;n<this.handlers.length;n++)if(this._compare(this.handlers[n].pattern,e)){var r=this.handlers[n].callback.call(this,e,t);return"boolean"!=typeof r||r}return!1};e.prototype._compare=function(e,t){for(var n in e)if(e.hasOwnProperty(n)&&e[n]!==t[n])return!1;return!0};return e})(),o=n(156),u=n(129),a=(function(){function e(){}e.init=function(t,n,s,u,a){var f,l=r.utils.unwrapObservable(n()),c=s(),h=new o.t(null),p={mode:"multi",direction:"custom",properties:{selected:"selected",focused:"focused",activeClass:"selection-active"}},d=l.selectionModel||new i.e;f=l.data?l.data:c.foreach&&c.foreach.data||c.foreach||c.template&&c.template.foreach;d.items=r.isObservable(f)?f:r.observableArray(f);d.rootElement=r.observable(t);if(l){d.focused=l.focused||r.observable(null);d.anchor=l.anchor||r.observable(null);d.layout=l.layout||r.observable(null);d.toggleClass=d.layout()?d.layout().getToggleClass():l.toggleClass||null;d.clearSelectionOnRemoval=l.clearSelectionOnRemoval;d.selectFirstItemOnActivate="boolean"!=typeof l.selectFirstItemOnActivate||l.selectFirstItemOnActivate;r.isObservable(l.mode)?d.mode=l.mode:d.mode=r.observable(l.mode||p.mode);r.isObservable(l.direction)?d.direction=l.direction:d.direction=r.observable(l.direction||p.direction);r.utils.extend(p.properties,l.properties)}else{d.selection=r.observableArray(l.data);d.focused=r.observable(null);d.anchor=r.observable(null);d.mode=r.observable(p.mode);d.direction=r.observable(p.direction);d.layout=null}d.init(p);var v=e.getMode(d.mode())(d,l.isReadyToBeSelected);e._registerEventHandlers(h,t,d,v,l.alwaysSelectFirst,l.isActive,l.allowInputEvents);r.utils.domNodeDisposal.addDisposeCallback(t,function(){d.clearSelectionOnRemoval&&d.clear();h.dispose()})};e.getMode=function(t){var n=e.modes[t];if(!n)throw new Error('Unknown mode: "'+t+'"');return n};e._registerEventHandlers=function(e,t,n,r,i,s,o){function a(e){var t=e.target,i=t&&"A"===t.tagName,s=n.findItemData(e.target);e.hasItem=!!s;e.isClickOnToggleElement=n.isClickOnToggleElement(this,e.target);i||r.match(e,s)}e.on(t,"touchstart",a);e.on(t,"touchend",a);e.on(t,"touchmove",a);e.on(t,"click",a);e.on(t,"focusin",function(e){if(!(e.relatedTarget&&t.contains(e.relatedTarget)||n.isActive.peek())){if(i){var r=n.firstItem();n.focused(r);n.anchor(r)}else if(e.target===t){var s=n.focused.peek();if(0===n.selection.peek().length&&!s&&n.selectFirstItemOnActivate){r=n.firstItem();n.focused(r);n.anchor(r);n.selectItem(r)}else if(s){n.selectItem(s);n.anchor(s)}}n.activate()}});e.on(t,"focusout",function(e){e.relatedTarget&&!t.contains(e.relatedTarget)&&n.deactivate()});e.on(t,"keydown",function(e){var i=e.target,a=i&&("INPUT"===i.tagName||"TEXTAREA"===i.tagName);if(!o&&a||s&&!s())return!0;var f=n.focused.peek();e.hasItem=!!f;e.keyCode===u.e.tab&&e.shiftKey&&!e.ctrlKey&&t.focus();if(r.match(e,f)){e.stopPropagation();e.preventDefault()}})};e._isItemReadyToBeSelected=function(e,t){var n=!1;!e||t&&!t(e)||(n=!0);return n};e._getSingleMatchers=function(t,n){t.focused()?t.selection([t.focused()]):t.selection.splice(1);var r=new s;r.register({type:"click",which:1,hasItem:!0,isClickOnToggleElement:!1},function(e,n){t.selectItem(n);t.anchor(n)});r.register({type:"click",which:1,hasItem:!0,isClickOnToggleElement:!0},function(e,n){t.selectItem(n);t.anchor(n)});r.register({type:"keydown",which:u.e.end},function(e,n){var r=t.lastItem();t.selectItem(r);t.anchor(r)});r.register({type:"keydown",which:u.e.home},function(e,n){var r=t.firstItem();t.selectItem(r);t.anchor(r)});r.register({type:"keydown",which:u.e.space,hasItem:!0},function(e,t){});if(t.hasVertical()||t.hasCustom()){r.register({type:"keydown",which:u.e.up,hasItem:!1},{type:"keydown",which:u.e.down,hasItem:!1},function(e,n){var r=t.firstItem();t.selectItem(r);t.anchor(r)});r.register({type:"keydown",which:u.e.up,hasItem:!0},function(r,i){var s=t.aboveItem(i);if(e._isItemReadyToBeSelected(s,n)){t.selectItem(s);t.anchor(s)}});r.register({type:"keydown",which:u.e.down,hasItem:!0},function(r,i){var s=t.belowItem(i);if(e._isItemReadyToBeSelected(s,n)){t.selectItem(s);t.anchor(s)}})}if(t.hasHorizontal()||t.hasCustom()){r.register({type:"keydown",which:u.e.left,hasItem:!1},{type:"keydown",which:u.e.right,hasItem:!1},function(e,n){var r=t.firstItem();t.selectItem(r);t.anchor(r)});r.register({type:"keydown",which:u.e.left,hasItem:!0},{type:"keydown",which:u.e.tab,shiftKey:!0,hasItem:!0},function(r,i){var s=t.leftItem(i);if(i===t.firstItem())return!1;if(e._isItemReadyToBeSelected(s,n)){t.selectItem(s);t.anchor(s)}});r.register({type:"keydown",which:u.e.right,hasItem:!0},{type:"keydown",which:u.e.tab,hasItem:!0},function(r,i){var s=t.rightItem(i);if(i===t.lastItem())return!1;if(e._isItemReadyToBeSelected(s,n)){t.selectItem(s);t.anchor(s)}})}return r};e._getMultiMatchers=function(t,n){var r=new s;r.register({type:"click",which:1,ctrlKey:!0,shiftKey:!0,hasItem:!0},{type:"click",which:1,metaKey:!0,shiftKey:!0,hasItem:!0},function(e,n){t.appendSelectionFromAnchor(n)});r.register({type:"click",which:1,ctrlKey:!0,hasItem:!0},{type:"click",which:1,metaKey:!0,hasItem:!0},function(e,n){t.toggleSelection(n);t.anchor(n)});r.register({type:"click",which:1,shiftKey:!0,hasItem:!0},function(e,n){t.appendSelectionFromAnchor(n)});r.register({type:"click",which:1,hasItem:!1},function(e,n){t.removeSelection()});r.register({type:"click",which:1,hasItem:!0,isClickOnToggleElement:!1},function(e,n){t.selectItem(n);t.anchor(n)});r.register({type:"click",which:1,hasItem:!0,isClickOnToggleElement:!0},function(e,n){t.toggleSelection(n);t.anchor(n)});r.register({type:"keydown",which:u.e.space,hasItem:!0},function(e,n){t.toggleSelection(n);t.anchor(n)});r.register({type:"keydown",which:u.e.end,ctrlKey:!0,shiftKey:!0},{type:"keydown",which:u.e.end,metaKey:!0,shiftKey:!0},function(e,n){t.appendSelectionFromAnchor(t.lastItem())});r.register({type:"keydown",which:u.e.end,ctrlKey:!0},{type:"keydown",which:u.e.end,metaKey:!0},function(e,n){var r=t.lastItem();t.focused(r);t.anchor(r)});r.register({type:"keydown",which:u.e.end,shiftKey:!0},function(e,n){t.replaceSelectionWithRangeFromAnchor(t.lastItem())});r.register({type:"keydown",which:u.e.end},function(e,n){var r=t.lastItem();t.selectItem(r);t.anchor(r)});r.register({type:"keydown",which:u.e.home,ctrlKey:!0,shiftKey:!0},{type:"keydown",which:u.e.home,metaKey:!0,shiftKey:!0},function(e,n){t.appendSelectionFromAnchor(t.firstItem())});r.register({type:"keydown",which:u.e.home,ctrlKey:!0},{type:"keydown",which:u.e.home,metaKey:!0},function(e,n){var r=t.firstItem();t.focused(r);t.anchor(r)});r.register({type:"keydown",which:u.e.home,shiftKey:!0},function(e,n){t.replaceSelectionWithRangeFromAnchor(t.firstItem())});r.register({type:"keydown",which:u.e.home},function(e,n){var r=t.firstItem();t.selectItem(r);t.anchor(r)});if(t.hasVertical()||t.hasCustom()){r.register({type:"keydown",which:u.e.up,ctrlKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:u.e.up,metaKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:u.e.down,ctrlKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:u.e.down,metaKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},function(e,n){var r=t.firstItem();t.selectItem(r);t.anchor(r)});r.register({type:"keydown",which:u.e.up,ctrlKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:u.e.up,metaKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},function(e,n){t.appendSelectionFromAnchor(t.aboveItem(n))});r.register({type:"keydown",which:u.e.up,ctrlKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:u.e.up,metaKey:!0,altKey:!1,hasItem:!0},function(r,i){var s=t.aboveItem(i);if(e._isItemReadyToBeSelected(s,n)){t.focused(s);t.anchor(s)}});r.register({type:"keydown",which:u.e.up,shiftKey:!0,altKey:!1,hasItem:!0},function(e,n){t.replaceSelectionWithRangeFromAnchor(t.aboveItem(n))});r.register({type:"keydown",which:u.e.up,altKey:!1,hasItem:!0},function(r,i){var s=t.aboveItem(i);if(e._isItemReadyToBeSelected(s,n)){t.selectItem(s);t.anchor(s)}});r.register({type:"keydown",which:u.e.down,ctrlKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:u.e.down,metaKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},function(r,i){var s=t.belowItem(i);e._isItemReadyToBeSelected(s,n)&&t.appendSelectionFromAnchor(s)});r.register({type:"keydown",which:u.e.down,ctrlKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:u.e.down,metaKey:!0,altKey:!1,hasItem:!0},function(r,i){var s=t.belowItem(i);if(e._isItemReadyToBeSelected(s,n)){t.focused(s);t.anchor(s)}});r.register({type:"keydown",which:u.e.down,shiftKey:!0,altKey:!1,hasItem:!0},function(r,i){var s=t.belowItem(i);e._isItemReadyToBeSelected(s,n)&&t.replaceSelectionWithRangeFromAnchor(s)});r.register({type:"keydown",which:u.e.down,altKey:!1,hasItem:!0},function(r,i){var s=t.belowItem(i);if(e._isItemReadyToBeSelected(s,n)){t.selectItem(s);t.anchor(s)}})}if(t.hasHorizontal()||t.hasCustom()){r.register({type:"keydown",which:u.e.left,ctrlKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:u.e.left,metaKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:u.e.right,ctrlKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},{type:"keydown",which:u.e.right,metaKey:!1,shiftKey:!1,altKey:!1,hasItem:!1},function(e,n){var r=t.firstItem();t.selectItem(r);t.anchor(r)});r.register({type:"keydown",which:u.e.left,ctrlKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:u.e.left,metaKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},function(r,i){var s=t.leftItem(i);e._isItemReadyToBeSelected(s,n)&&t.appendSelectionFromAnchor(s)});r.register({type:"keydown",which:u.e.left,ctrlKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:u.e.left,metaKey:!0,altKey:!1,hasItem:!0},function(r,i){var s=t.leftItem(i);if(e._isItemReadyToBeSelected(s,n)){t.focused(s);t.anchor(s)}});r.register({type:"keydown",which:u.e.left,shiftKey:!0,altKey:!1,hasItem:!0},function(r,i){var s=t.leftItem(i);e._isItemReadyToBeSelected(s,n)&&t.replaceSelectionWithRangeFromAnchor(s)});r.register({type:"keydown",which:u.e.left,altKey:!1,hasItem:!0},function(r,i){var s=t.leftItem(i);if(e._isItemReadyToBeSelected(s,n)){t.selectItem(s);t.anchor(s)}});r.register({type:"keydown",which:u.e.right,ctrlKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:u.e.right,metaKey:!0,shiftKey:!0,altKey:!1,hasItem:!0},function(r,i){var s=t.rightItem(i);e._isItemReadyToBeSelected(s,n)&&t.appendSelectionFromAnchor(s)});r.register({type:"keydown",which:u.e.right,ctrlKey:!0,altKey:!1,hasItem:!0},{type:"keydown",which:u.e.right,metaKey:!0,altKey:!1,hasItem:!0},function(r,i){var s=t.rightItem(i);if(e._isItemReadyToBeSelected(s,n)){t.focused(s);t.anchor(s)}});r.register({type:"keydown",which:u.e.right,shiftKey:!0,altKey:!1,hasItem:!0},function(r,i){var s=t.rightItem(i);e._isItemReadyToBeSelected(s,n)&&t.replaceSelectionWithRangeFromAnchor(s)});r.register({type:"keydown",which:u.e.right,altKey:!1,hasItem:!0},function(r,i){var s=t.rightItem(i);if(e._isItemReadyToBeSelected(s,n)){t.selectItem(s);t.anchor(s)}})}r.register({type:"keydown",which:u.e.a,ctrlKey:!0},{type:"keydown",which:u.e.a,metaKey:!0},function(e,n){t.selectAll()});return r};e.modes={single:e._getSingleMatchers,multi:e._getMultiMatchers};return e})();t.e=a},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return s});n.d(t,"n",function(){return o});var r,i=n(1002);(function(e){e.Small="S";e.Medium="M";e.Large="L"})(r||(r={}));function s(e){var t;switch(e.size){case r.Large:t=3;break;case r.Medium:t=2;break;default:t=1}return Object(i.getUserPhotoUrl)(e.userLoginName,t)}function o(e,t){var n=Object(i.getUserPhotoUrl)(t);if(!e||!n||n.startsWith("http"))return n;try{return new URL(e).origin+n}catch(e){return n}}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.valid=0]="valid";e[e.warning=1]="warning";e[e.invalid=2]="invalid"})(r||(r={}))},function(e,t,n){"use strict";var r=n(0),i=n(1649),s=n("knockout-lib"),o=n(269),u=(function(e){Object(r.__extends)(t,e);function t(){var t=e.call(this)||this;t._focusedIndex=-1;t._subscriptions=[];t._selectItemKeyToModel={};t.keyToIndexHash={};t.indexToKeyHash={};t.unresolvedSelectedIndices={};t._focusedIndex=-1;t._subscriptions=[];t._selectItemKeyToModel={};t.itemSet=s.observable(null);t.layout=s.observable();t.selection=s.observableArray().extend({rateLimit:{timeout:200,method:"notifyWhenChangesStop"}});t.selectionKeyHash=s.observable({});t.focused=s.observable().extend({rateLimit:{timeout:50,method:"notifyWhenChangesStop"}});t.items=s.observableArray();t.focusedKeyHash=s.observable({});t.isAllSelected=s.observable(!1);t.isActive=s.observable(!1);t.clearSelectionOnRemoval=!1;t.selectFirstItemOnActivate=!0;return t}t._set=function(e,t,n,r){(e=s.utils.unwrapObservable(e))&&e.hasOwnProperty(t)&&s.isObservable(e[t])&&e[t](n);if(e&&e.key){r()[e.key]=n;r.valueHasMutated()}};t._setAll=function(e,n,r,i){for(var s=0;s<e.length;s++)t._set(e[s],n,r,i)};t._hasCssClass=function(e,t){return!!(e&&e.className&&-1!==e.className.indexOf(t)&&e.className.match("\\b"+t+"\\b"))};t._getParentElement=function(e){return e&&Object(o.e)(e)||null};t._insideElementWithClass=function(e,n,r){r=r||null;for(var i=e;i;){if(t._hasCssClass(i,n))return!0;if(i===r)return!1;i=t._getParentElement(i)}return!1};t.prototype.init=function(e){var n=this;if(!this.items)throw new Error("The selection binding can only be used together with `foreach`, `foreach: { data: ... }`, `template: { foreach: ... }` or like `selection: { data: ... }`.");if(!s.isObservable(this.selection))throw new Error("The selection binding should be bound to either an `observableArray` or a object containing a `selection` `observableArray`.");this.properties=e.properties;this._buildKeyIndexHash();this.async.setTimeout(function(){n.cleanup();n._updateFocused(e.properties.focused,!0)},0);this._subscriptions=[];this._subscriptions.push(this.focused.subscribe(function(e){var t;(t=(e=s.utils.unwrapObservable(e))?e.key:null)&&n._updateIsFocusedObservable(t,!1)},this,"beforeChange"));this._subscriptions.push(this.focused.subscribe(function(e){n._focusedIndex=e?n._findItemIndex(n.focused()):-1;n._focusedIndex>-1&&n._updateIsFocusedObservable(n.indexToKeyHash[n._focusedIndex],!0)}));this._subscriptions.push(this.selection.subscribe(function(r){t._setAll(n.selection(),e.properties.selected,!1,n.selectionKeyHash)},this,"beforeChange"));this._subscriptions.push(this.selection.subscribe(function(r){"single"===n.mode()&&r.length>1?n.selection([r.slice(-1)[0]]):t._setAll(r,e.properties.selected,!0,n.selectionKeyHash);var i=n.items().length,s=n.selection().length;n.isAllSelected(i>0&&i===s)}));this._subscriptions.push(this.items.subscribe(function(e){n._buildKeyIndexHash();n.cleanup()}));t._setAll(this.selection.peek(),e.properties.selected,!0,this.selectionKeyHash);this._subscriptions.push(this.focused.subscribe(function(r){t._set(r,e.properties.focused,!1,n.focusedKeyHash)},this,"beforeChange"));this._subscriptions.push(this.focused.subscribe(function(r){t._set(r,e.properties.focused,!0,n.focusedKeyHash)}));this.focused()&&t._set(this.focused(),e.properties.focused,!0,this.focusedKeyHash)};t.prototype.cleanup=function(){var e=this;if(!this.itemSet.peek()||!this.itemSet.peek().isPlaceholder){var t=[];if(this.focused.peek()){var n=this._findItemIndex(this.focused.peek());-1===n?this.focused(null):this._focusedIndex=n}this.anchor.peek()&&-1===this._findItemIndex(this.anchor.peek())&&this.anchor(null);if(this.isAllSelected())this.selectAll();else{s.utils.arrayForEach(this.selection.peek(),function(n){-1!==e._findItemIndex(n)&&t.push(n)});t.length!==this.selection.peek().length&&this.selection(t)}}};t.prototype.clear=function(){this.focused&&this.focused(null);this.anchor&&this.anchor(null);this._focusedIndex=-1;this.removeSelection()};t.prototype.hasHorizontal=function(){return"horizontal"===this.direction.peek()};t.prototype.hasVertical=function(){return"vertical"===this.direction.peek()};t.prototype.hasCustom=function(){return"custom"===this.direction.peek()};t.prototype.toggleAllSelected=function(){if(this.selection.peek().length===this.items.peek().length){this.selection([]);this._updateAllSelectItemViewModels(!1)}else this.selectAll()};t.prototype.selectAll=function(){var e=this.items.peek().slice();this.unresolvedSelectedIndices={};for(var t=0;t<e.length;t++)e[t]||(this.unresolvedSelectedIndices[t]=!0);this.selection(this.items().slice());this._updateAllSelectItemViewModels(!0)};t.prototype.selectItem=function(e){var t=[],n=s.utils.unwrapObservable(e);this._updateSelectItemViewModelInSelection(!1);if(e){t.push(e);this._updateIsSelectedObservable(n.key,!0)}this.selection(t);this.focused(e)};t.prototype.firstItem=function(){return this.items()[0]};t.prototype.lastItem=function(){return this.items()[this.items().length-1]};t.prototype.nextItem=function(e){var t=this._findItemIndex(e);return this.items()[Math.min(t+1,this.items().length-1)]};t.prototype.previousItem=function(e){var t=this._findItemIndex(e);return this.items()[Math.max(t-1,0)]};t.prototype.leftItem=function(e){var t=this._findItemIndex(e),n=this.layout();return n?this.items()[n.getItemIndexLeft(t)]:this.hasHorizontal()?this.previousItem(e):null};t.prototype.aboveItem=function(e){var t=this._findItemIndex(e),n=this.layout();return n?this.items()[n.getItemIndexAbove(t)]:this.hasVertical()?this.previousItem(e):null};t.prototype.rightItem=function(e){var t=this._findItemIndex(e),n=this.layout();return n?this.items()[n.getItemIndexRight(t)]:this.hasHorizontal()?this.nextItem(e):null};t.prototype.belowItem=function(e){var t=this._findItemIndex(e),n=this.layout();return n?this.items()[n.getItemIndexBelow(t)]:this.hasVertical()?this.nextItem(e):null};t.prototype.isAlreadySelected=function(e){var t=s.utils.unwrapObservable(e);return t.hasOwnProperty("key")?!0===this.selectionKeyHash()[t.key]:-1!==s.utils.arrayIndexOf(this.selection(),e)};t.prototype.toggleSelection=function(e,t){var n=s.utils.unwrapObservable(e);if(this.isAlreadySelected(e)){if(!t){this.selection.remove(e);this._updateIsSelectedObservable(n.key,!1)}}else if(!1!==t){this.selection.push(e);this._updateIsSelectedObservable(n.key,!0)}this.focused(e)};t.prototype.removeSelection=function(){this.unresolvedSelectedIndices={};this.selection([]);this._updateAllSelectItemViewModels(!1)};t.prototype.appendSelectionWithCurrentItem=function(e){if(e){this.anchor(e);if(!this.isAlreadySelected(e)){var t=s.utils.unwrapObservable(e);this.selection.push(e);this._updateIsSelectedObservable(t.key,!0)}this.focused(e)}};t.prototype.appendSelectionFromAnchor=function(e){if(e){var t=this.anchor.peek();t?this.selection.remove(t):this.anchor(e);this.selection.push.apply(this.selection,this._createRange(this.items,this.anchor(),e,!0));this._updateSelectItemViewModelInSelection(!0);this.focused(e)}};t.prototype.replaceSelectionWithRangeFromAnchor=function(e){if(e){this.anchor.peek()||this.anchor(e);this._updateSelectItemViewModelInSelection(!1);this.selection(this._createRange(this.items,this.anchor.peek(),e));this._updateSelectItemViewModelInSelection(!0);this.focused(e)}};t.prototype.findItemData=function(e){var t=s.contextFor(e);if(!t||!t.$data)return null;for(var n=this._getItemFromContext(t)||t.$data;t;){if(n&&this._findItemIndex(n)>=0)return n;t=t.$parentContext;n=this._getItemFromContext(t)}return null};t.prototype.isClickOnToggleElement=function(e,n){var r=this.toggleClass;return!!r&&t._insideElementWithClass(n,r,e)};t.prototype.activate=function(){s.utils.toggleDomNodeCssClass(this.rootElement.peek(),this.properties.activeClass,!0);this.isActive(!0)};t.prototype.deactivate=function(){s.utils.toggleDomNodeCssClass(this.rootElement.peek(),this.properties.activeClass,!1);this.isActive(!1)};t.prototype.subscribeSelectItemViewModel=function(e,t){this._selectItemKeyToModel[e]?this._selectItemKeyToModel[e].push(t):this._selectItemKeyToModel[e]=[t]};t.prototype.disposeSelectItemViewModel=function(e,t){var n=this._selectItemKeyToModel[e],r=-1;if(n){(r=n.indexOf(t))>-1&&n.splice(r,1);0===n.length&&delete this._selectItemKeyToModel[e]}};t.prototype.getFocusedItemKey=function(){var e=null;this._focusedIndex>-1&&(e=this.indexToKeyHash[this._focusedIndex]);return e};t.prototype.ensureFocusedItemViewModel=function(){var e=this.getFocusedItemKey();this._updateIsFocusedObservable(e,!0)};t.prototype.setFocusItemByKey=function(e){var t=this.keyToIndexHash[e];void 0!==t&&this.focused(this.items.peek()[t])};t.prototype.getViewModelsForKey=function(e){return this._selectItemKeyToModel[e]};t.prototype._findItemIndex=function(e){var t=-1,n=s.utils.unwrapObservable(e);if(n)if(n.hasOwnProperty("key")){var r=this.keyToIndexHash[n.key];void 0!==r&&(t=r)}else t=s.utils.arrayIndexOf(this.items.peek(),e);return t};t.prototype._getKeyForItem=function(e){var t,n=s.utils.unwrapObservable(e);n&&n.hasOwnProperty("key")&&(t=n.key);return t};t.prototype._createRange=function(e,t,n,r){var i=this.selectionKeyHash(),s=e(),o=this._findItemIndex(t),u=this._findItemIndex(n),a=[];if(o>u){var f=o;o=u;u=f}for(var l=o;l<=u;l+=1){var c=this._getKeyForItem(s[l]);c?r&&i[c]||a.push(s[l]):this.unresolvedSelectedIndices[l]=!0}return a};t.prototype._updateFocused=function(e,t){for(var n=this.items.peek(),r=0;r<n.length;r++){var i=n[r];if(i&&i.hasOwnProperty(e)&&s.isObservable(i[e])&&i[e]()===t){this.focused(i);break}}};t.prototype._updateIsSelectedObservable=function(e,t){var n;e&&(n=this._selectItemKeyToModel[e])&&n.forEach(function(e){e.isSelected(t)})};t.prototype._updateIsFocusedObservable=function(e,t){var n;e&&(n=this._selectItemKeyToModel[e])&&n.forEach(function(e){e.isFocused(t)})};t.prototype._updateAllSelectItemViewModels=function(e){for(var t in this._selectItemKeyToModel)this._selectItemKeyToModel[t].forEach(function(t){t.isSelected(e)})};t.prototype._updateSelectItemViewModelInSelection=function(e){for(var t,n,r=this.selection.peek(),i=0;i<r.length;i++)if(t=s.utils.unwrapObservable(r[i])){n=t.key;this._updateIsSelectedObservable(n,e)}};t.prototype._buildKeyIndexHash=function(){var e,t,n=this.items.peek();this.keyToIndexHash={};this.indexToKeyHash={};for(var r=0;r<n.length;r++)if((t=s.utils.unwrapObservable(n[r]))&&t.hasOwnProperty("key")){e=t.key;this.keyToIndexHash[e]=r;this.indexToKeyHash[r]=e}this._checkUnresolvedIndicies()};t.prototype._checkUnresolvedIndicies=function(){var e,t=this.items.peek();for(var n in this.unresolvedSelectedIndices)if(t[Number(n)]){delete this.unresolvedSelectedIndices[n];(e=e||{})[n]=!0}if(e){for(var r=[],i=this.selectionKeyHash.peek(),s=0;s<t.length;s++){var o=t[s];(i[this._getKeyForItem(o)]||e[s]||this.unresolvedSelectedIndices[s])&&r.push(o)}this.selection(r)}};t.prototype._getItemFromContext=function(e){return e&&e.$data?"function"==typeof e.$data.getItem?e.$data.getItem():e.$data.isSelectable?e.$data:null:null};return t})(i.n);t.e=u},,,function(e,t,n){"use strict";var r;(function(e){e[e.normal=0]="normal";e[e.blocker=1]="blocker";e[e.vaultBlocker=2]="vaultBlocker"})(r||(r={}));t.e=r},,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(282),i=Object(r.e)({eventName:"SuiteNavError,",shortEventName:"SuiteNavError",requiresParent:!1},{message:1,stack:1,type:1})},function(e,t,n){"use strict";var r=n(138);Object(r.n)([{rawString:".od-PanelHost{display:none}.SPPageChrome .od-Panel{top:0}.od-Panel{outline:1px solid transparent;position:absolute;top:48px;bottom:0;width:100%;max-width:100%;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-sizing:border-box;transition:width .3s ease-out;box-shadow:-30px 0 30px -30px "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:"}[dir=ltr] .od-Panel{right:0}[dir=rtl] .od-Panel{left:0}.od-Panel.od-Panel--reactSuiteNav{top:48px}.isFluent .od-Panel{box-shadow:0 25.6px 57.6px 0 rgba(0,0,0,.22),0 4.8px 14.4px 0 rgba(0,0,0,.18)}html[dir=rtl] .od-Panel{box-shadow:30px 0 30px -30px "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:"}.od-BasePage--noSuiteNav .od-Panel{top:0}.od-Panel.od-Panel--sm{width:100%}.lg .od-Panel.od-Panel--sm,.md .od-Panel.od-Panel--sm,.xlg .od-Panel.od-Panel--sm,.xxlg .od-Panel.od-Panel--sm,.xxxlg .od-Panel.od-Panel--sm,.xxxxlg .od-Panel.od-Panel--sm{width:340px}.lg .od-Panel.od-Panel--lg,.lg .od-Panel.od-Panel--xlg,.xlg .od-Panel.od-Panel--lg,.xlg .od-Panel.od-Panel--xlg,.xxlg .od-Panel.od-Panel--lg,.xxlg .od-Panel.od-Panel--xlg,.xxxlg .od-Panel.od-Panel--lg,.xxxlg .od-Panel.od-Panel--xlg,.xxxxlg .od-Panel.od-Panel--lg,.xxxxlg .od-Panel.od-Panel--xlg{width:auto}[dir=ltr] .lg .od-Panel.od-Panel--lg,[dir=ltr] .lg .od-Panel.od-Panel--xlg,[dir=ltr] .xlg .od-Panel.od-Panel--lg,[dir=ltr] .xlg .od-Panel.od-Panel--xlg,[dir=ltr] .xxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxlg .od-Panel.od-Panel--xlg,[dir=ltr] .xxxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxxlg .od-Panel.od-Panel--xlg,[dir=ltr] .xxxxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxxxlg .od-Panel.od-Panel--xlg{left:48px}[dir=rtl] .lg .od-Panel.od-Panel--lg,[dir=rtl] .lg .od-Panel.od-Panel--xlg,[dir=rtl] .xlg .od-Panel.od-Panel--lg,[dir=rtl] .xlg .od-Panel.od-Panel--xlg,[dir=rtl] .xxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxlg .od-Panel.od-Panel--xlg,[dir=rtl] .xxxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxxlg .od-Panel.od-Panel--xlg,[dir=rtl] .xxxxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxxxlg .od-Panel.od-Panel--xlg{right:48px}.lg .od-Panel.od-Panel--md,.xlg .od-Panel.od-Panel--md,.xxlg .od-Panel.od-Panel--md,.xxxlg .od-Panel.od-Panel--md,.xxxxlg .od-Panel.od-Panel--md{width:643px}[dir=ltr] .lg .od-Panel.od-Panel--md,[dir=ltr] .xlg .od-Panel.od-Panel--md,[dir=ltr] .xxlg .od-Panel.od-Panel--md,[dir=ltr] .xxxlg .od-Panel.od-Panel--md,[dir=ltr] .xxxxlg .od-Panel.od-Panel--md{left:auto}[dir=rtl] .lg .od-Panel.od-Panel--md,[dir=rtl] .xlg .od-Panel.od-Panel--md,[dir=rtl] .xxlg .od-Panel.od-Panel--md,[dir=rtl] .xxxlg .od-Panel.od-Panel--md,[dir=rtl] .xxxxlg .od-Panel.od-Panel--md{right:auto}.lg .od-Panel.od-panel-md-listform,.xlg .od-Panel.od-panel-md-listform,.xxlg .od-Panel.od-panel-md-listform,.xxxlg .od-Panel.od-panel-md-listform,.xxxxlg .od-Panel.od-panel-md-listform{width:800px}[dir=ltr] .lg .od-Panel.od-panel-md-listform,[dir=ltr] .xlg .od-Panel.od-panel-md-listform,[dir=ltr] .xxlg .od-Panel.od-panel-md-listform,[dir=ltr] .xxxlg .od-Panel.od-panel-md-listform,[dir=ltr] .xxxxlg .od-Panel.od-panel-md-listform{left:auto}[dir=rtl] .lg .od-Panel.od-panel-md-listform,[dir=rtl] .xlg .od-Panel.od-panel-md-listform,[dir=rtl] .xxlg .od-Panel.od-panel-md-listform,[dir=rtl] .xxxlg .od-Panel.od-panel-md-listform,[dir=rtl] .xxxxlg .od-Panel.od-panel-md-listform{right:auto}[dir=ltr] .xxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxxxlg .od-Panel.od-Panel--lg{left:428px}[dir=rtl] .xxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxxxlg .od-Panel.od-Panel--lg{right:428px}[dir=ltr] .xxxlg .od-Panel.od-Panel--lg,[dir=ltr] .xxxxlg .od-Panel.od-Panel--lg{left:980px}[dir=rtl] .xxxlg .od-Panel.od-Panel--lg,[dir=rtl] .xxxxlg .od-Panel.od-Panel--lg{right:980px}[dir=ltr] .xxxxlg .od-Panel.od-Panel--lg{left:1620px}[dir=rtl] .xxxxlg .od-Panel.od-Panel--lg{right:1620px}[dir=ltr] .xxlg .od-Panel.od-Panel--xlg,[dir=ltr] .xxxlg .od-Panel.od-Panel--xlg,[dir=ltr] .xxxxlg .od-Panel.od-Panel--xlg{left:176px}[dir=rtl] .xxlg .od-Panel.od-Panel--xlg,[dir=rtl] .xxxlg .od-Panel.od-Panel--xlg,[dir=rtl] .xxxxlg .od-Panel.od-Panel--xlg{right:176px}.lg .od-Panel.od-Panel--fullScreen,.md .od-Panel.od-Panel--fullScreen,.xlg .od-Panel.od-Panel--fullScreen,.xxlg .od-Panel.od-Panel--fullScreen,.xxxlg .od-Panel.od-Panel--fullScreen,.xxxxlg .od-Panel.od-Panel--fullScreen{width:100%}.sm .od-Panel.od-Panel--lightDismiss{width:272px}.od-Panel--FullPagePanel{top:0;width:100%;height:100%}.od-Panel--hasPadding{padding:40px 16px 20px}.isFluent .od-Panel--hasPadding{padding:74px 16px 20px}.lg .od-Panel--hasPadding,.xlg .od-Panel--hasPadding,.xxlg .od-Panel--hasPadding,.xxxlg .od-Panel--hasPadding,.xxxxlg .od-Panel--hasPadding{padding:40px 32px 20px}.isFluent.lg .od-Panel--hasPadding{padding:74px 24px 20px}.isFluent.xlg .od-Panel--hasPadding{padding:74px 24px 20px}.isFluent.xxlg .od-Panel--hasPadding{padding:74px 24px 20px}.isFluent.xxxlg .od-Panel--hasPadding{padding:74px 24px 20px}.isFluent.xxxxlg .od-Panel--hasPadding{padding:74px 24px 20px}.xlg .od-Panel--hasPadding,.xxlg .od-Panel--hasPadding,.xxxlg .od-Panel--hasPadding,.xxxxlg .od-Panel--hasPadding{padding-top:70px}.isFluent.xlg .od-Panel--hasPadding{padding-top:74px}.isFluent.xxlg .od-Panel--hasPadding{padding-top:74px}.isFluent.xxxlg .od-Panel--hasPadding{padding-top:74px}.isFluent.xxxxlg .od-Panel--hasPadding{padding-top:74px}.xxlg .od-Panel--hasPadding,.xxxlg .od-Panel--hasPadding,.xxxxlg .od-Panel--hasPadding{padding:70px 40px 20px}.isFluent.xxlg .od-Panel--hasPadding{padding:74px 24px 20px}.isFluent.xxxlg .od-Panel--hasPadding{padding:74px 24px 20px}.isFluent.xxxxlg .od-Panel--hasPadding{padding:74px 24px 20px}.od-Panel--autoScroll{overflow:auto}.od-Panel--hiddenScroll{overflow:hidden}.od-Panel--alwaysScroll{overflow-y:scroll}.od-Panel-title{margin-bottom:8px}.isFluent .od-Panel-title{margin-bottom:19px;font-size:20px;max-width:240px}html[dir=ltr] .isFluent .od-Panel-title{margin-right:26px}html[dir=rtl] .isFluent .od-Panel-title{margin-left:26px}.lg .od-Panel-title,.md .od-Panel-title,.sm .od-Panel-title{line-height:48px}.isFluent.sm .od-Panel-title{line-height:normal}.isFluent.md .od-Panel-title{line-height:normal}.isFluent.lg .od-Panel-title{line-height:normal}.od-Panel--hidden{visibility:hidden}.od-Panel-content--titleFill{width:100%;height:calc(100% - 48px - 8px)}.od-Panel-content--noTitleFill{width:100%;height:100%}.od-Panel-button--close{position:absolute;outline:0;margin:0;border:0;background:0 0;cursor:pointer;top:0;padding-top:12px}[dir=ltr] .od-Panel-button--close{right:0}[dir=rtl] .od-Panel-button--close{left:0}[dir=ltr] .od-Panel-button--close{padding-right:16px}[dir=rtl] .od-Panel-button--close{padding-left:16px}.isFluent .od-Panel-button--close{height:32px;width:32px;line-height:32px;padding:0;top:16px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";border-radius:2px}[dir=ltr] .isFluent .od-Panel-button--close{right:16px}[dir=rtl] .isFluent .od-Panel-button--close{left:16px}.isFluent .od-Panel-button--close:hover{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.isFluent .od-Panel-button--close:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-Panel-button--close .ms-Icon--Cancel{margin-top:1px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:16px}.isFluent .od-Panel-button--close .ms-Icon--Cancel{margin-top:0;color:inherit}.md .od-Panel-button--close .ms-Icon--Cancel,.sm .od-Panel-button--close .ms-Icon--Cancel{font-size:20px}.isFluent.sm .od-Panel-button--close .ms-Icon--Cancel{font-size:16px}.isFluent.md .od-Panel-button--close .ms-Icon--Cancel{font-size:16px}.od-Panel--hasCommandBar .od-Panel-button--close{z-index:600;padding:11px 16px}.isFluent .od-Panel--hasCommandBar .od-Panel-button--close{padding:0;top:6px}[dir=ltr] .isFluent .od-Panel--hasCommandBar .od-Panel-button--close{right:8px}[dir=rtl] .isFluent .od-Panel--hasCommandBar .od-Panel-button--close{left:8px}[dir=ltr] .od-Panel--stickyCloseButton .od-Panel-button--close{right:20px}[dir=rtl] .od-Panel--stickyCloseButton .od-Panel-button--close{left:20px}[dir=ltr] .md .od-Panel-button--close,[dir=ltr] .sm .od-Panel-button--close{right:4px}[dir=rtl] .md .od-Panel-button--close,[dir=rtl] .sm .od-Panel-button--close{left:4px}[dir=ltr] .isFluent.sm .od-Panel-button--close{right:20px}[dir=rtl] .isFluent.sm .od-Panel-button--close{left:20px}[dir=ltr] .isFluent.md .od-Panel-button--close{right:20px}[dir=rtl] .isFluent.md .od-Panel-button--close{left:20px}[dir=ltr] .isFluent.sm .od-Panel-button--close{right:12px}[dir=rtl] .isFluent.sm .od-Panel-button--close{left:12px}.od-Panel-button--close:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Panel--stickyCloseButton .od-Panel-content{position:absolute;top:0;bottom:0;left:0;right:0;overflow:auto}[dir=ltr] .od-Panel--stickyCloseButton .od-Panel-content{padding-right:40px}[dir=rtl] .od-Panel--stickyCloseButton .od-Panel-content{padding-left:40px}.od-OverlayHost-overlay .od-Panel{opacity:0}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-Panel{opacity:1}[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-Panel{animation-name:ms-fadeIn,ms-slideLeftIn40;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-Panel{animation:none}}[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-Panel{animation-name:ms-fadeIn,ms-slideRightIn40;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-Panel{animation:none}}[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Panel{animation-name:ms-fadeOut,ms-slideRightOut40;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=ltr] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Panel{animation:none}}[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Panel{animation-name:ms-fadeOut,ms-slideLeftOut40;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){[dir=rtl] .od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Panel{animation:none}}.od-PanelOverlay.ms-ModalOverlay{top:48px}.od-BasePage--noSuiteNav .od-PanelOverlay.ms-ModalOverlay{top:0}.SPPageChrome .od-PanelOverlay.ms-ModalOverlay{top:0}[dir=ltr] .od--hasFlexPane .od-Panel{right:320px}[dir=rtl] .od--hasFlexPane .od-Panel{left:320px}"}])},function(e,t,n){"use strict";var r=n(0),i=n(1650),s=n("knockout-lib"),o=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.controlsDescendantBindings=!0;n.createComputed(n._computeRefreshChildElements);return n}t.prototype._computeRefreshChildElements=function(){var e=s.unwrap(this.valueAccessor());s.virtualElements.emptyNode(this.element);this.element.innerHTML=e;s.applyBindingsToDescendants(this.bindingContext,this.element)};return t})(i.t);t.e=o},function(e,t,n){"use strict";n.d(t,"e",function(){return F});var r={};n.r(r);n.d(r,"root",function(){return g});n.d(r,"suggestionsItem",function(){return y});n.d(r,"closeButton",function(){return b});n.d(r,"suggestionsItemIsSuggested",function(){return w});n.d(r,"itemButton",function(){return E});n.d(r,"actionButton",function(){return S});n.d(r,"buttonSelected",function(){return x});n.d(r,"suggestionsTitle",function(){return T});n.d(r,"suggestionsContainer",function(){return N});n.d(r,"suggestionsNone",function(){return C});n.d(r,"suggestionsSpinner",function(){return k});n.d(r,"suggestionsAvailable",function(){return L});var i,s=n(4),o=n("react-lib"),u=n(472),a=n(1419),f=n(129),l=n(886),c=n(37),h=n(1948),p=n(1637),d=n(2102);(function(e){e[e.none=0]="none";e[e.forceResolve=1]="forceResolve";e[e.searchMore=2]="searchMore"})(i||(i={}));var v=n(1508),m=n(138);Object(m.n)([{rawString:".root_c995a031{min-width:260px}.suggestionsItem_c995a031{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;position:relative;overflow:hidden}.suggestionsItem_c995a031:hover{background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.suggestionsItem_c995a031:hover .closeButton_c995a031{display:block}.suggestionsItem_c995a031.suggestionsItemIsSuggested_c995a031{background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.suggestionsItem_c995a031.suggestionsItemIsSuggested_c995a031:hover{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}@media screen and (-ms-high-contrast:active){.suggestionsItem_c995a031.suggestionsItemIsSuggested_c995a031:hover{background:Highlight;color:HighlightText}}@media screen and (-ms-high-contrast:active){.suggestionsItem_c995a031.suggestionsItemIsSuggested_c995a031{background:Highlight;color:HighlightText;-ms-high-contrast-adjust:none}}.suggestionsItem_c995a031.suggestionsItemIsSuggested_c995a031 .closeButton_c995a031:hover{background:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}@media screen and (-ms-high-contrast:active){.suggestionsItem_c995a031.suggestionsItemIsSuggested_c995a031 .itemButton_c995a031{color:HighlightText}}.suggestionsItem_c995a031 .closeButton_c995a031{display:none;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.suggestionsItem_c995a031 .closeButton_c995a031:hover{background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.actionButton_c995a031{background-color:transparent;border:0;cursor:pointer;margin:0;position:relative;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";height:40px;width:100%;font-size:12px}[dir=ltr] .actionButton_c995a031{padding-left:8px}[dir=rtl] .actionButton_c995a031{padding-right:8px}html[dir=ltr] .actionButton_c995a031{text-align:left}html[dir=rtl] .actionButton_c995a031{text-align:right}.actionButton_c995a031:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";cursor:pointer}.actionButton_c995a031:active,.actionButton_c995a031:focus{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.actionButton_c995a031 .ms-Button-icon{font-size:16px;width:25px}.actionButton_c995a031 .ms-Button-label{margin:0 4px 0 9px}html[dir=rtl] .actionButton_c995a031 .ms-Button-label{margin:0 9px 0 4px}.buttonSelected_c995a031{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.suggestionsTitle_c995a031{padding:0 12px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:12px;line-height:40px;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.suggestionsContainer_c995a031{overflow-y:auto;overflow-x:hidden;max-height:300px;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.suggestionsNone_c995a031{text-align:center;color:#797775;font-size:12px;line-height:30px}.suggestionsSpinner_c995a031{margin:5px 0;white-space:nowrap;line-height:20px;font-size:12px}html[dir=ltr] .suggestionsSpinner_c995a031{padding-left:14px}html[dir=rtl] .suggestionsSpinner_c995a031{padding-right:14px}html[dir=ltr] .suggestionsSpinner_c995a031{text-align:left}html[dir=rtl] .suggestionsSpinner_c995a031{text-align:right}.suggestionsSpinner_c995a031 .ms-Spinner-circle{display:inline-block;vertical-align:middle}.suggestionsSpinner_c995a031 .ms-Spinner-label{display:inline-block;margin:0 10px 0 16px;vertical-align:middle}html[dir=rtl] .suggestionsSpinner_c995a031 .ms-Spinner-label{margin:0 16px 0 10px}.itemButton_c995a031.itemButton_c995a031{width:100%;padding:0;min-width:0;height:100%}@media screen and (-ms-high-contrast:active){.itemButton_c995a031.itemButton_c995a031{color:WindowText}}.itemButton_c995a031.itemButton_c995a031:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.closeButton_c995a031.closeButton_c995a031{padding:0 4px;height:auto;width:32px}@media screen and (-ms-high-contrast:active){.closeButton_c995a031.closeButton_c995a031{color:WindowText}}.closeButton_c995a031.closeButton_c995a031:hover{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.suggestionsAvailable_c995a031{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}]);var g="root_c995a031",y="suggestionsItem_c995a031",b="closeButton_c995a031",w="suggestionsItemIsSuggested_c995a031",E="itemButton_c995a031",S="actionButton_c995a031",x="buttonSelected_c995a031",T="suggestionsTitle_c995a031",N="suggestionsContainer_c995a031",C="suggestionsNone_c995a031",k="suggestionsSpinner_c995a031",L="suggestionsAvailable_c995a031",A=r,O=Object(u.e)(),M=(function(e){Object(s.r)(t,e);function t(t){var n=e.call(this,t)||this;Object(l.e)(n);return n}t.prototype.render=function(){var e,t=this.props,n=t.suggestionModel,r=t.RenderSuggestion,i=t.onClick,s=t.className,u=t.id,a=t.onRemoveItem,f=t.isSelectedOverride,l=t.removeButtonAriaLabel,p=t.styles,d=t.theme,m=p?O(p,{theme:d,className:s,suggested:n.selected||f}):{root:Object(c.e)("ms-Suggestions-item",A.suggestionsItem,(e={},e["is-suggested "+A.suggestionsItemIsSuggested]=n.selected||f,e),s),itemButton:Object(c.e)("ms-Suggestions-itemButton",A.itemButton),closeButton:Object(c.e)("ms-Suggestions-closeButton",A.closeButton)};return o.createElement("div",{className:m.root,role:"presentation"},o.createElement(h.e,{onClick:i,className:m.itemButton,id:u,"aria-selected":n.selected,role:"option","aria-label":n.ariaLabel},r(n.item,this.props)),this.props.showRemoveButton?o.createElement(v.e,{iconProps:{iconName:"Cancel",styles:{root:{fontSize:"12px"}}},title:l,ariaLabel:l,onClick:a,className:m.closeButton}):null)};return t})(o.Component),_=n(25),D=n(506),P={root:"ms-Suggestions-item",itemButton:"ms-Suggestions-itemButton",closeButton:"ms-Suggestions-closeButton",isSuggested:"is-suggested"};var H=r,B=Object(u.e)(),j=Object(a.e)(M,function(e){var t,n,r,i,o,u,a=e.className,f=e.theme,l=e.suggested,c=f.palette,h=f.semanticColors,p=Object(_.x)(P,f);return{root:[p.root,{display:"flex",alignItems:"stretch",boxSizing:"border-box",width:"100%",position:"relative",selectors:{"&:hover":{background:h.menuItemBackgroundHovered},"&:hover .ms-Suggestions-closeButton":{display:"block"}}},l&&{selectors:(t={},t["."+D.e+" &"]={selectors:(n={},n["."+p.closeButton]={display:"block",background:h.menuItemBackgroundPressed},n)},t[":after"]={pointerEvents:"none",content:'""',position:"absolute",left:0,top:0,bottom:0,right:0,border:"1px solid "+f.semanticColors.focusBorder},t)},a],itemButton:[p.itemButton,{width:"100%",padding:0,border:"none",height:"100%",minWidth:0,overflow:"hidden",selectors:(r={},r[_.s]={color:"WindowText",selectors:{":hover":Object(s.e)({background:"Highlight",color:"HighlightText"},Object(_.T)())}},r[":hover"]={color:h.menuItemTextHovered},r)},l&&[p.isSuggested,{background:h.menuItemBackgroundPressed,selectors:(i={":hover":{background:h.menuDivider}},i[_.s]=Object(s.e)({background:"Highlight",color:"HighlightText"},Object(_.T)()),i)}]],closeButton:[p.closeButton,{display:"none",color:c.neutralSecondary,padding:"0 4px",height:"auto",width:32,selectors:(o={":hover, :active":{background:c.neutralTertiaryAlt,color:c.neutralDark}},o[_.s]={color:"WindowText"},o)},l&&(u={},u["."+D.e+" &"]={selectors:{":hover, :active":{background:c.neutralTertiary}}},u.selectors={":hover, :active":{background:c.neutralTertiary,color:c.neutralPrimary}},u)]}},void 0,{scope:"SuggestionItem"}),F=(function(e){Object(s.r)(t,e);function t(t){var n=e.call(this,t)||this;n._forceResolveButton=o.createRef();n._searchForMoreButton=o.createRef();n._selectedElement=o.createRef();n.tryHandleKeyDown=function(e,t){var r=!1,s=null,o=n.state.selectedActionType,u=n.props.suggestions.length;if(e===f.e.down)switch(o){case i.forceResolve:if(u>0){n._refocusOnSuggestions(e);s=i.none}else s=n._searchForMoreButton.current?i.searchMore:i.forceResolve;break;case i.searchMore:if(n._forceResolveButton.current)s=i.forceResolve;else if(u>0){n._refocusOnSuggestions(e);s=i.none}else s=i.searchMore;break;case i.none:-1===t&&n._forceResolveButton.current&&(s=i.forceResolve)}else if(e===f.e.up)switch(o){case i.forceResolve:if(n._searchForMoreButton.current)s=i.searchMore;else if(u>0){n._refocusOnSuggestions(e);s=i.none}break;case i.searchMore:if(u>0){n._refocusOnSuggestions(e);s=i.none}else n._forceResolveButton.current&&(s=i.forceResolve);break;case i.none:-1===t&&n._searchForMoreButton.current&&(s=i.searchMore)}if(null!==s){n.setState({selectedActionType:s});r=!0}return r};n._getAlertText=function(){var e=n.props,t=e.isLoading,r=e.isSearching,i=e.suggestions,s=e.suggestionsAvailableAlertText,o=e.noResultsFoundText;if(!t&&!r){if(i.length>0)return s||"";if(o)return o}return""};n._getMoreResults=function(){n.props.onGetMoreResults&&n.props.onGetMoreResults()};n._forceResolve=function(){n.props.createGenericItem&&n.props.createGenericItem()};n._shouldShowForceResolve=function(){return!!n.props.showForceResolve&&n.props.showForceResolve()};n._onClickTypedSuggestionsItem=function(e,t){return function(r){n.props.onSuggestionClick(r,e,t)}};n._refocusOnSuggestions=function(e){"function"==typeof n.props.refocusSuggestions&&n.props.refocusSuggestions(e)};n._onRemoveTypedSuggestionsItem=function(e,t){return function(r){(0,n.props.onSuggestionRemove)(r,e,t);r.stopPropagation()}};Object(l.e)(n);n.state={selectedActionType:i.none};return n}t.prototype.componentDidMount=function(){this.scrollSelected();this.activeSelectedElement=this._selectedElement?this._selectedElement.current:null};t.prototype.componentDidUpdate=function(){if(this._selectedElement.current&&this.activeSelectedElement!==this._selectedElement.current){this.scrollSelected();this.activeSelectedElement=this._selectedElement.current}};t.prototype.render=function(){var e,t,n=this,r=this.props,u=r.forceResolveText,a=r.mostRecentlyUsedHeaderText,f=r.searchForMoreIcon,l=r.searchForMoreText,v=r.className,m=r.moreSuggestionsAvailable,g=r.noResultsFoundText,y=r.suggestions,b=r.isLoading,w=r.isSearching,E=r.loadingText,S=r.onRenderNoResultFound,x=r.searchingText,T=r.isMostRecentlyUsedVisible,N=r.resultsMaximumNumber,C=r.resultsFooterFull,k=r.resultsFooter,L=r.isResultsFooterVisible,A=void 0===L||L,O=r.suggestionsHeaderText,M=r.suggestionsClassName,_=r.theme,D=r.styles,P=r.suggestionsListId;this._classNames=D?B(D,{theme:_,className:v,suggestionsClassName:M,forceResolveButtonSelected:this.state.selectedActionType===i.forceResolve,searchForMoreButtonSelected:this.state.selectedActionType===i.searchMore}):{root:Object(c.e)("ms-Suggestions",v,H.root),title:Object(c.e)("ms-Suggestions-title",H.suggestionsTitle),searchForMoreButton:Object(c.e)("ms-SearchMore-button",H.actionButton,(e={},e["is-selected "+H.buttonSelected]=this.state.selectedActionType===i.searchMore,e)),forceResolveButton:Object(c.e)("ms-forceResolve-button",H.actionButton,(t={},t["is-selected "+H.buttonSelected]=this.state.selectedActionType===i.forceResolve,t)),suggestionsAvailable:Object(c.e)("ms-Suggestions-suggestionsAvailable",H.suggestionsAvailable),suggestionsContainer:Object(c.e)("ms-Suggestions-container",H.suggestionsContainer,M),noSuggestions:Object(c.e)("ms-Suggestions-none",H.suggestionsNone)};var j=this._classNames.subComponentStyles?this._classNames.subComponentStyles.spinner:void 0,F=D?{styles:j}:{className:Object(c.e)("ms-Suggestions-spinner",H.suggestionsSpinner)},I=function(){return g?o.createElement("div",{className:n._classNames.noSuggestions},g):null},q=O;T&&a&&(q=a);var R=void 0;A&&(R=y.length>=N?C:k);var U=!(y&&y.length||b),z=U||b?{role:"dialog",id:P}:{},W=this.state.selectedActionType===i.forceResolve?"sug-selectedAction":void 0,X=this.state.selectedActionType===i.searchMore?"sug-selectedAction":void 0;return o.createElement("div",Object(s.e)({className:this._classNames.root},z),o.createElement(d.e,{message:this._getAlertText(),"aria-live":"polite"}),q?o.createElement("div",{className:this._classNames.title},q):null,u&&this._shouldShowForceResolve()&&o.createElement(h.e,{componentRef:this._forceResolveButton,className:this._classNames.forceResolveButton,id:W,onClick:this._forceResolve,"data-automationid":"sug-forceResolve"},u),b&&o.createElement(p.e,Object(s.e)({},F,{label:E})),U?S?S(void 0,I):I():this._renderSuggestions(),l&&m&&o.createElement(h.e,{componentRef:this._searchForMoreButton,className:this._classNames.searchForMoreButton,iconProps:f||{iconName:"Search"},id:X,onClick:this._getMoreResults,"data-automationid":"sug-searchForMore"},l),w?o.createElement(p.e,Object(s.e)({},F,{label:x})):null,!R||m||T||w?null:o.createElement("div",{className:this._classNames.title},R(this.props)))};t.prototype.hasSuggestedAction=function(){return!!this._searchForMoreButton.current||!!this._forceResolveButton.current};t.prototype.hasSuggestedActionSelected=function(){return this.state.selectedActionType!==i.none};t.prototype.executeSelectedAction=function(){switch(this.state.selectedActionType){case i.forceResolve:this._forceResolve();break;case i.searchMore:this._getMoreResults()}};t.prototype.focusAboveSuggestions=function(){this._forceResolveButton.current?this.setState({selectedActionType:i.forceResolve}):this._searchForMoreButton.current&&this.setState({selectedActionType:i.searchMore})};t.prototype.focusBelowSuggestions=function(){this._searchForMoreButton.current?this.setState({selectedActionType:i.searchMore}):this._forceResolveButton.current&&this.setState({selectedActionType:i.forceResolve})};t.prototype.focusSearchForMoreButton=function(){this._searchForMoreButton.current&&this._searchForMoreButton.current.focus()};t.prototype.scrollSelected=function(){this._selectedElement.current&&void 0!==this._selectedElement.current.scrollIntoView&&this._selectedElement.current.scrollIntoView(!1)};t.prototype._renderSuggestions=function(){var e=this,t=this.props,n=t.isMostRecentlyUsedVisible,r=t.mostRecentlyUsedHeaderText,i=t.onRenderSuggestion,s=t.removeSuggestionAriaLabel,u=t.suggestionsItemClassName,a=t.resultsMaximumNumber,f=t.showRemoveButtons,l=t.suggestionsContainerAriaLabel,c=t.suggestionsHeaderText,h=t.suggestionsListId,p=this.props.suggestions,d=j,v=-1;p.some(function(e,t){if(e.selected){v=t;return!0}return!1});a&&(p=v>=a?p.slice(v-a+1,v+1):p.slice(0,a));if(0===p.length)return null;var m=c;n&&r&&(m=r);return o.createElement("div",{className:this._classNames.suggestionsContainer,id:h,role:"listbox","aria-label":l||m},p.map(function(t,n){return o.createElement("div",{ref:t.selected?e._selectedElement:void 0,key:t.item.key?t.item.key:n,role:"presentation"},o.createElement(d,{suggestionModel:t,RenderSuggestion:i,onClick:e._onClickTypedSuggestionsItem(t.item,n),className:u,showRemoveButton:f,removeButtonAriaLabel:s,onRemoveItem:e._onRemoveTypedSuggestionsItem(t.item,n),id:"sug-"+n}))}))};return t})(o.Component)},function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(1946),i=n(52),s=n(1973),o=n(164),u=n(1713),a=n(1945),f=(function(){function e(e){this._pageContext=e.pageContext?e.pageContext:window._spPageContextInfo;this._getThemeDataSource=e.getThemeDataSource;this._themeProvider=new s.e(this._loadTheme.bind(this))}e.prototype.loadThemeSlotsMap=function(e){var t=this._getThemeCacheToken();return t?this._themeProvider.loadThemeTokenMap(t,e):i.n.resolve()};e.prototype.loadFullFormattedThemeData=function(e){var t=this;return this.loadFullThemeData(e).then(function(e){if(e){var n={},r=e.palette;for(var i in r){var o=r[i];o&&(n[i]=u.e.toHtmlString(o))}e.backgroundImageUri&&(n.backgroundImageUri=s.e.getBackgroundUrl(e));var f={palette:n,isInverted:e.isInverted};return f=Object(a.e)(f,t._pageContext)}})};e.prototype.loadFullThemeData=function(e){var t=this._getThemeCacheToken();if(t)return this._themeProvider.loadThemeData(t,e);return i.n.resolve(void 0)};e.prototype._getThemeCacheToken=function(){var e,t=this._pageContext;if(t){var n=Number(t.webTemplate),r=n===o.e.teamSite||n===o.e.group?t.groupColor:void 0,i=r?r+";web#"+t.webTemplate:null;e=t.themedCssFolderUrl||i||null}return e};e.prototype._loadTheme=function(e){if(!!this._getThemeCacheToken()){this._themeDataSource||(this._themeDataSource=this._getThemeDataSource());return this._themeDataSource.then(function(t){return t?t.loadTheme(e):i.n.resolve()})}return i.n.resolve()};return e})(),l=n(289),c=n(356),h=n(1866),p=n(1967),d=n(1008).r?"#0078d4":"#03787c",v=(function(){function e(e){this._pageContext=e;this._dataRequestor=new c.e({qosName:"WebThemeDataSource"},{pageContext:e})}e.prototype.getCacheToken=function(){var e="",t=this._pageContext;if(t){var n=Number(t.webTemplate),r=n!==o.t.mySite&&n!==o.t.mySiteHost?t.groupColor:d;e=t.themedCssFolderUrl||r}return e};e.prototype.loadTheme=function(e){if(!e&&this._dataPromise)return this._dataPromise;if(!this.getCacheToken())return this._dataPromise=i.n.resolve();this._dataPromise=this._pageContext.themedCssFolderUrl?this.loadServerTheme():this.loadGeneratedTheme();return this._dataPromise};e.prototype.needsRequestDigest=function(e){return!1};e.prototype.loadGeneratedTheme=function(){var e=this._pageContext.groupColor||d,t=u.e.fromHtmlColor(e);if(t){var n={backgroundImageUri:null,cacheToken:e,isDefault:!1,isInverted:!1,palette:h.e.generateFabricColors(t),version:"1"};return i.n.resolve(n)}return i.n.resolve()};e.prototype.loadServerTheme=function(){var e=this,t=Object(l.n)(this._pageContext),n=this._pageContext.currentUICultureName,r=this._pageContext.themedCssFolderUrl,i=this.getCacheToken()===r&&r||void 0,s=p.e.makeWebThemeRestUrl(t,n,i),o=this._dataRequestor.getData({url:s,parseResponse:function(t){e._data=p.e.processWebThemeRestResponse(t);return e._data},qosName:"WebThemeDataSource.LoadData",method:"GET"});o.done(null,function(){e._dataPromise=null});return o};return e})();function m(e){var t=e||window._spPageContextInfo,n={webThemeProvider:function(){return new f({pageContext:t,getThemeDataSource:function(){return i.n.resolve(new v(t))}})}};return Object(r.e)(n,t)}},function(e,t,n){"use strict";var r,i=n(1713),s=[.537,.349,.216,.184,.145,.082,.043,.027],o=[.537,.45,.349,.216,.184,.145,.082,.043],u=[.88,.77,.66,.55,.44,.33,.22,.11],a=[.11,.22,.33,.44,.55,.66,.77,.88],f=[.96,.84,.7,.4,.12],l=[.1,.24,.44];(function(e){e[e.Unshaded=0]="Unshaded";e[e.Shade1=1]="Shade1";e[e.Shade2=2]="Shade2";e[e.Shade3=3]="Shade3";e[e.Shade4=4]="Shade4";e[e.Shade5=5]="Shade5";e[e.Shade6=6]="Shade6";e[e.Shade7=7]="Shade7";e[e.Shade8=8]="Shade8"})(r||(r={}));function c(e,t){return{h:e.h,s:e.s,v:e.v-e.v*t}}function h(e,t){return{h:e.h,s:e.s-e.s*t,v:e.v+(100-e.v)*t}}function p(e,t,n){if(!e||t===r.Unshaded||!(function(e){return"number"==typeof e&&e>=r.Unshaded&&e<=r.Shade8})(t))return e;var p=h,d=c;if(n){p=c;d=h}var v=(function(e){var t,n,r=NaN,i=e.R,s=e.G,o=e.B,u=Math.max(i,s,o),a=Math.min(i,s,o),f=u-a;0===f?r=0:i===u?r=(s-o)/f%6:s===u?r=(o-i)/f+2:o===u&&(r=(i-s)/f+4);(r=Math.round(60*r))<0&&(r+=360);t=Math.round(100*(0===u?0:f/u));n=Math.round(u/255*100);return{h:r,s:t,v:n}})(e),m=(function(e){var t=e.h,n=e.s,r=e.v,i=(2-(n/=100))*(r/=100),s=n*r;return{h:t,s:100*(s=(s/=i<=1?i:2-i)||0),l:100*(i/=2)}})(v),g=t-1;return(function(e){var t=e.h,n=e.s,r=e.v,s=[],o=(r/=100)*(n/=100),u=t/60,a=o*(1-Math.abs(u%2-1)),f=r-o;switch(Math.floor(u)){case 0:s=[o,a,0];break;case 1:s=[a,o,0];break;case 2:s=[0,o,a];break;case 3:s=[0,a,o];break;case 4:s=[a,0,o];break;case 5:s=[o,0,a]}return i.e.fromRgba(Math.round(255*(s[0]+f)),Math.round(255*(s[1]+f)),Math.round(255*(s[2]+f)))})(v=(function(e){return 255===e.R&&255===e.G&&255===e.B})(e)?c(v,s[g]):(function(e){return 0===e.R&&0===e.G&&0===e.B})(e)?h(v,o[g]):m.l/100>.8?d(v,a[g]):m.l/100<.2?p(v,u[g]):g<f.length?p(v,f[g]):d(v,l[g-f.length]))}var d=(function(){function e(){}e.generateFabricColors=function(t,n){void 0===n&&(n=!1);var s={themeDarker:r.Shade8,themeDark:r.Shade7,themeDarkAlt:r.Shade6,themeLight:r.Shade3,themeLighter:r.Shade2,themeLighterAlt:r.Shade1,themePrimary:r.Unshaded,themeAccent:r.Unshaded,themeSecondary:r.Shade5,themeTertiary:r.Shade4},o=e._getDefaultThemeTokenMap(),u=i.e.fromRgba(t.R,t.G,t.B);for(var a in s){var f=s[a];o[a]=p(u,f,n)}var l=o.themeAccent;o.themeAccentTranslucent10=l?i.e.fromRgba(l.R,l.G,l.B,.1*i.e.maxComponent):null;if(n){var c={black:"#fff",blackTranslucent40:"#66ffffff",neutralDark:"#f4f4f4",neutralPrimary:"#fff",neutralPrimaryTranslucent50:"#7fffffff",neutralPrimaryAlt:"#dadada",neutralSecondary:"#d0d0d0",neutralTertiary:"#c8c8c8",neutralTertiaryAlt:"#6d6d6d",neutralQuaternary:"#4f4f4f",neutralQuaternaryAlt:"#484848",cmdbarSelected:"#4f4f4f",cmdbarSelectedHover:"#484848",neutralLight:"#3f3f3f",neutralLighter:"#313131",neutralLighterAlt:"#282828",white:"#1f1f1f",whiteTranslucent40:"#661f1f1f",error:"#f00",errorBackground:"#7e3333"};for(var h in c)c.hasOwnProperty(h)&&(o[h]=i.e.fromHtmlColor(c[h]))}return o};e._getDefaultThemeTokenMap=function(){return{backgroundOverlay:null,themeDarker:null,themeDark:null,themeDarkAlt:null,themePrimary:null,themeSecondary:null,themeTertiary:null,themeLight:null,themeLighter:null,themeLighterAlt:null,black:null,cmdbarSelected:null,cmdbarSelectedHover:null,neutralDark:null,neutralPrimary:null,neutralPrimaryAlt:null,neutralPrimaryTranslucent50:null,neutralSecondary:null,neutralSecondaryAlt:null,neutralTertiary:null,neutralTertiaryAlt:null,neutralQuaternary:null,neutralQuaternaryAlt:null,neutralLight:null,neutralLighter:null,neutralLighterAlt:null,white:null,blackTranslucent40:null,whiteTranslucent40:null,yellow:null,yellowLight:null,orange:null,orangeLight:null,redDark:null,red:null,magentaDark:null,magenta:null,magentaLight:null,purpleDark:null,purple:null,purpleLight:null,blueDark:null,blueMid:null,blue:null,blueLight:null,tealDark:null,teal:null,tealLight:null,greenDark:null,green:null,greenLight:null,error:null,errorBackground:null,success:null,successBackground:null,alert:null,alertBackground:null,infoBackground:null,info:null,orangeLighter:null}};return e})();t.e=d},function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"n",function(){return i});n.d(t,"t",function(){return s});function r(e){return!!e.properties.CheckedOutUserId}function i(e,t){var n=Number(t);return!isNaN(n)&&Number(e.properties.CheckedOutUserId)===n}function s(e,t){return r(e)&&!i(e,t)}},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return k});var r=n(1419),i=n(4),s=n("react-lib"),o=n(472),u=n(653),a=n(1699),f=n(1843),l=n(182),c=n(886),h=n(1377),p=n(37),d=n(1508),v=n(1739),m=Object(o.e)(),g=s.createElement(v.e,null).type,y=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;Object(c.e)(n);Object(h.e)("DialogContent",t,{titleId:"titleProps.id"});return n}t.prototype.render=function(){var e,t=this.props,n=t.showCloseButton,r=t.className,o=t.closeButtonAriaLabel,u=t.onDismiss,f=t.subTextId,l=t.subText,c=t.titleProps,h=void 0===c?{}:c,v=t.titleId,g=t.title,y=t.type,b=t.styles,w=t.theme,E=t.draggableHeaderClassName,S=m(b,{theme:w,className:r,isLargeHeader:y===a.e.largeHeader,isClose:y===a.e.close,draggableHeaderClassName:E}),x=this._groupChildren();l&&(e=s.createElement("p",{className:S.subText,id:f},l));return s.createElement("div",{className:S.content},s.createElement("div",{className:S.header},s.createElement("div",Object(i.e)({id:v,role:"heading","aria-level":1},h,{className:Object(p.e)(S.title,h.className)}),g),s.createElement("div",{className:S.topButton},this.props.topButtonsProps.map(function(e,t){return s.createElement(d.e,Object(i.e)({key:e.uniqueId||t},e))}),(y===a.e.close||n&&y!==a.e.largeHeader)&&s.createElement(d.e,{className:S.button,iconProps:{iconName:"Cancel"},ariaLabel:o,onClick:u,title:o}))),s.createElement("div",{className:S.inner},s.createElement("div",{className:S.innerContent},e,x.contents),x.footers))};t.prototype._groupChildren=function(){var e={footers:[],contents:[]};s.Children.map(this.props.children,function(t){"object"==typeof t&&null!==t&&t.type===g?e.footers.push(t):e.contents.push(t)});return e};t.defaultProps={showCloseButton:!1,className:"",topButtonsProps:[],closeButtonAriaLabel:"Close"};return t=Object(i.n)([l.n],t)})(s.Component),b=n(25),w={contentLgHeader:"ms-Dialog-lgHeader",close:"ms-Dialog--close",subText:"ms-Dialog-subText",header:"ms-Dialog-header",headerLg:"ms-Dialog--lgHeader",button:"ms-Dialog-button ms-Dialog-button--close",inner:"ms-Dialog-inner",content:"ms-Dialog-content",title:"ms-Dialog-title"},E=Object(r.e)(y,function(e){var t,n,r,i=e.className,s=e.theme,o=e.isLargeHeader,u=e.isClose,a=e.hidden,f=e.isMultiline,l=e.draggableHeaderClassName,c=s.palette,h=s.fonts,p=s.effects,d=s.semanticColors,v=Object(b.x)(w,s);return{content:[o&&[v.contentLgHeader,{borderTop:"4px solid "+c.themePrimary}],u&&v.close,{flexGrow:1,overflowY:"hidden"},i],subText:[v.subText,h.medium,{margin:"0 0 24px 0",color:d.bodySubtext,lineHeight:"1.5",wordWrap:"break-word",fontWeight:b.i.regular}],header:[v.header,{position:"relative",width:"100%",boxSizing:"border-box"},u&&v.close,l&&[l,{cursor:"move"}]],button:[v.button,a&&{selectors:{".ms-Icon.ms-Icon--Cancel":{color:d.buttonText,fontSize:b.u.medium}}}],inner:[v.inner,{padding:"0 24px 24px",selectors:(t={},t["@media (min-width: "+b.p+"px) and (max-width: "+b.l+"px)"]={padding:"0 16px 16px"},t)}],innerContent:[v.content,{position:"relative",width:"100%"}],title:[v.title,h.xLarge,{color:d.bodyText,margin:"0",minHeight:h.xLarge.fontSize,padding:"16px 46px 20px 24px",lineHeight:"normal",selectors:(n={},n["@media (min-width: "+b.p+"px) and (max-width: "+b.l+"px)"]={padding:"16px 46px 16px 16px"},n)},o&&{color:d.menuHeader},f&&{fontSize:h.xxLarge.fontSize}],topButton:[{display:"flex",flexDirection:"row",flexWrap:"nowrap",position:"absolute",top:"0",right:"0",padding:"15px 15px 0 0",selectors:(r={"> *":{flex:"0 0 auto"},".ms-Dialog-button":{color:d.buttonText},".ms-Dialog-button:hover":{color:d.buttonTextHovered,borderRadius:p.roundedCorner2}},r["@media (min-width: "+b.p+"px) and (max-width: "+b.l+"px)"]={padding:"15px 8px 0 0"},r)}]}},void 0,{scope:"DialogContent"}),S=Object(o.e)(),x={isDarkOverlay:!1,isBlocking:!1,className:"",containerClassName:"",topOffsetFixed:!1},T={type:a.e.normal,className:"",topButtonsProps:[]},N=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;n._getSubTextId=function(){var e=n.props,t=e.ariaDescribedById,r=e.modalProps,i=e.dialogContentProps,s=e.subText,o=r&&r.subtitleAriaId||t;o||(o=(i&&i.subText||s)&&n._defaultSubTextId);return o};n._getTitleTextId=function(){var e=n.props,t=e.ariaLabelledById,r=e.modalProps,i=e.dialogContentProps,s=e.title,o=r&&r.titleAriaId||t;o||(o=(i&&i.title||s)&&n._defaultTitleTextId);return o};n._id=Object(u.e)("Dialog");n._defaultTitleTextId=n._id+"-title";n._defaultSubTextId=n._id+"-subText";0;return n}t.prototype.render=function(){var e,t,n,r,o=this.props,u=o.className,a=o.containerClassName,l=o.contentClassName,c=o.elementToFocusOnDismiss,h=o.firstFocusableSelector,p=o.forceFocusInsideTrap,d=o.styles,v=o.hidden,m=o.ignoreExternalFocusing,g=o.isBlocking,y=o.isClickableOutsideFocusTrap,b=o.isDarkOverlay,w=o.isOpen,N=o.onDismiss,C=o.onDismissed,k=o.onLayerDidMount,L=o.responsiveMode,A=o.subText,O=o.theme,M=o.title,_=o.topButtonsProps,D=o.type,P=o.minWidth,H=o.maxWidth,B=o.modalProps,j=Object(i.e)({},B?B.layerProps:{onLayerDidMount:k});k&&!j.onLayerDidMount&&(j.onLayerDidMount=k);if(B&&B.dragOptions&&!B.dragOptions.dragHandleSelector){n="ms-Dialog-draggable-header";r=Object(i.e)(Object(i.e)({},B.dragOptions),{dragHandleSelector:"."+n})}else r=B&&B.dragOptions;var F=Object(i.e)(Object(i.e)(Object(i.e)(Object(i.e)({},x),{className:u,containerClassName:a,isBlocking:g,isDarkOverlay:b,onDismissed:C}),B),{layerProps:j,dragOptions:r}),I=Object(i.e)(Object(i.e)(Object(i.e)({className:l,subText:A,title:M,topButtonsProps:_,type:D},T),this.props.dialogContentProps),{draggableHeaderClassName:n,titleProps:Object(i.e)({id:(null===(e=this.props.dialogContentProps)||void 0===e?void 0:e.titleId)||this._defaultTitleTextId},null===(t=this.props.dialogContentProps)||void 0===t?void 0:t.titleProps)}),q=S(d,{theme:O,className:F.className,containerClassName:F.containerClassName,hidden:v,dialogDefaultMinWidth:P,dialogDefaultMaxWidth:H});return s.createElement(f.e,Object(i.e)({elementToFocusOnDismiss:c,firstFocusableSelector:h,forceFocusInsideTrap:p,ignoreExternalFocusing:m,isClickableOutsideFocusTrap:y,onDismissed:F.onDismissed,responsiveMode:L},F,{isDarkOverlay:F.isDarkOverlay,isBlocking:F.isBlocking,isOpen:void 0!==w?w:!v,className:q.root,containerClassName:q.main,onDismiss:N||F.onDismiss,subtitleAriaId:this._getSubTextId(),titleAriaId:this._getTitleTextId()}),s.createElement(E,Object(i.e)({subTextId:this._defaultSubTextId,title:I.title,subText:I.subText,showCloseButton:F.isBlocking,topButtonsProps:I.topButtonsProps,type:I.type,onDismiss:N||I.onDismiss,className:I.className},I),this.props.children))};t.defaultProps={hidden:!0};return t=Object(i.n)([l.n],t)})(s.Component),C={root:"ms-Dialog"},k=Object(r.e)(N,function(e){var t,n=e.className,r=e.containerClassName,i=e.dialogDefaultMinWidth,s=void 0===i?"288px":i,o=e.dialogDefaultMaxWidth,u=void 0===o?"340px":o,a=e.hidden,f=e.theme;return{root:[Object(b.x)(C,f).root,f.fonts.medium,n],main:[{width:s,outline:"3px solid transparent",selectors:(t={},t["@media (min-width: "+b.h+"px)"]={width:"auto",maxWidth:u,minWidth:s},t)},!a&&{display:"flex"},r]}},void 0,{scope:"Dialog"});k.displayName="Dialog"},function(e,t,n){"use strict";var r=n(138);Object(r.n)([{rawString:".od-IconGlyph.ms-Icon{display:none;font-size:16px;text-align:center;white-space:nowrap;position:relative}.od-IconGlyph.ms-Icon.od-IconGlyph--visible{display:inline-block}.od-IconGlyph.ms-Icon.ms-Icon--Add{font-size:15px}.od-IconGlyph-badge.ms-Icon{display:none;position:absolute;top:-.2em;font-size:.7em;width:1em;height:1em;text-align:center;white-space:nowrap}[dir=ltr] .od-IconGlyph-badge.ms-Icon{right:-.2em}[dir=rtl] .od-IconGlyph-badge.ms-Icon{left:-.2em}.od-IconGlyph-badge.ms-Icon.ms-Icon--StatusErrorFull{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-radius:50%;margin-top:0;font-size:12px}.od-IconGlyph-badge.ms-Icon.ms-Icon--StatusErrorFull:before{position:relative;top:-2px}.od-IconGlyph.ms-Icon.od-IconGlyph--badged .od-IconGlyph-badge.ms-Icon{display:inline-block}"}]);var i=n(0),s=n(1651),o=n("knockout-lib"),u=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.icon=o.isObservable(t.icon)?t.icon:o.observable(t.icon);n.badge=o.isObservable(t.badge)?t.badge:o.observable(t.badge);n.iconClasses=n.createComputed(function(){return n.icon()&&n.icon().getClass()||""});n.badgeClasses=n.createComputed(function(){return n.badge()&&n.badge().getClass()||""});return n}return t})(s.t),a=n(1652).e({tagName:"od-icon-glyph",template:"<i class=\"od-IconGlyph\" data-bind=\"class:iconClasses,attr:{'data-icon-name':icon},css:{'od-IconGlyph--badged':badge,'od-IconGlyph--visible':icon},with:badge\"><i class=\"od-IconGlyph-badge\" data-bind=\"class:$component.badgeClasses,attr:{'data-icon-name':$component.badge}\"></i></i>",viewModel:u,synchronous:!0});t.e=a},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"r",function(){return a});n.d(t,"t",function(){return l});n.d(t,"i",function(){return c});n.d(t,"n",function(){return h});var r,i=n(3),s=n(13),o="shared_sharepointonline",u=((r={})[o]=!0,r.shared_onedriveforbusiness=!0,r);function a(e){return e&&"Request"===e.type&&"Http"===e.kind||f(e)}function f(e){return e&&"Request"===e.type&&"ApiConnection"===e.kind&&e.api&&u[e.api.name]}function l(e){return e?{type:"Request",kind:"ApiConnection",api:{id:"",name:"shared_onedriveforbusiness"}}:{type:"Request",kind:"ApiConnection",api:{id:"",name:o}}}function c(e){return e&&(!s.e.isActivated("36574CF5-480D-47E8-BF76-8C449F1CE451","09/22/2021","Allow unidentified flow instances to run in the widget")&&!e.trigger||f(e.trigger))}function h(){return Object(i.Wi)(i.k)}},,function(e,t,n){"use strict";var r=n(138);Object(r.n)([{rawString:".od-ImageTile{display:block;position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden}.od-ImageTile img{display:block}.od-ImageTile--cover .od-ImageTile-background{top:0;left:0;bottom:0;right:0;width:100%;height:100%;margin:auto;background-size:cover;background-repeat:no-repeat;background-position:center}.od-ImageTile--fit .od-ImageTile-background{top:0;left:0;bottom:0;right:0;width:100%;height:100%;margin:auto;background-size:contain;background-repeat:no-repeat;background-position:center}.od-ImageTile-image{display:block;opacity:0;position:absolute;box-sizing:border-box}.od-ImageTile-image,a .od-ImageTile-image{border:none}.od-ImageTile-background{display:block;opacity:0;position:absolute;box-sizing:border-box}.od-ImageTile--isLoaded.od-ImageTile--isDimensioned.od-ImageTile--isAligned .od-ImageTile-background{opacity:1}@media screen and (-ms-high-contrast:active){.od-ImageTile--isLoaded.od-ImageTile--isDimensioned.od-ImageTile--isAligned .od-ImageTile-background{opacity:0}}.od-ImageTile--isLoaded.od-ImageTile--isDimensioned.od-ImageTile--isCustom .od-ImageTile-image{opacity:1}@media screen and (-ms-high-contrast:active){.od-ImageTile--isLoaded.od-ImageTile--isDimensioned .od-ImageTile-image{opacity:1}}.od-ImageTile--isRotating .od-ImageTile-image{transition:transform 167ms cubic-bezier(.1,.25,.75,.9)}"}]);var i=n(1652),s=n(0),o=n(1651),u=n(1767),a=n(1707),f=n(1650),l=n(1649),c=n(197),h=n(11),p=(function(e){Object(s.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=r._images=[];r.async.setInterval(function(){i.length>300&&i.splice(300,1/0)},6e4);return r}t.prototype.checkOutImage=function(){return this._images.shift()||document.createElement("img")};t.prototype.checkInImage=function(e){var t=this,n=new c.e,r=this.async;r.setTimeout(function(){e.setAttribute("src","data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=");e.removeAttribute("style");e.removeAttribute("class");r.setTimeout(function(){e.removeAttribute("src");t._images.push(e);n.complete()},1e3)},0);return n.getPromise()};return t})(l.n),d=Object(h.s)("ImageRecycler",p),v=n("knockout-lib"),m=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=n.resources.consume(d),i=n.valueAccessor(),o=r.checkOutImage(),u=n.bindingContext,f=i.attr,l=void 0===f?{}:f,c=i.style,h=i.css,p=i.class;v.applyBindingsToNode(o,{attr:Object(s.__assign)({alt:""},l)},u);c&&v.applyBindingsToNode(o,{style:c},u);h&&v.applyBindingsToNode(o,{css:h},u);p&&v.applyBindingsToNode(o,{class:p},u);new(n.managed(a.e))({element:o,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return i.imageLoader},bindingContext:u});v.virtualElements.setDomNodeChildren(n.element,[o]);n.addDisposable({dispose:function(){if(o){v.cleanNode(o);r.checkInImage(o).done()}}});n.controlsDescendantBindings=!0;return n}t.supportsVirtualElements=!0;return t})(f.t),g=n(22),y=n(526),b=n(880),w=n(1730),E=n(1708),S=n(1438),x=(function(e){Object(s.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.addBindingHandlers({imageLoader:a.e,imageRecycler:m});var i=t.image,s=t.rotation,o=void 0===s?u.e.none:s,f=t.desiredSize,l=t.scale,c=void 0===l?1:l,h=t.isLoaded,p=void 0===h?r.createObservable(!1):h,d=t.position,v=t.loadedImage,g=t.error,y=t.loadImageScenarioName,b=n.thumbnailCache,x=void 0===b?r.resources.consume(E.e):b,T=n.outputExtenders,N=void 0===T?{deferred:!0}:T;r._image=r.wrapObservable(i);r._rotation=r.wrapObservable(o);r._scale=r.wrapObservable(c);r._desiredSize=r.wrapObservable(f);r._alignment=w.n(t.alignment);r._thumbnailCache=x;r._loadedImage=r.wrapObservable(v);r._error=r.wrapObservable(g);r.isRotating=r._getIsRotating();r.alignmentName=r.createPureComputed(r._computeAlignmentName);r.actualSize=r.createPureComputed(r._computeActualSize);r.actualSize.equalityComparer=S.e;r.isLoaded=r.createPureComputed(r._computeIsLoaded);r._imageUrl=r.createPureComputed(r._computeImageUrl);r._finalSize=r.createPureComputed(r._computeFinalSize);r._finalSize.equalityComparer=S.e;r._position=r.createPureComputed(r._computePosition);r._position.equalityComparer=S.e;r.imageElementStyle=r.createPureComputed(r._computeImageElementStyle);r.imageElementStyle.equalityComparer=S.e;r.imageBackgroundStyle=r.createPureComputed(r._computeImageBackgroundStyle);r.imageBackgroundStyle.equalityComparer=S.e;r.createBackgroundComputed(r._computeRecordImage);r.imageLoaderParams={src:r._imageUrl,image:r._loadedImage,error:r._error,scenarioName:y};d&&r.createBackgroundComputed(function(){return d(r._position())}).extend(N);p&&r.createBackgroundComputed(function(){return p(r.isLoaded())}).extend(N);return r}t.prototype._computeImageUrl=function(){var e=this._image();return e&&e.url&&g.format(e.url,e.width,e.height)||""};t.prototype._computeFinalSize=function(){var e,t=this._image(),n=this._scale();if(t&&!t.width){var r=this.actualSize(),i=window.devicePixelRatio||1;e=r&&{width:r.width*n/i,height:r.height*n/i}}else e=t&&{width:t.width*n,height:t.height*n};return e};t.prototype._computeImageElementStyle=function(){var e,t=this._desiredSize(),n=this._finalSize(),r=this._rotation();if(n){var i=void 0;i=t&&t.width&&t.height?t:n;var s=this._alignment.getTransform(n,i),o=s.translate.x/i.width,u=s.translate.y/i.height,a=s.scale*n.width/i.width,f=void 0;if(r){var l=void 0;if(r%2==1){var c={width:n.height,height:n.width};l=this._alignment.getTransform(c,i).multiply(s.invert())}else l=y.e.IDENTITY;f="rotate("+90*r+"deg) scale("+l.scale.toFixed(6)+")"}else f="";e={left:(100*o).toFixed(2)+"%",top:(100*u).toFixed(2)+"%",width:(100*a).toFixed(2)+"%","-webkit-transform":f,"-ms-transform":f,transform:f}}else e={left:"",top:"",width:"","-webkit-transform":"","-ms-transform":"",transform:""};return e};t.prototype._computeImageBackgroundStyle=function(){var e=this._finalSize(),t=this._imageUrl();return{"max-width":e?e.width.toFixed(2)+"px":"","max-height":e?e.height.toFixed(2)+"px":"","background-image":'url("'+t+'")'}};t.prototype._getIsRotating=function(){var e,t=this,n=this.createObservable(this._rotation.peek()),r=this.createPureComputed(function(){var r=t._rotation();e&&t.async.clearTimeout(e);e=t.async.setTimeout(function(){return n(r)},300);return n()});return this.createPureComputed(function(){return t._rotation()!==r()})};t.prototype._computeRecordImage=function(){var e=this._image();e&&this.isLoaded()&&this._thumbnailCache.record(e)};t.prototype._computeIsLoaded=function(){return!!this._loadedImage()};t.prototype._computeActualSize=function(){var e,t=this._loadedImage();if(t){e={width:t.width,height:t.height}}return e};t.prototype._computePosition=function(){var e,t=this._desiredSize(),n=this._finalSize(),r=this._rotation();if(n){var i=void 0;i=t&&t.width&&t.height?t:n;var s=void 0;s=r%2==1?{width:n.height,height:n.width}:n;var o=this._alignment.getTransform(s,i),u=o.translate.x,a=o.translate.y,f=o.scale*s.width,l=o.scale*s.height;e=new b.e(u,a,f,l)}return e};t.prototype._computeAlignmentName=function(){var e;if(!this._rotation())switch(this._alignment.name){case"cover-center":e="cover";break;case"fit-center":e="fit"}return e};return t})(o.t),T=Object(i.e)({tagName:"od-image-tile",template:"<span class=\"od-ImageTile\" data-bind=\"css:{'od-ImageTile--isLoaded':isLoaded,'od-ImageTile--isDimensioned':!!actualSize(),'od-ImageTile--isRotating':isRotating,'od-ImageTile--isAligned':!!alignmentName(),'od-ImageTile--isCustom':!alignmentName()},class:alignmentName()?'od-ImageTile--'+alignmentName():''\"><span class=\"od-ImageTile-background\" data-bind=\"style:imageBackgroundStyle\"></span>\x3c!--ko imageRecycler:{imageLoader:imageLoaderParams,class:'od-ImageTile-image',style:imageElementStyle}--\x3e\x3c!--/ko--\x3e</span>",viewModel:x,synchronous:!0});t.e=T},function(e,t,n){"use strict";n.d(t,"r",function(){return E});n.d(t,"t",function(){return S});n.d(t,"e",function(){return x});n.d(t,"n",function(){return T});var r=n(0),i=n("react-lib"),s=n(1670),o=n(2051),u=n(1547),a=n(97),f=n(1508),l=n(993),c=n(37),h=n(22),p=n(138);Object(p.n)([{rawString:"@media screen and (-ms-high-contrast: active){.ms-Suggestions-itemButton:hover .ms-PeoplePicker-personaContent .ms-Persona-primaryText,.ms-Suggestions-itemButton:hover .ms-PeoplePicker-personaContent .ms-Persona-secondaryText,.ms-Suggestions-itemButton.is-suggested .ms-PeoplePicker-personaContent .ms-Persona-primaryText,.ms-Suggestions-itemButton.is-suggested .ms-PeoplePicker-personaContent .ms-Persona-secondaryText{color:HighlightText}}.ms-PickerPersona-container{position:relative;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;vertical-align:top;background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";margin:1px;vertical-align:top;white-space:nowrap;cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ms-PickerPersona-container::-moz-focus-inner{border:0}.ms-PickerPersona-container{outline:transparent}.ms-PickerPersona-container{position:relative}.ms-Fabric--isFocusVisible .ms-PickerPersona-container:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"focusBorder",defaultValue:"#605e5c"},{rawString:"}.ms-PickerPersona-container:hover{background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.ms-PickerPersona-container.is-selected{background:"},{theme:"neutralQuaternary",defaultValue:"#d2d0ce"},{rawString:"}.ms-PickerPersona-container.is-selected:hover{background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.ms-PickerPersona-container.is-listbelow{width:100%}.ms-PickerItem-sideContent{display:inline-block}.ms-PickerPersona-content{-webkit-box-flex:1;-ms-flex:1;flex:1;vertical-align:middle;min-width:100px}.ms-PeoplePicker-personaContent{min-width:100px;padding:7px 12px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-PeoplePicker-linkedInLogo{color:#0077b5}.itemContent_cceaac04{-webkit-box-flex:0;-ms-flex:0 1 auto;flex:0 1 auto;min-width:0;max-width:100%;overflow:hidden}.peoplePickerPill_cceaac04{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";height:24px;border-radius:12px;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin:4px}.peoplePickerClose_cceaac04{border-radius:12px;height:24px;width:24px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.peoplePickerClose_cceaac04:hover{background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:";border-radius:12px}\n"}]);var d=n(1841),v=n(249),m=n(70),g=v.e.isFeatureEnabled({ODC:"ToolTipEmailKillSwitch"})||m.e.isActivated("2f7a87f9150a4ef3b35a1ad82e402730","08/28/2021","ToolTipEmailKillSwitchActivated"),y={details:{paddingLeft:4,paddingRight:0}},b={icon:{fontSize:12,marginRight:0}};function w(e,t){var n="3rem";if(t)switch(t){case s.n.size24:n="1.5rem";break;case s.n.size32:n="2rem";break;case s.n.size40:n="2.5rem";break;case s.n.extraSmall:n="1.75rem";break;default:n="3rem"}return{text:e.name?e.name:"",imageUrl:e.image?e.image:"",tertiaryText:e.email?e.email:"",secondaryText:e.job?e.job:"",imageInitials:"",imageAlt:e.imageAlt,coinProps:{styles:{coin:{width:n,height:n,maxWidth:"75px",maxHeight:"75px"},image:{width:n+"!important",height:n+"!important",maxWidth:"75px",maxHeight:"75px"},imageArea:{width:n,height:n,maxWidth:"75px",maxHeight:"75px"},initials:{width:n,height:n,fontSize:"0.625rem",lineHeight:n}}},styles:{root:{height:n},primaryText:{fontSize:"0.875rem"},secondaryText:{fontSize:"0.75rem"}}}}var E=function(e){var t=w(e,s.n.size40);return i.createElement("div",{className:"ms-PeoplePicker-personaContent"},i.createElement(o.e,Object(r.__assign)({},t,{presence:s.t.none,size:s.n.size40,className:"ms-PeoplePicker-pickerPersona"})),4===e.entityType&&i.createElement(l.e,{className:"od-PeoplePicker-linkedInLogo",iconName:"LinkedInLogo"}))},S=function(e){var t=e.item,n=e.onRemoveItem,l=e.index,h=e.selected,p=e.removeButtonAriaLabel,d=w(t,s.n.extraSmall);g||(d.onRenderPrimaryText=function(){return i.createElement(u.e,{content:t.email||d.text,directionalHint:a.e.topLeftEdge},d.text)});return i.createElement("div",{className:Object(c.e)("ms-PickerPersona-container",{"is-selected":!!h}),"data-is-focusable":!0,"data-selection-index":l,key:l,role:"listitem"},i.createElement("div",{className:Object(c.e)("ms-PickerItem-content","itemContent_cceaac04")},i.createElement(o.e,Object(r.__assign)({},d,{presence:s.t.none,size:s.n.extraSmall}))),i.createElement(f.e,{onClick:n,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,ariaLabel:p}))},x=function(e){var t=e.item,n=e.onRemoveItem,u=e.index,a=e.selected,l=w(t,s.n.size40),p="PickerPersonaId"+Math.floor(1e4*Math.random()),v=h.format(d.n,t.name);return i.createElement("div",{className:Object(c.e)("ms-PickerPersona-container is-listbelow",{"is-selected":!!a}),"data-is-focusable":!0,"data-selection-index":u,key:u,"aria-labelledby":p,role:"listitem"},i.createElement("div",{className:"ms-PickerPersona-content"},i.createElement(o.e,Object(r.__assign)({id:p},l,{presence:s.t.none,size:s.n.size40}))),i.createElement("div",{className:"ms-PickerItem-content"},i.createElement(f.e,{onClick:n,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,ariaLabel:v})))},T=function(e){var t=e.item,n=e.onRemoveItem,u=e.index,a=t.email?"/_layouts/15/userphoto.aspx?accountname="+t.email:"",l={text:t.name||"",imageUrl:t.image||a,styles:{primaryText:{fontSize:"0.875rem"},secondaryText:{fontSize:"0.75rem"}}},c="PickerPersonaId"+Math.floor(1e4*Math.random()),p=h.format(d.n,t.name);return i.createElement("div",{className:"peoplePickerPill_cceaac04","data-is-focusable":!1,"data-selection-index":u,key:u,"aria-labelledby":c},i.createElement(o.e,Object(r.__assign)({id:c},l,{presence:s.t.none,size:s.n.size24,styles:y})),i.createElement(f.e,{onClick:n,iconProps:{iconName:"Cancel"},className:"peoplePickerClose_cceaac04","data-is-focusable":!0,ariaLabel:p,styles:b}))}},,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(91),i=function(){var e,t,n=Object(r.e)();return!!(null===(t=null===(e=n)||void 0===e?void 0:e.navigator)||void 0===t?void 0:t.userAgent)&&n.navigator.userAgent.indexOf("rv:11.0")>-1}},,,function(e,t,n){"use strict";var r=n(0),i=n(1650),s=n(181),o=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,i=n.valueAccessor();n._platform=n.resources.consume(s.e.optional);n._isPermanent="object"==typeof i&&i.isPermanent||!1;n._isReentrant="object"==typeof i&&i.isReentrant||!1;document.activeElement===n.element&&n._select();var o=Object(r.__assign)({focus:n._onFocus,focusin:n._onFocus,mouseup:n._onMouseUp},n._isReentrant?{focusout:n._onFocusOut}:{});n.events.onAll(n.element,o);return n}t.prototype._select=function(){var e=this.element;if((this._isPermanent||!this._hasSelected)&&"function"==typeof this.element.select){e.select();try{this._platform.isIOS&&e.value&&e.setSelectionRange(0,e.value.length)}catch(e){}this._hasSelected=!0;return!0}return!1};t.prototype._onFocus=function(e){this._select();return!0};t.prototype._onFocusOut=function(){this._hasSelected=!1;return!0};t.prototype._onMouseUp=function(e){if(this._select())return!1};return t})(i.t);t.e=o},,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(1649),i=new(n(7).t)({name:"UserStateProvider.key.updateQuota",factory:{dependencies:{observablesFactoryType:r.i},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})},,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r,i=((r={})[0]="Globe",r[3]="Lock",r[2]="PeopleAdd",r[1]="Work",r[4]="SecurityGroup",r[5]="Chat",r[6]="Mail",r)},function(e,t,n){"use strict";n.d(t,"e",function(){return C});var r=n(1419),i=n(4),s=n("react-lib"),o=n(1845),u=n(993),a=n(472),f=n(886),l=n(207),c=n(653),h=n(1487);0;var p,d=n(479),v=n(1755),m=n(270),g=n(91),y=n(1884),b=Object(a.e)(),w=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;n._textElement=s.createRef();n._onFocus=function(e){n.props.onFocus&&n.props.onFocus(e);n.setState({isFocused:!0},function(){n.props.validateOnFocusIn&&n._validate(n.value)})};n._onBlur=function(e){n.props.onBlur&&n.props.onBlur(e);n.setState({isFocused:!1},function(){n.props.validateOnFocusOut&&n._validate(n.value)})};n._onRenderLabel=function(e){var t=e.label,r=e.required,i=n._classNames.subComponentStyles?n._classNames.subComponentStyles.label:void 0;return t?s.createElement(o.e,{required:r,htmlFor:n._id,styles:i,disabled:e.disabled,id:n._labelId},e.label):null};n._onRenderDescription=function(e){return e.description?s.createElement("span",{className:n._classNames.description},e.description):null};n._onRevealButtonClick=function(e){n.setState(function(e){return{isRevealingPassword:!e.isRevealingPassword}})};n._onInputChange=function(e){var t=e.target.value;if(void 0!==t&&t!==n._lastChangeValue){n._lastChangeValue=t;e.persist();var r;n.setState(function(e,i){var s=E(i,e)||"";return(r=t===s)||n._isControlled?null:{uncontrolledValue:t}},function(){var i=n.props.onChange;!r&&i&&i(e,t)})}};Object(f.e)(n);n._async=new l.e(n);0;n._fallbackId=Object(c.e)("TextField");n._descriptionId=Object(c.e)("TextFieldDescription");n._labelId=Object(c.e)("TextFieldLabel");n._warnControlledUsage();var r=t.defaultValue,i=void 0===r?"":r;"number"==typeof i&&(i=String(i));n.state={uncontrolledValue:n._isControlled?void 0:i,isFocused:!1,errorMessage:""};n._delayedValidate=n._async.debounce(n._validate,n.props.deferredValidationTime);n._lastValidation=0;return n}Object.defineProperty(t.prototype,"value",{get:function(){return E(this.props,this.state)},enumerable:!0,configurable:!0});t.prototype.componentDidMount=function(){this._adjustInputHeight();this.props.validateOnLoad&&this._validate(this.value)};t.prototype.componentWillUnmount=function(){this._async.dispose()};t.prototype.getSnapshotBeforeUpdate=function(e,t){return{selection:[this.selectionStart,this.selectionEnd]}};t.prototype.componentDidUpdate=function(e,t,n){var r=this.props,i=(n||{}).selection,s=void 0===i?[null,null]:i,o=s[0],u=s[1];if(!!e.multiline!=!!r.multiline&&t.isFocused){this.focus();null!==o&&null!==u&&o>=0&&u>=0&&this.setSelectionRange(o,u)}var a=E(e,t),f=this.value;if(a!==f){this._warnControlledUsage(e);this.state.errorMessage&&!r.errorMessage&&this.setState({errorMessage:""});this._adjustInputHeight();this._lastChangeValue=void 0;S(r)&&this._delayedValidate(f)}};t.prototype.render=function(){var e=this.props,t=e.borderless,n=e.className,r=e.disabled,o=e.iconProps,a=e.inputClassName,f=e.label,l=e.multiline,c=e.required,d=e.underlined,v=e.prefix,m=e.resizable,w=e.suffix,E=e.theme,S=e.styles,x=e.autoAdjustHeight,T=e.canRevealPassword,N=e.type,C=e.onRenderPrefix,k=void 0===C?this._onRenderPrefix:C,L=e.onRenderSuffix,A=void 0===L?this._onRenderSuffix:L,O=e.onRenderLabel,M=void 0===O?this._onRenderLabel:O,_=e.onRenderDescription,D=void 0===_?this._onRenderDescription:_,P=this.state,H=P.isFocused,B=P.isRevealingPassword,j=this._errorMessage,F=!!T&&"password"===N&&(function(){var e;if("boolean"!=typeof p){var t=Object(g.e)();if(null===(e=t)||void 0===e?void 0:e.navigator){var n=/Edg/.test(t.navigator.userAgent||"");p=!(Object(y.e)()||n)}else p=!0}return p})(),I=this._classNames=b(S,{theme:E,className:n,disabled:r,focused:H,required:c,multiline:l,hasLabel:!!f,hasErrorMessage:!!j,borderless:t,resizable:m,hasIcon:!!o,underlined:d,inputClassName:a,autoAdjustHeight:x,hasRevealButton:F});return s.createElement("div",{className:I.root},s.createElement("div",{className:I.wrapper},M(this.props,this._onRenderLabel),s.createElement("div",{className:I.fieldGroup},(void 0!==v||this.props.onRenderPrefix)&&s.createElement("div",{className:I.prefix},k(this.props,this._onRenderPrefix)),l?this._renderTextArea():this._renderInput(),o&&s.createElement(u.e,Object(i.e)({className:I.icon},o)),F&&s.createElement("button",{className:I.revealButton,onClick:this._onRevealButtonClick,type:"button"},s.createElement("span",{className:I.revealSpan},s.createElement(u.e,{className:I.revealIcon,iconName:B?"Hide":"RedEye"}))),(void 0!==w||this.props.onRenderSuffix)&&s.createElement("div",{className:I.suffix},A(this.props,this._onRenderSuffix)))),this._isDescriptionAvailable&&s.createElement("span",{id:this._descriptionId},D(this.props,this._onRenderDescription),j&&s.createElement("div",{role:"alert"},s.createElement(h.e,null,s.createElement("p",{className:I.errorMessage},s.createElement("span",{"data-automation-id":"error-message"},j))))))};t.prototype.focus=function(){this._textElement.current&&this._textElement.current.focus()};t.prototype.blur=function(){this._textElement.current&&this._textElement.current.blur()};t.prototype.select=function(){this._textElement.current&&this._textElement.current.select()};t.prototype.setSelectionStart=function(e){this._textElement.current&&(this._textElement.current.selectionStart=e)};t.prototype.setSelectionEnd=function(e){this._textElement.current&&(this._textElement.current.selectionEnd=e)};Object.defineProperty(t.prototype,"selectionStart",{get:function(){return this._textElement.current?this._textElement.current.selectionStart:-1},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"selectionEnd",{get:function(){return this._textElement.current?this._textElement.current.selectionEnd:-1},enumerable:!0,configurable:!0});t.prototype.setSelectionRange=function(e,t){this._textElement.current&&this._textElement.current.setSelectionRange(e,t)};t.prototype._warnControlledUsage=function(e){this._id,this.props;if(null===this.props.value&&!this._hasWarnedNullValue){this._hasWarnedNullValue=!0;Object(d.e)("Warning: 'value' prop on 'TextField' should not be null. Consider using an empty string to clear the component or undefined to indicate an uncontrolled component.")}};Object.defineProperty(t.prototype,"_id",{get:function(){return this.props.id||this._fallbackId},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isControlled",{get:function(){return Object(v.e)(this.props,"value")},enumerable:!0,configurable:!0});t.prototype._onRenderPrefix=function(e){var t=e.prefix;return s.createElement("span",{style:{paddingBottom:"1px"}},t)};t.prototype._onRenderSuffix=function(e){var t=e.suffix;return s.createElement("span",{style:{paddingBottom:"1px"}},t)};Object.defineProperty(t.prototype,"_errorMessage",{get:function(){var e=this.props.errorMessage;return(void 0===e?this.state.errorMessage:e)||""},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isDescriptionAvailable",{get:function(){var e=this.props;return!!(e.onRenderDescription||e.description||this._errorMessage)},enumerable:!0,configurable:!0});t.prototype._renderTextArea=function(){var e=Object(m.u)(this.props,m.w,["defaultValue"]),t=this.props["aria-labelledby"]||(this.props.label?this._labelId:void 0);return s.createElement("textarea",Object(i.e)({id:this._id},e,{ref:this._textElement,value:this.value||"",onInput:this._onInputChange,onChange:this._onInputChange,className:this._classNames.field,"aria-labelledby":t,"aria-describedby":this._isDescriptionAvailable?this._descriptionId:this.props["aria-describedby"],"aria-invalid":!!this._errorMessage,"aria-label":this.props.ariaLabel,readOnly:this.props.readOnly,onFocus:this._onFocus,onBlur:this._onBlur}))};t.prototype._renderInput=function(){var e,t=Object(m.u)(this.props,m.h,["defaultValue","type"]),n=this.props["aria-labelledby"]||(this.props.label?this._labelId:void 0),r=this.state.isRevealingPassword?"text":null!=(e=this.props.type)?e:"text";return s.createElement("input",Object(i.e)({type:r,id:this._id,"aria-labelledby":n},t,{ref:this._textElement,value:this.value||"",onInput:this._onInputChange,onChange:this._onInputChange,className:this._classNames.field,"aria-label":this.props.ariaLabel,"aria-describedby":this._isDescriptionAvailable?this._descriptionId:this.props["aria-describedby"],"aria-invalid":!!this._errorMessage,readOnly:this.props.readOnly,onFocus:this._onFocus,onBlur:this._onBlur}))};t.prototype._validate=function(e){var t=this;if(this._latestValidateValue!==e||!S(this.props)){this._latestValidateValue=e;var n=this.props.onGetErrorMessage,r=n&&n(e||"");if(void 0!==r)if("string"!=typeof r&&"then"in r){var i=++this._lastValidation;r.then(function(n){i===t._lastValidation&&t.setState({errorMessage:n});t._notifyAfterValidate(e,n)})}else{this.setState({errorMessage:r});this._notifyAfterValidate(e,r)}else this._notifyAfterValidate(e,"")}};t.prototype._notifyAfterValidate=function(e,t){e===this.value&&this.props.onNotifyValidationResult&&this.props.onNotifyValidationResult(t,e)};t.prototype._adjustInputHeight=function(){if(this._textElement.current&&this.props.autoAdjustHeight&&this.props.multiline){var e=this._textElement.current;e.style.height="";e.style.height=e.scrollHeight+"px"}};t.defaultProps={resizable:!0,deferredValidationTime:200,validateOnLoad:!0,canRevealPassword:!1};return t})(s.Component);function E(e,t){var n=e.value,r=void 0===n?t.uncontrolledValue:n;return"number"==typeof r?String(r):r}function S(e){return!(e.validateOnFocusIn||e.validateOnFocusOut)}var x=n(25),T={root:"ms-TextField",description:"ms-TextField-description",errorMessage:"ms-TextField-errorMessage",field:"ms-TextField-field",fieldGroup:"ms-TextField-fieldGroup",prefix:"ms-TextField-prefix",suffix:"ms-TextField-suffix",wrapper:"ms-TextField-wrapper",revealButton:"ms-TextField-reveal",multiline:"ms-TextField--multiline",borderless:"ms-TextField--borderless",underlined:"ms-TextField--underlined",unresizable:"ms-TextField--unresizable",required:"is-required",disabled:"is-disabled",active:"is-active"};function N(e){var t=e.underlined,n=e.disabled,r=e.focused,i=e.theme,s=i.palette,o=i.fonts;return function(){var e;return{root:[t&&n&&{color:s.neutralTertiary},t&&{fontSize:o.medium.fontSize,marginRight:8,paddingLeft:12,paddingRight:0,lineHeight:"22px",height:32},t&&r&&{selectors:(e={},e[x.s]={height:31},e)}]}}}var C=Object(r.e)(w,function(e){var t,n,r,s,o,u,a,f,l,c,h,p,d=e.theme,v=e.className,m=e.disabled,g=e.focused,y=e.required,b=e.multiline,w=e.hasLabel,E=e.borderless,S=e.underlined,C=e.hasIcon,k=e.resizable,L=e.hasErrorMessage,A=e.inputClassName,O=e.autoAdjustHeight,M=e.hasRevealButton,_=d.semanticColors,D=d.effects,P=d.fonts,H=Object(x.x)(T,d),B={background:_.disabledBackground,color:m?_.disabledText:_.inputPlaceholderText,display:"flex",alignItems:"center",padding:"0 10px",lineHeight:1,whiteSpace:"nowrap",flexShrink:0,selectors:(t={},t[x.s]={background:"Window",color:m?"GrayText":"WindowText"},t)},j=[P.medium,{color:_.inputPlaceholderText,opacity:1,selectors:(n={},n[x.s]={color:"GrayText"},n)}],F={color:_.disabledText,selectors:(r={},r[x.s]={color:"GrayText"},r)};return{root:[H.root,P.medium,y&&H.required,m&&H.disabled,g&&H.active,b&&H.multiline,E&&H.borderless,S&&H.underlined,x.j,{position:"relative"},v],wrapper:[H.wrapper,S&&[{display:"flex",borderBottom:"1px solid "+(L?_.errorText:_.inputBorder),width:"100%"},m&&{borderBottomColor:_.disabledBackground,selectors:(s={},s[x.s]=Object(i.e)({borderColor:"GrayText"},Object(x.T)()),s)},!m&&{selectors:{":hover":{borderBottomColor:L?_.errorText:_.inputBorderHovered,selectors:(o={},o[x.s]=Object(i.e)({borderBottomColor:"Highlight"},Object(x.T)()),o)}}},g&&[{position:"relative"},Object(x.k)(L?_.errorText:_.inputFocusBorderAlt,0,"borderBottom")]]],fieldGroup:[H.fieldGroup,x.j,{border:"1px solid "+_.inputBorder,borderRadius:D.roundedCorner2,background:_.inputBackground,cursor:"text",height:32,display:"flex",flexDirection:"row",alignItems:"stretch",position:"relative"},b&&{minHeight:"60px",height:"auto",display:"flex"},!g&&!m&&{selectors:{":hover":{borderColor:_.inputBorderHovered,selectors:(u={},u[x.s]=Object(i.e)({borderColor:"Highlight"},Object(x.T)()),u)}}},g&&!S&&Object(x.k)(L?_.errorText:_.inputFocusBorderAlt,D.roundedCorner2),m&&{borderColor:_.disabledBackground,selectors:(a={},a[x.s]=Object(i.e)({borderColor:"GrayText"},Object(x.T)()),a),cursor:"default"},E&&{border:"none"},E&&g&&{border:"none",selectors:{":after":{border:"none"}}},S&&{flex:"1 1 0px",border:"none",textAlign:"left"},S&&m&&{backgroundColor:"transparent"},L&&!S&&{borderColor:_.errorText,selectors:{"&:hover":{borderColor:_.errorText}}},!w&&y&&{selectors:(f={":before":{content:"'*'",color:_.errorText,position:"absolute",top:-5,right:-10}},f[x.s]={selectors:{":before":{color:"WindowText",right:-14}}},f)}],field:[P.medium,H.field,x.j,{borderRadius:0,border:"none",background:"none",backgroundColor:"transparent",color:_.inputText,padding:"0 8px",width:"100%",minWidth:0,textOverflow:"ellipsis",outline:0,selectors:(l={"&:active, &:focus, &:hover":{outline:0},"::-ms-clear":{display:"none"}},l[x.s]={background:"Window",color:m?"GrayText":"WindowText"},l)},Object(x.L)(j),b&&!k&&[H.unresizable,{resize:"none"}],b&&{minHeight:"inherit",lineHeight:17,flexGrow:1,paddingTop:6,paddingBottom:6,overflow:"auto",width:"100%"},b&&O&&{overflow:"hidden"},C&&!M&&{paddingRight:24},b&&C&&{paddingRight:40},m&&[{backgroundColor:_.disabledBackground,color:_.disabledText,borderColor:_.disabledBackground},Object(x.L)(F)],S&&{textAlign:"left"},g&&!E&&{selectors:(c={},c[x.s]={paddingLeft:11,paddingRight:11},c)},g&&b&&!E&&{selectors:(h={},h[x.s]={paddingTop:4},h)},A],icon:[b&&{paddingRight:24,alignItems:"flex-end"},{pointerEvents:"none",position:"absolute",bottom:6,right:8,top:"auto",fontSize:x.u.medium,lineHeight:18},m&&{color:_.disabledText}],description:[H.description,{color:_.bodySubtext,fontSize:P.xSmall.fontSize}],errorMessage:[H.errorMessage,x.e.slideDownIn20,P.small,{color:_.errorText,margin:0,paddingTop:5,display:"flex",alignItems:"center"}],prefix:[H.prefix,B],suffix:[H.suffix,B],revealButton:[H.revealButton,"ms-Button","ms-Button--icon",{height:30,width:32,border:"none",padding:"0px 4px",backgroundColor:"transparent",color:_.link,selectors:{":hover":{outline:0,color:_.primaryButtonBackgroundHovered,backgroundColor:_.buttonBackgroundHovered,selectors:(p={},p[x.s]={borderColor:"Highlight",color:"Highlight"},p)},":focus":{outline:0}}},C&&{marginRight:28}],revealSpan:{display:"flex",height:"100%",alignItems:"center"},revealIcon:{margin:"0px 4px",pointerEvents:"none",bottom:6,right:8,top:"auto",fontSize:x.u.medium,lineHeight:18},subComponentStyles:{label:N(e)}}},void 0,{scope:"TextField"})},function(e,t,n){"use strict";var r=n(1026),i=(function(){function e(e,t){this.value=e;this.extraClasses=t}e.prototype.getClass=function(){var e=this.value?Object(r.e)(this.value):void 0;0;return"ms-Icon ms-Icon--"+this.value+" "+(e||"")+(this.extraClasses?" "+this.extraClasses:"")};e.prototype.getExtraClasses=function(){return this.extraClasses};e.prototype.toString=function(){return this.value};return e})();t.e=i},function(e,t,n){"use strict";n.d(t,"e",function(){return p});var r=n(0),i=(n(1683),n("react-lib")),s=n(1653),o=n("knockout-lib"),u=n(7),a=n(1687),f=n(1663),l=n(127),c=n(117);function h(e){var t=e.specification,n=e.placeholder,r=Object(c.t)(),u=Object(a.t)(t),h=i.useState(function(){return(function(){var e=document.createElement("div");o.applyBindings({},e);var t=o.contextFor(e);o.removeNode(e);return t})()})[0],p=Object(l.e)(function(t,i){e.onApplyBindings&&e.onApplyBindings(t);return new(r.resolved(s.n))({element:t,valueAccessor:function(){return{specification:u,placeholder:n}},bindingContext:i})});return i.createElement(f.e,{bindingContext:h,applyBindings:p},e.children)}function p(e){var t=e.resources,n=Object(r.__rest)(e,["resources"]),s=i.createElement(h,Object(r.__assign)({},n));return t?i.createElement(c.e,{resources:t},s):s}t.t=p;new u.t({name:"Knockout",factory:new u.e(p)})},,function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n("react-lib"),i={auto:"auto",always:"always"},s=r.createContext({scrollablePane:void 0})},function(e,t,n){"use strict";n.d(t,"e",function(){return v});var r=n(4),i=n("react-lib"),s=n(472),o=n(129),u=n(886),a=n(1503),f=n(1772),l=n(1508),c=n(869),h=n(2013),p=n(1646),d=Object(s.e)(),v=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;n.rootElement=i.createRef();n._onKeyDown=function(e){n.props.onDismiss&&e.which===o.e.escape&&n.props.onDismiss()};Object(u.e)(n);n.state={};return n}t.prototype.componentDidMount=function(){this.props.onDismiss&&document.addEventListener("keydown",this._onKeyDown,!1)};t.prototype.componentWillUnmount=function(){this.props.onDismiss&&document.removeEventListener("keydown",this._onKeyDown)};t.prototype.focus=function(){this.rootElement.current&&this.rootElement.current.focus()};t.prototype.render=function(){var e,t,n,s,o,u=this.props,v=u.children,m=u.illustrationImage,g=u.primaryButtonProps,y=u.secondaryButtonProps,b=u.headline,w=u.hasCondensedHeadline,E=u.hasCloseButton,S=void 0===E?this.props.hasCloseIcon:E,x=u.onDismiss,T=u.closeButtonAriaLabel,N=u.hasSmallHeadline,C=u.isWide,k=u.styles,L=u.theme,A=u.ariaDescribedBy,O=u.ariaLabelledBy,M=u.footerContent,_=u.focusTrapZoneProps,D=d(k,{theme:L,hasCondensedHeadline:w,hasSmallHeadline:N,hasCloseButton:S,hasHeadline:!!b,isWide:C,primaryButtonClassName:g?g.className:void 0,secondaryButtonClassName:y?y.className:void 0});m&&m.src&&(e=i.createElement("div",{className:D.imageContent},i.createElement(c.e,Object(r.e)({},m))));if(b){var P="string"==typeof b?"p":"div";t=i.createElement("div",{className:D.header},i.createElement(P,{role:"heading",className:D.headline,id:O},b))}if(v){var H="string"==typeof v?"p":"div";n=i.createElement("div",{className:D.body},i.createElement(H,{className:D.subText,id:A},v))}(g||y||M)&&(s=i.createElement(h.e,{className:D.footer,horizontal:!0,horizontalAlign:M?"space-between":"end"},i.createElement(h.e.Item,{align:"center"},i.createElement("span",null,M)),i.createElement(h.e.Item,null,y&&i.createElement(a.e,Object(r.e)({},y,{className:D.secondaryButton})),g&&i.createElement(f.e,Object(r.e)({},g,{className:D.primaryButton})))));S&&(o=i.createElement(l.e,{className:D.closeButton,iconProps:{iconName:"Cancel"},title:T,ariaLabel:T,onClick:x}));return i.createElement("div",{className:D.content,ref:this.rootElement,role:"dialog",tabIndex:-1,"aria-labelledby":O,"aria-describedby":A,"data-is-focusable":!0},e,i.createElement(p.e,Object(r.e)({isClickableOutsideFocusTrap:!0},_),i.createElement("div",{className:D.bodyContent},t,n,s,o)))};return t})(i.Component)},,,function(e,t,n){"use strict";var r=n(1914),i=n("knockout-lib"),s=n(1657),o=function(e,t,n){this.key=e||"";this.content=i.observable(new r.e(n));this.content.equalityComparer=s.n;this.schema=i.observableArray([]);this.schema.equalityComparer=s.e;this.context=i.utils.extend({},t);this.contentTypes=i.observableArray([]);this.isPlaceholder=!0;this.version=0};t.e=o},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(1649),i=new(n(7).t)({name:"UseItemsScope.key.useItemsScope",factory:{dependencies:{observablesFactoryType:r.i},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})},,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(1419),i=n(1898),s=n(1822),o=Object(r.e)(i.e,s.e,void 0,{scope:"TeachingBubbleContent"})},,function(e,t,n){"use strict";n.d(t,"e",function(){return Y});var r,i=n(1419),s=n(4),o=n("react-lib"),u=n(1508),a=n(1493),f=n(1806),l=n(1625),c=n(472),h=n(881),p=n(37),d=n(207),v=n(95),m=n(886),g=n(1377),y=n(653),b=n(705),w=n(270),E=n(991),S=n(1646),x=n(1714),T=Object(c.e)();(function(e){e[e.closed=0]="closed";e[e.animatingOpen=1]="animatingOpen";e[e.open=2]="open";e[e.animatingClosed=3]="animatingClosed"})(r||(r={}));var N,C,k,L,A,O=(function(e){Object(s.r)(t,e);function t(t){var n=e.call(this,t)||this;n._panel=o.createRef();n._animationCallback=null;n._hasCustomNavigation=!(!n.props.onRenderNavigation&&!n.props.onRenderNavigationContent);n.dismiss=function(e){n.props.onDismiss&&n.isActive&&n.props.onDismiss(e);(!e||e&&!e.defaultPrevented)&&n.close()};n._allowScrollOnPanel=function(e){e?n._allowTouchBodyScroll?Object(h.e)(e,n._events):Object(h.t)(e,n._events):n._events.off(n._scrollableContent);n._scrollableContent=e};n._onRenderNavigation=function(e){if(!n.props.onRenderNavigationContent&&!n.props.onRenderNavigation&&!n.props.hasCloseButton)return null;var t=n.props.onRenderNavigationContent,r=void 0===t?n._onRenderNavigationContent:t;return o.createElement("div",{className:n._classNames.navigation},r(e,n._onRenderNavigationContent))};n._onRenderNavigationContent=function(e){var t,r=e.closeButtonAriaLabel,i=e.hasCloseButton,s=e.onRenderHeader,a=void 0===s?n._onRenderHeader:s;if(i){var f=null===(t=n._classNames.subComponentStyles)||void 0===t?void 0:t.closeButton();return o.createElement(o.Fragment,null,!n._hasCustomNavigation&&a(n.props,n._onRenderHeader,n._headerTextId),o.createElement(u.e,{styles:f,className:n._classNames.closeButton,onClick:n._onPanelClick,ariaLabel:r,title:r,"data-is-visible":!0,iconProps:{iconName:"Cancel"}}))}return null};n._onRenderHeader=function(e,t,r){var i=e.headerText,u=e.headerTextProps,a=void 0===u?{}:u;return i?o.createElement("div",{className:n._classNames.header},o.createElement("div",Object(s.e)({id:r,role:"heading","aria-level":1},a,{className:Object(p.e)(n._classNames.headerText,a.className)}),i)):null};n._onRenderBody=function(e){return o.createElement("div",{className:n._classNames.content},e.children)};n._onRenderFooter=function(e){var t=n.props.onRenderFooterContent,r=void 0===t?null:t;return r?o.createElement("div",{className:n._classNames.footer},o.createElement("div",{className:n._classNames.footerInner},r())):null};n._animateTo=function(e){e===r.open&&n.props.onOpen&&n.props.onOpen();n._animationCallback=n._async.setTimeout(function(){n.setState({visibility:e});n._onTransitionComplete()},200)};n._clearExistingAnimationTimer=function(){null!==n._animationCallback&&n._async.clearTimeout(n._animationCallback)};n._onPanelClick=function(e){n.dismiss(e)};n._onTransitionComplete=function(){n._updateFooterPosition();n.state.visibility===r.open&&n.props.onOpened&&n.props.onOpened();n.state.visibility===r.closed&&n.props.onDismissed&&n.props.onDismissed()};var i=n.props.allowTouchBodyScroll,a=void 0!==i&&i;n._allowTouchBodyScroll=a;n._async=new d.e(n);n._events=new v.e(n);Object(m.e)(n);Object(g.e)("Panel",t,{ignoreExternalFocusing:"focusTrapZoneProps",forceFocusInsideTrap:"focusTrapZoneProps",firstFocusableSelector:"focusTrapZoneProps"});n.state={isFooterSticky:!1,visibility:r.closed,id:Object(y.e)("Panel")};return n}t.getDerivedStateFromProps=function(e,t){return void 0===e.isOpen?null:!e.isOpen||t.visibility!==r.closed&&t.visibility!==r.animatingClosed?e.isOpen||t.visibility!==r.open&&t.visibility!==r.animatingOpen?null:{visibility:r.animatingClosed}:{visibility:r.animatingOpen}};t.prototype.componentDidMount=function(){this._events.on(window,"resize",this._updateFooterPosition);this._shouldListenForOuterClick(this.props)&&this._events.on(document.body,"mousedown",this._dismissOnOuterClick,!0);this.props.isOpen&&this.setState({visibility:r.animatingOpen})};t.prototype.componentDidUpdate=function(e,t){var n=this._shouldListenForOuterClick(this.props),i=this._shouldListenForOuterClick(e);if(this.state.visibility!==t.visibility){this._clearExistingAnimationTimer();this.state.visibility===r.animatingOpen?this._animateTo(r.open):this.state.visibility===r.animatingClosed&&this._animateTo(r.closed)}n&&!i?this._events.on(document.body,"mousedown",this._dismissOnOuterClick,!0):!n&&i&&this._events.off(document.body,"mousedown",this._dismissOnOuterClick,!0)};t.prototype.componentWillUnmount=function(){this._async.dispose();this._events.dispose()};t.prototype.render=function(){var e=this.props,t=e.className,n=void 0===t?"":t,i=e.elementToFocusOnDismiss,u=e.firstFocusableSelector,c=e.focusTrapZoneProps,h=e.forceFocusInsideTrap,p=e.hasCloseButton,d=e.headerText,v=e.headerClassName,m=void 0===v?"":v,g=e.ignoreExternalFocusing,y=e.isBlocking,E=e.isFooterAtBottom,N=e.isLightDismiss,C=e.isHiddenOnDismiss,k=e.layerProps,L=e.overlayProps,A=e.popupProps,O=e.type,M=e.styles,_=e.theme,D=e.customWidth,P=e.onLightDismissClick,H=void 0===P?this._onPanelClick:P,B=e.onRenderNavigation,j=void 0===B?this._onRenderNavigation:B,F=e.onRenderHeader,I=void 0===F?this._onRenderHeader:F,q=e.onRenderBody,R=void 0===q?this._onRenderBody:q,U=e.onRenderFooter,z=void 0===U?this._onRenderFooter:U,W=this.state,X=W.isFooterSticky,V=W.visibility,$=W.id,J=O===x.e.smallFixedNear||O===x.e.customNear,K=Object(b.e)(_)?J:!J,Q=O===x.e.custom||O===x.e.customNear?{width:D}:{},G=Object(w.u)(this.props,w.s),Y=this.isActive,Z=V===r.animatingClosed||V===r.animatingOpen;this._headerTextId=d&&$+"-headerText";if(!Y&&!Z&&!C)return null;this._classNames=T(M,{theme:_,className:n,focusTrapZoneClassName:c?c.className:void 0,hasCloseButton:p,headerClassName:m,isAnimating:Z,isFooterSticky:X,isFooterAtBottom:E,isOnRightSide:K,isOpen:Y,isHiddenOnDismiss:C,type:O,hasCustomNavigation:this._hasCustomNavigation});var ee,te=this._classNames,ne=this._allowTouchBodyScroll;y&&Y&&(ee=o.createElement(f.e,Object(s.e)({className:te.overlay,isDarkThemed:!1,onClick:N?H:void 0,allowTouchBodyScroll:ne},L)));return o.createElement(a.e,Object(s.e)({},k),o.createElement(l.e,Object(s.e)({role:"dialog","aria-modal":"true",ariaLabelledBy:this._headerTextId?this._headerTextId:void 0,onDismiss:this.dismiss,className:te.hiddenPanel},A),o.createElement("div",Object(s.e)({"aria-hidden":!Y&&Z},G,{ref:this._panel,className:te.root}),ee,o.createElement(S.e,Object(s.e)({ignoreExternalFocusing:g,forceFocusInsideTrap:!(!y||C&&!Y)&&h,firstFocusableSelector:u,isClickableOutsideFocusTrap:!0},c,{className:te.main,style:Q,elementToFocusOnDismiss:i}),o.createElement("div",{className:te.commands,"data-is-visible":!0},j(this.props,this._onRenderNavigation)),o.createElement("div",{className:te.contentInner},(this._hasCustomNavigation||!p)&&I(this.props,this._onRenderHeader,this._headerTextId),o.createElement("div",{ref:this._allowScrollOnPanel,className:te.scrollableContent,"data-is-scrollable":!0},R(this.props,this._onRenderBody)),z(this.props,this._onRenderFooter))))))};t.prototype.open=function(){void 0===this.props.isOpen&&(this.isActive||this.setState({visibility:r.animatingOpen}))};t.prototype.close=function(){void 0===this.props.isOpen&&this.isActive&&this.setState({visibility:r.animatingClosed})};Object.defineProperty(t.prototype,"isActive",{get:function(){return this.state.visibility===r.open||this.state.visibility===r.animatingOpen},enumerable:!0,configurable:!0});t.prototype._shouldListenForOuterClick=function(e){return!!e.isBlocking&&!!e.isOpen};t.prototype._updateFooterPosition=function(){var e=this._scrollableContent;if(e){var t=e.clientHeight,n=e.scrollHeight;this.setState({isFooterSticky:t<n})}};t.prototype._dismissOnOuterClick=function(e){var t=this._panel.current;this.isActive&&t&&!e.defaultPrevented&&(Object(E.e)(t,e.target)||(this.props.onOuterClick?this.props.onOuterClick(e):this.dismiss(e)))};t.defaultProps={isHiddenOnDismiss:!1,isOpen:void 0,isBlocking:!0,hasCloseButton:!0,type:x.e.smallFixedFar};return t})(o.Component),M=n(25),_={root:"ms-Panel",main:"ms-Panel-main",commands:"ms-Panel-commands",contentInner:"ms-Panel-contentInner",scrollableContent:"ms-Panel-scrollableContent",navigation:"ms-Panel-navigation",closeButton:"ms-Panel-closeButton ms-PanelAction-close",header:"ms-Panel-header",headerText:"ms-Panel-headerText",content:"ms-Panel-content",footer:"ms-Panel-footer",footerInner:"ms-Panel-footerInner",isOpen:"is-open",hasCloseButton:"ms-Panel--hasCloseButton",smallFluid:"ms-Panel--smFluid",smallFixedNear:"ms-Panel--smLeft",smallFixedFar:"ms-Panel--sm",medium:"ms-Panel--md",large:"ms-Panel--lg",largeFixed:"ms-Panel--fixed",extraLarge:"ms-Panel--xl",custom:"ms-Panel--custom",customNear:"ms-Panel--customLeft"},D="100%",P="auto",H=272,B=340,j=592,F=644,I=940,q="auto",R=0,U=48,z=428,W=176,X=((N={})["@media (min-width: "+M.h+"px)"]={width:B},N),V=((C={})["@media (min-width: "+M.c+"px)"]={width:j},C["@media (min-width: "+M.v+"px)"]={width:F},C),$=((k={})["@media (min-width: "+M.d+"px)"]={left:U,width:P},k["@media (min-width: "+M.m+"px)"]={left:z},k),J=((L={})["@media (min-width: "+M.m+"px)"]={left:q,width:I},L),K=((A={})["@media (min-width: "+M.m+"px)"]={left:W},A),Q=function(e){var t;switch(e){case x.e.smallFixedFar:t=Object(s.e)({},X);break;case x.e.medium:t=Object(s.e)(Object(s.e)({},X),V);break;case x.e.large:t=Object(s.e)(Object(s.e)(Object(s.e)({},X),V),$);break;case x.e.largeFixed:t=Object(s.e)(Object(s.e)(Object(s.e)(Object(s.e)({},X),V),$),J);break;case x.e.extraLarge:t=Object(s.e)(Object(s.e)(Object(s.e)(Object(s.e)({},X),V),$),K)}return t},G={paddingLeft:"24px",paddingRight:"24px"},Y=Object(i.e)(O,function(e){var t,n=e.className,r=e.focusTrapZoneClassName,i=e.hasCloseButton,o=e.headerClassName,u=e.isAnimating,a=e.isFooterSticky,f=e.isFooterAtBottom,l=e.isOnRightSide,c=e.isOpen,h=e.isHiddenOnDismiss,p=e.hasCustomNavigation,d=e.theme,v=e.type,m=void 0===v?x.e.smallFixedFar:v,g=d.effects,y=d.fonts,b=d.semanticColors,w=Object(M.x)(_,d),E=m===x.e.custom||m===x.e.customNear;return{root:[w.root,d.fonts.medium,c&&w.isOpen,i&&w.hasCloseButton,{pointerEvents:"none",position:"absolute",top:0,left:0,right:0,bottom:0},E&&l&&w.custom,E&&!l&&w.customNear,n],overlay:[{pointerEvents:"auto",cursor:"pointer"},c&&u&&M.e.fadeIn100,!c&&u&&M.e.fadeOut100],hiddenPanel:[!c&&!u&&h&&{visibility:"hidden"}],main:[w.main,{backgroundColor:b.bodyBackground,boxShadow:g.elevation64,pointerEvents:"auto",position:"absolute",display:"flex",flexDirection:"column",overflowX:"hidden",overflowY:"auto",WebkitOverflowScrolling:"touch",bottom:0,top:0,left:q,right:R,width:D,selectors:Object(s.e)((t={},t[M.s]={borderLeft:"3px solid "+b.variantBorder,borderRight:"3px solid "+b.variantBorder},t),Q(m))},m===x.e.smallFluid&&{left:R},m===x.e.smallFixedNear&&{left:R,right:q,width:H},m===x.e.customNear&&{right:"auto",left:0},E&&{maxWidth:"100vw"},c&&u&&!l&&M.e.slideRightIn40,c&&u&&l&&M.e.slideLeftIn40,!c&&u&&!l&&M.e.slideLeftOut40,!c&&u&&l&&M.e.slideRightOut40,r],commands:[w.commands,{marginTop:18},p&&{marginTop:"inherit"}],navigation:[w.navigation,{display:"flex",justifyContent:"flex-end"},p&&{height:"44px"}],contentInner:[w.contentInner,{display:"flex",flexDirection:"column",flexGrow:1,overflowY:"hidden"}],header:[w.header,G,{alignSelf:"flex-start"},i&&!p&&{flexGrow:1},p&&{flexShrink:0}],headerText:[w.headerText,y.xLarge,{color:b.bodyText,lineHeight:"27px",overflowWrap:"break-word",wordWrap:"break-word",wordBreak:"break-word",hyphens:"auto"},o],scrollableContent:[w.scrollableContent,{overflowY:"auto"},f&&{flexGrow:1}],content:[w.content,G,{paddingBottom:20}],footer:[w.footer,{flexShrink:0,borderTop:"1px solid transparent",transition:"opacity "+M.n.durationValue3+" "+M.n.easeFunction2},a&&{background:b.bodyBackground,borderTopColor:b.variantBorder}],footerInner:[w.footerInner,G,{paddingBottom:16,paddingTop:16}],subComponentStyles:{closeButton:{root:[w.closeButton,{marginRight:14,color:d.palette.neutralSecondary,fontSize:M.u.large},p&&{marginRight:0,height:"auto",width:"44px"}],rootHovered:{color:d.palette.neutralPrimary}}}}},void 0,{scope:"Panel"})},function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(0),i=n("react-lib"),s=n(1486),o=n(2060),u=n(70),a=n(2133),f=n(1709),l=n(1881),c=n(1835),h=n(138);Object(h.n)([{rawString:".ms-Suggestions{width:260px}\n"}]);var p=n(1841),d=o.e,v=o.t,m=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onResolveSuggestions=function(e){if(n._peoplePickerSearchPromise){n._peoplePickerSearchPromise.cancel();n._peoplePickerSearchPromise=void 0}if((e=e.trim()).length<2)return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions([],e):[];var t=n._dataProvider.search(e.trim(),n._getPeoplePickerQueryParams());if(!t)return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions([],e):[];var r=t.cached?t.cached:[];n._peoplePickerSearchPromise=t.promise;return n._peoplePickerSearchPromise.then(function(e){n._peoplePickerSearchPromise=void 0;return e?r.concat(e):[]}).then(function(t){return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions(t,e):t})};n._onGetMoreResults=function(e){n._onGetMoreResultsClicked&&n._onGetMoreResultsClicked();var t;if(n.props.peoplePickerQueryParams){(t=Object(r.__assign)({},n.props.peoplePickerQueryParams)).useGraph=!1;t.useSubstrate=!1}return n._dataProvider&&n._dataProvider.sharePointSearch&&t?u.t.isActivated("0710ffb7-9cb3-4e9d-8df2-1a413ac7b42b","03/19/2021","Add filter suggestions to show more results")?n._dataProvider.sharePointSearch(e,t):n._dataProvider.sharePointSearch(e,t).then(function(t){if(n.props.onResolvedSuggestions){var r=n.props.onResolvedSuggestions(t,e);if(r instanceof Array)return r}return t}):[]};if(t.dataProvider)n._dataProvider=t.dataProvider;else{if(!t.context)throw new Error("No pageContext available for PeoplePickerProvider.");n._dataProvider=new a.e({pageContext:t.context,peoplePickerDataSource:t.dataSource})}n._handleGetMoreResultsInBaseClass=!!(n._dataProvider.canUseGraph&&n.props.peoplePickerQueryParams&&n._dataProvider.canUseGraph(n.props.peoplePickerQueryParams))&&!n.props.onGetMoreResults;n.state={hasUnresolvedText:!1,searchForMoreText:n._getSearchForMoreText(n._handleGetMoreResultsInBaseClass)};return n}Object.defineProperty(t.prototype,"selectedPeople",{get:function(){return this._peoplePicker&&this._peoplePicker.items||[]},enumerable:!0,configurable:!0});t.prototype.render=function(){var e=this.props,t=e.className,n=e.onRenderItem,s=e.onRenderSuggestionsItem,o=e.defaultSelectedItems,u=e.onSelectedPersonasChange,a=e.suggestionsHeaderText,f=e.suggestionsClassName,h=e.noResultsFoundText,m=e.loadingText,g=e.inputProps,y=e.onSuggestionSelected,b=e.suggestionsAvailableAlertText,w=e.enableSelectedSuggestionAlert,E=e.selectedItems,S=e.itemLimit,x=e.onInputChange,T=e.onGetMoreResults,N=e.searchForMoreText,C=e.ariaLabel,k=void 0===C?"":C,L=e.pickerCalloutProps,A=e.pickerOverrideStyles,O=e.theme,M=e.disabled,_=e.onGetMoreResultsClicked,D=e.removeButtonAriaLabel;this._onGetMoreResultsClicked=_;var P={className:t,onRenderSuggestionsItem:s||l.r,onResolveSuggestions:this._onResolveSuggestions,defaultSelectedItems:o,selectedItems:E,onChange:u,inputProps:g,enableSelectedSuggestionAlert:w,pickerSuggestionsProps:{suggestionsHeaderText:a,loadingText:m,noResultsFoundText:h,className:f,suggestionsAvailableAlertText:b,searchForMoreText:N||(this._handleGetMoreResultsInBaseClass?this.state.searchForMoreText:void 0),suggestionsContainerAriaLabel:p.t},onItemSelected:y,itemLimit:S,onInputChange:x,onGetMoreResults:T||(this._handleGetMoreResultsInBaseClass?this._onGetMoreResults:void 0),pickerCalloutProps:L,styles:A,theme:O,"aria-label":k,disabled:M,removeButtonAriaLabel:D};switch(this.props.peoplePickerType){case c.e.listBelow:P.onRenderItem=n||l.e;return i.createElement(v,Object(r.__assign)({},P,{componentRef:this._resolveRef("_peoplePicker")}));default:P.onRenderItem=n||l.t;return i.createElement(d,Object(r.__assign)({},P,{componentRef:this._resolveRef("_peoplePicker")}))}};t.prototype.focusInput=function(){this._peoplePicker&&this._peoplePicker.focusInput()};t.prototype._getPeoplePickerQueryParams=function(){if(this.props.peoplePickerQueryParams){!this.props.peoplePickerQueryParams.onToggleGetMoreResults&&this._handleGetMoreResultsInBaseClass&&(this.props.peoplePickerQueryParams.onToggleGetMoreResults=this._onToggleGetMoreResults);return this.props.peoplePickerQueryParams}return{allowEmailAddresses:!1,groupID:0,maximumEntitySuggestions:30,principalSource:15,blockExternalUsers:!0,principalType:f.e.user|f.e.securityGroup|f.e.sharePointGroup}};t.prototype._onToggleGetMoreResults=function(e){this.state&&(e&&!this.state.searchForMoreText||!e&&this.state.searchForMoreText)&&this.setState({searchForMoreText:this._getSearchForMoreText(e)})};t.prototype._getSearchForMoreText=function(e){return e?p.r:void 0};return t})(s.e)},function(e,t,n){"use strict";var r=function(e){this.items=new Array(e||0);this.groupings=null;this.partialResultRequestCount=0;this.partialResultStatus=0};t.e=r},function(e,t,n){"use strict";n.r(t);n.d(t,"shareFocusItemResourceKey",function(){return u});n.d(t,"copyLinkFocusItemResourceKey",function(){return a});n.d(t,"copyFormLinkFocusItemResourceKey",function(){return f});n.d(t,"shareFromDetailPaneFocusItemResourceKey",function(){return l});n.d(t,"shareFromGrantAccessItemResourceKey",function(){return c});n.d(t,"hasFollowedAnItemKey",function(){return h});var r=n(1649),i=n(1657),s=n(7),o=function(e){return{dependencies:{observablesFactoryType:r.i},create:function(t){var n=new(0,t.observablesFactoryType)({}),r=n.create();e&&(r.equalityComparer=i.n);return{instance:r,disposable:n}}}},u=new s.t({name:"ShareCommandKeys.shareFocusItem",factory:o(!0)}),a=new s.t({name:"ShareCommandKeys.copyLinkFocusItem",factory:o()}),f=new s.t({name:"ShareCommandKeys.copyFormLinkFocusItem",factory:o()}),l=new s.t({name:"ShareCommandKeys.copyLinkFocusItem",factory:o()}),c=new s.t({name:"ShareCommandKeys.shareFromGrantAccess",factory:o()}),h=new s.t({name:"ShareCommandKeys.hasFollowedAnItemKey",factory:{dependencies:{observablesFactoryType:r.i},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})},,function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return c});var r,i=n(0),s=n(133),o=n(2090),u=n(2367),a=n(2504),f=n(2298),l=n(1725);(function(e){e.Opening="Opening";e.Opened="Opened";e.Completed="Completed"})(r||(r={}));var c=(function(){function e(e,t){this._manager=e;this._extraData=t}e.prototype.setEngagementExtraData=function(e){this._extraData=Object(i.__assign)(Object(i.__assign)({},this._extraData),e)};e.prototype.linkSettingsOpened=function(e){this.log("LinkSettings.Opened",e)};e.prototype.linkSettingsApplyClicked=function(e){this.log("LinkSettings.ApplyClicked",e)};e.prototype.linkSettingsCancelClicked=function(e){this.log("LinkSettings.CancelClicked",e)};e.prototype.linkSettingsLearnMoreClicked=function(e){this.log("LinkSettings.LearnMoreClicked",e)};e.prototype.linkSettingsOnAllowEditingClicked=function(e){this.log("LinkSettings.AllowEditingClicked",e)};e.prototype.linkTrackLinkClicked=function(e){this.log("LinkSettings.TrackLinkClicked",e)};e.prototype.linkSettingsLinkTypeChanged=function(e){this.log("LinkSettings.LinkTypeChanged",e)};e.prototype.manageAccessOpened=function(e){this.log("ManageAccess.Opened",e)};e.prototype.manageAccessAddressBarLinkTypeClicked=function(e){this.log("ManageAccess.AddressBarLinkTypeClicked",e)};e.prototype.manageAccessFacePileClicked=function(e){this.log("ManageAccess.FacePileClicked",e)};e.prototype.manageAccessRemoveDirectAccess=function(e){this.log("ManageAccess.RemoveDirectAccess",e)};e.prototype.shareCompleted=function(e){this.log("Completed",e)};e.prototype.sendACopyClicked=function(e){this.log("SendACopy.Clicked",e)};e.prototype.sendACopyOfficeClicked=function(e){this.log("SendACopy.OfficeClicked",e)};e.prototype.sendACopyPdfClicked=function(e){this.log("SendACopy.PdfClicked",e)};e.prototype.whoElseHasAccessClicked=function(e){this.log("WhoElseHasAccess.Clicked",e)};e.prototype.externalSharingCslError=function(e){this.log("externalSharingCslError",e)};e.prototype.copyLinkInterruptOpened=function(e){this.log("copyLinkInterruptOpened",e)};e.prototype.copyLinkInterruptEditLinkChosen=function(e){this.log("copyLinkInterruptEditLinkChosen",e)};e.prototype.copyLinkInterruptExistingLinkChosen=function(e){this.log("copyLinkInterruptExistingLinkChosen",e)};e.prototype.copyLinkInterruptCancelled=function(e){this.log("copyLinkInterruptCancelled",e)};e.prototype.shareErrorFileIsUploading=function(e){this.log("shareError.FileUploading",e)};e.prototype.peoplePickerLinkedinSuggestions=function(e,t){this.log("PeoplePicker.Suggestions",Object(i.__assign)(Object(i.__assign)({},e),{linkedinSuggestionsCount:l.t(t)}))};e.prototype.logEvent=function(e,t){this.log(r[e],t)};e.prototype.log=function(e,t){var n=Object(i.__assign)(Object(i.__assign)({},this._extraData),t),r=location.href.toLowerCase().indexOf("sharedialog.aspx")>=0,l=Object(i.__assign)(Object(i.__assign)({},n),{clientId:o.e[n.clientId],scenarioId:n.scenarioId,mode:u.e[n.mode],shareType:a.e[n.shareType],audience:f.e[n.audience],shareTargets:this._getFriendlyShareTargets(n.shareTargets),isShareDialogASPXHosted:r}),c={name:"ShareV3."+e,webTemplateId:n.webTemplateId?n.webTemplateId.toString():void 0,docId:n.itemUniqueId,extraData:l};(this._manager?s.e.withManager(this._manager):s.e).logData(c)};e.prototype._getFriendlyShareTargets=function(e){var t=[];if(e)for(var n=0,r=e;n<r.length;n++){var i=r[n];t.push(a.e[i])}return t};return e})()},,function(e,t,n){"use strict";n.d(t,"e",function(){return w});var r=n(4),i=n("react-lib"),s=n(886),o=n(207),u=n(95),a=n(881),f=n(270),l=n(37),c=n(269),h=n(1372),p=n(91),d=n(1778),v=n(1466),m={top:-1,bottom:-1,left:-1,right:-1,width:0,height:0},g=function(e){return e.getBoundingClientRect()},y=g,b=g,w=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;n._root=i.createRef();n._surface=i.createRef();n._pageRefs={};n._getDerivedStateFromProps=function(e,t){if(e.items!==n.props.items||e.renderCount!==n.props.renderCount||e.startIndex!==n.props.startIndex||e.version!==n.props.version){n._resetRequiredWindows();n._requiredRect=null;n._measureVersion++;n._invalidatePageCache();return n._updatePages(e,t)}return t};n._onRenderRoot=function(e){var t=e.rootRef,n=e.surfaceElement,s=e.divProps;return i.createElement("div",Object(r.e)({ref:t},s),n)};n._onRenderSurface=function(e){var t=e.surfaceRef,n=e.pageElements,s=e.divProps;return i.createElement("div",Object(r.e)({ref:t},s),n)};n._onRenderPage=function(e,t){for(var s=n.props,o=s.onRenderCell,u=s.role,a=e.page,f=a.items,l=void 0===f?[]:f,c=a.startIndex,h=Object(r.s)(e,["page"]),p=void 0===u?"listitem":"presentation",d=[],v=0;v<l.length;v++){var m=c+v,g=l[v],y=n.props.getKey?n.props.getKey(g,m):g&&g.key;null==y&&(y=m);d.push(i.createElement("div",{role:p,className:"ms-List-cell",key:y,"data-list-index":m,"data-automationid":"ListCell"},o&&o(g,m,n.props.ignoreScrollingState?void 0:n.state.isScrolling)))}return i.createElement("div",Object(r.e)({},h),d)};Object(s.e)(n);n.state={pages:[],isScrolling:!1,getDerivedStateFromProps:n._getDerivedStateFromProps};n._async=new o.e(n);n._events=new u.e(n);n._estimatedPageHeight=0;n._totalEstimates=0;n._requiredWindowsAhead=0;n._requiredWindowsBehind=0;n._measureVersion=0;n._onAsyncScroll=n._async.debounce(n._onAsyncScroll,100,{leading:!1,maxWait:500});n._onAsyncIdle=n._async.debounce(n._onAsyncIdle,200,{leading:!1});n._onAsyncResize=n._async.debounce(n._onAsyncResize,16,{leading:!1});n._onScrollingDone=n._async.debounce(n._onScrollingDone,500,{leading:!1});n._cachedPageHeights={};n._estimatedPageHeight=0;n._focusedIndex=-1;n._pageCache={};return n}t.getDerivedStateFromProps=function(e,t){return t.getDerivedStateFromProps(e,t)};Object.defineProperty(t.prototype,"pageRefs",{get:function(){return this._pageRefs},enumerable:!0,configurable:!0});t.prototype.scrollToIndex=function(e,t,n){void 0===n&&(n=d.e.auto);for(var r=this.props.startIndex,i=r+this._getRenderCount(),s=this._allowedRect,o=0,u=1,a=r;a<i;a+=u){var f=this._getPageSpecification(a,s),l=f.height;u=f.itemCount;if(a<=e&&a+u>e){if(t&&this._scrollElement){for(var c=b(this._scrollElement),h={top:this._scrollElement.scrollTop,bottom:this._scrollElement.scrollTop+c.height},p=e-a,v=0;v<p;++v)o+=t(a+v);var m=o+t(e);switch(n){case d.e.top:this._scrollElement.scrollTop=o;return;case d.e.bottom:this._scrollElement.scrollTop=m-c.height;return;case d.e.center:this._scrollElement.scrollTop=(o+m-c.height)/2;return;case d.e.auto:}if(o>=h.top&&m<=h.bottom)return;o<h.top||m>h.bottom&&(o=m-c.height)}this._scrollElement.scrollTop=o;return}o+=l}};t.prototype.getStartItemIndexInView=function(e){for(var t=0,n=this.state.pages||[];t<n.length;t++){var r=n[t];if(!r.isSpacer&&(this._scrollTop||0)>=r.top&&(this._scrollTop||0)<=r.top+r.height){if(!e){var i=Math.floor(r.height/r.itemCount);return r.startIndex+Math.floor((this._scrollTop-r.top)/i)}for(var s=0,o=r.startIndex;o<r.startIndex+r.itemCount;o++){i=e(o);if(r.top+s<=this._scrollTop&&this._scrollTop<r.top+s+i)return o;s+=i}}}return 0};t.prototype.componentDidMount=function(){this.setState(this._updatePages(this.props,this.state));this._measureVersion++;this._scrollElement=Object(a.i)(this._root.current);this._events.on(window,"resize",this._onAsyncResize);this._root.current&&this._events.on(this._root.current,"focus",this._onFocus,!0);if(this._scrollElement){this._events.on(this._scrollElement,"scroll",this._onScroll);this._events.on(this._scrollElement,"scroll",this._onAsyncScroll)}};t.prototype.componentDidUpdate=function(e,t){var n=this.props,r=this.state;if(this.state.pagesVersion!==t.pagesVersion){if(n.getPageHeight)this._onAsyncIdle();else{if(this._updatePageMeasurements(r.pages)){this._materializedRect=null;if(this._hasCompletedFirstRender)this._onAsyncScroll();else{this._hasCompletedFirstRender=!0;this.setState(this._updatePages(n,r))}}else this._onAsyncIdle()}n.onPagesUpdated&&n.onPagesUpdated(r.pages)}};t.prototype.componentWillUnmount=function(){this._async.dispose();this._events.dispose();delete this._scrollElement};t.prototype.shouldComponentUpdate=function(e,t){var n=this.state.pages,r=t.pages,i=!1;if(!t.isScrolling&&this.state.isScrolling)return!0;if(e.version!==this.props.version)return!0;if(e.items===this.props.items&&n.length===r.length)for(var s=0;s<n.length;s++){var o=n[s],u=r[s];if(o.key!==u.key||o.itemCount!==u.itemCount){i=!0;break}}else i=!0;return i};t.prototype.forceUpdate=function(){this._invalidatePageCache();this._updateRenderRects(this.props,this.state,!0);this.setState(this._updatePages(this.props,this.state));this._measureVersion++;e.prototype.forceUpdate.call(this)};t.prototype.getTotalListHeight=function(){return this._surfaceRect.height};t.prototype.render=function(){for(var e=this.props,t=e.className,n=e.role,i=void 0===n?"list":n,s=e.onRenderSurface,o=e.onRenderRoot,u=this.state.pages,a=void 0===u?[]:u,c=[],h=Object(f.u)(this.props,f.s),p=0,d=a;p<d.length;p++){var m=d[p];c.push(this._renderPage(m))}var g=s?Object(v.e)(s,this._onRenderSurface):this._onRenderSurface;return(o?Object(v.e)(o,this._onRenderRoot):this._onRenderRoot)({rootRef:this._root,pages:a,surfaceElement:g({surfaceRef:this._surface,pages:a,pageElements:c,divProps:{role:"presentation",className:"ms-List-surface"}}),divProps:Object(r.e)(Object(r.e)({},h),{className:Object(l.e)("ms-List",t),role:c.length>0?i:void 0})})};t.prototype._shouldVirtualize=function(e){void 0===e&&(e=this.props);var t=e.onShouldVirtualize;return!t||t(e)};t.prototype._invalidatePageCache=function(){this._pageCache={}};t.prototype._renderPage=function(e){var t,n=this,r=this.props.usePageCache;if(r&&(t=this._pageCache[e.key])&&t.pageElement)return t.pageElement;var i=this._getPageStyle(e),s=this.props.onRenderPage,o=(void 0===s?this._onRenderPage:s)({page:e,className:"ms-List-page",key:e.key,ref:function(t){n._pageRefs[e.key]=t},style:i,role:"presentation"},this._onRenderPage);r&&0===e.startIndex&&(this._pageCache[e.key]={page:e,pageElement:o});return o};t.prototype._getPageStyle=function(e){var t=this.props.getPageStyle;return Object(r.e)(Object(r.e)({},t?t(e):{}),e.items?{}:{height:e.height})};t.prototype._onFocus=function(e){for(var t=e.target;t!==this._surface.current;){var n=t.getAttribute("data-list-index");if(n){this._focusedIndex=Number(n);break}t=Object(c.e)(t)}};t.prototype._onScroll=function(){this.state.isScrolling||this.props.ignoreScrollingState||this.setState({isScrolling:!0});this._resetRequiredWindows();this._onScrollingDone()};t.prototype._resetRequiredWindows=function(){this._requiredWindowsAhead=0;this._requiredWindowsBehind=0};t.prototype._onAsyncScroll=function(){this._updateRenderRects(this.props,this.state);this._materializedRect&&(e=this._requiredRect,t=this._materializedRect,e.top>=t.top&&e.left>=t.left&&e.bottom<=t.bottom&&e.right<=t.right)||this.setState(this._updatePages(this.props,this.state));var e,t};t.prototype._onAsyncIdle=function(){var e=this.props,t=e.renderedWindowsAhead,n=e.renderedWindowsBehind,r=this._requiredWindowsAhead,i=this._requiredWindowsBehind,s=Math.min(t,r+1),o=Math.min(n,i+1);if(s!==r||o!==i){this._requiredWindowsAhead=s;this._requiredWindowsBehind=o;this._updateRenderRects(this.props,this.state);this.setState(this._updatePages(this.props,this.state))}(t>s||n>o)&&this._onAsyncIdle()};t.prototype._onScrollingDone=function(){this.props.ignoreScrollingState||this.setState({isScrolling:!1})};t.prototype._onAsyncResize=function(){this.forceUpdate()};t.prototype._updatePages=function(e,t){this._requiredRect||this._updateRenderRects(e,t);var n=this._buildPages(e,t),i=t.pages;this._notifyPageChanges(i,n.pages,this.props);return Object(r.e)(Object(r.e)(Object(r.e)({},t),n),{pagesVersion:{}})};t.prototype._notifyPageChanges=function(e,t,n){var r=n.onPageAdded,i=n.onPageRemoved;if(r||i){for(var s={},o=0,u=e;o<u.length;o++){(l=u[o]).items&&(s[l.startIndex]=l)}for(var a=0,f=t;a<f.length;a++){var l;(l=f[a]).items&&(s[l.startIndex]?delete s[l.startIndex]:this._onPageAdded(l))}for(var c in s)s.hasOwnProperty(c)&&this._onPageRemoved(s[c])}};t.prototype._updatePageMeasurements=function(e){var t=!1;if(!this._shouldVirtualize())return t;for(var n=0;n<e.length;n++){var r=e[n];r.items&&(t=this._measurePage(r)||t)}return t};t.prototype._measurePage=function(e){var t=!1,n=this._pageRefs[e.key],r=this._cachedPageHeights[e.startIndex];if(n&&this._shouldVirtualize()&&(!r||r.measureVersion!==this._measureVersion)){var i={width:n.clientWidth,height:n.clientHeight};if(i.height||i.width){t=e.height!==i.height;e.height=i.height;this._cachedPageHeights[e.startIndex]={height:i.height,measureVersion:this._measureVersion};this._estimatedPageHeight=Math.round((this._estimatedPageHeight*this._totalEstimates+i.height)/(this._totalEstimates+1));this._totalEstimates++}}return t};t.prototype._onPageAdded=function(e){var t=this.props.onPageAdded;t&&t(e)};t.prototype._onPageRemoved=function(e){var t=this.props.onPageRemoved;t&&t(e)};t.prototype._buildPages=function(e,t){var n=e.renderCount,i=e.items,s=e.startIndex,o=e.getPageHeight;n=this._getRenderCount(e);for(var u=Object(r.e)({},m),a=[],f=1,l=0,c=null,p=this._focusedIndex,d=s+n,v=this._shouldVirtualize(e),g=0===this._estimatedPageHeight&&!o,y=this._allowedRect,b=function(e){var n=w._getPageSpecification(e,y),r=n.height,o=n.data,m=n.key;f=n.itemCount;var b=l+r-1,E=Object(h.r)(t.pages,function(t){return!!t.items&&t.startIndex===e})>-1,S=!y||b>=y.top&&l<=y.bottom,x=!w._requiredRect||b>=w._requiredRect.top&&l<=w._requiredRect.bottom;if(!g&&(x||S&&E)||!v||p>=e&&p<e+f||e===s){if(c){a.push(c);c=null}var T=Math.min(f,d-e),N=w._createPage(m,i.slice(e,e+T),e,void 0,void 0,o);N.top=l;N.height=r;w._visibleRect&&w._visibleRect.bottom&&(N.isVisible=b>=w._visibleRect.top&&l<=w._visibleRect.bottom);a.push(N);x&&w._allowedRect&&(function(e,t){e.top=t.top<e.top||-1===e.top?t.top:e.top;e.left=t.left<e.left||-1===e.left?t.left:e.left;e.bottom=t.bottom>e.bottom||-1===e.bottom?t.bottom:e.bottom;e.right=t.right>e.right||-1===e.right?t.right:e.right;e.width=e.right-e.left+1;e.height=e.bottom-e.top+1})(u,{top:l,bottom:b,height:r,left:y.left,right:y.right,width:y.width})}else{c||(c=w._createPage("spacer-"+e,void 0,e,0,void 0,o,!0));c.height=(c.height||0)+(b-l)+1;c.itemCount+=f}l+=b-l+1;if(g&&v)return"break"},w=this,E=s;E<d;E+=f){if("break"===b(E))break}if(c){c.key="spacer-end";a.push(c)}this._materializedRect=u;return Object(r.e)(Object(r.e)({},t),{pages:a,measureVersion:this._measureVersion})};t.prototype._getPageSpecification=function(e,t){var n=this.props.getPageSpecification;if(n){var r=n(e,t),i=r.itemCount,s=void 0===i?this._getItemCountForPage(e,t):i,o=r.height;return{itemCount:s,height:void 0===o?this._getPageHeight(e,t,s):o,data:r.data,key:r.key}}return{itemCount:s=this._getItemCountForPage(e,t),height:this._getPageHeight(e,t,s)}};t.prototype._getPageHeight=function(e,t,n){if(this.props.getPageHeight)return this.props.getPageHeight(e,t,n);var r=this._cachedPageHeights[e];return r?r.height:this._estimatedPageHeight||30};t.prototype._getItemCountForPage=function(e,t){var n=this.props.getItemCountForPage?this.props.getItemCountForPage(e,t):10;return n||10};t.prototype._createPage=function(e,t,n,r,i,s,o){void 0===n&&(n=-1);void 0===r&&(r=t?t.length:0);void 0===i&&(i={});e=e||"page-"+n;var u=this._pageCache[e];return u&&u.page?u.page:{key:e,startIndex:n,itemCount:r,items:t,style:i,top:0,height:0,data:s,isSpacer:o||!1}};t.prototype._getRenderCount=function(e){var t=e||this.props,n=t.items,r=t.startIndex,i=t.renderCount;return void 0===i?n?n.length-r:0:i};t.prototype._updateRenderRects=function(e,t,n){var i=e.renderedWindowsAhead,s=e.renderedWindowsBehind,o=t.pages;if(this._shouldVirtualize(e)){var u=this._surfaceRect||Object(r.e)({},m),a=this._scrollElement&&this._scrollElement.scrollHeight,f=this._scrollElement?this._scrollElement.scrollTop:0;if(this._surface.current&&(n||!o||!this._surfaceRect||!a||a!==this._scrollHeight||Math.abs(this._scrollTop-f)>this._estimatedPageHeight/3)){u=this._surfaceRect=y(this._surface.current);this._scrollTop=f}!n&&a&&a===this._scrollHeight||this._measureVersion++;this._scrollHeight=a;var l=Math.max(0,-u.top),c=Object(p.e)(this._root.current),h={top:l,left:u.left,bottom:l+c.innerHeight,right:u.right,width:u.width,height:c.innerHeight};this._requiredRect=E(h,this._requiredWindowsBehind,this._requiredWindowsAhead);this._allowedRect=E(h,s,i);this._visibleRect=h}};t.defaultProps={startIndex:0,onRenderCell:function(e,t,n){return i.createElement(i.Fragment,null,e&&e.name||"")},renderedWindowsAhead:2,renderedWindowsBehind:2};return t})(i.Component);function E(e,t,n){var r=e.top-t*e.height,i=e.height+(t+n)*e.height;return{top:r,bottom:r+i,height:i,left:e.left,right:e.right,width:e.width}}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return i});n.d(t,"n",function(){return s});var r={neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8"},i={elevation4:"0 0 5px 0 rgba(0,0,0,.4)",elevation8:"0 0 5px 0 rgba(0,0,0,.4)",elevation16:"0 0 5px 0 rgba(0,0,0,.4)",elevation64:"0 0 5px 0 rgba(0,0,0,.4)",roundedCorner2:"0px",roundedCorner4:"0px",roundedCorner6:"0px"},s={tiny:{fontSize:10,fontWeight:600},xSmall:{fontSize:11,fontWeight:400},small:{fontSize:12,fontWeight:400},smallPlus:{fontSize:13,fontWeight:400},medium:{fontSize:14,fontWeight:400},mediumPlus:{fontSize:15,fontWeight:400},large:{fontSize:17,fontWeight:300},xLarge:{fontSize:21,fontWeight:100},xLargePlus:{fontSize:21,fontWeight:100},xxLarge:{fontSize:28,fontWeight:100},xxLargePlus:{fontSize:28,fontWeight:100},superLarge:{fontSize:42,fontWeight:100},mega:{fontSize:72,fontWeight:100}}},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return i});var r,i;(function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully";e[e.AccessRequestsQueued=1]="AccessRequestsQueued";e[e.Error=2]="Error"})(r||(r={}));(function(e){e[e.UnshareLink=0]="UnshareLink";e[e.ShareLink=1]="ShareLink";e[e.FetchSharingInformation=2]="FetchSharingInformation"})(i||(i={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return u});n.d(t,"n",function(){return a});n.d(t,"t",function(){return f});var r,i,s=n(328),o=n(1688);function u(e){r=Object(s.t)(90076,e);i=Object(s.t)(90069,e)}function a(){if(!r||!o.c())return 0;r.logExposure();return r.variantToDisplay}function f(){if(!i||!o.f())return 0;i.logExposure();return i.variantToDisplay}},,,,,,,function(e,t,n){"use strict";var r='<div class="od-PanelHost" data-bind="foreach:panels">\x3c!--ko component:{name:$parent.overlayTagName,params:{animation:{afterAdd:1,beforeRemove:500},alignToParent:false}}--\x3e\x3c!--ko focusTrap:{}--\x3e<div class="ms-ModalOverlay od-PanelOverlay"></div><div class="od-Panel" role="dialog" tabindex="-1" data-bind="interactionScope:{isScope:true},preserveFocus,recoverFocus:{isEnabled:$host.isOpen},scrollContainer,dismiss:{close:$component.closePanel.bind($component),disableEscape:disableEscape},class:$component.determinePanelCssClass($data)+\' \'+$component.getScrollBarMode($data),css:{\'od-Panel--hasCommandBar\':hasCommandBar,\'od-Panel--hasPadding\':includePadding,\'od-Panel--lightDismiss\':preserveLightDismiss,\'od-Panel--stickyCloseButton\':stickyCloseButton,\'od-Panel--reactSuiteNav\':$component.isReactSuiteNav},attr:{\'aria-label\':title,\'aria-describedby\':elementDescribedBy},element:$parent.contentRoot">\x3c!--ko ifnot:noTitle--\x3e<div class="od-Panel-title" data-bind="text:title,css:{\'ms-fontWeight-semilight\':!$component.isFluentFlight,\'ms-fontWeight-semibold\':$component.isFluentFlight,\'ms-font-xl\':!$component.isFluentFlight}"></div>\x3c!--/ko--\x3e<div class="od-Panel-content" data-bind="component:component,css:{\'od-Panel--hasPadding\':stickyCloseButton&&includePadding,\'od-Panel-content--noTitleFill\':maximizePanelContent&&noTitle,\'od-Panel-content--titleFill\':maximizePanelContent&&!noTitle},clientRect:{size:panelContentSize}"></div>\x3c!--ko if:showCloseButton--\x3e<button class="od-Panel-button od-Panel-button--close" tabindex="0" data-bind="click:$component.closePanel.bind($component),attr:{\'aria-label\':$component.closePanelLabel,title:$component.closePanelLabel},keyboard:{mappings:{Enter:$component.onEnter.bind($component)}}"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>',i=(n(1862),n(1652)),s=n(0),o=n("knockout-lib"),u=n(1651),a=n(1781),f=n(1703),l=n(1659),c=n(46),h=n(1660),p=n(1715),d=n(1662),v=n(1742),m=n(1718),g=n(1789),y=n(1668),b=n(2001),w=n(1677),E=n(1706),S=n(1006),x=n(477),T=(function(e){Object(s.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.closePanelLabel=b.e;r.overlayTagName=E.e.tagName;r.addBindingHandlers({scrollContainer:y.e,dismiss:f.e,element:h.e,focusTrap:p.e,keyboard:d.e,interactionScope:w.t,preserveFocus:v.e,recoverFocus:m.e,clientRect:g.e});r.isFluentFlight=r.resources.consume(S.e);r.contentRoot=o.observable();r._panelProvider=r.resources.consume(a.e);r.panels=r._panelProvider.currentPanels;r.isFluentEnabled=r.resources.consume(S.e);r.isReactSuiteNav=Object(c.isFeatureEnabled)(c.UseReactConsumerShell);return r}t.prototype.onEnter=function(e,t){this.closePanel(e,!0);t.stopPropagation();return!1};t.prototype.closePanel=function(e,t){e.isBlocking&&!t||e.state(1);return!1};t.prototype.determinePanelCssClass=function(e){var t="od-Panel--"+l.e.determineCssClass(e.size);return Object(x.i)()?t+" od-Panel--FullPagePanel":e.overridePanelStyle?t+" "+e.overridePanelStyle:t};t.prototype.getScrollBarMode=function(e){return"od-Panel--"+e.scrollMode+"Scroll"};t.prototype.getClass=function(e){return"od-Panel--"+l.e.determineCssClass(e.size)};return t})(u.t),N=n(1653),C=i.e({tagName:"ms-panel-host",template:r,viewModel:T,synchronous:!0});t.e=C,Object(N.t)({name:"PanelHost",template:r,automationName:"od-panel-host",viewModelType:T})},,,,,,,function(e,t,n){"use strict";var r=n(2055),i=n(1666),s=n(1661),o=n(48),u=n(219),a=n(62),f=n(52),l=n(1867),c=n(1726),h=new RegExp("^Templates$","i"),p=(function(){function e(){}e.isFolder=function(e,t){return t?e&&(e.type===u.e.Folder||e.type===u.e.OneNote):e&&e.type===u.e.Folder};e.isCheckedOut=function(e){return l.e(e)};e.isCheckedOutByUser=function(e,t){return l.n(e,t)};e.isCheckedOutByOther=function(t,n){return e.isCheckedOut(t)&&!e.isCheckedOutByUser(t,n)};e.showCheckedOutByOtherDialog=function(e){return e.requestDialog({title:r.i,component:{name:c.e.tagName,params:{text:r.r}},actions:[{name:i.cancelActionText,execute:function(){return f.n.wrap(2)},icon:new s.e("Cancel"),isDefault:!0}]}).wait().then(function(){return{resultType:o.e.Success}})};e.isPublished=function(t,n){return n.isModerated?t.properties[e.PublishProperty]&&"3"!==t.properties[e.PublishProperty]&&"1"!==t.properties[e.PublishProperty]:0===e.getVersionNoModeration(t,n).minor&&0!==e.getVersionNoModeration(t,n).major};e.needsPublishingReminder=function(t,n){return!e.isPublished(t,n)&&(!e.isPendingApproval(t,n)&&!e.isPageTemplate(t)&&((!t.properties||!t.properties._ScheduledVersion||t.properties.owshiddenversion!==t.properties._ScheduledVersion)&&(a.e.hasItemPermission(t,a.e.editListItems)&&n.enableMinorVersions&&!e.isFolder(t,!0))))};e.isPublishingRelevant=function(t,n){return a.e.hasItemPermission(t,a.e.editListItems)&&n.enableMinorVersions&&!e.isCheckedOut(t)&&!e.isFolder(t,!0)};e.getVersionNoModeration=function(e,t){return t.isModerated?{major:0,minor:0}:this.getVersion(e,t)};e.getVersion=function(t,n){if(t&&t.properties&&t.properties[e.VersionProperty]){var r=Number(t.properties[e.VersionProperty])%512;return{major:Math.floor(Number(t.properties[e.VersionProperty])/512),minor:r}}return{major:0,minor:0}};e.isPendingApproval=function(t,n){return!!n.isModerated&&(t&&t.properties&&t.properties[e.PublishProperty]&&"2"===t.properties[e.PublishProperty])};e.isPageTemplate=function(e){if(!e.id)return!1;var t=e.id.split("/"),n=t.length;return h.test(t[n-2])};e.isApprovalRelevant=function(t,n){return n&&n.isModerated&&!e.isCheckedOut(t)&&a.e.hasItemPermission(t,a.e.editListItems)&&a.e.hasItemPermission(t,a.e.approveItems)};e.FileTypeProperty="FSObjType";e.PublishProperty="_ModerationStatus.";e.VersionProperty="_UIVersion";return e})();t.e=p},function(e,t,n){"use strict";var r;(function(e){e[e.button=0]="button";e[e.link=1]="link"})(r||(r={}));t.e=r},,,,function(e,t,n){"use strict";var r=n(0),i=n(1692),s=n(1686),o=n(1847),u=n(52),a=n(1649),f=n(1963),l=n(1848),c=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.operations=t.operations;n.name="";n.iconName="";n.progress={minimum:n.createObservable(0),maximum:n.createObservable(0),current:n.createObservable(0)};n.batch=t.batch;n.error=n.createObservable();n.count=n.createObservable(0);n._initializeType();n.payloads=n.createPureComputed(n._computePayloads);n.actions=n.createObservable({});n.states=n.createObservable({created:0,started:0,completed:0,failed:0,canceled:0,expired:0});n._initializeOperations();n.state=n.createPureComputed(n._computeState);n.visibility=n.createPureComputed(n._computeVisibility);return n}t.prototype._initializeType=function(){var e=this.addDisposable(l.e.group(this.operations,function(e){return e.type()}));this.type=this.createPureComputed(function(){return 1===e().length&&e()[0].key||i.e.multiple})};t.prototype._computePayloads=function(){var e=this.operations()[0];return e&&e.payloads()||{}};t.prototype._initializeOperations=function(){var e=this;this.addDisposable(this.operations.map({mappingWithDisposeCallback:function(t){var n=e.createPureComputed(function(){return s.e[t.state()]}),r=e.addDisposable(f.t(t.progress.minimum,e.progress.minimum)),i=e.addDisposable(f.t(t.progress.maximum,e.progress.maximum)),o=e.addDisposable(f.t(t.progress.current,e.progress.current)),u=e.addDisposable(f.e(n,e.states)),a=e.addDisposable(f.n(t.error,e.error)),l=e.addDisposable(f.t(t.count,e.count)),c=e.createComputed(function(){var n=!1,r=e.actions.peek();for(var i in t.actions())if(!(i in r)){r[i]=e._initializeAction(i);n=!0}n&&e.actions.valueHasMutated()});return{mappedValue:t,dispose:function(){n.dispose();r.dispose();i.dispose();o.dispose();u.dispose();c.dispose();a.dispose();l.dispose()}}}}))};t.prototype._computeState=function(){var e=this.states();return e.started||e.created&&(e.failed||e.completed||e.canceled)?s.e.started:e.created?s.e.created:e.failed?s.e.failed:e.completed?s.e.completed:e.canceled?s.e.canceled:s.e.expired};t.prototype._computeVisibility=function(){return this.operations().reduce(function(e,t){var n=t.visibility.peek();return n<e?n:e},2)};t.prototype._initializeAction=function(e){var t=this.addDisposable(this.operations.filter(function(t){var n=t.actions()[e];return n&&n.isAvailable()}));return this.addDisposable(new o.e({count:this.createPureComputed(function(){return t().length}),key:e,operation:this,isAvailable:this.createPureComputed(function(){return!!t().length}),onExecute:function(){return u.n.all(t().slice().map(function(t){var n=t.actions.peek()[e];return n&&n.execute()||u.n.wrap()}))}}))};return t})(a.n);t.e=c},,,function(e,t,n){"use strict";n.d(t,"t",function(){return l});n.d(t,"e",function(){return c});var r=n(0),i=n(254),s=n(430),o=n(249),u=n(471),a=n(1920),f=n(1008);function l(e,t,n){var r;i.e.applyBatchedUpdates(function(){r=Object(s.n)(c(e,t))});return r}function c(e,t){t&&o.e.initSPExpFeatures(t.ExpFeatures);u.n.evaluateCanOverride();if(!f.r){e=h({palette:{themePrimary:"#03787c",themeLighterAlt:"#f0f9fa",themeLighter:"#c5e9ea",themeLight:"#98d6d8",themeTertiary:"#49aeb1",themeSecondary:"#13898d",themeDarkAlt:"#026d70",themeDark:"#025c5f",themeDarker:"#014446"}},e)}f.n&&!u.n.isFeatureEnabled(f.e)&&(e=h({effects:a.t},e));f.n&&!u.n.isFeatureEnabled(f.e)&&(e=h({fonts:a.n},e));var n=e.palette;n&&(n.black||n.neutralPrimary||n.white||n.neutralQuaternary)&&!(n.black&&n.white&&n.neutralPrimary&&n.neutralQuaternary&&0===n.black.indexOf("#000")&&0===n.white.toLowerCase().indexOf("#fff")&&0===n.neutralPrimary.indexOf("#333")&&0===n.neutralQuaternary.toLowerCase().indexOf("#d0d0d0"))||(e.palette=Object(r.__assign)(Object(r.__assign)({},e.palette),a.e));return e}function h(e,t){return e=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e),t),{effects:Object(r.__assign)(Object(r.__assign)({},e.effects),t.effects),fonts:Object(r.__assign)(Object(r.__assign)({},e.fonts),t.fonts),palette:Object(r.__assign)(Object(r.__assign)({},e.palette),t.palette)})}},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r,i;function s(e,t){if(!r||i!==e){r=(function(e,t){var n,r=t||window._spPageContextInfo;r&&(n=e.webThemeProvider(r));return n})(e,t);i=e}return r}},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=n(1505).e},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(4),i=n("react-lib"),s=n(472),o=n(886),u=n(1910),a=n(1439),f=n(97),l=Object(s.e)(),c=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;n.rootElement=i.createRef();Object(o.e)(n);n.state={};n._defaultCalloutProps={beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1,directionalHint:f.e.rightCenter};return n}t.prototype.focus=function(){this.rootElement.current&&this.rootElement.current.focus()};t.prototype.render=function(){var e=this.props,t=e.calloutProps,n=e.targetElement,s=e.onDismiss,o=e.hasCloseButton,f=void 0===o?this.props.hasCloseIcon:o,c=e.isWide,h=e.styles,p=e.theme,d=e.target,v=Object(r.e)(Object(r.e)({},this._defaultCalloutProps),t),m={theme:p,isWide:c,calloutProps:Object(r.e)(Object(r.e)({},v),{theme:v.theme}),hasCloseButton:f},g=l(h,m),y=g.subComponentStyles?g.subComponentStyles.callout:void 0;return i.createElement(a.e,Object(r.e)({target:d||n,onDismiss:s},v,{className:g.root,styles:y,hideOverflow:!0}),i.createElement("div",{ref:this.rootElement},i.createElement(u.e,Object(r.e)({},this.props))))};t.defaultProps={calloutProps:{beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1,directionalHint:f.e.rightCenter}};return t})(i.Component)},,,function(e,t,n){"use strict";n.d(t,"e",function(){return k});var r=n(0),i=n(138);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareHint{background:none;margin:16px 16px 0px 16px;position:relative}.isFluent .od-ShareHint{margin:0 16px}.od-ShareHint.od-ShareHint--shimmerFadeout .od-ShareHint-shimmer{opacity:0;visibility:hidden}.od-ShareHint.od-ShareHint--loaded .od-ShareHint-data{opacity:1;line-height:1rem}.od-ShareHint .ms-Label{font-size:.75rem;padding:5px 8px;vertical-align:top}.od-ShareHint .ms-Icon--CaretDownSolid8{vertical-align:top;font-size:.625rem;padding-top:9px;color:"},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:"}.od-ShareHint .od-ShareHint-data,.od-ShareHint .od-ShareHint-shimmer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ShareHint .od-ShareHint-data{font-size:.875rem;background:none;border:1px solid "},{theme:"variantBorder",defaultValue:"#edebe9"},{rawString:";padding:10px 10px 10px 0px;margin:0;opacity:0;-webkit-transition:opacity 200ms;transition:opacity 200ms;outline:transparent;position:relative}@media screen and (-ms-high-contrast: active){.od-ShareHint .od-ShareHint-data{border:1px solid WindowText}}.isFluent .od-ShareHint .od-ShareHint-data{border-radius:2px;border:none}.od-ShareHint .od-ShareHint-data::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareHint .od-ShareHint-data:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ShareHint .od-ShareHint-data:focus:after{border-color:ActiveBorder}}.od-ShareHint .od-ShareHint-data .od-ShareHint-iconHolder{vertical-align:top}.od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{display:inline-block;vertical-align:top;margin-top:4px;font-size:.625rem;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}[dir='ltr'] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{margin-left:auto}[dir='rtl'] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{margin-right:auto}[dir='ltr'] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{padding-left:4px}[dir='rtl'] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{padding-right:4px}.od-ShareHint .od-ShareHint-data.od-ShareHint-darkBorder{border-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";border-radius:2px}.od-ShareHint div.od-ShareHint-data{border:0}.od-ShareHint button.od-ShareHint-data{width:100%}.od-ShareHint .od-ShareHint--clickable{cursor:pointer}.od-ShareHint .od-ShareHint-shimmer{width:100%;position:absolute;top:0;-webkit-box-sizing:border-box;box-sizing:border-box;border:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";padding:14px 10px;background:-webkit-gradient(linear, left top, right top, from("},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"), color-stop(50%, "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"), to("},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"));background:linear-gradient(to right, "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:" 0%, "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:" 50%, "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:" 100%);background-size:90% 100%;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";background-clip:content-box;background-repeat:no-repeat;-webkit-animation:2s ease-in-out infinite placeholderShimmer;animation:2s ease-in-out infinite placeholderShimmer;-webkit-transition:opacity 200ms, visibility 200ms;transition:opacity 200ms, visibility 200ms}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-iconHolder-shimmer{width:2.25rem;height:1.5rem}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-iconHolder-shimmer svg{fill:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-text-shimmer{color:transparent;width:100%;height:1.5rem;border-bottom:4px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-top:4px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";-webkit-box-sizing:border-box;box-sizing:border-box}.teams .od-ShareHint-data .od-ShareHint-chevron{-webkit-transform:rotate(90deg);transform:rotate(90deg);margin-top:0}.ms-TeachingBubble-closebutton{color:white}@-webkit-keyframes placeholderShimmer{0%{background-position:-900%}100%{background-position:1000%}}@keyframes placeholderShimmer{0%{background-position:-900%}100%{background-position:1000%}}\n"}]);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareHintDetail{overflow:hidden}.od-ShareHintDetail-status{font-size:.75rem;padding:0 8px;vertical-align:middle}.od-ShareHintDetail-statusText{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";font:-apple-system-caption1}[dir='ltr'] .od-ShareHintDetail-statusText{margin-right:4px}[dir='rtl'] .od-ShareHintDetail-statusText{margin-left:4px}.od-ShareHintDetail-statusUnhealthyText{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";font:-apple-system-caption1}[dir='ltr'] .od-ShareHintDetail-statusUnhealthyText{margin-right:4px}[dir='rtl'] .od-ShareHintDetail-statusUnhealthyText{margin-left:4px}.od-ShareHintDetail-statusDetails{position:absolute;top:0}[dir='ltr'] .od-ShareHintDetail-statusDetails{right:-36px}[dir='rtl'] .od-ShareHintDetail-statusDetails{left:-36px}[dir='ltr'] .od-ShareHintDetail-statusDetails{text-align:right}[dir='rtl'] .od-ShareHintDetail-statusDetails{text-align:left}.od-ShareHintDetail-expirationText{font-size:.75rem;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ShareHintDetail-iconsList{display:inline-block}.od-ShareHintDetail-item{display:inline-block;margin-bottom:0;font-size:.625rem;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}[dir='ltr'] .od-ShareHintDetail-item{margin-right:4px}[dir='rtl'] .od-ShareHintDetail-item{margin-left:4px}.od-ShareHintDetail-item .ms-Icon{background-color:transparent;position:relative}.od-ShareHintDetail-item .ms-Icon:after{position:absolute;width:12px;height:12px;background-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.od-ShareHintDetail-item-expired{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}[dir='ltr'] .od-ShareHintDetail-description{text-align:left}[dir='rtl'] .od-ShareHintDetail-description{text-align:right}.od-ShareHintDetail-chevron{font-size:.5rem}.od-ShareHintDetail-iconTooltipContent{font-size:.875rem}\n"}]);var s=n(993),o=n(2298),u=n(2429),a=n(1547),f=n("react-lib"),l=n(22),c=n(1654),h=n(996),p=n(1665),d=n(1679),v=n(1688),m=n(1667),g=n(425),y=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._renderStatusIcons=r._renderStatusIcons.bind(r);return r}t.prototype.render=function(){var e=this._getLabel(this.props.currentSettings);return f.createElement("div",{className:"od-ShareHintDetail"},f.createElement("div",{className:"od-ShareHintDetail-description"},f.createElement("div",{className:"od-ShareHintDetail-status"},f.createElement("span",{className:"od-ShareHintDetail-statusText"},e),this._renderStatusIcons(),this._renderChevron(this.props.isClickable))))};t.prototype._renderStatusIcons=function(){if(this.props.currentSettings){var e=this.props.currentSettings.expiration,t=this.props.currentSettings.hasPassword,n=this.props.currentSettings.preventDownload,r=[];e&&e.getTime()!==new Date(0).getTime()&&r.push({icon:"Calendar",tooltip:""+l.format(c.bt,Object(h.s)(e))});t&&r.push({icon:"Lock",tooltip:c.Ds});n&&r.push({icon:"Blocked2",tooltip:c.Li});this.props.currentSettings.audience!==o.e.existing&&this.props.currentSettings.isReview&&d.t[this.props.sharingInformation.fileExtension]&&r.push({icon:"Feedback",tooltip:c.lr});this.props.currentSettings.audience===o.e.anyone&&this.props.currentSettings.trackLinkUsers&&r.push({icon:"ReminderPerson",tooltip:v.h()&&m.n(this.props.clientId)?c.ps:c.vs});var i=r.map(function(e,t){var n={onRenderContent:function(){return f.createElement("div",{className:"od-ShareHintDetail-iconTooltipContent"},e.tooltip)}};return f.createElement("i",{className:"od-ShareHintDetail-item"},f.createElement(a.e,{id:e.icon,tooltipProps:n},f.createElement(s.e,{iconName:e.icon,"aria-describedby":e.icon,styles:{root:{fontSize:"0.625rem",width:"2.75",height:"2.75"}}})))});return f.createElement("div",{className:"od-ShareHintDetail-iconsList"},i)}};t.prototype._renderChevron=function(e){if(e)return f.createElement(s.e,{iconName:g.e.isRightToLeft?"ChevronLeft":"ChevronRight",className:"od-ShareHintDetail-chevron",styles:{root:{fontSize:"0.625rem",width:"2.75",height:"2.75"}}})};t.prototype._getLabel=function(e){var t=this.props.companyName,n=this.props.sharingInformation.addressBarLinkSettings,r=this.props.sharingInformation.sharingAbilities;if(this.props.isAddressBarLinkHint&&n)return n.linkDisabled||!Object(p.i)(r)?c.hi:l.format(c.qe,t);if(!e)return"";if(e.preventDownload){if(e.audience===o.e.anyone)return c.B;if(e.audience===o.e.organization)return l.format(c.Re,t);if(e.audience===o.e.specificPeopleFlex)return c.po}switch(e.sharingLinkKind){case 1:return e.audience===o.e.specificPeople?this.props.sharingInformation.requiresAccessApproval?c.ls:e.sharingRole?Object(p.k)(e.sharingRole)?c.fo:e.sharingRole===u.e.review?d.t[this.props.sharingInformation.fileExtension]?c.lo:c.co:c.ho:e.isEdit?c.fo:c.ho:c.at;case 2:return l.format(c.qe,t);case 3:return l.format(c.je,t);case 4:return c.H;case 5:return c.L;case 6:return e.audience===o.e.existing?c.at:e.audience===o.e.specificPeopleFlex?e.sharingRole?Object(p.k)(e.sharingRole)?c.fo:e.sharingRole===u.e.review?d.t[this.props.sharingInformation.fileExtension]?c.lo:c.co:c.ho:e.isEdit?c.fo:c.ho:e.audience===o.e.customLabeledSpecificPeople?e.sharingRole===u.e.review?this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?l.format(c.We,this.props.customLabeledAudienceConfig.entityName):Object(p.a)(this.props.clientId,"review",this.props.customLabeledAudienceConfig,this.props.sharingInformation.fileExtension):e.isEdit?this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?l.format(c.ze,this.props.customLabeledAudienceConfig.entityName):Object(p.a)(this.props.clientId,"edit",this.props.customLabeledAudienceConfig):this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?l.format(c.Xe,this.props.customLabeledAudienceConfig.entityName):Object(p.a)(this.props.clientId,"view",this.props.customLabeledAudienceConfig):e.audience===o.e.organization?e.sharingRole===u.e.review?d.t[this.props.sharingInformation.fileExtension]?l.format(c.Fe,t):l.format(c.Ie,t):e.isEdit?l.format(c.je,t):l.format(c.qe,t):e.audience===o.e.anyone?e.sharingRole===u.e.review?d.t[this.props.sharingInformation.fileExtension]?c.A:c.P:e.isEdit?c.L:c.H:"";default:return""}};return t})(f.Component),b=n(2064),w=n(2314),E=n(1910),S=n(97),x=n(471),T=n(1021),N=n("prop-types-lib"),C={ODB:1176},k=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._targetButton=Object(f.createRef)();r._odShareHintchevron=Object(f.createRef)();r._onDismiss=function(){r.setState({isCoachmarkVisible:!1})};r._platformDetection=n.platformDetection;r._isOnExperiment=!1;if(x.n.isFeatureEnabled(C)){var i=new T.t({name:"CoachMark",startDate:"08/2/2018",version:T.e.v2});r._isOnExperiment=i.IsExperimentOn()}r.state={isCoachmarkVisible:r._isOnExperiment};return r}t.prototype.render=function(){var e,t,n=this.props,i=!!this.props.onShareHintClick,s="od-ShareHint "+(Object(p.L)(n.sharingInformation)?"":"od-ShareHint--shimmerFadeout od-ShareHint--loaded"),u="od-ShareHint-data "+(i?"od-ShareHint--clickable":"")+" "+(n.useDarkBorder?"od-ShareHint-darkBorder":"");e=f.createElement("div",{className:"od-ShareHint-shimmer"},f.createElement("div",{className:"od-ShareHint-iconHolder-shimmer"},f.createElement("svg",{viewBox:"0 0 15 10",width:"36",height:"24"},f.createElement("path",{d:"M0,0 L15,0 L15,10 L0,10 L0,0 Z M0,5 C0,7.76142375 2.23857625,10 5,10 C7.76142375,10 10,7.76142375 10,5 C10,2.23857625 7.76142375,2.22044605e-16 5,0 C2.23857625,-2.22044605e-16 0,2.23857625 0,5 L0,5 Z"}))),f.createElement("div",{className:"od-ShareHint-text-shimmer"}));if(n.isAddressBarLinkHint){var a=this.props.sharingInformation.addressBarLinkSettings,h=this.props.sharingInformation.sharingAbilities,d=4===(v=a.linkDisabled||!Object(p.i)(h)?4:1)?c.hi:l.format(c.ci,this.props.companyName);t=f.createElement("button",{className:u,ref:this._targetButton,onClick:this._openLinkPermissions.bind(this)},f.createElement("div",{className:"od-ShareHint-iconHolder"},f.createElement(b.e,{label:d,permissionsType:v,showLabel:!1})),f.createElement(y,{clientId:n.clientId,companyName:n.companyName,currentSettings:null,sharingInformation:n.sharingInformation,linkRecipients:n.linkRecipients,customLabeledAudienceConfig:null,isAddressBarLinkHint:!0,addressBarLink:n.addressBarLink,isClickable:i}))}else{var v=this._getFileShareTypeFromAudience(),m=(d=this._getLabelFromPermissionsType(v),this.props.currentSettings.audience===o.e.customLabeledSpecificPeople&&this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl);t=n.onShareHintClick?f.createElement("button",{className:u,ref:this._targetButton,onClick:this._openLinkPermissions.bind(this)},f.createElement("div",{className:"od-ShareHint-iconHolder"},f.createElement(b.e,{label:d,permissionsType:v,iconUrl:m,showLabel:!1})),f.createElement(y,{clientId:n.clientId,companyName:n.companyName,currentSettings:n.currentSettings,sharingInformation:n.sharingInformation,linkRecipients:n.linkRecipients,customLabeledAudienceConfig:n.customLabeledAudienceConfig,isClickable:i})):f.createElement("div",Object(r.__assign)({className:u},{autoFocus:!0}),f.createElement("div",{className:"od-ShareHint-iconHolder"},f.createElement(b.e,{label:d,permissionsType:v,iconUrl:m,showLabel:!1})),f.createElement(y,{clientId:n.clientId,companyName:n.companyName,currentSettings:n.currentSettings,sharingInformation:n.sharingInformation,linkRecipients:n.linkRecipients,customLabeledAudienceConfig:n.customLabeledAudienceConfig,isClickable:i}))}return f.createElement("div",{"aria-label":c.Nn,className:s},t,e,this.state.isCoachmarkVisible&&f.createElement(w.e,{target:this._odShareHintchevron.current,positioningContainerProps:{directionalHint:g.e.isRightToLeft?S.e.bottomLeftEdge:S.e.bottomRightEdge}},f.createElement(E.e,{calloutProps:{directionalHint:g.e.isRightToLeft?S.e.bottomLeftEdge:S.e.bottomRightEdge,gapSpace:0},headline:c.Nn,hasCondensedHeadline:!0,hasCloseIcon:!0,closeButtonAriaLabel:c.Se,onDismiss:this._onDismiss},c.cn,f.createElement("br",null),c.hn)))};t.prototype._renderChevron=function(e){if(e)return f.createElement("div",{ref:this._odShareHintchevron},f.createElement(s.e,{iconName:g.e.isRightToLeft?"ChevronLeft":"ChevronRight",className:"od-ShareHint-chevron",styles:{root:{fontSize:"1.3125rem",width:"2.75",height:"2.75"}}}))};t.prototype._openLinkPermissions=function(){var e=this.props.onShareHintClick;e&&e()};t.prototype._getFileShareTypeFromAudience=function(){var e=this.props.currentSettings.audience;return e===o.e.anyone?0:e===o.e.organization?1:e===o.e.existing?4:e===o.e.customLabeledSpecificPeople?5:2};t.prototype._getLabelFromPermissionsType=function(e){return 0===e?c.li:1===e?l.format(c.ci,this.props.companyName):4===e?c.hi:2===e?c.Si:void 0};t.contextTypes={platformDetection:N.object.isRequired};return t})(f.Component)},,,function(e,t,n){"use strict";var r=n(138);Object(r.n)([{rawString:".od-DialogOverlay{display:none}.od-Dialog{background-color:transparent;position:absolute;top:48px;bottom:0;width:100%;display:block;font-size:0;line-height:100vh;text-align:center;display:flex;align-items:center}[dir=ltr] .od-Dialog{left:0}[dir=rtl] .od-Dialog{right:0}.od-Dialog::before{vertical-align:middle;display:inline-block;content:'';height:100%;width:0}.sm .od-Dialog{align-items:flex-start;box-sizing:border-box;padding:0}.od-Dialog-main{vertical-align:middle;display:inline-block;box-shadow:0 0 16px 0 "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-sizing:border-box;line-height:normal;width:100%;min-height:100px;outline:0;visibility:hidden}.sm .od-Dialog-main{height:100%}html[dir=ltr] .od-Dialog-main{text-align:left}html[dir=rtl] .od-Dialog-main{text-align:right}.isFluent .od-Dialog-main{box-shadow:0 25.6px 57.6px 0 rgba(0,0,0,.22),0 4.8px 14.4px 0 rgba(0,0,0,.18);border-radius:2px;overflow:hidden}@media screen and (-ms-high-contrast:active){.od-Dialog-main{box-shadow:0 0 0 3px "},{theme:"white",defaultValue:"#ffffff"},{rawString:" inset}}@media screen and (-ms-high-contrast:black-on-white){.od-Dialog-main{box-shadow:0 0 0 3px "},{theme:"black",defaultValue:"#000000"},{rawString:" inset}}.od-Dialog-main:focus{outline:0}.od-Dialog-main--dialog{margin:auto;position:relative}.od-Dialog-main--callout{position:absolute}.od-Dialog-main--visible{visibility:visible}.od-Dialog-main--sm{width:320px}.isFluent .od-Dialog-main--sm{width:360px}.od-Dialog-main--sm.od-Dialog-main-style--blocker{width:340px}.od-Dialog-main--sm.od-Dialog-main-style--vaultBlocker{width:620px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel{top:0;width:auto;position:absolute;bottom:0;left:0;right:0}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button{display:inline-flex;align-items:center}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button--primary,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button--primary{border:none}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button--primary:disabled,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button--primary:disabled{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button--primary:disabled:before,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button--primary:disabled:before{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button--primary .od-Button-label,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button--primary .od-Button-label{display:inline-block;font-size:14px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel.od-Dialog--close .od-Dialog-button.od-Dialog-button--close,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{top:8px}.od-Dialog-main--md{max-width:480px}.od-Dialog-main--lg{max-width:640px}.od-Dialog-main--xlg{max-width:1024px}.od-Dialog-main--xxlg{max-width:1366px}.od-Dialog-main--xxxlg{max-width:1920px}.od-Dialog-button.od-Dialog-button--close{display:none}.sm .od-Dialog-button.od-Dialog-button--close{top:8px}.od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{display:block;position:absolute;margin:0;padding:0;border:0;background:0 0;cursor:pointer;top:12px;padding:4px;height:24px;width:24px}[dir=ltr] .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{right:12px}[dir=rtl] .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{left:12px}.isFluent .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{height:32px;width:32px;line-height:32px;top:5px;border-radius:2px;padding:0;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}[dir=ltr] .isFluent .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{right:5px}[dir=rtl] .isFluent .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{left:5px}.isFluent .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close:hover{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.isFluent .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close .ms-Icon.ms-Icon--Cancel{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:16px}.isFluent .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close .ms-Icon.ms-Icon--Cancel{color:inherit}.sm .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close{top:8px;line-height:20px}.sm .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--close .ms-Icon.ms-Icon--Cancel{font-size:20px}.od-Dialog-subText{margin:0 0 20px 0;font-weight:300;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-Dialog-subText.od-Dialog-subText--s{font-size:12px}.od-Dialog-subText.od-Dialog-subText--m{font-size:14px}.od-Dialog-subText.od-Dialog-subText--l{font-size:17px}.od-Dialog-content{position:relative;width:100%}.sm .od-Dialog-content{height:100%}.od-Dialog-content .od-Button.od-Button--compound:not(:last-child){margin-bottom:20px}.ms-ModalOverlay{display:block;position:absolute;cursor:pointer;left:0;right:0;top:0;bottom:0;background-color:"},{theme:"whiteTranslucent40",defaultValue:"rgba(255,255,255,.4)"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-ModalOverlay{display:none}}.od-Dialog--multiline{width:95%}[dir=ltr] .od-Dialog-button--close{right:14px}[dir=rtl] .od-Dialog-button--close{left:14px}[dir=ltr] .od-Dialog-button--close{left:auto}[dir=rtl] .od-Dialog-button--close{right:auto}.od-Dialog-content{font-size:12px}.isFluent .od-Dialog-content{font-size:14px;line-height:20px}.od-OverlayHost-overlay .ms-ModalOverlay{animation-name:ms-fadeIn;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.od-OverlayHost-overlay .ms-ModalOverlay{animation:none}}.od-OverlayHost-overlay .od-Dialog-main{animation-name:ms-fadeIn,ms-slideDownIn10;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.od-OverlayHost-overlay .od-Dialog-main{animation:none}}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .ms-ModalOverlay{animation-name:ms-fadeOut;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .ms-ModalOverlay{animation:none}}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Dialog-main{animation-name:ms-fadeOut,ms-slideUpOut10;animation-duration:167ms;animation-timing-function:cubic-bezier(.1,.25,.75,.9);animation-fill-mode:both}@media (prefers-reduced-motion:reduce){.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Dialog-main{animation:none}}.od-OverlayHost-overlay.od-OverlayHost-overlay--closed .od-Dialog{visibility:hidden;transition:visibility 0s linear 267ms}"}])},function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(4),i=n("react-lib"),s=n(25),o=n(516),u=n(254),a=n(1786),f=n(1732);function l(e,t){void 0===t&&(t={});var n=t.factoryOptions,l=(void 0===n?{}:n).defaultProp,c=function(n){var a,l,c,h=(a=t.displayName,l=i.useContext(o.e),c=t.fields,u.e.getSettings(c||["theme","styles","tokens"],a,l.customizations)),p=t.state;p&&(n=Object(r.e)(Object(r.e)({},n),p(n)));var d=n.theme||h.theme,v=(function e(t,n){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];for(var o={},u=0,a=i;u<a.length;u++){var l=a[u];if(l){l="function"==typeof l?l(t,n):l;Array.isArray(l)&&(l=e.apply(void 0,Object(r.o)([t,n],l)));Object(f.e)(o,l)}}return o})(n,d,t.tokens,h.tokens,n.tokens),m=(function(e,t,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return s.y.apply(void 0,r.map(function(r){return"function"==typeof r?r(e,t,n):r}))})(n,d,v,t.styles,h.styles,n.styles),g=Object(r.e)(Object(r.e)({},n),{styles:m,tokens:v,_defaultStyles:m,theme:d});return e(g)};c.displayName=t.displayName||e.name;l&&(c.create=Object(a.e)(c,{defaultProp:l}));Object(f.e)(c,t.statics);return c}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=/[\(\[\{][^\)\]\}]*[\)\]\}]/g,i=/[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g,s=/^\d+[\d\s]*(:?ext|x|)\s*\d+$/i,o=/\s+/g,u=/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\u3040-\u309F\u30A0-\u30FF\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF]|[\uD840-\uD869][\uDC00-\uDED6]/;function a(e,t,n){if(!e)return"";e=(function(e){return e=(e=(e=(e=e.replace(r,"")).replace(i,"")).replace(o," ")).trim()})(e);return u.test(e)||!n&&s.test(e)?"":(function(e,t){var n="",r=e.split(" ");if(2===r.length){n+=r[0].charAt(0).toUpperCase();n+=r[1].charAt(0).toUpperCase()}else if(3===r.length){n+=r[0].charAt(0).toUpperCase();n+=r[2].charAt(0).toUpperCase()}else 0!==r.length&&(n+=r[0].charAt(0).toUpperCase());return t&&n.length>1?n.charAt(1)+n.charAt(0):n})(e,t)}},function(e,t,n){"use strict";var r=n(138);Object(r.n)([{rawString:".od-Persona-image{display:inline-block;width:3.125rem;height:3.125rem;border-radius:50%;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:';font-size:1.3125rem;position:relative;overflow:hidden;text-align:center;vertical-align:middle}.od-Persona-image.ms-Icon{line-height:3.125rem}.od-Persona-image>img{display:none;position:absolute;left:0;top:0;width:100%;height:100%;-o-object-fit:cover;object-fit:cover}.od-Persona-image--isLoaded>img{display:block;border-radius:50%}.od-Persona-userInitials{font-family:"Segoe UI",-apple-system,BlinkMacSystemFont,Roboto,"Helvetica Neue",sans-serif;position:absolute;font-size:.875rem;font-weight:400;color:'},{theme:"white",defaultValue:"#ffffff"},{rawString:";width:100%;height:100%;top:0;left:0;border-radius:50%}"}]);var i=n(0),s=n("knockout-lib"),o=n(1651),u=n(1954),a=n(22),f=n(1707),l=n(46),c=n(1765),h=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.charsWithinParenthesisRegex=/\(([^)]*)\)/gi;n.excludedCharactersRegex=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/gi;n.multipleSpacesRegex=/\s+/gi;n.isImageLoaded=s.observable(!1);n.addBindingHandlers({imageLoader:f.e});n.person=s.isObservable(t.person)?t.person:s.observable(t.person);n.disablePictrueAlt=t.disablePictrueAlt;n.pictureAlt=n.createComputed(n._computePictureAlt);n._iconType=t.iconType;n.isNewHasAccessControlEnabled=l.isFeatureEnabled(l.EnableNewHasAccessControl);return n}t.prototype.getIconType=function(e){if(this._iconType)return this._iconType;switch(e?e.type:3){case 1:return"Contact";case 0:return"Mail";default:return"People"}};t.prototype.getInitial=function(e){var t="";if(!e)return t;var n=(e=(e=(e=(e=e.replace(this.charsWithinParenthesisRegex,"")).replace(this.excludedCharactersRegex,"")).replace(this.multipleSpacesRegex," ")).trim()).split(" ");if(n.length>=2){t+=n[0].charAt(0).toUpperCase();t+=n[n.length-1].charAt(0).toUpperCase()}else 0!==n.length&&(t+=n[0].charAt(0).toUpperCase());return t};t.prototype.getTextBoyColor=function(e){return Object(c.e)({text:e})};t.prototype._computePictureAlt=function(){var e=a.format(u.u,s.utils.unwrapObservable(this.person().name));return this.disablePictrueAlt?"":e};return t})(o.t),p=n(1652).e({tagName:"od-persona-image",template:'<div class="od-Persona-image ms-Icon" role="img" data-bind="icon:true,class:\'ms-Icon--\'+getIconType(person().sharingInfo),css:{\'od-Persona-image--isLoaded\':isImageLoaded},attr:{\'aria-label\':person().name}">\x3c!--ko if:isNewHasAccessControlEnabled--\x3e<div class="od-Persona-userInitials" data-bind="style:{\'background-color\':getTextBoyColor(person().name)},text:getInitial(person().name)"></div>\x3c!--/ko--\x3e\x3c!--ko if:person().image--\x3e<img data-bind="imageLoader:{src:person().image,isLoaded:isImageLoaded,scenarioName:\'personaImage\'},attr:{alt:pictureAlt}">\x3c!--/ko--\x3e</div>',viewModel:h});t.e=p},function(e,t,n){"use strict";n.d(t,"e",function(){return y});var r=n(1419),i=n(4),s=n("react-lib"),o=n(472),u=n(1483),a=n(1621),f=n(886),l=n(653),c=n(993),h=n(1633),p=Object(o.e)(),d=(function(e){Object(i.r)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._checkBox=s.createRef();r._renderContent=function(e,t,n){void 0===n&&(n={});var o=r.props,f=o.disabled,l=o.inputProps,h=o.name,p=o.ariaLabel,d=o.ariaLabelledBy,v=o.ariaDescribedBy,m=o.onRenderLabel,g=void 0===m?r._onRenderLabel:m,y=o.checkmarkIconProps,b=o.ariaPositionInSet,w=o.ariaSetSize,E=o.title,S=o.label;return s.createElement("div",{className:r._classNames.root,title:E},s.createElement(u.e,null),s.createElement("input",Object(i.e)({type:"checkbox"},l,{"data-ktp-execute-target":n["data-ktp-execute-target"],checked:e,disabled:f,className:r._classNames.input,ref:r._checkBox,name:h,id:r._id,title:E,onChange:r._onChange,onFocus:r._onFocus,onBlur:r._onBlur,"aria-disabled":f,"aria-label":p||S,"aria-labelledby":d,"aria-describedby":Object(a.e)(v,n["aria-describedby"]),"aria-posinset":b,"aria-setsize":w,"aria-checked":t?"mixed":e?"true":"false"})),s.createElement("label",{className:r._classNames.label,htmlFor:r._id},s.createElement("div",{className:r._classNames.checkbox,"data-ktp-target":n["data-ktp-target"]},s.createElement(c.e,Object(i.e)({iconName:"CheckMark"},y,{className:r._classNames.checkmark}))),g(r.props,r._onRenderLabel)))};r._onFocus=function(e){var t=r.props.inputProps;t&&t.onFocus&&t.onFocus(e)};r._onBlur=function(e){var t=r.props.inputProps;t&&t.onBlur&&t.onBlur(e)};r._onChange=function(e){var t=r.props.onChange,n=r.state,i=n.isChecked;if(n.isIndeterminate){t&&t(e,i);void 0===r.props.indeterminate&&r.setState({isIndeterminate:!1})}else{t&&t(e,!i);void 0===r.props.checked&&r.setState({isChecked:!i})}};r._onRenderLabel=function(e){var t=e.label,n=e.title;return t?s.createElement("span",{"aria-hidden":"true",className:r._classNames.text,title:n},t):null};Object(f.e)(r);0;r._id=r.props.id||Object(l.e)("checkbox-");r.state={isChecked:!!(void 0!==t.checked?t.checked:t.defaultChecked),isIndeterminate:!!(void 0!==t.indeterminate?t.indeterminate:t.defaultIndeterminate)};return r}t.getDerivedStateFromProps=function(e,t){var n={};void 0!==e.indeterminate&&(n.isIndeterminate=!!e.indeterminate);void 0!==e.checked&&(n.isChecked=!!e.checked);return Object.keys(n).length?n:null};t.prototype.render=function(){var e=this,t=this.props,n=t.className,r=t.disabled,i=t.boxSide,o=t.theme,u=t.styles,a=t.onRenderLabel,f=void 0===a?this._onRenderLabel:a,l=t.keytipProps,c=this.state,d=c.isChecked,v=c.isIndeterminate;this._classNames=p(u,{theme:o,className:n,disabled:r,indeterminate:v,checked:d,reversed:"start"!==i,isUsingCustomLabelRender:f!==this._onRenderLabel});return l?s.createElement(h.e,{keytipProps:l,disabled:r},function(t){return e._renderContent(d,v,t)}):this._renderContent(d,v)};Object.defineProperty(t.prototype,"indeterminate",{get:function(){return!!this.state.isIndeterminate},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"checked",{get:function(){return!!this.state.isChecked},enumerable:!0,configurable:!0});t.prototype.focus=function(){this._checkBox.current&&this._checkBox.current.focus()};t.defaultProps={boxSide:"start"};return t})(s.Component),v=n(25),m=n(506),g={root:"ms-Checkbox",label:"ms-Checkbox-label",checkbox:"ms-Checkbox-checkbox",checkmark:"ms-Checkbox-checkmark",text:"ms-Checkbox-text"},y=Object(r.e)(d,function(e){var t,n,r,s,o,u,a,f,l,c,h,p,d,y,b,w,E,S,x=e.className,T=e.theme,N=e.reversed,C=e.checked,k=e.disabled,L=e.isUsingCustomLabelRender,A=e.indeterminate,O=T.semanticColors,M=T.effects,_=T.palette,D=T.fonts,P=Object(v.x)(g,T),H=O.inputForegroundChecked,B=_.neutralSecondary,j=_.neutralPrimary,F=O.inputBackgroundChecked,I=O.inputBackgroundChecked,q=O.disabledBodySubtext,R=O.inputBorderHovered,U=O.inputBackgroundCheckedHovered,z=O.inputBackgroundChecked,W=O.inputBackgroundCheckedHovered,X=O.inputBackgroundCheckedHovered,V=O.inputTextHovered,$=O.disabledBodySubtext,J=O.bodyText,K=O.disabledText,Q=[(t={content:'""',borderRadius:M.roundedCorner2,position:"absolute",width:10,height:10,top:4,left:4,boxSizing:"border-box",borderWidth:5,borderStyle:"solid",borderColor:k?q:F,transitionProperty:"border-width, border, border-color",transitionDuration:"200ms",transitionTimingFunction:"cubic-bezier(.4, 0, .23, 1)"},t[v.s]={borderColor:"WindowText"},t)];return{root:[P.root,{position:"relative",display:"flex"},N&&"reversed",C&&"is-checked",!k&&"is-enabled",k&&"is-disabled",!k&&[!C&&(n={},n[":hover ."+P.checkbox]=(r={borderColor:R},r[v.s]={borderColor:"Highlight"},r),n[":focus ."+P.checkbox]={borderColor:R},n[":hover ."+P.checkmark]=(s={color:B,opacity:"1"},s[v.s]={color:"Highlight"},s),n),C&&!A&&(o={},o[":hover ."+P.checkbox]={background:W,borderColor:X},o[":focus ."+P.checkbox]={background:W,borderColor:X},o[v.s]=(u={},u[":hover ."+P.checkbox]={background:"Highlight",borderColor:"Highlight"},u[":focus ."+P.checkbox]={background:"Highlight"},u[":focus:hover ."+P.checkbox]={background:"Highlight"},u[":focus:hover ."+P.checkmark]={color:"Window"},u[":hover ."+P.checkmark]={color:"Window"},u),o),A&&(a={},a[":hover ."+P.checkbox+", :hover ."+P.checkbox+":after"]=(f={borderColor:U},f[v.s]={borderColor:"WindowText"},f),a[":focus ."+P.checkbox]={borderColor:U},a[":hover ."+P.checkmark]={opacity:"0"},a),(l={},l[":hover ."+P.text+", :focus ."+P.text]=(c={color:V},c[v.s]={color:k?"GrayText":"WindowText"},c),l)],x],input:(h={position:"absolute",background:"none",opacity:0},h["."+m.e+" &:focus + label::before"]=(p={outline:"1px solid "+T.palette.neutralSecondary,outlineOffset:"2px"},p[v.s]={outline:"1px solid WindowText"},p),h),label:[P.label,T.fonts.medium,{display:"flex",alignItems:L?"center":"flex-start",cursor:k?"default":"pointer",position:"relative",userSelect:"none"},N&&{flexDirection:"row-reverse",justifyContent:"flex-end"},{"&::before":{position:"absolute",left:0,right:0,top:0,bottom:0,content:'""',pointerEvents:"none"}}],checkbox:[P.checkbox,(d={position:"relative",display:"flex",flexShrink:0,alignItems:"center",justifyContent:"center",height:"20px",width:"20px",border:"1px solid "+j,borderRadius:M.roundedCorner2,boxSizing:"border-box",transitionProperty:"background, border, border-color",transitionDuration:"200ms",transitionTimingFunction:"cubic-bezier(.4, 0, .23, 1)",overflow:"hidden",":after":A?Q:null},d[v.s]=Object(i.e)({borderColor:"WindowText"},Object(v.T)()),d),A&&{borderColor:F},N?{marginLeft:4}:{marginRight:4},!k&&!A&&C&&(y={background:z,borderColor:I},y[v.s]={background:"Highlight",borderColor:"Highlight"},y),k&&(b={borderColor:q},b[v.s]={borderColor:"GrayText"},b),C&&k&&(w={background:$,borderColor:q},w[v.s]={background:"Window"},w)],checkmark:[P.checkmark,(E={opacity:C?"1":"0",color:H},E[v.s]=Object(i.e)({color:k?"GrayText":"Window"},Object(v.T)()),E)],text:[P.text,(S={color:k?K:J,fontSize:D.medium.fontSize,lineHeight:"20px"},S[v.s]=Object(i.e)({color:k?"GrayText":"WindowText"},Object(v.T)()),S),N?{marginRight:4}:{marginLeft:4}]}},void 0,{scope:"Checkbox"})},,,function(e,t,n){"use strict";n.d(t,"e",function(){return T});var r=n(0),i=n(138);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareNotification{text-align:center;position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.od-ShareNotification-successPadding{padding-top:24px}.od-ShareNotification-failPadding{padding-top:50px}[dir='ltr'] .isFluent .od-ShareNotification-failPadding .od-ShareNotification-content{text-align:left}[dir='rtl'] .isFluent .od-ShareNotification-failPadding .od-ShareNotification-content{text-align:right}[dir='ltr'] .isFluent .od-ShareNotification-failPadding .ms-TextField{margin-right:8px}[dir='rtl'] .isFluent .od-ShareNotification-failPadding .ms-TextField{margin-left:8px}.od-ShareNotification-icon{position:relative;margin-bottom:16px;opacity:0;-webkit-transform:translateX(-50%) scale(0.5, 0.5);transform:translateX(-50%) scale(0.5, 0.5);-webkit-transform-origin:50% 50%;transform-origin:50% 50%;background-color:#599b00;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:1.3125rem;border-radius:50%;width:2.75rem;height:2.75rem;-webkit-animation:bounce 0.45s;animation:bounce 0.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-left:2.75rem}.isFluent .od-ShareNotification-icon{background-color:"},{theme:"shareSuccessIcon",defaultValue:"#498205"},{rawString:"}.od-ShareNotification-content{width:90%}[dir='ltr'] .od-ShareNotification-content{padding-left:16px}[dir='rtl'] .od-ShareNotification-content{padding-right:16px}[dir='ltr'] .od-ShareNotification-content{padding-right:16px}[dir='rtl'] .od-ShareNotification-content{padding-left:16px}.isFluent .od-ShareNotification-content .ms-font-l{font-weight:500;font-size:1.25rem}.od-ShareNotification-content-tooltip{margin:5px}.od-ShareNotification-permissionText{margin-bottom:24px;padding:0 20px}.od-ShareNotification-urlText{padding:10px 4px 12px 4px;display:-webkit-box;display:-ms-flexbox;display:flex}.isFluent .od-ShareNotification-urlText{padding:12px 0}.isFluent .od-ShareNotification-urlText .ms-TextField{padding-right:4px}.od-ShareNotification-urlText .ms-TextField .ms-TextField-field{padding:0}[dir='ltr'] .od-ShareNotification-urlText .ms-TextField .ms-TextField-field{padding-left:8px}[dir='rtl'] .od-ShareNotification-urlText .ms-TextField .ms-TextField-field{padding-right:8px}.isFluent .od-ShareNotification-urlText .ms-TextField .ms-TextField-field{border-radius:2px}.od-ShareNotification-urlText .ms-TextField .ms-TextField-fieldGroup{height:2rem}.od-ShareNotification-close{position:absolute;top:16px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:.75rem;width:.75rem;height:.75rem;cursor:pointer}[dir='ltr'] .od-ShareNotification-close{right:12px}[dir='rtl'] .od-ShareNotification-close{left:12px}.od-ShareNotification-footer{margin-top:-10px;width:100%}.isFluent .od-ShareNotification-footer{margin-top:0px}@-webkit-keyframes bounce{0%{-webkit-transform:translateX(-50%) scaleX(0.8) scaleY(0.8);transform:translateX(-50%) scaleX(0.8) scaleY(0.8);opacity:0}60%{-webkit-transform:translateX(-50%) scaleX(1.35) scaleY(1.35);transform:translateX(-50%) scaleX(1.35) scaleY(1.35);opacity:1;-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}100%{-webkit-transform:translateX(-50%) scaleX(1) scaleY(1);transform:translateX(-50%) scaleX(1) scaleY(1);opacity:1;-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}}@keyframes bounce{0%{-webkit-transform:translateX(-50%) scaleX(0.8) scaleY(0.8);transform:translateX(-50%) scaleX(0.8) scaleY(0.8);opacity:0}60%{-webkit-transform:translateX(-50%) scaleX(1.35) scaleY(1.35);transform:translateX(-50%) scaleX(1.35) scaleY(1.35);opacity:1;-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}100%{-webkit-transform:translateX(-50%) scaleX(1) scaleY(1);transform:translateX(-50%) scaleX(1) scaleY(1);opacity:1;-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}}.od-ShareNotification .od-ShareHint{margin:16px 0px 0px 0px;padding:16px;border:none;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.isFluent .od-ShareNotification .od-ShareHint{padding:6px;margin:0;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-ShareNotification .od-ShareHint--clickable{width:100%}.od-ShareNotification-copyCta{font-size:.75rem}.od-ShareNotification-copyButton{height:2rem;min-width:-webkit-fit-content;min-width:-moz-fit-content;min-width:fit-content;width:auto}.isFluent .od-ShareNotification-copyButton{border-radius:2px}[dir='ltr'] .teams .od-ShareNotification-copyButton{margin-left:5px}[dir='rtl'] .teams .od-ShareNotification-copyButton{margin-right:5px}.od-ShareNotification-urlTextField{width:100%}.od-ShareNotification-accessRequestIcon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";margin-top:24px}.od-ShareNotification-accessRequestHeader{font-size:1.25rem;margin-bottom:8px}.od-ShareNotification-accessRequestBody{font-size:.75rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0px 8px 24px 8px;text-align:left}.od-ShareNotification-SharedWith{-ms-flex-item-align:stretch;align-self:stretch;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding:16px}.od-ShareNotification-SharedWith .od-SharedWith-List>*:not(:last-child){margin-right:4px}\n"}]);var s=n(1745),o=n(2504),u=n(1952),a=n(2062),f=n(1893),l=n("react-lib"),c=n("prop-types-lib"),h=n(22),p=n(1665),d=n(1772),v=n(1439),m=n(97),g=n(993),y=n(1654),b=n(1667),w=n(1688),E=n(2057),S=n(1729),x={root:{fontSize:"1.3125rem",width:"2.75",height:"2.75"}},T=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this;i._onShowNameTooltip=function(){i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{isNameTooltipVisible:!0}))};i._onHideNameTooltip=function(){i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{isNameTooltipVisible:!1}))};i._copySharingLinkToClipboard=function(){return Object(r.__awaiter)(i,void 0,void 0,function(){var e=this;return Object(r.__generator)(this,function(t){p.o(this.props.clientId,this._textField,this.props.linkUrl).then(function(t){e.setState(Object(r.__assign)(Object(r.__assign)({},e.state),{successfullyCopied:t}))});return[2]})})};i._onNotificationLabel=function(e){i._notificationLabel=e};i.state={successfullyCopied:!1,isNameTooltipVisible:!1};i._resize=n.resize;i._sharingStore=n.sharingStore;i._platformDetection=n.platformDetection;i._isSharedWithFeatureOn=!w.o()&&n.sharingStore.isConsumer&&!n.sharingStore.isConsumer();return i}t.prototype.componentDidMount=function(){var e=this,t=this._platformDetection,n=t.isEdge,r=t.isIE,i=this.props.shareType===o.e.copy&&this.props.shouldCopyLinkToClipboard,s=r&&!b.d(this.props.clientId);i&&!s&&this._copySharingLinkToClipboard();(n||s)&&setTimeout(function(){e._textField.focus()},500)};t.prototype.componentDidUpdate=function(){this._resize()};t.prototype.render=function(){var e=this,t=this._getNotificationLabel(),n=this._getNotificationLabel(!0),i=this._getNotificationAriaLabel(),u=this.props.shareType===o.e.copy,a=!!this._sharingStore&&this._sharingStore.hasAccessRequestBeenCreated(),c=this.props.shareType,h=c===o.e.share||c===o.e.moreApps||c===o.e.copy&&this.state.successfullyCopied,p=h?"od-ShareNotification-successPadding":"od-ShareNotification-failPadding";return a?l.createElement("div",{className:"od-ShareNotification"},l.createElement(s.e,Object(r.__assign)({},Object(S.e)(this.props),{viewState:4})),l.createElement("div",{className:"od-ShareNotification-content ms-font-su"},l.createElement(g.e,{iconName:"PeopleAlert",className:"od-ShareNotification-accessRequestIcon",styles:x}),l.createElement("div",{className:"od-ShareNotification-accessRequestHeader ms-fontWeight-regular"},y.o),l.createElement("div",{className:"od-ShareNotification-accessRequestBody"},y.s))):l.createElement("div",{className:"od-ShareNotification "+p,role:"alert","aria-live":"assertive"},l.createElement(s.e,Object(r.__assign)({},Object(S.e)(this.props),{viewState:4})),this._renderCheckMark(h),l.createElement("div",{className:"od-ShareNotification-content"},l.createElement("div",{className:"ms-font-l",ref:this._onNotificationLabel,onMouseOver:this._onShowNameTooltip,onMouseLeave:this._onHideNameTooltip,role:"alert","aria-live":"assertive"},t),this.state.isNameTooltipVisible&&t!==n&&l.createElement(v.e,{directionalHint:m.e.topCenter,gapSpace:2,onDismiss:this._onHideNameTooltip,target:this._notificationLabel,calloutWidth:300},l.createElement("div",{className:"od-ShareNotification-content-tooltip"},n)),u&&this._renderCopyCta(),u&&l.createElement("div",{className:"od-ShareNotification-urlText"},l.createElement(f.e,{autoFocus:!0,"aria-live":"polite",ariaLabel:i,onClick:this._copySharingLinkToClipboard,readOnly:!0,componentRef:function(t){e._textField=t},type:"text",value:this.props.linkUrl,className:"od-ShareNotification-urlTextField",styles:{field:{fontSize:"0.875rem"}}}),l.createElement(d.e,{className:"od-ShareNotification-copyButton",text:y.Ce,onClick:this._copySharingLinkToClipboard,styles:{label:{fontSize:"0.875rem"},root:{padding:"0px 1rem"}}}))),u&&this._renderShareHint(),this._renderSharedWith())};t.prototype._renderCheckMark=function(e){if(e)return l.createElement("div",{className:"od-ShareNotification-icon"},l.createElement(g.e,{iconName:"CheckMark",styles:x}))};t.prototype._renderCopyCta=function(){var e=this.props,t=this.state;if(e.shareType===o.e.copy&&!t.successfullyCopied)return l.createElement("span",{className:"od-ShareNotification-copyCta"},y.Vn)};t.prototype._renderSharedWith=function(){if(this._isSharedWithFeatureOn&&this.props.sharingHintProps&&this.props.sharingHintProps.linkRecipients){var e=this.props.sharingHintProps.linkRecipients.map(function(e){return{email:e.email,loginName:e.email,primaryText:e.name,type:e.principalType,imageUrl:e.image}});if(e&&e.length)return l.createElement("div",{className:"od-ShareNotification-SharedWith"},l.createElement(a.e,{label:y.Hs,getPhotoUrl:Object(E.e)(this.props.webUrl),sharingLinks:[],sharingPrincipals:e}))}return null};t.prototype._renderShareHint=function(){var e=this.props.sharingHintProps;return e?l.createElement("div",{className:"od-ShareNotification-footer"},l.createElement(u.e,{clientId:e.clientId,companyName:e.companyName,currentSettings:e.currentSettings,sharingInformation:e.sharingInformation,onShareHintClick:e.sharingInformation.requiresAccessApproval?void 0:e.onShareHintClick,linkRecipients:e.linkRecipients,customLabeledAudienceConfig:e.customLabeledAudienceConfig})):null};t.prototype._getNotificationLabel=function(e){var t=e?this.props.itemName:p.D(this.props.itemName),n=this.props.shareType,r=t?h.format(y.zn,t):y.Wn,i=t?h.format(y.Xn,t):y.$n,s=t?h.format(y.Jn,t):y.Kn;return n===o.e.copy?this.state.successfullyCopied?r:i:n===o.e.share?s:n===o.e.moreApps?i:""};t.prototype._getNotificationAriaLabel=function(){var e=this.props.shareType;return e===o.e.copy?this.state.successfullyCopied?y.Wn:y.$n:e===o.e.share?y.Kn:e===o.e.moreApps?y.$n:""};t.contextTypes={resize:c.func.isRequired,sharingStore:c.object.isRequired,platformDetection:c.object.isRequired};return t})(l.Component)},function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});n.d(t,"n",function(){return o});var r=n("knockout-lib");function i(e,t){var n,r=function(e){t(t.peek()+e)},i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),s=e.subscribe(function(){r(e.peek()-n)});r(e.peek());return{dispose:function(){i.dispose();s.dispose();r(-e.peek())}}}function s(e,t){var n,r=function(e,n){var r=t.peek();void 0!==e&&r[e]--;void 0!==n&&(r[n]=(r[n]||0)+1);t.valueHasMutated()},i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),s=e.subscribe(function(){r(n,e.peek())});r(void 0,e.peek());return{dispose:function(){i.dispose();s.dispose();r(e.peek(),void 0)}}}function o(e,t){var n=e.peek(),i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),s=r.computed(function(){!t()&&e()&&t(e())}),o=e.subscribe(function(e){!e&&n&&t.peek()===n&&t(void 0)});return{dispose:function(){s.dispose();o.dispose();i.dispose()}}}},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(49),i=n(11),s=n(1760),o=n(1784),u=Object(i.s)("GraphPeoplePickerHelper",s.t,{oAuthTokenProvider:o.e,pageContext:r.h,sharingContextInformation:r.p.optional})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"r",function(){return i});n.d(t,"n",function(){return s});n.d(t,"t",function(){return o});var r="role:1073741827",i="role:1073741826",s="role:1073741829",o="role:1073741830"},function(e,t,n){"use strict";n.d(t,"t",function(){return p});n.d(t,"n",function(){return d});n.d(t,"r",function(){return v});n.d(t,"i",function(){return g});n.d(t,"e",function(){return y});var r=n(219),i=n(1820),s=n(22),o=n(296),u="Doc",a="Ppt",f="Xls",l="Vsd",c="Lib",h={WinDocuments:c,WinLibrary:c,WinMusic:c,WinPictures:c,WinPodcastLibrary:c,WinVideos:c,WinDrive:"Drive",CDDrive:"CDDrive",GenericDrive:"Drive",UsbDrive:"USBDrive",ExternalDrive:"ExtDrive",NetworkStorage:"NetDrive",Accdb:"Mdb",Doc:u,Docm:u,Docx:u,Dot:u,Dotm:u,Dotx:u,Exe:"Exe",Html:"Html",Mdb:"Mdb",Mpp:"Mpp",Mpt:"Mpp",Odp:a,Ods:f,Odt:u,One:"One",Onepkg:"One",Onetoc2:"One",Notebook:"OneNotebook",Pot:a,Potm:a,Potx:a,Ppa:a,Ppam:a,Pps:a,Ppsm:a,Ppsx:a,Ppt:a,Pptm:a,Pptx:a,Pub:"Pub",Rtf:"Rtf",Txt:"Txt",Vdw:l,Vsd:l,Vsdm:l,Vsdx:l,Vsl:l,Vss:l,Vssm:l,Vssx:l,Vst:l,Vstm:l,Vstx:l,Xaml:"Xaml",Xla:f,Xlam:f,Xll:f,Xls:f,Xlsb:f,Xlsm:f,Xlsx:f,Xlt:f,Xltm:f,Xltx:f,Xml:"Xml",Xps:"Xps",Xsn:"Xsn",Zip:"Zip"};function p(e,t,n){var o=e.extension,u=o&&o.slice("."===o[0]?1:0),a=u&&u.toUpperCase(),f=m(e.itemFromServer&&e.itemFromServer.iconType||u);return e.isDocSet?i.fileTypeDocSet:f||e.type!==r.e.Folder?n||(e.panorama?i.fileTypePanorama:e.photo&&!e.video?s.format(i.fileTypeImage,a||"").trim():f?i["fileType"+f]:a?s.format(i.fileTypeUnknown,a):t?i.listItemType:i.fileTypeNoExtension):i.fileTypeFolder}function d(e){var t=e.slice(e.lastIndexOf(".")+1);return s.format(i.shortcutFileTypeFormat,t.length!==e.length?this.getShortcutFileTypeFromExtension(t):i.fileTypeNoExtension)}function v(e){var t=i.fileTypeNoExtension;if(!e)return t;var n=m(s.capitalize(e));if(n)return i["fileType"+n];var r=e.toUpperCase();return r?s.format(i.fileTypeUnknown,r):t}function m(e){return h[e]}function g(e){return!!e.properties&&!!e.properties.autoAlbumTag}function y(e){if(!e)return o.e.Word;var t=m(s.capitalize(e.split(".").pop()));return"One"===t?o.e.OneNote:t===a?o.e.PowerPoint:t===f?o.e.Excel:t===l?o.e.Visio:o.e.Word}},function(e,t,n){"use strict";var r=n(1866),i=n(1713),s=n(72),o=(function(){function e(){}e.makeWebThemeRestUrl=function(e,t,n){var r=e;r&&"/"===r[r.length-1]&&(r=r.substring(0,r.length-1));r=s.e.escapeUrlForCallback(r);var i=s.e.escapeUrlForCallback(r)+"/_api/SP.Web.GetContextWebThemeData?noImages=true&lcid="+s.e.encodeURIComponent(t);n&&(i+="&ThemeOverride="+s.e.encodeURIComponent(n));return i};e.processWebThemeRestResponse=function(t){var n,r=JSON.parse(t);r&&r.d&&r.d.GetContextWebThemeData&&(n=JSON.parse(r.d.GetContextWebThemeData));return e.processRawThemeData(n)};e.processRawThemeData=function(t){if(t){var n,s=e.coerceToColor,o=e.SetColorIfMissing,u=t.Palette?t.Palette.Colors:{};n=e.convertColorsToRgba(u);var a=r.e.generateFabricColors(n.ContentAccent1,t.IsInverted),f=s(n.PageBackground)||s(t.IsInverted?"#1b1a19":"#ffffff"),l=s(n.BackgroundOverlay)||null,c=Math.round(.4*i.e.maxComponent);for(var h in a)o(n,h,a[h]);o(n,"white",f);o(n,"primaryBackground",i.e.clone(f));o(n,"primaryText",a.primaryText||s("#333"));o(n,"whiteTranslucent40",f&&i.e.fromRgba(f.R,f.G,f.B,c));o(n,"backgroundOverlay",l);o(n,"suiteBarBackground",s(n.SuiteBarBackground)||null);o(n,"suiteBarText",s(n.SuiteBarText)||null);o(n,"suiteBarDisabledText",s(n.SuiteBarDisabledText)||null);o(n,"topBarBackground",s(n.TopBarBackground)||null);o(n,"topBarText",s(n.TopBarText)||null);o(n,"topBarHoverText",s(n.TopBarHoverText)||null);o(n,"dialogBorder",s(n.DialogBorder)||null);return{backgroundImageUri:t.BackgroundImageUri,cacheToken:t.ThemeCacheToken,isDefault:t.IsDefault,isInverted:t.IsInverted,palette:n,version:t.Version}}return{backgroundImageUri:"",cacheToken:"",isDefault:!0,isInverted:!1,palette:{},version:""}};e.convertColorsToRgba=function(t){var n={};for(var r in t)if(t.hasOwnProperty(r)){var i=e.coerceToColor(t[r]);i&&(n[r]=i)}return n};e.coerceToColor=function(t){var n;t?"string"==typeof t||t instanceof String?n=i.e.fromHtmlColor(String(t)):"DefaultColor"in t?n=e.coerceToColor(t.DefaultColor):"R"in t&&"G"in t&&"B"in t&&(n=i.e.fromRgba(t.R,t.G,t.B,t.A)):n=null;return n};e.SetColorIfMissing=function(e,t,n){e[t]||(e[t]=n)};return e})();t.e=o},function(e,t,n){"use strict";n.d(t,"e",function(){return N});var r=n(0),i=n(197),s=n(103),o=n(63),u=n(2249),a=n(1861),f=n(164),l=n(1017),c=n(156),h=n(471),p=n(70),d=n(1865),v=n(1008),m=n(52),g=n(994),y=n(133),b=n(109),w=n(48),E=n(1036),S={ODB:556,ODC:null,Fallback:!1},x={ODB:1302,ODC:null,Fallback:!1},T={ODB:1836,ODC:null,Fallback:!1},N=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,{engagementEvent:y.e,qosEvents:{"SuiteNavProvider.GetO365Shell":new b.e({name:"SuiteNavProvider.GetO365Shell"})}},n)||this;r._dataSource=n.dataSource;r._cssLoaded=!1;r._isSuiteNavBootstrapperLoadingFlowEnabled=h.n.isFeatureEnabled(x);return r}t.prototype.clearCachedPromise=function(){this._modelPromise=void 0};t.prototype.loadData=function(e){return this._loadModel(e).then(function(e){return e.data})};t.prototype.getO365Shell=function(){if(this._isSuiteNavBootstrapperLoadingFlowEnabled)return e.prototype.getO365Shell.call(this);if(!this._capabilities.supportsRealSuiteNav)throw new Error("getO365Shell is only supported if supportsRealSuiteNav capability is true.");var t=new i.e,n=new b.e({name:"SuiteNavProvider.GetO365Shell"});this._getSuiteNavShell(t);t.getPromise().then(function(){n.end({resultType:w.e.Success})},function(e){n.end(Object(E.n)({error:e}))});return t.getPromise()};t.prototype.getMailUrl=function(){return this._loadModel().then(function(e){var t=e&&e.data&&e.data.WorkloadLinks;if(t)for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i&&i.Id===l.e.MAIL)return i.Url}})};t.prototype.updateWorkloadSettingsLinks=function(e){var t,n=this;return this.getO365Shell().then(function(r){return(t=r)&&t.Settings?n.loadData(e):void 0}).then(function(e){e&&e.CurrentWorkloadSettingsSubLinks&&e.CurrentWorkloadSettingsSubLinks.length>0&&t.Settings.SetWorkloadSettingsLinks(e.CurrentWorkloadSettingsSubLinks)}).catch(function(e){y.e.logData({name:"SuiteNavProvider.UpdateWorkloadSettingsLinksError"})})};t.prototype.trySetDataAfterInitialRender=function(e,t){var n=this,i=this._dataSource.getSuiteNavContext();if(i&&i.isConsumer){if(!p.t.isActivated("0461c2e7-c91a-4038-b591-09477f3f84a6","09/27/2021","Extra SuiteNav configuration for Consumer")&&e.NFD){i.helpNamespace&&e.NFD.UpdateHelpNamespace(i.helpNamespace);e.NFD.OnFeedbackMetadataRequested(function(e,t){return e=n._dataSource.setFeedbackMetadata(e,t)});this._addFeedbackButton(e)}this._logEngagementData({name:"SuiteNavProvider.SetDataNotNeededInConsumer"});return m.n.wrap(!0)}y.e.logData({name:"SuiteNavProvider.SetDataAfterInitialRender"});var s=t.actionContext,o=t.bundleLoader;return this.loadData().then(function(t){if(!t){y.e.logData({name:"SuiteNavProvider.NoSuiteNavData"});return!1}if(!e){y.e.logData({name:"SuiteNavProvider.NoO365Shell"});return!1}var i=h.n.isFeatureEnabled(T)&&!!e.NFD,u=i&&n._shouldAddFeedbackButton(e);if(u){var a=JSON.parse(t.ClientData);if(a.OCVFeedbackMAXEnabled){if(!p.t.isActivated("7897BF84-323B-4580-95D2-A14836FE65F6","09/15/2021","Stop modifying OCVFeedbackMAXEnabled")){a.OCVFeedbackMAXEnabled=!1;t.ClientData=JSON.stringify(a)}}else i=u=!1}try{e.SetData(t)}catch(e){y.e.logData({name:"SuiteNavProvider.SetDataFail"});b.e.instrumentPromise({name:"SuiteNav.RefreshCacheAfterInvalidShellData"},function(){return n.loadData(!0)});return!1}t.ActionsMap&&e.Navigation.OnLinkClick(function(e){var n=t.ActionsMap[e.Id];n&&(e.Cancel=!n(Object(r.__assign)(Object(r.__assign)({},e),s||{})))});e.OnHasMember("OnDataChanged",function(){e.OnDataChanged(function(){return b.e.instrumentPromise({name:"SuiteNav.RefreshCacheForShellDataChanged"},function(){return n.loadData(!0)}).done()})});if(i){e.NFD.OnFeedbackMetadataRequested(function(e,t){return e=n._dataSource.setFeedbackMetadata(e,t)});u&&n._addFeedbackButton(e)}o&&o.pageRenderingIsComplete();return!0},function(e){y.e.logData({name:"SuiteNavProvider.LoadDataError"});return!1})};t.prototype._getSuiteNavShell=function(e,t){var n=this;this._loadModel().then(function(r){if(!n._cssLoaded&&r.cssUrl){g.e.loadStylesheet(r.cssUrl);n._dataSource.onCssLoad&&n._dataSource.onCssLoad(r);n._cssLoaded=!0}y.e.logData({name:"SuiteNavProvider.GetO365ShellByS2S"});n._requestShellCore(r.jsUrl,t,C).then(function(t){e.complete(t)},function(t){n._modelPromise=void 0;if((t=Object(E.n)({error:t}))&&"LoadScriptError"===t.resultCode&&n._isDataFromCache){y.e.logData({name:"SuiteNavProvider.O365ShellCacheFailed"});n._clearCache();n._getSuiteNavShell(e)}else if(n._hasRetriedShell)e.error(t);else{n._hasRetriedShell=!0;n._cssLoaded=!1;y.e.logData({name:"SuiteNavProvider.O365ShellRetry"});n._getSuiteNavShell(e,!0)}})})};t.prototype._loadModel=function(e){var t=this;if(!e&&this._modelPromise)return this._modelPromise;var n,r,s=new i.e,o=this._capabilities.supportsCaching,u=this._dataSource,a=w.e.Failure,f=b.e.instrumentPromise({name:"SuiteNavProvider.LoadData"},function(){return new m.n(function(r,i){var s;!e&&o&&t._isCacheValid()&&(s=t._cache.getValue(t._cacheDataKey));if(s&&s.data){y.e.logData({name:"SuiteNavProvider.DataFromCache"});u.updateDataForCurrentPage&&(s.data=u.updateDataForCurrentPage(s.data));if(o&&t._isCacheOutdated()){y.e.logData({name:"SuiteNavProvider.RefreshCache"});u.loadData().then(function(e){t._updateCache(e)})}t._isDataFromCache=!0;r(s)}else{t._isDataFromCache=!1;e&&y.e.logData({name:"SuiteNavProvider.ForceUpdateData"});y.e.logData({name:"SuiteNavProvider.DataFromServer"});u.loadData().done(function(e){if(e)if(e.data){o&&!(function(e){var t=e&&e.data&&e.data.WorkloadLinks;return!!t&&t.some(function(e){return e&&!e.Url})})(e)&&t._updateCache(e);r(e)}else{n="NoModelData";i("Model with no data returned")}else{n="NoModel";i("No model returned")}},function(e){if(m.n.isCanceled(i)){n="Canceled";a=w.e.ExpectedFailure}else n="ServerLoadFailure";i(e)})}})},null,function(e){if(m.n.isCanceled(e)){a=w.e.ExpectedFailure;n="Canceled"}return{resultType:a,resultCode:n||"Other",error:e}});(r=Object(d.e)())?this._modelPromise=m.n.all({suiteNavModel:f,theme:r.loadThemeSlotsMap()}).then(function(e){var t=e.suiteNavModel,n=e.theme,r=t&&t.data,i=t&&t.hasCobranding,s=r&&r.UseSPOBehaviors,o=h.n.isFeatureEnabled(S),u=n&&n.suiteBarBackground;!(u&&r&&s)||i&&o||(r.ThemeColors=[u,n.primaryText,u,n.suiteBarText,n.suiteBarDisabledText,n.topBarBackground,n.topBarText,n.topBarHoverText,n.primaryBackground,n.themeLighterAlt,n.dialogBorder]);return t}):this._modelPromise=f;this._modelPromise.then(function(e){return s.complete(e)},function(e){return s.error(e)});return s.getPromise()};t.prototype._shouldAddFeedbackButton=function(e){var t=!1;if(h.n.isFeatureEnabled({ODB:v.r?-1246:1246,ODC:null,Fallback:!1})){var n=this._dataSource.getWebTemplateType?this._dataSource.getWebTemplateType():f.t.invalid,r=/\/_layouts\/15\/Lists.aspx$/i;t=p.t.isActivated("9BCCA26C-EC25-44FF-A395-2D6D04734F76","09/15/2021","More specific ODB check for Feedback button")?n!==f.t.mySiteHost&&n!==f.t.mySite&&n!==f.t.tenantAdmin||r.test(window.location.pathname):n!==f.t.mySiteHost&&!v.r&&n!==f.t.tenantAdmin||r.test(window.location.pathname)}return t};t.prototype._addFeedbackButton=function(e){var t;null===(t=e.Extensibility)||void 0===t||t.AddOrUpdateCustomHeaderButton({affordanceMenuItemText:u.e,ariaLabel:u.e,iconFontFamily:"FabricMDL2Icons",iconFontName:"",id:"GiveFeedbackButton",onShow:function(){var t;if(e.FlexPane){e.FlexPane.OpenFlexPaneForProvider("Feedback");c.e.raise(document.body,"resize",void 0,!0)}null===(t=e.Extensibility)||void 0===t||t.UpdateButtonState("GiveFeedbackButton",!0)},onHide:function(){var t;null===(t=e.FlexPane)||void 0===t||t.CloseFlexPaneForProvider("Feedback");c.e.raise(document.body,"resize",void 0,!0)}})};t.prototype._clearCache=function(){this._cache.remove(this._cacheDataKey);this._cache.remove(this._cacheThemeDataKey);this._cache.remove(this._cacheDateKey);this._cache.remove(this._cacheVersionKey);this._cache.remove(this._cacheSessionKey,o.e.session)};t.prototype._updateCache=function(e,t){this._cache.setValue(this._cacheDataKey,e);this._cache.setValue(this._cacheDateKey,new Date);this._cache.setValue(this._cacheVersionKey,this._cacheVersion);this._cache.setValue(this._cacheSessionKey,!0,o.e.session)};t.prototype._isCacheOutdated=function(){var e=this._cache.getValue(this._cacheSessionKey,o.e.session),t=Date.parse(this._cache.getValue(this._cacheDateKey));return s.e.hasStorageType(o.e.session)&&!e||Date.now()-t>=60*this._cacheRenew*60*1e3};return t})(E.e);function C(){var e=window._o365su;if(e&&e.b)for(var t=0,n=["ThrowOnNull","ThrowOnUndefined","ThrowOnNullOrUndefined","ThrowOnNullOrEmpty","ThrowOnNullOrEmptyArray"];t<n.length;t++){var r=n[t];k(e.b,r)}}function k(e,t){var n=e[t];"function"==typeof n&&(e[t]=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];try{return n.apply(this,e)}catch(e){a.e.logData({message:e&&e.message||"",stack:e&&e.stack||"",type:t})}})}},function(e,t,n){"use strict";var r='<div class="od-DialogHost">\x3c!--ko with:dialog--\x3e\x3c!--ko component:{name:$component.dialogOverlayTagName,params:{dialog:$component.dialog}}--\x3e\x3c!--ko if:$component.isStandard--\x3e\x3c!--ko component:{name:$component.standardDialogTagName,params:{}}--\x3e\x3c!--ko if:!!component--\x3e\x3c!--ko with:component--\x3e\x3c!--ko component:$data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:!!control--\x3e\x3c!--ko control:control--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot:$component.isStandard--\x3e\x3c!--ko with:component--\x3e\x3c!--ko component:$data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>',i=n(138);Object(i.n)([{rawString:".od-DialogHost{display:none}"}]);var s=n(1706),o=n(0),u=n(1651),a=(n(1955),n("knockout-lib")),f=n(195),l=n(425),c=n(880),h=n(1859),p=n(1678),d=n(1703),v=n(1659),m=n(1715),g=n(1660),y=n(1718),b=n(1742),w=n(1776),E=n(1677),S=(function(e){Object(o.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({dismiss:d.e,automation:w.e,element:g.e,focusTrap:m.e,interactionScope:E.t,preserveFocus:b.e,recoverFocus:y.e,host:p.e});n.dialog=t.dialog;n.overlayComponent=n.createPureComputed(n._computeOverlayComponent);n.contentRoot=a.observable();n._launchPoint=new f.e(-1,-1);n.isVisible=a.observable(!1);n.title=n.createObservable(n.dialog().title());n.dialogStyle=n.createComputed(n._computeDialogStyle);n.sizeClass=n.createComputed(n._computeSizeClass);n.styleClass=n.createComputed(n._computeStyleClass);return n}t.prototype.dismiss=function(){var e=this.dialog();if(e&&e.isDismissable){e.dismiss();return!1}return!0};t.prototype._computeOverlayComponent=function(){var e=this.dialog();return{name:s.e.tagName,params:{animation:{beforeRemove:500},alignToParent:e.isCallout}}};t.prototype._computeDialogStyle=function(){var e=this.dialog(),t={};if(e){if(this.unwrapObservable(e.calloutHeight)&&e.isCallout){this.ensureLaunchPointCalculated();t.left=this._launchPoint.x+"px";t.top=this._launchPoint.y+"px"}}else{t.left="-1000px";t.top="-1000px"}e.isCallout&&!this.unwrapObservable(e.calloutHeight)||this.isVisible(!0);return t};t.prototype.ensureLaunchPointCalculated=function(){var e=this.dialog.peek().invokerEvent;if(e&&this.contentRoot()){var t=this.contentRoot().getBoundingClientRect(),n=e.clientX,r=e.clientY;if(n<=0&&r<=0||!n&&!r){var i=e.target.getBoundingClientRect();n=i.left;r=i.bottom}var s=l.e.isRightToLeft?n-t.width:n,o=r,u=new c.e(s,o,t.width,t.height),a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,f=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,h=new c.e(0,0,a,f),p=u.nudge(h);this._launchPoint.x=p.getLeft();this._launchPoint.y=p.getTop()}};t.prototype._computeSizeClass=function(){return v.e.determineCssClass(this.dialog().size)};t.prototype._computeStyleClass=function(){return h.e[this.dialog().style]};return t})(u.t),x=n(1652),T=x.e({tagName:"od-dialog-overlay",template:"<div class=\"od-DialogOverlay\" data-bind=\"css:{'is-active':dialog}\">\x3c!--ko with:dialog--\x3e\x3c!--ko component:$component.overlayComponent--\x3e<div class=\"od-Dialog\" data-bind=\"css:{'od-Dialog--close':isDismissable},focusTrap:{}\"><div class=\"ms-ModalOverlay\" data-bind=\"visible:!isCallout&&!isOverlayHidden,style:{backgroundColor:overlayColor}\"></div><div class=\"od-Dialog-main\" tabindex=\"-1\" role=\"dialog\" data-bind=\"interactionScope:{isScope:true},preserveFocus:shouldPreserveFocus,recoverFocus:{isEnabled:$host.isOpen},dismiss:{isEnabled:isSoftDismissable,close:isDismissable&&$component.dismiss.bind($component),dismissOnScroll:isDismissableOnScroll,dismissOnResize:isDismissableOnResize},class:'od-Dialog-main--'+$component.sizeClass()+' '+'od-Dialog-main-style--'+$component.styleClass()+(customCssClasses?' '+customCssClasses:''),css:{'od-Dialog-main--allowPanel':!stayAsPopup,'od-Dialog-main--callout':isCallout,'od-Dialog-main--dialog':!isCallout,'od-Dialog-main--visible':$component.isVisible()},automation:automationId,style:$component.dialogStyle,attr:{'aria-labelledby':'od-Dialog-title','aria-describedby':'od-Dialog-content'},element:$parent.contentRoot\"><div class=\"od-Dialog-content\" data-bind=\"host:{}\"></div></div></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>",viewModel:S,synchronous:!0}),N=n(1682);Object(i.n)([{rawString:".od-Link{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-decoration:none;cursor:pointer;outline:0}.od-Link:focus,.od-Link:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.od-Link:active{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Link[disabled]{cursor:default;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-Dialog-actionsLoading{display:inline-block;padding-bottom:7px;vertical-align:bottom}[dir=ltr] .od-Dialog-actionsLoading{padding-right:5px}[dir=rtl] .od-Dialog-actionsLoading{padding-left:5px}.od-Dialog-main--callout .od-Dialog-inner{padding:0}.od-Dialog-main--callout .od-Dialog-header{padding:0}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-actions,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-actions{position:absolute;top:0;left:0;right:0;margin-top:0;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";padding:0 10px 0 0;height:44px}html[dir=rtl] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-actions,html[dir=rtl] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-actions{padding:0 0 0 10px}html[dir=ltr] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-actions .od-Dialog-actionsRight,html[dir=ltr] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-actions .od-Dialog-actionsRight{float:left}html[dir=rtl] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-actions .od-Dialog-actionsRight,html[dir=rtl] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-actions .od-Dialog-actionsRight{float:right}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-actions .ms-Icon--Save,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-actions .ms-Icon--Save{font-size:20px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action{background:0 0;height:44px}[dir=ltr] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action,[dir=ltr] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action{padding-right:16px}[dir=rtl] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action,[dir=rtl] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action{padding-left:16px}[dir=ltr] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action,[dir=ltr] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action{padding-left:16px}[dir=rtl] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action,[dir=rtl] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action{padding-right:16px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action .od-Button-icon,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action .od-Button-icon{display:inline-block;margin-top:5px;margin-right:6px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action .od-Button-label,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action .od-Button-label{font-weight:400;font-size:14px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-action:hover,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-action:hover{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-header,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-header{padding:48px 16px 0 16px}html[dir=rtl] .sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-header,html[dir=rtl] .sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-header{padding:48px 16px 0 16px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Dialog-inner,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Dialog-inner{padding:16px}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button:disabled .od-Button-icon,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button:disabled .od-Button-icon{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.sm .od-Dialog-main--md.od-Dialog-main--allowPanel .od-Button:disabled .od-Button-label,.sm .od-Dialog-main--sm.od-Dialog-main--allowPanel .od-Button:disabled .od-Button-label{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.od-Dialog-content .od-Dialog-action.od-Button:focus{border:2px solid "},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--back{padding:5px 10px 5px 0;background:0 0;border:0;cursor:pointer}html[dir=rtl] .od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--back{padding:5px 0 5px 10px}.od-Dialog.od-Dialog--close .od-Dialog-button.od-Dialog-button--back .ms-Icon.ms-Icon--Back{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:16px}.ms-Dialog-button--close{position:absolute;top:12px;background:0 0;border:none;cursor:pointer}[dir=ltr] .ms-Dialog-button--close{right:8px}[dir=rtl] .ms-Dialog-button--close{left:8px}.ms-Dialog-button--close .ms-Icon{font-size:16px}.od-Dialog-header{position:relative;width:100%;box-sizing:border-box;padding:24px 32px 0;word-wrap:break-word}.isFluent .od-Dialog-header{padding:24px 40px 0 24px}.od-Dialog-header .od-Dialog-title{margin:0;font-weight:100;font-size:21px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";display:inline}.isFluent .od-Dialog-header .od-Dialog-title{font-size:20px;font-weight:600}.od-Dialog-header .od-Dialog-title .od-Dialog-titleIcon::after{content:''}[dir=ltr] .od-Dialog-header .od-Dialog-title .od-Dialog-titleIcon::after{margin-right:16px}[dir=rtl] .od-Dialog-header .od-Dialog-title .od-Dialog-titleIcon::after{margin-left:16px}.od-Dialog-header .od-Dialog-title .od-Dialog-titleIcon .od-IconGlyph{display:inline-block;top:8px;font-size:28px}.od-Dialog-header.od-Dialog-header--large{padding:30px 20px;margin-bottom:10px;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Dialog-header.od-Dialog-header--large .od-Dialog-title{font-weight:100;font-size:28px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-Dialog-inner{height:100%;padding:16px 32px 20px}.isFluent .od-Dialog-inner{padding:18px 24px 24px}.od-Dialog-actions{position:relative;width:100%;height:32px;margin-top:24px}.od-Dialog-actions::after,.od-Dialog-actions::before{display:table;content:'';line-height:0}.od-Dialog-actions::after{clear:both}.od-Dialog-action .od-Button-icon{display:none}.od-Dialog-action.od-Dialog-action--link{border:0;cursor:pointer;box-sizing:border-box;box-shadow:none;margin:0;padding:0;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-decoration:none;cursor:pointer;outline:0;padding:0 0 0 4px;background:0 0}.od-Dialog-action.od-Dialog-action--link:focus,.od-Dialog-action.od-Dialog-action--link:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.od-Dialog-action.od-Dialog-action--link:active{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Dialog-action.od-Dialog-action--link[disabled]{cursor:default;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}html[dir=rtl] .od-Dialog-action.od-Dialog-action--link{padding:0 4px 0 0}.od-Dialog-action.od-Dialog-action--link .od-Button-label{font-weight:400;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Dialog-action.od-Dialog-action--link:hover .od-Button-label{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.sm .od-Dialog-action .od-Button-label{font-size:12px}html[dir=ltr] .od-Dialog-actionsRight{float:right}html[dir=rtl] .od-Dialog-actionsRight{float:left}[dir=ltr] .od-Dialog-actionsRight .od-Dialog-action:not(:last-child){margin-right:5px}[dir=rtl] .od-Dialog-actionsRight .od-Dialog-action:not(:last-child){margin-left:5px}[dir=ltr] .isFluent .od-Dialog-actionsRight .od-Dialog-action:not(:last-child){margin-right:8px}[dir=rtl] .isFluent .od-Dialog-actionsRight .od-Dialog-action:not(:last-child){margin-left:8px}html[dir=ltr] .od-Dialog.od-Dialog--lgHeader .od-Dialog-actionsRight{float:right}html[dir=rtl] .od-Dialog.od-Dialog--lgHeader .od-Dialog-actionsRight{float:left}[dir=ltr] .od-Dialog.od-Dialog--lgHeader .od-Dialog-actionsRight .od-Dialog-action:not(:last-child){margin-right:15px}[dir=rtl] .od-Dialog.od-Dialog--lgHeader .od-Dialog-actionsRight .od-Dialog-action:not(:last-child){margin-left:15px}"}]);var C=n(1662),k=n(282),L=Object(k.e)({eventName:"DialogAction,",shortEventName:"DialogAction"},{dialogName:1,actionName:1}),A=n(2251),O=n(1744),M=n(1872),_=(function(e){Object(o.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.loadingSpinnerTagName=O.e.tagName;n.iconGlyphTagName=M.e.tagName;n.addBindingHandlers({keyboard:C.e,automation:w.e,host:p.e,element:g.e});n.closeLabel=A.e;n.dialog=n.resources.consume(N.e).currentDialog;n.actionButton=n.observables.create(null);n.createComputed(function(){var e=n.actionButton();e&&n.dialog.peek().focusOnPrimaryAction&&e.focus()});return n}t.prototype.dismiss=function(){var e=this.dialog();if(e&&e.isDismissable){e.dismiss();return!1}return!0};t.prototype.executeDefaultAction=function(){var e=this.dialog();if(e&&e.executeDefaultAction){var t=a.utils.arrayFirst(e.actions,function(e){return e.isDefault});if(t){this._logEvent(t);return this.execute(t)}}return!0};t.prototype.execute=function(e){var t=this.dialog();if(t&&e.isAvailable()){e.isExecuting(!0);this._logEvent(e);e.execute().done(function(n){e.isExecuting(!1);t.state(n)});return!1}return!0};t.prototype._logEvent=function(e){var t=this.dialog.peek();e.instrumentationId&&t.instrumentationId&&L.logData({actionName:e.instrumentationId,dialogName:t.instrumentationId})};return t})(u.t),D=x.e({tagName:"od-standard-dialog",template:'\x3c!--ko with:dialog--\x3e<div data-bind="keyboard:{allowInputEvents:true,allowButtonEvents:false,mappings:{Enter:$component.executeDefaultAction.bind($component)}},css:\'od-StandardDialog\'"><div class="od-Dialog-header od-Dialog-header--s"><p class="od-Dialog-title" id="od-Dialog-title" data-bind="attr:{\'aria-label\':title}" role="heading" aria-level="1">\x3c!--ko if:titleAction&&titleAction.isVisible()--\x3e<button class="od-Dialog-button od-Dialog-button--back" data-bind="attr:{\'aria-label\':titleAction.name,title:titleAction.name},click:titleAction.execute">\x3c!--ko if:titleAction.icon--\x3e<span data-bind="component:{name:$component.iconGlyphTagName,params:{icon:titleAction.icon}}"></span>\x3c!--/ko--\x3e</button>\x3c!--/ko--\x3e\x3c!--ko if:titleIcon&&!titleAction--\x3e<span class="od-Dialog-titleIcon" data-bind="component:{name:$component.iconGlyphTagName,params:{icon:titleIcon}},attr:{\'aria-label\':titleIconAriaLabel}"></span>\x3c!--/ko--\x3e\x3c!--ko text:title--\x3e\x3c!--/ko--\x3e</p></div><div class="od-Dialog-inner"><div class="od-Dialog-content" id="od-Dialog-content" data-bind="host:{}"></div>\x3c!--ko if:actions.length&&actionsVisible--\x3e<div class="od-Dialog-actions" data-bind="automation:\'actionsSection\'"><div class="od-Dialog-actionsRight" data-bind="foreach:actions">\x3c!--ko if:isVisible--\x3e<button class="od-Dialog-action" data-bind="css:{\'od-Button--primary\':isDefault,\'od-Button\':!isLink,\'od-Dialog-action--link\':isLink},click:$component.execute.bind($component),enable:isAvailable,automation:automationId,element:$component.actionButton">\x3c!--ko if:icon--\x3e<span class="od-Button-icon" data-bind="component:{name:$component.iconGlyphTagName,params:{icon:icon}}"></span>\x3c!--/ko--\x3e<span class="od-Button-label" data-bind="text:name"></span></button>\x3c!--/ko--\x3e\x3c!--ko if:isVisible()&&isExecuting()--\x3e<div class="od-Dialog-actionsLoading" data-bind="component:{name:$component.loadingSpinnerTagName,params:{loadingText:\'\'}}"></div>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e</div><button class="od-Dialog-button od-Dialog-button--close" data-bind="attr:{\'aria-label\':$component.closeLabel,title:$component.closeLabel},click:isDismissable&&$component.dismiss.bind($component)"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button></div>\x3c!--/ko--\x3e',viewModel:_}),P=n(1653),H=(function(e){Object(o.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.addBindingHandlers({control:P.n});r.dialog=r.resources.consume(N.e).currentDialog;r.dialogOverlayTagName=T.tagName;r.standardDialogTagName=D.tagName;r.isStandard=r.createPureComputed(r._computeIsStandard);r.hasDialog=r.createPureComputed(r._computeHasDialog);return r}t.prototype._computeIsStandard=function(){var e=this.dialog();return e&&1===e.template};t.prototype._computeHasDialog=function(){return!!this.dialog()};return t})(u.t),B=x.e({tagName:"od-dialog-host",template:r,viewModel:H,synchronous:!0});t.e=B,Object(P.t)({name:"DialogHost",template:r,automationName:"od-dialog-host",viewModelType:H})},,,function(e,t,n){"use strict";n.d(t,"e",function(){return N});var r,i,s,o=n(1419),u=n(4),a=n("react-lib"),f=n(472),l=n(886),c=n(653),h=n(37),p=n(270),d=n(1487),v=n(1508),m=n(993),g=n(1737),y=Object(f.e)(),b=(function(e){Object(u.r)(t,e);function t(t){var n,r=e.call(this,t)||this;r.ICON_MAP=((n={})[g.e.info]="Info",n[g.e.warning]="Info",n[g.e.error]="ErrorBadge",n[g.e.blocked]="Blocked2",n[g.e.severeWarning]="Warning",n[g.e.success]="Completed",n);r._getRegionProps=function(){var e=!!r._getActionsDiv()||!!r._getDismissDiv(),t={"aria-describedby":r.state.labelId,role:"region"};return e?t:{}};r._onClick=function(e){r.setState({expandSingleLine:!r.state.expandSingleLine})};Object(l.e)(r);r.state={labelId:Object(c.e)("MessageBar"),showContent:!1,expandSingleLine:!1};return r}t.prototype.render=function(){var e=this.props.isMultiline;this._classNames=this._getClassNames();return e?this._renderMultiLine():this._renderSingleLine()};t.prototype._getActionsDiv=function(){return this.props.actions?a.createElement("div",{className:this._classNames.actions},this.props.actions):null};t.prototype._getDismissDiv=function(){var e=this.props,t=e.onDismiss,n=e.dismissIconProps;return t?a.createElement(v.e,{disabled:!1,className:this._classNames.dismissal,onClick:t,iconProps:n||{iconName:"Clear"},title:this.props.dismissButtonAriaLabel,ariaLabel:this.props.dismissButtonAriaLabel}):null};t.prototype._getDismissSingleLine=function(){return this.props.onDismiss?a.createElement("div",{className:this._classNames.dismissSingleLine},this._getDismissDiv()):null};t.prototype._getExpandSingleLine=function(){return!this.props.actions&&this.props.truncated?a.createElement("div",{className:this._classNames.expandSingleLine},a.createElement(v.e,{disabled:!1,className:this._classNames.expand,onClick:this._onClick,iconProps:{iconName:this.state.expandSingleLine?"DoubleChevronUp":"DoubleChevronDown"},ariaLabel:this.props.overflowButtonAriaLabel,"aria-expanded":this.state.expandSingleLine})):null};t.prototype._getIconSpan=function(){var e=this.props.messageBarIconProps;return a.createElement("div",{className:this._classNames.iconContainer,"aria-hidden":!0},e?a.createElement(m.e,Object(u.e)({},e,{className:Object(h.e)(this._classNames.icon,e.className)})):a.createElement(m.e,{iconName:this.ICON_MAP[this.props.messageBarType],className:this._classNames.icon}))};t.prototype._renderMultiLine=function(){return a.createElement("div",Object(u.e)({className:this._classNames.root},this._getRegionProps()),a.createElement("div",{className:this._classNames.content},this._getIconSpan(),this._renderInnerText(),this._getDismissDiv()),this._getActionsDiv())};t.prototype._renderSingleLine=function(){return a.createElement("div",Object(u.e)({className:this._classNames.root},this._getRegionProps()),a.createElement("div",{className:this._classNames.content},this._getIconSpan(),this._renderInnerText(),this._getExpandSingleLine(),this._getActionsDiv(),this._getDismissSingleLine()))};t.prototype._renderInnerText=function(){var e=Object(p.u)(this.props,p.a,["className"]);return a.createElement("div",{className:this._classNames.text,id:this.state.labelId,role:"status","aria-live":this._getAnnouncementPriority()},a.createElement("span",Object(u.e)({className:this._classNames.innerText},e),a.createElement(d.e,null,a.createElement("span",null,this.props.children))))};t.prototype._getClassNames=function(){var e=this.props,t=e.theme,n=e.className,r=e.messageBarType,i=e.onDismiss,s=e.actions,o=e.truncated,u=e.isMultiline,a=this.state.expandSingleLine;return y(this.props.styles,{theme:t,messageBarType:r||g.e.info,onDismiss:void 0!==i,actions:void 0!==s,truncated:o,isMultiline:u,expandSingleLine:a,className:n})};t.prototype._getAnnouncementPriority=function(){switch(this.props.messageBarType){case g.e.blocked:case g.e.error:case g.e.severeWarning:return"assertive"}return"polite"};t.defaultProps={messageBarType:g.e.info,onDismiss:void 0,isMultiline:!0};return t})(a.Component),w=n(25),E={root:"ms-MessageBar",error:"ms-MessageBar--error",blocked:"ms-MessageBar--blocked",severeWarning:"ms-MessageBar--severeWarning",success:"ms-MessageBar--success",warning:"ms-MessageBar--warning",multiline:"ms-MessageBar-multiline",singleline:"ms-MessageBar-singleline",dismissalSingleLine:"ms-MessageBar-dismissalSingleLine",expandingSingleLine:"ms-MessageBar-expandingSingleLine",content:"ms-MessageBar-content",iconContainer:"ms-MessageBar-icon",text:"ms-MessageBar-text",innerText:"ms-MessageBar-innerText",dismissSingleLine:"ms-MessageBar-dismissSingleLine",expandSingleLine:"ms-MessageBar-expandSingleLine",dismissal:"ms-MessageBar-dismissal",expand:"ms-MessageBar-expand",actions:"ms-MessageBar-actions",actionsSingleline:"ms-MessageBar-actionsSingleLine"},S=((r={})[g.e.error]="errorBackground",r[g.e.blocked]="errorBackground",r[g.e.success]="successBackground",r[g.e.warning]="warningBackground",r[g.e.severeWarning]="severeWarningBackground",r[g.e.info]="infoBackground",r),x=((i={})[g.e.error]="rgba(255, 0, 0, 0.3)",i[g.e.blocked]="rgba(255, 0, 0, 0.3)",i[g.e.success]="rgba(48, 241, 73, 0.3)",i[g.e.warning]="rgba(255, 254, 57, 0.3)",i[g.e.severeWarning]="rgba(255, 0, 0, 0.3)",i[g.e.info]="Window",i),T=((s={})[g.e.error]="errorIcon",s[g.e.blocked]="errorIcon",s[g.e.success]="successIcon",s[g.e.warning]="warningIcon",s[g.e.severeWarning]="severeWarningIcon",s[g.e.info]="infoIcon",s),N=Object(o.e)(b,function(e){var t,n,r,i,s,o=e.theme,a=e.className,f=e.onDismiss,l=e.truncated,c=e.isMultiline,h=e.expandSingleLine,p=e.messageBarType,d=void 0===p?g.e.info:p,v=o.semanticColors,m=o.fonts,y=Object(w.A)(0,w.l),b=Object(w.x)(E,o),N={fontSize:w.u.xSmall,height:10,lineHeight:"10px",color:v.messageText,selectors:(t={},t[w.s]=Object(u.e)(Object(u.e)({},Object(w.T)()),{color:"WindowText"}),t)},C=[Object(w.S)(o,{inset:1,highContrastStyle:{outlineOffset:"-6px",outline:"1px solid Highlight"},borderColor:"transparent"}),{flexShrink:0,width:32,height:32,padding:"8px 12px",selectors:{"& .ms-Button-icon":N,":hover":{backgroundColor:"transparent"},":active":{backgroundColor:"transparent"}}}];return{root:[b.root,m.medium,d===g.e.error&&b.error,d===g.e.blocked&&b.blocked,d===g.e.severeWarning&&b.severeWarning,d===g.e.success&&b.success,d===g.e.warning&&b.warning,c?b.multiline:b.singleline,!c&&f&&b.dismissalSingleLine,!c&&l&&b.expandingSingleLine,{background:v[S[d]],color:v.messageText,minHeight:32,width:"100%",display:"flex",wordBreak:"break-word",selectors:(n={".ms-Link":{color:v.messageLink,selectors:{":hover":{color:v.messageLinkHovered}}}},n[w.s]=Object(u.e)(Object(u.e)({},Object(w.T)()),{background:x[d],border:"1px solid WindowText",color:"WindowText"}),n)},c&&{flexDirection:"column"},a],content:[b.content,{display:"flex",width:"100%",lineHeight:"normal"}],iconContainer:[b.iconContainer,{fontSize:w.u.medium,minWidth:16,minHeight:16,display:"flex",flexShrink:0,margin:"8px 0 8px 12px"}],icon:{color:v[T[d]],selectors:(r={},r[w.s]=Object(u.e)(Object(u.e)({},Object(w.T)()),{color:"WindowText"}),r)},text:[b.text,Object(u.e)(Object(u.e)({minWidth:0,display:"flex",flexGrow:1,margin:8},m.small),{selectors:(i={},i[w.s]=Object(u.e)({},Object(w.T)()),i)}),!f&&{marginRight:12}],innerText:[b.innerText,{lineHeight:16,selectors:{"& span a":{paddingLeft:4}}},l&&{overflow:"visible",whiteSpace:"pre-wrap"},!c&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},!c&&!l&&{selectors:(s={},s[y]={overflow:"visible",whiteSpace:"pre-wrap"},s)},h&&{overflow:"visible",whiteSpace:"pre-wrap"}],dismissSingleLine:b.dismissSingleLine,expandSingleLine:b.expandSingleLine,dismissal:[b.dismissal,C],expand:[b.expand,C],actions:[c?b.actions:b.actionsSingleline,{display:"flex",flexGrow:0,flexShrink:0,flexBasis:"auto",flexDirection:"row-reverse",alignItems:"center",margin:"0 12px 0 8px",selectors:{"& button:nth-child(n+2)":{marginLeft:8}}},c&&{marginBottom:8},f&&!c&&{marginRight:0}]}},void 0,{scope:"MessageBar"})},function(e,t,n){"use strict";var r=n(1713),i=n(103),s=n(63),o=(function(){function e(){}e.clearThemeCache=function(){var t=e.getThemeDataStore();t.remove("Data");t.remove("CacheToken");t.remove("CacheVersion")};e.getCachedTheme=function(t){var n,r=e.getThemeDataStore();try{t===r.getValue("CacheToken")&&"1.7"===r.getValue("CacheVersion")&&(n=r.getValue("Data"))}catch(e){}return n};e.updateThemeCache=function(t,n){var r=e.getThemeDataStore();r.setValue("Data",t);r.setValue("CacheToken",n||t.cacheToken);r.setValue("CacheVersion","1.7")};e.getThemeDataStore=function(){return new i.e("odTheme",s.e.local)};return e})(),u=n(52),a=n(48),f=n(109),l=(function(){function e(e){this._loadData=e}e.getBackgroundUrl=function(t){return t?e._makeCssUrl(t.backgroundImageUri):"none"};e._makeCssUrl=function(t){var n="none";t&&(n='url("'+e._escapeQuotesAndParentheses(t)+'")');return n};e._escapeQuotesAndParentheses=function(e){var t={"'":"%27",'"':"%22","(":"%28",")":"%29"},n=null;null!=e&&(n=e.replace(/(['"\(\)])/gm,function(e,n){return t[n]}));return n};e.prototype.loadThemeTokenMap=function(t,n){return this.loadThemeData(t,n).then(function(t){var n;if(t&&t.palette){n={};var i=t.palette;for(var s in i){var o=i[s];n[s]=o?r.e.toHtmlString(o):null}n.backgroundImageUri=e._makeCssUrl(t.backgroundImageUri)}return n},function(e){return null})};e.prototype.loadThemeData=function(e,t){if(!t&&this._dataPromise)return this._dataPromise;var n=this,r=null,i=a.e.Failure;this._dataPromise=f.e.instrumentPromise({name:"ThemeProvider.LoadData"},function(){return new u.n(function(s,f){var l=null;t||(l=o.getCachedTheme(e));l?s(l):n._loadData(t).done(function(t){if(t){t.cacheToken&&o.updateThemeCache(t,e);s(t)}else{r="NoData";f&&f("No model returned")}},function(e){if(u.n.isCanceled(e)){r="Canceled";i=a.e.ExpectedFailure}else r="ServerLoadFailure";f&&f(e)})})},null,function(e){if(u.n.isCanceled(e)){i=a.e.ExpectedFailure;r="Canceled"}var t=e;if(e){var n={name:e.name||void 0,message:e.message&&e.message.value||e.message||void 0,correlationId:e.correlationId||void 0};t=JSON.stringify(n)}return{resultType:i,resultCode:r||"Other",error:t}});return this._dataPromise};return e})();t.e=l},,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(25),i=n(86),s=Object(i.t)(function(){return Object(r._)({from:{opacity:0},to:{opacity:1}})}),o=Object(i.t)(function(){return Object(r._)({from:{transform:"translateX(-10px)"},to:{transform:"translateX(0)"}})}),u=Object(i.t)(function(e,t,n,i,u,a){var f;void 0===e&&(e=Object(r.O)());var l={animationName:r.a.continuousPulseAnimationSingle(i||e.palette.themePrimary,u||e.palette.themeTertiary,"4px","28px","4px"),animationIterationCount:"1",animationDuration:".8s",zIndex:1},c={animationName:o(),animationIterationCount:"1",animationDuration:".5s"},h={animationName:s(),animationIterationCount:"1",animationDuration:".5s"},p={root:[e.fonts.small,{display:"flex",justifyContent:"flex-start",alignItems:"flex-start",boxSizing:"border-box",color:e.palette.neutralSecondary},a&&n&&h],pulsingBeacon:[{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"0px",height:"0px",borderRadius:"225px",borderStyle:"solid",opacity:0},a&&n&&l],isCompactRoot:{alignItems:"center"},personaContainer:{display:"flex",flexWrap:"wrap",minWidth:"32px",width:"32px",height:"32px"},isCompactPersonaContainer:{display:"inline-flex",flexWrap:"nowrap",flexBasis:"auto",height:"16px",width:"auto",minWidth:"0",paddingRight:"6px"},activityTypeIcon:{height:"32px",fontSize:"16px",lineHeight:"16px",marginTop:"3px"},isCompactIcon:{height:"16px",minWidth:"16px",fontSize:"13px",lineHeight:"13px",color:e.palette.themePrimary,marginTop:"1px",position:"relative",display:"flex",justifyContent:"center",alignItems:"center",selectors:{".ms-Persona-imageArea":{margin:"-2px 0 0 -2px",border:"2px solid"+e.palette.white,borderRadius:"50%",selectors:(f={},f[r.s]={border:"none",margin:"0"},f)}}},activityPersona:{display:"block"},doublePersona:{selectors:{":first-child":{alignSelf:"flex-end"}}},isCompactPersona:{display:"inline-block",width:"8px",minWidth:"8px",overflow:"visible"},activityContent:[{padding:"0 8px"},a&&n&&c],activityText:{display:"inline"},isCompactContent:{flex:"1",padding:"0 4px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflowX:"hidden"},commentText:{color:e.palette.neutralPrimary},timeStamp:[e.fonts.tiny,{fontWeight:400,color:e.palette.neutralSecondary}],isCompactTimeStamp:{display:"inline-block",paddingLeft:"0.3em",fontSize:"1em"}};return Object(r.y)(p,t)})},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(25),i=n(86),s=Object(i.t)(function(e,t,n,i){return{root:Object(r.H)("ms-ActivityItem",t,e.root,i&&e.isCompactRoot),pulsingBeacon:Object(r.H)("ms-ActivityItem-pulsingBeacon",e.pulsingBeacon),personaContainer:Object(r.H)("ms-ActivityItem-personaContainer",e.personaContainer,i&&e.isCompactPersonaContainer),activityPersona:Object(r.H)("ms-ActivityItem-activityPersona",e.activityPersona,i&&e.isCompactPersona,!i&&n&&2===n.length&&e.doublePersona),activityTypeIcon:Object(r.H)("ms-ActivityItem-activityTypeIcon",e.activityTypeIcon,i&&e.isCompactIcon),activityContent:Object(r.H)("ms-ActivityItem-activityContent",e.activityContent,i&&e.isCompactContent),activityText:Object(r.H)("ms-ActivityItem-activityText",e.activityText),commentText:Object(r.H)("ms-ActivityItem-commentText",e.commentText),timeStamp:Object(r.H)("ms-ActivityItem-timeStamp",e.timeStamp,i&&e.isCompactTimeStamp)}})},,,,,,,,,,,,,function(e,t){var n,r,i=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}(function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}})();function u(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout){n=setTimeout;return setTimeout(e,0)}try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}var a,f=[],l=!1,c=-1;function h(){if(l&&a){l=!1;a.length?f=a.concat(f):c=-1;f.length&&p()}}function p(){if(!l){var e=u(h);l=!0;for(var t=f.length;t;){a=f;f=[];for(;++c<t;)a&&a[c].run();c=-1;t=f.length}a=null;l=!1;(function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout){r=clearTimeout;return clearTimeout(e)}try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}})(e)}}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];f.push(new d(e,t));1!==f.length||l||u(p)};function d(e,t){this.fun=e;this.array=t}d.prototype.run=function(){this.fun.apply(null,this.array)};i.title="browser";i.browser=!0;i.env={};i.argv=[];i.version="";i.versions={};function v(){}i.on=v;i.addListener=v;i.once=v;i.off=v;i.removeListener=v;i.removeAllListeners=v;i.emit=v;i.prependListener=v;i.prependOnceListener=v;i.listeners=function(e){return[]};i.binding=function(e){throw new Error("process.binding is not supported")};i.cwd=function(){return"/"};i.chdir=function(e){throw new Error("process.chdir is not supported")};i.umask=function(){return 0}},,function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"r",function(){return i});n.d(t,"n",function(){return s});n.d(t,"e",function(){return o});var r,i,s,o;(function(e){e[e.Sunday=0]="Sunday";e[e.Monday=1]="Monday";e[e.Tuesday=2]="Tuesday";e[e.Wednesday=3]="Wednesday";e[e.Thursday=4]="Thursday";e[e.Friday=5]="Friday";e[e.Saturday=6]="Saturday"})(r||(r={}));(function(e){e[e.January=0]="January";e[e.February=1]="February";e[e.March=2]="March";e[e.April=3]="April";e[e.May=4]="May";e[e.June=5]="June";e[e.July=6]="July";e[e.August=7]="August";e[e.September=8]="September";e[e.October=9]="October";e[e.November=10]="November";e[e.December=11]="December"})(i||(i={}));(function(e){e[e.FirstDay=0]="FirstDay";e[e.FirstFullWeek=1]="FirstFullWeek";e[e.FirstFourDayWeek=2]="FirstFourDayWeek"})(s||(s={}));(function(e){e[e.Day=0]="Day";e[e.Week=1]="Week";e[e.Month=2]="Month";e[e.WorkWeek=3]="WorkWeek"})(o||(o={}))},,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(11),i=n(2053),s=n(2054),o=n(1430),u=Object(r.s)("GraphDataRequestor",o.e,{sessionManagementProvider:i.resourceKey,urlDataSource:s.resourceKey});o.e},,,,,function(e,t,n){"use strict";var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.items=t.items.filter(s);n.rootElementClass=t.rootElementClass||null;n.boundingElementClass=t.boundingElementClass||null;n.shouldHideIcons=!!t.shouldHideIcons;n.engagementSource=t.engagementSource||null;n.alignment=t.alignment;n.point=t.point;n.anchorElement=t.anchorElement;n.isMenuOpen=t.isMenuOpen;var r=t.dismissOnClick,i=void 0===r||r;n.dismissOnClick=i;return n}return t})(n(1649).n);function s(e){return 8==(8&e.location)}t.e=i},,,,,,,,function(e,t,n){"use strict";var r=n(1652),i=n(0),s=n(1651),o=n(391),u=n(1820),a=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._item=n.wrapObservable(t.item);n.name=n.createPureComputed(n._computeName);var r=n.resources.consume(o.e);n.open=new(n.managed(r.OpenAction))({openRelation:2,item:n._item});return n}t.prototype.execute=function(e,t){if(e.isAvailable()){e.execute(t).done();return!1}};t.prototype._computeName=function(){var e=this._item();return e&&(e.displayName||e.name)||u.fileTypeFolder.toLocaleLowerCase()};return t})(s.t),f=r.e({tagName:"od-item-link",template:'\x3c!--ko with:open--\x3e\x3c!--ko if:isAvailable--\x3e<a class="od-ItemLink" href="#" data-bind="click:$component.execute.bind($component),text:$component.name"></a>\x3c!--/ko--\x3e\x3c!--ko ifnot:isAvailable--\x3e<span class="od-ItemLink" data-bind="text:$component.name"></span>\x3c!--/ko--\x3e\x3c!--/ko--\x3e',viewModel:a,synchronous:!0});t.e=f},function(e,t,n){"use strict";n.d(t,"e",function(){return g});var r=n(4),i=n("react-lib"),s=n(1786),o=n(1956),u=n(1377),a=n(270),f=function(e,t){return t.spacing.hasOwnProperty(e)?t.spacing[e]:e},l=function(e){var t=parseFloat(e),n=isNaN(t)?0:t,r=isNaN(t)?"":t.toString();return{value:n,unit:e.substring(r.toString().length)||"px"}},c=function(e,t){if(void 0===e||"number"==typeof e||""===e)return e;var n=e.split(" ");return n.length<2?f(e,t):n.reduce(function(e,n){return f(e,t)+" "+f(n,t)})},h=n(25),p={start:"flex-start",end:"flex-end"},d={root:"ms-Stack",inner:"ms-Stack-inner"},v=n(1808);var m={Item:v.e},g=Object(o.e)(function(e){var t=e.as,n=void 0===t?"div":t,o=e.disableShrink,f=e.wrap,l=Object(r.s)(e,["as","disableShrink","wrap"]);Object(u.e)("Stack",e,{gap:"tokens.childrenGap",maxHeight:"tokens.maxHeight",maxWidth:"tokens.maxWidth",padding:"tokens.padding"});var c=i.Children.map(e.children,function(e,t){if(!e)return null;if((s=e)&&"object"==typeof s&&s.type&&s.type.displayName===v.e.displayName){var n={shrink:!o};return i.cloneElement(e,Object(r.e)(Object(r.e)({},n),e.props))}var s;return e}),h=Object(a.u)(l,a.a),p=Object(s.t)(e,{root:n,inner:"div"});return f?Object(s.n)(p.root,Object(r.e)({},h),Object(s.n)(p.inner,null,c)):Object(s.n)(p.root,Object(r.e)({},h),c)},{displayName:"Stack",styles:function(e,t,n){var i,s,o,u,a,v,m,g=e.verticalFill,y=e.horizontal,b=e.reversed,w=e.grow,E=e.wrap,S=e.horizontalAlign,x=e.verticalAlign,T=e.disableShrink,N=e.className,C=Object(h.x)(d,t),k=n&&n.childrenGap?n.childrenGap:e.gap,L=n&&n.maxHeight?n.maxHeight:e.maxHeight,A=n&&n.maxWidth?n.maxWidth:e.maxWidth,O=n&&n.padding?n.padding:e.padding,M=(function(e,t){if(void 0===e||""===e)return{rowGap:{value:0,unit:"px"},columnGap:{value:0,unit:"px"}};if("number"==typeof e)return{rowGap:{value:e,unit:"px"},columnGap:{value:e,unit:"px"}};var n=e.split(" ");if(n.length>2)return{rowGap:{value:0,unit:"px"},columnGap:{value:0,unit:"px"}};if(2===n.length)return{rowGap:l(f(n[0],t)),columnGap:l(f(n[1],t))};var r=l(f(e,t));return{rowGap:r,columnGap:r}})(k,t),_=M.rowGap,D=M.columnGap,P=""+-.5*D.value+D.unit,H=""+-.5*_.value+_.unit,B={textOverflow:"ellipsis"},j={"> *:not(.ms-StackItem)":{flexShrink:T?0:1}};return E?{root:[C.root,{flexWrap:"wrap",maxWidth:A,maxHeight:L,width:"auto",overflow:"visible",height:"100%"},S&&(i={},i[y?"justifyContent":"alignItems"]=p[S]||S,i),x&&(s={},s[y?"alignItems":"justifyContent"]=p[x]||x,s),N,{display:"flex"},y&&{height:g?"100%":"auto"}],inner:[C.inner,{display:"flex",flexWrap:"wrap",marginLeft:P,marginRight:P,marginTop:H,marginBottom:H,overflow:"visible",boxSizing:"border-box",padding:c(O,t),width:0===D.value?"100%":"calc(100% + "+D.value+D.unit+")",maxWidth:"100vw",selectors:Object(r.e)({"> *":Object(r.e)({margin:""+.5*_.value+_.unit+" "+.5*D.value+D.unit},B)},j)},S&&(o={},o[y?"justifyContent":"alignItems"]=p[S]||S,o),x&&(u={},u[y?"alignItems":"justifyContent"]=p[x]||x,u),y&&{flexDirection:b?"row-reverse":"row",height:0===_.value?"100%":"calc(100% + "+_.value+_.unit+")",selectors:{"> *":{maxWidth:0===D.value?"100%":"calc(100% - "+D.value+D.unit+")"}}},!y&&{flexDirection:b?"column-reverse":"column",height:"calc(100% + "+_.value+_.unit+")",selectors:{"> *":{maxHeight:0===_.value?"100%":"calc(100% - "+_.value+_.unit+")"}}}]}:{root:[C.root,{display:"flex",flexDirection:y?b?"row-reverse":"row":b?"column-reverse":"column",flexWrap:"nowrap",width:"auto",height:g?"100%":"auto",maxWidth:A,maxHeight:L,padding:c(O,t),boxSizing:"border-box",selectors:Object(r.e)((a={"> *":B},a[b?"> *:not(:last-child)":"> *:not(:first-child)"]=[y&&{marginLeft:""+D.value+D.unit},!y&&{marginTop:""+_.value+_.unit}],a),j)},w&&{flexGrow:!0===w?1:w},S&&(v={},v[y?"justifyContent":"alignItems"]=p[S]||S,v),x&&(m={},m[y?"alignItems":"justifyContent"]=p[x]||x,m),N]}},statics:m})},,,function(e,t,n){"use strict";n.r(t);var r;(function(e){e.getParent=function(e,t){if(e.level&&e.parentKey&&0!==e.level){return t.filter(function(t){return t.groupingId===e.parentKey})[0]}};e.getFilterDetails=function(n,r){for(var i=n,s=[],o=[];i&&i.fieldSchema;){s.unshift(i.fieldSchema.Name);var u=t(i);o.unshift(u);i=e.getParent(i,r)}return{fields:s,values:o}};function t(e){var t="";switch(e.fieldSchema.Type){case"User":case"Lookup":t=e.name;break;case"DateTime":var n=decodeURIComponent(e.groupString).split(";#"),r=n[0];n.length>0&&(n=n.slice(1,n.length-1))[e.level]&&(r=n[e.level]);t=(function(e){if(!e)return e;var t=e.substring(0,4),n=e.substring(4,6),r=e.substring(6,8);return[t,"-",n,"-",r].join("")})(r);break;default:t=e.fieldValue}return t}})(r||(r={}));t.default=r},,,function(e,t,n){"use strict";n.d(t,"e",function(){return v});n.d(t,"t",function(){return m});n.d(t,"i",function(){return g});n.d(t,"n",function(){return y});n.d(t,"r",function(){return b});var r=n("knockout-lib"),i=n(2566),s=n(133),o=n(2028),u=n(52),a=n(1661),f=n(1726),l=n(1666),c=n(1990),h=n(22),p=n(996),d=n(1954);function v(e,t,n,f){var l=r.observable(!0);return n.requestDialog({title:i.n,size:"Medium",customCssClasses:"od-ConfirmationDialog",component:{name:o.e.tagName,params:{message:i.t}},actions:[{name:i.e,execute:function(){s.e.logData({name:"Confirm.DisableLink."+f+".Click",isIntentional:!0});l(!1);var n=e().then(function(e){return u.n.wrap(e?2:3)});t(n);return n},isDefault:!0,isAvailable:l,icon:new a.e("Save"),automationId:"UnshareConfirm"},{name:i.r,execute:function(){s.e.logData({name:"KeepExisting.DisableLink."+f+".Click",isIntentional:!0});return u.n.wrap(3)},isDefault:!1,icon:new a.e("Cancel"),automationId:"UnshareCancel"}],executeDefaultAction:!1})}function m(e,t,n){return n.requestDialog({title:t,size:"Small",component:{name:f.e.tagName,params:{text:e}},actions:[{name:l.Close,execute:function(){return u.n.wrap(2)},isAvailable:r.observable(!0),icon:new a.e("Save"),isDefault:!0}],executeDefaultAction:!1}).wait()}function g(e,t){for(var n=0,r=0,i=!1,s=0,o=e.people;s<o.length;s++){var u=o[s];if(2===u.entityType)r++;else if(0!==u.sharingInfo.role){n++;1===u.entityType&&(i=!0)}}var a="";r>0&&n>0?a=r>1?h.format(i?c.E:c.b,t,r,n):h.format(i?c.w:c.y,t,n):1===r?a=h.format(c.d,t):r>1?a=h.format(c.v,t,r):n>0&&i?a=h.format(c.g,t,n):n>1?a=h.format(c.m,t,n):1===n&&(a=h.format(c.S,t));return a}function y(e){if(!e)return 0;var t=e.getTime()-(new Date).getTime();return Math.ceil(t/864e5)}function b(e,t){if(e||t&&this._item){var n=(null==t?void 0:t.expiration)?Object(p.s)(new Date(t.expiration)):null;switch(e){case 1:return n?h.format(d.p,n):d.h;case 2:return n?h.format(d.r,n):d.n;case 6:return d.a;case 4:return d.t;case 0:return d.o;case 7:return t.customRole}}return""}},function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(156),i=n(326),s="formFactorChange",o="hamburgerVisibilityChange",u="showCommandLabelsChange",a={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},f={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0},l=(function(){function e(e,t){this._scope=new i.e;this._events=new(this._scope.attached(r.t))(this);this._events.on(window,"resize, orientationchange",this._onContainerResize.bind(this));var n=t.breakpoints;this._breakpoints="function"==typeof n?n:function(){return n};this._windowWidth=0;this._windowHeight=0;this._onContainerResize()}e.reduceBreakpoints=function(e,t){return{Small:t,Medium:e.Small,Large:e.Medium,XLarge:e.Large,XXLarge:e.XLarge,XXXLarge:e.XXLarge,XXXXLarge:1/0}};e.determineWindowSize=function(e,t){void 0===t&&(t=f);if(0===e)return"Medium";for(var n in f)if(e<t[n])return n};e.determineCssClass=function(e){return a[e]};e.getScrollbarWidth=function(){var e=document.createElement("div"),t=document.createElement("div"),n=e.style;n.visibility="hidden";n.width="100px";n.msOverflowStyle="scrollbar";n.overflow="scroll";t.style.width="100%";document.body.appendChild(e);e.appendChild(t);var r=e.offsetWidth,i=t.offsetWidth;e.parentNode.removeChild(e);var s=r-i;this.getScrollbarWidth=function(){return s};return s};Object.defineProperty(e.prototype,"windowWidth",{get:function(){return this._windowWidth},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"windowHeight",{get:function(){return this._windowHeight},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"formFactorSize",{get:function(){return this._formFactorSize},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isHamburgerVisible",{get:function(){return this._isHamburgerVisible},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"showLabels",{get:function(){return this._showLabels},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"cssClass",{get:function(){return this._cssClass},enumerable:!0,configurable:!0});e.prototype.dispose=function(){this._scope.dispose()};e.prototype.compareSize=function(e,t){var n=this._breakpoints();return n[e]-n[t]};e.prototype._afterContainerResize=function(){};e.prototype._onContainerResize=function(){var t=document.body,n=document.documentElement,r=this._windowHeight=n.clientWidth||t.clientWidth;this._windowWidth=n.clientHeight||t.clientHeight;var i=this._formFactorSize,a=this._formFactorSize=e.determineWindowSize(r,this._breakpoints());this._cssClass=e.determineCssClass(a);var l=this._isHamburgerVisible;this._isHamburgerVisible=r<f.Large;var c=this._showLabels;this._showLabels=this.compareSize(a,"Medium")>0;i&&a!==i&&this._events.raise(s);"boolean"==typeof l&&l!==this._isHamburgerVisible&&this._events.raise(o);"boolean"==typeof c&&c!==this._showLabels&&this._events.raise(u);this._afterContainerResize()};e.DEFAULT_BREAKPOINTS=f;e.MAC_SCROLL_BAR_WIDTH=8;return e})();t.t=l},function(e,t,n){"use strict";n.d(t,"t",function(){return o});n.d(t,"e",function(){return u});var r=n(141),i={word:["doc","docm","docx","docb","dot","dotm","dotx"],excel:["xls","xlsb","xlsm","xlsx","xlt","xltm","xltx"],powerpoint:["ppt","pptm","pptx","sldx","sldm","pot","potm","potx","pps","ppsm","ppsx"],onenote:["one"],visio:["vsd","vsdm","vsdx","vdw","vss","vssm","vssx","vst","vstm","vstx"],fluid:["fluid"],pdf:["pdf"],document:["epub","gdoc","odt","rtf","wri","pages"],presentation:["odp","gslides","key"],spreadsheet:["ods","gsheet","numbers"],txt:["dif","diff","readme","out","plist","properties","text","txt"],archive:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","z","zip"],photo:["arw","bmp","cr2","crw","dcr","dds","dib","dng","erf","gif","heic","heif","ico","jfi","jfif","jif","jpe","jpeg","jpg","kdc","mrw","nef","orf","pct","pict","png","pns","psd","raw","tga","tif","tiff","wdp"],audio:["aif","aiff","aac","amr","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","ogg","oga","ra","rm","wav","wma","wv"],video:["3g2","3gp","3gp2","3gpp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4"," mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"],vector:["ai","dgn","gdraw","pd","emf","eps","fig","indd","indt","ps","svg","svgz","wmf","oxps","xps","xd","sketch"],model:["3ds","3mf","blend","cool","dae","df","dwfx","dwg","dxf","fbx","glb","gltf","holo","layout","max","off","ply","skp","stp","stl","t","thl","x"],csv:["csv"],xml:["xaml","xml","xsl"],html:["htm","html","mht"],code:["abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","config","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","Hcp","h","h++","haml","handlebars","hbs","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","mak","make","manifest","master","md","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","pss","pt","py","pyw","r","rake","rb","rbx","rc","rdf","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","ruby","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","sh","shtml","sml","svn-base","sql","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","vmg","webpart","wsp","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"],email:["eml","msg","ost","pst"],application:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"],font:["ttf","otf","woff"],sysfile:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","kdc","ldt","lrprev","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xll"]},s=void 0;function o(e){return e?null!==e.itemType&&void 0!==e.itemType&&e.itemType!==r.t.File?r.t[e.itemType].toLowerCase():u(e.extension):"none"}function u(e){if(!e)return"none";if(!s){s={};Object.keys(i).map(function(e){i[e].forEach(function(t){s[t]=e})})}var t=s[e.toLowerCase()];return t||"other"}},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return X});var r,i,s,o=n(1419),u=n(4),a=n("react-lib"),f=n(472),l=n(1019),c=n(180),h=n(129),p=n(774),d=n(886),v=n(653),m=n(270),g=n(1621),y=n(1372),b=n(1623),w=n(1624),E=n(1439),S=n(1959),x=n(1948),T=n(97),N=n(2034),C=(function(){function e(){this._size=0}e.prototype.updateOptions=function(e){for(var t=[],n=0,r=0;r<e.length;r++)e[r].itemType===N.e.Divider||e[r].itemType===N.e.Header?t.push(r):e[r].hidden||n++;this._size=n;this._displayOnlyOptionsCache=t;this._cachedOptions=Object(u.o)(e)};Object.defineProperty(e.prototype,"optionSetSize",{get:function(){return this._size},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"cachedOptions",{get:function(){return this._cachedOptions},enumerable:!0,configurable:!0});e.prototype.positionInSet=function(e){if(void 0!==e){for(var t=0;e>this._displayOnlyOptionsCache[t];)t++;if(this._displayOnlyOptionsCache[t]===e)throw new Error("Unexpected: Option at index "+e+" is not a selectable element.");return e-t+1}};return e})(),k=n(1648),L=n(287),A=n(993),O=n(1845),M=n(1633),_=n(1912),D=n(182),P=n(2035),H=Object(f.e)(),B=(function(e){Object(u.r)(t,e);function t(t){var n,r,i=e.call(this,t)||this;i._host=a.createRef();i._focusZone=a.createRef();i._dropDown=a.createRef();i._scrollIdleDelay=250;i._sizePosCache=new C;i._requestAnimationFrame=(n=i,function(e){if(!r){r=new Set;Object(l.e)(n,{componentWillUnmount:function(){r.forEach(function(e){return cancelAnimationFrame(e)})}})}var t=requestAnimationFrame(function(){r.delete(t);e()});r.add(t)});i._onChange=function(e,t,n,r,s){var o=i.props,a=o.onChange,f=o.onChanged;if(a||f){var l=s?Object(u.e)(Object(u.e)({},t[n]),{selected:!r}):t[n];a&&a(Object(u.e)(Object(u.e)({},e),{target:i._dropDown.current}),l,n);f&&f(l,n)}};i._getPlaceholder=function(){return i.props.placeholder||i.props.placeHolder};i._getTitle=function(e,t){var n=i.props.multiSelectDelimiter,r=void 0===n?", ":n;return e.map(function(e){return e.text}).join(r)};i._onRenderTitle=function(e){return a.createElement(a.Fragment,null,i._getTitle(e))};i._onRenderPlaceholder=function(e){return i._getPlaceholder()?a.createElement(a.Fragment,null,i._getPlaceholder()):null};i._onRenderContainer=function(e){var t=e.calloutProps,n=e.panelProps,r=i.props,s=r.responsiveMode,o=r.dropdownWidth,f=s<=D.e.medium,l=i._classNames.subComponentStyles?i._classNames.subComponentStyles.panel:void 0,c=void 0,h=void 0;"auto"===o?h=i._dropDown.current?i._dropDown.current.clientWidth:0:c=o||(i._dropDown.current?i._dropDown.current.clientWidth:0);return f?a.createElement(_.e,Object(u.e)({isOpen:!0,isLightDismiss:!0,onDismiss:i._onDismiss,hasCloseButton:!1,styles:l},n),i._renderFocusableList(e)):a.createElement(E.e,Object(u.e)({isBeakVisible:!1,gapSpace:0,doNotLayer:!1,directionalHintFixed:!1,directionalHint:T.e.bottomLeftEdge,calloutWidth:c,calloutMinWidth:h},t,{className:i._classNames.callout,target:i._dropDown.current,onDismiss:i._onDismiss,onScroll:i._onScroll,onPositioned:i._onPositioned}),i._renderFocusableList(e))};i._onRenderCaretDown=function(e){return a.createElement(A.e,{className:i._classNames.caretDown,iconName:"ChevronDown","aria-hidden":!0})};i._onRenderList=function(e){var t=e.onRenderItem,n=void 0===t?i._onRenderItem:t,r={items:[]},s=[],o=function(){var e=r.id?[a.createElement("div",{role:"group",key:r.id,"aria-labelledby":r.id},r.items)]:r.items;s=Object(u.o)(s,e);r={items:[]}};e.options.forEach(function(e,t){(function(e,t){switch(e.itemType){case N.e.Header:r.items.length>0&&o();var s=i._id+e.key;r.items.push(n(Object(u.e)(Object(u.e)({id:s},e),{index:t}),i._onRenderItem));r.id=s;break;case N.e.Divider:t>0&&r.items.push(n(Object(u.e)(Object(u.e)({},e),{index:t}),i._onRenderItem));r.items.length>0&&o();break;default:r.items.push(n(Object(u.e)(Object(u.e)({},e),{index:t}),i._onRenderItem))}})(e,t)});r.items.length>0&&o();return a.createElement(a.Fragment,null,s)};i._onRenderItem=function(e){switch(e.itemType){case N.e.Divider:return i._renderSeparator(e);case N.e.Header:return i._renderHeader(e);default:return i._renderOption(e)}};i._renderOption=function(e){var t=i.props.onRenderOption,n=void 0===t?i._onRenderOption:t,r=i.state.selectedIndices,s=void 0===r?[]:r,o=!(void 0===e.index||!s)&&s.indexOf(e.index)>-1,u=e.hidden?i._classNames.dropdownItemHidden:o&&!0===e.disabled?i._classNames.dropdownItemSelectedAndDisabled:o?i._classNames.dropdownItemSelected:!0===e.disabled?i._classNames.dropdownItemDisabled:i._classNames.dropdownItem,f=e.title,l=void 0===f?e.text:f,c=i._classNames.subComponentStyles?i._classNames.subComponentStyles.multiSelectItem:void 0;return i.props.multiSelect?a.createElement(S.e,{id:i._listId+e.index,key:e.key,"data-index":e.index,"data-is-focusable":!e.disabled,disabled:e.disabled,onChange:i._onItemClick(e),inputProps:{"aria-selected":o,onMouseEnter:i._onItemMouseEnter.bind(i,e),onMouseLeave:i._onMouseItemLeave.bind(i,e),onMouseMove:i._onItemMouseMove.bind(i,e),role:"option"},label:e.text,title:l,onRenderLabel:i._onRenderItemLabel.bind(i,e),className:u,checked:o,styles:c,ariaPositionInSet:i._sizePosCache.positionInSet(e.index),ariaSetSize:i._sizePosCache.optionSetSize}):a.createElement(x.e,{id:i._listId+e.index,key:e.key,"data-index":e.index,"data-is-focusable":!e.disabled,disabled:e.disabled,className:u,onClick:i._onItemClick(e),onMouseEnter:i._onItemMouseEnter.bind(i,e),onMouseLeave:i._onMouseItemLeave.bind(i,e),onMouseMove:i._onItemMouseMove.bind(i,e),role:"option","aria-selected":o?"true":"false",ariaLabel:e.ariaLabel,title:l,"aria-posinset":i._sizePosCache.positionInSet(e.index),"aria-setsize":i._sizePosCache.optionSetSize},n(e,i._onRenderOption))};i._onRenderOption=function(e){return a.createElement("span",{className:i._classNames.dropdownOptionText},e.text)};i._onRenderItemLabel=function(e){var t=i.props.onRenderOption;return(void 0===t?i._onRenderOption:t)(e,i._onRenderOption)};i._onPositioned=function(e){i._focusZone.current&&i._requestAnimationFrame(function(){var e=i.state.selectedIndices;if(i._focusZone.current)if(e&&e[0]&&!i.props.options[e[0]].disabled){var t=Object(c.e)().getElementById(i._id+"-list"+e[0]);t&&i._focusZone.current.focusElement(t)}else i._focusZone.current.focus()});i.state.calloutRenderEdge&&i.state.calloutRenderEdge===e.targetEdge||i.setState({calloutRenderEdge:e.targetEdge})};i._onItemClick=function(e){return function(t){if(!e.disabled){i.setSelectedIndex(t,e.index);i.props.multiSelect||i.setState({isOpen:!1})}}};i._onScroll=function(){if(i._isScrollIdle||void 0===i._scrollIdleTimeoutId)i._isScrollIdle=!1;else{clearTimeout(i._scrollIdleTimeoutId);i._scrollIdleTimeoutId=void 0}i._scrollIdleTimeoutId=setTimeout(function(){i._isScrollIdle=!0},i._scrollIdleDelay)};i._onMouseItemLeave=function(e,t){if(!i._shouldIgnoreMouseEvent()&&i._host.current)if(i._host.current.setActive)try{i._host.current.setActive()}catch(e){}else i._host.current.focus()};i._onDismiss=function(){i.setState({isOpen:!1})};i._onDropdownBlur=function(e){if(!i._isDisabled()){i.setState({hasFocus:!1});i.state.isOpen||i.props.onBlur&&i.props.onBlur(e)}};i._onDropdownKeyDown=function(e){if(!i._isDisabled()){i._lastKeyDownWasAltOrMeta=i._isAltOrMeta(e);if(i.props.onKeyDown){i.props.onKeyDown(e);if(e.defaultPrevented)return}var t,n=i.state.selectedIndices.length?i.state.selectedIndices[0]:-1,r=e.altKey||e.metaKey,s=i.state.isOpen;switch(e.which){case h.e.enter:i.setState({isOpen:!s});break;case h.e.escape:if(!s)return;i.setState({isOpen:!1});break;case h.e.up:if(r){if(s){i.setState({isOpen:!1});break}return}i.props.multiSelect?i.setState({isOpen:!0}):i._isDisabled()||(t=i._moveIndex(e,-1,n-1,n));break;case h.e.down:if(r){e.stopPropagation();e.preventDefault()}r&&!s||i.props.multiSelect?i.setState({isOpen:!0}):i._isDisabled()||(t=i._moveIndex(e,1,n+1,n));break;case h.e.home:i.props.multiSelect||(t=i._moveIndex(e,1,0,n));break;case h.e.end:i.props.multiSelect||(t=i._moveIndex(e,-1,i.props.options.length-1,n));break;case h.e.space:break;default:return}if(t!==n){e.stopPropagation();e.preventDefault()}}};i._onDropdownKeyUp=function(e){if(!i._isDisabled()){var t=i._shouldHandleKeyUp(e),n=i.state.isOpen;if(i.props.onKeyUp){i.props.onKeyUp(e);if(e.defaultPrevented)return}switch(e.which){case h.e.space:i.setState({isOpen:!n});break;default:t&&n&&i.setState({isOpen:!1});return}e.stopPropagation();e.preventDefault()}};i._onZoneKeyDown=function(e){var t;i._lastKeyDownWasAltOrMeta=i._isAltOrMeta(e);var n=e.altKey||e.metaKey;switch(e.which){case h.e.up:n?i.setState({isOpen:!1}):i._host.current&&(t=Object(p.u)(i._host.current,i._host.current.lastChild,!0));break;case h.e.home:case h.e.end:case h.e.pageUp:case h.e.pageDown:break;case h.e.down:!n&&i._host.current&&(t=Object(p.i)(i._host.current,i._host.current.firstChild,!0));break;case h.e.escape:i.setState({isOpen:!1});break;case h.e.tab:i.setState({isOpen:!1});return;default:return}t&&t.focus();e.stopPropagation();e.preventDefault()};i._onZoneKeyUp=function(e){if(i._shouldHandleKeyUp(e)&&i.state.isOpen){i.setState({isOpen:!1});e.preventDefault()}};i._onDropdownClick=function(e){if(i.props.onClick){i.props.onClick(e);if(e.defaultPrevented)return}var t=i.state.isOpen;i._isDisabled()||i._shouldOpenOnFocus()||i.setState({isOpen:!t});i._isFocusedByClick=!1};i._onDropdownMouseDown=function(){i._isFocusedByClick=!0};i._onFocus=function(e){if(!i._isDisabled()){i.props.onFocus&&i.props.onFocus(e);var t={hasFocus:!0};i._shouldOpenOnFocus()&&(t.isOpen=!0);i.setState(t)}};i._isDisabled=function(){var e=i.props.disabled,t=i.props.isDisabled;void 0===e&&(e=t);return e};i._onRenderLabel=function(e){var t=e.label,n=e.required,r=e.disabled,s=i._classNames.subComponentStyles?i._classNames.subComponentStyles.label:void 0;return t?a.createElement(O.e,{className:i._classNames.label,id:i._labelId,required:n,styles:s,disabled:r},t):null};Object(d.e)(i);var s,o=t.multiSelect,f=t.selectedKey,m=t.selectedKeys,g=t.defaultSelectedKey,y=t.defaultSelectedKeys,b=t.options;i._id=t.id||Object(v.e)("Dropdown");i._labelId=i._id+"-label";i._listId=i._id+"-list";i._optionId=i._id+"-option";i._isScrollIdle=!0;s=o?i._getSelectedIndexes(b,void 0!==y?y:m):i._getSelectedIndexes(b,void 0!==g?g:f);i._sizePosCache.updateOptions(b);i.state={isOpen:!1,selectedIndices:s,hasFocus:!1,calloutRenderEdge:void 0};return i}Object.defineProperty(t.prototype,"selectedOptions",{get:function(){var e=this.props.options,t=this.state.selectedIndices;return Object(P.e)(e,t)},enumerable:!0,configurable:!0});t.prototype.componentWillUnmount=function(){clearTimeout(this._scrollIdleTimeoutId)};t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t,n=e.options!==this.props.options;void 0===e[t=e.multiSelect?n&&void 0!==e.defaultSelectedKeys?"defaultSelectedKeys":"selectedKeys":n&&void 0!==e.defaultSelectedKey?"defaultSelectedKey":"selectedKey"]||e[t]===this.props[t]&&!n||this.setState({selectedIndices:this._getSelectedIndexes(e.options,e[t])})};t.prototype.componentDidUpdate=function(e,t){if(!0===t.isOpen&&!1===this.state.isOpen){this._gotMouseMove=!1;this.props.onDismiss&&this.props.onDismiss()}};t.prototype.render=function(){var e,t,n=this,r=this._id,i=this.props,s=i.className,o=i.label,f=i.options,l=i.ariaLabel,c=i.required,h=i.errorMessage,p=i.keytipProps,d=i.styles,v=i.theme,y=i.panelProps,b=i.calloutProps,w=i.onRenderTitle,E=void 0===w?this._getTitle:w,S=i.onRenderContainer,x=void 0===S?this._onRenderContainer:S,T=i.onRenderCaretDown,N=void 0===T?this._onRenderCaretDown:T,C=i.onRenderLabel,k=void 0===C?this._onRenderLabel:C,L=this.state,A=L.isOpen,O=L.selectedIndices,_=L.calloutRenderEdge,D=i.onRenderPlaceholder||i.onRenderPlaceHolder||this._getPlaceholder;f!==this._sizePosCache.cachedOptions&&this._sizePosCache.updateOptions(f);var B=Object(P.e)(f,O),j=Object(m.u)(i,m.s),F=this._isDisabled(),I=r+"-errorMessage",q=F?void 0:A&&1===O.length&&O[0]>=0?this._listId+O[0]:void 0;this._classNames=H(d,{theme:v,className:s,hasError:!!(h&&h.length>0),hasLabel:!!o,isOpen:A,required:c,disabled:F,isRenderingPlaceholder:!B.length,panelClassName:null===(e=y)||void 0===e?void 0:e.className,calloutClassName:null===(t=b)||void 0===t?void 0:t.className,calloutRenderEdge:_});var R=!!h&&h.length>0;return a.createElement("div",{className:this._classNames.root},k(this.props,this._onRenderLabel),a.createElement(M.e,{keytipProps:p,disabled:F},function(e){return a.createElement("div",Object(u.e)({},e,{"data-is-focusable":!F,ref:n._dropDown,id:r,tabIndex:F?-1:0,role:"combobox","aria-haspopup":"listbox","aria-expanded":A?"true":"false","aria-label":l,"aria-labelledby":o&&!l?Object(g.e)(n._labelId,n._optionId):void 0,"aria-describedby":Object(g.e)(e["aria-describedby"],R?n._id+"-errorMessage":void 0),"aria-activedescendant":q,"aria-required":c,"aria-disabled":F,"aria-controls":A?n._listId:void 0},j,{className:n._classNames.dropdown,onBlur:n._onDropdownBlur,onKeyDown:n._onDropdownKeyDown,onKeyUp:n._onDropdownKeyUp,onClick:n._onDropdownClick,onMouseDown:n._onDropdownMouseDown,onFocus:n._onFocus}),a.createElement("span",{id:n._optionId,className:n._classNames.title,"aria-live":"polite","aria-atomic":!0},B.length?E(B,n._onRenderTitle):D(i,n._onRenderPlaceholder)),a.createElement("span",{className:n._classNames.caretDownWrapper},N(i,n._onRenderCaretDown)))}),A&&x(Object(u.e)(Object(u.e)({},i),{onDismiss:this._onDismiss}),this._onRenderContainer),R&&a.createElement("div",{role:"alert",id:I,className:this._classNames.errorMessage},h))};t.prototype.focus=function(e){if(this._dropDown.current){this._dropDown.current.focus();e&&this.setState({isOpen:!0})}};t.prototype.setSelectedIndex=function(e,t){var n=this,r=this.props,i=r.options,s=r.selectedKey,o=r.selectedKeys,u=r.multiSelect,a=r.notifyOnReselect,f=this.state.selectedIndices,l=void 0===f?[]:f,c=!!l&&l.indexOf(t)>-1,h=[];t=Math.max(0,Math.min(i.length-1,t));if(void 0===s&&void 0===o){if(u||a||t!==l[0]){if(u){h=l?this._copyArray(l):[];if(c){var p=h.indexOf(t);p>-1&&h.splice(p,1)}else h.push(t)}else h=[t];e.persist();this.setState({selectedIndices:h},function(){n._onChange(e,i,t,c,u)})}}else this._onChange(e,i,t,c,u)};t.prototype._copyArray=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];t.push(i)}return t};t.prototype._moveIndex=function(e,t,n,r){var i=this.props.options;if(r===n||0===i.length)return r;n>=i.length?n=0:n<0&&(n=i.length-1);for(var s=0;i[n].itemType===N.e.Header||i[n].itemType===N.e.Divider||i[n].disabled;){if(s>=i.length)return r;n+t<0?n=i.length:n+t>=i.length&&(n=-1);n+=t;s++}this.setSelectedIndex(e,n);return n};t.prototype._renderFocusableList=function(e){var t=e.onRenderList,n=void 0===t?this._onRenderList:t,r=e.label,i=e.ariaLabel,s=e.multiSelect;return a.createElement("div",{className:this._classNames.dropdownItemsWrapper,onKeyDown:this._onZoneKeyDown,onKeyUp:this._onZoneKeyUp,ref:this._host,tabIndex:0},a.createElement(k.e,{ref:this._focusZone,direction:L.e.vertical,id:this._listId,className:this._classNames.dropdownItems,role:"listbox","aria-label":i,"aria-labelledby":r&&!i?this._labelId:void 0,"aria-multiselectable":s},n(e,this._onRenderList)))};t.prototype._renderSeparator=function(e){var t=e.index,n=e.key;return t>0?a.createElement("div",{role:"separator",key:n,className:this._classNames.dropdownDivider}):null};t.prototype._renderHeader=function(e){var t=this.props.onRenderOption,n=void 0===t?this._onRenderOption:t,r=e.key,i=e.id;return a.createElement("div",{id:i,key:r,className:this._classNames.dropdownItemHeader},n(e,this._onRenderOption))};t.prototype._onItemMouseEnter=function(e,t){if(!this._shouldIgnoreMouseEvent()){t.currentTarget.focus()}};t.prototype._onItemMouseMove=function(e,t){var n=t.currentTarget;this._gotMouseMove=!0;this._isScrollIdle&&document.activeElement!==n&&n.focus()};t.prototype._shouldIgnoreMouseEvent=function(){return!this._isScrollIdle||!this._gotMouseMove};t.prototype._getSelectedIndexes=function(e,t){if(void 0===t){return this.props.multiSelect?this._getAllSelectedIndices(e):-1!==(s=this._getSelectedIndex(e,null))?[s]:[]}if(!Array.isArray(t)){return-1!==(s=this._getSelectedIndex(e,t))?[s]:[]}for(var n=[],r=0,i=t;r<i.length;r++){var s,o=i[r];-1!==(s=this._getSelectedIndex(e,o))&&n.push(s)}return n};t.prototype._getAllSelectedIndices=function(e){return e.map(function(e,t){return e.selected?t:-1}).filter(function(e){return-1!==e})};t.prototype._getSelectedIndex=function(e,t){return Object(y.r)(e,function(e){return null!=t?e.key===t:!!e.selected||!!e.isSelected})};t.prototype._isAltOrMeta=function(e){return e.which===h.e.alt||"Meta"===e.key};t.prototype._shouldHandleKeyUp=function(e){var t=this._lastKeyDownWasAltOrMeta&&this._isAltOrMeta(e);this._lastKeyDownWasAltOrMeta=!1;return!!t&&!(Object(b.e)()||Object(w.e)())};t.prototype._shouldOpenOnFocus=function(){var e=this.state.hasFocus,t=this.props.openOnKeyboardFocus;return!this._isFocusedByClick&&!0===t&&!e};t.defaultProps={options:[]};return t=Object(u.n)([D.n],t)})(a.Component),j=n(506),F=n(69),I=n(25),q={root:"ms-Dropdown-container",label:"ms-Dropdown-label",dropdown:"ms-Dropdown",title:"ms-Dropdown-title",caretDownWrapper:"ms-Dropdown-caretDownWrapper",caretDown:"ms-Dropdown-caretDown",callout:"ms-Dropdown-callout",panel:"ms-Dropdown-panel",dropdownItems:"ms-Dropdown-items",dropdownItem:"ms-Dropdown-item",dropdownDivider:"ms-Dropdown-divider",dropdownOptionText:"ms-Dropdown-optionText",dropdownItemHeader:"ms-Dropdown-header",titleIsPlaceHolder:"ms-Dropdown-titleIsPlaceHolder",titleHasError:"ms-Dropdown-title--hasError"},R=((r={})[I.s+", "+I.o.replace("@media ","")]=Object(u.e)({},Object(I.T)()),r),U={selectors:Object(u.e)((i={},i[I.s]={backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText"},i),R)},z={selectors:(s={},s[I.s]={borderColor:"Highlight"},s)},W=Object(I.A)(0,I.h),X=Object(o.e)(B,function(e){var t,n,r,i,s,o,a,f,l,c,h,p=e.theme,d=e.hasError,v=e.hasLabel,m=e.className,g=e.isOpen,y=e.disabled,b=e.required,w=e.isRenderingPlaceholder,E=e.panelClassName,S=e.calloutClassName,x=e.calloutRenderEdge;if(!p)throw new Error("theme is undefined or null in base Dropdown getStyles function.");var T=Object(I.x)(q,p),N=p.palette,C=p.semanticColors,k=p.effects,L=p.fonts,A={color:C.menuItemTextHovered},O={color:C.menuItemText},M={borderColor:C.errorText},_=[T.dropdownItem,{backgroundColor:"transparent",boxSizing:"border-box",cursor:"pointer",display:"flex",alignItems:"center",padding:"0 8px",width:"100%",minHeight:36,lineHeight:20,height:0,position:"relative",border:"1px solid transparent",borderRadius:0,wordWrap:"break-word",overflowWrap:"break-word",textAlign:"left",".ms-Button-flexContainer":{width:"100%"}}],D=C.menuItemBackgroundPressed,P=function(e){var t;void 0===e&&(e=!1);return{selectors:(t={"&:hover:focus":[{color:C.menuItemTextHovered,backgroundColor:e?D:C.menuItemBackgroundHovered},U],"&:focus":[{backgroundColor:e?D:"transparent"},U],"&:active":[{color:C.menuItemTextHovered,backgroundColor:e?C.menuItemBackgroundHovered:C.menuBackground},U]},t["."+j.e+" &:focus:after"]={left:0,top:0,bottom:0,right:0},t[I.s]={border:"none"},t)}},H=Object(u.o)(_,[{backgroundColor:D,color:C.menuItemTextHovered},P(!0),U]),B=Object(u.o)(_,[{color:C.disabledText,cursor:"default",selectors:(t={},t[I.s]={color:"GrayText",border:"none"},t)}]),R=x===F.t.bottom?k.roundedCorner2+" "+k.roundedCorner2+" 0 0":"0 0 "+k.roundedCorner2+" "+k.roundedCorner2,X=x===F.t.bottom?"0 0 "+k.roundedCorner2+" "+k.roundedCorner2:k.roundedCorner2+" "+k.roundedCorner2+" 0 0";return{root:[T.root,m],label:T.label,dropdown:[T.dropdown,I.j,L.medium,{color:C.menuItemText,borderColor:C.focusBorder,position:"relative",outline:0,userSelect:"none",selectors:(n={},n["&:hover ."+T.title]=[!y&&A,{borderColor:g?N.neutralSecondary:N.neutralPrimary},z],n["&:focus ."+T.title]=[!y&&A,{selectors:(r={},r[I.s]={color:"Highlight"},r)}],n["&:focus:after"]=[{pointerEvents:"none",content:"''",position:"absolute",boxSizing:"border-box",top:"0px",left:"0px",width:"100%",height:"100%",border:y?"none":"2px solid "+N.themePrimary,borderRadius:"2px",selectors:(i={},i[I.s]={color:"Highlight"},i)}],n["&:active ."+T.title]=[!y&&A,{borderColor:N.themePrimary},z],n["&:hover ."+T.caretDown]=!y&&O,n["&:focus ."+T.caretDown]=[!y&&O,{selectors:(s={},s[I.s]={color:"Highlight"},s)}],n["&:active ."+T.caretDown]=!y&&O,n["&:hover ."+T.titleIsPlaceHolder]=!y&&O,n["&:focus ."+T.titleIsPlaceHolder]=!y&&O,n["&:active ."+T.titleIsPlaceHolder]=!y&&O,n["&:hover ."+T.titleHasError]=M,n["&:active ."+T.titleHasError]=M,n)},g&&"is-open",y&&"is-disabled",b&&"is-required",b&&!v&&{selectors:(o={":before":{content:"'*'",color:C.errorText,position:"absolute",top:-5,right:-10}},o[I.s]={selectors:{":after":{right:-14}}},o)}],title:[T.title,I.j,{backgroundColor:C.inputBackground,borderWidth:1,borderStyle:"solid",borderColor:C.inputBorder,borderRadius:g?R:k.roundedCorner2,cursor:"pointer",display:"block",height:32,lineHeight:30,padding:"0 28px 0 8px",position:"relative",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},w&&[T.titleIsPlaceHolder,{color:C.inputPlaceholderText}],d&&[T.titleHasError,M],y&&{backgroundColor:C.disabledBackground,border:"none",color:C.disabledText,cursor:"default",selectors:(a={},a[I.s]=Object(u.e)({border:"1px solid GrayText",color:"GrayText",backgroundColor:"Window"},Object(I.T)()),a)}],caretDownWrapper:[T.caretDownWrapper,{position:"absolute",top:1,right:8,height:32,lineHeight:30},!y&&{cursor:"pointer"}],caretDown:[T.caretDown,{color:N.neutralSecondary,fontSize:L.small.fontSize,pointerEvents:"none"},y&&{color:C.disabledText,selectors:(f={},f[I.s]=Object(u.e)({color:"GrayText"},Object(I.T)()),f)}],errorMessage:Object(u.e)(Object(u.e)({color:C.errorText},p.fonts.small),{paddingTop:5}),callout:[T.callout,{boxShadow:k.elevation8,borderRadius:X,selectors:(l={},l[".ms-Callout-main"]={borderRadius:X},l)},S],dropdownItemsWrapper:{selectors:{"&:focus":{outline:0}}},dropdownItems:[T.dropdownItems,{display:"block"}],dropdownItem:Object(u.o)(_,[P()]),dropdownItemSelected:H,dropdownItemDisabled:B,dropdownItemSelectedAndDisabled:[H,B,{backgroundColor:"transparent"}],dropdownItemHidden:Object(u.o)(_,[{display:"none"}]),dropdownDivider:[T.dropdownDivider,{height:1,backgroundColor:C.bodyDivider}],dropdownOptionText:[T.dropdownOptionText,{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",minWidth:0,maxWidth:"100%",wordWrap:"break-word",overflowWrap:"break-word",margin:"1px"}],dropdownItemHeader:[T.dropdownItemHeader,Object(u.e)(Object(u.e)({},L.medium),{fontWeight:I.i.semibold,color:C.menuHeader,background:"none",backgroundColor:"transparent",border:"none",height:36,lineHeight:36,cursor:"default",padding:"0 8px",userSelect:"none",textAlign:"left",selectors:(c={},c[I.s]=Object(u.e)({color:"GrayText"},Object(I.T)()),c)})],subComponentStyles:{label:{root:{display:"inline-block"}},multiSelectItem:{root:{padding:0},label:{alignSelf:"stretch",padding:"0 8px",width:"100%"}},panel:{root:[E],main:{selectors:(h={},h[W]={width:272},h)},contentInner:{padding:"0 0 20px"}}}}},void 0,{scope:"Dropdown"})},function(e,t,n){"use strict";var r=n(138);Object(r.n)([{rawString:".od-Confirmation-message{padding:0;box-sizing:border-box;box-shadow:none;margin:0;padding:0;font-size:.875rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main .od-Dialog-content{line-height:1.25rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main .od-Dialog-content .od-Dialog-button.od-Dialog-button--close{width:2rem;height:2rem;line-height:2rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main .od-Dialog-content .od-Dialog-button.od-Dialog-button--close i.ms-Icon.ms-Icon--Cancel{font-size:1rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main .od-Dialog-actions{height:2rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main .od-Dialog-actions button.od-Dialog-action{height:2rem;font-size:.875rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main .od-Dialog-actions button.od-Dialog-action .od-Button-label{font-size:.875rem}.od-Dialog.od-Dialog--close .od-ConfirmationDialog.od-Dialog-main #od-Dialog-title{font-size:1.25rem}"}]);var i=n(0),s=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.message=t.message;return n}return t})(n(1651).t),o=n(1652).e({tagName:"ms-confirmation",template:'<div class="od-Confirmation"><p class="od-Confirmation-message" data-bind="text:message"></p></div>',viewModel:s});t.e=o},function(e,t,n){"use strict";var r=n(138);Object(r.n)([{rawString:".od-FolderCoverTile{position:absolute;left:0;right:0;top:0;bottom:0;overflow:hidden}.od-FolderCoverTile-image{position:absolute;left:0;right:0;top:0;bottom:0;opacity:0;transition:opacity .6s linear .6s;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-FolderCoverTile-watermark{position:absolute;left:50%;top:38%;transform:translate(-50%,-50%);max-width:64px;max-height:64px}.od-FolderCoverTile-item0 .od-FolderCoverTile-image,.od-FolderCoverTile-item1 .od-FolderCoverTile-image{opacity:1}.od-FolderCoverTile>div{position:absolute;bottom:0}.od-FolderCoverTile-empty{left:2px;right:2px;top:8px;box-shadow:0 0 0 1px "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FolderCoverTile-item0{left:2px;right:2px;top:8px;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";box-shadow:0 0 0 1px "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";transform:translateY(100%)}.od-FolderCoverTile-item1{left:2px;right:2px;top:8px;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";box-shadow:0 0 0 1px "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";transition:transform .6s cubic-bezier(.1,.9,.2,1)}.od-FolderCoverTile-item2,.od-FolderCoverTile-item3{transition:left .6s cubic-bezier(.1,.9,.2,1),right .6s cubic-bezier(.1,.9,.2,1),top .6s cubic-bezier(.1,.9,.2,1)}.od-FolderCoverTile-item2{left:5px;right:5px;top:5px;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-shadow:0 0 0 1px "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-FolderCoverTile-item3,.od-FolderCoverTile-item4{left:8px;right:8px;top:2px;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-shadow:0 0 0 1px "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-FolderCoverTile-item4{opacity:0}.is-tag .od-FolderCoverTile-item1,.is-tag .od-FolderCoverTile-item2,.is-tag .od-FolderCoverTile-item3{box-shadow:none}.is-tag .od-FolderCoverTile-item1{left:0;right:0;top:0}.is-tag .od-FolderCoverTile-item2{left:2px;right:2px;top:8px;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";transition:left .6s cubic-bezier(.1,.9,.2,1),right .6s cubic-bezier(.1,.9,.2,1),top .6s cubic-bezier(.1,.9,.2,1)}"}]);var i,s=n(0),o=n(1651),u=n(1816),a=n(1730),f=n(181),l=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.thumbnailTagName=u.e.tagName;var r=n.observables,s=n.resources;i||(i=s.consume(f.e).isRetinaSupported?"64_2x":"64");n.imageRect=t.imageRect;n._item=t.item;n._lastThumbnails=-1;n._thumbnailIndex=-1;n._isPulsingEnabled=!0;n.pulseRecords=r.createArray();r.compute(n._computeRecords);var o=t.pulseTarget;o&&o(n);return n}t.prototype.canPulse=function(){var e=this._item();return!!(e&&e.folder&&e.folder.covers&&e.folder.covers.length>1)};t.prototype.enablePulsing=function(e){this._isPulsingEnabled=e};t.prototype.pulse=function(){if(this.canPulse()&&this._isPulsingEnabled){this._pushNextRecord();this.pulseRecords.shift();this._updatePulseClasses()}};t.prototype.getThumbnailParams=function(e){return{image:e.thumbnail,desiredSize:this.imageRect,alignment:a.e.cover}};t.prototype._computeRecords=function(){var e=this._item();if(e){var t=e.key||"",n=e.folder&&e.folder.covers?e.folder.covers.length:-1;if(t!==this._lastKey||n!==this._lastThumbnails){this._lastKey=t;this._lastThumbnails=n;this.pulseRecords.removeAll();this._thumbnailIndex=-1;0===(e.folder&&e.folder.totalCount)?this._pushFolderRecord(!0):this._initializeRecord();this._updatePulseClasses()}}};t.prototype._pushFolderRecord=function(e){var t=this.observables;this.pulseRecords.push({className:t.create("od-FolderCoverTile-empty"),isThumbnailVisible:t.create(!1),isWatermarkVisible:t.create(!1),watermarkUrl:t.create(""),isEmpty:e,thumbnail:t.create(null)})};t.prototype._initializeRecord=function(){var e;for(e=0;e<3;e++)this._pushFolderRecord(!1);for(e=0;e<2;e++)this._pushNextRecord()};t.prototype._pushNextRecord=function(){var e=this._getNextThumbnail(),t=this.observables;this.pulseRecords.push({className:t.create(),thumbnail:t.create(e),isThumbnailVisible:t.create(!1),isWatermarkVisible:t.create(!1),watermarkUrl:t.create("")})};t.prototype._updatePulseClasses=function(){for(var e=this.pulseRecords(),t=0;t<e.length;t++){var n=e[t],r=e.length-t-1;n.isEmpty||n.className("od-FolderCoverTile-item"+r);n.isThumbnailVisible(!(!n.thumbnail()||!(n.isThumbnailVisible()||r<2)));var i=this.unwrapObservable(this._item),s=!i.tagInfo&&!n.isThumbnailVisible()&&(1===r||i.isAlbum||i.isDocSet);n.isWatermarkVisible(s);n.watermarkUrl(s?this._getFolderWatermarkUrl():null)}};t.prototype._getFolderWatermarkUrl=function(){var e=this._item(),t="genericfolder";e.isAlbum&&(t="photofolder");switch(e.isSpecialFolder&&e.specialFolderCanonicalName){case"Music":t="musicfolder";break;case"Documents":t="documentfolder";break;case"Photos":t="photofolder"}e.isDocSet&&(t="Docset");return window.require.toUrl("odsp-media/images/watermarks/"+i+"/"+t.toLowerCase()+".png")};t.prototype._getNextThumbnail=function(){var e=this._item(),t=e&&e.folder&&e.folder.covers,n=t&&t.length;if(n){return t[this._thumbnailIndex=(this._thumbnailIndex+1)%n]}};return t})(o.t),c=n(1652).e({tagName:"od-folder-cover-tile",template:'<div class="od-FolderCoverTile" data-bind="foreach:pulseRecords"><div data-bind="attr:{class:className}">\x3c!--ko if:isThumbnailVisible--\x3e<div class="od-FolderCoverTile-image" data-bind="component:{name:$component.thumbnailTagName,params:$component.getThumbnailParams($data)}"></div>\x3c!--/ko--\x3e\x3c!--ko if:isWatermarkVisible--\x3e<img class="od-FolderCoverTile-watermark" role="presentation" data-bind="attr:{src:watermarkUrl}">\x3c!--/ko--\x3e</div></div>',viewModel:l,synchronous:!0});t.e=c},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.Normal=0]="Normal";e[e.Divider=1]="Divider";e[e.Header=2]="Header"})(r||(r={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e,t){for(var n=[],r=0,i=t;r<i.length;r++){var s=e[i[r]];s&&n.push(s)}return n}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(11),s=n(76),o=n(1649),u=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._dataSource=n.policyTipDataSource;return r}t.prototype.getPolicyTip=function(e){return this._dataSource.getPolicyTip(e)};t.prototype.updatePolicy=function(e){return this._dataSource.updatePolicy(e)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},o.n.dependencies),{policyTipDataSource:s.V});return t})(o.n),a=Object(i.s)("PolicyTipProvider",u)},,,,,,,,,,,,,function(e,t,n){"use strict";n(2190);var r=n(138);Object(r.n)([{rawString:".ms-Presence{display:inline-block;width:.75rem;height:.75rem;z-index:1;margin:3px;border-radius:50%;border:2px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";text-align:center;vertical-align:bottom}.ms-Presence.ms-Presence--Online{background-color:#7dbc00}.ms-Presence.ms-Presence--Busy{background-color:#e9001b}@media screen and (-ms-high-contrast:active){.ms-Presence.ms-Presence--Busy{background-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-Presence.ms-Presence--Busy{background-color:#37006e}}.ms-Presence.ms-Presence--DoNotDisturb{background-color:#eb0615}.ms-Presence.ms-Presence--BeRightBack{background-color:#f9ce15}.ms-Presence.ms-Presence--Away{background-color:#f9ce15}.ms-Presence.ms-Presence--Offline{background-color:#bd2eae}@media screen and (-ms-high-contrast:active){.ms-Presence.ms-Presence--Offline{background-color:"},{theme:"black",defaultValue:"#000000"},{rawString:";box-shadow:0 0 0 1px "},{theme:"white",defaultValue:"#ffffff"},{rawString:" inset}}@media screen and (-ms-high-contrast:black-on-white){.ms-Presence.ms-Presence--Offline{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-shadow:0 0 0 1px "},{theme:"black",defaultValue:"#000000"},{rawString:" inset}}.ms-Presence.ms-Presence--Hidden{background-color:#f1f1f1}.ms-Presence::before{font-size:8px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";line-height:.75rem;vertical-align:top;position:relative}@media screen and (-ms-high-contrast:active){.ms-Presence{border-color:"},{theme:"black",defaultValue:"#000000"},{rawString:";box-shadow:0 0 0 1px #1aebff inset;color:"},{theme:"black",defaultValue:"#000000"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.ms-Presence{border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-shadow:0 0 0 1px #37006e inset;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}}.od-Persona.od-Persona--lg .ms-Presence{width:1.25rem;height:1.25rem;border-width:3px}.od-Persona.od-Persona--lg .ms-Presence::before{line-height:1.25rem;font-size:14px}.od-Persona.od-Persona--xl .ms-Presence{width:1.75rem;height:1.75rem;border-width:4px}.od-Persona.od-Persona--xl .ms-Presence::before{line-height:1.75rem;font-size:21px}.od-focus--enabled a.ms-Presence{box-shadow:none}.od-focus--enabled .ms-Presence:focus:before{position:absolute;top:0;bottom:0;left:0;right:0;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";content:'';border-radius:50%}"}]);var i=n(0),s=n(1651),o=n("knockout-lib"),u=n(1830),a=n(2637),f=n(25),l=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this)||this;n.strings=a;n.sip=o.isObservable(t.sip)?t.sip:o.observable(t.sip||"");n.presenceType=o.observable(0);n._dataProvider=n.resources.consume(u.t);n.registerPresence(n.sip());n.isVisible=!!n._presenceDisposable;n._sipSubscriptionOld=n.sip.subscribe(function(e){n.unRegisterPresence(e)},n,"beforeChange");n._sipSubscriptionNew=n.sip.subscribe(function(e){n.registerPresence(e)},n);n.presenceClass=n.createComputed(n._computePresenceClass);n.presenceTypeText=n.createComputed(n._computePresenceTypeText);return n}t.prototype.dispose=function(){e.prototype.dispose.call(this);this.unRegisterPresence(this.sip());this._sipSubscriptionOld&&this._sipSubscriptionOld.dispose();this._sipSubscriptionNew&&this._sipSubscriptionNew.dispose()};t.prototype.registerPresence=function(e){var t=this;this._dataProvider&&e&&(this._presenceDisposable=this._dataProvider.subscribePresence(e,function(e){t._presenceCallback(e)}))};t.prototype.unRegisterPresence=function(e){this._presenceDisposable&&this._presenceDisposable.dispose()};t.prototype._presenceCallback=function(e){!this.isDisposed&&this.presenceType&&this.presenceType(e)};t.prototype._computePresenceTypeText=function(){var e="";switch(this.presenceType()){case 1:e=this.strings.online;break;case 2:e=this.strings.busy;break;case 3:e=this.strings.doNotDisturb;break;case 4:e=this.strings.beRightBack;break;case 5:e=this.strings.away;break;case 6:e=this.strings.offline}return e};t.prototype._computePresenceClass=function(){var e="";switch(this.presenceType()){case 1:e="ms-Presence--Online "+Object(f.C)("SkypeCheck");break;case 2:e="ms-Presence--Busy";break;case 3:e="ms-Presence--DoNotDisturb "+Object(f.C)("SkypeMinus");break;case 4:e="ms-Presence--BeRightBack";break;case 5:e="ms-Presence--Away "+Object(f.C)("SkypeClock");break;case 6:e="ms-Presence--Offline";break;case 7:case 0:e="ms-Presence--Hidden";break;default:e="ms-Presence--Hidden"}return"ms-Presence "+e};return t})(s.t),c=n(1652),h=(c.e({tagName:"ms-presence",template:'<a data-bind="css:presenceClass,visible:isVisible,attr:{title:presenceTypeText,\'aria-label\':presenceTypeText}" class="od-Persona-presence"></a>',viewModel:l}),n(1958)),p=n(1723),d=n(1823),v=n(2004),m=n(888),g=n(1744),y=n(1954),b=n(2264),w=n(1749),E=n(46),S=n(76),x=n(391),T=n(1662),N=n(1660),C=n(22),k=n(2019),L=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.loadingSpinnerTagName=g.e.tagName;n.personaImageTagName=h.e.tagName;n.addBindingHandlers({tooltip:w.e,keyboard:T.e,element:N.e});n.updateSharingRole=function(e){if(5===e.sharingInfo.role)n._removePerson(n.person());else{var t=n.person();t.sharingInfo=e.sharingInfo;n.person(t);n.updatingPermissions(!1)}};n._item=t.item;n.openContextMenu=t.openContextMenu||n.observables.create(!1);n.inputEvent=t.inputEvent||n.observables.create(null);n.sharingRoleElement=n.createObservable();n.disableTab=n.createObservable(t.disableTab);n.showEmail=Object(E.isFeatureEnabled)(E.ShowEmailInPeoplePicker);n.person=o.isObservable(t.person)?t.person:o.observable(t.person);n.updatingPermissions=o.observable(!1);n.nameEmail=n.person().email?C.format(y.s,n.person().name,n.person().email):n.person().name;n._removePerson=t.removePerson||function(e){};n.showName=void 0===t.showName||!!t.showName;n.showProfileLink=!!t.profileLinkOn;n.showPresence=!!t.showPresence;n._includeComma=!!t.includeComma;n._sharingRoleMenuRootElementClass=t.sharingRoleMenuRootElementClass||"od-Dialog-main";n._urlDataSource=n.resources.consume(S.ve);t.personaSize?n.personaSize=o.isObservable(t.personaSize)?t.personaSize:o.observable(t.personaSize):n.personaSize=o.observable(3);n.personaImageParams={person:n.person,disablePictrueAlt:t.disablePictrueAlt,iconType:t.iconType};n.createComputed(function(){if(n.openContextMenu()&&n.canChangePermissions()&&n.canManagePermissions()){var e=n._createContextMenuCommands(),t=n._createContextMenuHelper(e),r=n.inputEvent.peek();d.e.createContextMenu(r,t,n);13===r.keyCode&&r.preventDefault();n.openContextMenu(!1)}});n.personaClass=n.createComputed(function(){var e=void 0===n.person().isResolved||n.person().isResolved?"":"od-Persona-unresolved ";n._includeComma&&(e+="od-Persona--comma ");e+="od-Persona";switch(n.personaSize()){case 7:return e+" od-Persona--mini";case 1:return e+" od-Persona--tiny";case 2:return e+" od-Persona--xs";case 3:return e+" od-Persona--sm";case 5:return e+" od-Persona--lg";case 6:return e+" od-Persona--xl";case 8:return e+" od-Persona--xxl";default:return e}});n.hasSharingInfo=n.createComputed(function(){return!!n.person().sharingInfo});var r=n.resources.isExposed(x.B)?n.resources.consume(x.B):null;n.personIsCurrentUser=n.createPureComputed(function(){return r&&n.person().userId&&n._urlDataSource.getOwnerId("",r()).toLowerCase()===n.person().userId.toLowerCase()},{deferEvaluation:!0});n.canChangePermissions=n.createPureComputed(function(){return!!n.person().sharingInfo&&0!==n.person().sharingInfo.role&&!n.personIsCurrentUser()});n.canManagePermissions=n.createObservable(t.canManagePermissions);n.presenceVisible=n.createComputed(function(){return n.showPresence&&!!n.person().sip});n.tooltip=n.person().email;n.updatingText=y.c;n.person().providerName&&(n.tooltip+="\n"+n.person().providerName);return n}t.prototype.getSharingRole=function(e){return k.r(null==e?void 0:e.role,e)};t.prototype.onSharingRoleClick=function(e,t){this.resources.consume(m.e).logData({name:"UpdatePermissionsMenu.SharingDialog.Click",isIntentional:!0});var n=this._createContextMenuCommands(),r=this._createContextMenuHelper(n,t);d.e.createContextMenu(t,r,this);return n};t.prototype._createContextMenuCommands=function(){var e,t=[],n="";if(Object(E.isFeatureEnabled)(E.ReviewPermissionUI)&&this._item.appMap&&"ms-word"===this._item.appMap){var r,i="";if(1===this.person().sharingInfo.role){n=y.e;e=2;i=y.f;r=6}else if(6===this.person().sharingInfo.role){n=y.e;e=2;i=y.d;r=1}else if(2===this.person().sharingInfo.role){n=y.f;e=6;i=y.d;r=1}t[0]=new p.e({text:n,isToggleable:!1,action:new(this.managed(b.default))({person:this.person(),role:e,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,expiration:this.person.peek().sharingInfo.expiration,item:this._item})});t[1]=new p.e({text:i,isToggleable:!1,action:new(this.managed(b.default))({person:this.person(),role:r,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,expiration:this.person.peek().sharingInfo.expiration,item:this._item})});t[2]=new p.e({text:y.l,isToggleable:!1,action:new(this.managed(b.default))({person:this.person(),role:5,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,item:this._item})})}else{if(1===this.person().sharingInfo.role){n=y.e;e=2}else{n=y.d;e=1}t[0]=new p.e({text:n,isToggleable:!1,action:new(this.managed(b.default))({person:this.person(),role:e,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,expiration:this.person.peek().sharingInfo.expiration,item:this._item})});t[1]=new p.e({text:y.l,isToggleable:!1,action:new(this.managed(b.default))({person:this.person(),role:5,isExecuting:this.updatingPermissions,callback:this.updateSharingRole,item:this._item})})}return t};t.prototype._createContextMenuHelper=function(e,t){return new v.e({items:e,rootElementClass:this._sharingRoleMenuRootElementClass,anchorElement:t&&t.target||this.sharingRoleElement.peek()})};return t})(s.t),A=c.e({tagName:"od-persona",template:'<div data-bind="tooltip:{content:nameEmail,\'aria-label\':person().name},css:personaClass"><div class="od-Persona-imageArea"><div class="od-Persona-imageCircle">\x3c!--ko component:{name:personaImageTagName,params:personaImageParams}--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if:presenceVisible--\x3e\x3c!--ko component:{name:\'ms-presence\',params:{sip:person().sip}}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div><div class="od-Persona-details">\x3c!--ko if:showProfileLink--\x3e\x3c!--ko if:person().profilePage--\x3e<a class="od-Persona-link od-Persona-primaryText" target="_blank" data-bind="attr:{href:person().profilePage},text:person().name"></a>\x3c!--/ko--\x3e\x3c!--ko ifnot:person().profilePage--\x3e<span class="od-Persona-link od-Persona-primaryText" data-bind="text:person().name"></span>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:!showProfileLink&&showName--\x3e<div class="od-Persona-primaryText od-persona-link" data-bind="text:person().name"></div>\x3c!--/ko--\x3e<div class="od-Persona-secondaryText" data-bind="visible:!!person().job,text:person().job"></div><div class="od-Persona-tertiaryText" data-bind="visible:!!person().department,text:person().department"></div><div class="od-Persona-optionalText" data-bind="visible:!!person().office,text:person().office"></div><div class="od-Persona-emailText" data-bind="visible:showEmail,text:person().email"></div>\x3c!--ko if:canChangePermissions()&&canManagePermissions()--\x3e<div class="od-Persona-sharingContainer" data-bind="visible:!updatingPermissions()&&getSharingRole(person().sharingInfo)&&personaSize()>3"><button class="od-Persona-sharingRole" aria-haspopup="true" data-bind="click:onSharingRoleClick,keyboard:{Space:onSharingRoleClick},attr:{\'aria-label\':getSharingRole(person().sharingInfo),tabindex:!disableTab?\'0\':\'-1\'},element:sharingRoleElement"><div class="od-Persona-sharingRole-Text"><span data-bind="text:getSharingRole(person().sharingInfo)"></span><span class="od-Persona-sharingRole-Chevron" data-bind="visible:!personIsCurrentUser()"><i class="ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i></span></div></button></div>\x3c!--ko if:updatingPermissions()--\x3e<div class="od-Persona-sharingSpinner" data-bind="component:{name:loadingSpinnerTagName,params:{loadingText:updatingText}},visible:updatingPermissions()"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:hasSharingInfo&&(!canChangePermissions()||!canManagePermissions())--\x3e<div class="od-Persona-sharingRole-Text" data-bind="text:getSharingRole(person().sharingInfo)"></div>\x3c!--/ko--\x3e</div></div>',viewModel:L});t.e=A},,function(e,t,n){"use strict";n.d(t,"e",function(){return y});var r=n(1419),i=n(4),s=n("react-lib"),o=n(472),u=n(270),a=n(1547),f=n(917),l=n(97),c=n(1802),h=n(1670),p=Object(o.e)(),d=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;n._onRenderPersonaCoin=function(e){return s.createElement(c.e,Object(i.e)({},e))};0;return n}t.prototype.render=function(){var e=this._onRenderText(this._getText()),t=this._onRenderText(this.props.secondaryText),n=this._onRenderText(this.props.tertiaryText),r=this._onRenderText(this.props.optionalText),o=this.props,a=o.hidePersonaDetails,f=o.onRenderOptionalText,l=void 0===f?r:f,c=o.onRenderPrimaryText,d=void 0===c?e:c,v=o.onRenderSecondaryText,m=void 0===v?t:v,g=o.onRenderTertiaryText,y=void 0===g?n:g,b=o.onRenderPersonaCoin,w=void 0===b?this._onRenderPersonaCoin:b,E=this.props.size,S=this.props,x=S.allowPhoneInitials,T=S.className,N=S.coinProps,C=S.showUnknownPersonaCoin,k=S.coinSize,L=S.styles,A=S.imageAlt,O=S.imageInitials,M=S.imageShouldFadeIn,_=S.imageShouldStartVisible,D=S.imageUrl,P=S.initialsColor,H=S.initialsTextColor,B=S.isOutOfOffice,j=S.onPhotoLoadingStateChange,F=S.onRenderCoin,I=S.onRenderInitials,q=S.presence,R=S.presenceTitle,U=S.presenceColors,z=S.showInitialsUntilImageLoads,W=S.showSecondaryText,X=S.theme,V=Object(i.e)({allowPhoneInitials:x,showUnknownPersonaCoin:C,coinSize:k,imageAlt:A,imageInitials:O,imageShouldFadeIn:M,imageShouldStartVisible:_,imageUrl:D,initialsColor:P,initialsTextColor:H,onPhotoLoadingStateChange:j,onRenderCoin:F,onRenderInitials:I,presence:q,presenceTitle:R,showInitialsUntilImageLoads:z,size:E,text:this._getText(),isOutOfOffice:B,presenceColors:U},N),$=p(L,{theme:X,className:T,showSecondaryText:W,presence:q,size:E}),J=Object(u.u)(this.props,u.s),K=s.createElement("div",{className:$.details},this._renderElement($.primaryText,d,e),this._renderElement($.secondaryText,m,t),this._renderElement($.tertiaryText,y,n),this._renderElement($.optionalText,l,r),this.props.children);return s.createElement("div",Object(i.e)({},J,{className:$.root,style:k?{height:k,minWidth:k}:void 0}),w(V,this._onRenderPersonaCoin),(!a||E===h.n.size8||E===h.n.size10||E===h.n.tiny)&&K)};t.prototype._renderElement=function(e,t,n){return s.createElement("div",{dir:"auto",className:e},t&&t(this.props,n))};t.prototype._getText=function(){return this.props.text||this.props.primaryText||""};t.prototype._onRenderText=function(e){return e?function(){return s.createElement(a.e,{content:e,overflowMode:f.e.Parent,directionalHint:l.e.topLeftEdge},e)}:void 0};t.defaultProps={size:h.n.size48,presence:h.t.none,imageAlt:""};return t})(s.Component),v=n(25),m=n(1675),g={root:"ms-Persona",size8:"ms-Persona--size8",size10:"ms-Persona--size10",size16:"ms-Persona--size16",size24:"ms-Persona--size24",size28:"ms-Persona--size28",size32:"ms-Persona--size32",size40:"ms-Persona--size40",size48:"ms-Persona--size48",size56:"ms-Persona--size56",size72:"ms-Persona--size72",size100:"ms-Persona--size100",size120:"ms-Persona--size120",available:"ms-Persona--online",away:"ms-Persona--away",blocked:"ms-Persona--blocked",busy:"ms-Persona--busy",doNotDisturb:"ms-Persona--donotdisturb",offline:"ms-Persona--offline",details:"ms-Persona-details",primaryText:"ms-Persona-primaryText",secondaryText:"ms-Persona-secondaryText",tertiaryText:"ms-Persona-tertiaryText",optionalText:"ms-Persona-optionalText",textContent:"ms-Persona-textContent"},y=Object(r.e)(d,function(e){var t=e.className,n=e.showSecondaryText,r=e.theme,i=r.semanticColors,s=r.fonts,o=Object(v.x)(g,r),u=Object(m.r)(e.size),a=Object(m.n)(e.presence),f={color:i.bodySubtext,fontWeight:v.i.regular,fontSize:s.small.fontSize};return{root:[o.root,r.fonts.medium,v.j,{color:i.bodyText,position:"relative",height:m.t.size48,minWidth:m.t.size48,display:"flex",alignItems:"center",selectors:{".contextualHost":{display:"none"}}},u.isSize8&&[o.size8,{height:m.t.size8,minWidth:m.t.size8}],u.isSize10&&[o.size10,{height:m.t.size10,minWidth:m.t.size10}],u.isSize16&&[o.size16,{height:m.t.size16,minWidth:m.t.size16}],u.isSize24&&[o.size24,{height:m.t.size24,minWidth:m.t.size24}],u.isSize24&&n&&{height:"36px"},u.isSize28&&[o.size28,{height:m.t.size28,minWidth:m.t.size28}],u.isSize28&&n&&{height:"32px"},u.isSize32&&[o.size32,{height:m.t.size32,minWidth:m.t.size32}],u.isSize40&&[o.size40,{height:m.t.size40,minWidth:m.t.size40}],u.isSize48&&o.size48,u.isSize56&&[o.size56,{height:m.t.size56,minWidth:m.t.size56}],u.isSize72&&[o.size72,{height:m.t.size72,minWidth:m.t.size72}],u.isSize100&&[o.size100,{height:m.t.size100,minWidth:m.t.size100}],u.isSize120&&[o.size120,{height:m.t.size120,minWidth:m.t.size120}],a.isAvailable&&o.available,a.isAway&&o.away,a.isBlocked&&o.blocked,a.isBusy&&o.busy,a.isDoNotDisturb&&o.doNotDisturb,a.isOffline&&o.offline,t],details:[o.details,{padding:"0 24px 0 16px",minWidth:0,width:"100%",textAlign:"left",display:"flex",flexDirection:"column",justifyContent:"space-around"},(u.isSize8||u.isSize10)&&{paddingLeft:17},(u.isSize24||u.isSize28||u.isSize32)&&{padding:"0 8px"},(u.isSize40||u.isSize48)&&{padding:"0 12px"}],primaryText:[o.primaryText,v.B,{color:i.bodyText,fontWeight:v.i.regular,fontSize:s.medium.fontSize,selectors:{":hover":{color:i.inputTextHovered}}},n&&{height:"16px",lineHeight:"16px",overflowX:"hidden"},(u.isSize8||u.isSize10)&&{fontSize:s.small.fontSize,lineHeight:m.t.size8},u.isSize16&&{lineHeight:m.t.size28},(u.isSize24||u.isSize28||u.isSize32||u.isSize40||u.isSize48)&&n&&{height:18},(u.isSize56||u.isSize72||u.isSize100||u.isSize120)&&{fontSize:s.xLarge.fontSize},(u.isSize56||u.isSize72||u.isSize100||u.isSize120)&&n&&{height:22}],secondaryText:[o.secondaryText,v.B,f,(u.isSize8||u.isSize10||u.isSize16||u.isSize24||u.isSize28||u.isSize32)&&{display:"none"},n&&{display:"block",height:"16px",lineHeight:"16px",overflowX:"hidden"},u.isSize24&&n&&{height:18},(u.isSize56||u.isSize72||u.isSize100||u.isSize120)&&{fontSize:s.medium.fontSize},(u.isSize56||u.isSize72||u.isSize100||u.isSize120)&&n&&{height:18}],tertiaryText:[o.tertiaryText,v.B,f,{display:"none",fontSize:s.medium.fontSize},(u.isSize72||u.isSize100||u.isSize120)&&{display:"block"}],optionalText:[o.optionalText,v.B,f,{display:"none",fontSize:s.medium.fontSize},(u.isSize100||u.isSize120)&&{display:"block"}],textContent:[o.textContent,v.B]}},void 0,{scope:"Persona"})},,function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return a});var r=n(0),i=n(221),s=n(11),o=n(76),u=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._identityDataSource=n.identityDataSource;return r}t.prototype.getToken=function(){return this._identityDataSource.getGraphToken({})};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.e.dependencies),{identityDataSource:o.S});return t})(i.e);t.default=u;var a=Object(s.s)("GraphTokenProvider",u)},function(e,t,n){"use strict";n.r(t);n.d(t,"GraphUrlDataSource",function(){return u});n.d(t,"resourceKey",function(){return a});var r=n(7),i=n(11),s=n(46),o=n(126),u=(function(){function e(){}e.prototype.getApiName=function(){return"Graph"};e.prototype.getApiBaseUrl=function(){return!Object(s.isFeatureEnabled)(s.UseNewShareDialog)||Object(o.e)()&&!Object(s.isFeatureEnabled)(s.UseNewShareDialogForWinApp)?"https://graph.microsoft.com/v1.0":"https://graph.microsoft.com/beta"};return e})(),a=new r.t({name:"GraphUrlDataSource",factory:new i.i(u)})},,function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(4),i=n("react-lib"),s=n(1976),o=n(1975),u=n(1802),a=n(1670),f=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;n._onRenderIcon=function(e){return e.activityPersonas?n._onRenderPersonaArray(e):n.props.activityIcon};n._onRenderActivityDescription=function(e){var t=n._getClassNames(e),r=e.activityDescription||e.activityDescriptionText;return r?i.createElement("span",{className:t.activityText},r):null};n._onRenderComments=function(e){var t=n._getClassNames(e),r=e.comments||e.commentText;return!e.isCompact&&r?i.createElement("div",{className:t.commentText},r):null};n._onRenderTimeStamp=function(e){var t=n._getClassNames(e);return!e.isCompact&&e.timeStamp?i.createElement("div",{className:t.timeStamp},e.timeStamp):null};n._onRenderPersonaArray=function(e){var t=n._getClassNames(e),s=null,o=e.activityPersonas;if(o[0].imageUrl||o[0].imageInitials){var f=[],l=o.length>1||e.isCompact,c=e.isCompact?3:4,h=void 0;e.isCompact&&(h={display:"inline-block",width:"10px",minWidth:"10px",overflow:"visible"});o.filter(function(e,t){return t<c}).forEach(function(e,n){f.push(i.createElement(u.e,Object(r.e)({},e,{key:e.key||n,className:t.activityPersona,size:l?a.n.size16:a.n.size32,style:h})))});s=i.createElement("div",{className:t.personaContainer},f)}return s};return n}t.prototype.render=function(){var e=this.props,t=e.onRenderIcon,n=void 0===t?this._onRenderIcon:t,r=e.onRenderActivityDescription,s=void 0===r?this._onRenderActivityDescription:r,o=e.onRenderComments,u=void 0===o?this._onRenderComments:o,a=e.onRenderTimeStamp,f=void 0===a?this._onRenderTimeStamp:a,l=e.animateBeaconSignal,c=e.isCompact,h=this._getClassNames(this.props);return i.createElement("div",{className:h.root,style:this.props.style},(this.props.activityPersonas||this.props.activityIcon||this.props.onRenderIcon)&&i.createElement("div",{className:h.activityTypeIcon},l&&c&&i.createElement("div",{className:h.pulsingBeacon}),n(this.props)),i.createElement("div",{className:h.activityContent},s(this.props,this._onRenderActivityDescription),u(this.props,this._onRenderComments),f(this.props,this._onRenderTimeStamp)))};t.prototype._getClassNames=function(e){return Object(s.e)(Object(o.e)(void 0,e.styles,e.animateBeaconSignal,e.beaconColorOne,e.beaconColorTwo,e.isCompact),e.className,e.activityPersonas,e.isCompact)};return t})(i.Component)},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(1002);function i(e,t){return function(n){var i=Object(r.getUserPhotoUrl)(n,t||1);return 0===i.indexOf("https://")||0===i.indexOf("http://")?i:i&&e?e+i:void 0}}},,,function(e,t,n){"use strict";n.d(t,"e",function(){return j});n.d(t,"t",function(){return F});var r={};n.r(r);n.d(r,"pickerText",function(){return A});n.d(r,"inputFocused",function(){return O});n.d(r,"inputDisabled",function(){return M});n.d(r,"pickerInput",function(){return _});n.d(r,"pickerItems",function(){return D});n.d(r,"screenReaderOnly",function(){return P});var i=n(4),s=n("react-lib"),o=n(472),u=n(1419),a=n(129),f=n(991),l=n(886),c=n(207),h=n(653),p=n(37),d=n(1648),v=n(287),m=n(1439),g=n(97),y=n(1481),b=n(1630),w=n(107),E=n(1864),S=n(25),x={root:"ms-Suggestions",suggestionsContainer:"ms-Suggestions-container",title:"ms-Suggestions-title",forceResolveButton:"ms-forceResolve-button",searchForMoreButton:"ms-SearchMore-button",spinner:"ms-Suggestions-spinner",noSuggestions:"ms-Suggestions-none",suggestionsAvailable:"ms-Suggestions-suggestionsAvailable",isSelected:"is-selected"};function T(e){var t,n=e.className,r=e.suggestionsClassName,s=e.theme,o=e.forceResolveButtonSelected,u=e.searchForMoreButtonSelected,a=s.palette,f=s.semanticColors,l=s.fonts,c=Object(S.x)(x,s),h={backgroundColor:"transparent",border:0,cursor:"pointer",margin:0,paddingLeft:8,position:"relative",borderTop:"1px solid "+a.neutralLight,height:40,textAlign:"left",width:"100%",fontSize:l.small.fontSize,selectors:{":hover":{backgroundColor:f.menuItemBackgroundPressed,cursor:"pointer"},":focus, :active":{backgroundColor:a.themeLight},".ms-Button-icon":{fontSize:l.mediumPlus.fontSize,width:25},".ms-Button-label":{margin:"0 4px 0 9px"}}},p={backgroundColor:a.themeLight,selectors:(t={},t[S.s]=Object(i.e)({backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText"},Object(S.T)()),t)};return{root:[c.root,{minWidth:260},n],suggestionsContainer:[c.suggestionsContainer,{overflowY:"auto",overflowX:"hidden",maxHeight:300,transform:"translate3d(0,0,0)"},r],title:[c.title,{padding:"0 12px",fontSize:l.small.fontSize,color:a.themePrimary,lineHeight:40,borderBottom:"1px solid "+f.menuItemBackgroundPressed}],forceResolveButton:[c.forceResolveButton,h,o&&[c.isSelected,p]],searchForMoreButton:[c.searchForMoreButton,h,u&&[c.isSelected,p]],noSuggestions:[c.noSuggestions,{textAlign:"center",color:a.neutralSecondary,fontSize:l.small.fontSize,lineHeight:30}],suggestionsAvailable:[c.suggestionsAvailable,S.M],subComponentStyles:{spinner:{root:[c.spinner,{margin:"5px 0",paddingLeft:14,textAlign:"left",whiteSpace:"nowrap",lineHeight:20,fontSize:l.small.fontSize}],circle:{display:"inline-block",verticalAlign:"middle"},label:{display:"inline-block",verticalAlign:"middle",margin:"0 10px 0 16px"}}}}}var N=(function(){function e(){var e=this;this._isSuggestionModel=function(e){return void 0!==e.item};this._ensureSuggestionModel=function(t){return e._isSuggestionModel(t)?t:{item:t,selected:!1,ariaLabel:t.name||t.primaryText}};this.suggestions=[];this.currentIndex=-1}e.prototype.updateSuggestions=function(e,t){if(e&&e.length>0){this.suggestions=this.convertSuggestionsToSuggestionItems(e);this.currentIndex=t||0;if(-1===t)this.currentSuggestion=void 0;else if(void 0!==t){this.suggestions[t].selected=!0;this.currentSuggestion=this.suggestions[t]}}else{this.suggestions=[];this.currentIndex=-1;this.currentSuggestion=void 0}};e.prototype.nextSuggestion=function(){if(this.suggestions&&this.suggestions.length){if(this.currentIndex<this.suggestions.length-1){this.setSelectedSuggestion(this.currentIndex+1);return!0}if(this.currentIndex===this.suggestions.length-1){this.setSelectedSuggestion(0);return!0}}return!1};e.prototype.previousSuggestion=function(){if(this.suggestions&&this.suggestions.length){if(this.currentIndex>0){this.setSelectedSuggestion(this.currentIndex-1);return!0}if(0===this.currentIndex){this.setSelectedSuggestion(this.suggestions.length-1);return!0}}return!1};e.prototype.getSuggestions=function(){return this.suggestions};e.prototype.getCurrentItem=function(){return this.currentSuggestion};e.prototype.getSuggestionAtIndex=function(e){return this.suggestions[e]};e.prototype.hasSelectedSuggestion=function(){return!!this.currentSuggestion};e.prototype.removeSuggestion=function(e){this.suggestions.splice(e,1)};e.prototype.createGenericSuggestion=function(e){var t=this.convertSuggestionsToSuggestionItems([e])[0];this.currentSuggestion=t};e.prototype.convertSuggestionsToSuggestionItems=function(e){return Array.isArray(e)?e.map(this._ensureSuggestionModel):[]};e.prototype.deselectAllSuggestions=function(){if(this.currentIndex>-1){this.suggestions[this.currentIndex].selected=!1;this.currentIndex=-1}};e.prototype.setSelectedSuggestion=function(e){if(e>this.suggestions.length-1||e<0){this.currentIndex=0;this.currentSuggestion.selected=!1;this.currentSuggestion=this.suggestions[0];this.currentSuggestion.selected=!0}else{this.currentIndex>-1&&(this.suggestions[this.currentIndex].selected=!1);this.suggestions[e].selected=!0;this.currentIndex=e;this.currentSuggestion=this.suggestions[e]}};return e})(),C=n(1855),k=n(2074),L=n(138);Object(L.n)([{rawString:".pickerText_7f99953b{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-sizing:border-box;box-sizing:border-box;border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";min-width:180px;min-height:30px}.pickerText_7f99953b:hover{border-color:"},{theme:"inputBorderHovered",defaultValue:"#323130"},{rawString:"}.pickerText_7f99953b.inputFocused_7f99953b{position:relative;border-color:"},{theme:"inputFocusBorderAlt",defaultValue:"#0078d4"},{rawString:"}.pickerText_7f99953b.inputFocused_7f99953b:after{pointer-events:none;content:'';position:absolute;left:-1px;top:-1px;bottom:-1px;right:-1px;border:2px solid "},{theme:"inputFocusBorderAlt",defaultValue:"#0078d4"},{rawString:"}@media screen and (-ms-high-contrast:active){.pickerText_7f99953b.inputDisabled_7f99953b{position:relative;border-color:GrayText}.pickerText_7f99953b.inputDisabled_7f99953b:after{pointer-events:none;content:'';position:absolute;left:0;top:0;bottom:0;right:0;background-color:Window}}.pickerInput_7f99953b{height:34px;border:none;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;outline:0;padding:0 6px 0;-ms-flex-item-align:end;align-self:flex-end}.pickerItems_7f99953b{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;max-width:100%}.screenReaderOnly_7f99953b{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}]);var A="pickerText_7f99953b",O="inputFocused_7f99953b",M="inputDisabled_7f99953b",_="pickerInput_7f99953b",D="pickerItems_7f99953b",P="screenReaderOnly_7f99953b",H=r,B=Object(o.e)();var j=(function(e){Object(i.r)(t,e);function t(t){var n,r=e.call(this,t)||this;r.root=s.createRef();r.input=s.createRef();r.focusZone=s.createRef();r.suggestionElement=s.createRef();r.SuggestionOfProperType=E.e;r._styledSuggestions=(n=r.SuggestionOfProperType,Object(u.e)(n,T,void 0,{scope:"Suggestions"}));r.dismissSuggestions=function(e){var t=function(){var t=!0;r.props.onDismiss&&(t=r.props.onDismiss(e,r.suggestionStore.currentSuggestion?r.suggestionStore.currentSuggestion.item:void 0));(!e||e&&!e.defaultPrevented)&&!1!==t&&r.canAddItems()&&r.suggestionStore.hasSelectedSuggestion()&&r.state.suggestedDisplayValue&&r.addItemByIndex(0)};r.currentPromise?r.currentPromise.then(function(){return t()}):t();r.setState({suggestionsVisible:!1})};r.refocusSuggestions=function(e){r.resetFocus();r.suggestionStore.suggestions&&r.suggestionStore.suggestions.length>0&&(e===a.e.up?r.suggestionStore.setSelectedSuggestion(r.suggestionStore.suggestions.length-1):e===a.e.down&&r.suggestionStore.setSelectedSuggestion(0))};r.onInputChange=function(e){r.updateValue(e);r.setState({moreSuggestionsAvailable:!0,isMostRecentlyUsedVisible:!1})};r.onSuggestionClick=function(e,t,n){r.addItemByIndex(n)};r.onSuggestionRemove=function(e,t,n){r.props.onRemoveSuggestion&&r.props.onRemoveSuggestion(t);r.suggestionStore.removeSuggestion(n)};r.onInputFocus=function(e){r.selection.setAllSelected(!1);if(!r.state.isFocused){r.setState({isFocused:!0});r._userTriggeredSuggestions();r.props.inputProps&&r.props.inputProps.onFocus&&r.props.inputProps.onFocus(e)}};r.onInputBlur=function(e){r.props.inputProps&&r.props.inputProps.onBlur&&r.props.inputProps.onBlur(e)};r.onBlur=function(e){if(r.state.isFocused){var t=e.relatedTarget;null===e.relatedTarget&&(t=document.activeElement);if(t&&!Object(f.e)(r.root.current,t)){r.setState({isFocused:!1});r.props.onBlur&&r.props.onBlur(e)}}};r.onClick=function(e){void 0!==r.props.inputProps&&void 0!==r.props.inputProps.onClick&&r.props.inputProps.onClick(e);0===e.button&&r._userTriggeredSuggestions()};r.onKeyDown=function(e){var t=e.which;switch(t){case a.e.escape:if(r.state.suggestionsVisible){r.setState({suggestionsVisible:!1});e.preventDefault();e.stopPropagation()}break;case a.e.tab:case a.e.enter:if(r.suggestionElement.current&&r.suggestionElement.current.hasSuggestedActionSelected())r.suggestionElement.current.executeSelectedAction();else if(!e.shiftKey&&r.suggestionStore.hasSelectedSuggestion()&&r.state.suggestionsVisible){r.completeSuggestion();e.preventDefault();e.stopPropagation()}else r._completeGenericSuggestion();break;case a.e.backspace:r.props.disabled||r.onBackspace(e);e.stopPropagation();break;case a.e.del:if(!r.props.disabled)if(r.input.current&&e.target===r.input.current.inputElement&&r.state.suggestionsVisible&&-1!==r.suggestionStore.currentIndex){r.props.onRemoveSuggestion&&r.props.onRemoveSuggestion(r.suggestionStore.currentSuggestion.item);r.suggestionStore.removeSuggestion(r.suggestionStore.currentIndex);r.forceUpdate()}else r.onBackspace(e);e.stopPropagation();break;case a.e.up:if(r.input.current&&e.target===r.input.current.inputElement&&r.state.suggestionsVisible)if(r.suggestionElement.current&&r.suggestionElement.current.tryHandleKeyDown(t,r.suggestionStore.currentIndex)){e.preventDefault();e.stopPropagation();r.forceUpdate()}else if(r.suggestionElement.current&&r.suggestionElement.current.hasSuggestedAction()&&0===r.suggestionStore.currentIndex){e.preventDefault();e.stopPropagation();r.suggestionElement.current.focusAboveSuggestions();r.suggestionStore.deselectAllSuggestions();r.forceUpdate()}else if(r.suggestionStore.previousSuggestion()){e.preventDefault();e.stopPropagation();r.onSuggestionSelect()}break;case a.e.down:if(r.input.current&&e.target===r.input.current.inputElement&&r.state.suggestionsVisible)if(r.suggestionElement.current&&r.suggestionElement.current.tryHandleKeyDown(t,r.suggestionStore.currentIndex)){e.preventDefault();e.stopPropagation();r.forceUpdate()}else if(r.suggestionElement.current&&r.suggestionElement.current.hasSuggestedAction()&&r.suggestionStore.currentIndex+1===r.suggestionStore.suggestions.length){e.preventDefault();e.stopPropagation();r.suggestionElement.current.focusBelowSuggestions();r.suggestionStore.deselectAllSuggestions();r.forceUpdate()}else if(r.suggestionStore.nextSuggestion()){e.preventDefault();e.stopPropagation();r.onSuggestionSelect()}}};r.onItemChange=function(e,t){var n=r.state.items;if(t>=0){var i=n;i[t]=e;r._updateSelectedItems(i)}};r.onGetMoreResults=function(){r.setState({isSearching:!0},function(){if(r.props.onGetMoreResults&&r.input.current){var e=r.props.onGetMoreResults(r.input.current.value,r.state.items),t=e,n=e;if(Array.isArray(t)){r.updateSuggestions(t);r.setState({isSearching:!1})}else n.then&&n.then(function(e){r.updateSuggestions(e);r.setState({isSearching:!1})})}else r.setState({isSearching:!1});r.input.current&&r.input.current.focus();r.setState({moreSuggestionsAvailable:!1,isResultsFooterVisible:!0})})};r.completeSelection=function(e){r.addItem(e);r.updateValue("");r.input.current&&r.input.current.clear();r.setState({suggestionsVisible:!1})};r.addItemByIndex=function(e){r.completeSelection(r.suggestionStore.getSuggestionAtIndex(e).item)};r.addItem=function(e){var t=r.props.onItemSelected?r.props.onItemSelected(e):e;if(null!==t){var n=t,i=t;if(i&&i.then)i.then(function(e){var t=r.state.items.concat([e]);r._updateSelectedItems(t)});else{var s=r.state.items.concat([n]);r._updateSelectedItems(s)}r.setState({suggestedDisplayValue:""})}};r.removeItem=function(e,t){var n=r.state.items,i=n.indexOf(e);if(i>=0){var s=n.slice(0,i).concat(n.slice(i+1));r._updateSelectedItems(s)}};r.removeItems=function(e){var t=r.state.items.filter(function(t){return-1===e.indexOf(t)});r._updateSelectedItems(t)};r._shouldFocusZoneEnterInnerZone=function(e){if(r.state.suggestionsVisible)switch(e.which){case a.e.up:case a.e.down:return!0}return e.which===a.e.enter};r._onResolveSuggestions=function(e){var t=r.props.onResolveSuggestions(e,r.state.items);null!==t&&r.updateSuggestionsList(t,e)};r._completeGenericSuggestion=function(){if(r.props.onValidateInput&&r.input.current&&r.props.onValidateInput(r.input.current.value)!==C.e.invalid&&r.props.createGenericItem){var e=r.props.createGenericItem(r.input.current.value,r.props.onValidateInput(r.input.current.value));r.suggestionStore.createGenericSuggestion(e);r.completeSuggestion()}};r._userTriggeredSuggestions=function(){if(!r.state.suggestionsVisible){var e=r.input.current?r.input.current.value:"";e?0===r.suggestionStore.suggestions.length?r._onResolveSuggestions(e):r.setState({isMostRecentlyUsedVisible:!1,suggestionsVisible:!0}):r.onEmptyInputFocus()}};Object(l.e)(r);r._async=new c.e(r);var i=t.selectedItems||t.defaultSelectedItems||[];r._id=Object(h.e)();r._ariaMap={selectedItems:"selected-items-"+r._id,selectedSuggestionAlert:"selected-suggestion-alert-"+r._id,suggestionList:"suggestion-list-"+r._id,combobox:"combobox-"+r._id};r.suggestionStore=new N;r.selection=new y.e({onSelectionChanged:function(){return r.onSelectionChange()}});r.selection.setItems(i);r.state={items:i,suggestedDisplayValue:"",isMostRecentlyUsedVisible:!1,moreSuggestionsAvailable:!1,isFocused:!1,isSearching:!1,selectedIndices:[]};return r}t.getDerivedStateFromProps=function(e){return e.selectedItems?{items:e.selectedItems}:null};Object.defineProperty(t.prototype,"items",{get:function(){return this.state.items},enumerable:!0,configurable:!0});t.prototype.componentDidMount=function(){this.selection.setItems(this.state.items);this._onResolveSuggestions=this._async.debounce(this._onResolveSuggestions,this.props.resolveDelay)};t.prototype.componentDidUpdate=function(e,t){if(this.state.items&&this.state.items!==t.items){var n=this.selection.getSelectedIndices()[0];this.selection.setItems(this.state.items);if(this.state.isFocused&&this.state.items.length<t.items.length){this.selection.setIndexSelected(n,!0,!0);this.resetFocus(n)}}};t.prototype.componentWillUnmount=function(){this.currentPromise&&(this.currentPromise=void 0);this._async.dispose()};t.prototype.focus=function(){this.focusZone.current&&this.focusZone.current.focus()};t.prototype.focusInput=function(){this.input.current&&this.input.current.focus()};t.prototype.completeSuggestion=function(e){this.suggestionStore.hasSelectedSuggestion()&&this.input.current?this.completeSelection(this.suggestionStore.currentSuggestion.item):e&&this._completeGenericSuggestion()};t.prototype.render=function(){var e,t,n=this.state,r=n.suggestedDisplayValue,o=n.isFocused,u=n.items,a=this.props,f=a.className,l=a.inputProps,c=a.disabled,h=a.theme,m=a.styles,g=this.state.suggestionsVisible?this._ariaMap.suggestionList:"",y=m?B(m,{theme:h,className:f,isFocused:o,disabled:c,inputClassName:l&&l.className}):{root:Object(p.e)("ms-BasePicker",f||""),text:Object(p.e)("ms-BasePicker-text",H.pickerText,this.state.isFocused&&H.inputFocused),itemsWrapper:H.pickerItems,input:Object(p.e)("ms-BasePicker-input",H.pickerInput,l&&l.className),screenReaderText:H.screenReaderOnly};return s.createElement("div",{ref:this.root,className:y.root,onKeyDown:this.onKeyDown,onBlur:this.onBlur},s.createElement(d.e,{componentRef:this.focusZone,direction:v.e.bidirectional,shouldEnterInnerZone:this._shouldFocusZoneEnterInnerZone},this.getSuggestionsAlert(y.screenReaderText),s.createElement(b.e,{selection:this.selection,selectionMode:w.t.multiple},s.createElement("div",{className:y.text},u.length>0&&s.createElement("span",{id:this._ariaMap.selectedItems,className:y.itemsWrapper,role:"list"},this.renderItems()),this.canAddItems()&&s.createElement(k.e,Object(i.e)({spellCheck:!1},l,{className:y.input,componentRef:this.input,id:(null===(e=l)||void 0===e?void 0:e.id)?l.id:this._ariaMap.combobox,onClick:this.onClick,onFocus:this.onInputFocus,onBlur:this.onInputBlur,onInputValueChange:this.onInputChange,suggestedDisplayValue:r,"aria-activedescendant":this.getActiveDescendant(),"aria-controls":g,"aria-describedby":u.length>0?this._ariaMap.selectedItems:void 0,"aria-expanded":!!this.state.suggestionsVisible,"aria-haspopup":"listbox","aria-label":this.props["aria-label"]||(null===(t=l)||void 0===t?void 0:t["aria-label"]),role:"combobox",disabled:c,onInputChange:this.props.onInputChange}))))),this.renderSuggestions())};t.prototype.canAddItems=function(){var e=this.state.items,t=this.props.itemLimit;return void 0===t||e.length<t};t.prototype.renderSuggestions=function(){var e=this._styledSuggestions;return this.state.suggestionsVisible&&this.input?s.createElement(m.e,Object(i.e)({isBeakVisible:!1,gapSpace:5,target:this.input.current?this.input.current.inputElement:void 0,onDismiss:this.dismissSuggestions,directionalHint:g.e.bottomLeftEdge,directionalHintForRTL:g.e.bottomRightEdge},this.props.pickerCalloutProps),s.createElement(e,Object(i.e)({onRenderSuggestion:this.props.onRenderSuggestionsItem,onSuggestionClick:this.onSuggestionClick,onSuggestionRemove:this.onSuggestionRemove,suggestions:this.suggestionStore.getSuggestions(),componentRef:this.suggestionElement,onGetMoreResults:this.onGetMoreResults,moreSuggestionsAvailable:this.state.moreSuggestionsAvailable,isLoading:this.state.suggestionsLoading,isSearching:this.state.isSearching,isMostRecentlyUsedVisible:this.state.isMostRecentlyUsedVisible,isResultsFooterVisible:this.state.isResultsFooterVisible,refocusSuggestions:this.refocusSuggestions,removeSuggestionAriaLabel:this.props.removeButtonAriaLabel,suggestionsListId:this._ariaMap.suggestionList,createGenericItem:this._completeGenericSuggestion},this.props.pickerSuggestionsProps))):null};t.prototype.renderItems=function(){var e=this,t=this.props,n=t.disabled,r=t.removeButtonAriaLabel,i=this.props.onRenderItem,s=this.state,o=s.items,u=s.selectedIndices;return o.map(function(t,s){return i({item:t,index:s,key:t.key?t.key:s,selected:-1!==u.indexOf(s),onRemoveItem:function(){return e.removeItem(t,!0)},disabled:n,onItemChange:e.onItemChange,removeButtonAriaLabel:r})})};t.prototype.resetFocus=function(e){var t=this.state.items;if(t.length&&e>=0){var n=this.root.current&&this.root.current.querySelectorAll("[data-selection-index]")[Math.min(e,t.length-1)];n&&this.focusZone.current&&this.focusZone.current.focusElement(n)}else this.canAddItems()?this.input.current&&this.input.current.focus():this.resetFocus(t.length-1)};t.prototype.onSuggestionSelect=function(){if(this.suggestionStore.currentSuggestion){var e=this.input.current?this.input.current.value:"",t=this._getTextFromItem(this.suggestionStore.currentSuggestion.item,e);this.setState({suggestedDisplayValue:t})}};t.prototype.onSelectionChange=function(){this.setState({selectedIndices:this.selection.getSelectedIndices()})};t.prototype.updateSuggestions=function(e){this.suggestionStore.updateSuggestions(e,0);this.forceUpdate()};t.prototype.onEmptyInputFocus=function(){var e=this.props.onEmptyResolveSuggestions?this.props.onEmptyResolveSuggestions:this.props.onEmptyInputFocus;if(e){var t=e(this.state.items);this.updateSuggestionsList(t);this.setState({isMostRecentlyUsedVisible:!0,suggestionsVisible:!0,moreSuggestionsAvailable:!1})}};t.prototype.updateValue=function(e){this._onResolveSuggestions(e)};t.prototype.updateSuggestionsList=function(e,t){var n=this,r=e,i=e;if(Array.isArray(r))this._updateAndResolveValue(t,r);else if(i&&i.then){this.setState({suggestionsLoading:!0});this.suggestionStore.updateSuggestions([]);void 0!==t?this.setState({suggestionsVisible:this._getShowSuggestions()}):this.setState({suggestionsVisible:this.input.current&&this.input.current.inputElement===document.activeElement});var s=this.currentPromise=i;s.then(function(e){s===n.currentPromise&&n._updateAndResolveValue(t,e)})}};t.prototype.resolveNewValue=function(e,t){var n=this;this.updateSuggestions(t);var r=void 0;this.suggestionStore.currentSuggestion&&(r=this._getTextFromItem(this.suggestionStore.currentSuggestion.item,e));this.setState({suggestedDisplayValue:r,suggestionsVisible:this._getShowSuggestions()},function(){return n.setState({suggestionsLoading:!1})})};t.prototype.onChange=function(e){this.props.onChange&&this.props.onChange(e)};t.prototype.onBackspace=function(e){(this.state.items.length&&!this.input.current||this.input.current&&!this.input.current.isValueSelected&&0===this.input.current.cursorLocation)&&(this.selection.getSelectedCount()>0?this.removeItems(this.selection.getSelection()):this.removeItem(this.state.items[this.state.items.length-1]))};t.prototype.getActiveDescendant=function(){if(!this.state.suggestionsLoading){var e=this.suggestionStore.currentIndex;return e<0&&this.suggestionElement.current&&this.suggestionElement.current.hasSuggestedAction()?"sug-selectedAction":e>-1&&!this.state.suggestionsLoading?"sug-"+e:void 0}};t.prototype.getSuggestionsAlert=function(e){void 0===e&&(e=H.screenReaderOnly);var t=this.suggestionStore.currentIndex;if(this.props.enableSelectedSuggestionAlert){var n=t>-1?this.suggestionStore.getSuggestionAtIndex(this.suggestionStore.currentIndex):void 0,r=n?n.ariaLabel:void 0;return s.createElement("div",{className:e,role:"alert",id:this._ariaMap.selectedSuggestionAlert,"aria-live":"assertive"},r," ")}};t.prototype._updateAndResolveValue=function(e,t){if(void 0!==e)this.resolveNewValue(e,t);else{this.suggestionStore.updateSuggestions(t,-1);this.state.suggestionsLoading&&this.setState({suggestionsLoading:!1})}};t.prototype._updateSelectedItems=function(e){var t=this;this.props.selectedItems?this.onChange(e):this.setState({items:e},function(){t._onSelectedItemsUpdated(e)})};t.prototype._onSelectedItemsUpdated=function(e){this.onChange(e)};t.prototype._getShowSuggestions=function(){return void 0!==this.input.current&&null!==this.input.current&&this.input.current.inputElement===document.activeElement&&""!==this.input.current.value};t.prototype._getTextFromItem=function(e,t){return this.props.getTextFromItem?this.props.getTextFromItem(e,t):""};return t})(s.Component),F=(function(e){Object(i.r)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.state,t=e.suggestedDisplayValue,n=e.isFocused,r=this.props,o=r.className,u=r.inputProps,a=r.disabled,f=r.theme,l=r.styles,c=this.state.suggestionsVisible?this._ariaMap.suggestionList:"",h=l?B(l,{theme:f,className:o,isFocused:n,inputClassName:u&&u.className}):{root:Object(p.e)("ms-BasePicker",o||""),text:Object(p.e)("ms-BasePicker-text",H.pickerText,this.state.isFocused&&H.inputFocused,a&&H.inputDisabled),input:Object(p.e)("ms-BasePicker-input",H.pickerInput,u&&u.className),screenReaderText:H.screenReaderOnly};return s.createElement("div",{ref:this.root,onBlur:this.onBlur},s.createElement("div",{className:h.root,onKeyDown:this.onKeyDown},this.getSuggestionsAlert(h.screenReaderText),s.createElement("div",{className:h.text},s.createElement(k.e,Object(i.e)({},u,{className:h.input,componentRef:this.input,onFocus:this.onInputFocus,onBlur:this.onInputBlur,onClick:this.onClick,onInputValueChange:this.onInputChange,suggestedDisplayValue:t,"aria-activedescendant":this.getActiveDescendant(),"aria-controls":c||void 0,"aria-expanded":!!this.state.suggestionsVisible,"aria-haspopup":"listbox",role:"combobox",disabled:a,onInputChange:this.props.onInputChange})))),this.renderSuggestions(),s.createElement(b.e,{selection:this.selection,selectionMode:w.t.single},s.createElement(d.e,{componentRef:this.focusZone,className:"ms-BasePicker-selectedItems",isCircularNavigation:!0,direction:v.e.bidirectional,shouldEnterInnerZone:this._shouldFocusZoneEnterInnerZone,id:this._ariaMap.selectedItems,role:"list"},this.renderItems())))};t.prototype.onBackspace=function(e){};return t})(j)},,function(e,t,n){"use strict";n.d(t,"e",function(){return v});var r=n(0),i=n(138);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-SharedWith{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex}.od-SharedWith .label{font-size:.875rem;font-weight:600;padding-right:4px;white-space:nowrap}.od-SharedWith-Facepile{display:-webkit-box;display:-ms-flexbox;display:flex;position:relative}.od-SharedWith-Facepile button.compact{height:auto;padding:2px;width:auto}.od-SharedWith-Facepile button.compact:hover{background-color:transparent}.od-SharedWith-Facepile li{display:-webkit-box;display:-ms-flexbox;display:flex}.od-SharedWith-List{display:-webkit-box;display:-ms-flexbox;display:flex}.od-SharedWith-List li{-ms-flex-negative:0;flex-shrink:0}.od-SharedWith-Persona{display:-webkit-box;display:-ms-flexbox;display:flex;position:relative}.od-SharedWith-Persona-measure{left:0px;position:absolute;visibility:hidden}.od-SharedWith-Persona .od-SharedWith-Persona-measure{margin-left:0px}.od-SharedWith-Link .ms-Persona-initials{background-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-SharedWith-Link .ms-Persona-initials i{font-weight:400}.od-SharedWith-More .ms-Persona-initials{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}\n"}]);var s=n(1709),o=n(1654),u=n(22),a=n("react-lib"),f=n("react-dom-lib"),l=n(1670),c=n(993),h=n(2051),p=n(1508),d=n(1688);n(2218);function v(e){var t=e.ariaLabel,n=e.label,r=e.getPhotoUrl,i=e.onClick,l=e.sharingPrincipals,c=e.sharingLinks,h=a.useRef(null),p=a.useRef(null),v=a.useRef(null),g=a.useState(!0),y=g[0],b=g[1],w=a.useState(0),E=w[0],S=w[1],x=a.useMemo(function(){var e=[],n={},f=0;if(c.length)for(var h=0,p=c;h<p.length;h++){var v=p[h];if(v.principals.length||v.invitees.length){for(var g=0,y=v.principals;g<y.length;g++){n[(C=y[g]).loginName]=C}if(v.isActive&&(!v.expiration||v.expiration.getTime()>Date.now()))for(var b=0,w=v.invitees;b<w.length;b++){n[(C=w[b]).loginName]=C}}f++}for(var E=0,S=l;E<S.length;E++){n[(C=S[E]).loginName]=C}f&&e.push(a.createElement(m,{ariaLabel:t,className:"od-SharedWith-Link",iconName:"Link",key:".link",onClick:i,title:1===f?o.Fs:Object(u.format)(o.js,f)}));for(var x=0,T=Object.keys(n);x<T.length;x++){var N=T[x],C=n[N],k=void 0;k=!Object(d.d)()&&C.imageUrl?C.imageUrl:C.type===s.e.user&&r?r(N):void 0;e.push(a.createElement(m,{ariaLabel:t,imageUrl:k,key:C.primaryText,onClick:i,text:C.primaryText,title:C.email?C.primaryText+" <"+C.email+">":C.primaryText}))}return e},[l,c]);a.useEffect(function(){h.current=new IntersectionObserver(T,{root:v.current,threshold:1});return function(){return h.current.disconnect()}},[]);a.useEffect(function(){if(h.current&&p.current){for(var e=[],t=0;t<p.current.children.length;t++){var n=p.current.children[t];h.current.observe(n);e.push(n)}return function(){for(var t=0,n=e;t<n.length;t++){var r=n[t];h.current.unobserve(r)}}}});return a.createElement("div",{className:"od-SharedWith",ref:v},n&&a.createElement("span",{className:"label"},n),a.createElement("div",{"aria-label":n,className:"od-SharedWith-Facepile"},!y&&a.createElement("ul",{className:"od-SharedWith-List"},x.slice(0,E<x.length-1?E:void 0),E<x.length-1?a.createElement(m,{ariaLabel:t,className:"od-SharedWith-More",iconName:"More",key:".more",onClick:i,title:o.Is}):null),a.createElement("ul",{"aria-hidden":!0,className:"od-SharedWith-List od-SharedWith-Persona-measure",ref:p,role:"presentation"},x)));function T(e){var t=0,n=1e3;if(p.current){for(var r=0,i=e;r<i.length;r++)for(var s=i[r],o=0;o<p.current.children.length;o++){if(p.current.children[o]===s.target){s.intersectionRect.width===s.boundingClientRect.width?t=Math.max(t,o):n=Math.min(n,o);break}}0===t&&1e3!==n&&(t=Math.max(0,n-1));Object(f.unstable_batchedUpdates)(function(){S(function(e){return e!==t?t:e});b(!1)})}}}function m(e){var t=e.ariaLabel,n=e.className,i=e.iconName,s=e.imageUrl,o=e.onClick,u=e.text,f=e.title,d={text:u,imageUrl:s,hidePersonaDetails:!0,showInitialsUntilImageLoads:!0,size:l.n.size24,onRenderInitials:i?function(){return a.createElement(c.e,{iconName:i})}:void 0,coinProps:{styles:{coin:{width:"1.5rem",height:"1.5rem"},image:{width:"1.5rem !important",height:"1.5rem !important"},imageArea:{width:"1.5rem",height:"1.5rem"},initials:{width:"1.5rem",height:"1.5rem",fontSize:"0.625rem",lineHeight:"1.5rem"}}},styles:{root:{height:"1.5rem"},primaryText:{fontSize:"0.875rem"},secondaryText:{fontSize:"0.75rem"}}},v=a.createElement(h.e,Object(r.__assign)({},d));o&&(v=a.createElement(p.e,{"aria-haspopup":!0,ariaLabel:t,className:"compact",onClick:o,styles:{root:{height:"2rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:{height:"2rem"}}},v));return a.createElement("li",{className:n,title:f},v)}},,function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(0),i=n(138);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareLinkDescription{-webkit-box-align:top;-ms-flex-align:top;align-items:top;display:-webkit-box;display:-ms-flexbox;display:flex;padding:6px 0px 2px 0px;width:100%}.isFluent .od-ShareLinkDescription{padding:4px 0}.od-ShareLinkDescription-label{font-size:.875rem;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";display:-webkit-box;display:-ms-flexbox;display:flex;overflow:hidden;text-overflow:ellipsis;vertical-align:top;font:-apple-system-subheadline;width:80%;padding-top:2px}[dir='ltr'] .od-ShareLinkDescription-label{margin-left:8px}[dir='rtl'] .od-ShareLinkDescription-label{margin-right:8px}[dir='ltr'] .od-ShareLinkDescription-label{text-align:left}[dir='rtl'] .od-ShareLinkDescription-label{text-align:right}.isFluent .od-ShareLinkDescription-label{padding-top:0;position:relative;top:2px}.od-ShareLinkDescription-image{width:1rem;height:1rem}.od-ShareLinkDescription-icon{-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-radius:50%;border-style:solid;border-width:.0625rem;-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-box;display:-ms-flexbox;display:flex;height:1.5rem;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:1.5rem}.isFluent .od-ShareLinkDescription-icon{font-size:.875rem}.od-ShareLinkDescription-icon .ms-Icon{font-size:.875rem}.od-ShareLinkDescription-icon.icon-PeopleAdd{color:#393939;background:#f2f2f2;border:1px solid #393939}.od-ShareLinkDescription-icon.icon-Work{color:#004e8c;background:#f0f5f8;border:1px solid #004e8c}.od-ShareLinkDescription-icon.icon-Chat{color:#6264a7;background:#f6f6fa;border:1px solid #6264a7}.od-ShareLinkDescription-icon.icon-Mail{color:"},{theme:"teal",defaultValue:"#008272"},{rawString:";background:#f0f5f7;border:1px solid "},{theme:"teal",defaultValue:"#008272"},{rawString:"}.od-ShareLinkDescription-icon.icon-Globe{color:#0b6a0b;background:#f1f6f1;border:1px solid #0b6a0b}.od-ShareLinkDescription-icon.icon-SecurityGroup{color:#8e562e;background:#f4efeb;border:1px solid #8e562e}.od-ShareLinkDescription-icon .ms-Icon--PeopleAdd{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);color:"},{theme:"orangeLight",defaultValue:"#ea4300"},{rawString:";position:relative;display:inline-block;border-radius:50%;width:1.5rem;height:1.5rem;border:.0625rem solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}[dir='ltr'] .od-ShareLinkDescription-icon .ms-Icon--PeopleAdd{padding-right:10px}[dir='rtl'] .od-ShareLinkDescription-icon .ms-Icon--PeopleAdd{padding-left:10px}\n"}]);var s=n(1892),o=n(2065),u=n(993),a=n("react-lib"),f=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=s.e[this.props.permissionsType],t=this.props.iconUrl?a.createElement("img",{"aria-hidden":"true",className:"od-ShareLinkDescription-image",src:this.props.iconUrl,alt:this.props.label}):a.createElement(u.e,{"aria-hidden":"true",iconName:e,styles:{root:{fontSize:"0.875rem",width:"2.75",height:"2.75"}}});return a.createElement("div",{className:"od-ShareLinkDescription"},a.createElement("div",{className:"od-ShareLinkDescription-icon icon-"+e,"aria-hidden":"true"},t),this._renderLabel())};t.prototype._renderLabel=function(){var e=this.props.infoButtonMessage,t=e?a.createElement(o.e,{message:e}):"";if(this.props.showLabel)return a.createElement("div",{className:"od-ShareLinkDescription-label"},this.props.label,t)};return t})(a.Component)},function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(0),i=n(138);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-InfoButton-infoIcon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";padding:5px 4px 4px 4px;font-size:.75rem}.od-InfoButton-button{background:none;border:none;padding:0}.od-InfoButton-content{font-size:.75rem;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding:10px;width:250px}\n"}]);var s=n(1439),o=n(97),u=n(993),a=n("react-lib"),f=n("prop-types-lib"),l=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this;i._onShowCallout=function(){i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{isCalloutVisible:!0}))};i._onDismissCallout=function(){i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{isCalloutVisible:!1}))};i._onInfoButton=function(e){i._infoButton=e};i.state={isCalloutVisible:!1};return i}t.prototype.render=function(){var e=this.props,t=this.state;return a.createElement("div",null,a.createElement("div",{className:"od-InfoButton-button",onClick:this._onShowCallout,ref:this._onInfoButton},a.createElement(u.e,{iconName:"Info",className:"od-InfoButton-infoIcon",onMouseOver:this._onShowCallout,onMouseLeave:this._onDismissCallout,styles:{root:{fontSize:"0.75rem"}}})),t.isCalloutVisible&&a.createElement(s.e,{directionalHint:o.e.topCenter,gapSpace:2,onDismiss:this._onDismissCallout,target:this._infoButton,setInitialFocus:!0},a.createElement("div",{className:"od-InfoButton-content"},a.createElement("span",{className:"od-InfoButton-message"},e.message))))};t.contextTypes={strings:f.object.isRequired};return t})(a.Component)},function(e,t,n){"use strict";var r=n(0),i=n(138);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-SendButton-linkButton{font-size:17px;font:-apple-system-headline}\n"}]);var s=n("react-lib"),o=n(1772),u=n(1635),a=n(2298),f=n(1938),l=n(1665),c=n("prop-types-lib"),h=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._onSendLinkClicked=function(){r.props.onSendLinkClicked(r.props.messageText,r.props.subjectText)};r._platformDetection=n.platformDetection;return r}t.prototype.render=function(){var e=!1;if(this.props.currentSettings.audience===a.e.existing)for(var t=0,n=this.props.linkRecipients;t<n.length;t++){var r=n[t];if(void 0===this.props.permissionsMap[r.email]&&void 0===this.props.permissionsMap[r.userId]){e=!0;break}}if(this.props.ctaLabel){var i=!!this.props.errorMessage||Object(l.L)(this.props.sharingInformation)||e||Object(l.h)(this.props.messageText)>this.props.maximumMessageLength||Object(l.h)(this.props.subjectText)>this.props.maximumSubjectLength;if(this.props.sendButtonType===f.e.button)return s.createElement(o.e,{disabled:i,onClick:this._onSendLinkClicked},this.props.ctaLabel);if(this.props.sendButtonType===f.e.link)return s.createElement("div",{className:"od-SendButton-linkButton"},s.createElement(u.e,{disabled:i,onClick:this._onSendLinkClicked},this._platformDetection.isAndroid?this.props.ctaLabel.toUpperCase():this.props.ctaLabel))}};t.contextTypes={platformDetection:c.object.isRequired};return t})(s.Component);t.e=h},,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.Both=0]="Both";e[e.Header=1]="Header";e[e.Footer=2]="Footer"})(r||(r={}))},,,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n("react-lib"),s=n(1804),o=n(117);function u(e){var t=(function(t){Object(r.__extends)(n,t);function n(){return null!==t&&t.apply(this,arguments)||this}n.prototype.render=function(){var t=this.props,n=t.resources,o=Object(r.__rest)(t,["resources"]);return i.createElement(s.e,{specification:Object(s.t)(e,o),resources:n})};return n})(i.PureComponent);return Object(o.r)()(t)}},function(e,t,n){"use strict";e.exports=n(2091).polyfill()},function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(4),i=n("react-lib"),s=n(1884),o=n(129),u=n(886),a=n(207),f=n(270),l=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;n._inputElement=i.createRef();n._autoFillEnabled=!0;n._isComposing=!1;n._onCompositionStart=function(e){n._isComposing=!0;n._autoFillEnabled=!1};n._onCompositionUpdate=function(){Object(s.e)()&&n._updateValue(n._getCurrentInputValue(),!0)};n._onCompositionEnd=function(e){var t=n._getCurrentInputValue();n._tryEnableAutofill(t,n.value,!1,!0);n._isComposing=!1;n._async.setTimeout(function(){n._updateValue(n._getCurrentInputValue(),!1)},0)};n._onClick=function(){n._value&&""!==n._value&&n._autoFillEnabled&&(n._autoFillEnabled=!1)};n._onKeyDown=function(e){n.props.onKeyDown&&n.props.onKeyDown(e);if(!e.nativeEvent.isComposing)switch(e.which){case o.e.backspace:n._autoFillEnabled=!1;break;case o.e.left:case o.e.right:if(n._autoFillEnabled){n._value=n.state.displayValue;n._autoFillEnabled=!1}break;default:n._autoFillEnabled||-1!==n.props.enableAutofillOnKeyPress.indexOf(e.which)&&(n._autoFillEnabled=!0)}};n._onInputChanged=function(e){var t=n._getCurrentInputValue(e);n._isComposing||n._tryEnableAutofill(t,n._value,e.nativeEvent.isComposing);if(!Object(s.e)()||!n._isComposing){var r=e.nativeEvent.isComposing,i=void 0===r?n._isComposing:r;n._updateValue(t,i)}};n._onChanged=function(){};n._updateValue=function(e,t){if(e||e!==n._value){n._value=n.props.onInputChange?n.props.onInputChange(e,t):e;n.setState({displayValue:n._getDisplayValue(n._value,n.props.suggestedDisplayValue)},function(){return n._notifyInputChange(n._value,t)})}};Object(u.e)(n);n._async=new a.e(n);n._value=t.defaultVisibleValue||"";n.state={displayValue:t.defaultVisibleValue||""};return n}Object.defineProperty(t.prototype,"cursorLocation",{get:function(){if(this._inputElement.current){var e=this._inputElement.current;return"forward"!==e.selectionDirection?e.selectionEnd:e.selectionStart}return-1},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"isValueSelected",{get:function(){return Boolean(this.inputElement&&this.inputElement.selectionStart!==this.inputElement.selectionEnd)},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"selectionStart",{get:function(){return this._inputElement.current?this._inputElement.current.selectionStart:-1},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"selectionEnd",{get:function(){return this._inputElement.current?this._inputElement.current.selectionEnd:-1},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"inputElement",{get:function(){return this._inputElement.current},enumerable:!0,configurable:!0});t.prototype.UNSAFE_componentWillReceiveProps=function(e){if(this.props.updateValueInWillReceiveProps){var t=this.props.updateValueInWillReceiveProps();null!==t&&t!==this._value&&(this._value=t)}var n=this._getDisplayValue(this._value,e.suggestedDisplayValue);"string"==typeof n&&this.setState({displayValue:n})};t.prototype.componentDidUpdate=function(){var e=this._value,t=this.props,n=t.suggestedDisplayValue,r=t.shouldSelectFullInputValueInComponentDidUpdate,i=0;if(!t.preventValueSelection&&this._autoFillEnabled&&e&&n&&this._doesTextStartWith(n,e)){var s=!1;r&&(s=r());if(s&&this._inputElement.current)this._inputElement.current.setSelectionRange(0,n.length,"backward");else{for(;i<e.length&&e[i].toLocaleLowerCase()===n[i].toLocaleLowerCase();)i++;i>0&&this._inputElement.current&&this._inputElement.current.setSelectionRange(i,n.length,"backward")}}};t.prototype.componentWillUnmount=function(){this._async.dispose()};t.prototype.render=function(){var e=this.state.displayValue,t=Object(f.u)(this.props,f.h);return i.createElement("input",Object(r.e)({autoCapitalize:"off",autoComplete:"off","aria-autocomplete":"both"},t,{ref:this._inputElement,value:e,onCompositionStart:this._onCompositionStart,onCompositionUpdate:this._onCompositionUpdate,onCompositionEnd:this._onCompositionEnd,onChange:this._onChanged,onInput:this._onInputChanged,onKeyDown:this._onKeyDown,onClick:this.props.onClick?this.props.onClick:this._onClick,"data-lpignore":!0}))};t.prototype.focus=function(){this._inputElement.current&&this._inputElement.current.focus()};t.prototype.clear=function(){this._autoFillEnabled=!0;this._updateValue("",!1);this._inputElement.current&&this._inputElement.current.setSelectionRange(0,0)};t.prototype._getCurrentInputValue=function(e){return e&&e.target&&e.target.value?e.target.value:this.inputElement&&this.inputElement.value?this.inputElement.value:""};t.prototype._tryEnableAutofill=function(e,t,n,r){!n&&e&&this._inputElement.current&&this._inputElement.current.selectionStart===e.length&&!this._autoFillEnabled&&(e.length>t.length||r)&&(this._autoFillEnabled=!0)};t.prototype._notifyInputChange=function(e,t){this.props.onInputValueChange&&this.props.onInputValueChange(e,t)};t.prototype._getDisplayValue=function(e,t){var n=e;t&&e&&this._doesTextStartWith(t,n)&&this._autoFillEnabled&&(n=t);return n};t.prototype._doesTextStartWith=function(e,t){return!(!e||!t)&&0===e.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())};t.defaultProps={enableAutofillOnKeyPress:[o.e.down,o.e.up]};return t})(i.Component);(function(e){Object(r.r)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}})(l)},function(e,t,n){"use strict";var r=n("knockout-lib"),i=n(1662),s=(function(){function e(){}e.init=function(e,t,n,s,o){var u=t(),a={Enter:function(e){u(!u());return!1}},f=new i.e({element:e,bindingContext:o,allBindingsAccessor:n,valueAccessor:function(){return a}});r.applyBindingsToNode(e,f,o);r.applyBindingsToNode(e,{click:function(){return u(!u())}},o)};return e})();t.e=s},,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return J});var r=n(1419),i=n(25),s={root:"ms-GroupedList",compact:"ms-GroupedList--Compact",group:"ms-GroupedList-group",link:"ms-Link",listCell:"ms-List-cell"},o="cubic-bezier(0.445, 0.050, 0.550, 0.950)",u=n(4),a=n("react-lib"),f=n(472),l=n(705),c=n(129),h=n(886),p=n(37),d=n(653),v=n(95),m=n(107),g=n(506),y=n(292),b=n(1010),w=n(712),E={root:"ms-GroupHeader",compact:"ms-GroupHeader--compact",check:"ms-GroupHeader-check",dropIcon:"ms-GroupHeader-dropIcon",expand:"ms-GroupHeader-expand",isCollapsed:"is-collapsed",title:"ms-GroupHeader-title",isSelected:"is-selected",iconTag:"ms-Icon--Tag",group:"ms-GroupedList-group",isDropping:"is-dropping"},S="cubic-bezier(0.075, 0.820, 0.165, 1.000)",x="cubic-bezier(0.390, 0.575, 0.565, 1.000)",T="cubic-bezier(0.600, -0.280, 0.735, 0.045)",N=n(1466),C=n(1424),k=n(993),L=n(1637),A=Object(f.e)(),O=(function(e){Object(u.r)(t,e);function t(t){var n=e.call(this,t)||this;n._toggleCollapse=function(){var e=n.props,t=e.group,r=e.onToggleCollapse,i=e.isGroupLoading,s=!n.state.isCollapsed,o=!s&&i&&i(t);n.setState({isCollapsed:s,isLoadingVisible:o});r&&r(t)};n._onKeyUp=function(e){var t=n.props,r=t.group,i=t.onGroupHeaderKeyUp;i&&i(e,r);if(!e.defaultPrevented){var s=n.state.isCollapsed&&e.which===Object(l.t)(c.e.right,n.props.theme);if(!n.state.isCollapsed&&e.which===Object(l.t)(c.e.left,n.props.theme)||s){n._toggleCollapse();e.stopPropagation();e.preventDefault()}}};n._onToggleClick=function(e){n._toggleCollapse();e.stopPropagation();e.preventDefault()};n._onToggleSelectGroupClick=function(e){var t=n.props,r=t.onToggleSelectGroup,i=t.group;r&&r(i);e.preventDefault();e.stopPropagation()};n._onHeaderClick=function(){var e=n.props,t=e.group,r=e.onGroupHeaderClick,i=e.onToggleSelectGroup;r?r(t):i&&i(t)};n._onRenderTitle=function(e){var t=e.group,r=e.ariaColSpan;return t?a.createElement("div",{className:n._classNames.title,id:n._id,role:"gridcell","aria-colspan":r},a.createElement("span",null,t.name),a.createElement("span",{className:n._classNames.headerCount},"(",t.count,t.hasMoreData&&"+",")")):null};n._id=Object(d.e)("GroupHeader");n.state={isCollapsed:n.props.group&&n.props.group.isCollapsed,isLoadingVisible:!1};return n}t.getDerivedStateFromProps=function(e,t){if(e.group){var n=e.group.isCollapsed,r=e.isGroupLoading,i=!n&&r&&r(e.group);return Object(u.e)(Object(u.e)({},t),{isCollapsed:n||!1,isLoadingVisible:i||!1})}return t};t.prototype.render=function(){var e=this.props,t=e.group,n=e.groupLevel,r=void 0===n?0:n,i=e.viewport,s=e.selectionMode,o=e.loadingText,f=e.isSelected,c=void 0!==f&&f,h=e.selected,p=void 0!==h&&h,d=e.indentWidth,v=e.onRenderTitle,g=void 0===v?this._onRenderTitle:v,y=e.onRenderGroupHeaderCheckbox,b=e.isCollapsedGroupSelectVisible,E=void 0===b||b,S=e.expandButtonProps,x=e.expandButtonIcon,T=e.selectAllButtonProps,C=e.theme,O=e.styles,M=e.className,_=e.compact,D=e.ariaPosInSet,P=e.ariaSetSize,H=e.useFastIcons?this._fastDefaultCheckboxRender:this._defaultCheckboxRender,B=y?Object(N.e)(y,H):H,j=this.state,F=j.isCollapsed,I=j.isLoadingVisible,q=s===m.t.multiple,R=q&&(E||!(t&&t.isCollapsed)),U=p||c,z=Object(l.e)(C);this._classNames=A(O,{theme:C,className:M,selected:U,isCollapsed:F,compact:_});return t?a.createElement("div",{className:this._classNames.root,style:i?{minWidth:i.width}:{},onClick:this._onHeaderClick,role:"row","aria-setsize":P,"aria-posinset":D,"data-is-focusable":!0,onKeyUp:this._onKeyUp,"aria-label":t.ariaLabel,"aria-labelledby":t.ariaLabel?void 0:this._id,"aria-expanded":!this.state.isCollapsed,"aria-selected":q?U:void 0,"aria-level":r+1},a.createElement("div",{className:this._classNames.groupHeaderContainer,role:"presentation"},R?a.createElement("div",{role:"gridcell"},a.createElement("button",Object(u.e)({"data-is-focusable":!1,type:"button",className:this._classNames.check,role:"checkbox","aria-checked":U,"data-selection-toggle":!0,onClick:this._onToggleSelectGroupClick},T),B({checked:U,theme:C},B))):s!==m.t.none&&a.createElement(w.e,{indentWidth:d,count:1}),a.createElement(w.e,{indentWidth:d,count:r}),a.createElement("div",{className:this._classNames.dropIcon,role:"presentation"},a.createElement(k.e,{iconName:"Tag"})),a.createElement("div",{role:"gridcell"},a.createElement("button",Object(u.e)({"data-is-focusable":!1,type:"button",className:this._classNames.expand,onClick:this._onToggleClick,"aria-expanded":!this.state.isCollapsed},S),a.createElement(k.e,{className:this._classNames.expandIsCollapsed,iconName:x||(z?"ChevronLeftMed":"ChevronRightMed")}))),g(this.props,this._onRenderTitle),I&&a.createElement(L.e,{label:o}))):null};t.prototype._defaultCheckboxRender=function(e){return a.createElement(C.e,{checked:e.checked})};t.prototype._fastDefaultCheckboxRender=function(e){return a.createElement(M,{theme:e.theme,checked:e.checked})};t.defaultProps={expandButtonProps:{"aria-label":"expand collapse group"}};return t})(a.Component),M=a.memo(function(e){return a.createElement(C.e,{theme:e.theme,checked:e.checked,className:e.className,useFastIcons:!0})}),_=Object(r.e)(O,function(e){var t,n,r,s,o,u=e.theme,a=e.className,f=e.selected,c=e.isCollapsed,h=e.compact,p=y.e.cellLeftPadding,d=h?40:48,v=u.semanticColors,m=u.palette,N=u.fonts,C=Object(i.x)(E,u),k=[Object(i.S)(u),{cursor:"default",background:"none",backgroundColor:"transparent",border:"none",padding:0}];return{root:[C.root,Object(i.S)(u),u.fonts.medium,{borderBottom:"1px solid "+v.listBackground,cursor:"default",userSelect:"none",selectors:(t={":hover":{background:v.listItemBackgroundHovered,color:v.actionLinkHovered}},t["&:hover ."+C.check]={opacity:1},t["."+g.e+" &:focus ."+C.check]={opacity:1},t[":global(."+C.group+"."+C.isDropping+")"]={selectors:(n={},n["& > ."+C.root+" ."+C.dropIcon]={transition:"transform "+i.n.durationValue4+" "+S+" opacity "+i.n.durationValue1+" "+x,transitionDelay:i.n.durationValue3,opacity:1,transform:"rotate(0.2deg) scale(1);"},n["."+C.check]={opacity:0},n)},t)},f&&[C.isSelected,{background:v.listItemBackgroundChecked,selectors:(r={":hover":{background:v.listItemBackgroundCheckedHovered}},r[""+C.check]={opacity:1},r)}],h&&[C.compact,{border:"none"}],a],groupHeaderContainer:[{display:"flex",alignItems:"center",height:d}],headerCount:[{padding:"0px 4px"}],check:[C.check,k,{display:"flex",alignItems:"center",justifyContent:"center",paddingTop:1,marginTop:-1,opacity:0,width:b.e,height:d,selectors:(s={},s["."+g.e+" &:focus"]={opacity:1},s)}],expand:[C.expand,k,{display:"flex",alignItems:"center",justifyContent:"center",fontSize:N.small.fontSize,width:w.t,height:d,color:f?m.neutralPrimary:m.neutralSecondary,selectors:{":hover":{backgroundColor:f?m.neutralQuaternary:m.neutralLight},":active":{backgroundColor:f?m.neutralTertiaryAlt:m.neutralQuaternaryAlt}}}],expandIsCollapsed:[c?[C.isCollapsed,{transform:"rotate(0deg)",transformOrigin:"50% 50%",transition:"transform .1s linear"}]:{transform:Object(l.e)(u)?"rotate(-90deg)":"rotate(90deg)",transformOrigin:"50% 50%",transition:"transform .1s linear"}],title:[C.title,{paddingLeft:p,fontSize:h?N.medium.fontSize:N.mediumPlus.fontSize,fontWeight:c?i.i.regular:i.i.semibold,cursor:"pointer",outline:0,whiteSpace:"nowrap",textOverflow:"ellipsis"}],dropIcon:[C.dropIcon,{position:"absolute",left:-26,fontSize:i.u.large,color:m.neutralSecondary,transition:"transform "+i.n.durationValue2+" "+T+", opacity "+i.n.durationValue4+" "+x,opacity:0,transform:"rotate(0.2deg) scale(0.65)",transformOrigin:"10px 10px",selectors:(o={},o[":global(."+C.iconTag+")"]={position:"absolute"},o)}]}},void 0,{scope:"GroupHeader"}),D={root:"ms-GroupShowAll",link:"ms-Link"},P=n(1635),H=Object(f.e)(),B=Object(r.e)(function(e){var t=e.group,n=e.groupLevel,r=e.showAllLinkText,i=void 0===r?"Show All":r,s=e.styles,o=e.theme,u=e.onToggleSummarize,f=H(s,{theme:o}),l=Object(a.useCallback)(function(e){u(t);e.stopPropagation();e.preventDefault()},[u,t]);return t?a.createElement("div",{className:f.root},a.createElement(w.e,{count:n}),a.createElement(P.e,{onClick:l},i)):null},function(e){var t,n=e.theme,r=n.fonts,s=Object(i.x)(D,n);return{root:[s.root,{position:"relative",padding:"10px 84px",cursor:"pointer",selectors:(t={},t["."+s.link]={fontSize:r.small.fontSize},t)}]}},void 0,{scope:"GroupShowAll"}),j={root:"ms-groupFooter"},F=Object(f.e)(),I=Object(r.e)(function(e){var t=e.group,n=e.groupLevel,r=e.footerText,i=e.indentWidth,s=e.styles,o=e.theme,u=F(s,{theme:o});return t&&r?a.createElement("div",{className:u.root},a.createElement(w.e,{indentWidth:i,count:n}),r):null},function(e){var t=e.theme,n=e.className,r=Object(i.x)(j,t);return{root:[t.fonts.medium,r.root,{position:"relative",padding:"5px 38px"},n]}},void 0,{scope:"GroupFooter"}),q=n(1919),R=(function(e){Object(u.r)(t,e);function t(n){var r=e.call(this,n)||this;r._root=a.createRef();r._list=a.createRef();r._subGroupRefs={};r._droppingClassName="";r._onRenderGroupHeader=function(e){return a.createElement(_,Object(u.e)({},e))};r._onRenderGroupShowAll=function(e){return a.createElement(B,Object(u.e)({},e))};r._onRenderGroupFooter=function(e){return a.createElement(I,Object(u.e)({},e))};r._renderSubGroup=function(e,n){var i=r.props,s=i.dragDropEvents,o=i.dragDropHelper,u=i.eventsToRegister,f=i.getGroupItemLimit,l=i.groupNestingDepth,c=i.groupProps,h=i.items,p=i.headerProps,d=i.showAllProps,v=i.footerProps,m=i.listProps,g=i.onRenderCell,y=i.selection,b=i.selectionMode,w=i.viewport,E=i.onRenderGroupHeader,S=i.onRenderGroupShowAll,x=i.onRenderGroupFooter,T=i.onShouldVirtualize,N=i.group,C=i.compact,k=e.level?e.level+1:l;return!e||e.count>0||c&&c.showEmptyGroups?a.createElement(t,{ref:function(e){return r._subGroupRefs["subGroup_"+n]=e},key:r._getGroupKey(e,n),dragDropEvents:s,dragDropHelper:o,eventsToRegister:u,footerProps:v,getGroupItemLimit:f,group:e,groupIndex:n,groupNestingDepth:k,groupProps:c,headerProps:p,items:h,listProps:m,onRenderCell:g,selection:y,selectionMode:b,showAllProps:d,viewport:w,onRenderGroupHeader:E,onRenderGroupShowAll:S,onRenderGroupFooter:x,onShouldVirtualize:T,groups:N?N.children:[],compact:C}):null};r._getGroupDragDropOptions=function(){var e=r.props,t=e.group,n=e.groupIndex,i=e.dragDropEvents;return{eventMap:e.eventsToRegister,selectionIndex:-1,context:{data:t,index:n,isGroup:!0},updateDropState:r._updateDroppingState,canDrag:i.canDrag,canDrop:i.canDrop,onDrop:i.onDrop,onDragStart:i.onDragStart,onDragEnter:i.onDragEnter,onDragLeave:i.onDragLeave,onDragEnd:i.onDragEnd,onDragOver:i.onDragOver}};r._updateDroppingState=function(e,t){var n=r.state.isDropping,i=r.props,s=i.dragDropEvents,o=i.group;if(n!==e){n?s&&s.onDragLeave&&s.onDragLeave(o,t):s&&s.onDragEnter&&(r._droppingClassName=s.onDragEnter(o,t));r.setState({isDropping:e})}};var i=n.selection,s=n.group;Object(h.e)(r);r._id=Object(d.e)("GroupedListSection");r.state={isDropping:!1,isSelected:!(!i||!s)&&i.isRangeSelected(s.startIndex,s.count)};r._events=new v.e(r);return r}t.prototype.componentDidMount=function(){var e=this.props,t=e.dragDropHelper,n=e.selection;t&&this._root.current&&(this._dragDropSubscription=t.subscribe(this._root.current,this._events,this._getGroupDragDropOptions()));n&&this._events.on(n,m.e,this._onSelectionChange)};t.prototype.componentWillUnmount=function(){this._events.dispose();this._dragDropSubscription&&this._dragDropSubscription.dispose()};t.prototype.componentDidUpdate=function(e){if(this.props.group!==e.group||this.props.groupIndex!==e.groupIndex||this.props.dragDropHelper!==e.dragDropHelper){if(this._dragDropSubscription){this._dragDropSubscription.dispose();delete this._dragDropSubscription}this.props.dragDropHelper&&this._root.current&&(this._dragDropSubscription=this.props.dragDropHelper.subscribe(this._root.current,this._events,this._getGroupDragDropOptions()))}};t.prototype.render=function(){var e=this.props,t=e.getGroupItemLimit,n=e.group,r=e.groupIndex,i=e.headerProps,s=e.showAllProps,o=e.footerProps,f=e.viewport,l=e.selectionMode,c=e.onRenderGroupHeader,h=void 0===c?this._onRenderGroupHeader:c,d=e.onRenderGroupShowAll,v=void 0===d?this._onRenderGroupShowAll:d,m=e.onRenderGroupFooter,g=void 0===m?this._onRenderGroupFooter:m,y=e.onShouldVirtualize,b=e.groupedListClassNames,w=e.groups,E=e.compact,S=e.listProps,x=void 0===S?{}:S,T=this.state.isSelected,N=n&&t?t(n):1/0,C=n&&!n.children&&!n.isCollapsed&&!n.isShowingAll&&(n.count>N||n.hasMoreData),k=n&&n.children&&n.children.length>0,L=x.version,A={group:n,groupIndex:r,groupLevel:n?n.level:0,isSelected:T,selected:T,viewport:f,selectionMode:l,groups:w,compact:E},O={groupedListId:this._id,ariaSetSize:w?w.length:void 0,ariaPosInSet:void 0!==r?r+1:void 0},M=Object(u.e)(Object(u.e)(Object(u.e)({},i),A),O),_=Object(u.e)(Object(u.e)({},s),A),D=Object(u.e)(Object(u.e)({},o),A),P=!!this.props.dragDropHelper&&this._getGroupDragDropOptions().canDrag(n)&&!!this.props.dragDropEvents.canDragGroups;return a.createElement("div",Object(u.e)({ref:this._root},P&&{draggable:!0},{className:Object(p.e)(b&&b.group,this._getDroppingClassName()),role:"presentation"}),h(M,this._onRenderGroupHeader),n&&n.isCollapsed?null:k?a.createElement(q.e,{role:"presentation",ref:this._list,items:n?n.children:[],onRenderCell:this._renderSubGroup,getItemCountForPage:this._returnOne,onShouldVirtualize:y,version:L,id:this._id}):this._onRenderGroup(N),n&&n.isCollapsed?null:C&&v(_,this._onRenderGroupShowAll),g(D,this._onRenderGroupFooter))};t.prototype.forceUpdate=function(){e.prototype.forceUpdate.call(this);this.forceListUpdate()};t.prototype.forceListUpdate=function(){var e=this.props.group;if(this._list.current){this._list.current.forceUpdate();if(e&&e.children&&e.children.length>0)for(var t=e.children.length,n=0;n<t;n++){(r=this._list.current.pageRefs["subGroup_"+String(n)])&&r.forceListUpdate()}}else{var r;(r=this._subGroupRefs["subGroup_"+String(0)])&&r.forceListUpdate()}};t.prototype._onSelectionChange=function(){var e=this.props,t=e.group,n=e.selection;if(n&&t){var r=n.isRangeSelected(t.startIndex,t.count);r!==this.state.isSelected&&this.setState({isSelected:r})}};t.prototype._onRenderGroupCell=function(e,t){return function(n,r){return e(t,n,r)}};t.prototype._onRenderGroup=function(e){var t,n=this.props,r=n.group,i=n.items,s=n.onRenderCell,o=n.listProps,f=n.groupNestingDepth,l=n.onShouldVirtualize,c=n.groupProps,h=r&&!r.isShowingAll?r.count:i.length,p=r?r.startIndex:0;return a.createElement(q.e,Object(u.e)({role:c&&c.role?c.role:"rowgroup","aria-label":null===(t=r)||void 0===t?void 0:t.name,items:i,onRenderCell:this._onRenderGroupCell(s,f),ref:this._list,renderCount:Math.min(h,e),startIndex:p,onShouldVirtualize:l,id:this._id},o))};t.prototype._returnOne=function(){return 1};t.prototype._getGroupKey=function(e,t){return"group-"+(e&&e.key?e.key:String(e.level)+String(t))};t.prototype._getDroppingClassName=function(){var e=this.state.isDropping,t=this.props,n=t.group,r=t.groupedListClassNames;e=!(!n||!e);return Object(p.e)(e&&this._droppingClassName,e&&"is-dropping",e&&r&&r.groupIsDropping)};return t})(a.Component),U=n(1648),z=n(287),W=Object(f.e)(),X=y.t.rowHeight,V=y.t.compactRowHeight,$=(function(e){Object(u.r)(t,e);function t(t){var n=e.call(this,t)||this;n._list=a.createRef();n._renderGroup=function(e,t){var r=n.props,i=r.dragDropEvents,s=r.dragDropHelper,o=r.eventsToRegister,f=r.groupProps,l=r.items,c=r.listProps,h=r.onRenderCell,p=r.selectionMode,d=r.selection,v=r.viewport,m=r.onShouldVirtualize,g=r.groups,y=r.compact,b={onToggleSelectGroup:n._onToggleSelectGroup,onToggleCollapse:n._onToggleCollapse,onToggleSummarize:n._onToggleSummarize},w=Object(u.e)(Object(u.e)({},f.headerProps),b),E=Object(u.e)(Object(u.e)({},f.showAllProps),b),S=Object(u.e)(Object(u.e)({},f.footerProps),b),x=n._getGroupNestingDepth();if(!f.showEmptyGroups&&e&&0===e.count)return null;var T=Object(u.e)(Object(u.e)({},c||{}),{version:n.state.version});return a.createElement(R,{key:n._getGroupKey(e,t),dragDropEvents:i,dragDropHelper:s,eventsToRegister:o,footerProps:S,getGroupItemLimit:f&&f.getGroupItemLimit,group:e,groupIndex:t,groupNestingDepth:x,groupProps:f,headerProps:w,listProps:T,items:l,onRenderCell:h,onRenderGroupHeader:f.onRenderHeader,onRenderGroupShowAll:f.onRenderShowAll,onRenderGroupFooter:f.onRenderFooter,selectionMode:p,selection:d,showAllProps:E,viewport:v,onShouldVirtualize:m,groupedListClassNames:n._classNames,groups:g,compact:y})};n._getDefaultGroupItemLimit=function(e){return e.count};n._getGroupItemLimit=function(e){var t=n.props.groupProps;return(t&&t.getGroupItemLimit?t.getGroupItemLimit:n._getDefaultGroupItemLimit)(e)};n._getGroupHeight=function(e){var t=n.props.compact?V:X;return t+(e.isCollapsed?0:t*n._getGroupItemLimit(e))};n._getPageHeight=function(e){var t=n.state.groups,r=n.props.getGroupHeight,i=void 0===r?n._getGroupHeight:r,s=t&&t[e];return s?i(s,e):0};n._onToggleCollapse=function(e){var t=n.props.groupProps,r=t&&t.headerProps&&t.headerProps.onToggleCollapse;if(e){r&&r(e);e.isCollapsed=!e.isCollapsed;n._updateIsSomeGroupExpanded();n.forceUpdate()}};n._onToggleSelectGroup=function(e){var t=n.props,r=t.selection,i=t.selectionMode;e&&r&&i===m.t.multiple&&r.toggleRangeSelected(e.startIndex,e.count)};n._isInnerZoneKeystroke=function(e){return e.which===Object(l.t)(c.e.right)};n._onToggleSummarize=function(e){var t=n.props.groupProps,r=t&&t.showAllProps&&t.showAllProps.onToggleSummarize;if(r)r(e);else{e&&(e.isShowingAll=!e.isShowingAll);n.forceUpdate()}};n._getPageSpecification=function(e){var t=n.state.groups,r=t&&t[e];return{key:r&&r.key}};Object(h.e)(n);n._isSomeGroupExpanded=n._computeIsSomeGroupExpanded(t.groups);var r=t.listProps,i=(void 0===r?{}:r).version,s=void 0===i?{}:i;n.state={groups:t.groups,items:t.items,listProps:t.listProps,version:s};return n}t.getDerivedStateFromProps=function(e,t){var n=e.groups,r=e.selectionMode,i=e.compact,s=e.items,o=e.listProps,a=o&&o.version,f=Object(u.e)(Object(u.e)({},t),{selectionMode:r,compact:i,groups:n,listProps:o}),l=!1;a===(t.listProps&&t.listProps.version)&&s===t.items&&n===t.groups&&r===t.selectionMode&&i===t.compact||(l=!0);l&&(f=Object(u.e)(Object(u.e)({},f),{version:{}}));return f};t.prototype.scrollToIndex=function(e,t,n){this._list.current&&this._list.current.scrollToIndex(e,t,n)};t.prototype.getStartItemIndexInView=function(){return this._list.current.getStartItemIndexInView()||0};t.prototype.componentDidMount=function(){var e=this.props,t=e.groupProps,n=e.groups,r=void 0===n?[]:n;t&&t.isAllGroupsCollapsed&&this._setGroupsCollapsedState(r,t.isAllGroupsCollapsed)};t.prototype.render=function(){var e=this.props,t=e.className,n=e.usePageCache,r=e.onShouldVirtualize,i=e.theme,s=e.role,o=void 0===s?"treegrid":s,f=e.styles,l=e.compact,c=e.focusZoneProps,h=void 0===c?{}:c,d=e.rootListProps,v=void 0===d?{}:d,m=this.state,g=m.groups,y=m.version;this._classNames=W(f,{theme:i,className:t,compact:l});var b=h.shouldEnterInnerZone,w=void 0===b?this._isInnerZoneKeystroke:b;return a.createElement(U.e,Object(u.e)({direction:z.e.vertical,"data-automationid":"GroupedList","data-is-scrollable":"false",role:"presentation"},h,{shouldEnterInnerZone:w,className:Object(p.e)(this._classNames.root,h.className)}),g?a.createElement(q.e,Object(u.e)({ref:this._list,role:o,items:g,onRenderCell:this._renderGroup,getItemCountForPage:this._returnOne,getPageHeight:this._getPageHeight,getPageSpecification:this._getPageSpecification,usePageCache:n,onShouldVirtualize:r,version:y},v)):this._renderGroup(void 0,0))};t.prototype.forceUpdate=function(){e.prototype.forceUpdate.call(this);this._forceListUpdates()};t.prototype.toggleCollapseAll=function(e){var t=this.state.groups,n=void 0===t?[]:t,r=this.props.groupProps,i=r&&r.onToggleCollapseAll;if(n.length>0){i&&i(e);this._setGroupsCollapsedState(n,e);this._updateIsSomeGroupExpanded();this.forceUpdate()}};t.prototype._setGroupsCollapsedState=function(e,t){for(var n=0;n<e.length;n++)e[n].isCollapsed=t};t.prototype._returnOne=function(){return 1};t.prototype._getGroupKey=function(e,t){return"group-"+(e&&e.key?e.key:String(t))};t.prototype._getGroupNestingDepth=function(){for(var e=0,t=this.state.groups;t&&t.length>0;){e++;t=t[0].children}return e};t.prototype._forceListUpdates=function(e){this.setState({version:{}})};t.prototype._computeIsSomeGroupExpanded=function(e){var t=this;return!(!e||!e.some(function(e){return e.children?t._computeIsSomeGroupExpanded(e.children):!e.isCollapsed}))};t.prototype._updateIsSomeGroupExpanded=function(){var e=this.state.groups,t=this.props.onGroupExpandStateChanged,n=this._computeIsSomeGroupExpanded(e);if(this._isSomeGroupExpanded!==n){t&&t(n);this._isSomeGroupExpanded=n}};t.defaultProps={selectionMode:m.t.multiple,isHeaderVisible:!0,groupProps:{},compact:!1};return t})(a.Component),J=Object(r.e)($,function(e){var t,n,r=e.theme,u=e.className,a=e.compact,f=r.palette,l=Object(i.x)(s,r);return{root:[l.root,r.fonts.small,{position:"relative",selectors:(t={},t["."+l.listCell]={minHeight:38},t)},a&&[l.compact,{selectors:(n={},n["."+l.listCell]={minHeight:32},n)}],u],group:[l.group,{transition:"background-color "+i.n.durationValue2+" "+o}],groupIsDropping:{backgroundColor:f.neutralLight}}},void 0,{scope:"GroupedList"})},,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return s});var r;(function(e){e[e.unknown=1]="unknown";e[e.odb=2]="odb";e[e.sharePoint=3]="sharePoint";e[e.ngsc=4]="ngsc";e[e.word=5]="word";e[e.powerpoint=6]="powerpoint";e[e.excel=7]="excel";e[e.onenoteWeb=8]="onenoteWeb";e[e.wac=9]="wac";e[e.visio=10]="visio";e[e.officecom=11]="officecom";e[e.listPart=12]="listPart";e[e.outlookWeb=13]="outlookWeb";e[e.odIos=14]="odIos";e[e.odAndroid=15]="odAndroid";e[e.teams=16]="teams";e[e.sample=17]="sample";e[e.odc=18]="odc";e[e.wordAndroid=19]="wordAndroid";e[e.excelAndroid=20]="excelAndroid";e[e.powerpointAndroid=21]="powerpointAndroid";e[e.wordIos=22]="wordIos";e[e.excelIos=23]="excelIos";e[e.powerpointIos=24]="powerpointIos";e[e.onenote=25]="onenote";e[e.teamsIos=26]="teamsIos";e[e.teamsAndroid=27]="teamsAndroid";e[e.onenoteIos=28]="onenoteIos";e[e.visioIos=29]="visioIos";e[e.onenoteAndroid=30]="onenoteAndroid";e[e.visioAndroid=31]="visioAndroid";e[e.outlookWindows=32]="outlookWindows";e[e.outlookMac=33]="outlookMac";e[e.onenoteUWP=34]="onenoteUWP";e[e.officemobileIos=35]="officemobileIos";e[e.officemobileAndroid=36]="officemobileAndroid";e[e.odcWac=37]="odcWac";e[e.outlookGroupsWeb=38]="outlookGroupsWeb";e[e.fluid=39]="fluid";e[e.modernFileExplorer=40]="modernFileExplorer";e[e.listsHome=41]="listsHome";e[e.listsIos=42]="listsIos";e[e.edgeEnterpriseNtp=43]="edgeEnterpriseNtp";e[e.officeFeed=44]="officeFeed";e[e.searchUx=45]="searchUx";e[e.consumerList=46]="consumerList";e[e.shareDemo=47]="shareDemo";e[e.onePlayer=48]="onePlayer"})(r||(r={}));var i=void 0;function s(e){if(void 0===i){i={};for(var t in r){var n=parseInt(t);if(!isNaN(n)){var s=r[n].toLowerCase();i[s]=n}}}var o=e?e.toLowerCase():"";return i[o]||r.unknown}t.e=r},function(e,t,n){(function(t,n){r=function(){"use strict";function e(e){return"function"==typeof e}var r=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},i=0,s=void 0,o=void 0,u=function(e,t){d[i]=e;d[i+1]=t;2===(i+=2)&&(o?o(v):m())},a="undefined"!=typeof window?window:void 0,f=a||{},l=f.MutationObserver||f.WebKitMutationObserver,c="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),h="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function p(){var e=setTimeout;return function(){return e(v,1)}}var d=new Array(1e3);function v(){for(var e=0;e<i;e+=2){(0,d[e])(d[e+1]);d[e]=void 0;d[e+1]=void 0}i=0}var m=void 0;m=c?function(){return t.nextTick(v)}:l?(function(){var e=0,t=new l(v),n=document.createTextNode("");t.observe(n,{characterData:!0});return function(){n.data=e=++e%2}})():h?(function(){var e=new MessageChannel;e.port1.onmessage=v;return function(){return e.port2.postMessage(0)}})():void 0===a?(function(){try{var e=Function("return this")().require("vertx");return void 0!==(s=e.runOnLoop||e.runOnContext)?function(){s(v)}:p()}catch(e){return p()}})():p();function g(e,t){var n=this,r=new this.constructor(w);void 0===r[b]&&_(r);var i=n._state;if(i){var s=arguments[i-1];u(function(){return O(i,r,s,n._result)})}else L(n,r,e,t);return r}function y(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(w);T(t,e);return t}var b=Math.random().toString(36).substring(2);function w(){}var E={error:null};function S(e){try{return e.then}catch(e){E.error=e;return E}}function x(t,n,r){if(n.constructor===t.constructor&&r===g&&n.constructor.resolve===y)(function(e,t){1===t._state?C(e,t._result):2===t._state?k(e,t._result):L(t,void 0,function(t){return T(e,t)},function(t){return k(e,t)})})(t,n);else if(r===E){k(t,E.error);E.error=null}else void 0===r?C(t,n):e(r)?(function(e,t,n){u(function(e){var r=!1,i=(function(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}})(n,t,function(n){if(!r){r=!0;t!==n?T(e,n):C(e,n)}},function(t){if(!r){r=!0;k(e,t)}},e._label);if(!r&&i){r=!0;k(e,i)}},e)})(t,n,r):C(t,n)}function T(e,t){e===t?k(e,new TypeError("You cannot resolve a promise with itself")):(r=typeof(n=t),null===n||"object"!==r&&"function"!==r?C(e,t):x(e,t,S(t)));var n,r}function N(e){e._onerror&&e._onerror(e._result);A(e)}function C(e,t){if(void 0===e._state){e._result=t;e._state=1;0!==e._subscribers.length&&u(A,e)}}function k(e,t){if(void 0===e._state){e._state=2;e._result=t;u(N,e)}}function L(e,t,n,r){var i=e._subscribers,s=i.length;e._onerror=null;i[s]=t;i[s+1]=n;i[s+2]=r;0===s&&e._state&&u(A,e)}function A(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,i=void 0,s=e._result,o=0;o<t.length;o+=3){r=t[o];i=t[o+n];r?O(n,r,i,s):i(s)}e._subscribers.length=0}}function O(t,n,r,i){var s=e(r),o=void 0,u=void 0,a=void 0,f=void 0;if(s){if((o=(function(e,t){try{return e(t)}catch(e){E.error=e;return E}})(r,i))===E){f=!0;u=o.error;o.error=null}else a=!0;if(n===o){k(n,new TypeError("A promises callback cannot return that same promise."));return}}else{o=i;a=!0}void 0!==n._state||(s&&a?T(n,o):f?k(n,u):1===t?C(n,o):2===t&&k(n,o))}var M=0;function _(e){e[b]=M++;e._state=void 0;e._result=void 0;e._subscribers=[]}var D=(function(){function e(e,t){this._instanceConstructor=e;this.promise=new e(w);this.promise[b]||_(this.promise);if(r(t)){this.length=t.length;this._remaining=t.length;this._result=new Array(this.length);if(0===this.length)C(this.promise,this._result);else{this.length=this.length||0;this._enumerate(t);0===this._remaining&&C(this.promise,this._result)}}else k(this.promise,new Error("Array Methods must be provided an Array"))}e.prototype._enumerate=function(e){for(var t=0;void 0===this._state&&t<e.length;t++)this._eachEntry(e[t],t)};e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===y){var i=S(e);if(i===g&&void 0!==e._state)this._settledAt(e._state,t,e._result);else if("function"!=typeof i){this._remaining--;this._result[t]=e}else if(n===P){var s=new n(w);x(s,e,i);this._willSettleAt(s,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)};e.prototype._settledAt=function(e,t,n){var r=this.promise;if(void 0===r._state){this._remaining--;2===e?k(r,n):this._result[t]=n}0===this._remaining&&C(r,this._result)};e.prototype._willSettleAt=function(e,t){var n=this;L(e,void 0,function(e){return n._settledAt(1,t,e)},function(e){return n._settledAt(2,t,e)})};return e})(),P=(function(){function e(t){this[b]=M++;this._result=this._state=void 0;this._subscribers=[];if(w!==t){"function"!=typeof t&&(function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")})();this instanceof e?(function(e,t){try{t(function(t){T(e,t)},function(t){k(e,t)})}catch(t){k(e,t)}})(this,t):(function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")})()}}e.prototype.catch=function(e){return this.then(null,e)};e.prototype.finally=function(e){var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){throw n})})};return e})();P.prototype.then=g;P.all=function(e){return new D(this,e).promise};P.race=function(e){var t=this;return r(e)?new t(function(n,r){for(var i=e.length,s=0;s<i;s++)t.resolve(e[s]).then(n,r)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})};P.resolve=y;P.reject=function(e){var t=new this(w);k(t,e);return t};P._setScheduler=function(e){o=e};P._setAsap=function(e){u=e};P._asap=u;P.polyfill=function(){var e=void 0;if(void 0!==n)e=n;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=P};P.Promise=P;return P},e.exports=r();var r}).call(this,n(1989),n(719))},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return y});var r=n(1419),i=n(4),s=n("react-lib"),o=n(472),u=n(886),a=n(1379),f=n(1377),l=n(653),c=n(270),h=n(1483),p=n(1845),d=n(1633),v=Object(o.e)(),m=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;n._toggleButton=s.createRef();n._onClick=function(e){var t=n.props,r=t.disabled,i=t.checked,s=t.onChange,o=t.onChanged,u=t.onClick,a=n.state.checked;if(!r){void 0===i&&n.setState({checked:!a});s&&s(e,!a);o&&o(!a);u&&u(e)}};Object(u.e)(n);Object(a.e)("Toggle",t,{checked:"defaultChecked"});Object(f.e)("Toggle",t,{onAriaLabel:"ariaLabel",offAriaLabel:void 0,onChanged:"onChange"});n.state={checked:!(!t.checked&&!t.defaultChecked)};n._id=Object(l.e)("Toggle");return n}t.getDerivedStateFromProps=function(e,t){return void 0===e.checked?null:{checked:!!e.checked}};Object.defineProperty(t.prototype,"checked",{get:function(){return this.state.checked},enumerable:!0,configurable:!0});t.prototype.render=function(){var e=this,t=this.props,n=t.as,r=void 0===n?"div":n,o=t.className,u=t.theme,a=t.disabled,f=t.keytipProps,l=t.id,m=t.label,g=t.ariaLabel,y=t.onAriaLabel,b=t.offAriaLabel,w=t.offText,E=t.onText,S=t.styles,x=t.inlineLabel,T=this.state.checked,N=T?E:w,C=T?y:b,k=Object(c.u)(this.props,c.h,["defaultChecked"]),L=v(S,{theme:u,className:o,disabled:a,checked:T,inlineLabel:x,onOffMissing:!E&&!w}),A=l||this._id,O=A+"-label",M=A+"-stateText",_=void 0;if(!g&&!C){m&&(_=O);N&&(_=_?_+" "+M:M)}var D=this.props.role?this.props.role:"switch",P=function(t){void 0===t&&(t={});return s.createElement("button",Object(i.e)({},k,t,{className:L.pill,disabled:a,id:A,type:"button",role:D,ref:e._toggleButton,"aria-disabled":a,"aria-checked":T,"aria-label":g||C,"data-is-focusable":!0,onChange:e._noop,onClick:e._onClick,"aria-labelledby":_}),s.createElement("span",{className:L.thumb}))},H=f?s.createElement(d.e,{keytipProps:f,ariaDescribedBy:k["aria-describedby"],disabled:a},function(e){return P(e)}):P();return s.createElement(r,{className:L.root,hidden:k.hidden},m&&s.createElement(p.e,{htmlFor:A,className:L.label,id:O},m),s.createElement("div",{className:L.container},H,N&&s.createElement(p.e,{htmlFor:A,className:L.text,id:M},N)),s.createElement(h.e,null))};t.prototype.focus=function(){this._toggleButton.current&&this._toggleButton.current.focus()};t.prototype._noop=function(){};return t})(s.Component),g=n(25),y=Object(r.e)(m,function(e){var t,n,r,s,o,u,a,f=e.theme,l=e.className,c=e.disabled,h=e.checked,p=e.inlineLabel,d=e.onOffMissing,v=f.semanticColors,m=f.palette,y=v.bodyBackground,b=v.inputBackgroundChecked,w=v.inputBackgroundCheckedHovered,E=m.neutralDark,S=v.disabledBodySubtext,x=v.smallInputBorder,T=v.inputForegroundChecked,N=v.disabledBodySubtext,C=v.disabledBackground,k=v.smallInputBorder,L=v.inputBorderHovered,A=v.disabledBodySubtext,O=v.disabledText;return{root:["ms-Toggle",h&&"is-checked",!c&&"is-enabled",c&&"is-disabled",f.fonts.medium,{marginBottom:"8px"},p&&{display:"flex",alignItems:"center"},l],label:["ms-Toggle-label",{display:"inline-block"},c&&{color:O,selectors:(t={},t[g.s]={color:"GrayText"},t)},p&&!d&&{marginRight:16},d&&p&&{order:1,marginLeft:16},p&&{wordBreak:"break-all"}],container:["ms-Toggle-innerContainer",{display:"flex",position:"relative"}],pill:["ms-Toggle-background",Object(g.S)(f,{inset:-3}),{fontSize:"20px",boxSizing:"border-box",width:40,height:20,borderRadius:10,transition:"all 0.1s ease",border:"1px solid "+k,background:y,cursor:"pointer",display:"flex",alignItems:"center",padding:"0 3px"},!c&&[!h&&{selectors:{":hover":[{borderColor:L}],":hover .ms-Toggle-thumb":[{backgroundColor:E,selectors:(n={},n[g.s]={borderColor:"Highlight"},n)}]}},h&&[{background:b,borderColor:"transparent",justifyContent:"flex-end"},{selectors:(r={":hover":[{backgroundColor:w,borderColor:"transparent",selectors:(s={},s[g.s]={backgroundColor:"Highlight"},s)}]},r[g.s]=Object(i.e)({backgroundColor:"Highlight"},Object(g.T)()),r)}]],c&&[{cursor:"default"},!h&&[{borderColor:A}],h&&[{backgroundColor:S,borderColor:"transparent",justifyContent:"flex-end"}]],!c&&{selectors:{"&:hover":{selectors:(o={},o[g.s]={borderColor:"Highlight"},o)}}}],thumb:["ms-Toggle-thumb",{display:"block",width:12,height:12,borderRadius:"50%",transition:"all 0.1s ease",backgroundColor:x,borderColor:"transparent",borderWidth:6,borderStyle:"solid",boxSizing:"border-box"},!c&&h&&[{backgroundColor:T,selectors:(u={},u[g.s]={backgroundColor:"Window",borderColor:"Window"},u)}],c&&[!h&&[{backgroundColor:N}],h&&[{backgroundColor:C}]]],text:["ms-Toggle-stateText",{selectors:{"&&":{padding:"0",margin:"0 8px",userSelect:"none",fontWeight:g.i.regular}}},c&&{selectors:{"&&":{color:O,selectors:(a={},a[g.s]={color:"GrayText"},a)}}}]}},void 0,{scope:"Toggle"})},function(e,t,n){"use strict";n.d(t,"e",function(){return h});var r=n(1419),i=n(4),s=n("react-lib"),o=n(472),u=n(270),a=n(1487),f=Object(o.e)(),l=(function(e){Object(i.r)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.message,n=e.styles,r=e.as,o=void 0===r?"div":r,l=e.className,c=f(n,{className:l});return s.createElement(o,Object(i.e)({role:"status",className:c.root},Object(u.u)(this.props,u.s,["className"])),s.createElement(a.e,null,s.createElement("div",{className:c.screenReaderText},t)))};t.defaultProps={"aria-live":"polite"};return t})(s.Component),c=n(25),h=Object(r.e)(l,function(e){return{root:e.className,screenReaderText:c.M}})},,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(49),i=n(11),s=n(1741),o=n(1784),u=Object(i.s)("SubstratePeoplePickerHelper",s.t,{oAuthTokenProvider:o.e,pageContext:r.h,sharingContextInformation:r.p.optional})},function(e,t,n){"use strict";n.d(t,"t",function(){return a});n.d(t,"e",function(){return f});var r=n(0),i=n(896),s=n(48);n.d(t,"n",function(){return s.e});var o=n(333),u=n(1028),a=Object(i.e)({eventName:"CustomerPromise,",shortEventName:"CustomerPromise",requiresParent:!1},{scenario:{isKey:!0,isPrefixingDisabled:!0,type:1},errorCode:{isPrefixingDisabled:!0,type:1},resultType:{typeRef:s.e,isPrefixingDisabled:!0,type:6},resultCategory:{isPrefixingDisabled:!0,type:1},extraData:4,httpStatus:{isPrefixingDisabled:!0,type:2},perfGoalInMs:{isPrefixingDisabled:!0,type:2},duration:{isPrefixingDisabled:!0,type:2}}),f=(function(e){Object(r.__extends)(t,e);function t(t){var n,r,i=e.call(this,t)||this;(null===(n=t)||void 0===n?void 0:n.perfGoalInMs)&&i.setTimeout(null===(r=t)||void 0===r?void 0:r.perfGoalInMs,{resultType:s.e.Failure,errorCode:"Missing Perf Goal"});return i}t.prototype.end=function(t){t&&t.extraData&&this.data.extraData&&(t=Object(r.__assign)(Object(r.__assign)({},t),{extraData:Object(r.__assign)(Object(r.__assign)({},this.data.extraData),t.extraData)}));t&&(t=this._assessPerf(t));return e.prototype.end.call(this,t)};t.prototype._assessPerf=function(e){if(!this.endTime){var t=e.perfGoalInMs||this.data.perfGoalInMs;if(t&&e.resultType!==s.e.Failure){t<o.e.getTime()-this.startTime&&(e=Object(r.__assign)(Object(r.__assign)({},e),{resultType:s.e.Failure,errorCode:"Missing Perf Goal",extraData:e.errorCode?Object(r.__assign)(Object(r.__assign)({},e.extraData),{innerErrorCode:e.errorCode}):void 0}))}}return e};return t})(a).withManager(Object(u.e)())},,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(0),i=n("react-lib"),s=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.state={hasError:!1};return n}t.getDerivedStateFromError=function(e){return{hasError:!0}};t.prototype.render=function(){return this.state.hasError?null:i.createElement(i.Fragment,null,this.props.children)};t.prototype.componentDidCatch=function(e,t){this.props.onError&&this.props.onError(e,t)};return t})(i.PureComponent)},function(e,t,n){"use strict";var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.shouldStartExpanded,i=void 0===r||r;n._shouldStartExpanded=i;n.showArrow=!1;n.isExpanded=n._getIsExpanded();return n}t.prototype._getIsExpanded=function(){var e=this,t=this.createObservable(this._shouldStartExpanded);return this.createComputed({read:function(){return!e.showArrow||t()},write:function(n){e.showArrow&&t(n)},pure:!0})};return t})(n(1649).n);t.e=i},function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});n.d(t,"n",function(){return u});n.d(t,"r",function(){return a});var r=n(2381),i=n(22);function s(){return r.g}function o(e){return i.format(r.u,"'"+e+"'")}function u(e,t){var n=r.o,i=a(e,4),s=a(e,2),o=a(e,1);i?n=r.f:s?n=r.o:o&&(n=r.a);t&&(n=n+' <a href=";" data-bind="click: '+t+'">'+r.g+"</a>");return n}function a(e,t){return e&&(e&t)===t}},,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(0);function i(e){if(e){var t=e.fieldSchema,n=e.children,s=Object(r.__rest)(e,["fieldSchema","children"]);return Object(r.__assign)({fieldSchema:t?Object(r.__assign)(Object(r.__assign)({},t),{Name:t.Name}):void 0,children:n?n.map(i):void 0},s)}}},,,,,function(e,t,n){"use strict";var r=n(138);Object(r.n)([{rawString:".od-ItemActivity-item{max-width:100%}.od-ItemActivity-item-nameText{font-weight:600;color:"},{theme:"bodyText",defaultValue:"#323130"},{rawString:"}@media (forced-colors: active){.od-ItemActivity-item-nameText.lpc-hoverTarget{color:ButtonText}}.od-ItemActivity-item-linkText{font-weight:600;text-decoration:none}.od-ItemActivity-item-clickableLinkText{max-width:100%;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";cursor:pointer;font-family:inherit;font-size:12px}.od-ItemActivity-otherActors{list-style-type:none;margin:0;padding:0}.od-ItemActivity-n-Others{font-weight:600}.od-ItemActivity-item-textContent{overflow:hidden;text-overflow:ellipsis;display:inline-block;max-width:100%;vertical-align:middle}.od-ItemActivity-item .ms-ActivityItem-activityContent{width:calc(100% - 70px)}.od-ItemActivity-timeStamp{display:inline-block;vertical-align:middle}html[dir='ltr'] .od-ItemActivity-timeStamp{padding-left:0}html[dir='rtl'] .od-ItemActivity-timeStamp{padding-right:0}.od-ItemActivity-timeStamp:before{content:'\\00a0\\2219\\00a0'}.od-ItemActivity-persona{position:relative;width:100%;height:100%;font-weight:400;margin-top:-5px}@media screen and (-ms-high-contrast: active){.od-ItemActivity-persona{margin-top:0px}}.od-ItemActivity-personaIcon{position:absolute;top:0px;left:0px;width:100%;height:100%;border-radius:50%}.activitycard-deeplink-animate{animation:deeplinkHighlight 5s 1 cubic-bezier(0.8, 0, 0.5, 1);-webkit-animation:deeplinkHighlight 5s 1 cubic-bezier(0.8, 0, 0.5, 1)}.activitycard-deeplink-animate .od-ItemActivityList-activity{animation:deeplinkInnerHighlight 5s 1 cubic-bezier(0.8, 0, 0.5, 1);-webkit-animation:deeplinkInnerHighlight 5s 1 cubic-bezier(0.8, 0, 0.5, 1)}@keyframes deeplinkHighlight{0%{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";-webkit-box-shadow:0px 0px 0px 2px "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-shadow:0px 0px 0px 2px "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}50%{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";-webkit-box-shadow:0px 0px 0px 2px "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-shadow:0px 0px 0px 2px "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}}@-webkit-keyframes deeplinkHighlight{0%{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";-webkit-box-shadow:0px 0px 0px 2px "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-shadow:0px 0px 0px 2px "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}50%{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";-webkit-box-shadow:0px 0px 0px 2px "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-shadow:0px 0px 0px 2px "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}}@keyframes deeplinkInnerHighlight{0%{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:"}50%{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:"}}@-webkit-keyframes deeplinkInnerHighlight{0%{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:"}50%{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:"}}\n"}])},,,,,,,,function(e,t,n){"use strict";n(1862);var r=n(1652),i=n(0),s=n(1651),o=n(1706),u=n(1703),a=n(1678),f=n(1677),l=n(1668),c=n(1715),h=n(1742),p=n(1718),d=n(1660),v=n(1659),m=n(2001),g=n(1006),y={},b=(function(e){Object(i.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.overlayTagName=o.e.tagName;n.closePanelLabel=m.e;n.addBindingHandlers({dismiss:u.e,element:d.e,host:a.e,interactionScope:f.t,focusTrap:c.e,recoverFocus:p.e,preserveFocus:h.e,scrollContainer:l.e});var r=t.size,i=void 0===r?"Small":r,s=t.title,v=void 0===s?"":s,b=t.onClose,w=t.ariaLabel,E=void 0===w?"":w,S=t.showCloseButton,x=void 0===S||S,T=t.isOpen,N=t.width,C=void 0===N?"":N,k=t.virtualParentElement,L=t.hasCommandBar,A=void 0!==L&&L,O=t.customCssStyle,M=void 0===O?n.createObservable(""):O;n._size=i;n._onClose=b;n.contentElement=n.createObservable();n.title=n.wrapObservable(v);n._ariaLabel=n.wrapObservable(E);n.showCloseButton=n.createObservable(!!n._onClose&&x);n.isOpen=T;n.customCssStyle=M;n.widthClass=n.createPureComputed(n._computeWidthClass,{deferEvaluation:!0});var _=n.wrapObservable(C);n.style=n.createPureComputed(function(){return _()?{width:_()+"px"}:y});n.ariaLabel=n.createPureComputed(n._computeAriaLabel);n.virtualParentElement=k;n.isFluentFlight=n.resources.consume(g.e);n.hasCommandBar=A;return n}t.prototype.onClose=function(e,t){this._onClose&&this._onClose(t);return!1};t.prototype.onDismiss=function(e,t){this._onClose&&this._onClose(t);return!1};t.prototype.isPanelOpen=function(e){return this.isOpen?this.isOpen():e()};t.prototype._computeWidthClass=function(){return this.unwrapObservable(this.style)===y?"od-Panel--"+v.e.determineCssClass(this._size):""};t.prototype._computeAriaLabel=function(){return this.unwrapObservable(this.title)||this.unwrapObservable(this._ariaLabel)};return t})(s.t),w=r.e({tagName:"od-panel-overlay",template:'\x3c!--ko component:{name:overlayTagName,params:{animation:{afterAdd:1,beforeRemove:500,isOpen:isOpen},alignToParent:false,virtualParentElement:virtualParentElement}}--\x3e<div class="od-Panel-container" data-bind="focusTrap:{},css:{\'od-Panel--hidden\':!isPanelOpen($host.isOpen)}"><div class="ms-ModalOverlay od-PanelOverlay"></div><div class="od-Panel od-Panel--hasPadding od-Panel--autoScroll" role="dialog" tabindex="-1" data-bind="interactionScope:{isScope:true},preserveFocus,recoverFocus:{isEnabled:isPanelOpen($host.isOpen)},scrollContainer,dismiss:{isOpen:isOpen||$host.isOpen,close:$component.onDismiss.bind($component),useLocalEvents:true},class:widthClass()+\' \'+customCssStyle(),css:{\'od-Panel--hasCommandBar\':hasCommandBar},attr:{\'aria-label\':ariaLabel},style:style,element:$component.contentElement">\x3c!--ko if:title--\x3e<div class="od-Panel-title" role="heading" aria-level="1" data-bind="text:title,css:{\'ms-fontWeight-semilight\':!$component.isFluentFlight,\'ms-fontWeight-semibold\':$component.isFluentFlight,\'ms-font-xl\':!$component.isFluentFlight}"></div>\x3c!--/ko--\x3e<div class="od-Panel-content" data-bind="host:{}"></div>\x3c!--ko if:showCloseButton--\x3e<button class="od-Panel-button od-Panel-button--close" data-bind="click:$component.onClose.bind($component),attr:{\'aria-label\':$component.closePanelLabel}"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e',viewModel:b,synchronous:!0});t.e=w},,function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(52),i=n(1814),s=n(0),o=n(103),u=n(63),a=(function(e){Object(s.__extends)(t,e);function t(){var n=e.call(this,t._Key,t._DataStoreCachingType)||this;n._MaxItems=200;n._Version=5;n._buffer=n.getValue(t._StorageKey);n._buffer&&n._buffer.version===n._Version&&n._buffer.lastCachePrune||n.initializeBuffer();n._data={};if(Date.now()<n._buffer.lastCachePrune+6048e5)for(var r=0;r<n._buffer.dataArray.length;r++)n._data[n._buffer.dataArray[r].email]=n._buffer.dataArray[r];else{n.initializeBuffer();n.setValue(t._StorageKey,n._buffer)}return n}t.clear=function(){new o.e(t._Key,t._DataStoreCachingType).remove(t._StorageKey)};t.isCacheEntryFresh=function(e,t){return e.name===t.name&&e.email===t.email&&e.job===t.job&&e.office===t.office&&e.department===t.department&&e.phone===t.phone};t.prototype.setItem=function(e){var n=this._data[e.email];if(n){if(t.isCacheEntryFresh(n,e))return;var r=this._buffer.dataArray.map(function(e){return e.userId}).indexOf(e.userId);this._buffer.dataArray[r]=e}else if(this._buffer.dataArray.length===this._MaxItems){this._buffer.index++;this._buffer.index>=this._MaxItems&&(this._buffer.index=0);var i=this._buffer.dataArray[this._buffer.index];delete this._data[i.email];this._buffer.dataArray[this._buffer.index]=e}else{this._buffer.dataArray.push(e);this._buffer.index++}this._data[e.email]=e;this.setValue(t._StorageKey,this._buffer)};t.prototype.getItems=function(e,t){for(var n=[],r=0;r<this._buffer.dataArray.length;r++){var i=(this._buffer.index-r+this._MaxItems)%this._MaxItems;!(this._buffer.dataArray[i].email&&this._buffer.dataArray[i].email.toLowerCase().indexOf(e.toLowerCase())>=0||this._buffer.dataArray[i].name&&this._buffer.dataArray[i].name.toLowerCase().indexOf(e.toLowerCase())>=0)||t&&1===this._buffer.dataArray[i].entityType||n.push(this._buffer.dataArray[i])}return n};t.prototype.containsItem=function(e){return Boolean(this._data[e.email])};t.prototype.initializeBuffer=function(){this._buffer={};this._buffer.dataArray=[];this._buffer.index=-1;this._buffer.version=this._Version;this._buffer.lastCachePrune=Date.now()};t._Key="ClientPeoplePicker";t._StorageKey="MRU";t._DataStoreCachingType=u.e.local;return t})(o.e),f=(function(){function e(e){this._dataSource=e.peoplePickerDataSource?e.peoplePickerDataSource:new i.e({imageAbsoluteWebUrl:e.imageAbsoluteWebUrl},{pageContext:e.pageContext,apiUrlHelper:e.apiUrlHelper,graphPeoplePickerHelper:e.graphPeoplePickerHelper});this._ppCapabilities=this._dataSource.getCapabilities();if(this._ppCapabilities.supportsMruCaching){this._mruCache=new a;this.MaxCacheSuggestions=5}else this.MaxCacheSuggestions=0}e.prototype.search=function(e,t){var n,i,s=this,o={cached:null,promise:null};this._mruCache&&!t.groupID&&(i=this.searchMruCache(e,t&&t.filterExternalUsers)).length>0&&(o.cached=i);o.promise=new r.n(function(r,o){n=s._dataSource.search(e,t).then(function(e){if(e)if(i){i.length>0&&(i=s._removeStaleCacheResults(i,e));var t=i.map(function(e){return e.userId});r(e.filter(function(e){return t.indexOf(e.userId)<0}))}else r(e)},function(e){o(e)})},function(){n&&n.cancel()});return o};e.prototype.resolve=function(e,t){var n=this;return this._dataSource.resolve(e,t).then(function(e){n._mruCache&&e.isResolved&&n.addToMruCache(e);return e})};e.prototype.getPersonaDetails=function(e){return this._dataSource.getPersonaDetails(e).then(function(e){return e})};e.prototype.subscribePresence=function(e,t){return this._dataSource.subscribePresence(e,t)};e.prototype.addToMruCache=function(e){var t=this._mruCache;t&&e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"!==e.rawPersonData.EntityData.PrincipalType&&t.setItem(e)};e.prototype.getPickerEntityInformation=function(e){return this._dataSource.getPickerEntityInformation(e)};e.prototype.sharePointSearch=function(e,t){return this._dataSource.sharePointSearch(e,t).then(function(e){return e})};e.prototype.canUseGraph=function(e){return this._dataSource.canUseGraph(e)};e.prototype.canUseSubstrate=function(e){return this._dataSource.canUseSubstrate(e)};e.prototype.getLivePersonaPickerHelper=function(){return this._dataSource.getLivePersonaPickerHelper()};e.prototype.searchMruCache=function(e,t){var n=[],r=this._mruCache;if(r){n=r.getItems(e,t);var i=this.MaxCacheSuggestions;n.length>i&&(n=n.splice(0,i))}return n};e.prototype._removeStaleCacheResults=function(e,t){var n=e.map(function(e){return e.userId}),r=[];t.forEach(function(t){var i=n.indexOf(t.userId);if(i>-1){var s=e[i];a.isCacheEntryFresh(s,t)&&r.push(s)}});return r};return e})()},function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(1653),o=n(1895),u=n(326),a=n(138);Object(a.n)([{rawString:".od-DetailsPane-LegacySection .InfoPane-section{padding:12px 16px;margin:12px 0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-DetailsPane-LegacySection .InfoPane-sectionHeader{position:relative}.od-DetailsPane-LegacySection .InfoPane-sectionHeaderText{font-size:.875rem;font-weight:400}.isFluent .od-DetailsPane-LegacySection .InfoPane-sectionHeaderText{font-size:.875rem;font-weight:600;margin:0 0 8px}.od-DetailsPane-LegacySection .od-SharingSection-PermissionsPile{padding:12px 16px;margin:12px 0;width:auto}.od-DetailsPane-LegacySection .InfoPaneSection--properties{width:auto}.od-DetailsPane-LegacySection .InfoPane-sectionContent .od-ClientFormFields-field{padding:0;margin:12px 0}.od-DetailsPane-LegacySection .InfoPaneSection--activitiesfeed .InfoPane-sectionContent{margin-top:12px}.od-DetailsPane-LegacySection .InfoPaneSection--shortcutInformation{font-size:12px}.od-DetailsPane-LegacySection .InfoPaneSection--shortcutInformation .InfoPane-sectionHeader{display:none}.od-DetailsPane-LegacySection .od-PolicyTipSection.InfoPane-section{padding:0}.od-DetailsPane-LegacySection .od-PolicyTipSection.InfoPane-section .od-PolicyTipMessageBar{padding:12px 16px}.od-DetailsPane-LegacySection .od-PolicyTipSection.InfoPane-section .InfoPane-sectionContent{padding:12px 16px}"}]);var f=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._scope=new u.e;n._sectionParams={item:n.props.item,isScheduled:n.props.isScheduling,isHeaderHidden:n.props.isHeaderHidden};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.item!==this.props.item&&(this._sectionParams={item:e.item,isScheduled:e.isScheduling})};t.prototype.shouldComponentUpdate=function(e){return e.sectionControlKey!==this.props.sectionControlKey||e.resources!==this.props.resources||e.item!==this.props.item};t.prototype.componentWillUnmount=function(){this._scope.dispose()};t.prototype.render=function(){var e=this.props,t=e.sectionControlKey,n=e.resources,r=Object(s.r)(t,this._sectionParams);return i.createElement("div",{className:"od-DetailsPane-LegacySection"},i.createElement(o.t,{specification:r,resources:n}))};return t})(i.Component);t.e=f},,,,,,,function(e,t,n){"use strict";var r;(function(e){e[e.documents=0]="documents";e[e.photos=1]="photos";e[e.favorites=2]="favorites"})(r||(r={}));t.e=r},function(e,t,n){"use strict";var r=n(0),i=n(1650),s=n("knockout-lib"),o=n(1668),u=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=Object(o.t)(n.element),i=n.element;n.createBackgroundComputed(function(){var e=s.unwrap(n.valueAccessor());if(e.isSelected()){var t=e.top,o=e.containerToTop,u=e.smooth,a=r.scrollTop,f=a+r.offsetHeight,l=r.scrollHeight-r.clientHeight,c=i.offsetTop,h=c+i.offsetHeight,p=a;o?p=0:c<a||t?p=c:h>f&&(p=h-r.offsetHeight);if((p=Math.min(p,l))===a)return;u?n.smoothScroll(r,p,a):r.scrollTop=p}});return n}t.prototype.smoothScroll=function(e,t,n,r){var i=this;void 0===r&&(r=0);if(!(r>100)){var s=1*r/100,o=0;o=s<=.5?2*s*s:1-2*(s=1-s)*s;e.scrollTop=n+o*(t-n);this.async.setTimeout(function(){i.smoothScroll(e,t,n,r+1)},5)}};return t})(i.t);t.e=u}],Array(16),[function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n("knockout-lib");function i(e,t){var n=document.createElement("div");n.innerHTML=t;r.applyBindings(e,n);var i=n.textContent;r.cleanNode(n);return i}},function(e,t,n){"use strict";var r;(function(e){e[e.none=1]="none";e[e.available=2]="available";e[e.other=3]="other"})(r||(r={}));t.e=r}],Array(14),[function(e,t,n){"use strict";var r,i=n(0),s=n(2367),o=n(2298),u=n(2504);(function(e){e[e.NONE=0]="NONE";e[e.VIEW=1]="VIEW";e[e.EDIT=2]="EDIT";e[e.OWNER=3]="OWNER";e[e.REVIEW=6]="REVIEW"})(r||(r={}));var a=n(2429),f=n(2090),l=n(1922),c=n(2160),h=n(1965),p=n(1709),d=n(125),v=n(52),m=n(22),g=n(156),y=n(1654),b=n(70),w=n(48),E=n(109),S=n(1665),x=n(33),T=n(1667),N=n(1917),C=n(1771),k=n(141),L=n(2021),A=n(1688),O=n(1923),M=n(101),_=(function(){function e(e,t){var n=this;this._listeners=null;var r=e.item,i=e.sharingInformation,s=e.defaultRecipients,o=e.accessChecked,u=void 0===o||o,a=e.mode,l=e.isListItem;this._item=r;this._mode=a;this._sharingContextInformation=e.sharingContextInformation;this._clientId=this._sharingContextInformation&&Object(f.t)(this._sharingContextInformation.clientId);this._sharingProvider=t.sharingProvider;this._suiteNavProvider=t.suiteNavProvider||void 0;this._graphPeoplePickerHelper=t.graphPeoplePickerHelper;this._substratePeoplePickerHelper=t.substratePeoplePickerHelper;this._peoplePickerProvider=t.peoplePickerProvider;this._policyTipProvider=t.policyTipProvider||void 0;this._permissions=this._sharingContextInformation&&this._sharingContextInformation.rawInvite&&this._sharingContextInformation.rawInvite.value;this._sharingService=e.sharingService;this._firstShareLinkRequest=!0;this._listeners=[];this._groupsMemberCountCache=[];this._sharingInformationInvalidated=!1;this._groupMembersCountHash={};this._isListItem=l;this._sharingContextInformation&&this._sharingContextInformation.experimentContext&&Object(O.e)(this._sharingContextInformation.experimentContext);var h=this._sharingContextInformation?this._sharingContextInformation.scenarioId:"",p={mode:this._mode,clientId:this._clientId,scenarioId:h};this._engagementHelper=new N.e(e.telemetryManager,p);this._storeContents={sharingInformation:i,sharingLinkCreated:null,companyName:this._sharingContextInformation&&this._sharingContextInformation.organizationName||y.xe,groupsMemberCount:0,policyTipInfo:{info:null,actionResult:null},permissionsMap:{},invitedUsers:[],defaultLink:null,defaultRecipients:null,outlookAvailability:c.e.none,grantAccessResult:null,addPeopleResult:null,accessRequestCreated:!1,isValidatingDefaultRecipients:!1};this._configureuserPhotoCdnBaseUrl(i);if(s&&0!==s.length)this._resolveDefaultRecipients(s,u,a);else{this._eventGroup=new g.t(this);this._eventGroup.on(window,"message",function(e){if(e&&e.data)try{var t=JSON.parse(e.data);if("atMention_defaultRecipients"===t.name){var r=t.recipientIds;n._resolveDefaultRecipients(r,u,a)}}catch(e){}})}}e.prototype.isConsumer=function(){return!1};e.prototype.isListItem=function(){return this._isListItem};e.prototype.getEngagementHelper=function(){return this._engagementHelper};e.prototype.addListener=function(e){this._listeners.push(e)};e.prototype.getInitialLinkSettings=function(e){return null};e.prototype.getSharingInformation=function(){return this._storeContents.sharingInformation};e.prototype.shouldDisableGraphForPeopleSearch=function(){return this._storeContents&&this._storeContents.sharingInformation&&(this._storeContents.sharingInformation.enforceIBSegmentFiltering||this._storeContents.sharingInformation.enforceSPOSearch)};e.prototype.isPeopleSharingLinksEnabled=function(){if(this._storeContents.sharingInformation){var e=this._storeContents.sharingInformation.sharingAbilities;return!(!e||!e.peopleSharingLinkAbilities)&&(!!e&&(e.peopleSharingLinkAbilities.canManageEditLink.enabled||e.peopleSharingLinkAbilities.canManageReadLink.enabled))}return!1};e.prototype.showManageAccess=function(){return!0};e.prototype.fetchSharingInformation=function(e,t){var n=this;if(!this._storeContents.sharingInformation||this._sharingInformationInvalidated||e&&!this._storeContents.sharingInformation.hasPermissionsInformation||t){var r=(new Date).getTime(),i=!!this._sharingContextInformation||e;this._sharingProvider.getSharingInformation(this._item,i,!0,null,t).then(function(e){n._getSharingInformationStats={name:"GetSharingInformation",resultType:w.e.Success,duration:(new Date).getTime()-r};if(!n._storeContents.sharingInformation||!n._storeContents.sharingInformation.error){n._storeContents.sharingInformation=e;n._fetchAdditionalAuthenticationTokens();n.fetchPolicyTipInformation();n._configureLinkIfShareId();n._configureuserPhotoCdnBaseUrl(e);n._emitChange({type:l.t.FetchSharingInformation})}},function(e){var t=5,i=e&&e.code,s=e&&e.status,o=y.Ft,u=JSON.stringify(e||{});i?i.indexOf("-2147024809")>-1&&u&&u.indexOf("Item does not exist")>-1&&(t=3):s&&parseInt(s,10)>=500&&(t=2);n._getSharingInformationStats={name:"GetSharingInformation",resultType:w.e.Failure,duration:(new Date).getTime()-r,error:t};n._invokeShareStatsEvent();n._storeContents.sharingInformation={error:t,errorCategory:1,errorMessage:o,debugErrorMessage:u,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,isGraphAvailable:!1,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,customizedExternalSharingServiceUrl:void 0,outlookEndpointHostUrl:void 0,webUrl:void 0};n._emitChange({type:l.t.FetchSharingInformation})})}else{this._getSharingInformationStats={name:"GetSharingInformationProvided",resultType:w.e.Success,duration:0};this._configureLinkIfShareId();this._emitChange({type:l.t.FetchSharingInformation})}};e.prototype.fetchMemberCount=function(e){var t=this;this._groupMembersCountHash[e.email]||this._peoplePickerProvider.getPickerEntityInformation(e).then(function(n){var r=n.totalMemberCount;t._groupMembersCountHash[e.email]=r;t._emitChange()}).catch(function(n){t._groupMembersCountHash[e.email]=null;t._emitChange()})};e.prototype.getMembersCounts=function(){return this._groupMembersCountHash};e.prototype.shareLink=function(e){var t,n=this,r=this._firstShareLinkRequest;this._firstShareLinkRequest=!1;Object(M.s)("sharelink.start");var a=e.settings,f=e.recipients,c=e.emailMessage,h=e.emailSubject,p=e.copyLinkCommand,d=e.allRecipientsHaveAccess,v=e.shareId,g=e.inviteesToRemove,b=e.shareType;if(e.copyLinkCommand&&T.c(this._clientId)&&this._mode===s.e.copy&&!this._sharingContextInformation.shareId&&this._sharingService&&(this._sharingContextInformation.itemUrl||this._sharingContextInformation.webAbsoluteUrl&&this._sharingContextInformation.serverRelativeItemUrl||this._sharingContextInformation.webAbsoluteUrl&&this._sharingContextInformation.uniqueId)&&r)this._getDefaultLink();else{var E=0,S=0,x=!1,N=(f=f||[]).map(function(e){1===e.entityType?S++:E++;e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"===e.rawPersonData.EntityData.PrincipalType&&(x=!0);return{userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData}});N=this._dedupeRecipients(N);if(v&&v.length>0||a.shareId&&a.shareId.length>0)this._shareLink(a,N,c,h,p,r,v,g);else{if(this.isPeopleSharingLinksEnabled()&&(this._doesPSLSupportNewExternalUsers()||!x)&&a.audience!==o.e.existing&&!this._storeContents.sharingInformation.requiresAccessApproval)this._shareLink(a,N,c,h,p,r,v,g);else if(1!==a.sharingLinkKind&&6!==a.sharingLinkKind)this._shareLink(a,N,c,h,p,r,v,g);else{var C=void 0;C=a.sharingRole?this._getRoleString(a.sharingRole):this._getRoleValue(a.isEdit);var k={items:[this._item],roleValue:C,sendEmail:void 0!==c,message:c,subject:h,requireSignIn:!0,propagateSharing:!0},L=this._storeContents.sharingInformation.directLink,O=A.r()&&(null===(t=a)||void 0===t?void 0:t.audience)==o.e.existing&&(b===u.e.copy||b===u.e.outlook||b===u.e.teams||b===u.e.nonOutlook||b===u.e.moreApps);if(0===f.length||a.audience==o.e.existing&&(this._mode===s.e.copy||this._mode==s.e.linkSettings)||O){this._invokeShareStatsEvent({name:"NoExtraCallReturnCanonical",duration:0,resultType:w.e.Success});Object(M.s)("sharelink.existing");this._handleSharedLink(L,p)}else{for(var _=!0,D=0,P=f;D<P.length;D++){var H=P[D];3!==this._storeContents.permissionsMap[H.email]&&3!==this._storeContents.permissionsMap[H.userId]&&(_=!1)}if(_||d){var B=(new Date).getTime();Object(M.s)("sharelink.emailWithoutPermissioning.start");this._sharingProvider.emailWithoutPermissioning(N,this._item,c,h).done(function(e){Object(M.s)("sharelink.emailWithoutPermissioning.end");var t=e.statusCode;if(0===t){n._invokeShareStatsEvent({name:"ForwardObjectLink",duration:(new Date).getTime()-B,resultType:w.e.Success});n._handleSharedLink(L,p)}else{var r=5,s=y.Ft;if(-8===t){r=6;s=y.Us}else if(-13===t){r=7;s=m.format(y.Gt,e.invalidEmails.join(", "))}else if(-7===t){r=5;s=e.errorMessage}n._invokeShareStatsEvent({name:"ForwardObjectLink",duration:(new Date).getTime()-B,resultType:w.e.Failure,error:r});n._storeContents.sharingInformation=Object(i.__assign)(Object(i.__assign)({},n._storeContents.sharingInformation),{error:r,errorCategory:3,errorMessage:s});n._emitChange({type:l.t.ShareLink})}})}else{var j=(new Date).getTime();Object(M.s)("sharelink.share.start");this._sharingProvider.share(N,k,!0).done(function(e){Object(M.s)("sharelink.share.end");var t=e.statusCode;if(0===t){var r=L;0===E&&1===S&&e.invitationLink?r=Object(i.__assign)(Object(i.__assign)({},L),{url:e.invitationLink}):0===E&&S>1&&e.invitationLink&&(r=Object(i.__assign)(Object(i.__assign)({},L),{url:n._removeEmailQueryParamFromInvitationLink(e.invitationLink)}));a.audience===o.e.customLabeledSpecificPeople&&(r=Object(i.__assign)(Object(i.__assign)({},r),{audience:o.e.customLabeledSpecificPeople}));n._invokeShareStatsEvent({name:"ShareObject",resultType:w.e.Success,duration:(new Date).getTime()-j});n._handleSharedLink(r,p)}else if(1===t){n._storeContents.accessRequestCreated=!0;n._invokeShareStatsEvent({name:"ShareObject",resultType:w.e.Success,duration:(new Date).getTime()-j});n._handleSharedLink(L,p)}else{var s=5,u=y.Ft;if(-8===t){s=6;u=y.Us}else if(-13===t){s=7;u=m.format(y.Gt,e.invalidEmails.join(", "))}else if(-7===t){s=5;u=e.errorMessage}n._storeContents.sharingInformation=Object(i.__assign)(Object(i.__assign)({},n._storeContents.sharingInformation),{error:s,errorCategory:3,errorMessage:u});n._invokeShareStatsEvent({name:"ShareObject",resultType:w.e.Failure,duration:(new Date).getTime()-j,error:s});n._emitChange({type:l.t.ShareLink})}})}}}p&&this._storeContents.defaultLink&&this._storeContents.defaultLink.audience!==a.audience&&this._cleanupDefaultLink()}}};e.prototype.unshareLink=function(e,t){var n=this,r={item:this._item,kind:e,shareId:t};this._sharingProvider.unshareLink(r).done(function(e){if(!0===e){n._removeLinkByShareId(t);n._updateIsShared();n._emitChange({type:l.t.UnshareLink})}})};e.prototype.getSharingLinkCreated=function(){return this._storeContents.sharingLinkCreated};e.prototype.updatePermissions=function(e,t){var n=this;this._sharingProvider.updatePermissions2(e,this._item,t).done(function(t){var i=n._storeContents.sharingInformation.sharingPrincipals;if(t.role===r.NONE){n._storeContents.sharingInformation.sharingPrincipals=i.filter(function(t){return t.id!==e.id});n._updateIsShared();n._emitChange()}else for(var s=0,o=i;s<o.length;s++){var u=o[s];if(u.id===e.id){switch(t.role){case r.VIEW:u.role=a.e.view;break;case r.EDIT:u.role=a.e.edit;break;case r.OWNER:u.role=a.e.owner;break;case r.REVIEW:u.role=a.e.review}n._emitChange()}}})};e.prototype.addPeople=function(e,t,n,r,i){var s=this,o=this._getRoleString(t),u={items:[this._item],roleValue:o,sendEmail:r,message:i,requireSignIn:!0,propagateSharing:!0};this._sharingProvider.share(e,u,!0).then(function(e){switch(e.statusCode){case 0:s._storeContents.addPeopleResult=l.e.CompletedSuccessfully;break;case 1:s._storeContents.addPeopleResult=l.e.AccessRequestsQueued;break;default:s._storeContents.addPeopleResult=l.e.Error}s._emitChange()},function(){s._storeContents.addPeopleResult=!1;s._emitChange()})};e.prototype.fetchSuiteNavInformation=function(){var e=this;if(this._suiteNavProvider)this._suiteNavProvider.loadData().then(function(t){var n=t.CompanyDisplayName||e._storeContents.companyName,r=t?JSON.parse(t.ClientData):{HasEXOLicense:!1};e._storeContents.companyName=n;e._storeContents.outlookAvailability=r.HasEXOLicense?c.e.available:c.e.none;e._emitChange()});else{this._storeContents.outlookAvailability=c.e.none;this._emitChange()}};e.prototype.getCompanyName=function(){return this._storeContents.companyName};e.prototype.getOutlookAvailability=function(){return this._storeContents.outlookAvailability};e.prototype.navigateToOwa=function(e,t){window.open(this._getOwaUrl(e,t),"_blank")};e.prototype.getNavId=function(){return this._sharingContextInformation&&this._sharingContextInformation.navId};e.prototype.fetchGroupsMemberCount=function(e){for(var t=this,n=0,r=function(e){var r={userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData,principalType:e.principalType};if(e.principalType===p.e.securityGroup){var s=i._groupsMemberCountCache[e.userId];void 0!==s?n+=s:i._peoplePickerProvider.getPickerEntityInformation(r).then(function(r){var i=r.totalMemberCount;t._groupsMemberCountCache[e.userId]=i;n+=i;t._storeContents.groupsMemberCount=n;t._emitChange()}).catch(function(n){t._groupsMemberCountCache[e.userId]=null;t._emitChange()})}},i=this,s=0,o=e;s<o.length;s++){r(o[s])}this._storeContents.groupsMemberCount=n;this._emitChange()};e.prototype.getGroupsMemberCount=function(){return this._storeContents.groupsMemberCount};e.prototype.fetchPolicyTipInformation=function(){var e=this;if(this._policyTipProvider){if(this._storeContents.policyTipInfo.info){this._emitChange();return}var t=this._storeContents.sharingInformation;if(!t)return;if(!this._item)return;var n=!this._isPolicyTipFlagSet(this._item.policyTip,4),r=t.sharingAbilities;if(r){if(7!==(r&&r.directSharingAbilities&&r.directSharingAbilities.canAddExternalPrincipal.disabledReason)&&n)return}else if(n)return;this._policyTipProvider.getPolicyTip(this._item).then(function(t){if(t){e._storeContents.policyTipInfo.info=t;e._emitChange()}})}};e.prototype.getPolicyTipInformation=function(){return this._storeContents.policyTipInfo};e.prototype.updatePolicy=function(e,t){var n=this;if(this._policyTipProvider){var r={item:this._item,action:e};t&&(r.justification=t);this._policyTipProvider.updatePolicy(r).then(function(e){n._storeContents.policyTipInfo.actionResult=e;n._sharingInformationInvalidated=!0;n.fetchSharingInformation(!0);n._emitChange()})}};e.prototype.checkPermissions=function(e,t){var n=this;if(0!==e.length){var r=[];this._recipients=[];for(var i=0,s=e;i<s.length;i++){var o=s[i];r.push({alias:b.t.isActivated("00bdc590-2d96-4d10-bb1c-66fb6cb59dfd")?o.email:o.userId||o.email});this._recipients.push(o.email)}t=t||this._storeContents.invitedUsers;this._invitedUsers=[];for(var u=0,a=t;u<a.length;u++){var f=a[u];r.push({alias:f.email});this._invitedUsers.push(f.email)}var l=r.map(function(e){return e.alias});this._sharingProvider.checkPermissions(r,this._item).then(function(e){n._storeContents.permissionsMap={};for(var t=0,r=e;t<r.length;t++){var i=r[t];n._invitedUsers.indexOf(i.inputEntity)>-1?n._storeContents.permissionsMap[i.inputEntity]=i.hasAccess?3:2:(n._recipients.indexOf(i.inputEntity)>-1||l.indexOf(i.inputEntity)>-1)&&(n._storeContents.permissionsMap[i.inputEntity]=i.hasAccess?3:1)}n._emitChange()})}else{this._storeContents.permissionsMap={};this._emitChange()}};e.prototype.getPermissionsMap=function(){return this._storeContents.permissionsMap};e.prototype.getDefaultRecipients=function(){return this._storeContents.defaultRecipients};e.prototype.consumeDefaultRecipients=function(){this._storeContents.defaultRecipients={isConsumed:!0,recipients:this._storeContents.defaultRecipients.recipients}};e.prototype.grantAccess=function(e){var t=this,n=(e=e||[]).map(function(e){return{userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData}});n=this._dedupeRecipients(n);var r={items:[this._item],roleValue:this._getRoleValue(!0),sendEmail:!1,requireSignIn:!0,propagateSharing:!0};this._sharingProvider.share(n,r,!0).done(function(e){t._storeContents=Object(i.__assign)(Object(i.__assign)({},t._storeContents),{grantAccessResult:0===e.statusCode});t._emitChange()})};e.prototype.getGrantAccessResult=function(){return this._storeContents.grantAccessResult};e.prototype.getAddPeopleResult=function(){return this._storeContents.addPeopleResult};e.prototype.dispose=function(){if(this._eventGroup){this._eventGroup.dispose();this._eventGroup=void 0}};e.prototype.hasAccessRequestBeenCreated=function(){return this._storeContents.accessRequestCreated};e.prototype.isValidatingDefaultRecipients=function(){return this._storeContents.isValidatingDefaultRecipients};e.prototype.setAddressBarLinkCapability=function(e){var t=this;return this._sharingProvider.setAddressBarLinkCapability(this._item,e).done(function(e){e&&t.fetchSharingInformation(!0,!0)})};e.prototype._doesPSLSupportNewExternalUsers=function(){if(this._storeContents.sharingInformation){var e=this._storeContents.sharingInformation.sharingAbilities;return!(!e||!e.peopleSharingLinkAbilities)&&e.peopleSharingLinkAbilities.canAddNewExternalPrincipals.enabled}return!1};e.prototype.resetPeoplePickerError=function(){this._storeContents.sharingInformation.peoplePickerError=void 0;this._emitChange()};e.prototype.getSharingClickTime=function(){return this._sharingContextInformation.clickTime};e.prototype._cleanupDefaultLink=function(){var e=this._storeContents.defaultLink;if(e){this.unshareLink(e.sharingLinkKind,e.shareId);this._storeContents.defaultLink=void 0}};e.prototype._emitChange=function(e){if(this._storeContents&&this._storeContents.sharingInformation){var t=this._storeContents.sharingInformation,n=this.getItemInformationForLogging(),r=n.itemType,i=n.extension;this._engagementHelper.setEngagementExtraData({webTemplateId:t.webTemplateId,itemUniqueId:t.itemUniqueId,itemType:r,extension:i})}for(var s=0,o=this._listeners;s<o.length;s++){(0,o[s])(e)}};e.prototype._fetchAdditionalAuthenticationTokens=function(){var e=this;if(this._storeContents.sharingInformation){var t=this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();t?this._graphPeoplePickerHelper.getGraphToken().then(function(n){t=!!n;e._storeContents.sharingInformation.isGraphAvailable=t}):this._storeContents.sharingInformation.isGraphAvailable=!1;var n=this._substratePeoplePickerHelper&&this._substratePeoplePickerHelper.canUseSubstrate();n?this._substratePeoplePickerHelper.getSubstrateToken().then(function(t){e._substratePeoplePickerHelper.init(t);n=!!t;e._storeContents.sharingInformation.isTsAvailable=n}):this._storeContents.sharingInformation.isTsAvailable=!1}};e.prototype._handleSharedLink=function(e,t){e.createdViaCopyLinkCommand=t||!1;this._storeContents.sharingLinkCreated=e;this._updateIsShared();this._emitChange({type:l.t.ShareLink})};e.prototype._getRoleValue=function(e){return e?h.e:h.r};e.prototype._getRoleString=function(e){return e===a.e.review?"roletype:Reviewer":e===a.e.edit?h.e:e===a.e.owner?h.n:e===a.e.manageList?h.t:h.r};e.prototype._configureLinkIfShareId=function(){var e=this,t=this._sharingContextInformation&&this._sharingContextInformation.shareId;if(t&&this._mode===s.e.copy){if("00000000-0000-0000-0000-000000000000"===t)this._storeContents.sharingLinkCreated=this._storeContents.sharingInformation.directLink;else{var n=this._storeContents.sharingInformation.sharingLinks.filter(function(t){return t.isActive&&t.shareId===e._sharingContextInformation.shareId})[0];this._storeContents.sharingLinkCreated=n||this._storeContents.sharingInformation.directLink}this._storeContents.sharingLinkCreated.createdViaCopyLinkCommand=!0}};e.prototype._configureuserPhotoCdnBaseUrl=function(e){A.p()||!e||!e.userPhotoCdnBaseUrl||window._spPageContextInfo&&window._spPageContextInfo.userPhotoCdnBaseUrl||(window._spPageContextInfo=Object(i.__assign)(Object(i.__assign)({},window._spPageContextInfo),{userPhotoCdnBaseUrl:e.userPhotoCdnBaseUrl}))};e.prototype._removeLinkByShareId=function(e){this._storeContents.sharingInformation.sharingLinks=this._storeContents.sharingInformation.sharingLinks.map(function(t){if(e===t.shareId){t.expiration=null;t.isActive=!1;t.shareId=d.e.Empty;t.url=null;t.principals=[]}return t})};e.prototype._updateIsShared=function(){var e=this._storeContents.sharingInformation;if(e){for(var t=e.sharingLinks,n=e.sharingPrincipals,r=!1,i=0,s=t;i<s.length;i++){var o=s[i];o.isActive&&1!==o.sharingLinkKind&&(r=!0)}r||(r=n.length>0);this._storeContents.sharingInformation.isShared=r}};e.prototype._getOwaUrl=function(e,t){var n,r,i="https://outlook.office.com/owa/",s=null===(r=null===(n=this._storeContents)||void 0===n?void 0:n.sharingInformation)||void 0===r?void 0:r.outlookEndpointHostUrl;s&&(i="https://"+s+"/owa/");return i+"?body="+encodeURIComponent(t)+"&to="+e.join(";")+"&path=/mail/action/compose"};e.prototype._resolveDefaultRecipients=function(e,t,n){var r=this,o=e||[],u=[];this._storeContents.isValidatingDefaultRecipients=e.length>0;if(!t){o=[];for(var a=[],f=0,l=e;f<l.length;f++){var c=l[f];a.push({alias:c})}u.push(this._sharingProvider.checkPermissions(a,this._item).then(function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];r.hasAccess||o.push(r.inputEntity)}}))}v.n.all(u).then(function(){if(0!==o.length){for(var e=[],t=[],u={principalSource:15,principalType:13,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:1,allowSharePointGroups:!1,forceResolve:!0},a=0,f=o;a<f.length;a++){var l=f[a];e.push(r._peoplePickerProvider.resolve(l,u).then(function(e){t.push(e)}))}v.n.all(e).then(function(){r._storeContents.defaultRecipients={isConsumed:!1,recipients:t};r._storeContents.isValidatingDefaultRecipients=!1;r._emitChange()},function(){r._storeContents.defaultRecipients={isConsumed:!1,recipients:[]};r._storeContents.isValidatingDefaultRecipients=!1;r._emitChange()})}else if(n===s.e.atMention){r._storeContents=Object(i.__assign)(Object(i.__assign)({},r._storeContents),{grantAccessResult:!0});r._emitChange()}})};e.prototype._removeEmailQueryParamFromInvitationLink=function(e){var t=e.split("?");if(t.length>1){for(var n=[],r=0,i=t[1].split("&");r<i.length;r++){var s=i[r];-1===s.indexOf("email=")&&n.push(s)}var o=n.join("&");return t[0]+"?"+o}return e};e.prototype._shareLink=function(e,t,n,r,u,c,h,p){var d=this;Object(M.s)("sharelink._shareLink.start");var v={emailData:n,emailSubject:r,items:[this._item],recipients:t,settings:{createLink:!0,sharingLinkKind:e.sharingLinkKind,expiration:e.expiration,updatePassword:e.updatePassword,password:e.password,shareId:h,inviteesToRemove:p,role:e.sharingRole}};v.settings.role||(v.settings.role=e.isEdit?a.e.edit:a.e.view);if(e.shareId&&e.shareId.length>0){v.settings.shareId=e.shareId;e.fetchLinkOnly&&(v.settings.createLink=!1)}var m=(new Date).getTime(),g=new E.e({name:"SharingShareLink."+s.e[this._mode]+"."+(f.e[this._clientId]||"unknown")});this._getShareLinkStats={name:"ShareLinkInit",resultType:w.e.Success,duration:0};if((e.updatePassword||e.hasPassword&&e.shareId&&e.shareId.length>0)&&e.audience===o.e.anyone){v.settings.sharingLinkKind=6;v.settings.allowAnonymousAccess=!0}if(e.audience===o.e.anyone)if(e.trackLinkUsers){v.settings.allowAnonymousAccess=!1;v.settings.restrictShareMembership=!1;v.settings.trackLinkUsers=!0;v.settings.scope=0;v.settings.sharingLinkKind=6}else{v.settings.allowAnonymousAccess=!0;v.settings.restrictShareMembership=!1;v.settings.trackLinkUsers=!1;v.settings.scope=0}else if(e.audience===o.e.organization){v.settings.allowAnonymousAccess=!1;v.settings.restrictShareMembership=!1;v.settings.scope=1}if(e.preventDownload){v.settings.role=a.e.restrictedview;e.sharingRole=a.e.restrictedview;v.settings.sharingLinkKind=6}if(e.audience===o.e.specificPeopleFlex||e.audience===o.e.customLabeledSpecificPeople){v.settings.restrictShareMembership=!0;v.settings.scope=2}var b=this.getDefaultRecipients();e.audience===o.e.customLabeledSpecificPeople&&b&&(v.recipients=b.recipients);if(e.isCreateOnlyLink){v.settings.role=a.e.submit;v.settings.description=e.description}this._sharingProvider.shareLink(v).done(function(t){Object(M.s)("sharelink._shareLink.end");if(t.error){d._storeContents.sharingInformation=Object(i.__assign)(Object(i.__assign)({},d._storeContents.sharingInformation),{error:t.error,errorCategory:2,debugErrorMessage:t.debugErrorMessage,errorMessage:y.Ft});g.end({resultType:w.e.Failure});d._getShareLinkStats={name:"ShareLink",resultType:w.e.Failure,duration:(new Date).getTime()-m,error:t.error};d._invokeShareStatsEvent(d._getShareLinkStats);d._emitChange({type:l.t.ShareLink})}else{g.end({resultType:w.e.Success});d._getShareLinkStats={name:"ShareLink",resultType:w.e.Success,duration:(new Date).getTime()-m};d._invokeShareStatsEvent(d._getShareLinkStats);var n=t.link;e.audience===o.e.customLabeledSpecificPeople&&(n.audience=o.e.customLabeledSpecificPeople);n.sharingLinkKind===d._storeContents.sharingInformation.defaultSharingLink.sharingLinkKind&&c&&u&&0===d._storeContents.sharingInformation.sharingLinks.filter(function(e){return e.shareId===n.shareId}).length&&(d._storeContents.defaultLink=n);if(h){d._sharingInformationInvalidated=!0;d.fetchSharingInformation(!0);d._emitChange({type:l.t.ShareLink})}else d._handleSharedLink(n,u)}})};e.prototype._invokeShareStatsEvent=function(e){var t=new E.e,n=this._getSharingInformationStats&&this._getSharingInformationStats.resultType;e&&(n=e.resultType);var r={mode:s.e[this._mode],clientId:f.e[this._clientId]||"unknown",getData:JSON.stringify(this._getSharingInformationStats),setData:JSON.stringify(e)};t.end({name:"SharingStats",resultType:n,extraData:r})};e.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t};e.prototype._getDefaultLink=function(){var e,t,n=this,r=new E.e({name:"SharingGetDefaultLink"}),i=this._sharingContextInformation.itemUrl;if(!i&&this._sharingContextInformation.serverRelativeItemUrl){i=""+new x.e(this._sharingContextInformation.webAbsoluteUrl).authority+this._sharingContextInformation.serverRelativeItemUrl}var s=[];this._sharingContextInformation.defaultRecipients&&this._sharingContextInformation.defaultRecipients.length>0&&(s=this._sharingContextInformation.defaultRecipients.map(function(e){return{email:e}}));var o=this._sharingContextInformation.uniqueId;o||(o=null===(t=null===(e=this._storeContents)||void 0===e?void 0:e.sharingInformation)||void 0===t?void 0:t.itemUniqueId);var u=this._permissions?v.n.resolve(this._permissions):o?this._sharingService.getDefaultLinkByUniqueId(o||"",s,!0):this._sharingService.getDefaultLink(i,s,!0);Object(M.s)("sharelink.getDefaultLink.start");u.then(function(e){Object(M.s)("sharelink.getDefaultLink.end");var t=e[0],i=t.link,s=t.roles&&t.roles.indexOf("write")>=0;r.end({resultType:w.e.Success});n._handleSharedLink({allowsAnonymousAccess:"anonymous"===i.scope,audience:Object(S.S)(i.scope),expiration:t.expirationDateTime,isActive:!0,isEdit:s,principals:[],shareId:t.id,sharingLinkKind:Object(S.x)(i.scope,s),url:i.webUrl,createdViaCopyLinkCommand:!0,invitees:[],updatePassword:!1,password:""},!0)},function(e){r.end({resultType:w.e.Failure,extraData:{error:e}});var t="";try{t=JSON.stringify(e)}catch(e){}n._storeContents.sharingInformation={error:e,errorCategory:8,errorMessage:y.Ft,debugErrorMessage:t,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,isGraphAvailable:!1,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,customizedExternalSharingServiceUrl:void 0,outlookEndpointHostUrl:void 0,webUrl:void 0};n._emitChange()})};e.prototype._dedupeRecipients=function(e){var t=[],n={};e.forEach(function(e){n[e.userId]=e});Object.keys(n).forEach(function(e){t.push(n[e])});return t};e.prototype.isPasswordModificationAllowed=function(){return!0};e.prototype.isExpirationDateModificationAllowed=function(){return!0};e.prototype.isPremiumExperienceAllowed=function(){return!0};e.prototype.isReportProblemSupported=function(){return!1};e.prototype.shouldInterruptCopyLink=function(e){return new v.n(function(e,t){e(!1)})};e.prototype.isPreventDownloadAllowed=function(){return!0};e.prototype.isBundleShare=function(){return!1};e.prototype.getSupportedAudienceOptions=function(){return[o.e.anyone,o.e.customLabeledSpecificPeople,o.e.existing,o.e.organization,o.e.specificPeople,o.e.specificPeopleFlex]};e.prototype.isSpecificPeopleExpirationAllowed=function(){return!1};e.prototype.showAudienceLearnMore=function(){return!0};e.prototype.showEmailsInSuggestions=function(){return!1};e.prototype.getFamily=function(){return null};e.prototype.getFamilyMembers=function(){return null};e.prototype.getCurrentUserId=function(){return null};e.prototype.getItemInformationForLogging=function(){var e,t,n,r=!0,i=this.getSharingInformation();if(i.fileExtension){e=Object(L.e)(i.fileExtension);t=i.fileExtension}else if(i.sharedObjectType)e=C.e[i.sharedObjectType];else if(i.item){e=Object(L.t)(i.item);t=i.item.extension;r=i.item.itemType===k.t.File}r&&e&&"other"!==e&&(n=t);return{itemType:e,extension:n}};e.prototype.getSharingInformationAPIStats=function(){return this._getSharingInformationStats};e.prototype.getShareLinkAPIStats=function(){return this._getShareLinkStats};return e})();t.e=_},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"r",function(){return s});n.d(t,"t",function(){return o});n.d(t,"s",function(){return u});n.d(t,"i",function(){return a});n.d(t,"n",function(){return f});var r=n(1832),i=new r.e("checkout"),s=new r.e("quickEdit"),o=new r.e("editItem"),u=new r.e("viewItem"),a=new r.e("versionHistory"),f=new r.e("exportList")},,,,,,,,function(e,t,n){"use strict";var r=n(52),i=(function(){function e(){this._pendingPromises={}}e.prototype.deduplicate=function(e,t){var n=this;if(!this._pendingPromises[e]){var i=t();this._pendingPromises[e]=i;return i.then(function(t){delete n._pendingPromises[e];return t},function(t){delete n._pendingPromises[e];return r.n.reject(t)})}return this._pendingPromises[e]};return e})();t.e=i},function(e,t,n){"use strict";var r=n(138);Object(r.n)([{rawString:".od-Persona{box-sizing:border-box;box-shadow:none;margin:0;padding:0;font-size:.875rem;line-height:1;position:relative;width:100%}.od-Persona .od-Persona-imageArea{position:relative;display:inline-block;background-color:transparent;width:3rem;height:3rem;overflow:visible}[dir=ltr] .od-Persona .od-Persona-imageArea{margin-right:.5rem}[dir=rtl] .od-Persona .od-Persona-imageArea{margin-left:.5rem}.od-Persona .od-Persona-imageCircle{width:3rem;height:3rem;margin:0;border-radius:50%;overflow:hidden;position:absolute;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}[dir=ltr] .od-Persona .od-Persona-imageCircle{left:0}[dir=rtl] .od-Persona .od-Persona-imageCircle{right:0}[dir=ltr] .od-Persona .od-Persona-imageCircle{right:0}[dir=rtl] .od-Persona .od-Persona-imageCircle{left:0}.od-Persona .od-Persona-initials{border-radius:50%}.od-Persona .od-Persona-placeholder{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";position:absolute;font-size:2.9375rem;top:.4375rem}[dir=ltr] .od-Persona .od-Persona-placeholder{right:0}[dir=rtl] .od-Persona .od-Persona-placeholder{left:0}[dir=ltr] .od-Persona .od-Persona-placeholder{left:0}[dir=rtl] .od-Persona .od-Persona-placeholder{right:0}.od-Persona .od-Persona-image{width:3rem;height:3rem;line-height:3rem}.od-Persona .od-Persona-image[src='']{display:none}.od-Persona .od-Persona-presence{position:absolute;height:.75rem;width:.75rem;border-radius:50%;top:auto;bottom:-.375rem;border:.125rem solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}[dir=ltr] .od-Persona .od-Persona-presence{left:auto}[dir=rtl] .od-Persona .od-Persona-presence{right:auto}[dir=ltr] .od-Persona .od-Persona-presence{right:-.125rem}[dir=rtl] .od-Persona .od-Persona-presence{left:-.125rem}.od-Persona .od-Persona-row{white-space:nowrap;clear:both;display:inline-block}.od-Persona.od-Persona-unresolved .od-Persona-image{display:none}.od-Persona .od-Persona-details{vertical-align:top;display:inline-block;margin-top:.25rem}.od-Persona .od-persona-link{display:inline-block;padding-bottom:.1875rem}.od-Persona .od-Persona-primaryText{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-weight:400;font-size:1.125rem;white-space:nowrap;max-width:100%;overflow:hidden;text-overflow:ellipsis;padding-bottom:.1875rem}.od-Persona .od-Persona-emailText,.od-Persona .od-Persona-optionalText,.od-Persona .od-Persona-secondaryText,.od-Persona .od-Persona-sharingRole-Text,.od-Persona .od-Persona-sharingSpinner,.od-Persona .od-Persona-tertiaryText{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-weight:400;font-size:.75rem;padding-bottom:.1875rem;white-space:nowrap;height:auto;overflow:hidden;text-overflow:ellipsis}.od-Persona .od-Persona-sharingRole-Text{margin:.125rem 0}.od-Persona .od-Persona-optionalText,.od-Persona .od-Persona-tertiaryText{display:none}.od-Persona .od-Persona-sharingRole{cursor:pointer;background:0 0;border:none;padding:0}.od-Persona .od-Persona-sharingRole .ms-Icon--ChevronDown{position:relative;top:.125rem}.od-Persona.od-Persona--mini{width:1.5rem;height:1.5rem;display:inline-block}.od-Persona.od-Persona--mini .od-Persona-image,.od-Persona.od-Persona--mini .od-Persona-imageArea,.od-Persona.od-Persona--mini .od-Persona-imageCircle{width:1.5rem;height:1.5rem;margin:0}.od-Persona.od-Persona--mini .od-Persona-details{display:none}.od-Persona.od-Persona--tiny{padding:0;display:inline-block}[dir=ltr] .od-Persona.od-Persona--tiny{margin-left:4px}[dir=rtl] .od-Persona.od-Persona--tiny{margin-right:4px}.od-Persona.od-Persona--tiny .od-Persona-image,.od-Persona.od-Persona--tiny .od-Persona-imageArea,.od-Persona.od-Persona--tiny .od-Persona-imageCircle{display:none}.od-Persona.od-Persona--tiny .od-Persona-presence{vertical-align:text-bottom;padding-top:0}.od-Persona.od-Persona--tiny .od-Persona-details{height:.875rem;margin-top:0;line-height:.875rem;overflow:visible}[dir=ltr] .od-Persona.od-Persona--tiny .od-Persona-details{padding-left:.9375rem}[dir=rtl] .od-Persona.od-Persona--tiny .od-Persona-details{padding-right:.9375rem}.od-Persona.od-Persona--tiny .od-Persona-presence{height:.625rem;width:.625rem;top:.625rem;border:0}[dir=ltr] .od-Persona.od-Persona--tiny .od-Persona-presence{right:auto}[dir=rtl] .od-Persona.od-Persona--tiny .od-Persona-presence{left:auto}.od-Persona.od-Persona--tiny .od-Persona-primaryText{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-weight:400;font-size:.75rem;padding-top:.125rem}.od-Persona.od-Persona--tiny .od-Persona-optionalText,.od-Persona.od-Persona--tiny .od-Persona-secondaryText,.od-Persona.od-Persona--tiny .od-Persona-sharingRole-Text,.od-Persona.od-Persona--tiny .od-Persona-sharingSpinner,.od-Persona.od-Persona--tiny .od-Persona-tertiaryText{display:none}.od-Persona.od-Persona--tiny.od-Persona--comma{padding:0;background-color:transparent}.od-Persona.od-Persona--tiny.od-Persona--comma .od-Persona-primaryText:after{content:','}.od-Persona.od-Persona--xs .od-Persona-image,.od-Persona.od-Persona--xs .od-Persona-imageArea,.od-Persona.od-Persona--xs .od-Persona-imageCircle{width:2rem;height:2rem}.od-Persona.od-Persona--xs .od-Persona-imageArea{margin-bottom:0}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-imageArea{margin-right:.5rem}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-imageArea{margin-left:.5rem}.od-Persona.od-Persona--xs .od-Persona-image{line-height:2rem}.od-Persona.od-Persona--xs .od-Persona-placeholder{font-size:1.75rem;top:.25rem}.od-Persona.od-Persona--xs .od-Persona-presence{bottom:-.0625rem}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-presence{right:-.0625rem}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-presence{left:-.0625rem}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-details{padding-left:0}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-details{padding-right:0}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-details{padding-right:.25rem}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-details{padding-left:.25rem}[dir=ltr] .od-Persona.od-Persona--xs .od-Persona-details{margin-right:.25rem}[dir=rtl] .od-Persona.od-Persona--xs .od-Persona-details{margin-left:.25rem}.od-Persona.od-Persona--xs .od-Persona-primaryText{font-size:.875rem;padding-top:.1875rem}.od-Persona.od-Persona--xs .od-Persona-secondaryText{display:none}.od-Persona.od-Persona--sm .od-Persona-image,.od-Persona.od-Persona--sm .od-Persona-imageArea,.od-Persona.od-Persona--sm .od-Persona-imageCircle{width:2.5rem;height:2.5rem}[dir=ltr] .od-Persona.od-Persona--sm .od-Persona-imageArea{margin-left:.25rem}[dir=rtl] .od-Persona.od-Persona--sm .od-Persona-imageArea{margin-right:.25rem}.od-Persona.od-Persona--sm .od-Persona-image{line-height:2.5rem}.od-Persona.od-Persona--sm .od-Persona-placeholder{font-size:2.375rem;top:.3125rem}.od-Persona.od-Persona--sm .od-Persona-presence{bottom:-.0625rem;margin:0}[dir=ltr] .od-Persona.od-Persona--sm .od-Persona-presence{right:-.0625rem}[dir=rtl] .od-Persona.od-Persona--sm .od-Persona-presence{left:-.0625rem}.od-Persona.od-Persona--sm .od-Persona-primaryText{font-size:.875rem;padding:0}.od-Persona.od-Persona--sm .od-Persona-secondaryText{padding:0;margin-top:.3125rem}.od-Persona.od-Persona--lg .od-Persona-image,.od-Persona.od-Persona--lg .od-Persona-imageArea,.od-Persona.od-Persona--lg .od-Persona-imageCircle{width:4.5rem;height:4.5rem}.od-Persona.od-Persona--lg .od-Persona-imageArea{height:4.875rem}[dir=ltr] .od-Persona.od-Persona--lg .od-Persona-imageArea{margin-right:.75rem}[dir=rtl] .od-Persona.od-Persona--lg .od-Persona-imageArea{margin-left:.75rem}.od-Persona.od-Persona--lg .od-Persona-image{line-height:4.5rem;font-size:1.75rem}.od-Persona.od-Persona--lg .od-Persona-details{padding-top:.375rem}[dir=ltr] .od-Persona.od-Persona--lg .od-Persona-imageArea{margin-right:.625rem}[dir=rtl] .od-Persona.od-Persona--lg .od-Persona-imageArea{margin-left:.625rem}.od-Persona.od-Persona--lg .od-Persona-placeholder{font-size:4.25rem;top:.625rem}[dir=ltr] .od-Persona.od-Persona--lg .od-Persona-placeholder{left:-.3125rem}[dir=rtl] .od-Persona.od-Persona--lg .od-Persona-placeholder{right:-.3125rem}.od-Persona.od-Persona--lg .od-Persona-presence{height:1.25rem;width:1.25rem;bottom:.25rem;border-width:.1875rem}[dir=ltr] .od-Persona.od-Persona--lg .od-Persona-presence{right:-.125rem}[dir=rtl] .od-Persona.od-Persona--lg .od-Persona-presence{left:-.125rem}.od-Persona.od-Persona--lg .od-Persona-primaryText{font-weight:400;line-height:.75rem}.od-Persona.od-Persona--lg .od-Persona-tertiaryText{display:block}.od-Persona.od-Persona--lg .od-Persona-optionalText,.od-Persona.od-Persona--lg .od-Persona-secondaryText,.od-Persona.od-Persona--lg .od-Persona-sharingRole-Text,.od-Persona.od-Persona--lg .od-Persona-tertiaryText{line-height:.75rem;margin-top:.5rem;margin-bottom:0}.od-Persona.od-Persona--xl .od-Persona-image,.od-Persona.od-Persona--xl .od-Persona-imageArea,.od-Persona.od-Persona--xl .od-Persona-imageCircle{width:6.25rem;height:6.25rem}[dir=ltr] .od-Persona.od-Persona--xl .od-Persona-imageArea{margin-right:1.25rem}[dir=rtl] .od-Persona.od-Persona--xl .od-Persona-imageArea{margin-left:1.25rem}.od-Persona.od-Persona--xl .od-Persona-image{line-height:6.25rem;font-size:1.75rem}.od-Persona.od-Persona--xl .od-Persona-placeholder{font-size:5.9375rem;top:.75rem}.od-Persona.od-Persona--xl .od-Persona-presence{height:1.75rem;width:1.75rem;border-width:.25rem}.od-Persona.od-Persona--xl .od-Persona-primaryText{font-size:1.25rem;font-weight:300;margin-top:.125rem}.od-Persona.od-Persona--xl .od-Persona-secondaryText{padding-top:.4375rem}.od-Persona.od-Persona--xl .od-Persona-optionalText,.od-Persona.od-Persona--xl .od-Persona-tertiaryText{padding-top:.5rem;display:block}.od-Persona.od-Persona--xxl .od-Persona-image,.od-Persona.od-Persona--xxl .od-Persona-imageArea,.od-Persona.od-Persona--xxl .od-Persona-imageCircle{width:7.5rem;height:7.5rem}[dir=ltr] .od-Persona.od-Persona--xxl .od-Persona-imageArea{margin-right:1.25rem}[dir=rtl] .od-Persona.od-Persona--xxl .od-Persona-imageArea{margin-left:1.25rem}.od-Persona.od-Persona--xxl .od-Persona-image{line-height:7.5rem;font-size:1.75rem}.od-Persona.od-Persona--xxl .od-Persona-placeholder{font-size:5.9375rem;top:.75rem}.od-Persona.od-Persona--xxl .od-Persona-presence{height:1.75rem;width:1.75rem;border-width:.25rem}.od-Persona.od-Persona--xxl .od-Persona-primaryText{font-size:1.75rem;font-weight:300;margin-top:.125rem}.od-Persona.od-Persona--xxl .od-Persona-secondaryText{padding-top:.4375rem}.od-Persona.od-Persona--xxl .od-Persona-optionalText,.od-Persona.od-Persona--xxl .od-Persona-tertiaryText{padding-top:.5rem;display:block}.od-Persona.od-Persona--darkText .od-Persona-primaryText{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-Persona.od-Persona--darkText .od-Persona-optionalText,.od-Persona.od-Persona--darkText .od-Persona-secondaryText,.od-Persona.od-Persona--darkText .od-Persona-tertiaryText{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}"}])}],Array(19),[function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(1649),s=n(76),o=n(11),u=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._commandDataSource=n.itemCommandDataSource;return r}t.prototype.getCommand=function(e,t){return this._commandDataSource.getCommand(e,t)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{itemCommandDataSource:s.O});return t})(i.n),a=Object(o.s)("ItemCommandProvider",u)},,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(1419),i=n(1949),s=n(1822),o=Object(r.e)(i.e,s.e,void 0,{scope:"TeachingBubble"})},function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(0),i=n(46),s=n(1649),o=n(11),u=n(103),a=n(63),f=n(108),l=n(218),c=n(1011),h=n(717),p=n(149),d={campaignGuid:"00000000-0000-0000-0000-000000000000",endDate:new Date(1970,1,1),flag:i.Off,isCoachmark:!0},v=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._dataStore=new u.e("CoachmarkProvider",a.e.session);r._currentCampaign=r.createObservable(d);r._isVisible=r.createObservable(!1);r._navigation=n.navigation;r._firstRunExperienceStatus=n.firstRunExperienceStatus;r._currentTeachingBubble=r.createObservable({campaign:r._currentCampaign,isVisible:r._isVisible});r._navigation.viewParams.resetAllBubbles&&r._dataStore.remove("CoachmarkTearDropSeen");var i=r.resources.consume(p.e);r._teachingBubbleProviderPromise=i.waitForPLT().then(function(){return r.resources.consume(l.T)});return r}Object.defineProperty(t.prototype,"isVisible",{get:function(){return this._isVisible},enumerable:!1,configurable:!0});Object.defineProperty(t.prototype,"currentCampaign",{get:function(){return this._currentCampaign},enumerable:!1,configurable:!0});t.prototype.hideCampaign=function(){this._isVisible(!1);this._currentCampaign(d)};t.prototype.setCampaign=function(e){var t=this;if(e){if(this._firstRunExperienceStatus.get()!==h.e.visible){var n=e.name+"CoachmarkTearDropSeen";this._dataStore.getValue("CoachmarkTearDropSeen")||this._teachingBubbleProviderPromise.then(function(r){r&&r.shouldBubbleBeAdded(e,!1).then(function(r){if(r){t._currentCampaign(e);t._isVisible(!0);t._dataStore.setValue(n,!0)}})})}}else{this._currentCampaign(d);this._isVisible(!1)}};t.prototype.getCurrentTeachingBubble=function(){return this._currentTeachingBubble};t.dependencies=Object(r.__assign)(Object(r.__assign)({},s.n.dependencies),{navigation:f.e,firstRunExperienceStatus:c.e});return t})(s.n),m=Object(o.s)("CoachmarkProvider",v)},function(e,t,n){"use strict";var r=(function(){function e(){}e.htmlDecodeFromString=function(e){var t=e,n=(new DOMParser).parseFromString(t,"text/html");return t=n&&n.body&&n.body.innerText?n.body.innerText:t};e.isIE11=function(){return!!window.MSInputMethodContext&&!!document.documentMode};e.isFireFox=function(){return"undefined"!=typeof InstallTrigger};return e})();t.e=r},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.succeed=0]="succeed";e[e.unsupport=1]="unsupport";e[e.failed=2]="failed"})(r||(r={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(7),i=n(1649),s=n(1071),o=n(733),u=new r.t({name:"isOfflineStateLegacyKOObservable.key.isOfflineStateLegacyKOObservable",factory:{dependencies:{observablesFactoryTypeKey:i.i,isOfflineStateObservable:s.e},create:function(e){var t=e.isOfflineStateObservable,n=new o.e,r=n.attach(new e.observablesFactoryTypeKey).create(t.get());n.attach({dispose:t.subscribe(function(){r(t.get())})});return{instance:r,disposable:n}}}})},function(e,t,n){"use strict";(function(){if("object"==typeof window)if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});else{var e=(function(e){for(var t=window.document,n=o(t);n;)n=o(t=n.ownerDocument);return t})(),t=[],n=null,r=null,i=function(e){this.time=e.time;this.target=e.target;this.rootBounds=l(e.rootBounds);this.boundingClientRect=l(e.boundingClientRect);this.intersectionRect=l(e.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0});this.isIntersecting=!!e.intersectionRect;var t=this.boundingClientRect,n=t.width*t.height,r=this.intersectionRect,i=r.width*r.height;this.intersectionRatio=n?Number((i/n).toFixed(4)):this.isIntersecting?1:0},s=(function(){function s(e,t){this.THROTTLE_TIMEOUT=100;this.POLL_INTERVAL=null;this.USE_MUTATION_OBSERVER=!0;var n,r,i,s=t||{};if("function"!=typeof e)throw new Error("callback must be a function");if(s.root&&1!=s.root.nodeType&&9!=s.root.nodeType)throw new Error("root must be a Document or Element");this._checkForIntersections=(n=this._checkForIntersections.bind(this),r=this.THROTTLE_TIMEOUT,i=null,function(){i||(i=setTimeout(function(){n();i=null},r))});this._callback=e;this._observationTargets=[];this._queuedEntries=[];this._rootMarginValues=this._parseRootMargin(s.rootMargin);this.thresholds=this._initThresholds(s.threshold);this.root=s.root||null;this.rootMargin=this._rootMarginValues.map(function(e){return e.value+e.unit}).join(" ");this._monitoringDocuments=[];this._monitoringUnsubscribes=[]}s.prototype._setupCrossOriginUpdater=function(){n||(n=function(e,n){r=e&&n?c(e,n):{top:0,bottom:0,left:0,right:0,width:0,height:0};t.forEach(function(e){e._checkForIntersections()})});return n};s.prototype._resetCrossOriginUpdater=function(){n=null;r=null};s.prototype.observe=function(e){if(!this._observationTargets.some(function(t){return t.element==e})){if(!e||1!=e.nodeType)throw new Error("target must be an Element");this._registerInstance();this._observationTargets.push({element:e,entry:null});this._monitorIntersections(e.ownerDocument);this._checkForIntersections()}};s.prototype.unobserve=function(e){this._observationTargets=this._observationTargets.filter(function(t){return t.element!=e});this._unmonitorIntersections(e.ownerDocument);0==this._observationTargets.length&&this._unregisterInstance()};s.prototype.disconnect=function(){this._observationTargets=[];this._unmonitorAllIntersections();this._unregisterInstance()};s.prototype.takeRecords=function(){var e=this._queuedEntries.slice();this._queuedEntries=[];return e};s.prototype._initThresholds=function(e){var t=e||[0];Array.isArray(t)||(t=[t]);return t.sort().filter(function(e,t,n){if("number"!=typeof e||isNaN(e)||e<0||e>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return e!==n[t-1]})};s.prototype._parseRootMargin=function(e){var t=(e||"0px").split(/\s+/).map(function(e){var t=/^(-?\d*\.?\d+)(px|%)$/.exec(e);if(!t)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(t[1]),unit:t[2]}});t[1]=t[1]||t[0];t[2]=t[2]||t[0];t[3]=t[3]||t[1];return t};s.prototype._monitorIntersections=function(t){var n=t.defaultView;if(n&&-1==this._monitoringDocuments.indexOf(t)){var r=this._checkForIntersections,i=null,s=null;if(this.POLL_INTERVAL)i=n.setInterval(r,this.POLL_INTERVAL);else{u(n,"resize",r,!0);u(t,"scroll",r,!0);this.USE_MUTATION_OBSERVER&&"MutationObserver"in n&&(s=new n.MutationObserver(r)).observe(t,{attributes:!0,childList:!0,characterData:!0,subtree:!0})}this._monitoringDocuments.push(t);this._monitoringUnsubscribes.push(function(){var e=t.defaultView;if(e){i&&e.clearInterval(i);a(e,"resize",r,!0)}a(t,"scroll",r,!0);s&&s.disconnect()});var f=this.root&&(this.root.ownerDocument||this.root)||e;if(t!=f){var l=o(t);l&&this._monitorIntersections(l.ownerDocument)}}};s.prototype._unmonitorIntersections=function(t){var n=this._monitoringDocuments.indexOf(t);if(-1!=n){var r=this.root&&(this.root.ownerDocument||this.root)||e;if(!this._observationTargets.some(function(e){var n=e.element.ownerDocument;if(n==t)return!0;for(;n&&n!=r;){var i=o(n);if((n=i&&i.ownerDocument)==t)return!0}return!1})){var i=this._monitoringUnsubscribes[n];this._monitoringDocuments.splice(n,1);this._monitoringUnsubscribes.splice(n,1);i();if(t!=r){var s=o(t);s&&this._unmonitorIntersections(s.ownerDocument)}}}};s.prototype._unmonitorAllIntersections=function(){var e=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0;this._monitoringUnsubscribes.length=0;for(var t=0;t<e.length;t++)e[t]()};s.prototype._checkForIntersections=function(){if(this.root||!n||r){var e=this._rootIsInDom(),t=e?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach(function(r){var s=r.element,o=f(s),u=this._rootContainsTarget(s),a=r.entry,l=e&&u&&this._computeTargetAndRootIntersection(s,o,t),c=null;this._rootContainsTarget(s)?n&&!this.root||(c=t):c={top:0,bottom:0,left:0,right:0,width:0,height:0};var h=r.entry=new i({time:window.performance&&performance.now&&performance.now(),target:s,boundingClientRect:o,rootBounds:c,intersectionRect:l});a?e&&u?this._hasCrossedThreshold(a,h)&&this._queuedEntries.push(h):a&&a.isIntersecting&&this._queuedEntries.push(h):this._queuedEntries.push(h)},this);this._queuedEntries.length&&this._callback(this.takeRecords(),this)}};s.prototype._computeTargetAndRootIntersection=function(t,i,s){if("none"!=window.getComputedStyle(t).display){for(var o,u,a,l,h,d,v,m,g=i,y=p(t),b=!1;!b&&y;){var w=null,E=1==y.nodeType?window.getComputedStyle(y):{};if("none"==E.display)return null;if(y==this.root||9==y.nodeType){b=!0;if(y==this.root||y==e)if(n&&!this.root)if(!r||0==r.width&&0==r.height){y=null;w=null;g=null}else w=r;else w=s;else{var S=p(y),x=S&&f(S),T=S&&this._computeTargetAndRootIntersection(S,x,s);if(x&&T){y=S;w=c(x,T)}else{y=null;g=null}}}else{var N=y.ownerDocument;y!=N.body&&y!=N.documentElement&&"visible"!=E.overflow&&(w=f(y))}w&&(g=(o=w,u=g,a=void 0,l=void 0,h=void 0,d=void 0,v=void 0,m=void 0,a=Math.max(o.top,u.top),l=Math.min(o.bottom,u.bottom),h=Math.max(o.left,u.left),d=Math.min(o.right,u.right),m=l-a,(v=d-h)>=0&&m>=0&&{top:a,bottom:l,left:h,right:d,width:v,height:m}||null));if(!g)break;y=y&&p(y)}return g}};s.prototype._getRootRect=function(){var t;if(this.root&&!d(this.root))t=f(this.root);else{var n=d(this.root)?this.root:e,r=n.documentElement,i=n.body;t={top:0,left:0,right:r.clientWidth||i.clientWidth,width:r.clientWidth||i.clientWidth,bottom:r.clientHeight||i.clientHeight,height:r.clientHeight||i.clientHeight}}return this._expandRectByRootMargin(t)};s.prototype._expandRectByRootMargin=function(e){var t=this._rootMarginValues.map(function(t,n){return"px"==t.unit?t.value:t.value*(n%2?e.width:e.height)/100}),n={top:e.top-t[0],right:e.right+t[1],bottom:e.bottom+t[2],left:e.left-t[3],height:0,width:0};n.width=n.right-n.left;n.height=n.bottom-n.top;return n};s.prototype._hasCrossedThreshold=function(e,t){var n=e&&e.isIntersecting?e.intersectionRatio||0:-1,r=t.isIntersecting?t.intersectionRatio||0:-1;if(n!==r)for(var i=0;i<this.thresholds.length;i++){var s=this.thresholds[i];if(s==n||s==r||s<n!=s<r)return!0}};s.prototype._rootIsInDom=function(){return!this.root||h(e,this.root)};s.prototype._rootContainsTarget=function(t){var n=this.root&&(this.root.ownerDocument||this.root)||e;return h(n,t)&&(!this.root||n==t.ownerDocument)};s.prototype._registerInstance=function(){t.indexOf(this)<0&&t.push(this)};s.prototype._unregisterInstance=function(){var e=t.indexOf(this);-1!=e&&t.splice(e,1)};return s})();window.IntersectionObserver=s;window.IntersectionObserverEntry=i}function o(e){try{return e.defaultView&&e.defaultView.frameElement||null}catch(e){return null}}function u(e,t,n,r){"function"==typeof e.addEventListener?e.addEventListener(t,n,r||!1):"function"==typeof e.attachEvent&&e.attachEvent("on"+t,n)}function a(e,t,n,r){"function"==typeof e.removeEventListener?e.removeEventListener(t,n,r||!1):"function"==typeof e.detatchEvent&&e.detatchEvent("on"+t,n)}function f(e){var t;try{t=e.getBoundingClientRect()}catch(e){}if(!t)return{top:0,bottom:0,left:0,right:0,width:0,height:0};t.width&&t.height||(t={top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top});return t}function l(e){return!e||"x"in e?e:{top:e.top,y:e.top,bottom:e.bottom,left:e.left,x:e.left,right:e.right,width:e.width,height:e.height}}function c(e,t){var n=t.top-e.top,r=t.left-e.left;return{top:n,left:r,height:t.height,width:t.width,bottom:n+t.height,right:r+t.width}}function h(e,t){for(var n=t;n;){if(n==e)return!0;n=p(n)}return!1}function p(t){var n=t.parentNode;if(9==t.nodeType&&t!=e)return o(t);n&&n.assignedSlot&&(n=n.assignedSlot.parentNode);return n&&11==n.nodeType&&n.host?n.host:n}function d(e){return e&&9===e.nodeType}})()},function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e,t){var n=t?document.createElement("textarea"):document.createElement("input");if(t)n.innerHTML=e;else{n.setAttribute("type","text");n.setAttribute("value",e)}document.body.appendChild(n);var r=!1;try{n.focus();n.select();r=document.execCommand("copy")}catch(e){}if(!r&&window.navigator&&window.navigator.clipboard)try{window.navigator.clipboard.writeText(n.value);r=!0}catch(e){}document.body.removeChild(n);return r}},function(e,t,n){"use strict";var r=n(0),i=n(1830),s=n(1794),o=n(1819),u=n(2036),a=(function(e){Object(r.__extends)(t,e);function t(t,n){return e.call(this,t,n)||this}t.dependencies={sharingProvider:s.resourceKey,suiteNavProvider:o.resourceKey,peoplePickerProvider:i.t,policyTipProvider:u.e};return t})(n(2175).e);t.e=a}],Array(15),[function(e,t,n){"use strict";n.d(t,"e",function(){return T});var r=n(0),i=n(2367),s=n(138);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-AtMention{max-height:550px;min-height:150px;overflow-y:auto;position:relative;min-width:320px}.od-AtMention ul{list-style-type:none;list-style:none;margin:0;padding:0}.od-AtMention li{-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;padding-bottom:8px}[dir='ltr'] .od-AtMention li{padding-right:4px}[dir='rtl'] .od-AtMention li{padding-left:4px}.od-AtMention.od-AtMention--isSharing{position:relative}.od-AtMention.od-AtMention--isSharing:after{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";bottom:0;content:'';left:0;opacity:0.8;position:absolute;right:0;top:0}.od-AtMention .od-AtMention-container{display:inline-block;padding:16px 16px 0px 16px;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:"},{theme:"menuBackground",defaultValue:"#ffffff"},{rawString:";width:100%}.od-AtMention .od-AtMention-recipients{margin-bottom:16px;max-height:200px;overflow-y:auto}.od-AtMention .od-AtMention-recipients li>.od-AtMention-recipient{font:-apple-system-headline}.od-AtMention .od-AtMention-recipients--error{margin-top:16px}.od-AtMention .od-AtMention-recipients--error li>.od-AtMention-recipient--error{border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";border-style:solid;border-width:thin}.od-AtMention .od-AtMention-recipients--error li>.od-AtMention-recipient--error .ms-Persona-primaryText{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";font:-apple-system-body}.od-AtMention .od-AtMention-recipient{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-radius:16px;font:-apple-system-body}.od-AtMention div.od-AtMention-message{margin-bottom:16px;font:-apple-system-body;font-size:.875rem}.od-AtMention .od-AtMention-button{margin-bottom:16px;font:-apple-system-headline}.od-AtMention .od-AtMention-button-rounded{margin-bottom:16px;font:-apple-system-headline;height:2.75rem;border-radius:8px}.od-AtMention .od-AtMention-spinnerHolder{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;height:150px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.od-AtMention .od-Share-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}@media (inverted-colors){.od-AtMention .od-AtMention-button:focus,.od-AtMention .od-AtMention-button:hover{outline:2px solid}}\n"}]);var o=n(1809),u=n(1745),a=n(1972),f=n(1737),l=n(1670),c=n(2051),h=n(1772),p=n(1729),d=n(1637),v=n(390),m=n(1654),g=n(1667),y=n("react-lib"),b=n("prop-types-lib"),w=n(1758),E=n(1753),S=n(1738),x={root:{height:"unset",minHeight:"2rem",padding:"0 1rem"},label:{fontSize:"0.875rem"}},T=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._topLevelDivRef=y.createRef();r._onShareClicked=function(){r.setState({isSharing:!0},function(){r._store.getEngagementHelper().shareCompleted({clientId:r.props.clientId,scenarioId:r.props.scenarioId,mode:i.e.atMention});r._store.grantAccess(r.props.recipients)})};r._onOkayClicked=function(){r._notifyGrantAccessCompleted(!1);r._dismiss()};r._dismiss=n.onDismiss;r._resize=n.resize;r._store=n.sharingStore;r._platformDetection=n.platformDetection;r._shareClickTime=n.shareClickTime;var s=0===t.recipients.length;s||r._notifyReady();r.state={canShare:r._canShare(t.recipients),isLoading:s,isSharing:!1};r._resizeTracker=new S.e(n.resize);return r}t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=0===e.recipients.length;this.state.isLoading&&!t&&this._notifyReady();this.setState({canShare:this._canShare(e.recipients),isLoading:t})};t.prototype.componentDidUpdate=function(){this._resizeIfNeeded()};t.prototype.componentDidMount=function(){var e=this;this._notifyReadyForRecipients();this._store.addListener(function(){var t=e._store.getGrantAccessResult();if(null!==t){e._notifyGrantAccessCompleted(t);e.props.onComplete&&e.props.onComplete(!!t);e._dismiss()}});this._resizeIfNeeded()};t.prototype.render=function(){var e,t=this.state,n=t.canShare,s=t.isLoading,o=t.isSharing;e=s?this._renderLoadingSpinner():n?this._renderHappyPath():this._renderSadPath();return y.createElement("div",{ref:this._topLevelDivRef,className:"od-AtMention "+(o?"od-AtMention--isSharing":"")},!s&&y.createElement(u.e,Object(r.__assign)({},Object(p.e)(this.props),{mode:i.e.atMention,viewState:5})),e,this._renderSharingActivityIndicator(),E.e(this._getScreenReaderAlertMessage(),"assertive","alert"))};t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)};t.prototype._renderLoadingSpinner=function(){return y.createElement("div",{className:"od-AtMention-spinnerHolder"},y.createElement(d.e,{className:"od-AtMention-spinner",label:m.Te,type:v.t.large,styles:{circle:{width:"1.75rem",height:"1.75rem",borderWidth:"0.09375rem"},label:{fontSize:"0.75rem"}}}))};t.prototype._renderSharingActivityIndicator=function(){if(this.state.isSharing)return y.createElement(o.e,{message:m.qt})};t.prototype._renderHappyPath=function(){var e=this._platformDetection.isIOS?"od-AtMention-button-rounded":"od-AtMention-button",t=this._getHappyMessage();return y.createElement("div",{className:"od-AtMention-container"},this._renderRecipients(!1),y.createElement("div",{className:"od-AtMention-message"},t),y.createElement(h.e,{autoFocus:!0,className:e,onClick:this._onShareClicked,"aria-label":m.Ms,styles:x},m.Ms))};t.prototype._renderSadPath=function(){var e=this._platformDetection.isIOS?"od-AtMention-button-rounded":"od-AtMention-button";return y.createElement("div",{className:"od-AtMention-container"},y.createElement(a.e,{messageBarType:f.e.warning,styles:{icon:{fontSize:"1rem",minWidth:"1rem",minHeight:"1rem"},text:{fontSize:"0.75rem",lineHeight:"1rem"},innerText:{lineHeight:"1rem"}}},this._getSadMessage()),this._renderRecipients(!0),y.createElement(h.e,{autoFocus:!0,className:e,onClick:this._onOkayClicked,"aria-label":m.Ms,styles:x},m.pr))};t.prototype._renderRecipients=function(e){var t=this,n=this.props.recipients.map(function(e){var n=t._isRecipientInvalid(e),i={imageUrl:e.image,primaryText:e.name,size:l.n.extraSmall,coinProps:{styles:{coin:{width:"2.5rem",height:"2.5rem",maxWidth:"75px",maxHeight:"75px"},image:{width:"2.5rem !important",height:"2.5rem !important",maxWidth:"75px",maxHeight:"75px"},imageArea:{width:"2.5rem",height:"2.5rem",maxWidth:"75px",maxHeight:"75px"}}},styles:{root:{height:"2.5rem"},primaryText:{fontSize:"0.875rem"},secondaryText:{fontSize:"0.75rem"}}};return y.createElement("li",null,y.createElement(c.e,Object(r.__assign)({},i,{className:"od-AtMention-recipient "+(n?"od-AtMention-recipient--error":"")})))});return y.createElement("ul",{className:"od-AtMention-recipients "+(e?"od-AtMention-recipients--error":""),"aria-label":m.Ut},n)};t.prototype._getScreenReaderAlertMessage=function(){return this.state.isSharing?m.qt:m.Rt};t.prototype._canShare=function(e){var t=this,n=this.props.sharingInformation;return!!n.canManagePermissions&&(!!n.canAddInternalPrincipal&&e.every(function(e){return!t._isRecipientInvalid(e)}))};t.prototype._isRecipientInvalid=function(e){return!e.isResolved||e.isExternal&&!e.providerName};t.prototype._notifyReady=function(){w.l(this._shareClickTime,this.props.clientId,i.e.atMention,this.props.scenarioId,this.props.correlationId)};t.prototype._notifyReadyForRecipients=function(){w.h()};t.prototype._notifyGrantAccessCompleted=function(e){w.i(e)};t.prototype._getHappyMessage=function(){return this._store.isConsumer()?m.W:this._store.isListItem()?m.z:g.a(this.props.clientId)?m.X:m.U};t.prototype._getSadMessage=function(){if(this._store.isConsumer())return m.K;var e=this.props.sharingInformation,t=g.a(this.props.clientId)?m.$:m.V;return e.canManagePermissions&&e.canAddInternalPrincipal?m.J:t};t.contextTypes={onDismiss:b.func.isRequired,resize:b.func.isRequired,sharingStore:b.object.isRequired,platformDetection:b.object.isRequired,shareClickTime:b.number};return t})(y.Component)},function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return X});var r=n(0),i=n(52),s=n(1669),o=n(219),u=n(1690),a=n(2016),f=n(1649),l=n("knockout-lib"),c=n(1812),h=n(66),p=n(72),d=n(2441),v=n(22),m=n(726),g=n(178),y=n(289),b=n(76),w=n(49),E=n(291),S=n(2341),x=n(290),T=n(1001),N=n(46),C=n(1766),k=n(970),L=n(1656),A=n(1438),O=n(11),M=n(608),_=n(3024),D=n(108),P=n(13),H="0x0120",B=1,j=2,F=4,I=8,q=32,R=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,n.pageContext,n)||this;r._clientForms=null;r._listContext=n.listContext;r._itemsDataSource=n.items;r._navigation=n.navigation;r._complianceTagDataSource=n.compliance;r._itemUrlHelper=n.itemUrlHelper;r._apiUrlHelper=n.apiUrlHelper;return r}t.prototype.createItem=function(e,t){var n=this,r=this._getUrlInfo(),i=r.listUrl,s=r.itemUrlParts,o="AddValidateUpdateItemUsingPath",u=t?t+".CreateItem":"CreateItem";return this._createOrUpdateItem(u,function(){return n._apiUrlHelper.build().webByItemUrl(s).method("GetList",i).method(o).toString()},function(t){var n=e.rootFolder||i;return JSON.stringify({listItemCreateInfo:{__metadata:{type:"SP.ListItemCreationInformationUsingPath"},FolderPath:{__metadata:{type:"SP.ResourcePath"},DecodedUrl:n}},formValues:t,bNewDocumentUpdate:e.newDocumentUpdate,checkInComment:e.checkInComment})},e,o).then(function(){return n._updateAttachmentsField(e)})};t.prototype.updateItem=function(e,t){var n=this,r=e.clientForm.isBulkEdit&&e.selection&&e.selection.length>1?e.selection:void 0;r&&r.filter(function(e){return!!e});var i=r&&r.length>0,s=t?t+".UpdateItem":"UpdateItem";return this._createOrUpdateItem(s,function(e){var t=n._getUrlInfo(),r=t.listUrl,s=t.itemUrlParts;return i?n._apiUrlHelper.build().webByItemUrl(s).method("GetList",r).method("BulkValidateUpdateListItems").toString():n._apiUrlHelper.build().webByItemUrl(s).method("GetList",r).method("items",e.peek().properties.ID).method("ValidateUpdateListItem").toString()},function(t){var s,o;if(i){s=[];for(var u=0,a=r;u<a.length;u++){var f=a[u];s.push(parseInt(f.peek().properties.ID,10))}if(!e.isRecursiveView){var l=(f=e.clientForm.item.peek())&&f.parent;o=l&&n._itemUrlHelper.getItemUrlParts(l.key).normalizedItemUrl}}return JSON.stringify({itemIds:s,formValues:t,bNewDocumentUpdate:e.newDocumentUpdate,checkInComment:e.checkInComment,folderPath:o})},e,i?"BulkValidateUpdateListItems":"ValidateUpdateListItem",r).then(function(t){return n._updateAttachmentsField(e).then(function(){return t})})};t.prototype.getClientFormSchema=function(e,t,n){var s=this,o=function(){var i=s._locateClientFormWithContentTypeInfos(e,t);if(n&&i&&i.fields){var o=i.fields.filter(function(e){var t=e.FieldType.toLowerCase(),n=e.Name;return"file"!==t&&"attachments"!==t&&"Title"!==n&&"LinkTitle"!==n&&"LinkTitleNoMenu"!==n});return Object(r.__assign)(Object(r.__assign)({},i),{fields:o})}return i};if(null===this._clientForms||this._listContext.refreshClientForm){this._listContext.refreshClientForm=void 0;return this.fetchAllClientFormSchemas().then(function(){return o()})}return i.n.wrap(o())};t.prototype.updateFormValues=function(e,t){var n=this,r=e.item.peek();if(!r||!r.properties||!r.properties.ID)return i.n.wrap();for(var s=[],o=0,u=e.fields;o<u.length;o++){var a=u[o];0===a.state.peek()&&s.push(a)}return this._getData({url:(function(){var e=r.properties.ID,t=p.e.encodeRestUriStringToken(n._listContext.listUrl),i=B+j+F;i+=I;Object(N.isFeatureEnabled)(N.ClientFormImageField)&&(i+=q);var s=",cutoffVersion="+(new h.t(window.location.href,{queryCaseInsensitive:!0}).getQueryParameter("VersionNo")||"0");return n._pageContext.webAbsoluteUrl+"/_api/web/GetList(@v1)/RenderExtendedListFormData(itemId="+e+",formId='editform',mode='2',options="+i+s+")?@v1='"+t+"'"})(),parseResponse:function(e){if(null!=e){var t=JSON.parse(e);if(t.d.RenderExtendedListFormData){try{t=JSON.parse(t.d.RenderExtendedListFormData)}catch(e){return i.n.reject(e)}return t}}return null},qosName:"GetItemDataForClientForm",method:"POST",additionalHeaders:this._getAdditionalHeaders()}).then(function(r){n._handleServerData(e,r,t,s);for(var i=0,o=s;i<o.length;i++){o[i].state(0)}},function(e){for(var t=e?e.code?e.code.split(","):e.error?e.error.code.split(","):[]:[],n=e||t.length>1?Number(t[0]):-1,r=0,o=s;r<o.length;r++){o[r].state(0)}return i.n.wrapError({errorCode:n,message:e&&e.message?e.message.value?e.message.value:e.message:""})})};t.prototype.getFieldValueSuggestions=function(e,t,n,r){n=n||5;r=M.e.encodeText(r);var s=this._getSuggestionsViewXml(e,t,!0,n,r),o=this._getSuggestionsViewXml(e,t,!1,n,r),u=this._getAdditionalHeaders(),a=function(t){var n=JSON.parse(t);return n&&n.Row&&n.Row.length>0?n.Row.map(function(t){var n=t[e];return"string"==typeof n||n instanceof String?t[e].trim():JSON.stringify(t[e])}):[]},f=this._getData({url:this._getServerConnectionUrl().toString(),parseResponse:a,qosName:"GetLatestFieldValueModifiedByMe",additionalPostData:g.e.getAdditionalPostData({needsSchema:!1,viewXml:s}),method:"POST",additionalHeaders:u}),l=this._getData({url:this._getServerConnectionUrl().toString(),parseResponse:a,qosName:"GetLatestFieldValueModifiedByOther",additionalPostData:g.e.getAdditionalPostData({needsSchema:!1,viewXml:o}),method:"POST",additionalHeaders:u});return i.n.all([f,l]).then(function(e){for(var t={},r=[],i=0,s=e;i<s.length;i++)for(var o=0,u=s[i];o<u.length;o++){var a=u[o];if(!t[a]){r.push(a);t[a]=!0;if(r.length===n)return r}}return r})};t.prototype.getFieldFilterData=function(e,t){var n=E.t(this._navigation.viewParams);return this._itemsDataSource.getFilterData(e,n,t)};t.prototype.getContentTypes=function(e){var t=[];if(this._clientForms&&this._clientForms[e])for(var n in this._clientForms[e])this._clientForms[e].hasOwnProperty(n)&&t.push({displayName:n,description:n,templateUrl:null});return t};t.prototype.hasFormRenderMode=function(e){var t=this;return this._ensureClientForms(function(){return t._checkRenderModes(e)})};t.prototype.getFormRenderMode=function(e,t){var n=this;return this._ensureClientForms(function(){return n._getFormRenderMode(e,t)})};t.prototype.getPowerAppFormId=function(){return this._powerAppFormId};t.prototype.getPowerAppRenderInfo=function(){return this._powerAppFormInfo};t.prototype.getPowerAppAdditionalData=function(){return this._powerAppAdditionalData};t.prototype.getPowerAppFormCacheInfo=function(){return this._powerAppFormCacheInfo};t.prototype.getPowerAppFormDesignUrl=function(e){var t=this;return this._getData({url:t._pageContext.webAbsoluteUrl+"/_api/SP.Internal.FormsCustomization.GetPowerAppsFormDesignUrl?listName='"+e+"'&visualizationTarget=1",parseResponse:function(e){var t=JSON.parse(e),n="";t.d&&t.d.Value&&(n=JSON.parse(t.d.Value));return n},qosName:"GetPowerAppFormDesignUrl",method:"GET"})};t.prototype.fetchAllClientFormSchemas=function(e){var t=this;void 0===e&&(e=!1);this._clientFormsDebouncer||(this._clientFormsDebouncer=new L.e);this._clientFormsDebouncer.isExecuting()&&!e||(this._clientFormsPromise=this._clientFormsDebouncer.debounce(this._getData({url:this._getServerConnectionUrl().toString(),parseResponse:function(e){t._clientForms={};var n=JSON.parse(e);n.ContentTypeIdToNameMap&&(t._contentTypeIdToNameMap=n.ContentTypeIdToNameMap);n.ClientFormCustomFormatter&&(t._ctIdToClientFormCustomFormatter=n.ClientFormCustomFormatter);var r=n.ClientForms;if(r){r.New&&t._processClientFormResponse(2,r.New);if(r.Edit){t._processClientFormResponse(1,r.Edit);t._processClientFormResponse(3,r.Edit)}}n.Navigation&&(t._listContext.leftNavigationData={quickLaunchNodes:n.Navigation.Nodes});void 0!==n.EnableAttachments&&(t._listContext.enableAttachments=n.EnableAttachments);n.FormRenderModes&&t._processFormRenderMode(n.FormRenderModes);(n.PowerAppFormId||n.AppId)&&(t._powerAppFormId=n.PowerAppFormId||n.AppId);n.AppRenderInfo&&(t._powerAppFormInfo=n.AppRenderInfo||{});n.AppAdditionalData&&(t._powerAppAdditionalData=n.AppAdditionalData);n.CachedFileUrlTemplate&&n.CacheAppFiles&&(t._powerAppFormCacheInfo=JSON.stringify({appFiles:n.CacheAppFiles,cachedFileUrlTemplate:n.CachedFileUrlTemplate}))},qosName:"GetClientForms",additionalPostData:g.e.getAdditionalPostData({needsSchema:!1,viewXml:'<View><ViewFields><FieldRef Name="ID"/></ViewFields></View>',needsForms:!0,needsQuickLaunch:!1}),method:"POST",additionalHeaders:this._getAdditionalHeaders(),noRedirect:!0})));return this._clientFormsPromise};t.prototype.getDataSourceName=function(){return"ClientFormDataSource"};t.prototype._processClientFormResponse=function(e,t){this._clientForms[e]||(this._clientForms[e]={});var n=this._clientForms[e];for(var r in t)if(t.hasOwnProperty(r)&&!n[r]){var i=this._reverseLookupContentTypeIdByName(r),s=this._ctIdToClientFormCustomFormatter?this._ctIdToClientFormCustomFormatter[i]:void 0;n[r]={contentType:r,contentTypeId:i,formType:e,fields:[],clientFormCustomFormatter:s?JSON.parse(s):void 0,mode:0};for(var o=n[r],u=t[r],a=0,f=u.length;a<f;a++)o.fields.push(u[a])}this._clientForms[e]=n};t.prototype._getServerConnectionUrl=function(e){var t=this._itemUrlHelper.getUrlParts({listUrl:this._listContext.listUrl});return m.t({webUrl:this._pageContext.webAbsoluteUrl,listId:this._listContext.listId,urlParts:t,rootFolder:this._listContext.folderPath,requestToken:"?"})};t.prototype._getUrlInfo=function(){var e=this._itemUrlHelper.getUrlParts({listUrl:this._listContext.listUrl});return{listUrl:e?e.serverRelativeListUrl:this._listContext.listUrl,itemUrlParts:e}};t.prototype._createOrUpdateItem=function(e,t,n,r,s,o){var u=this,a=r.clientForm.fields,f=[],l=[],c={},h=[],p=null,v=null,m=!1;this._failedUpdateComplianceTagIdsCount=0;for(var g=0,b=a;g<b.length;g++){var w=b[g];if(w.data&&0===w.state.peek()){var E=w.data.peek();if(C.c(w)&&E!==w.serverData){p=w;if(o){var S=this._getUpdateMultipleComplianceTagsPromises(E,o,w);if(S)for(var x=0,T=S;x<T.length;x++){var k=T[x];h.push(k)}}else{var L=this._getUpdateComplianceTagPromise(E,r.clientForm.item.peek(),w);L&&h.push(L)}}else if(C.h(w)){if(!Object(N.isFeatureEnabled)(N.IPRecordVersioningClient)){c[w.schema.Name]=!0;continue}var A=C.p(r.clientForm.item.peek().properties[C.t]);if(A===("1"===E)||o){c[w.schema.Name]=!0;continue}v=w;var O=this._getUpdateUnlockedRecordPromise(E,r.clientForm.item.peek(),w,A);O&&h.push(O)}else if(this._isClientFormFieldUpdated(r,E,w)&&"attachments"!==w.schema.FieldType.toLowerCase()){w.state(1);f.push(w);var M=w.schema.Name;if("ContentType"===M){E=this._reverseLookupContentTypeIdByName(E.displayName);M="ContentTypeId";m=!0}l.push({FieldName:M,FieldValue:E,HasException:!1,ErrorMessage:null})}else c[w.schema.Name]=!0}}2!==r.clientForm.formType||m?1===r.clientForm.formType&&r.clientForm.item&&!r.clientForm.isBulkEdit&&r.clientForm.item.peek()&&r.clientForm.item.peek().properties&&!m&&l.push({FieldName:"ContentTypeId",FieldValue:r.clientForm.item.peek().properties.ContentTypeId,HasException:!1,ErrorMessage:null}):l.push({FieldName:"ContentType",FieldValue:r.clientForm.contentType,HasException:!1,ErrorMessage:null});if(0===f.length&&0===h.length)return i.n.wrap({status:d.e.success});h.push(this._getUpdateItemPromise(e,t,n,r,s,f,l,r.clientForm.item,o));return i.n.all(h).then(function(e){for(var t={status:d.e.success},n=0,r=e;n<r.length;n++){var i=r[n];if(i&&i.hasOwnProperty("status")){t.status=i.status;i.failedItemIds&&(t.failedItemIds=i.failedItemIds)}break}u._failedUpdateComplianceTagIdsCount>0&&t.status===d.e.success&&(t.status=d.e.partialSuccess);return t},function(e){p&&p.state(0);v&&v.state(0);for(var t=0,n=f;t<n.length;t++){var i=n[t];i.hasException(!0);i.state(0)}var s=Object(y.r)(u._pageContext)+r.clientForm.item.peek().properties.FileRef;throw e=(e=Array.isArray(e)?e:[e]).filter(function(e){return e&&e.message&&e.message.value}).map(function(e){e.message.value=e.message.value.replace('"'+s+'" ',"");return e})})};t.prototype._getUpdateItemPromise=function(e,t,n,r,s,o,u,a,f){return u&&0!==u.length&&o&&0!==o.length?this._getData({url:t(a),parseResponse:function(e){var t=JSON.parse(e);if(!t.d||!t.d[s]||!t.d[s].results){for(var n=0,u=o;n<u.length;n++){(L=u[n]).state(0)}return i.n.wrapError("The server response couldn't be processed")}for(var l=null,c={},h="",p=0,m=t.d[s].results;p<m.length;p++){var g=m[p];if(2===r.clientForm.formType&&"Id"===g.FieldName){var y=a.peek();y.properties||(y.properties={});y.properties.ID=g.FieldValue}if(!0===g.HasException||null!==g.ErrorMessage){var b=g.FieldName;c[b]||(c[b]=[]);void 0!==g.ItemId&&c[b].indexOf(g.ItemId)<0&&c[b].push(g.ItemId);if(!l){l={};for(var w=0,E=r.clientForm.fields;w<E.length;w++){var S=E[w];l[S.schema.Name]=S}}if(l[b]){l[b].errorMessage(g.ErrorMessage);l[b].hasException(!0);var x=l[b].schema.Title;h=h?h+", "+x:x}}}var T={status:h?d.e.fail:d.e.success};if(f&&f.length&&c.null){var N=c.null;N.length<f.length?T.status=d.e.partialSuccess:T.status=d.e.fail;T.failedItemIds=N}for(var C=0,k=o;C<k.length;C++){var L=k[C];if(h){if(!c[L.schema.Name]&&r.isInteractiveSave){L.errorMessage(v.format(_.e,h));L.hasException(!0)}}else{L.errorMessage("");L.hasException(!1)}L.state(0)}return T},qosName:e,additionalPostData:n(u),method:"POST",additionalHeaders:this._getAdditionalHeaders(),maxRetries:5}):i.n.wrap()};t.prototype._handleServerData=function(e,t,n,r){for(var i=t.ListData,s=t.Data.Row[0],o=e.item.peek(),u=e.isBulkEdit,a=0,f=r.length;a<f;a++){var c=r[a],h=c.schema;if(!n||!n.hasOwnProperty(h.Name)){void 0===c.data&&(c.data=l.observable(null));void 0===c.serverData&&(c.serverData=null);if(i.hasOwnProperty(h.Name)){"boolean"===h.FieldType.toLowerCase()&&""===s[h.Name]&&"0"===i[h.Name]?c.serverData="":h.FieldType&&"thumbnail"===h.FieldType.toLowerCase()&&s[h.Name]?c.serverData=s[h.Name]:c.serverData=i[h.Name];if(!o.hasOwnProperty(h.Name)&&!o.properties.hasOwnProperty(h.Name)){o.properties[h.Name]=s[h.Name];"DateTime"===h.Type&&s[h.Name+"."]&&(o.properties[h.Name+"."]=s[h.Name+"."])}}else if(C.c(c)){c.serverData=s[C.r];o.hasOwnProperty(h.Name)||o.properties.hasOwnProperty(h.Name)||(o.properties[h.Name]=s[h.Name])}else o.folder&&c.schema.FieldType&&"file"===c.schema.FieldType.toLowerCase()&&c.schema.Title&&"name"===c.schema.Title.toLowerCase()&&i.Title?c.serverData=i.Title:c.serverData=null;u&&(c.serverData=null);if(c.schema.AppendOnly){c.appendOnlyData=t[c.schema.Name];c.data("")}else c.data(c.serverData);if(P.e.isActivated("1E378923-8921-4A0C-A8F3-130823AB8BEB","Fix hotfix VSO#615577")){c.hasException(!1);c.errorMessage("");c.schema=h}}}Object(N.isFeatureEnabled)(N.DocumentSetsModernView)&&Object(N.isFeatureEnabled)(N.UseItemsScopeInTeamSites)&&this._handleWelcomeFields(e,t.WelcomeFields);o.properties[C.e]=i[C.e];o.hasClientFormData=!0};t.prototype._handleWelcomeFields=function(e,t){var n=e.fields;if(Array.isArray(t)&&t.length>0&&n){for(var r=n.map(function(e,t){return{index:t,name:e.schema.InternalName}}),i={},s=0;s<t.length;s++){var o=t[s];o&&(i[o]=s+2)}i.FileLeafRef=0;i.DocumentSetDescription=1;r.sort(function(e,t){if(e.name===t.name)return e.index-t.index;var n=i[e.name],r=i[t.name];return void 0!==n&&void 0!==r?n-r:void 0!==n?-1:void 0!==r?1:e.index-t.index});e.fields=r.map(function(e){return n[e.index]})}};t.prototype._getAdditionalHeaders=function(){return m.r(this._listContext)};t.prototype._processFormRenderMode=function(e){if(e)for(var t in e)for(var n in e[t]){var r=2;switch(n){case"Edit":r=1;break;case"Display":r=3}var i=0;switch(e[t][n].RenderType){case 1:i=1;break;case 2:i=2;break;case 3:i=3;break;case 4:i=4;break;default:k.e.logData({name:"ClientFormDataSource.InvalidFormRenderMode",message:"Server returned RenderType="+e[t][n].RenderType})}this._clientForms[r][t].mode=i}};t.prototype._checkRenderModes=function(e){for(var t in this._clientForms)for(var n in this._clientForms[t])if(this._clientForms[t][n].mode===e)return!0;return!1};t.prototype._getSuggestionsViewXml=function(e,t,n,r,i){var s=n?'<Eq><FieldRef Name="Editor" LookupId="TRUE"/><Value Type="int"><UserID/></Value></Eq>':'<Neq><FieldRef Name="Editor" LookupId="TRUE"/><Value Type="int"><UserID/></Value></Neq>';return'<View Scope="RecursiveAll">'+('<Query><OrderBy><FieldRef Name="ID" Ascending="false"></FieldRef></OrderBy><Where>'+(s=i?"<And>"+s+'<BeginsWith><FieldRef Name="'+e+'"/><Value Type="'+t+'">'+i+"</Value></BeginsWith></And>":"<And>"+s+'<IsNotNull><FieldRef Name="'+e+'"/></IsNotNull></And>')+"</Where></Query>")+('<ViewFields><FieldRef Name="Modified"/><FieldRef Name="Editor"/><FieldRef Name="'+e+'"/></ViewFields>')+'<RowLimit Paged="TRUE">'+r+"</RowLimit></View>"};t.prototype._getUpdateComplianceTagPromise=function(e,t,n){var r,s=n.schema;s.ComplianceTags&&(r=s.ComplianceTags.filter(function(t){return t&&t.tagValue===e})[0]);return r?this._complianceTagDataSource.updateComplianceTag(t,r).then(null,function(e){if(e&&n){n.errorMessage(e.message&&e.message.value?e.message.value:e);n.hasException(!0)}}):i.n.wrap()};t.prototype._getUpdateUnlockedRecordPromise=function(e,t,n,r){var i=this._itemUrlHelper.getItemUrlParts(t.key).serverRelativeListUrl;return"1"===e?this._complianceTagDataSource.unlockRecord(t,i).then(function(e){n.serverData=e?"1":"0"},function(e){if(e&&n){n.serverData=r?"1":"0";n.errorMessage(e.message&&e.message.value?e.message.value:e);n.hasException(!0)}}):this._complianceTagDataSource.lockRecord(t,i).then(function(e){n.serverData=e?"1":"0"},function(e){if(e&&n){n.serverData=r?"1":"0";n.errorMessage(e.message&&e.message.value?e.message.value:e);n.hasException(!0)}})};t.prototype._getUpdateMultipleComplianceTagsPromises=function(e,t,n){var r,i=this,s=n.schema,o=[];s.ComplianceTags&&(r=s.ComplianceTags.filter(function(t){return t&&t.tagValue===e})[0]);if(r){for(var u=[],a=0,f=0,l=t.length;f<l;f++){var c=t[f];u.push(parseInt(c().properties.ID,10));if(++a===C.i||f===t.length-1){var h=this._itemUrlHelper.getItemUrlParts(t[0]().key).serverRelativeListUrl;o.push(this._complianceTagDataSource.updateComplianceTagInBatch(u,r,h).then(function(e){i._failedUpdateComplianceTagIdsCount+=e.length},function(e){if(e&&n){n.errorMessage(e.message&&e.message.value?e.message.value:e);n.hasException(!0)}}));u=[];a=0}}return o}return null};t.prototype._updateAttachmentsField=function(e){var t=this,n=e.clientForm.item.peek(),r=null;if(n&&n.properties.ID&&"0"!==n.properties.ID){for(var s=0,o=e.clientForm.fields;s<o.length;s++){var u=o[s];if("attachments"===u.schema.FieldType.toLowerCase()){r=u;break}}var a=r&&r.AttachmentOperationsManager;if(a&&a.operationsPool.length>0){a.setListItem(n);return a.executeAllOperations(a.operationsPool,!0).then(function(e){a.operationsPool=[];t.handleAttachmentsErrors(e,r)},function(e){a.operationsPool=[];t.handleAttachmentsErrors(e,r)})}}return i.n.wrap(null)};t.prototype.handleAttachmentsErrors=function(e,t){var n=[];e.forEach(function(e){e.result||n.push(e.errorMsg)});if(t&&n&&n.length>0){var r=n.reduce(function(e,t){return e+(e?"\r\n":"")+t+"\r\n"},"");t.errorMessage(r);t.hasException(!0)}};t.prototype._getFormRenderMode=function(e,t){var n=this._contentTypeIdToNameMap[t],r=this._clientForms[e][n];return r?2===r.mode&&r.clientFormCustomFormatter&&r.clientFormCustomFormatter.bodyJSONFormatter?5:r.mode:this._checkRenderModes(3)?3:0};t.prototype._reverseLookupContentTypeIdByName=function(e){for(var t in this._contentTypeIdToNameMap)if(e===this._contentTypeIdToNameMap[t])return t;return null};t.prototype._ensureClientForms=function(e){if(!this._clientForms||this._listContext.refreshClientForm){this._listContext.refreshClientForm=void 0;return this.fetchAllClientFormSchemas(!0).then(e)}return i.n.wrap(e())};t.prototype._isClientFormFieldUpdated=function(e,t,n){return(!e.clientForm.isBulkEdit||""!==t||null!==n.serverData)&&(n.schema.AppendOnly?!P.e.isActivated("E4E6F7C4-9ADB-4B1B-833D-350823F516DE","Fix hotfix VSO#617198")||!!t:!A.e(t,n.serverData))};t.prototype._locateClientForm=function(e,t,n){!t&&n&&this._contentTypeIdToNameMap&&(t=this._contentTypeIdToNameMap[n]);if(!t&&this._clientForms[e])for(var r in this._clientForms[e])if(this._clientForms[e].hasOwnProperty(r)){t=r;break}if(n&&0===n.lastIndexOf(H,0)&&this._clientForms[e]&&!this._clientForms[e][t]){var i={FileLeafRef:1,Title:1,URL:1};for(var r in this._clientForms[e])if(this._clientForms[e].hasOwnProperty(r)){var s=this._clientForms[e][r].fields.filter(function(e){return!!i[e.Name]})[0];if(s){this._clientForms[e].Folder={contentType:"Folder",contentTypeId:n,formType:e,fields:[s],mode:0};return this._clientForms[e].Folder}}}if(!this._clientForms[e]||!this._clientForms[e][t]){if("folder"===t.toLowerCase()&&!n)for(var r in this._clientForms[e])if(this._clientForms[e][r]&&!this._clientForms[e][r].contentTypeId)return this._clientForms[e][r];return null}return this._clientForms[e][t]};t.prototype._locateClientFormWithContentTypeInfos=function(e,t){if(!t||!t.length)return this._locateClientForm(e,void 0,void 0);var n=t[0],i=this._locateClientForm(e,n.contentType,n.contentTypeId);if(1===t.length||!i||!i.fields)return i;for(var s=i.fields.slice(),o=function(n){if(0===s.length)return"break";var r=t[n],i=u._locateClientForm(e,r.contentType,r.contentTypeId);s=s.filter(function(e){for(var t=0,n=i.fields;t<n.length;t++){if(n[t].Name===e.Name)return!0}return!1})},u=this,a=1;a<t.length;a++){if("break"===o(a))break}return Object(r.__assign)(Object(r.__assign)({},i),{fields:s})};t.prototype._getData=function(e){return this.dataRequestor.getData(e)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},c.e.dependencies),{pageContext:w.h,listContext:w.o,items:b.H,navigation:D.e,compliance:S.e,itemUrlHelper:x.o,apiUrlHelper:T.e});return t})(c.e),U=Object(O.s)("ClientFormDataSource",R),z=n(2118),W=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._buffer=[];r._bufferSize=5;r._clientFormDataSource=n.clientFormDataSource;r._itemsStore=n.itemsStore;r._listContext=n.listContext;return r}t.prototype.getClientForm=function(e,t){var n=this;void 0===t&&(t=!1);t&&(this._listContext.refreshClientForm=!0);var r,s=e.item.peek(),u=this._getBufferKeyFromItem(s,e.contentType),a=e.isBulkEdit?void 0:this._getClientFormFromBuffer(u);s.type!==o.e.Folder||e.contentType||(e.contentType="Folder");if(a&&!this._listContext.refreshClientForm){if(s.hasClientFormData){a.item=e.item;return i.n.wrap(a)}this._deleteClientFormFromBuffer(u)}var f=this.getContentInfoTypes(e);return this._clientFormDataSource.getClientFormSchema(e.clientFormType,f,e.isBulkEdit).then(function(t){r={item:e.item,formType:t.formType,contentType:t.contentType,contentTypeId:t.contentTypeId,fields:[],clientFormCustomFormatter:t.clientFormCustomFormatter,isBulkEdit:e.isBulkEdit};n._generateFieldsFromSchema(r,t);if(2!==e.clientFormType)return n.updateFormValues(r)}).then(function(){n._addClientFormToBuffer(r);return i.n.wrap(r)})};t.prototype.getContentInfoTypes=function(e){var t=[];if(e.isBulkEdit&&e.selection&&!e.isSwitchingContentType)for(var n={},r=0,i=e.selection;r<i.length;r++){var s=i[r];if(s){var u=s.peek(),a=u.properties;if(a){var f=u.type!==o.e.Folder||a.ContentType?a.ContentType:"Folder",l=a.ContentTypeId,c=f+l;if(!n[c]){t.push({contentType:f,contentTypeId:l});n[c]=!0}}}}else t.push({contentType:e.contentType,contentTypeId:e.contentTypeId});return t};t.prototype.updateFormValues=function(e,t){return this._clientFormDataSource.updateFormValues(e,t)};t.prototype.createItem=function(e){return this._clientFormDataSource.createItem(e)};t.prototype.clearBuffer=function(){this._buffer=[]};t.prototype.updateItem=function(e){this._buffer=[];return this._clientFormDataSource.updateItem(e)};t.prototype.getContentTypes=function(e){return this._clientFormDataSource.getContentTypes(e)};t.prototype.updateItemMetadata=function(e,t){var n=this,r=e.items,s=e.metadata,o=e.parentItem,f=e.skipInvalidation,l=e.onComplete,c=r.length,h=0,p=[],d=function(){for(var e=[],t=s.group;t;){var r=t.fieldValue,i=t.fieldSchema;e.push({data:n.createObservable(r),serverData:null,state:n.createObservable(0),hasException:n.createObservable(!1),errorMessage:n.createObservable(""),schema:i});t=Object(z.e)(a.default.getParent(t,s.itemGroups))}return e};return i.n.wrap((function(){r.forEach(function(e,r){t&&(p[r]=new u.e(e.key,e));var i={item:n.createObservable(e),fields:d(),contentType:null,formType:1};n._clientFormDataSource.updateItem({clientForm:i,newDocumentUpdate:!1,checkInComment:null}).then(function(){h++;if(t){p[r]=p[r].succeed();t.update(p)}if(h===c){l&&l(!0);o&&!f&&n._itemsStore.invalidateItem(o.key)}},function(e){if(t){var n=e&&e.length>0&&e[0]&&e[0].message&&e[0].message.value;p[r]=p[r].fail(new Error(n));t.update(p)}})});t&&t.update(p)})())};t.prototype.hasFormRenderMode=function(e){return this._clientFormDataSource.hasFormRenderMode(e)};t.prototype.getFormRenderMode=function(e,t){var n,r,s;if(Object(N.isFeatureEnabled)(N.CustomActionPreFetch)&&this._listContext&&!1===this._listContext.checkPowerAppState){var o=null===(n=this._listContext)||void 0===n?void 0:n.availableContentTypes;if(o)for(var u=0,a=o;u<a.length;u++){var f=a[u];if((null===(r=f.ClientFormCustomFormatter)||void 0===r?void 0:r.bodyJSONFormatter)||(null===(s=f.ClientFormCustomFormatter)||void 0===s?void 0:s.toString().indexOf('"bodyJSONFormatter"'))>0)return i.n.resolve(5)}return i.n.resolve(2)}return this._clientFormDataSource.getFormRenderMode(e,t)};t.prototype.getPowerAppFormId=function(){return this._clientFormDataSource.getPowerAppFormId()};t.prototype.getPowerAppRenderInfo=function(){return this._clientFormDataSource.getPowerAppRenderInfo()};t.prototype.getPowerAppAdditionalData=function(){return this._clientFormDataSource.getPowerAppAdditionalData()};t.prototype.getPowerAppFormCacheInfo=function(){return this._clientFormDataSource.getPowerAppFormCacheInfo()};t.prototype.getPowerAppFormDesignUrl=function(e){return this._clientFormDataSource.getPowerAppFormDesignUrl(e)};t.prototype.fetchAllClientFormSchemas=function(){return this._clientFormDataSource.fetchAllClientFormSchemas()};t.prototype._generateFieldsFromSchema=function(e,t){for(var n=this._listContext&&this._listContext.enableAttachments,r=0,i=t.fields.length;r<i;r++){var s=t.fields[r];("Attachments"!==s.Type||n)&&!(e.isBulkEdit&&s.ReadOnlyField)&&e.fields.push(this._generateField(e,s))}};t.prototype._generateField=function(e,t){return{hasException:this.createObservable(!1),errorMessage:this.createObservable(""),schema:t,state:this.createObservable(0)}};t.prototype._getBufferKeyFromItem=function(e,t){return e.properties.ID+e.name+"|"+t};t.prototype._getClientFormFromBuffer=function(e){for(var t=0,n=this._buffer.length;t<n;t++){var r=this._buffer[t].key;if(r===e){if(0===t)return this._buffer[t].form;var i=this._buffer[t].form;this._buffer.splice(t,1);this._buffer.unshift({key:r,form:i});return i}}return null};t.prototype._addClientFormToBuffer=function(e){if(!e.isBulkEdit&&!this._hasAppendOnlyField(e)){var t=e.item.peek();t&&void 0!==t.properties.ID&&this._buffer.unshift({key:this._getBufferKeyFromItem(t,e.contentType),form:e})>this._bufferSize&&this._buffer.pop()}};t.prototype._deleteClientFormFromBuffer=function(e){for(var t=0,n=this._buffer.length;t<n;t++){if(this._buffer[t].key===e){this._buffer.splice(t,1);break}}};t.prototype._hasAppendOnlyField=function(e){for(var t=0,n=e.fields;t<n.length;t++){if(n[t].schema.AppendOnly)return!0}return!1};t.dependencies=Object(r.__assign)(Object(r.__assign)({},f.n.dependencies),{clientFormDataSource:U,itemsStore:s.t,listContext:w.o});return t})(f.n),X=(t.default=W,Object(O.s)("ClientFormProvider",W))},,function(e,t,n){"use strict";n.d(t,"e",function(){return w});var r=n(0),i=n(138);Object(i.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-SendLink--exclustionNotification .ms-BasePicker-text{border-bottom:1px solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-SendLink-message .od-SendLink-message-TextField{margin-bottom:12px}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field{padding:6px 0;font-size:.875rem;font-weight:"},{theme:"mediumFontWeight",defaultValue:"400"},{rawString:";font:-apple-system-footnote}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field::-webkit-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field::-moz-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field::-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}#od-SendLink-message-id .ms-Button::after{left:2px;right:2px;top:2px;bottom:2px}@media screen and (-ms-high-contrast: active){#od-SendLink-message-id .ms-Button::after{outline-color:window}}.od-SendLink-spinner .ms-Spinner-circle{display:inline-block}[dir='ltr'] .od-SendLink-spinner .ms-Spinner-circle{margin-right:8px}[dir='rtl'] .od-SendLink-spinner .ms-Spinner-circle{margin-left:8px}.od-SendLink-spinner .ms-Spinner-label{display:inline}.od-SendLink-ITPolicy{position:absolute;top:-24px}[dir='ltr'] .od-SendLink-ITPolicy{right:0}[dir='rtl'] .od-SendLink-ITPolicy{left:0}.od-SendLink-emailButtons{font:-apple-system-headline}[dir='ltr'] .od-SendLink-emailButtons{float:right}[dir='rtl'] .od-SendLink-emailButtons{float:left}.od-SendLink-emailButtons-allCaps{font:-apple-system-headline;font-style:uppercase;border-radius:2px}[dir='ltr'] .od-SendLink-emailButtons-allCaps{float:right}[dir='rtl'] .od-SendLink-emailButtons-allCaps{float:left}.od-SendLink-emailButtons-left{font:-apple-system-headline}[dir='ltr'] .isFluent .od-SendLink-emailButtons-left{text-align:right}[dir='rtl'] .isFluent .od-SendLink-emailButtons-left{text-align:left}.od-SendLink-emailButtons-rounded{font:-apple-system-headline}[dir='ltr'] .od-SendLink-emailButtons-rounded{float:right}[dir='rtl'] .od-SendLink-emailButtons-rounded{float:left}.od-SendLink-emailButtons-rounded .ms-Button{font:-apple-system-headline;border-radius:8px;height:54px}[dir='ltr'] .od-SendLink-emailButtons-roleSelector{float:right}[dir='rtl'] .od-SendLink-emailButtons-roleSelector{float:left}.od-SendLink-emailButtons-roleSelector .ms-Button{border-radius:2px}.od-SendLink-sendWrapper{display:block;width:100%;height:24px;padding-bottom:5px}.od-SendLink-email{position:relative}.od-SendLink-email .ms-TextField-field{height:65px;padding-bottom:30px;font-size:12px}[dir='ltr'] .od-SendLink-email .ms-TextField-field{padding-left:0px}[dir='rtl'] .od-SendLink-email .ms-TextField-field{padding-right:0px}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input{font-size:12px;font-weight:400;font:-apple-system-footnote}.isFluent .od-SendLink-email .ms-BasePicker .ms-BasePicker-input{font-size:14px;height:32px}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input::-webkit-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input::-moz-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input::-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.isFluent .od-SendLink-sendContainer{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}.od-SendLink-characterCounter{font-size:12px;font-weight:400}[dir='ltr'] .od-SendLink-characterCounter{float:right}[dir='rtl'] .od-SendLink-characterCounter{float:left}.od-SendLink-characterCounter--error{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-SendLink-characterCounterWrapper{display:block;height:16px;padding-bottom:5px}.od-SendLink-permissions{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.od-SendLink-peoplePicker{margin-bottom:12px;-webkit-box-flex:2;-ms-flex-positive:2;flex-grow:2;width:100%}\n"}]);var s=n(2367),o=n(1893),u=n(1725),a=n("react-lib"),f=n("prop-types-lib"),l=n(1851),c=n(2066),h=n(1938),p=n(1654),d=n(1665),v=n(1637),m=n(390),g=n(1667),y=n(1738),b=n(1747),w=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this;i._topLevelDivRef=a.createRef();i._validateMessage=function(e){i.props.onSendLinkMessageChange(e);var t=Object(d.h)(e);i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{messageLength:t}));return""};i._validateSubject=function(e){i.props.onSendLinkSubjectChange(e);var t=Object(d.h)(e);i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{subjectLength:t}));return e.length<=i.props.maximumSubjectLength?"":e.length+"/"+i.props.maximumSubjectLength};i._onResolvedSuggestions=function(e){i.context.sharingStore.getEngagementHelper().peoplePickerLinkedinSuggestions(i.props.engagementExtraData,e);return e};i._platformDetection=n.platformDetection;i.state={messageLength:0,subjectLength:0};i._onManageExistingAccessClick=i._onManageExistingAccessClick.bind(i);i._resizeTracker=new y.e(n.resize);return i}t.prototype.UNSAFE_componentWillReceiveProps=function(e){u.s({selectedItems:e.linkRecipients,sharingLinkKind:e.currentSettings.sharingLinkKind,canAddExternalPrincipal:e.sharingInformation.canAddExternalPrincipal,sharingInformation:e.sharingInformation,viewPolicyTipCallback:e.onViewPolicyTipClicked,onShareHintClick:Object(d.r)(e.sharingInformation)?e.onShareHintClicked:void 0,permissionsMap:e.permissionsMap});this.setState(Object(r.__assign)({},this.state))};t.prototype.componentDidMount=function(){this._resizeIfNeeded()};t.prototype.componentDidUpdate=function(){this._resizeIfNeeded()};t.prototype.render=function(){var e=this.props,t=e.currentSettings,n=e.linkRecipients,r=u.n(n),i=u.r(n,e.groupsMemberCount),s=this._platformDetection.isIOS||g.i(this.props.clientId)?"od-SendLink-emailButtons-rounded":this._platformDetection.isAndroid||g.t(this.props.clientId)?"od-SendLink-emailButtons-allCaps":"od-SendLink-emailButtons-left";s+=this._isRoleSelectorCompactExperimentOn?" od-SendLink-emailButtons-roleSelector":"";var o=this.props.showSendButton?a.createElement("div",{className:s},a.createElement(c.e,{ctaLabel:this.props.ctaLabel,currentSettings:this.props.currentSettings,errorMessage:this.props.errorMessage,linkRecipients:this.props.linkRecipients,maximumMessageLength:this.props.maximumMessageLength,maximumSubjectLength:this.props.maximumSubjectLength,messageText:this.props.messageText,subjectText:this.props.subjectText,onSendLinkClicked:this.props.onSendLinkClicked,permissionsMap:this.props.permissionsMap,sendButtonType:h.e.button,sharingInformation:this.props.sharingInformation})):"",f=e.isLoadingDefaultRecipients?a.createElement("div",null,a.createElement(v.e,{className:"od-SendLink-spinner",label:p.gn,size:m.e.small})):a.createElement(l.e,{defaultSelectedItems:n,error:e.errorMessage,onChange:e.onSelectedPeopleChange,onResolvedSuggestions:this._onResolvedSuggestions,oversharingExternalsWarning:r,oversharingGroupsWarning:i,pickerSettings:e.sharingInformation.peoplePickerSettings,sharingLinkKind:t.sharingLinkKind,sharingInformation:e.sharingInformation,permissionsMap:e.permissionsMap,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),clientId:e.clientId,onInputChange:e.onPeoplePickerInputChange||null,renderRoleSelector:!0,roleSelectorProps:this._getRoleSelectorProps()});return a.createElement("div",{ref:this._topLevelDivRef,className:"od-SendLink"},a.createElement("div",{className:"od-SendLink-email"},a.createElement("div",{className:"od-SendLink-peoplePicker"},f),a.createElement("div",{className:"od-SendLink-message",id:"od-SendLink-message-id"},this._renderTextArea(),this._renderCharacterCounter(),o)))};t.prototype._getRoleSelectorProps=function(){return{compact:!0,shimmer:Object(d.L)(this.props.sharingInformation),menuPermissionOptions:Object(b.t)({sharingInformation:this.props.sharingInformation,audience:this.props.currentSettings.audience,mode:s.e.share}),sharingRole:this.props.currentSettings.sharingRole,mode:s.e.share,clientId:this.props.clientId,ariaLabel:p.fn,showStopSharing:!1,onRoleChange:this.props.onRoleChange,showLinkSettings:!0,onLinkSettingsClicked:this.props.onLinkSettingsClicked,currentSettings:this.props.currentSettings}};t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)};t.prototype._onManageExistingAccessClick=function(){this.context.sharingStore.getEngagementHelper().whoElseHasAccessClicked(this.props.engagementExtraData);this.props.onManageExistingAccessClick()};t.prototype._renderTextArea=function(){if(this.props.showTextArea)return a.createElement("div",{className:"od-SendLink-message-TextField"},this._isSubjectExperimentOn&&a.createElement(o.e,{borderless:!0,underlined:!0,placeholder:p.Eo,onGetErrorMessage:this._validateSubject,defaultValue:this.props.subjectText}),a.createElement(o.e,{borderless:!0,placeholder:p.xn,ariaLabel:p.Sn,multiline:!0,resizable:!1,onGetErrorMessage:this._validateMessage,defaultValue:this.props.messageText}))};t.prototype._renderCharacterCounter=function(){var e=this.state.messageLength,t=e>this.props.maximumMessageLength,n="od-SendLink-characterCounter "+(t?"od-SendLink-characterCounter--error":"");if(e>this.props.maximumMessageLength/2)return t?a.createElement("div",{className:"od-SendLink-characterCounterWrapper"},a.createElement("span",{"aria-label":p.we,role:"alert",className:n},e,"/",this.props.maximumMessageLength)):a.createElement("div",{className:"od-SendLink-characterCounterWrapper"},a.createElement("span",{className:n},e,"/",this.props.maximumMessageLength))};t.contextTypes={platformDetection:f.object.isRequired,sharingStore:f.object.isRequired,resize:f.func.isRequired};return t})(a.Component)}],Array(16),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.Family=0]="Family";e[e.FamilyMember=1]="FamilyMember"})(r||(r={}))},,,,,,function(e,t,n){"use strict";var r=n(0),i=(n(2073),n("prop-types-lib")),s=n(138);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-Share{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";min-height:150px;overflow-y:auto;overflow-x:hidden}.od-Share.od-Share--hasActivity{position:relative}.od-Share.od-Share--hasActivity:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:0.8}[dir='ltr'] .od-Share .ms-Button+.ms-Button{margin-left:6px}[dir='rtl'] .od-Share .ms-Button+.ms-Button{margin-right:6px}[dir='ltr'] .isFluent .od-Share .ms-Button+.ms-Button{margin-left:13px}[dir='rtl'] .isFluent .od-Share .ms-Button+.ms-Button{margin-right:13px}.od-Share a{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-decoration:none}.od-Share a:hover,.od-Share a:focus{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:";text-decoration:underline}.od-Share a:focus{outline:1px solid transparent}.od-Share button:not(.ms-Button):not(.od-Share-noFocusBorder):focus{outline:1px solid;outline-color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.od-Share .od-Share-noFocusBorder:focus{outline:none;border:none}.isFluent .od-Share .ms-Button--default{outline:transparent;position:relative}.isFluent .od-Share .ms-Button--default::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .isFluent .od-Share .ms-Button--default:focus:after{content:'';position:absolute;top:2px;right:2px;bottom:2px;left:2px;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .isFluent .od-Share .ms-Button--default:focus:after{border-color:ActiveBorder}}@media screen and (-ms-high-contrast: active){.od-Share .ms-Button{outline:transparent;position:relative}.od-Share .ms-Button::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-Share .ms-Button:focus:after{content:'';position:absolute;top:-4px;right:-4px;bottom:-4px;left:-4px;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}}@media screen and (-ms-high-contrast: active) and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-Share .ms-Button:focus:after{border-color:ActiveBorder}}.od-Share ul{list-style-type:none;list-style:none;margin:0;padding:0}.od-Share .ms-Icon--ExcelLogo:before{color:#217346}.od-Share .ms-Icon--OneNoteLogo:before{color:#5c2d91}.od-Share .ms-Icon--PowerPointLogo:before{color:#d24726}.od-Share .ms-Icon--WordLogo:before{color:#2b579a}.od-Share .ms-Icon--PDF:before{color:#d24726}.od-Share.icon-Chat{color:#6264a7;background:#f6f6fa;border:1px solid #6264a7}.od-Share.icon-Mail{color:"},{theme:"teal",defaultValue:"#008272"},{rawString:";background:#f0f5f7;border:1px solid "},{theme:"teal",defaultValue:"#008272"},{rawString:"}.od-Share .icon-Globe{color:#0b6a0b;background:#f1f6f1;border:1px solid #0b6a0b}.isFluent .od-Share .icon-Globe{color:#0b6a0b;border-color:#0b6a0b;background-color:#f1f6f1}.od-Share .icon-Work{color:#004e8c;background:#f0f5f8;border:1px solid #004e8c}.isFluent .od-Share .icon-Work{color:#004e8c;border-color:#004e8c;background-color:#f0f5f8}.od-Share .icon-PeopleAdd{color:#393939;background:#f2f2f2;border:1px solid #393939}.isFluent .od-Share .icon-PeopleAdd{color:#201f1e;border-color:#201f1e;background-color:RGBA(#201f1e, 0.06)}.od-Share .icon-SecurityGroup{color:#8e562e;background:#f4efeb;border:1px solid #8e562e}.isFluent .od-Share .icon-SecurityGroup{color:#a4262c;border-color:#a4262c;background-color:RGBA(#a4262c, 0.06)}.od-Share .ms-Tooltip{pointer-events:none}@media all and (-ms-high-contrast: none), (-ms-high-contrast: active){.od-Share{width:320px}.od-Share .ms-Button{overflow:visible}}button.od-Share-backButton{z-index:1;background:none;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";cursor:pointer;font-size:16px;padding:0px;position:absolute;top:8px}[dir='ltr'] button.od-Share-backButton{left:10px}[dir='rtl'] button.od-Share-backButton{right:10px}.isFluent button.od-Share-backButton{top:12px}[dir='rtl'] button.od-Share-backButton{-webkit-transform:scale(-1, 1);transform:scale(-1, 1)}button.od-Share-backButton:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Share-spinnerHolder{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;height:150px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.od-Share-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}.teams .ms-Checkbox-checkbox{border-radius:4px}.teams .ms-Button.ms-Button--primary,.teams .ms-Button.ms-Button--default{border-radius:3px;min-width:96px}.teams .ms-Button--default{-webkit-box-shadow:0 2px 2px 0 rgba(37,36,36,0.15);box-shadow:0 2px 2px 0 rgba(37,36,36,0.15);border:1px solid rgba(37,36,36,0.15)}.teams .ms-Button--primary{-webkit-box-shadow:0 2px 2px 0 rgba(98,100,167,0.4);box-shadow:0 2px 2px 0 rgba(98,100,167,0.4)}.teams .ms-Button--primary.is-disabled{-webkit-box-shadow:none;box-shadow:none;border:none}\n"}]);var o=n(2367),u=n(2504);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ModifyPermissions.blocker:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:0.8}.od-ModifyPermissions .ms-Dialog-main{width:450px;max-width:none}.od-ModifyPermissions .ms-Dialog-header{display:none}.od-ModifyPermissions .ms-Dialog-actions{margin:20px}.od-ModifyPermissions.wide{min-width:480px}@media (max-width: 480px){.od-ModifyPermissions.wide{min-width:320px}}#od-ModifyPermissions-apply-id.ms-Button::after{left:2px;right:2px;top:2px;bottom:2px}[dir='ltr'] .teams .od-ModifyPermissions{margin-right:32px}[dir='rtl'] .teams .od-ModifyPermissions{margin-left:32px}[dir='ltr'] .teams .od-ModifyPermissions{margin-left:12px}[dir='rtl'] .teams .od-ModifyPermissions{margin-right:12px}.od-ModifyPermissions-header{padding:12px 0;text-align:center;height:44px;background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-ModifyPermissions-actions{padding:0 20px 20px 20px}[dir='ltr'] .od-ModifyPermissions-actions{text-align:right}[dir='rtl'] .od-ModifyPermissions-actions{text-align:left}.od-ModifyPermissions-actions div.ms-Button-label{font:-apple-system-headline}#od-ModifyPermissions-actions-id .ms-Button::after{left:2px;right:2px;top:2px;bottom:2px}.teams .od-ModifyPermissions-actions{padding-bottom:32px}[dir='ltr'] .teams .od-ModifyPermissions-actions{padding-right:0}[dir='rtl'] .teams .od-ModifyPermissions-actions{padding-left:0}.od-ModifyPermissions-section{padding:20px 0px 0 0px}.isFluent .od-ModifyPermissions-section{padding:0}.teams .od-ModifyPermissions-section{padding-top:10px}.od-ModifyPermissions-section-noAudienceMod{padding-top:0}[dir='ltr'] .od-ModifyPermissions-actions{text-align:right}[dir='rtl'] .od-ModifyPermissions-actions{text-align:left}.od-ModifyPermissions-margins{margin:0px 20px 0px 20px}.isFluent .od-ModifyPermissions-margins{margin:0 14px 0 10px;padding:0 6px}[dir='rtl'] .isFluent .od-ModifyPermissions-margins{margin:0 10px 0 14px}.od-confirmationDialog.shareDialog .ms-Dialog-actionsRight .ms-Button{width:100%;margin-top:4px;margin-bottom:4px}[dir='ltr'] .od-confirmationDialog.shareDialog .ms-Dialog-actionsRight .ms-Button{margin-left:-4px}[dir='rtl'] .od-confirmationDialog.shareDialog .ms-Dialog-actionsRight .ms-Button{margin-right:-4px}@media screen and (-ms-high-contrast: active){.od-ModifyPermissions-apply:focus,.od-ModifyPermissions-apply:hover{outline:2px solid #fff;background:highlight}}\n"}]);var a,f=n(2298),l=n(2429),c=n(1809),h=n("react-lib"),p=n(1871),d=n(1699),v=n(1739),m=n(1503),g=n(1772),y=n(22),b=n(1654);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ConfirmationDialog-subText{font-size:.75rem}.od-ConfirmationDialog-subText--nowrap{white-space:nowrap}.od-confirmationDialog .ms-Dialog-main{width:95%}.od-confirmationDialog .od-confirmationDialog-footer{display:inline-block}.od-confirmationDialog .od-confirmationDialog-footer .ms-Button{min-width:70px;max-width:70px}.od-confirmationDialog .ms-Dialog-title{font-weight:600}[dir='ltr'] .od-confirmationDialog-discard{float:left}[dir='rtl'] .od-confirmationDialog-discard{float:right}.od-confirmationDialog-saveCancel{display:inline}.od-confirmationDialog-saveCancel .ms-Button{margin:0px 4px}[dir='ltr'] .od-confirmationDialog-copyLinkInterruptButtons{padding-right:8px}[dir='rtl'] .od-confirmationDialog-copyLinkInterruptButtons{padding-left:8px}.od-ConfirmationDialog-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}]);(function(e){e[e.none=0]="none";e[e.link=1]="link";e[e.participant=2]="participant";e[e.linkSettings=3]="linkSettings";e[e.back=4]="back";e[e.shareDialogPasswordOnly=5]="shareDialogPasswordOnly";e[e.shareDialogExpirationOnly=6]="shareDialogExpirationOnly";e[e.shareDialogPasswordAndExpiration=7]="shareDialogPasswordAndExpiration";e[e.copyInterruptUpdate=8]="copyInterruptUpdate";e[e.copyInterruptRemove=9]="copyInterruptRemove";e[e.addressBarLinkOff=10]="addressBarLinkOff"})(a||(a={}));var w=(function(e){Object(r.__extends)(t,e);function t(t,n){return e.call(this,t)||this}t.prototype.render=function(){var e,t,n,r=this.props,i=r.confirmationCode,s=r.participant,o="od-confirmationDialog";switch(i){case a.link:e=b.Je;t=b.$e;n=b.ve;break;case a.linkSettings:e=b.ge;t=b.me;n=b.ve;break;case a.participant:e=y.format(b.Ge,s.name);t=b.is;n=b.ve;break;case a.back:e=b.sn;t=b.bs;n=b.ve;break;case a.shareDialogPasswordOnly:e=b.Oo;t=b.Bo;n=b.Do;o+=" shareDialog";break;case a.shareDialogExpirationOnly:e=b.Oo;t=b.Ho;n=b._o;o+=" shareDialog";break;case a.shareDialogPasswordAndExpiration:e=b.Oo;t=b.jo;n=b.Po;o+=" shareDialog";break;case a.copyInterruptUpdate:e=b.De;t=b.ke;n=b.Le;o+=" shareDialog";break;case a.copyInterruptRemove:e=b.Me;t=b.ke;n=b.Oe;o+=" shareDialog";break;case a.addressBarLinkOff:e=this.props.companyName?y.format(b.bo,this.props.companyName):b.yo;t=b.mo;n=b.ve}return h.createElement("div",null,h.createElement(p.e,{hidden:!1,className:o,onDismiss:this.props.onCancel,dialogContentProps:{type:d.e.close,title:e,subTextId:"dialogSubtext",styles:{topButton:{width:"2rem",height:"2rem",selectors:{".ms-Dialog-button--close .ms-Button-flexContainer .ms-Icon":{fontSize:"1rem"}}},title:{fontSize:"1.25rem"},innerContent:{},button:{},content:{},subText:{},header:{},inner:{selectors:{".ms-Dialog-action .ms-Button":{height:"2rem"},".ms-Dialog-action .ms-Button-textContainer .ms-Button-label":{fontSize:"0.875rem"}}}}},modalProps:{isDarkOverlay:!0,isBlocking:!0,subtitleAriaId:"dialogSubtext"}},this._getDialogSubText(),i===a.back?h.createElement(v.e,{className:"od-confirmationDialog-footer"},h.createElement(m.e,{className:"od-confirmationDialog-discard",onClick:this.props.onDiscard?this.props.onDiscard:this.props.onCancel,text:b.Ze}),h.createElement("div",{className:"od-confirmationDialog-saveCancel"},h.createElement(g.e,{onClick:this.props.onApply,text:t}),h.createElement(m.e,{onClick:this.props.onCancel,text:n}))):i===a.copyInterruptUpdate||i===a.copyInterruptRemove?h.createElement(v.e,null,h.createElement(g.e,{className:"od-ConfirmationDialog-copyLinkInterruptButtons",onClick:this.props.onApply,text:t}),h.createElement(m.e,{className:"od-ConfirmationDialog-copyLinkInterruptButtons",onClick:this.props.onDiscard||this.props.onCancel,text:n})):h.createElement(v.e,null,h.createElement(g.e,{onClick:this.props.onApply,text:t}),h.createElement(m.e,{onClick:this.props.onCancel,text:n}))))};t.prototype._getDialogSubText=function(){var e="";switch(this.props.confirmationCode){case a.link:return h.createElement("div",{className:"od-ConfirmationDialog-subText",id:"dialogSubtext","aria-live":"polite"},h.createElement("span",null,h.createElement("strong",null,b.Qe),b.Ke));case a.linkSettings:return h.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},h.createElement("span",null,b.I));case a.participant:return;case a.shareDialogPasswordOnly:e=y.format(b.xr,this.props.linkPasswordSetBy);return h.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},h.createElement("span",null,e));case a.shareDialogExpirationOnly:e=y.format(b.Sr,this.props.linkExpiration);return h.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},h.createElement("span",null,e));case a.shareDialogPasswordAndExpiration:e=y.format(b.Tr,this.props.linkExpiration,this.props.linkPasswordSetBy);return h.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},h.createElement("span",null,e));case a.copyInterruptUpdate:e=b._e;return h.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},h.createElement("span",null,e));case a.copyInterruptRemove:e=b.Ae;return h.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},h.createElement("span",null,e));case a.addressBarLinkOff:e=b.go;return h.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert",id:"dialogSubtext","aria-live":"polite"},h.createElement("span",null,e))}};return t})(h.Component),E=n(1729),S=n(1745);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-PermissionsSettings .ms-Checkbox{min-height:0}.od-PermissionsSettings .ms-Checkbox-label{margin-top:0}.od-PermissionsSettings .ms-Checkbox-label::before{width:1.25rem;height:1.25rem}.od-PermissionsSettings .ms-Checkbox-label::after{font-size:1rem;line-height:1.25rem;width:1.25rem}.od-PermissionsSettings .ms-PeoplePicker{margin-top:5px}.od-PermissionsSettings-section{padding-bottom:1.25rem}.od-PermissionsSettings-description{padding-bottom:10px;font-size:.625rem;font:-apple-system-caption2}[dir='ltr'] .od-PermissionsSettings-description .od-PermissionsSettings-description-textpart{margin-right:3px}[dir='rtl'] .od-PermissionsSettings-description .od-PermissionsSettings-description-textpart{margin-left:3px}.isFluent .od-PermissionsSettings-description{padding-bottom:8px;font-size:.875rem;font-weight:600}.od-PermissionsSettings-linksFromTemplateHeader{font-weight:400}.od-PermissionsSetting-specificPeople-container{margin-top:5px;font-size:.875rem}[dir='ltr'] .od-PermissionsSetting-specificPeople-container{margin-left:27px}[dir='rtl'] .od-PermissionsSetting-specificPeople-container{margin-right:27px}[dir='ltr'] .od-PermissionsSetting-specificPeople-container{margin-right:10px}[dir='rtl'] .od-PermissionsSetting-specificPeople-container{margin-left:10px}.od-PermissionsSetting-specificPeople-list{max-height:60px;overflow-y:auto;padding-bottom:2px}.od-PermissionsSetting-specificPeople-list a{text-decoration:none;outline:transparent;position:relative}.od-PermissionsSetting-specificPeople-list a::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-PermissionsSetting-specificPeople-list a:focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-PermissionsSetting-specificPeople-list a:focus:after{border-color:ActiveBorder}}.od-PermissionsSettings-bottomBorder{border-bottom:1px solid "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.isFluent .od-PermissionsSettings-bottomBorder{border-bottom:0}.teams .od-PermissionsSettings-bottomBorder{border:0}.teams .od-PermissionsSettings-description.od-ModifyPermissions-margins{margin:0}[dir='ltr'] .teams .od-PermissionsSettings-description.od-ModifyPermissions-margins{padding-left:20px}[dir='rtl'] .teams .od-PermissionsSettings-description.od-ModifyPermissions-margins{padding-right:20px}.od-PermissionsSettings-setting{margin-bottom:8px}.isFluent .od-PermissionsSettings-setting{margin-bottom:12px}.od-PermissionsSettings-setting span.ms-Checkbox-text{font:-apple-system-caption1}.od-PermissionsSettings-expirationError{font-size:.625rem;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-PermissionsSettings-PeoplePicker{margin-top:6px}[dir='ltr'] .od-PermissionsSettings-prompt{padding-right:.25em}[dir='rtl'] .od-PermissionsSettings-prompt{padding-left:.25em}.od-PermissionsSettings-learnMore{text-decoration:none;outline:transparent;position:relative;white-space:nowrap;font:-apple-system-caption2}.od-PermissionsSettings-learnMore::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-PermissionsSettings-learnMore:focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-PermissionsSettings-learnMore:focus:after{border-color:ActiveBorder}}.od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionText{vertical-align:top}[dir='ltr'] .od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionText{padding-left:3px}[dir='rtl'] .od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionText{padding-right:3px}.od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionIcon{display:inline-block}.od-PermissionsSettings-changePermission{margin-bottom:12px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-PermissionsSettings-setting--RequireVerification{width:100%;height:2rem}[dir='ltr'] .od-PermissionsSettings-setting--RequireVerification{margin-right:0}[dir='rtl'] .od-PermissionsSettings-setting--RequireVerification{margin-left:0}[dir='ltr'] .od-PermissionsSettings-setting--RequireVerification{padding-right:0}[dir='rtl'] .od-PermissionsSettings-setting--RequireVerification{padding-left:0}.od-RequireVerificationToggle{vertical-align:top;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;line-height:2rem}.od-RequireVerificationToggle .ms-Toggle{width:100%}.od-RequireVerificationToggle .ms-Toggle-slider{position:absolute;top:.375rem}[dir='ltr'] .od-RequireVerificationToggle .ms-Toggle-slider{right:30px}[dir='rtl'] .od-RequireVerificationToggle .ms-Toggle-slider{left:30px}[dir='ltr'] .od-RequireVerificationToggle .ms-Toggle-slider{float:right}[dir='rtl'] .od-RequireVerificationToggle .ms-Toggle-slider{float:left}.od-RequireVerificationToggle .ms-Toggle-label{padding:0;display:inline-block;margin:0 4px 0 8px;font-size:.875rem;cursor:pointer;width:calc(100% - 4.4rem)}[dir='rtl'] .od-RequireVerificationToggle .ms-Toggle-label{margin:0 8px 0 4px}.isFluent .od-RequireVerificationToggle .ms-Toggle-label{margin:0 4px 0 12px}[dir='rtl'] .isFluent .od-RequireVerificationToggle .ms-Toggle-label{margin:0 12px 0 4px}.od-RequireVerificationToggle .ms-Toggle:not(.isToggled) .ms-Toggle-label{font-weight:normal}.od-RequireVerificationToggle .ms-Toggle-innerContainer{line-height:2rem;margin-top:.25rem}[dir='ltr'] .od-RequireVerificationToggle .ms-Toggle-innerContainer{float:right}[dir='rtl'] .od-RequireVerificationToggle .ms-Toggle-innerContainer{float:left}.od-PermissionsSettings-setting--RequireVerification-Icon{display:inline-block}.isFluent .od-PermissionsSettings-setting--RequireVerification-Icon{font-size:1rem}.od-PermissionsSettings-setting--RequireVerification-Icon .ms-Icon{display:inline-block;font-size:1rem;margin:0 14px 0 8px;position:relative;height:2rem;line-height:2rem}[dir='rtl'] .od-PermissionsSettings-setting--RequireVerification-Icon .ms-Icon{margin:0 8px 0 14px}.od-PermissionsSettings-setting--PreventDownload{width:100%;height:2rem}[dir='ltr'] .od-PermissionsSettings-setting--PreventDownload{margin-right:0}[dir='rtl'] .od-PermissionsSettings-setting--PreventDownload{margin-left:0}[dir='ltr'] .od-PermissionsSettings-setting--PreventDownload{padding-right:0}[dir='rtl'] .od-PermissionsSettings-setting--PreventDownload{padding-left:0}.od-PermissionsSettings-setting--PreventDownload-Icon{display:inline-block}.isFluent .od-PermissionsSettings-setting--PreventDownload-Icon{font-size:1rem}.od-PermissionsSettings-setting--PreventDownload-Icon .ms-Icon{display:inline-block;font-size:1rem;margin:0 14px 0 8px;position:relative;height:2rem;line-height:2rem}[dir='rtl'] .od-PermissionsSettings-setting--PreventDownload-Icon .ms-Icon{margin:0 8px 0 14px}.od-PermissionsSettings-setting--OfficeReviewMode{width:100%;height:2rem}[dir='ltr'] .od-PermissionsSettings-setting--OfficeReviewMode{margin-right:0}[dir='rtl'] .od-PermissionsSettings-setting--OfficeReviewMode{margin-left:0}[dir='ltr'] .od-PermissionsSettings-setting--OfficeReviewMode{padding-right:0}[dir='rtl'] .od-PermissionsSettings-setting--OfficeReviewMode{padding-left:0}.od-PermissionsSettings-setting--OfficeReviewMode-Icon{display:inline-block}.isFluent .od-PermissionsSettings-setting--OfficeReviewMode-Icon{font-size:1rem}.od-PermissionsSettings-setting--OfficeReviewMode-Icon .ms-Icon{display:inline-block;font-size:1rem;margin:0 14px 0 8px;position:relative;height:2rem;line-height:2rem}[dir='rtl'] .od-PermissionsSettings-setting--OfficeReviewMode-Icon .ms-Icon{margin:0 8px 0 14px}.od-PermissionsSettings-wrapper{width:100%;outline:transparent;position:relative}.od-PermissionsSettings-wrapper::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-PermissionsSettings-wrapper:focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-PermissionsSettings-wrapper:focus:after{border-color:ActiveBorder}}.od-PermissionsSettings-blocker{pointer-events:none}.ms-Callout-container .od-PermissionsSettings-teachingBubble{max-width:300px}.od-PermissionsSettings-teachingBubbleIcon{font-size:1.5rem;position:absolute;top:1.5625rem;z-index:1}[dir='ltr'] .od-PermissionsSettings-teachingBubbleIcon{padding-left:.3125rem}[dir='rtl'] .od-PermissionsSettings-teachingBubbleIcon{padding-right:.3125rem}.od-PermissionsSettings-teachingBubble .ms-TeachingBubble-headline{padding-top:3.125rem}@media (forced-colors: active) and (prefers-color-scheme: light){.ms-TeachingBubble-primaryButton{color:black}}\n"}]);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}[dir='ltr'] .teams .od-AudienceChoiceGroup-row{padding-left:0}[dir='rtl'] .teams .od-AudienceChoiceGroup-row{padding-right:0}.teams .od-AudienceChoiceGroup-row.is-selected .od-ShareLinkDescription-label{font-weight:700}.od-AudienceChoiceGroup-row{background:none;border:none;cursor:pointer;margin-top:4px;width:90%;font:-apple-system-caption1;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.isFluent .od-AudienceChoiceGroup-row{padding:0;width:calc(100% - 24px)}.od-AudienceChoiceGroup-row.is-selected .od-ShareLinkDescription-label{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";font-weight:600;overflow-wrap:anywhere}.od-AudienceChoiceGroup-row.is-selected .tickIcon::after{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";content:'\\e73e';font-family:'FabricMDL2Icons';font-size:1rem;margin-top:8px;-ms-flex-preferred-size:10%;flex-basis:10%}[dir='ltr'] .od-AudienceChoiceGroup-row.is-selected .tickIcon::after{float:right}[dir='rtl'] .od-AudienceChoiceGroup-row.is-selected .tickIcon::after{float:left}.isFluent .od-AudienceChoiceGroup-row.is-selected .tickIcon::after{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:.75rem;margin-top:10px}.od-AudienceChoiceGroup-row.is-disabled .od-ShareLinkDescription-label{color:#a19f9d;overflow-wrap:anywhere}.od-AudienceChoiceGroup-row.is-disabled .od-ShareLinkDescription-icon{color:#a19f9d;background-color:#fafaf9;border-color:#a19f9d}@media screen and (-ms-high-contrast: active){.od-AudienceChoiceGroup-row{outline:1px solid transparent}}@media screen and (-ms-high-contrast: black-on-white){.od-AudienceChoiceGroup-row{outline:1px solid transparent}}.ms-Fabric--isFocusVisible .od-AudienceChoiceGroup-row:focus{-webkit-box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:" inset;box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:" inset}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-AudienceChoiceGroup-row:focus{-webkit-box-shadow:0 0 0 1px #1aebff inset;box-shadow:0 0 0 1px #1aebff inset}}@media screen and (-ms-high-contrast: black-on-white){.ms-Fabric--isFocusVisible .od-AudienceChoiceGroup-row:focus{-webkit-box-shadow:0 0 0 1px #37006e inset;box-shadow:0 0 0 1px #37006e inset}}.od-AudienceChoiceGroup-bottomBorder{border-bottom:1px solid "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.isFluent .od-AudienceChoiceGroup-bottomBorder{border-bottom:0}.teams .od-AudienceChoiceGroup-bottomBorder{border-bottom:0}.od-AudienceChoiceGroup-description{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;overflow:hidden;width:90%;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:90%;flex-basis:90%}[dir='ltr'] .od-AudienceChoiceGroup-description{float:left}[dir='rtl'] .od-AudienceChoiceGroup-description{float:right}\n"}]);var x=n(1648),T=n(287),N=n(2064),C=n(1667),k=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._firstInteractiveElement=h.createRef();r._onActiveElementChanged=function(e){if(!r._platformDetection.isMobile&&!C.s(r.props.clientId)&&e&&e.hasAttribute("data-key")){var t=parseInt(e.getAttribute("data-key"),10);"true"===e.getAttribute("aria-disabled")||r._onRowClick(t)}};r.state={selectedKey:r._getSelectedIndex(t)};r._platformDetection=n.platformDetection;return r}t.prototype._getSelectedIndex=function(e){for(var t=0,n=e.items;t<n.length;t++){var r=n[t];if(r.isChecked)return r.key}};t.prototype.componentDidMount=function(){var e=this;this._firstInteractiveElement&&this._firstInteractiveElement.current&&(this._platformDetection.isIOS?setTimeout(function(){e._firstInteractiveElement.current.focus()},100):this._firstInteractiveElement.current.focus())};t.prototype.render=function(){var e=this.props.items.map(this._renderItem,this);return h.createElement(x.e,{direction:T.e.vertical,onActiveElementChanged:this._onActiveElementChanged},h.createElement("div",{"aria-labelledby":"od-shareHeader-viewTitle od-PermissionsSettings-prompt-id",role:"radiogroup"},e))};t.prototype._renderItem=function(e,t){var n=e.key,r=!this._platformDetection.isFirefox,i=e.isDisabled&&e.disabledText?e.disabledText:"",s=this.state.selectedKey===n,o=this._platformDetection.isAndroid?t+1+" of "+this.props.items.length:"";return h.createElement(h.Fragment,null,h.createElement("button",{ref:s?this._firstInteractiveElement:void 0,role:"radio","aria-checked":s,key:n,onClick:e.isDisabled?function(){}:this._onRowClick.bind(this,n),className:this._getRowClasses(e),"aria-disabled":e.isDisabled,disabled:e.isDisabled,"aria-label":e.label+" "+i+" "+o,"data-key":n,tabIndex:s?0:-1},h.createElement("div",{className:"od-AudienceChoiceGroup-description"},h.createElement(N.e,{label:e.label,permissionsType:e.permissionsType,showLabel:!0,iconUrl:e.iconUrl,infoButtonMessage:r?i:""})),h.createElement("div",{className:"tickIcon","aria-hidden":!0})),h.createElement("div",{className:"od-AudienceChoiceGroup-bottomBorder"}))};t.prototype._getRowClasses=function(e){var t="od-ModifyPermissions-margins od-AudienceChoiceGroup-row od-Share-noFocusBorder";this.state.selectedKey===e.key&&(t+=" is-selected");e.isDisabled&&(t+=" is-disabled");return t};t.prototype._onRowClick=function(e){var t=this.props;this.setState({selectedKey:e});t.onChange(e);t.onAudienceChange(e);this.context.sharingStore.getEngagementHelper().linkSettingsLinkTypeChanged(this.props.engagementExtraData)};t.contextTypes={sharingStore:i.object.isRequired,platformDetection:i.object.isRequired};return t})(h.Component),L=n(129),A=n(1959),O=n(2101);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ExpirationDatePicker{margin-top:4px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%}.od-ExpirationDatePicker-content{border-bottom:.0625rem solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.isFluent .od-ExpirationDatePicker-content{border-bottom:.0625rem solid "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-ExpirationDatePicker-content,.od-ExpirationDatePicker-content-expired{width:100%;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.od-ExpirationDatePicker-content:hover,.od-ExpirationDatePicker-content-expired:hover{border-bottom-color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";cursor:pointer}.od-ExpirationDatePicker-content.od-ExpirationDatePicker-content-IE,.od-ExpirationDatePicker-content-expired.od-ExpirationDatePicker-content-IE{-ms-flex-wrap:nowrap;flex-wrap:nowrap}.od-ExpirationDatePicker-content .ms-DatePicker,.od-ExpirationDatePicker-content-expired .ms-DatePicker{display:inline-block;margin-bottom:0;padding:0;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.od-ExpirationDatePicker-content .ms-DatePicker i,.od-ExpirationDatePicker-content-expired .ms-DatePicker i{display:none}.od-ExpirationDatePicker-content .ms-DatePicker.od-DatePicker-IE,.od-ExpirationDatePicker-content-expired .ms-DatePicker.od-DatePicker-IE{width:100%;-webkit-box-flex:0;-ms-flex-positive:0;flex-grow:0}.od-ExpirationDatePicker-content .ms-TextField-field,.od-ExpirationDatePicker-content .od-ExpirationDate-expiresLabel,.od-ExpirationDatePicker-content-expired .ms-TextField-field,.od-ExpirationDatePicker-content-expired .od-ExpirationDate-expiresLabel{height:1.75rem;padding:0;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;font-size:.875rem}[dir='ltr'] .od-ExpirationDatePicker-content .ms-TextField-field.od-ExpirationDate-expiresLabelIE,[dir='ltr'] .od-ExpirationDatePicker-content .od-ExpirationDate-expiresLabel.od-ExpirationDate-expiresLabelIE,[dir='ltr'] .od-ExpirationDatePicker-content-expired .ms-TextField-field.od-ExpirationDate-expiresLabelIE,[dir='ltr'] .od-ExpirationDatePicker-content-expired .od-ExpirationDate-expiresLabel.od-ExpirationDate-expiresLabelIE{padding-right:14px}[dir='rtl'] .od-ExpirationDatePicker-content .ms-TextField-field.od-ExpirationDate-expiresLabelIE,[dir='rtl'] .od-ExpirationDatePicker-content .od-ExpirationDate-expiresLabel.od-ExpirationDate-expiresLabelIE,[dir='rtl'] .od-ExpirationDatePicker-content-expired .ms-TextField-field.od-ExpirationDate-expiresLabelIE,[dir='rtl'] .od-ExpirationDatePicker-content-expired .od-ExpirationDate-expiresLabel.od-ExpirationDate-expiresLabelIE{padding-left:14px}.od-ExpirationDatePicker-content .ms-TextField-fieldGroup,.od-ExpirationDatePicker-content-expired .ms-TextField-fieldGroup{background:transparent}.od-ExpirationDatePicker-content .ms-TextField,.od-ExpirationDatePicker-content-expired .ms-TextField{margin-bottom:0;width:100%}.od-ExpirationDatePicker-content .ms-DatePicker .ms-TextField div,.od-ExpirationDatePicker-content-expired .ms-DatePicker .ms-TextField div{border-color:transparent;padding:0;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ExpirationDatePicker-content .ms-Icon,.od-ExpirationDatePicker-content-expired .ms-Icon{font-size:1.25rem;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";margin-top:4px}.od-ExpirationDatePicker-label{display:inline-block;margin-top:7px}[dir='ltr'] .od-ExpirationDatePicker-label{margin-right:8px}[dir='rtl'] .od-ExpirationDatePicker-label{margin-left:8px}.isFluent .od-ExpirationDatePicker-label{font-size:1rem}[dir='ltr'] .isFluent .od-ExpirationDatePicker-label{margin-right:12px}[dir='rtl'] .isFluent .od-ExpirationDatePicker-label{margin-left:12px}.od-ExpirationDatePicker-info{display:-webkit-box;display:-ms-flexbox;display:flex}[dir='ltr'] .od-ExpirationDatePicker-info{margin-left:auto}[dir='rtl'] .od-ExpirationDatePicker-info{margin-right:auto}.od-ExpirationDatePicker-info .ms-Icon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";cursor:pointer;font-size:.75rem}[dir='ltr'] .od-ExpirationDatePicker-info .ms-Icon{margin-left:10px}[dir='rtl'] .od-ExpirationDatePicker-info .ms-Icon{margin-right:10px}.od-ExpirationDatePicker-delete{background-color:transparent;background:none;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";cursor:pointer;font-size:1rem;line-height:0px;padding:0px;height:1rem;outline:transparent;position:relative}[dir='ltr'] .od-ExpirationDatePicker-delete{margin-left:10px}[dir='rtl'] .od-ExpirationDatePicker-delete{margin-right:10px}.od-ExpirationDatePicker-delete::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ExpirationDatePicker-delete:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ExpirationDatePicker-delete:focus:after{border-color:ActiveBorder}}.od-ExpirationDatePicker-hidden{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}.od-ExpirationDatePicker-expired{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ExpirationDatePicker-content-expired{border-bottom:.0625rem solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ExpirationDatePicker-content-expired .ms-TextField-field{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ExpirationDatePicker-premiumGleam{height:.75rem;margin-top:2px;color:"},{theme:"yellow",defaultValue:"#ffb900"},{rawString:"}[dir='ltr'] .od-ExpirationDatePicker-premiumGleam{padding-right:5px}[dir='rtl'] .od-ExpirationDatePicker-premiumGleam{padding-left:5px}.od-ExpirationDatePicker-tooltipWrapper{outline:transparent;position:relative}.od-ExpirationDatePicker-tooltipWrapper::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ExpirationDatePicker-tooltipWrapper:focus:after{content:'';position:absolute;top:-.125rem;right:-.125rem;bottom:-.125rem;left:-.125rem;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ExpirationDatePicker-tooltipWrapper:focus:after{border-color:ActiveBorder}}.od-ExpirationDatePicker-infoTooltipContent{font-size:.875rem}@media (inverted-colors){.ms-DatePicker-day-button[aria-selected='true']{outline:.125rem solid}}input[readonly]:focus{border:.0625rem solid #0078d4}@media (forced-colors: active) and (prefers-color-scheme: dark){.od-ExpirationDatePicker-delete:enabled{color:white !important;forced-color-adjust:none}}@media (forced-colors: active) and (prefers-color-scheme: light){.od-ExpirationDatePicker-delete:enabled{color:black !important;forced-color-adjust:none}}\n"}]);var M=n(1486),_=n(1419),D=n(4),P=n(472),H=n(886),B=n(653),j=n(270),F=n(37),I=n(2315),q=n(1991),R=n(1439),U=n(97),z=n(1893),W=n(2321),X=n(1646),V=Object(P.e)(),$={months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["S","M","T","W","T","F","S"],goToToday:"Go to today",prevMonthAriaLabel:"Go to previous month",nextMonthAriaLabel:"Go to next month",prevYearAriaLabel:"Go to previous year",nextYearAriaLabel:"Go to next year",prevYearRangeAriaLabel:"Previous year range",nextYearRangeAriaLabel:"Next year range",closeButtonAriaLabel:"Close date picker",weekNumberFormatString:"Week number {0}"},J=(function(e){Object(D.r)(t,e);function t(t){var n=e.call(this,t)||this;n._calendar=h.createRef();n._datePickerDiv=h.createRef();n._textField=h.createRef();n._onSelectDate=function(e){var t=n.props,r=t.formatDate,i=t.onSelectDate;n.props.calendarProps&&n.props.calendarProps.onSelectDate&&n.props.calendarProps.onSelectDate(e);n.setState({selectedDate:e,formattedDate:r&&e?r(e):""});i&&i(e);n._calendarDismissed()};n._onCalloutPositioned=function(){var e=!0;n.props.calloutProps&&void 0!==n.props.calloutProps.setInitialFocus&&(e=n.props.calloutProps.setInitialFocus);n._calendar.current&&e&&n._calendar.current.focus()};n._onTextFieldFocus=function(e){n.props.disableAutoFocus||n.props.allowTextInput||(n._preventFocusOpeningPicker?n._preventFocusOpeningPicker=!1:n._showDatePickerPopup())};n._onTextFieldBlur=function(e){n._validateTextInput()};n._onTextFieldChanged=function(e,t){var r=n.props,i=r.allowTextInput,s=r.textField;if(i){n.state.isDatePickerShown&&n._dismissDatePickerPopup();var o=n.props,u=o.isRequired,a=o.strings;n.setState({errorMessage:u&&!t?a.isRequiredErrorMessage||" ":void 0,formattedDate:t})}s&&s.onChange&&s.onChange(e,t)};n._onTextFieldKeyDown=function(e){switch(e.which){case L.e.enter:e.preventDefault();e.stopPropagation();if(n.state.isDatePickerShown)n.props.allowTextInput&&n._dismissDatePickerPopup();else{n._validateTextInput();n._showDatePickerPopup()}break;case L.e.escape:n._handleEscKey(e)}};n._onTextFieldClick=function(e){n.props.disableAutoFocus||n.state.isDatePickerShown||n.props.disabled?n.props.allowTextInput&&n._dismissDatePickerPopup():n._showDatePickerPopup()};n._onIconClick=function(e){e.stopPropagation();n.state.isDatePickerShown||n.props.disabled?n.props.allowTextInput&&n._dismissDatePickerPopup():n._showDatePickerPopup()};n._dismissDatePickerPopup=function(){n.state.isDatePickerShown&&n.setState({isDatePickerShown:!1},function(){n._validateTextInput()})};n._calendarDismissed=function(){n._preventFocusOpeningPicker=!0;n._dismissDatePickerPopup()};n._handleEscKey=function(e){n.state.isDatePickerShown&&e.stopPropagation();n._calendarDismissed()};n._validateTextInput=function(){var e=n.props,t=e.isRequired,r=e.allowTextInput,i=e.strings,s=e.parseDateFromString,o=e.onSelectDate,u=e.formatDate,a=e.minDate,f=e.maxDate,l=n.state.formattedDate;if(!n.state.isDatePickerShown)if(r){var c=null;if(l){if(n.state.selectedDate&&!n.state.errorMessage&&u&&u(n.state.selectedDate)===l)return;if(!(c=s(l))||isNaN(c.getTime())){if(u){c=n.state.selectedDate;n.setState({formattedDate:u(c).toString()})}n.setState({errorMessage:i.invalidInputErrorMessage||" "})}else if(n._isDateOutOfBounds(c,a,f))n.setState({errorMessage:i.isOutOfBoundsErrorMessage||" "});else{n.setState({selectedDate:c,errorMessage:""});u&&u(c)!==l&&n.setState({formattedDate:u(c).toString()})}}else n.setState({errorMessage:t?i.isRequiredErrorMessage||" ":""});o&&o(c)}else t&&!l?n.setState({errorMessage:i.isRequiredErrorMessage||" "}):n.setState({errorMessage:""})};Object(H.e)(n);n.state=n._getDefaultState();n._id=t.id||Object(B.e)("DatePicker");n._preventFocusOpeningPicker=!1;return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.formatDate,n=e.value;if(!(Object(W.s)(this.props.minDate,e.minDate)&&Object(W.s)(this.props.maxDate,e.maxDate)&&this.props.isRequired===e.isRequired&&Object(W.s)(this.state.selectedDate,n)&&this.props.formatDate===t)){this._setErrorMessage(!0,e);this._id=e.id||this._id;var r=this.state.selectedDate;Object(W.s)(r,n)&&this.props.formatDate===t||this.setState({selectedDate:n||void 0,formattedDate:t&&n?t(n):""})}};t.prototype.componentDidUpdate=function(e,t){t.isDatePickerShown&&!this.state.isDatePickerShown&&this.props.onAfterMenuDismiss&&this.props.onAfterMenuDismiss()};t.prototype.render=function(){var e=this.props,t=e.firstDayOfWeek,n=e.strings,r=e.label,i=e.theme,s=e.className,o=e.styles,u=e.initialPickerDate,a=e.isRequired,f=e.disabled,l=e.ariaLabel,c=e.pickerAriaLabel,p=e.placeholder,d=e.allowTextInput,v=e.borderless,m=e.minDate,g=e.maxDate,y=e.showCloseButton,b=e.calendarProps,w=e.calloutProps,E=e.textField,S=e.underlined,x=e.allFocusable,T=e.calendarAs,N=void 0===T?I.e:T,C=e.tabIndex,k=this.state,L=k.isDatePickerShown,A=k.formattedDate,O=k.selectedDate,M=V(o,{theme:i,className:s,disabled:f,label:!!r,isDatePickerShown:L}),_=Object(B.e)("DatePicker-Callout"),P=Object(j.u)(this.props,j.s,["value"]),H=E&&E.iconProps,q=E&&E.id&&E.id!==this._id?E.id:this._id+"-label";return h.createElement("div",Object(D.e)({},P,{className:M.root}),h.createElement("div",{ref:this._datePickerDiv,"aria-haspopup":"true","aria-owns":L?_:void 0,className:M.wrapper},h.createElement(z.e,Object(D.e)({role:"combobox",label:r,"aria-expanded":L,ariaLabel:l,"aria-controls":L?_:void 0,required:a,disabled:f,errorMessage:this._getErrorMessage(),placeholder:p,borderless:v,value:A,componentRef:this._textField,underlined:S,tabIndex:C,readOnly:!d},E,{id:q,className:Object(F.e)(M.textField,E&&E.className),iconProps:Object(D.e)(Object(D.e)({iconName:"Calendar"},H),{className:Object(F.e)(M.icon,H&&H.className),onClick:this._onIconClick}),onKeyDown:this._onTextFieldKeyDown,onFocus:this._onTextFieldFocus,onBlur:this._onTextFieldBlur,onClick:this._onTextFieldClick,onChange:this._onTextFieldChanged}))),L&&h.createElement(R.e,Object(D.e)({id:_,role:"dialog",ariaLabel:c,isBeakVisible:!1,gapSpace:0,doNotLayer:!1,target:this._datePickerDiv.current,directionalHint:U.e.bottomLeftEdge},w,{className:Object(F.e)(M.callout,w&&w.className),onDismiss:this._calendarDismissed,onPositioned:this._onCalloutPositioned}),h.createElement(X.e,{isClickableOutsideFocusTrap:!0,disableFirstFocus:this.props.disableAutoFocus,forceFocusInsideTrap:!1},h.createElement(N,Object(D.e)({},b,{onSelectDate:this._onSelectDate,onDismiss:this._calendarDismissed,isMonthPickerVisible:this.props.isMonthPickerVisible,showMonthPickerAsOverlay:this.props.showMonthPickerAsOverlay,today:this.props.today,value:O||u,firstDayOfWeek:t,strings:n,highlightCurrentMonth:this.props.highlightCurrentMonth,highlightSelectedMonth:this.props.highlightSelectedMonth,showWeekNumbers:this.props.showWeekNumbers,firstWeekOfYear:this.props.firstWeekOfYear,showGoToToday:this.props.showGoToToday,dateTimeFormatter:this.props.dateTimeFormatter,minDate:m,maxDate:g,componentRef:this._calendar,showCloseButton:y,allFocusable:x})))))};t.prototype.focus=function(){this._textField.current&&this._textField.current.focus()};t.prototype.reset=function(){this.setState(this._getDefaultState())};t.prototype._setErrorMessage=function(e,t){var n=t||this.props,r=n.isRequired,i=n.strings,s=n.value,o=n.minDate,u=n.maxDate,a=n.initialPickerDate||!r||s?void 0:i.isRequiredErrorMessage||" ";!a&&s&&(a=this._isDateOutOfBounds(s,o,u)?i.isOutOfBoundsErrorMessage||" ":void 0);e&&this.setState({errorMessage:a});return a};t.prototype._showDatePickerPopup=function(){if(!this.state.isDatePickerShown){this._preventFocusOpeningPicker=!0;this.setState({isDatePickerShown:!0})}};t.prototype._getDefaultState=function(e){void 0===e&&(e=this.props);return{selectedDate:e.value||void 0,formattedDate:e.formatDate&&e.value?e.formatDate(e.value):"",isDatePickerShown:!1,errorMessage:this._setErrorMessage(!1)}};t.prototype._isDateOutOfBounds=function(e,t,n){return!!t&&Object(W.i)(t,e)>0||!!n&&Object(W.i)(n,e)<0};t.prototype._getErrorMessage=function(){if(!this.state.isDatePickerShown)return this.state.errorMessage};t.defaultProps={allowTextInput:!1,formatDate:function(e){return e?e.toDateString():""},parseDateFromString:function(e){var t=Date.parse(e);return t?new Date(t):null},firstDayOfWeek:q.t.Sunday,initialPickerDate:new Date,isRequired:!1,isMonthPickerVisible:!0,showMonthPickerAsOverlay:!1,strings:$,highlightCurrentMonth:!1,highlightSelectedMonth:!1,borderless:!1,pickerAriaLabel:"Calendar",showWeekNumbers:!1,firstWeekOfYear:q.n.FirstDay,showGoToToday:!0,dateTimeFormatter:void 0,showCloseButton:!1,underlined:!1,allFocusable:!1};return t})(h.Component),K=n(25),Q={root:"ms-DatePicker",callout:"ms-DatePicker-callout",withLabel:"ms-DatePicker-event--with-label",withoutLabel:"ms-DatePicker-event--without-label",disabled:"msDatePickerDisabled "},G=Object(_.e)(J,function(e){var t=e.className,n=e.theme,r=e.disabled,i=e.label,s=e.isDatePickerShown,o=n.palette,u=n.semanticColors,a=n.effects,f=n.fonts,l=Object(K.x)(Q,n),c={color:o.neutralSecondary,fontSize:f.mediumPlus.fontSize,lineHeight:"18px",pointerEvents:"none",position:"absolute",right:"4px",padding:"5px"};return{root:[l.root,n.fonts.medium,s&&"is-open",K.j,t],textField:[{position:"relative",selectors:{"& input[readonly]":{cursor:"pointer"},input:{selectors:{"::-ms-clear":{display:"none"}}}}},r&&{selectors:{"& input[readonly]":{cursor:"default"}}}],callout:[l.callout,{boxShadow:a.elevation8}],icon:[c,i?l.withLabel:l.withoutLabel,{paddingTop:"7px"},!r&&[l.disabled,{pointerEvents:"initial",cursor:"pointer"}],r&&{color:u.disabledText,cursor:"default"}]}},void 0,{scope:"DatePicker"}),Y=n(993),Z=n(1665),ee=n(1547),te=G,ne=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._dateRemovedStatus=h.createRef();r._onSelectDateForExpirationPicker=function(e){r._expirationDateRemoved=!1;var t=e<new Date(Date.now());r._focusDatePicker();r.setState({hasExpired:t,selectedDate:e});r.props.onSelectDate(e)};r._onDeleteDate=function(){r._expirationDateRemoved=!0;r._datePicker.focus();r.setState({selectedDate:null},function(){r.props.onSelectDate(null)})};r._formatDate=function(e){if(e){var t=e.getDay(),n=e.getMonth();return r._datePickerStrings.days[t]+" "+r._datePickerStrings.shortMonths[n]+" "+e.getDate()+" "+e.getFullYear()}return""};var i=r.props.value<new Date(Date.now());r.state={hasExpired:i,selectedDate:null};r._platformDetection=n.platformDetection;var s=new Date(Date.now());r._minDate=new Date(s.getFullYear(),s.getMonth(),s.getDate()+1,s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds());t.expiryRestriction>0?r._maxDate=new Date(s.getFullYear(),s.getMonth(),s.getDate()+t.expiryRestriction,s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()):r._maxDate=new Date(s.getFullYear()+2,s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds());r._isMobile=r._platformDetection.isMobile||C.s(r.props.clientId);r._datePickerStrings={months:Z.A,shortMonths:Z.M,days:Z.u,shortDays:Z.O,goToToday:b.It,setExpirationDate:b.Ls,nextMonthAriaLabel:b.Pn,prevMonthAriaLabel:b.ki,ariaLabel:r._formattedExpirationDateAriaLabel(),pickerAriaLabel:b.ft,closeButtonAriaLabel:r._isMobile&&b.ee||"",invalidInputErrorMessage:b.pt};return r}t.prototype.render=function(){var e=this.props.value,t=e&&this.state.hasExpired;this._datePickerStrings.ariaLabel=this._formattedExpirationDateAriaLabel();return h.createElement("div",{className:"od-ExpirationDatePicker"+(t?" od-ExpirationDatePicker-expired":"")},h.createElement("div",{className:"od-ExpirationDatePicker-label"+(t?" od-ExpirationDatePicker-expired":"")},h.createElement(Y.e,{"aria-hidden":"true",iconName:t?"EventDateMissed12":"Calendar"})),h.createElement("div",{className:"od-ExpirationDatePicker-content"+(t?" od-ExpirationDatePicker-content-expired":""+this._platformDetection.isIE?" od-ExpirationDatePicker-content-IE":"")},this._renderExpiresLabel(),h.createElement(te,{className:this._platformDetection.isIE?"od-DatePicker-IE":"",componentRef:this._resolveRef("_datePicker"),strings:this._datePickerStrings,placeholder:this._datePickerStrings.setExpirationDate,isMonthPickerVisible:!1,onSelectDate:this._onSelectDateForExpirationPicker,value:e,formatDate:this._formatDate,minDate:this._minDate,maxDate:this._maxDate,allowTextInput:this._platformDetection.isIE,ariaLabel:this._datePickerStrings.ariaLabel,pickerAriaLabel:this._datePickerStrings.pickerAriaLabel,showGoToToday:!1,showCloseButton:this._isMobile,allFocusable:!1,calloutProps:{preventDismissOnScroll:this._isMobile},disableAutoFocus:this.props.disableAutoFocus,tabIndex:this.props.tabIndex,onAfterMenuDismiss:this._focusDatePicker.bind(this),styles:{callout:{fontSize:"0.875rem",selectors:{".ms-DatePicker-header":{height:"1.75rem",lineHeight:"1.75rem"},".ms-DatePicker-monthAndYear":{fontSize:"0.875rem"},".ms-DatePicker-prevMonth":{fontSize:"0.75rem",width:"1.75rem",height:"1.75rem",lineHeight:"1.75rem"},".ms-DatePicker-nextMonth":{fontSize:"0.75rem",width:"1.75rem",height:"1.75rem",lineHeight:"1.75rem"},".ms-DatePicker-weekday":{fontSize:"0.75rem",width:"1.75rem",height:"1.75rem",lineHeight:"1.75rem"},".ms-DatePicker-day":{fontSize:"0.75rem",width:"1.75rem",height:"1.75rem",lineHeight:"1.75rem"},".ms-DatePicker-day-button":{width:"1.5rem",height:"1.5rem"}}},textField:{fontSize:"0.875rem",height:"1.75rem",selectors:{".ms-TextField-fieldGroup":{height:"1.75rem"},"input::placeholder":{fontSize:"0.875rem"}}},icon:{fontSize:"0.875rem"}}}),this._renderExpirationDateRemovedLabel(),this._renderRemoveDateButton()),this._renderPremiumGleam())};t.prototype._renderExpirationDateRemovedLabel=function(){if(this._expirationDateRemoved)return h.createElement("div",{ref:this._dateRemovedStatus,className:"od-Share-screenReaderOnly",tabIndex:-1,role:"alert","aria-live":"assertive","aria-hidden":!0},b.lt)};t.prototype._renderExpiresLabel=function(){if(this.props.value){var e="od-ExpirationDate-expiresLabel"+(this._platformDetection.isIE?" od-ExpirationDate-expiresLabelIE":"");return h.createElement("span",{className:e,role:"status","aria-live":"polite"},this.state.hasExpired?b.mt:b.yt)}};t.prototype._renderRemoveDateButton=function(){var e=this.state.selectedDate;if(!this.props.hideRemoveDateButton){if(this.props.expiryRestriction>0){var t=y.format(b.ct,this.props.expiryRestriction),n={maxWidth:"300px",onRenderContent:function(){return h.createElement("div",{className:"od-ExpirationDatePicker-infoTooltipContent"},t)}};return h.createElement("div",{className:"od-ExpirationDatePicker-info","aria-label":t},h.createElement(ee.e,{id:"od-ExpirationDatePicker-tooltip-id",hostClassName:"od-ExpirationDatePicker-tooltip",directionalHint:U.e.topCenter,calloutProps:{gapSpace:0},tooltipProps:n},h.createElement("div",{tabIndex:0,className:"od-ExpirationDatePicker-tooltipWrapper",role:"note"},h.createElement(Y.e,{iconName:"Info",className:"ms-Icon ms-Icon--Info"}))))}n={onRenderContent:function(){return h.createElement("div",{className:"od-ExpirationDatePicker-infoTooltipContent"},b.ss)}};return h.createElement(ee.e,{tooltipProps:n,id:"expirationDateRemovedButton",calloutProps:{gapSpace:0}},h.createElement("button",{className:"od-ExpirationDatePicker-delete",onClick:this._onDeleteDate,disabled:!e,"aria-label":b.ss},h.createElement(Y.e,{iconName:"Cancel","aria-hidden":!0})))}};t.prototype._formattedExpirationDateAriaLabel=function(){return this.state.selectedDate?y.format(b.ht,""):b.Ls};t.prototype._renderPremiumGleam=function(){return this.props.showGleam?h.createElement("img",{role:"presentation",src:"https://static2.sharepointonline.com/files/fabric/onedrive-assets/images/gleam.svg",className:"od-ExpirationDatePicker-premiumGleam"}):void 0};t.prototype._focusDatePicker=function(){this._platformDetection.isIE||this._datePicker.focus()};t.contextTypes={platformDetection:i.object.isRequired};return t})(M.e);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-PasswordField{margin-top:4px;height:100%;width:100%;display:block}.od-PasswordField .od-PasswordField-passwordFieldLine{display:-webkit-box;display:-ms-flexbox;display:flex}.od-PasswordField .od-ShareLink-passwordFieldContent{height:2rem;width:100%;border-bottom:.0625rem solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.isFluent .od-PasswordField .od-ShareLink-passwordFieldContent{border-bottom:.0625rem solid "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-PasswordField .od-ShareLink-passwordFieldContent:hover{border-bottom-color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-PasswordField .ms-PasswordField .ms-TextField input::-webkit-input-placeholder{width:100%;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:.875rem}.od-PasswordField .ms-PasswordField .ms-TextField input::-moz-placeholder{width:100%;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:.875rem}.od-PasswordField .ms-PasswordField .ms-TextField input::-ms-input-placeholder{width:100%;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:.875rem}.od-PasswordField .ms-PasswordField .ms-TextField input::placeholder{width:100%;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:.875rem}.od-PasswordField .ms-TextField{width:100%;display:inline-block;padding:2px;height:1.75rem;min-width:0;cursor:pointer;border-color:transparent}.od-PasswordField .ms-TextField .ms-TextField-fieldGroup{background:transparent}.od-PasswordField .ms-TextField-field{display:inline-block;padding:0;height:1.75rem;min-width:0;width:100%;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.od-PasswordField-delete{outline:transparent;position:relative;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-PasswordField-delete::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-PasswordField-delete:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-PasswordField-delete:focus:after{border-color:ActiveBorder}}.od-PasswordField-label{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-top:7px}[dir='ltr'] .od-PasswordField-label{margin-right:8px}[dir='rtl'] .od-PasswordField-label{margin-left:8px}.isFluent .od-PasswordField-label{font-size:.875rem}[dir='ltr'] .isFluent .od-PasswordField-label{margin-right:12px}[dir='rtl'] .isFluent .od-PasswordField-label{margin-left:12px}.od-PasswordField-cancel{display:inline-block;vertical-align:top;margin-top:1px}.odPasswordField-lastModifiedBy{font-style:italic}.od-PasswordField-shareReminder{display:block;margin-top:3px;font-size:.75rem}[dir='ltr'] .od-PasswordField-shareReminder{padding-left:22px}[dir='rtl'] .od-PasswordField-shareReminder{padding-right:22px}.od-PasswordField-shareReminder-detailsPane{display:block;margin-top:8px;font-size:.75rem}[dir='ltr'] .od-PasswordField-shareReminder-detailsPane{padding-left:36px}[dir='rtl'] .od-PasswordField-shareReminder-detailsPane{padding-right:36px}.od-PasswordField-passwordField{display:-webkit-box;display:-ms-flexbox;display:flex}.od-PermissionsSettings-delete{outline:transparent;position:relative;background-color:transparent;background:none;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";cursor:pointer;font-size:.875rem;line-height:0px;padding:0px}.od-PermissionsSettings-delete::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-PermissionsSettings-delete:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-PermissionsSettings-delete:focus:after{border-color:ActiveBorder}}[dir='ltr'] .od-PermissionsSettings-delete{margin-left:auto}[dir='rtl'] .od-PermissionsSettings-delete{margin-right:auto}.od-PasswordField-premiumGleam{height:12px;margin-top:12px;color:"},{theme:"yellow",defaultValue:"#ffb900"},{rawString:"}[dir='ltr'] .od-PasswordField-premiumGleam{padding-right:5px}[dir='rtl'] .od-PasswordField-premiumGleam{padding-left:5px}\n"}]);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareLink{padding:26px 0 12px}.od-ShareLink.flightOff{padding:0}.od-ShareLink .od-ShareLink-main{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative}.od-ShareLink .od-ShareLink-main .ms-Button--default{outline:transparent;position:relative;border-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:.75rem;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";min-width:3.375rem;height:2rem;margin:0;padding:0}.od-ShareLink .od-ShareLink-main .ms-Button--default::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareLink .od-ShareLink-main .ms-Button--default:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ShareLink .od-ShareLink-main .ms-Button--default:focus:after{border-color:ActiveBorder}}[dir='ltr'] .od-ShareLink .od-ShareLink-main .ms-Button--default{border-left:0px solid "},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}[dir='rtl'] .od-ShareLink .od-ShareLink-main .ms-Button--default{border-right:0px solid "},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-ShareLink-icon{position:relative;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:1.5625rem;border-radius:50%;width:3.125rem;min-width:3.125rem;height:3.125rem}[dir='ltr'] .od-ShareLink-icon{margin-right:10px}[dir='rtl'] .od-ShareLink-icon{margin-left:10px}.od-ShareLink-icon i{position:absolute;top:50%}[dir='ltr'] .od-ShareLink-icon i{left:50%}[dir='rtl'] .od-ShareLink-icon i{right:50%}[dir='ltr'] .od-ShareLink-icon i{-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%)}[dir='rtl'] .od-ShareLink-icon i{-webkit-transform:translate(50%, -50%);transform:translate(50%, -50%)}.od-ShareLink-icon2{position:relative;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:1.125rem;border-style:solid;border-width:.0625rem;border-radius:50%;-webkit-box-sizing:border-box;box-sizing:border-box;width:2rem;min-width:2rem;height:2rem}[dir='ltr'] .od-ShareLink-icon2{margin-right:10px}[dir='rtl'] .od-ShareLink-icon2{margin-left:10px}.od-ShareLink-icon2 i{font-size:1.125rem;position:absolute;top:50%}[dir='ltr'] .od-ShareLink-icon2 i{left:50%}[dir='rtl'] .od-ShareLink-icon2 i{right:50%}[dir='ltr'] .od-ShareLink-icon2 i{-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%)}[dir='rtl'] .od-ShareLink-icon2 i{-webkit-transform:translate(50%, -50%);transform:translate(50%, -50%)}.od-ShareLink-icon2.icon-Globe{color:#0b6a0b;background:#f1f6f1;border:1px solid #0b6a0b}.od-ShareLink-icon2.icon-Chat{color:#6264a7;background:#f6f6fa;border:1px solid #6264a7}.od-ShareLink-icon2.icon-Mail{color:"},{theme:"teal",defaultValue:"#008272"},{rawString:";background:#f0f5f7;border:1px solid "},{theme:"teal",defaultValue:"#008272"},{rawString:"}.od-ShareLink-icon2.icon-Work{color:#004e8c;background:#f0f5f8;border:1px solid #004e8c}.od-ShareLink-icon2.icon-FileRequest{color:#333333;background:white;border:white;font-size:20px}.od-ShareLink-icon2.icon-PeopleAdd{color:#393939;background:#f2f2f2;border:1px solid #393939}.od-ShareLink-icon2.icon-SecurityGroup{color:#8e562e;background:#f4efeb;border:1px solid #8e562e}.od-ShareLink-details{-webkit-box-flex:1;-ms-flex:1;flex:1}.od-ShareLink-details .ms-TextField-field{font-size:.875rem;min-width:100px}.od-ShareLink-details .ms-TextField-fieldGroup{height:2rem}.od-ShareLink-url{font-size:.875rem}.od-ShareLink-actionButton{outline:transparent;position:relative;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:1rem;width:2rem;height:2rem}.od-ShareLink-actionButton::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareLink-actionButton:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ShareLink-actionButton:focus:after{border-color:ActiveBorder}}.od-ShareLink-actionButton .ms-Button-icon{font-size:1rem}.od-ShareLink-description{padding-top:.5rem;font-size:.75rem}[dir='ltr'] .od-ShareLink-description{padding-left:42px}[dir='rtl'] .od-ShareLink-description{padding-right:42px}.od-ShareLink-description.flightOff{padding-top:0}[dir='ltr'] .od-ShareLink-description.flightOff{padding-left:60px}[dir='rtl'] .od-ShareLink-description.flightOff{padding-right:60px}.od-PermissionsList .od-ShareLink-description{cursor:pointer}.od-ShareLink-description .od-ShareLink-description-label{display:inline-block;font-size:.6875rem}[dir='ltr'] .od-ShareLink-description .od-ShareLink-description-label{margin-right:4px}[dir='rtl'] .od-ShareLink-description .od-ShareLink-description-label{margin-left:4px}.od-ShareLink--inviteesHolder{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center;outline:transparent;position:relative}[dir='ltr'] .od-ShareLink--inviteesHolder{padding-left:42px}[dir='rtl'] .od-ShareLink--inviteesHolder{padding-right:42px}[dir='ltr'] .od-ShareLink--inviteesHolder{padding-right:38px}[dir='rtl'] .od-ShareLink--inviteesHolder{padding-left:38px}.od-ShareLink--inviteesHolder::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareLink--inviteesHolder:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ShareLink--inviteesHolder:focus:after{border-color:ActiveBorder}}[dir='ltr'] .od-ShareLink--inviteesHolder.flightOff{padding-left:60px}[dir='rtl'] .od-ShareLink--inviteesHolder.flightOff{padding-right:60px}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%}[dir='ltr'] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .ms-Facepile-members>*{margin-right:10px}[dir='rtl'] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .ms-Facepile-members>*{margin-left:10px}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .ms-Persona-details{display:none}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerExpanded{font-size:.75rem;font-weight:600}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}[dir='ltr'] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron{margin-left:auto}[dir='rtl'] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron{margin-right:auto}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron .ms-Button-icon{font-size:.75rem}.od-ShareLink--inviteesHolder .od-ShareLink-participants{width:100%}ul.od-ShareLink-participants{cursor:default;list-style:none;padding:0}.od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{content:'';background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";display:block;height:.4375rem}[dir='ltr'] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-left:-62px}[dir='rtl'] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-right:-62px}[dir='ltr'] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-right:-58px}[dir='rtl'] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-left:-58px}.od-ShareLink-personaItem{padding:18px 8px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ShareLink-personaItem .ms-Persona{width:100%}.od-ShareLink-personaItem .ms-Persona .ms-Persona-primaryText,.od-ShareLink-personaItem .ms-Persona .ms-Persona-secondaryText,.od-ShareLink-personaItem .ms-Persona .ms-Persona-tertiaryText,.od-ShareLink-personaItem .ms-Persona .ms-Persona-optionalText{overflow-y:hidden;overflow-x:hidden;white-space:nowrap;text-overflow:ellipsis}.od-ShareLink-personaItem .ms-Persona .ms-Persona-primaryText{font-size:1rem;font:-apple-system-body;height:1.125rem;line-height:1.125rem}.od-ShareLink-personaItem .ms-Persona .ms-Persona-secondaryText{font-size:.625rem;color:"},{theme:"bodySubtext",defaultValue:"#605e5c"},{rawString:";font:-apple-system-caption1;height:1rem;line-height:1rem}.od-ShareLink-personaItem .ms-Button-icon{outline:transparent;position:relative;font-size:.75rem}.od-ShareLink-personaItem .ms-Button-icon::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareLink-personaItem .ms-Button-icon:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ShareLink-personaItem .ms-Button-icon:focus:after{border-color:ActiveBorder}}.od-ShareLink-personaItem .ms-Persona-image{height:2rem;width:2rem}.od-ShareLink-details-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}.od-ShareLink-linkMember{outline:transparent;position:relative}.od-ShareLink-linkMember::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareLink-linkMember:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ShareLink-linkMember:focus:after{border-color:ActiveBorder}}\n"}]);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}[dir='ltr'] .od-PasswordStrengthMeter{padding-left:6px}[dir='rtl'] .od-PasswordStrengthMeter{padding-right:6px}.od-PasswordStrengthMeter .display-linebreak{white-space:pre-line}.od-PasswordStrengthMeter-StrengthExplanation{font-weight:bold}.od-PasswordStrengthMeter-StrengthNotificationText{display:inline}.od-PasswordStrengthMeter-StrengthNotificationText.Weak{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationText.Fair{color:"},{theme:"orangeLight",defaultValue:"#ea4300"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationText.Good{color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationText.Strong{color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.od-PasswordStrengthMeter-tooltip{font-size:.875rem}.od-PasswordStrengthMeter-StrengthNotificationText-StrengthText{display:inline;font-weight:bold}.od-PasswordStrengthMeter-StrengthNotificationBar{width:auto}.od-PasswordStrengthMeter-StrengthNotificationBar.Weak .ms-ProgressIndicator-progressBar{background-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationBar.Fair .ms-ProgressIndicator-progressBar{background-color:"},{theme:"orangeLight",defaultValue:"#ea4300"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationBar.Good .ms-ProgressIndicator-progressBar{background-color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationBar.Strong .ms-ProgressIndicator-progressBar{background-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.od-PasswordStrengthMeter-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}]);var re=n(2263),ie=[b.Pr,b.Hr,b.Br,b.jr,b.Fr],se=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._calculatePasswordStrength=n._calculatePasswordStrength.bind(n);n._renderStrengthText=n._renderStrengthText.bind(n);n._renderStrengthBar=n._renderStrengthBar.bind(n);return n}t.prototype.render=function(){var e=this._calculatePasswordStrength(this.props.currentPassword),t=y.format(b.Ue,ie[e]);this.props.getStrengthMeterValue&&this.props.getStrengthMeterValue(ie[e]);return h.createElement("div",{className:"od-PasswordStrengthMeter"},h.createElement(ee.e,{tooltipProps:{maxWidth:"300px",onRenderContent:function(){return h.createElement("div",{className:"od-PasswordStrengthMeter-tooltip"},h.createElement("ul",{style:{margin:0,padding:0}},h.createElement("div",{className:"od-PasswordStrengthMeter-StrengthExplanation"},b.Or," ",h.createElement("br",null)),b.Mr," ",h.createElement("br",null),b._r," ",h.createElement("br",null),b.Dr))}}},h.createElement("div",{className:"od-PasswordStrengthMeter-test",tabIndex:0,"aria-label":t},this._renderStrengthText(e),this._renderStrengthBar(e))))};t.prototype._renderStrengthText=function(e){var t=ie[e];return h.createElement("div",{className:"od-PasswordStrengthMeter-StrengthNotificationText",role:"status","aria-live":"assertive"},h.createElement("div",{className:"od-PasswordStrengthMeter-StrengthNotificationText-StrengthText"},b.Ar),h.createElement("div",{className:"od-PasswordStrengthMeter-StrengthNotificationText "+t},t))};t.prototype._renderStrengthBar=function(e){var t=ie[e];return h.createElement("div",{className:"od-PasswordStrengthMeter-StrengthNotificationBar "+t,"aria-hidden":!0,role:"presentation"},h.createElement(re.e,{percentComplete:.25*e,barHeight:4,styles:{itemProgress:{height:"0.25rem"},progressBar:{height:"0.25rem"},progressTrack:{height:"0.25rem"}}}))};t.prototype._calculatePasswordStrength=function(e){var t=0;e.length>8&&t++;/[A-Z]/.test(e)&&/[a-z]/.test(e)&&t++;/\d/.test(e)&&t++;/[^A-Za-z0-9]/g.test(e)&&t++;return t};return t})(h.Component),oe=n(1738),ue=n(1508),ae=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this;i._currentStrengthMeterValue="";i._topLevelDiv=h.createRef();i._onUpdatePassword=function(e,t){void 0===t&&(t="");var n=t.length>0;i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{currentPassword:t,displayRemovePasswordButton:n&&i.props.detailsPane}),function(){i.props.onPasswordChange(t)})};if(i.props.detailsPane){i.state={currentPassword:"************",disablePasswordField:!0,displayRemovePasswordButton:!0,displayNotificationText:!0,hasExistingPassword:!0}}else i.state=Object(r.__assign)(Object(r.__assign)({},i.state),{currentPassword:"",disablePasswordField:!1,displayRemovePasswordButton:!1,displayNotificationText:!1,hasExistingPassword:!1});i._renderShareReminder=i._renderShareReminder.bind(i);i._onFocusPasswordFieldDetails=i._onFocusPasswordFieldDetails.bind(i);i._onFocusPasswordField=i._onFocusPasswordField.bind(i);i._onBlurPasswordField=i._onBlurPasswordField.bind(i);i._onDeletePassword=i._onDeletePassword.bind(i);i._getPasswordFieldAriaLabel=i._getPasswordFieldAriaLabel.bind(i);i._getStrengthMeterValue=i._getStrengthMeterValue.bind(i);i._resizeTracker=new oe.e(n.resize);return i}t.prototype.componentDidUpdate=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDiv)};t.prototype.render=function(){var e=this.props.detailsPane?this._onFocusPasswordFieldDetails:this._onFocusPasswordField,t=this._getPasswordFieldAriaLabel();return h.createElement("div",{ref:this._topLevelDiv,className:"od-PasswordField"},h.createElement("div",{className:"od-PasswordField-passwordFieldLine"},h.createElement("div",{className:"od-PasswordField-label"},h.createElement(Y.e,{iconName:"Lock"})),h.createElement("div",{className:"od-ShareLink-passwordFieldContent"},h.createElement(z.e,{type:"password",autoComplete:"off",disabled:this.state.disablePasswordField,placeholder:b.As,value:this.state.currentPassword,onChange:this._onUpdatePassword,onFocus:e,onBlur:this._onBlurPasswordField,borderless:!0,ariaLabel:t,readOnly:this.props.readOnly,tabIndex:this.props.tabIndex,"aria-describedby":"shareReminderText",styles:{field:{fontSize:".875rem",lineHeight:" 1.0625rem",selectors:{"::placeholder":{fontSize:".875rem"}},borderColor:"transparent",border:"none"}}})),this.state.displayRemovePasswordButton&&h.createElement(ue.e,{"data-is-focusable":!0,className:"od-PasswordField-delete",iconProps:{iconName:"Cancel"},ariaLabel:b.us,onClick:this._onDeletePassword}),this._renderPremiumGleam()),this._renderShareReminder())};t.prototype._renderShareReminder=function(){var e,t="od-PasswordField-shareReminder";this.props.detailsPane&&(t+="-detailsPane");this.state.displayNotificationText?this.state.hasExistingPassword?this.props.detailsPane&&(e=h.createElement("div",{className:"odPasswordField-lastModifiedBy"},b.kr+this.props.lastModifiedBy)):e=this.state.currentPassword.length>0?h.createElement(se,{currentPassword:this.state.currentPassword,getStrengthMeterValue:this._getStrengthMeterValue}):h.createElement("div",null,b.Lr):e=h.createElement("div",null,"");return h.createElement("div",{className:t,id:"shareReminderText"},e)};t.prototype._renderPremiumGleam=function(){return this.props.showGleam?h.createElement("img",{role:"presentation",src:"https://static2.sharepointonline.com/files/fabric/onedrive-assets/images/gleam.svg",className:"od-PasswordField-premiumGleam"}):void 0};t.prototype._onFocusPasswordFieldDetails=function(){var e=this;this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{currentPassword:"",displayNotificationText:!0,displayRemovePasswordButton:!1,hasExistingPassword:!1}),function(){e.props.onPasswordChange("")})};t.prototype._onFocusPasswordField=function(){this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{displayNotificationText:!0}))};t.prototype._onBlurPasswordField=function(){this.state.currentPassword.length>0||this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{displayNotificationText:!1}))};t.prototype._onDeletePassword=function(){var e=this;this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{currentPassword:"",disablePasswordField:!1,displayRemovePasswordButton:!1,hasExistingPassword:!1}),function(){e.props.onPasswordChange("")})};t.prototype._getPasswordFieldAriaLabel=function(){return this.state.currentPassword.length>0?y.format(b.Ue,this._currentStrengthMeterValue):b.Cr};t.prototype._getStrengthMeterValue=function(e){this._currentStrengthMeterValue=e};t.contextTypes={resize:i.func.isRequired};return t})(h.Component),fe=n(1892),le=n(1844),ce=n(1747),he=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._onAllowRoleChange=function(e){r.setState({selectedRole:e},function(){r.props.onRoleChange(e)})};r.state={selectedRole:r._getSelectedKey(t)};return r}t.prototype.render=function(){var e=this.props,t=this._getRoleSelectorProps();return h.createElement(le.e,Object(r.__assign)({},t),e.canChangePermission&&this._renderInfoIcon())};t.prototype._getRoleSelectorProps=function(){var e=Object(ce.t)({sharingInformation:this.props.sharingInformation,mode:this.props.mode,audience:this.props.selectedPermissions.audience});return{compact:!1,disabled:this.props.canChangePermission,menuPermissionOptions:e,sharingRole:this.state.selectedRole,mode:this.props.mode,clientId:this.props.clientId,ariaLabel:b.fn,onRoleChange:this._onAllowRoleChange}};t.prototype._getSelectedKey=function(e){return e.selectedPermissions.sharingRole?e.selectedPermissions.sharingRole:e.selectedPermissions.isEdit?l.e.edit:l.e.view};t.prototype._renderInfoIcon=function(){var e={maxWidth:"320px",onRenderContent:function(){return h.createElement("div",{className:"od-RoleSelector-infoTooltipContent"},b.Be)}};return h.createElement("div",{className:"od-changePermissions--info","aria-label":b.Be,"aria-haspopup":!0},h.createElement(ee.e,{id:"od-changePermissions--tooltip",directionalHint:U.e.topLeftEdge,calloutProps:{gapSpace:0},tooltipProps:e},h.createElement(Y.e,{iconName:"Info","data-is-focusable":!0,"aria-describedby":"od-changePermissions--tooltip"})))};return t})(h.Component),pe=n(1725),de=n(1851);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-PreventDownloadToggle{vertical-align:top;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;line-height:2rem}.od-PreventDownloadToggle .ms-Toggle{width:100%}.od-PreventDownloadToggle .ms-Toggle-slider{position:absolute;top:.375rem}[dir='ltr'] .od-PreventDownloadToggle .ms-Toggle-slider{right:30px}[dir='rtl'] .od-PreventDownloadToggle .ms-Toggle-slider{left:30px}[dir='ltr'] .od-PreventDownloadToggle .ms-Toggle-slider{float:right}[dir='rtl'] .od-PreventDownloadToggle .ms-Toggle-slider{float:left}.od-PreventDownloadToggle .ms-Toggle-label{padding:0;display:inline-block;margin:0 4px 0 8px;font-size:.875rem;cursor:pointer;width:calc(100% - 4.4rem)}[dir='rtl'] .od-PreventDownloadToggle .ms-Toggle-label{margin:0 8px 0 4px}.isFluent .od-PreventDownloadToggle .ms-Toggle-label{margin:0 4px 0 12px}[dir='rtl'] .isFluent .od-PreventDownloadToggle .ms-Toggle-label{margin:0 12px 0 4px}.od-PreventDownloadToggle .ms-Toggle:not(.isToggled) .ms-Toggle-label{font-weight:normal}.od-PreventDownloadToggle .ms-Toggle-innerContainer{line-height:2rem;margin-top:.25rem}[dir='ltr'] .od-PreventDownloadToggle .ms-Toggle-innerContainer{float:right}[dir='rtl'] .od-PreventDownloadToggle .ms-Toggle-innerContainer{float:left}.od-preventDownload-tooltip .ms-Icon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";cursor:pointer;font-size:.75rem}[dir='ltr'] .od-preventDownload-tooltip .ms-Icon{margin-left:10px}[dir='rtl'] .od-preventDownload-tooltip .ms-Icon{margin-right:10px}.od-preventDownload-tooltipContent{font-size:.875rem}.od-PreventDownloadToggle-label{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.od-preventDownload-tooltipWrapper{outline:transparent;position:relative}.od-preventDownload-tooltipWrapper::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-preventDownload-tooltipWrapper:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-preventDownload-tooltipWrapper:focus:after{border-color:ActiveBorder}}.od-preventDownload-hidden{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}]);var ve,me=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r.state={preventDownloadToggle:!1};r._onChanged=r._onChanged.bind(r);return r}t.prototype.render=function(){var e=this.props.disablePreventDownload,t=!e&&this.props.isToggled,n=!this.props.detailsPane&&this.props.disablePreventDownload,i=n?this.props.isRolesDropDown?y.format(b.Oi,b.he):y.format(b.Ai,b.C):b.Mi,s={maxWidth:"300px",onRenderContent:function(){return h.createElement("div",{className:"od-preventDownload-tooltipContent"},i)}};this.props.detailsPane&&(t=!0);return h.createElement("div",{className:"od-PreventDownloadToggle"},h.createElement("div",{className:"od-PermissionsSettings-setting--PreventDownload-Icon"},h.createElement(Y.e,Object(r.__assign)({iconName:"Blocked2"},{alt:b.Vt}))),h.createElement(O.e,{checked:t,disabled:e,"aria-disabled":e,className:t?"isToggled":"",label:h.createElement("div",{className:"od-PreventDownloadToggle-label"},b.Mi),ariaLabel:i,onChanged:this._onChanged,role:"switch",styles:{label:{fontSize:".875rem"},pill:{width:"2.5rem",height:"1.25rem",borderWidth:"0.0625rem",borderRadius:"0.625rem"},thumb:{width:"0.75rem",height:"0.75rem"}}}),n&&h.createElement(ee.e,{hostClassName:"od-preventDownload-tooltip",directionalHint:U.e.topCenter,calloutProps:{gapSpace:0},tooltipProps:s},h.createElement("div",{tabIndex:0,className:"od-preventDownload-tooltipWrapper"},h.createElement(Y.e,{className:"ms-Icon ms-Icon--Info",iconName:"Info","aria-label":i}))))};t.prototype._onChanged=function(e){var t=this;this.context.sharingStore.getEngagementHelper().log("PreventDownload.ToggleChanged",{clientId:this.props.clientId,scenarioId:"",mode:this.props.mode});this.setState({preventDownloadToggle:e},function(){t.props.onToggleChange(e)})};t.contextTypes={sharingStore:i.object.isRequired};return t})(h.Component),ge=n(2213),ye={"3g2":1,"3gp":1,"3gp2":1,"3gpp":1,"3mf":1,ai:1,arw:1,asf:1,avci:1,avcs:1,avi:1,bas:1,bmp:1,cbl:1,cfg:1,cool:1,cr2:1,crw:1,csv:2,cur:1,dcm:1,dcm30:1,dds:1,dib:1,dic:1,dicm:1,dicom:1,dng:1,doc:2,docm:2,docx:2,dot:2,dotm:2,dotx:2,dwg:1,eml:1,epdf:1,epub:1,erf:1,exif:1,fbx:1,flac:1,fppx:1,gif:1,hdp:1,heic:1,heics:1,heif:1,heifs:1,ico:1,icon:1,jfif:1,jpe:1,jpeg:1,jpg:1,jxr:1,kdc:1,key:1,m2ts:1,m4a:1,m4v:1,mat:1,mov:1,movie:1,mp3:1,mp4:1,mp4v:1,mrw:1,msg:1,mts:1,nef:1,notebook:2,nrw:1,numbers:1,obj:1,odf:2,odp:2,ods:2,odt:2,ogg:1,one:2,onepkg:2,onetoc2:2,opus:1,orf:1,pages:1,pano:1,pdf:1,pdfa:1,pef:1,pict:1,ply:1,png:1,pot:2,potm:2,potx:2,ppa:2,ppam:2,pps:2,ppsm:2,ppsx:2,ppsxm:1,ppt:2,pptm:2,pptx:2,psb:1,psd:1,raf:1,raw:1,rle:1,rtf:2,rw2:1,rwl:1,sketch:1,sr2:1,srw:1,stl:1,tif:1,tiff:1,vdw:2,vsd:2,vsdm:2,vsdx:2,vsl:2,vss:2,vssm:2,vssx:2,vst:2,vstm:2,vstx:2,wdp:1,webm:1,webp:1,wma:1,wmv:1,xbm:1,xcf:1,xd:1,xla:2,xlam:2,xll:2,xls:2,xlsb:2,xlsm:2,xlsx:2,xlt:2,xltm:2,xltx:2,xpm:1},be={"3fr":1,"3mf":1,ai:1,ari:1,arw:1,avci:1,avcs:1,bas:1,bay:1,bmp:1,cap:1,cbl:1,cfg:1,cool:1,cr2:1,cr3:1,crw:1,csv:2,cur:1,dcm:1,dcm30:1,dcr:1,dcs:1,dds:1,dib:1,dic:1,dicm:1,dicom:1,dng:1,doc:2,docm:2,docx:2,dot:2,dotm:2,dotx:2,drf:1,dwg:1,eip:1,eml:1,epdf:1,epub:1,erf:1,exif:1,fbx:1,fff:1,flac:1,fppx:1,gif:1,hdp:1,heic:1,heics:1,heif:1,heifs:1,ico:1,icon:1,iiq:1,jfif:1,jpe:1,jpeg:1,jpg:1,jxr:1,k25:1,kdc:1,key:1,m4a:1,mat:1,mef:1,mos:1,mp3:1,mp4:1,mrw:1,msg:1,nef:1,notebook:2,nrw:1,numbers:1,obj:1,odf:2,odp:2,ods:2,odt:2,one:2,onepkg:2,onetoc2:2,opus:1,orf:1,ori:1,pages:1,pano:1,pdf:1,pdfa:1,pef:1,pict:1,ply:1,png:1,pot:2,potm:2,potx:2,ppa:2,ppam:2,pps:2,ppsm:2,ppsx:2,ppsxm:1,ppt:2,pptm:2,pptx:2,psb:1,psd:1,ptx:1,pxn:1,raf:1,raw:1,rle:1,rtf:2,rw2:1,rwl:1,sketch:1,sr2:1,srf:1,srw:1,stl:1,tif:1,tiff:1,vdw:2,vsd:2,vsdm:2,vsdx:2,vsl:2,vss:2,vssm:2,vssx:2,vst:2,vstm:2,vstx:2,wdp:1,webp:1,wma:1,x3f:1,xbm:1,xcf:1,xd:1,xla:2,xlam:2,xll:2,xls:2,xlsb:2,xlsm:2,xlsx:2,xlt:2,xltm:2,xltx:2,xpm:1},we=n(249),Ee={ODB:1768};(function(e){e[e.None=0]="None";e[e.AllowMediaTA=1]="AllowMediaTA";e[e.OfficeOnly=2]="OfficeOnly"})(ve||(ve={}));Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-OfficeReviewModeToggle{vertical-align:top;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;line-height:2rem}.od-OfficeReviewModeToggle .ms-Toggle{width:100%}.od-OfficeReviewModeToggle .ms-Toggle-slider{position:absolute;top:.375rem}[dir='ltr'] .od-OfficeReviewModeToggle .ms-Toggle-slider{right:30px}[dir='rtl'] .od-OfficeReviewModeToggle .ms-Toggle-slider{left:30px}[dir='ltr'] .od-OfficeReviewModeToggle .ms-Toggle-slider{float:right}[dir='rtl'] .od-OfficeReviewModeToggle .ms-Toggle-slider{float:left}.od-OfficeReviewModeToggle .ms-Toggle-label{padding:0;display:inline-block;margin:0 4px 0 8px;font-size:.875rem;cursor:pointer;width:calc(100% - 4.4rem)}[dir='rtl'] .od-OfficeReviewModeToggle .ms-Toggle-label{margin:0 8px 0 4px}.isFluent .od-OfficeReviewModeToggle .ms-Toggle-label{margin:0 4px 0 12px}[dir='rtl'] .isFluent .od-OfficeReviewModeToggle .ms-Toggle-label{margin:0 12px 0 4px}.od-OfficeReviewModeToggle .ms-Toggle:not(.isToggled) .ms-Toggle-label{font-weight:normal}.od-OfficeReviewModeToggle .ms-Toggle-innerContainer{line-height:2rem;margin-top:.25rem}[dir='ltr'] .od-OfficeReviewModeToggle .ms-Toggle-innerContainer{float:right}[dir='rtl'] .od-OfficeReviewModeToggle .ms-Toggle-innerContainer{float:left}.od-OfficeReviewModeToggle-label{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.od-OfficeReviewModeToggle-learnMore{text-decoration:none;outline:transparent;position:relative;margin:0px 3px;white-space:nowrap;font:-apple-system-caption2}.od-OfficeReviewModeToggle-learnMore::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-OfficeReviewModeToggle-learnMore:focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-OfficeReviewModeToggle-learnMore:focus:after{border-color:ActiveBorder}}.od-OfficeReviewMode-tooltip .ms-Icon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";cursor:pointer;font-size:.75rem}[dir='ltr'] .od-OfficeReviewMode-tooltip .ms-Icon{margin-left:10px}[dir='rtl'] .od-OfficeReviewMode-tooltip .ms-Icon{margin-right:10px}.od-OfficeReviewMode-tooltipContent{font-size:.75rem}.od-OfficeReviewMode-tooltipWrapper{outline:transparent;position:relative;font-size:.75rem}.od-OfficeReviewMode-tooltipWrapper::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-OfficeReviewMode-tooltipWrapper:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-OfficeReviewMode-tooltipWrapper:focus:after{border-color:ActiveBorder}}.od-OfficeReviewModeToggle-tooltipWrapper{display:inline;outline:transparent;position:relative;font-size:.75rem}.od-OfficeReviewModeToggle-tooltipWrapper::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-OfficeReviewModeToggle-tooltipWrapper:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-OfficeReviewModeToggle-tooltipWrapper:focus:after{border-color:ActiveBorder}}.od-OfficeReviewMode-hidden{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0;font-size:.75rem}\n"}]);var Se={label:{fontSize:".875rem"},pill:{width:"2.5rem",height:"1.25rem",borderWidth:"0.0625rem",borderRadius:"0.625rem"},thumb:{width:"0.75rem",height:"0.75rem"}},xe=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r.state={OfficeReviewModeToggle:!1};r._onChanged=r._onChanged.bind(r);return r}t.prototype.render=function(){return this._renderReviewModeWithEllipsis()};t.prototype._renderReviewModeWithEllipsis=function(){var e=this.props.disableOfficeReviewMode,t=this.props.isToggled,n=!this.props.detailsPane&&this.props.disableOfficeReviewMode,i=n?y.format(b.cr,b.C):b.hr,s={maxWidth:"300px",onRenderContent:function(){return n?h.createElement("div",{className:"od-OfficeReviewMode-tooltipContent"},i):h.createElement("div",{className:"od-OfficeReviewMode-tooltipContent"},b.lr," ",h.createElement("a",{className:"od-OfficeReviewModeToggle-learnMore","aria-label":b.rn+": "+b.hr,href:"https://support.office.com/article/9fcc2f7d-de0c-4cec-93b0-a82024800c07",target:"_blank"},b.rn))}};return h.createElement("div",{className:"od-OfficeReviewModeToggle"},h.createElement("div",{className:"od-PermissionsSettings-setting--OfficeReviewMode-Icon"},h.createElement(Y.e,Object(r.__assign)({iconName:"Feedback"},{alt:b.Xt}))),h.createElement(O.e,{checked:t,disabled:e,"aria-disabled":e,className:t?"isToggled":"",label:h.createElement("div",{className:"od-OfficeReviewModeToggle-label"},b.hr," "),ariaLabel:i,onChanged:this._onChanged,styles:Se}),h.createElement("div",{className:n?"od-OfficeReviewModeToggle--info":"od-OfficeReviewMode-tooltip--info"},h.createElement(ee.e,{hostClassName:"od-OfficeReviewMode-tooltip",directionalHint:U.e.topCenter,calloutProps:{gapSpace:0},tooltipProps:s},h.createElement("div",{tabIndex:0,className:"od-OfficeReviewModeToggle-tooltipWrapper"},h.createElement(Y.e,{iconName:"Info","aria-label":b.lr,className:"ms-Icon ms-Icon--Info"})))))};t.prototype._onChanged=function(e){var t=this;this.context.sharingStore.getEngagementHelper().log("OfficeReviewMode.ToggleChanged",{clientId:this.props.clientId,scenarioId:"",mode:this.props.mode});this.setState({OfficeReviewModeToggle:e},function(){t.props.onToggleChange(e)})};t.contextTypes={sharingStore:i.object.isRequired};return t})(h.Component);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}[dir='ltr'] .teams .od-LinkTemplateChoiceGroup-row{padding-left:0}[dir='rtl'] .teams .od-LinkTemplateChoiceGroup-row{padding-right:0}.teams .od-LinkTemplateChoiceGroup-row.is-selected .od-ShareHintDetail-statusText{font-weight:700}.od-LinkTemplateChoiceGroup-row{background:none;border:none;cursor:pointer;margin-top:4px;width:90%;font:-apple-system-caption1}.isFluent .od-LinkTemplateChoiceGroup-row{padding:0;width:calc(100% - 24px)}.od-LinkTemplateChoiceGroup-row .od-ShareHintDetail{padding-top:2px}.od-LinkTemplateChoiceGroup-row.is-selected .od-ShareHintDetail-statusText{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";font-weight:600}.od-LinkTemplateChoiceGroup-row.is-selected .tickIcon::after{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";content:'\\e73e';font-family:'FabricMDL2Icons';font-size:16px;margin-top:8px}[dir='ltr'] .od-LinkTemplateChoiceGroup-row.is-selected .tickIcon::after{float:right}[dir='rtl'] .od-LinkTemplateChoiceGroup-row.is-selected .tickIcon::after{float:left}.isFluent .od-LinkTemplateChoiceGroup-row.is-selected .tickIcon::after{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:12px;margin-top:10px}.od-LinkTemplateChoiceGroup-row.is-disabled .od-ShareHintDetail-statusText{color:#a19f9d}.od-LinkTemplateChoiceGroup-row.is-disabled .od-ShareLinkDescription-icon{color:#a19f9d;background-color:#fafaf9;border-color:#a19f9d}@media screen and (-ms-high-contrast: active){.od-LinkTemplateChoiceGroup-row{outline:1px solid transparent}}@media screen and (-ms-high-contrast: black-on-white){.od-LinkTemplateChoiceGroup-row{outline:1px solid transparent}}.ms-Fabric--isFocusVisible .od-LinkTemplateChoiceGroup-row:focus{-webkit-box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:" inset;box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:" inset}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-LinkTemplateChoiceGroup-row:focus{-webkit-box-shadow:0 0 0 1px #1aebff inset;box-shadow:0 0 0 1px #1aebff inset}}@media screen and (-ms-high-contrast: black-on-white){.ms-Fabric--isFocusVisible .od-LinkTemplateChoiceGroup-row:focus{-webkit-box-shadow:0 0 0 1px #37006e inset;box-shadow:0 0 0 1px #37006e inset}}.od-LinkTemplateChoiceGroup-bottomBorder{border-bottom:1px solid "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.isFluent .od-LinkTemplateChoiceGroup-bottomBorder{border-bottom:0}.teams .od-LinkTemplateChoiceGroup-bottomBorder{border-bottom:0}.od-LinkTemplateChoiceGroup-description{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;overflow:hidden;width:90%}[dir='ltr'] .od-LinkTemplateChoiceGroup-description{float:left}[dir='rtl'] .od-LinkTemplateChoiceGroup-description{float:right}\n"}]);var Te=n(996),Ne=n(2065),Ce=n(1679),ke=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._onActiveElementChanged=function(e){if(!r._platformDetection.isMobile&&!C.s(r.props.clientId)&&e&&e.hasAttribute("data-key")){var t=e.getAttribute("data-key");"true"===e.getAttribute("aria-disabled")||r._onRowClick(t,null)}};r.state={selectedKey:r._getSelectedIndex(t)};r._platformDetection=n.platformDetection;return r}t.prototype._getSelectedIndex=function(e){for(var t=0,n=e.items;t<n.length;t++){var r=n[t];if(r.isChecked)return r.key}return null};t.prototype.render=function(){var e=this.props.items.map(this._renderItem,this);return h.createElement("div",{"aria-label":b.Ei,role:"radiogroup"},h.createElement(x.e,{direction:T.e.vertical,defaultActiveElement:".od-LinkTemplateChoiceGroup-row.is-selected",onActiveElementChanged:this._onActiveElementChanged},e))};t.prototype._renderItem=function(e){var t=e.key,n=e.isDisabled&&e.disabledText?e.disabledText:"",r=this.state.selectedKey===t,i=fe.e[e.permissionsType],s=e.iconUrl?h.createElement("img",{"aria-hidden":"true",className:"od-ShareLinkDescription-image",src:e.iconUrl,alt:e.label}):h.createElement(Y.e,{"aria-hidden":"true",iconName:i});return h.createElement("div",{key:t},h.createElement("button",{role:"radio","aria-checked":r,key:t,onClick:e.isDisabled?function(){}:this._onRowClick.bind(this,t),className:this._getRowClasses(e),autoFocus:r,"aria-disabled":e.isDisabled,disabled:e.isDisabled,"aria-label":e.label+" "+n,"data-key":t},h.createElement("span",{tabIndex:-1,role:"status","aria-live":"polite","aria-label":r?y.format(b.G,e.label):"",className:"od-Share-screenReaderOnly"},r?y.format(b.G,e.label):""),h.createElement("div",{className:"od-LinkTemplateChoiceGroup-description"},h.createElement("div",{className:"od-ShareLinkDescription"},h.createElement("div",{className:"od-ShareLinkDescription-icon icon-"+i,"aria-hidden":"true"},s),this._renderLabel(e))),h.createElement("div",{className:"tickIcon","aria-hidden":!0})),h.createElement("div",{className:"od-LinkTemplateChoiceGroup-bottomBorder"}))};t.prototype._renderLabel=function(e){var t=e.isDisabled&&e.disabledText?e.disabledText:"";t&&h.createElement(Ne.e,{message:t});return h.createElement("div",{className:"od-ShareHintDetail"},h.createElement("div",{className:"od-ShareHintDetail-description"},h.createElement("div",{className:"od-ShareHintDetail-status"},h.createElement("span",{className:"od-ShareHintDetail-statusText"},e.label),this._renderStatusIcons(e.link))))};t.prototype._renderStatusIcons=function(e){if(e){var t=e.expiration,n=e.hasPassword,r=e.blockDownload,i=[];t&&t.getTime()!==new Date(0).getTime()&&i.push({icon:"Calendar",tooltip:""+y.format(b.bt,Object(Te.s)(t))});n&&i.push({icon:"Lock",tooltip:b.Ds});r&&i.push({icon:"Blocked2",tooltip:b.Li});e.audience!==f.e.existing&&e.isReview&&Ce.t[this.props.sharingInformation.fileExtension]&&i.push({icon:"Feedback",tooltip:b.lr});var s=i.map(function(e,t){return h.createElement("i",{className:"od-ShareHintDetail-item"},h.createElement(ee.e,{content:e.tooltip,id:e.icon},h.createElement(Y.e,{iconName:e.icon,"aria-describedby":e.icon})))});return h.createElement("div",{className:"od-ShareHintDetail-iconsList"},s)}};t.prototype._getRowClasses=function(e){var t="od-ModifyPermissions-margins od-LinkTemplateChoiceGroup-row";this.state.selectedKey===e.key&&(t+=" is-selected");e.isDisabled&&(t+=" is-disabled");return t};t.prototype._onRowClick=function(e,t){var n=this.props;this.setState({selectedKey:e});n.onChange(e);n.onLinkTemplateChange(e)};t.contextTypes={platformDetection:i.object.isRequired};return t})(h.Component),Le=n(1923),Ae=n(1688),Oe=n(1771),Me=(function(e){Object(r.__extends)(t,e);function t(t,n){var i,s,o=e.call(this,t)||this;o._allowEditCheckbox=Object(h.createRef)();o._pickerUpsellDiv=Object(h.createRef)();o._passwordUpsellDiv=Object(h.createRef)();o._learnMoreClicked=function(){o.context.sharingStore.getEngagementHelper().linkSettingsLearnMoreClicked(o.props.engagementExtraData)};o._onPeoplePickerChange=function(e){o.setState(Object(r.__assign)(Object(r.__assign)({},o.state),{externalRecipientWarning:pe.n(e),groupRecipientWarning:pe.r(e,o.props.groupsMemberCount)}),function(){o.props.onPeoplePickerChange(e)})};o._setSpecificPeopleReadOnlyExpanded=function(){o.setState({isSpecificPeopleReadOnlyExpanded:!0})};o._onAllowRoleChange=function(e){var t=!1,n=!1;e===l.e.edit&&(t=!0);e===l.e.review&&(n=!0);o.setState(Object(r.__assign)(Object(r.__assign)({},o.state),{preventDownloadDisabled:t||n}),function(){o.props.onRoleChange(e)})};o._onResolvedSuggestions=function(e){o.context.sharingStore.getEngagementHelper().peoplePickerLinkedinSuggestions(o.props.engagementExtraData,e);return e};o._resize=n.resize;var u=t.selectedPermissions.specificPeople;o.state={expirationErrorCode:Z.e.none,externalRecipientWarning:pe.n(u),groupRecipientWarning:pe.r(u,t.groupsMemberCount),preventDownloadDisabled:o.props.selectedPermissions.isEdit||o.props.selectedPermissions.isReview,officeReviewModeDisabled:!1===o.props.selectedPermissions.isEdit&&!1===o.props.selectedPermissions.isReview,showPickerTeachingBubble:!1,showPasswordTeachingBubble:!1,isSpecificPeopleReadOnlyExpanded:!1};o._onAllowEditChange=o._onAllowEditChange.bind(o);o._onTrackableChange=o._onTrackableChange.bind(o);o._onChoiceGroupChange=o._onChoiceGroupChange.bind(o);o._onLinkTemplateChoiceChange=o._onLinkTemplateChoiceChange.bind(o);o._onSelectDate=o._onSelectDate.bind(o);o._renderExpirationDatePicker=o._renderExpirationDatePicker.bind(o);o._renderExpirationDatePickerErrorMessage=o._renderExpirationDatePickerErrorMessage.bind(o);o._renderPeoplePicker=o._renderPeoplePicker.bind(o);o._permissionsOptions=o._getAudienceChoiceGroupOptions();o._linkTemplateOptions=o._getLinkTemplateOptions();o._supportedAudienceOptions=n.sharingStore.getSupportedAudienceOptions();o._hiddenAudienceOptions=(null===(i=t.hostOptions)||void 0===i?void 0:i.hiddenAudienceOptions)||[];o._disabledAudienceOptions=(null===(s=t.hostOptions)||void 0===s?void 0:s.disabledAudienceOptions)||[];return o}t.prototype.componentDidMount=function(){var e=this;this._disablePremiumFeatures=!this.context.sharingStore.isPremiumExperienceAllowed();if(this._disablePremiumFeatures){if(this._pickerUpsellDiv.current){this._pickerUpsellDiv.current.addEventListener("click",function(t){e._togglePickerTeachingBubble()});this._pickerUpsellDiv.current.addEventListener("keydown",function(t){t.keyCode!==L.e.enter&&t.keyCode!==L.e.space||e._togglePickerTeachingBubble()})}if(this._passwordUpsellDiv.current){this._passwordUpsellDiv.current.addEventListener("click",function(t){e._togglePasswordTeachingBubble()});this._passwordUpsellDiv.current.addEventListener("keydown",function(t){t.keyCode!==L.e.enter&&t.keyCode!==L.e.space||e._togglePasswordTeachingBubble()})}}var t,n,r=document.getElementsByClassName("od-PermissionsSettings-allowEdit")[0];if(r){t=r.getElementsByClassName("ms-Checkbox-text")[0];n=r.children[0]}t&&t.setAttribute("aria-hidden","true");if(n){n.setAttribute("aria-label",b.C);this.context.sharingStore.isPremiumExperienceAllowed()||n.focus()}};t.prototype.componentDidUpdate=function(e,t){this._resize()};t.prototype.render=function(){var e=this.props;this._disablePremiumFeatures=!this.context.sharingStore.isPremiumExperienceAllowed();return this._getLinkTemplateOptions().length>0?h.createElement("div",{className:"od-PermissionsSettings"},h.createElement("div",{className:"od-PermissionsSettings-section"},h.createElement("div",{className:"od-PermissionsSettings-description od-ModifyPermissions-margins"},h.createElement("span",{className:"od-PermissionsSettings-linksFromTemplateHeader"},b.pn)),h.createElement("div",{className:"od-PermissionsSettings-bottomBorder"}),h.createElement(ke,{items:this._getLinkTemplateOptions(),onChange:this._onLinkTemplateChoiceChange,onLinkTemplateChange:e.onLinkTemplateChange,companyName:e.companyName,clientId:e.clientId,sharingInformation:e.sharingInformation}),this._renderPeoplePicker())):this._getAudienceOptions().length>1?h.createElement("div",{className:"od-PermissionsSettings"},h.createElement("div",{className:"od-PermissionsSettings-section"},h.createElement("div",{className:"od-PermissionsSettings-description od-ModifyPermissions-margins"},h.createElement("span",{className:"od-PermissionsSettings-prompt",id:"od-PermissionsSettings-prompt-id"},b.Ei),this.context.sharingStore.showAudienceLearnMore()&&h.createElement("a",{className:"od-PermissionsSettings-learnMore","aria-label":b.rn+": "+b.Ei,href:"https://go.microsoft.com/fwlink/?linkid=846149",target:"_blank",onClick:this._learnMoreClicked,tabIndex:0},b.rn)),h.createElement("div",{className:"od-PermissionsSettings-bottomBorder"}),h.createElement(k,{items:this._getAudienceOptions(),onChange:this._onChoiceGroupChange,onAudienceChange:e.onAudienceChange,companyName:e.companyName,clientId:e.clientId,engagementExtraData:e.engagementExtraData}),this._renderPeoplePicker()),this._renderOtherSettings()):h.createElement("div",{className:"od-PermissionsSettings"},h.createElement("div",{className:"od-PermissionsSettings-section"},h.createElement("div",{className:"od-PermissionsSettings-bottomBorder"})),this._renderOtherSettings())};t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this,n=e.selectedPermissions,i=n.specificPeople;0===i.length&&e.recipients.length>0&&this._onPeoplePickerChange(e.recipients);this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{expirationErrorCode:Object(Z.d)(n.expiration,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays),externalRecipientWarning:pe.n(i),groupRecipientWarning:pe.r(i,e.groupsMemberCount),preventDownloadDisabled:n.isEdit||n.isReview,officeReviewModeDisabled:!n.isEdit&&!n.isReview}),function(){t.props.updateExpirationErrorCode(t.state.expirationErrorCode)})};t.prototype._togglePickerTeachingBubble=function(){this.setState({showPickerTeachingBubble:!this.state.showPickerTeachingBubble})};t.prototype._togglePasswordTeachingBubble=function(){this.setState({showPasswordTeachingBubble:!this.state.showPasswordTeachingBubble})};t.prototype._renderOtherSettings=function(){var e=!0;Ae.i()&&(e=!this._disablePremiumFeatures||!this.context.sharingStore.disablePremiumUpsell());if(this.props.selectedPermissions.audience!==f.e.existing&&!this.props.sharingInformation.requiresAccessApproval)return h.createElement("div",{className:"od-PermissionsSettings-section od-ModifyPermissions-margins"},h.createElement("div",{className:"od-PermissionsSettings-description"},b.mr),h.createElement("div",{role:"group","aria-label":b.mr},h.createElement("div",{className:"od-PermissionsSettings-setting"},this._renderRolesDropDown()),this._renderOfficeReviewModeToggle(),e&&this._renderExpirationDatePicker(),this.props.sharingInformation.anyoneLinkTrackUsers&&this._renderRequireVerificationToggle(),e&&this._renderPasswordField(),this._renderPreventDownloadToggle()))};t.prototype._getSpecificPeopleOption=function(){var e=this.props.sharingInformation.requiresAccessApproval,t=e?b.wi:this._getSpecificPeopleLabel(),n=!this.props.createPeopleSharingLinks||e?[1]:[6],r=this.props.createPeopleSharingLinks?f.e.specificPeopleFlex:f.e.specificPeople;return{disabledText:b.Ye,icon:fe.e[2],isChecked:!1,isDisabled:!1,key:r,label:t,linkKinds:n,permissionsType:2}};t.prototype._getAudienceChoiceGroupOptions=function(){var e=[{disabledText:b.Ye,icon:fe.e[0],isChecked:!1,isDisabled:!1,key:f.e.anyone,label:b.li,linkKinds:[4,5],permissionsType:0},{disabledText:b.Ye,icon:fe.e[1],isChecked:!1,isDisabled:!1,key:f.e.organization,label:y.format(b.ci,this.props.companyName),linkKinds:[2,3],permissionsType:1},this._getSpecificPeopleOption()];if(this.props.showExistingAccessOption||!this.props.sharingInformation.canManagePermissions||this.props.sharingInformation.blockPeoplePickerAndSharing){var t={icon:fe.e[1],isChecked:!1,isDisabled:!1,key:f.e.existing,label:b.hi,linkKinds:[1],permissionsType:4};e.splice(2,0,t)}return e};t.prototype._renderPeoplePicker=function(){var e=this.props,t=this.state;return e.selectedPermissions.audience!==f.e.specificPeople&&e.selectedPermissions.audience!==f.e.specificPeopleFlex||!e.copyLinkShortcut&&e.mode!==o.e.linkSettings?void 0:C.f(this.props.clientId)?h.createElement("div",{className:"od-PermissionsSetting-specificPeople-container"},e.currentSettings.specificPeople.length>0?this._renderReadOnlySpecificPeople():void 0):h.createElement("div",{className:"od-ModifyPermissions-margins od-PermissionsSettings-PeoplePicker"},h.createElement(de.e,{defaultSelectedItems:e.selectedPermissions.specificPeople,onChange:this._onPeoplePickerChange,oversharingExternalsWarning:t.externalRecipientWarning,oversharingGroupsWarning:t.groupRecipientWarning,pickerSettings:e.sharingInformation.peoplePickerSettings,error:e.peoplePickerError,sharingInformation:e.sharingInformation,clientId:this.props.clientId,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),onResolvedSuggestions:this._onResolvedSuggestions,onInputChange:this.props.onPeoplePickerInputChange||null}))};t.prototype._renderReadOnlySpecificPeople=function(){for(var e="",t=this.props.currentSettings.specificPeople,n=this.state.isSpecificPeopleReadOnlyExpanded?t.length:5,r=t.length-n,i=0;i<Math.min(t.length,n);i++)e+=t[i].name+(t.length-1>i?", ":"");var s=r>0&&!this.state.isSpecificPeopleReadOnlyExpanded?h.createElement("a",{href:"javascript:void(0)",onClick:this._setSpecificPeopleReadOnlyExpanded}," +"+r):void 0;return h.createElement("div",{className:"od-PermissionsSetting-specificPeople-list"},e,s)};t.prototype._renderRolesDropDown=function(){var e=this.props,t=ce.u(e.selectedPermissions.audience,e.sharingInformation.sharingAbilities,e.sharingInformation.fileExtension),n=e.sharingInformation.sharedObjectType===Oe.e.list;if(t||n)return h.createElement("div",{className:"od-PermissionsSettings-changePermission"},h.createElement(he,{mode:e.mode,clientId:e.clientId,selectedPermissions:e.selectedPermissions,onRoleChange:this._onAllowRoleChange,canChangePermission:!1,sharingInformation:this.props.sharingInformation}));return h.createElement(A.e,{className:"od-PermissionsSettings-allowEdit",label:b.C,onChange:this._onAllowEditChange,checked:e.selectedPermissions.isEdit,disabled:!e.selectedPermissions.allowEditing,componentRef:this._allowEditCheckbox,styles:{text:{fontSize:"0.875rem",lineHeight:"1.25rem"},checkbox:{width:"1.25rem",height:"1.25rem"},checkmark:{fontSize:"0.875rem"}}})};t.prototype._renderRequireVerificationToggle=function(){var e=this.props,t=e.selectedPermissions,n=this.props.sharingInformation.anyoneLinkTrackUsers,r=Ae.h()&&C.n(e.clientId),i=!r,s=!1;if(t.audience===f.e.anyone){s=!(!n||r)||t.trackLinkUsers;return h.createElement("div",{className:"od-PermissionsSettings-setting"},h.createElement("div",{className:"od-PermissionsSettings-setting--RequireVerification"},h.createElement("div",{className:"od-RequireVerificationToggle"},h.createElement("div",{className:"od-PermissionsSettings-setting--RequireVerification-Icon"},h.createElement(Y.e,{iconName:"ReminderPerson"})),h.createElement(O.e,{"aria-disabled":i,role:"checkbox",checked:s,disabled:i,label:r?b.ds:b.ms,onChange:this._onTrackableChange,styles:{label:{fontSize:".875rem"},pill:{width:"2.5rem",height:"1.25rem",borderWidth:"0.0625rem",borderRadius:"0.625rem"},thumb:{width:"0.75rem",height:"0.75rem"}}}))))}};t.prototype._renderExpirationDatePicker=function(){var e=this.props,t=e.selectedPermissions;return this.context.sharingStore.isExpirationDateModificationAllowed()&&(t.audience===f.e.anyone||this.context.sharingStore.isSpecificPeopleExpirationAllowed()&&t.audience===f.e.specificPeople)?this._disablePremiumFeatures?h.createElement("div",{ref:this._pickerUpsellDiv,className:"od-PermissionsSettings-wrapper",tabIndex:0},h.createElement("div",{className:"od-PermissionsSettings-blocker","aria-hidden":"true"},h.createElement("div",{className:"od-PermissionsSettings-setting"},h.createElement("div",{className:"od-PermissionsSettings-datePicker"},h.createElement(ne,{clientId:this.props.clientId,onSelectDate:this._onSelectDate,value:t.expiration,expiryRestriction:e.sharingInformation.anonymousLinkExpirationRestrictionDays,disableAutoFocus:this._disablePremiumFeatures,hideRemoveDateButton:this._disablePremiumFeatures,showGleam:this._disablePremiumFeatures,tabIndex:-1})),this._renderExpirationTeachingBubble(),h.createElement("span",{className:"od-PermissionsSettings-expirationError",role:"alert","aria-live":"assertive"},this._renderExpirationDatePickerErrorMessage())))):h.createElement("div",{className:"od-PermissionsSettings-setting"},h.createElement("div",{className:"od-PermissionsSettings-datePicker"},h.createElement(ne,{clientId:this.props.clientId,onSelectDate:this._onSelectDate,value:t.expiration,expiryRestriction:e.sharingInformation.anonymousLinkExpirationRestrictionDays,disableAutoFocus:this._disablePremiumFeatures,hideRemoveDateButton:this._disablePremiumFeatures,showGleam:this._disablePremiumFeatures})),this._renderExpirationTeachingBubble(),this._renderExpirationDatePickerErrorMessage()):void 0};t.prototype._renderExpirationTeachingBubble=function(){var e=this;if(this.state.showPickerTeachingBubble){var t={targetElement:this._pickerUpsellDiv.current,onDismiss:function(t){return e.setState({showPickerTeachingBubble:!1})},headline:b.dt,mainText:b.vt};return this._renderUpsellTeachingBubble(t)}};t.prototype._renderExpirationDatePickerErrorMessage=function(){var e=this.state.expirationErrorCode,t=Object(Z.p)(e,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays);if(""!==t)return h.createElement("span",{className:"od-PermissionsSettings-expirationError",role:"alert","aria-live":"assertive"},t)};t.prototype._renderPasswordField=function(){var e=this.props,t=this.context.sharingStore.isPasswordModificationAllowed(),n=e.selectedPermissions;return t&&n.audience===f.e.anyone?this._disablePremiumFeatures?h.createElement("div",{ref:this._passwordUpsellDiv,className:"od-PermissionsSettings-wrapper",tabIndex:0},h.createElement("div",{className:"od-PermissionsSettings-blocker","aria-hidden":"true"},h.createElement("div",{className:"od-PermissionsSettings-setting"},h.createElement(ae,{onPasswordChange:this.props.onPasswordChange,readOnly:!0,showGleam:!0,tabIndex:-1}),this._renderPasswordTeachingBubble()))):h.createElement("div",{className:"od-PermissionsSettings-setting"},h.createElement(ae,{onPasswordChange:this.props.onPasswordChange})):void 0};t.prototype._renderPasswordTeachingBubble=function(){var e=this;if(this.state.showPasswordTeachingBubble){var t={targetElement:this._passwordUpsellDiv.current,onDismiss:function(t){return e.setState({showPasswordTeachingBubble:!1})},headline:b.Ir,mainText:b.qr};return this._renderUpsellTeachingBubble(t)}};t.prototype._getLinkTemplateOptions=function(){var e=[],t=this.props.sharingInformation,n=t.sharingLinkTemplates,r=t.sharingAbilities,i=ce.i(r,n);if(i.length>0){for(var s=0,o=i;s<o.length;s++){var u=o[s];e.push(this._getLinkTemplateOption(u))}var a={icon:fe.e[1],isChecked:this.props.currentSettings.audience===f.e.existing,isDisabled:!1,key:f.e.existing.toString(),label:b.hi,linkKinds:[1],permissionsType:4};e.push(a);var l=this.props.sharingInformation.requiresAccessApproval?b.wi:this._getSpecificPeopleLabel(),c={icon:fe.e[2],isChecked:this.props.currentSettings.audience===f.e.specificPeople,isDisabled:!1,key:f.e.specificPeople.toString(),label:l,linkKinds:[1],permissionsType:2};e.push(c)}return e};t.prototype._getLinkTemplateOption=function(e){var t={icon:fe.e[0],isChecked:!1,isDisabled:!1,key:null,label:null,linkKinds:[4,5],permissionsType:0,link:e},n={icon:fe.e[1],isChecked:!1,isDisabled:!1,key:null,label:null,linkKinds:[2,3],permissionsType:1,link:e};switch(e.audience){case f.e.anyone:t.key=e.shareId;t.label=Object(Z.b)(e,this.props.companyName,this.props.clientId,null,this.props.sharingInformation.fileExtension);return t;case f.e.organization:n.key=e.shareId;n.label=Object(Z.b)(e,this.props.companyName,this.props.clientId,null,this.props.sharingInformation.fileExtension);return n}};t.prototype._getAudienceOptions=function(){var e=this.props.sharingInformation.sharingAbilities,t=this.props.sharingInformation,n=[],r=this.props.currentSettings,i=void 0;for(var s in e)if(e.hasOwnProperty(s)){var u=e[s];if(null!==u){var a=ce.n(s),l=n.map(function(e){return e.key}).indexOf(a)>-1;if(!a||l)continue;if(a===f.e.specificPeopleFlex&&!this.props.createPeopleSharingLinks){i=this._getSpecificPeopleOption();t.canManagePermissions&&!t.blockPeoplePickerAndSharing?i.isChecked=i.key===r.audience||f.e.specificPeopleFlex===r.audience:i.isDisabled=!0;this._supportedAudienceOptions.indexOf(f.e.specificPeople)>-1&&n.push(i);continue}if(y=this._getAudienceOption(a)){y.isDisabled=!(u.canManageEditLink.enabled||u.canManageReadLink.enabled);y.isChecked=y.key===r.audience;n.push(y)}}}var c={icon:fe.e[1],isChecked:r.audience===f.e.existing,isDisabled:!1,key:f.e.existing,label:b.hi,linkKinds:[1],permissionsType:4};-1!==this._supportedAudienceOptions.indexOf(f.e.existing)&&n.splice(2,0,c);var h=n.filter(function(e){return e.key===f.e.specificPeople&&!e.isDisabled||e.key===f.e.specificPeopleFlex&&!e.isDisabled?e:null}).length>0,p=!this.props.omitCustomLabeledAudience&&Object(Z.C)(this.props.clientId,this.props.mode,this.props.customLabeledAudienceConfig);if(h&&p){var d=this._getAudienceOption(f.e.customLabeledSpecificPeople);n.splice(2,0,d);d.isDisabled=!(this.props.sharingInformation.canAddInternalPrincipal||this.props.sharingInformation.canAddExternalPrincipal);d.isChecked=r.audience===f.e.customLabeledSpecificPeople||this.props.preferCustomLabeledAudience&&r.audience===f.e.specificPeopleFlex}this.props.mode!==o.e.linkSettings||!C.f(this.props.clientId)||this.props.shareId&&r.audience===f.e.specificPeopleFlex||!h||n.splice(n.indexOf(h),1);for(var v=[],m=0,g=n;m<g.length;m++){var y=g[m];if(-1===this._hiddenAudienceOptions.indexOf(y.key)||r.audience===y.key){-1!==this._disabledAudienceOptions.indexOf(y.key)&&r.audience!==y.key&&(y.isDisabled=!0);v.push(y)}}return v};t.prototype._renderPreventDownloadToggle=function(){var e=this.props.selectedPermissions,t=!!e.preventDownload,n=this.context.sharingStore.isPreventDownloadAllowed();return!!!this.context.sharingStore.getNavId()&&n&&ce.a(e.audience,this.props.sharingInformation.sharingAbilities)&&(function(e,t){if(!e)return!1;e=("."===e[0]?e.slice(1):e).toLowerCase();return we.e.isFeatureEnabled(Ee)?ye[e]>=t:be[e]>=t})(this.props.sharingInformation.fileExtension,1)?h.createElement("div",{className:"od-PermissionsSettings-setting"},h.createElement("div",{className:"od-PermissionsSettings-setting--PreventDownload"},h.createElement(me,{onToggleChange:this.props.onToggleChange,isToggled:t,clientId:this.props.clientId,mode:this.props.mode,disablePreventDownload:this.state.preventDownloadDisabled,isRolesDropDown:e.isReview}))):void 0};t.prototype._renderOfficeReviewModeToggle=function(){var e=this.props.selectedPermissions,t=!!e.isReview;return ce.o(e.audience,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension)?h.createElement("div",{className:"od-PermissionsSettings-setting"},h.createElement("div",{className:"od-PermissionsSettings-setting--OfficeReviewMode"},h.createElement(xe,{onToggleChange:this.props.onOfficeReviewModeToggleChange,isToggled:t,clientId:this.props.clientId,mode:this.props.mode,disableOfficeReviewMode:this.state.officeReviewModeDisabled}))):void 0};t.prototype._renderUpsellTeachingBubble=function(e){var t,n=function(){return window.open("https://onedrive.live.com/about/plans/")};if(this.context.goPremium)n=this.context.goPremium;else try{var r=window.external;r.IsGoPremiumAvailable()&&(n=function(){try{r.GoPremium("https://onedrive.live.com/about/plans/")}catch(e){}})}catch(e){}if(this.context.premiumLearnMore)t={children:b.xo,onClick:this.context.premiumLearnMore};else try{var i=window.external;if(i.IsPremiumLearnMoreAvailable()){t={children:b.xo,onClick:function(){try{i.PremiumLearnMore()}catch(e){}}}}}catch(e){}return h.createElement(ge.e,{targetElement:e.targetElement,onDismiss:e.onDismiss,hasCloseIcon:!0,headline:e.headline,primaryButtonProps:{children:b.To,onClick:n},secondaryButtonProps:t,calloutProps:{className:"od-PermissionsSettings-teachingBubble"},hasSmallHeadline:!0,styles:{headline:{fontSize:"0.875rem"},bodyContent:{fontSize:"0.875rem"},subText:{fontSize:"0.875rem"},primaryButton:{fontSize:"0.875rem",height:"2rem",padding:"0 1rem",selectors:{".ms-Button-label":{fontSize:"0.875rem"}}},closeButton:{fontSize:"0.75rem",width:"2rem",height:"2rem",selectors:{".ms-Button-icon":{fontSize:"0.75rem"}}}}},h.createElement(Y.e,{iconName:"Diamond",className:"od-PermissionsSettings-teachingBubbleIcon"}),e.mainText)};t.prototype._getAudienceOption=function(e){if(e===f.e.anyone&&this._supportedAudienceOptions.indexOf(f.e.anyone)>-1)return{disabledText:b.Ye,icon:fe.e[0],isChecked:!1,isDisabled:!1,key:f.e.anyone,label:b.li,linkKinds:[4,5],permissionsType:0};if(e===f.e.organization&&this._supportedAudienceOptions.indexOf(f.e.organization)>-1)return{disabledText:b.Ye,icon:fe.e[1],isChecked:!1,isDisabled:!1,key:f.e.organization,label:y.format(b.ci,this.props.companyName),linkKinds:[2,3],permissionsType:1};if(e===f.e.specificPeopleFlex&&this._supportedAudienceOptions.indexOf(f.e.specificPeopleFlex)>-1)return{disabledText:b.Ye,icon:fe.e[2],isChecked:!1,isDisabled:!1,key:f.e.specificPeopleFlex,label:this._getSpecificPeopleLabel(),linkKinds:[6],permissionsType:2};if(e===f.e.customLabeledSpecificPeople&&this._supportedAudienceOptions.indexOf(f.e.customLabeledSpecificPeople)>-1){var t=C.f(this.props.clientId),n=t?6:5,r="",i=this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.audienceType;r=t||"recipient"===i?b.bi:"channel"===i?b.mi:"team"===i?b.yi:b.gi;return{disabledText:b.Ye,icon:!(this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl)&&fe.e[n],iconUrl:this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl,isChecked:!1,isDisabled:!1,key:f.e.customLabeledSpecificPeople,label:this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?y.format(b.vi,this.props.customLabeledAudienceConfig.entityName):r,linkKinds:[6],permissionsType:!(this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl)&&n}}};t.prototype._getSpecificPeopleLabel=function(){if(Ae.c()){var e=void 0;switch(Le.n()){case 0:e=b.Si;break;case 1:e=y.format(b.xi,this.props.companyName);break;case 2:e=y.format(b.Ti,this.props.companyName);break;default:e=b.Si}return e}return b.Si};t.prototype._onChoiceGroupChange=function(e){for(var t=0,n=this._permissionsOptions;t<n.length;t++){var r=n[t];r.isChecked=e===r.key}};t.prototype._onLinkTemplateChoiceChange=function(e){for(var t=0,n=this._linkTemplateOptions;t<n.length;t++){var r=n[t];r.isChecked=e===r.key}};t.prototype._onSelectDate=function(e){var t=this,n=Object(Z.d)(e,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays);this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{expirationErrorCode:n}),function(){t.props.updateExpirationErrorCode(n);t.props.onExpirationChange(e)})};t.prototype._onTrackableChange=function(e,t){this.props.onTrackableChange(t);this.context.sharingStore.getEngagementHelper().linkTrackLinkClicked(this.props.engagementExtraData)};t.prototype._onAllowEditChange=function(e,t){this.props.onEditChange(t);this.context.sharingStore.getEngagementHelper().linkSettingsOnAllowEditingClicked(this.props.engagementExtraData);this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{preventDownloadDisabled:t,officeReviewModeDisabled:!!t}))};t.contextTypes={resize:i.func.isRequired,sharingStore:i.object.isRequired,goPremium:i.func,platformDetection:i.object.isRequired,premiumLearnMore:i.func};return t})(h.Component),_e=n(1758),De={root:{height:"2rem",borderRadius:"0.125rem",padding:"0 1rem"},icon:{fontSize:"1rem",height:"1rem",lineHeight:"1rem"},flexContainer:{height:"2rem"},label:{fontSize:"0.875rem"}},Pe=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._currentPassword="";r._matchingTemplate=null;r._peoplePickerHasUnresolvedText=!1;r._topLevelDivRef=h.createRef();r._onPeoplePickerInputChange=function(e){r._peoplePickerHasUnresolvedText=""!==e};r._currentPassword="";r.state=r._initializeState();r._preventDownloadToggle=!!r.state.selectedPermissions.preventDownload;r._officeReviewModeToggle=!!r.state.selectedPermissions.isReview;r._initializeState=r._initializeState.bind(r);r._onApplyClicked=r._onApplyClicked.bind(r);r._onCancel=r._onCancel.bind(r);r._onPeoplePickerChange=r._onPeoplePickerChange.bind(r);r._updateExpirationErrorCode=r._updateExpirationErrorCode.bind(r);r.onAudienceChange=r.onAudienceChange.bind(r);r.onLinkTemplateChange=r.onLinkTemplateChange.bind(r);r.onEditChange=r.onEditChange.bind(r);r.onRoleChange=r.onRoleChange.bind(r);r.onExpirationChange=r.onExpirationChange.bind(r);r.onTrackableChange=r.onTrackableChange.bind(r);r._getShareLinkTemplate=r._getShareLinkTemplate.bind(r);r._findMatchingShareLinkTemplate=r._findMatchingShareLinkTemplate.bind(r);r._calculateRole=r._calculateRole.bind(r);r._onPasswordChange=r._onPasswordChange.bind(r);r._onPreventDownloadToggleChange=r._onPreventDownloadToggleChange.bind(r);r._onOfficeReviewModeToggleChange=r._onOfficeReviewModeToggleChange.bind(r);r._onConfirmationUseExisting=r._onConfirmationUseExisting.bind(r);r._onConfirmationUseNew=r._onConfirmationUseNew.bind(r);r._shareClickTime=n.shareClickTime;r._resizeTracker=new oe.e(n.resize);return r}t.prototype.componentDidMount=function(){_e.l(this._shareClickTime,this.props.clientId,o.e.linkSettings,this.props.scenarioId,this.props.correlationId);this._resizeIfNeeded()};t.prototype.componentDidUpdate=function(){this._resizeIfNeeded()};t.prototype.render=function(){var e=this.state.showActivityIndicator?" blocker":"",t=C.e(this.props.clientId),n=ce.i(this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.sharingLinkTemplates),i="od-ModifyPermissions-section";this.context.sharingStore&&this.context.sharingStore.getSupportedAudienceOptions().length<=1&&(i+=" od-ModifyPermissions-section-noAudienceMod");return h.createElement("div",{ref:this._topLevelDivRef,className:"od-ModifyPermissions "+e+" "+(Ae.m()?"wide":"")},h.createElement(S.e,Object(r.__assign)({},Object(E.e)(this.props),{item:this.props.sharingInformation.item,viewState:n.length>0?12:2,mode:this.props.mode})),h.createElement("div",{className:i},h.createElement(Me,Object(r.__assign)({},Object(E.e)(this.props),{mode:this.props.mode,shareId:this.props.shareId,companyName:Z.P(this.props.companyName),currentSettings:this.props.currentSettings,onAudienceChange:this.onAudienceChange,onLinkTemplateChange:this.onLinkTemplateChange,onEditChange:this.onEditChange,onRoleChange:this.onRoleChange,onExpirationChange:this.onExpirationChange,onTrackableChange:this.onTrackableChange,onPeoplePickerChange:this._onPeoplePickerChange,peoplePickerError:this.state.peoplePickerError,selectedPermissions:this.state.selectedPermissions,sharingInformation:this.props.sharingInformation,showExistingAccessOption:this.props.showExistingAccessOption,updateExpirationErrorCode:this._updateExpirationErrorCode,groupsMemberCount:this.props.groupsMemberCount,createPeopleSharingLinks:this.props.createPeopleSharingLinks,copyLinkShortcut:this.props.copyLinkShortcut,onPasswordChange:this._onPasswordChange,onToggleChange:this._onPreventDownloadToggleChange,onOfficeReviewModeToggleChange:this._onOfficeReviewModeToggleChange,engagementExtraData:this.props.engagementExtraData,recipients:this.props.recipients,isLoadingDefaultRecipients:this.props.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,onPeoplePickerInputChange:this._onPeoplePickerInputChange}))),t?h.createElement("div",{className:"od-ModifyPermissions-actions",id:"od-ModifyPermissions-actions-id"},this._renderDefaultButton(),this._renderPrimaryButton()):h.createElement("div",{className:"od-ModifyPermissions-actions"},this._renderPrimaryButton(),this._renderDefaultButton()),this._renderActivityIndicator(),this.state.showConfirmationDialog&&this._renderConfirmationDialog())};t.prototype.onLinkTemplateChange=function(e){var t=this.props.sharingInformation.sharingLinkTemplates.find(function(t){return!!t.linkDetails&&t.linkDetails.shareId===e}),n={allowEditing:!0,audience:f.e.existing,expiration:null,isEdit:!1,isReview:!1,sharingRole:l.e.view,preventDownload:!1,sharingLinkKind:1,specificPeople:[],updatePassword:!1,hasPassword:!1,password:"",shareId:""};if(t){var i=t.linkDetails;n.shareId=i.shareId;n.fetchLinkOnly=!0;n.audience=i.audience;n.expiration=i.expiration;n.isEdit=i.isEdit;n.isReview=i.isReview;n.hasPassword=i.hasPassword;n.sharingRole=i.isEdit?Object(Z.c)(this.props.clientId,this.props.sharingInformation):i.isReview?l.e.review:l.e.view;n.trackLinkUsers=i.trackLinkUsers;n.preventDownload=i.blockDownload;n.sharingLinkKind=i.sharingLinkKind}else e===f.e.existing.toString()?n.audience=f.e.existing:e===f.e.specificPeople.toString()&&(n.audience=f.e.specificPeople);this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{peoplePickerError:null,selectedPermissions:n}))};t.prototype.onAudienceChange=function(e){var t=this.state.selectedPermissions,n=this._isAllowEditingEnabled(e),i=t.isEdit&&n,s=t.isReview&&(ce.u(e,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension)||ce.o(e,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension)),o=s?6:Object(Z.y)(e,i),u=e===f.e.anyone||e===f.e.specificPeople&&this.context.sharingStore.isSpecificPeopleExpirationAllowed()?t.expiration:Object(Z.l)(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays),a=l.e.view;s?a=l.e.review:i&&(a=Object(Z.c)(this.props.clientId,this.props.sharingInformation));var c={allowEditing:n,audience:e,expiration:u,isEdit:i,isReview:s,sharingRole:a,preventDownload:t.preventDownload&&!i&&!s,sharingLinkKind:o,specificPeople:[],updatePassword:!1,hasPassword:!1,password:"",shareId:"",trackLinkUsers:t.trackLinkUsers};this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{peoplePickerError:null,selectedPermissions:c}))};t.prototype.onEditChange=function(e){var t=this.state.selectedPermissions,n=Object(Z.y)(t.audience,e),i=l.e.view;e&&(i=t.isReview?l.e.review:Object(Z.c)(this.props.clientId,this.props.sharingInformation));this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{selectedPermissions:Object(r.__assign)(Object(r.__assign)({},t),{isEdit:e,isReview:i===l.e.review,sharingRole:i,sharingLinkKind:n,preventDownload:!1}),preventDownloadDisabled:e,officeReviewModeDisabled:!!e}));this._preventDownloadToggle=!1;this._officeReviewModeToggle=!1};t.prototype.onRoleChange=function(e){var t=this.state.selectedPermissions,n=l.e.review==e,i=e==l.e.manageList,s=n||i?6:Object(Z.y)(t.audience,Z.k(e)),o=Object(Z.l)(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays);this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{selectedPermissions:Object(r.__assign)(Object(r.__assign)({},t),{sharingRole:e,isEdit:Z.k(e),isReview:n,expiration:o,sharingLinkKind:s,preventDownload:!1}),preventDownloadDisabled:e!==l.e.view}));this._preventDownloadToggle=!1;this._officeReviewModeToggle=!1};t.prototype.onExpirationChange=function(e){e||(e=Object(Z.l)(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays));this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{selectedPermissions:Object(r.__assign)(Object(r.__assign)({},this.state.selectedPermissions),{expiration:e})}))};t.prototype.onTrackableChange=function(e){this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{selectedPermissions:Object(r.__assign)(Object(r.__assign)({},this.state.selectedPermissions),{trackLinkUsers:e})}))};t.prototype._renderDefaultButton=function(){return h.createElement(m.e,{onClick:this._onCancel,styles:De},b.ve)};t.prototype._renderPrimaryButton=function(){return h.createElement(g.e,{id:"od-ModifyPermissions-apply-id",className:"od-ModifyPermissions-apply",disabled:this._computeIsApplyButtonDisabled(),onClick:this._onApplyClicked,styles:De},b.F)};t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return h.createElement(c.e,{message:b.p})};t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)};t.prototype._initializeState=function(){var e=this.props,t=e.currentSettings,n=e.sharingInformation,r=t.isReview&&(ce.u(t.audience,e.sharingInformation.sharingAbilities,e.sharingInformation.fileExtension)||ce.o(t.audience,e.sharingInformation.sharingAbilities,e.sharingInformation.fileExtension)),i=pe.s({selectedItems:t.specificPeople,sharingLinkKind:1,canAddExternalPrincipal:n.canAddExternalPrincipal,sharingInformation:n,viewPolicyTipCallback:e.onViewPolicyTipClicked});return{expirationErrorCode:Z.e.none,peoplePickerError:i,selectedPermissions:{allowEditing:this._isAllowEditingEnabled(t.audience),trackLinkUsers:t.trackLinkUsers,audience:t.audience,isEdit:t.isEdit,isReview:r,sharingRole:t.sharingRole,expiration:t.expiration||Object(Z.l)(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays),sharingLinkKind:t.sharingLinkKind,specificPeople:t.specificPeople,updatePassword:t.updatePassword,password:t.password,hasPassword:t.hasPassword,preventDownload:t.preventDownload,shareId:t.shareId,fetchLinkOnly:t.fetchLinkOnly},showActivityIndicator:!1,preventDownloadDisabled:this._isAllowEditingEnabled(t.audience),officeReviewModeDisabled:!!this._isAllowEditingEnabled(t.audience),showConfirmationDialog:!1}};t.prototype._computeIsApplyButtonDisabled=function(){return this.state.expirationErrorCode!==Z.e.none||!!this.state.peoplePickerError};t.prototype._updateExpirationErrorCode=function(e){e!==this.state.expirationErrorCode&&this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{expirationErrorCode:e}))};t.prototype._onCancel=function(){this.props.onCancel()};t.prototype._onApplyClicked=function(){var e=this,t=this.state.selectedPermissions;if(this._peoplePickerHasUnresolvedText)this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{peoplePickerError:h.createElement("span",null,b.Ao)}));else if(t.audience!==f.e.specificPeopleFlex||0!==t.specificPeople.length||!this.props.copyLinkShortcut&&this.props.mode!==o.e.linkSettings){var n=this.props.doesCreate;if(t.fetchLinkOnly)this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{showActivityIndicator:n,showConfirmationDialog:!1}),function(){e.props.onSelectedPermissionsChange(e.state.selectedPermissions)});else{var i=t.audience===f.e.anyone||t.audience===f.e.specificPeople&&this.context.sharingStore.isSpecificPeopleExpirationAllowed()?t.expiration:null;if(this._determineMatchingTemplateAndSettingChange(i)){var s=!!this._matchingTemplate&&this._matchingTemplate.passwordProtected;this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{selectedPermissions:Object(r.__assign)(Object(r.__assign)({},t),{expiration:i,updatePassword:!!this._currentPassword,password:this._currentPassword,preventDownload:this._preventDownloadToggle,isReview:this._officeReviewModeToggle,shareId:this._existingPasswordLinkShareId,hasPassword:s}),showActivityIndicator:n,showConfirmationDialog:!0}))}else this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{selectedPermissions:Object(r.__assign)(Object(r.__assign)({},t),{expiration:i,updatePassword:!!this._currentPassword,password:this._currentPassword,preventDownload:this._preventDownloadToggle,isReview:this._officeReviewModeToggle,hasPassword:!!this._currentPassword,shareId:""}),showActivityIndicator:n,showConfirmationDialog:!1}),function(){e.props.onSelectedPermissionsChange(e.state.selectedPermissions)})}}else this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{peoplePickerError:h.createElement("span",null,b.rs)}))};t.prototype._determineMatchingTemplateAndSettingChange=function(e){if(this.state.selectedPermissions.audience!==f.e.anyone)return!1;this._matchingTemplate=this._getShareLinkTemplate();if(!this._matchingTemplate||!this._matchingTemplate.linkDetails)return!1;if(this._currentPassword&&this._matchingTemplate.passwordProtected)return!0;var t=this._matchingTemplate.linkDetails.expiration;return null!==e&&null!==t&&(e.getMonth()!==t.getMonth()||e.getDate()!==t.getDate())};t.prototype._onPeoplePickerChange=function(e){var t=pe.s({selectedItems:e,sharingLinkKind:1,canAddExternalPrincipal:this.props.sharingInformation.canAddExternalPrincipal,sharingInformation:this.props.sharingInformation,viewPolicyTipCallback:this.props.onViewPolicyTipClicked});if(!this.props.createPeopleSharingLinks&&this.state.selectedPermissions.audience===f.e.specificPeople){for(var n=!1,i=!1,s=0,o=e;s<o.length;s++){var u=o[s];n||(n=u.isExternal&&!u.providerName);i||(i=!u.isExternal||u.isExternal&&!!u.providerName)}n&&i&&(t=h.createElement("span",null,b.Tn))}this.props.onSelectedPeopleChange&&this.props.onSelectedPeopleChange(e);this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{peoplePickerError:t,selectedPermissions:Object(r.__assign)(Object(r.__assign)({},this.state.selectedPermissions),{specificPeople:e})}))};t.prototype._getShareLinkTemplate=function(){var e=this._findMatchingShareLinkTemplate();e&&(e.passwordProtected&&e.linkDetails?this._existingPasswordLinkShareId=e.linkDetails.shareId:this._existingPasswordLinkShareId="");return e};t.prototype._findMatchingShareLinkTemplate=function(){var e,t,n=!!this._currentPassword,r=this.props.sharingInformation.sharingLinkTemplates;if(!r||0===r.length)return null;for(var i=this._calculateRole(),s=0,o=r;s<o.length;s++){var u=o[s];if(u.role===i&&0===u.scope){if(n&&u.passwordProtected)return u;u.passwordProtected?e=u:t=u}}return e&&e.linkDetails&&!this._deletedPassword&&n?e:t};t.prototype._calculateRole=function(){return this.state.selectedPermissions.preventDownload?l.e.restrictedview:this.state.selectedPermissions.isReview?l.e.review:this.state.selectedPermissions.isEdit?Object(Z.c)(this.props.clientId,this.props.sharingInformation):l.e.view};t.prototype._onPasswordChange=function(e){this._currentPassword=e;this._deletedPassword=0===e.length};t.prototype._onPreventDownloadToggleChange=function(e){this._preventDownloadToggle=e;this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{selectedPermissions:Object(r.__assign)(Object(r.__assign)({},this.state.selectedPermissions),{preventDownload:e})}))};t.prototype._onOfficeReviewModeToggleChange=function(e){this._officeReviewModeToggle=e;var t=e?l.e.review:this.state.selectedPermissions.isEdit?Object(Z.c)(this.props.clientId,this.props.sharingInformation):l.e.view;this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{selectedPermissions:Object(r.__assign)(Object(r.__assign)({},this.state.selectedPermissions),{sharingRole:t,isReview:e,sharingLinkKind:e?6:Object(Z.y)(this.state.selectedPermissions.audience,this.state.selectedPermissions.isEdit)})}))};t.prototype._isAllowEditingEnabled=function(e){var t=this.props.sharingInformation.sharingAbilities;return ce.s(e,t)};t.prototype._getShareDialogConfirmationCode=function(e,t){var n=this.state.selectedPermissions.expiration,r=t.linkDetails.expiration,i=e&&t.passwordProtected,s=null!==n&&null!==r&&(n.getMonth()!==r.getMonth()||n.getDate()!==r.getDate());return i&&s?a.shareDialogPasswordAndExpiration:i?a.shareDialogPasswordOnly:a.shareDialogExpirationOnly};t.prototype._renderConfirmationDialog=function(){var e=!!this._currentPassword,t=this._matchingTemplate,n=this._getShareDialogConfirmationCode(e,t),r=t&&t.linkDetails&&null!==t.linkDetails.passwordLastModifiedBy?t.linkDetails.passwordLastModifiedBy.primaryText:"",i=t&&t.linkDetails&&null!==t.linkDetails.expiration?Object(Te.s)(t.linkDetails.expiration):"";return h.createElement(w,{confirmationCode:n,participant:null,onApply:this._onConfirmationUseNew,onCancel:this._onConfirmationUseExisting,linkPasswordSetBy:r,linkExpiration:i})};t.prototype._onConfirmationUseNew=function(){var e=this;this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{showConfirmationDialog:!1}),function(){e.props.onSelectedPermissionsChange(e.state.selectedPermissions)})};t.prototype._onConfirmationUseExisting=function(){var e=this,t=this.state.selectedPermissions,n=this._matchingTemplate&&this._matchingTemplate.linkDetails?this._matchingTemplate.linkDetails.expiration:null,i=!(!this._matchingTemplate||!this._matchingTemplate.linkDetails)&&this._matchingTemplate.passwordProtected;this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{selectedPermissions:Object(r.__assign)(Object(r.__assign)({},t),{expiration:n,updatePassword:!1,password:"",hasPassword:i}),showConfirmationDialog:!1}),function(){e.props.onSelectedPermissionsChange(e.state.selectedPermissions)})};t.contextTypes={shareClickTime:i.number,sharingStore:i.object.isRequired,resize:i.func.isRequired};return t})(h.Component),He=n(1962),Be=n(1637),je=n(390),Fe=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._initialLinkShown=!1;r._onLinkSettingsCancelClick=function(){r.setState({shouldCopyLinkToClipboard:!1},function(){r.props.onLinkPermissionsCancelClicked()})};r._onLinkSettingsApplyClicked=function(e){r.setState({shouldCopyLinkToClipboard:!0},function(){r.props.onLinkPermissionsApplyClicked(e)})};r._shareClickTime=n.shareClickTime;r.state={shouldCopyLinkToClipboard:!0};return r}t.prototype.render=function(){var e=this.props,t=e.sharingInformation;switch(this.props.viewState){case 4:var n={clientId:e.clientId,companyName:e.companyName,currentSettings:e.currentSettings,sharingInformation:t,onShareHintClick:e.onShareHintClicked,linkRecipients:null,customLabeledAudienceConfig:e.customLabeledAudienceConfig};if(!this._initialLinkShown){_e.l(this._shareClickTime,this.props.clientId,o.e.copy,this.props.scenarioId,this.props.correlationId);this._initialLinkShown=!0}return h.createElement(He.e,Object(r.__assign)({},Object(E.e)(this.props),{shareType:u.e.copy,itemName:t.item.name,linkUrl:e.displayUrl,sharingHintProps:n,shouldCopyLinkToClipboard:this.state.shouldCopyLinkToClipboard,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig}));case 2:return h.createElement(Pe,Object(r.__assign)({},Object(E.e)(this.props),{shareId:e.shareId,mode:e.mode,companyName:e.companyName,currentSettings:e.currentSettings,doesCreate:!0,onCancel:this._onLinkSettingsCancelClick,onSelectedPermissionsChange:this._onLinkSettingsApplyClicked,sharingInformation:e.sharingInformation,showExistingAccessOption:!0,groupsMemberCount:e.groupsMemberCount,onViewPolicyTipClicked:e.onViewPolicyTipClicked,createPeopleSharingLinks:e.createPeopleSharingLinks,copyLinkShortcut:!0,engagementExtraData:this.props.engagementExtraData,recipients:this.props.recipients,isLoadingDefaultRecipients:this.props.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,onSelectedPeopleChange:function(){}}));default:return h.createElement("div",{className:"od-Share-spinnerHolder"},h.createElement(Be.e,{className:"od-Share-spinner",label:b.Te,type:je.t.large}))}};t.contextTypes={shareClickTime:i.number};return t})(h.Component),Ie=n(2090);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-PermissionsList-content{padding:0 20px;margin-top:5px}.od-PermissionsList-content-wac{padding:0 20px;margin-top:25px}.od-PermissionsList-emptyLinks{padding-top:20px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:.75rem;min-height:2.25rem}.od-PermissionsList-inheritance{margin:16px}[dir='ltr'] .od-PermissionsList-inheritance .ms-MessageBar-icon{margin-left:8px}[dir='rtl'] .od-PermissionsList-inheritance .ms-MessageBar-icon{margin-right:8px}[dir='ltr'] .od-PermissionsList-inheritance .ms-MessageBar-text{margin-right:8px}[dir='rtl'] .od-PermissionsList-inheritance .ms-MessageBar-text{margin-left:8px}.od-PermissionsList-linksListHolder .od-ShareLinkDetails--sectionHeader{margin-top:0}.od-PermissionsList-header{font-weight:400;font-size:.875rem;display:inline;position:relative}.od-PermissionsList-header-no-position{font-weight:400;font-size:14px;display:inline}.od-ShareLinkDetails--sectionHeader{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.od-ShareLinkDetails--sectionHeader .ms-Icon{padding:0px 5px;font-size:.875rem}.od-ShareLinkDetails--sectionHeader .ms-Icon--Info,.od-ShareLinkDetails--sectionHeader .ms-Icon--Add,.od-ShareLinkDetails--sectionHeader .ms-Icon--Share{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:.75rem}.od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-grantAccess,.od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-share{margin:-5px 0;font-size:.875rem}[dir='ltr'] .od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-grantAccess,[dir='ltr'] .od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-share{float:right}[dir='rtl'] .od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-grantAccess,[dir='rtl'] .od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-share{float:left}.od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-grantAccess .od-ShareLinkDetails-Share-buttonText,.od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-share .od-ShareLinkDetails-Share-buttonText{font-size:.875rem}.od-ShareLinkDetails--sectionHeader .ms-Button{height:2rem}.od-PermissionsList-entities{padding-bottom:5px}.od-PermissionsList-entities div:last-of-type{border:none}.od-PermissionsList-links>div:last-of-type ul.od-ShareLink-participants:last-of-type::after{height:0px}.od-PermissionsList-principalGroup{outline:transparent;position:relative}.od-PermissionsList-principalGroup::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-PermissionsList-principalGroup:focus:after{content:'';position:absolute;top:-.125rem;right:-.125rem;bottom:-.125rem;left:-.125rem;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-PermissionsList-principalGroup:focus:after{border-color:ActiveBorder}}.od-PermissionsList-addressBarDescription{display:inline-block;padding-top:20px;font-size:.75rem}.od-AddressBarLinkHint{padding-top:20px;padding-bottom:24px}.isFluent .od-AddressBarLinkHint .od-ShareHint{margin:0}.od-AddressBarLinkHint .od-ShareHint .od-ShareLinkDescription .od-ShareLinkDescription-icon{font-size:.875rem;height:1.5rem;width:1.5rem;max-width:100px;max-height:100px}.od-AddressBarLinkHint .od-ShareHint .od-ShareLinkDescription .od-ShareLinkDescription-icon i{font-size:.875rem}.od-AddressBarLinkHint .od-ShareHint .od-ShareHintDetail .od-ShareHintDetail-status .od-ShareHintDetail-statusText{font-size:.75rem;line-height:1rem;overflow-wrap:anywhere}.od-AddressBarLinkHint .od-ShareHint .od-ShareHintDetail .od-ShareHintDetail-status .od-ShareHintDetail-chevron{font-size:.5rem}.ms-ContextualMenu-container .ms-ContextualMenu.ms-FocusZone.is-open{max-width:unset}\n"}]);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-LinkMember-Persona{width:32px}.od-LinkMember-tooltip{padding:8px}\n"}]);var qe,Re=n(2051),Ue=n(1670),ze=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this;i._onShowCallout=function(){i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{isCalloutVisible:!0}))};i._onDismissCallout=function(){i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{isCalloutVisible:!1}))};i.state={isCalloutVisible:!1};i._uniqueId="j"+Math.random().toString().replace(".","");return i}t.prototype.render=function(){var e=this.props,t=this.state;return h.createElement("div",{className:"od-LinkMember"},h.createElement(Re.e,{className:"od-LinkMember-Persona",primaryText:e.primaryText,initialsColor:Ue.e.blue,size:Ue.n.extraExtraSmall,onMouseOver:this._onShowCallout,onMouseLeave:this._onDismissCallout,id:this._uniqueId,imageUrl:e.imageUrl}),t.isCalloutVisible&&h.createElement(R.e,{directionalHint:U.e.topCenter,onDismiss:this._onDismissCallout,target:"#"+this._uniqueId+" ",setInitialFocus:!0},h.createElement("div",{className:"od-LinkMember-tooltip"},h.createElement("span",null,e.primaryText))))};return t})(h.Component),We=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this;i._onCancel=function(){i.setState(function(){return Object(r.__assign)(Object(r.__assign)({},i.state),{showDetailsPanel:!1,showConfirmationDialog:!1,participants:i.state.participants,hasPeopleChange:!1})})};i._onConfirmationDeleteParticipant=function(){if(i.state.confirmationCode===a.participant){i._onLinkParticipantDelete();i.setState({showConfirmationDialog:!1,confirmationCode:a.none})}};i.state={participants:i.props.participants,showConfirmationDialog:!1,confirmationCode:a.none,hasPeopleChange:!1};return i}t.prototype.render=function(){var e=this;return h.createElement("ul",{className:"od-ShareLink-participants",key:this.props.showDetailsPanel?"Panel-ul-"+this.props.link.shareId:this.props.link.shareId},this.props.participants.map(function(t){return h.createElement("li",{className:"od-ShareLink-personaItem",key:e.props.showDetailsPanel?"Panel-li-"+t.email:t.email},h.createElement(Re.e,{imageUrl:t.image,primaryText:t.name,secondaryText:t.isExternal?b.Tt:t.job,size:Ue.n.size32,showSecondaryText:!(!t.job&&!t.isExternal)}),6===e.props.link.sharingLinkKind&&!e.props.link.isAddressBarLink&&h.createElement(ue.e,{"data-is-focusable":!0,ariaLabel:y.format(b.as,t.name),className:"od-ShareLink-actionButton",iconProps:{iconName:"Cancel"},onClick:function(){return e.setState({showConfirmationDialog:!0,confirmationCode:a.participant,participant:t})}}))}),this.state.showConfirmationDialog&&this._renderConfirmationDialog())};t.prototype._renderConfirmationDialog=function(){var e=this,t=this.state,n=t.confirmationCode,r=t.participants,i=t.participant;return h.createElement(w,{confirmationCode:n,participants:r,participant:i,onApply:this._onConfirmationDeleteParticipant,onCancel:this.state.confirmationCode===a.back?this._onCancel:function(){e.setState({showConfirmationDialog:!1,confirmationCode:a.none})}})};t.prototype._onLinkParticipantDelete=function(){var e=this.state.participant,t=[];if(this.props.showDetailsPanel){t=!0!==e.isExternal&&e.principalName?this.props.participants.filter(function(t){return t.principalName!==e.principalName}):this.props.participants.filter(function(t){return t.email!==e.email});this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{participants:t,hasPeopleChange:!0}));this.props.onRemoveParticipant(e,t)}else this.props.updateLinkSettings(e)};return t})(h.Component);(function(e){e[e.none=0]="none";e[e.descriptive=1]="descriptive";e[e.more=2]="more";e[e.downArrow=3]="downArrow"})(qe||(qe={}));var Xe=n(434),Ve=n(1484),$e=n(86),Je=n(432),Ke=Object($e.t)(function(e,t,n){var r=Object(Je.e)(e),i=Object(K.y)(r,n);return Object(D.e)(Object(D.e)({},i),{root:[r.root,t,e.fonts.medium,n&&n.root]})}),Qe=(function(e){Object(D.r)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.className,n=e.styles,r=Object(D.s)(e,["className","styles"]),i=Ke(this.props.theme,t,n);return h.createElement(Xe.e,Object(D.e)({},r,{variantClassName:"ms-Button--facepile",styles:i,onRenderDescription:M.t}))};return t=Object(D.n)([Object(Ve.e)("FacepileButton",["theme","styles"],!0)],t)})(h.Component),Ge=n(1802),Ye=Object(P.e)(),Ze=(function(e){Object(D.r)(t,e);function t(t){var n=e.call(this,t)||this;n._classNames=Ye(n.props.styles,{theme:n.props.theme,className:n.props.className});n._getPersonaControl=function(e){var t=n.props,r=t.getPersonaProps,i=t.personaSize;return h.createElement(Re.e,Object(D.e)({imageInitials:e.imageInitials,imageUrl:e.imageUrl,initialsColor:e.initialsColor,allowPhoneInitials:e.allowPhoneInitials,text:e.personaName,size:i},r?r(e):null,{styles:{details:{flex:"1 0 auto"}}}))};n._getPersonaCoinControl=function(e){var t=n.props,r=t.getPersonaProps,i=t.personaSize;return h.createElement(Ge.e,Object(D.e)({imageInitials:e.imageInitials,imageUrl:e.imageUrl,initialsColor:e.initialsColor,allowPhoneInitials:e.allowPhoneInitials,text:e.personaName,size:i},r?r(e):null))};Object(H.e)(n);n._ariaDescriptionId=Object(B.e)();return n}t.prototype.render=function(){var e=this.props.overflowButtonProps,t=this.props,n=t.chevronButtonProps,r=t.maxDisplayablePersonas,i=t.personas,s=t.overflowPersonas,o=t.showAddButton,u=t.ariaLabel,a=t.showTooltip,f=void 0===a||a,l=this._classNames,c="number"==typeof r?Math.min(i.length,r):i.length;n&&!e&&(e=n);var p=s&&s.length>0,d=p?i:i.slice(0,c),v=(p?s:i.slice(c))||[];return h.createElement("div",{className:l.root},this.onRenderAriaDescription(),h.createElement("div",{className:l.itemContainer},o?this._getAddNewElement():null,h.createElement("ul",{className:l.members,"aria-label":u},this._onRenderVisiblePersonas(d,0===v.length&&1===i.length,f)),e?this._getOverflowElement(v):null))};t.prototype.onRenderAriaDescription=function(){var e=this.props.ariaDescription,t=this._classNames;return e&&h.createElement("span",{className:t.screenReaderOnly,id:this._ariaDescriptionId},e)};t.prototype._onRenderVisiblePersonas=function(e,t,n){var r=this,i=this.props,s=i.onRenderPersona,o=void 0===s?this._getPersonaControl:s,u=i.onRenderPersonaCoin,a=void 0===u?this._getPersonaCoinControl:u;return e.map(function(e,i){var s=t?o(e,r._getPersonaControl):a(e,r._getPersonaCoinControl);return h.createElement("li",{key:(t?"persona":"personaCoin")+"-"+i,className:r._classNames.member},e.onClick?r._getElementWithOnClickEvent(s,e,n,i):r._getElementWithoutOnClickEvent(s,e,n,i))})};t.prototype._getElementWithOnClickEvent=function(e,t,n,r){var i=t.keytipProps;return h.createElement(Qe,Object(D.e)({},Object(j.u)(t,j.n),this._getElementProps(t,n,r),{keytipProps:i,onClick:this._onPersonaClick.bind(this,t)}),e)};t.prototype._getElementWithoutOnClickEvent=function(e,t,n,r){return h.createElement("div",Object(D.e)({},Object(j.u)(t,j.n),this._getElementProps(t,n,r)),e)};t.prototype._getElementProps=function(e,t,n){var r=this._classNames;return{key:(e.imageUrl?"i":"")+n,"data-is-focusable":!0,className:r.itemButton,title:t?e.personaName:void 0,onMouseMove:this._onPersonaMouseMove.bind(this,e),onMouseOut:this._onPersonaMouseOut.bind(this,e)}};t.prototype._getOverflowElement=function(e){switch(this.props.overflowButtonType){case qe.descriptive:return this._getDescriptiveOverflowElement(e);case qe.downArrow:return this._getIconElement("ChevronDown");case qe.more:return this._getIconElement("More");default:return null}};t.prototype._getDescriptiveOverflowElement=function(e){var t=this.props.personaSize;if(!e||e.length<1)return null;var n=e.map(function(e){return e.personaName}).join(", "),r=Object(D.e)({title:n},this.props.overflowButtonProps),i=Math.max(e.length,0),s=this._classNames;return h.createElement(Qe,Object(D.e)({},r,{ariaDescription:r.title,className:s.descriptiveOverflowButton}),h.createElement(Ge.e,{size:t,onRenderInitials:this._renderInitialsNotPictured(i),initialsColor:Ue.e.transparent}))};t.prototype._getIconElement=function(e){var t=this.props,n=t.overflowButtonProps,r=t.personaSize,i=this._classNames;return h.createElement(Qe,Object(D.e)({},n,{className:i.overflowButton}),h.createElement(Ge.e,{size:r,onRenderInitials:this._renderInitials(e,!0),initialsColor:Ue.e.transparent}))};t.prototype._getAddNewElement=function(){var e=this.props,t=e.addButtonProps,n=e.personaSize,r=this._classNames;return h.createElement(Qe,Object(D.e)({},t,{className:r.addButton}),h.createElement(Ge.e,{size:n,onRenderInitials:this._renderInitials("AddFriend")}))};t.prototype._onPersonaClick=function(e,t){e.onClick(t,e);t.preventDefault();t.stopPropagation()};t.prototype._onPersonaMouseMove=function(e,t){e.onMouseMove&&e.onMouseMove(t,e)};t.prototype._onPersonaMouseOut=function(e,t){e.onMouseOut&&e.onMouseOut(t,e)};t.prototype._renderInitials=function(e,t){var n=this._classNames;return function(){return h.createElement(Y.e,{iconName:e,className:t?n.overflowInitialsIcon:""})}};t.prototype._renderInitialsNotPictured=function(e){var t=this._classNames;return function(){return h.createElement("span",{className:t.overflowInitialsIcon},e<100?"+"+e:"99+")}};t.defaultProps={maxDisplayablePersonas:5,personas:[],overflowPersonas:[],personaSize:Ue.n.size32};return t})(h.Component),et={root:"ms-Facepile",addButton:"ms-Facepile-addButton ms-Facepile-itemButton",descriptiveOverflowButton:"ms-Facepile-descriptiveOverflowButton ms-Facepile-itemButton",itemButton:"ms-Facepile-itemButton ms-Facepile-person",itemContainer:"ms-Facepile-itemContainer",members:"ms-Facepile-members",member:"ms-Facepile-member",overflowButton:"ms-Facepile-overflowButton ms-Facepile-itemButton"},tt=Object(_.e)(Ze,function(e){var t,n=e.className,r=e.theme,i=e.spacingAroundItemButton,s=void 0===i?2:i,o=r.palette,u=r.fonts,a=Object(K.x)(et,r),f={textAlign:"center",padding:0,borderRadius:"50%",verticalAlign:"top",display:"inline",backgroundColor:"transparent",border:"none",selectors:{"&::-moz-focus-inner":{padding:0,border:0}}};return{root:[a.root,r.fonts.medium,{width:"auto"},n],addButton:[a.addButton,Object(K.S)(r,{inset:-1}),f,{fontSize:u.medium.fontSize,color:o.white,backgroundColor:o.themePrimary,marginRight:2*s+"px",selectors:{"&:hover":{backgroundColor:o.themeDark},"&:focus":{backgroundColor:o.themeDark},"&:active":{backgroundColor:o.themeDarker},"&:disabled":{backgroundColor:o.neutralTertiaryAlt}}}],descriptiveOverflowButton:[a.descriptiveOverflowButton,Object(K.S)(r,{inset:-1}),f,{fontSize:u.small.fontSize,color:o.neutralSecondary,backgroundColor:o.neutralLighter,marginLeft:2*s+"px"}],itemButton:[a.itemButton,f],itemContainer:[a.itemContainer,{display:"flex"}],members:[a.members,{display:"flex",overflow:"hidden",listStyleType:"none",padding:0,margin:"-"+s+"px"}],member:[a.member,{display:"inline-flex",flex:"0 0 auto",margin:s+"px"}],overflowButton:[a.overflowButton,Object(K.S)(r,{inset:-1}),f,{fontSize:u.medium.fontSize,color:o.neutralSecondary,backgroundColor:o.neutralLighter,marginLeft:2*s+"px"}],overflowInitialsIcon:[{color:o.neutralPrimary,selectors:(t={},t[K.s]={color:"WindowText"},t)}],screenReaderOnly:K.M}},void 0,{scope:"Facepile"});Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareLinkDetails--div{top:0;left:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";width:100%;height:100%;padding:0 20px;-webkit-box-sizing:border-box;box-sizing:border-box;overflow-y:auto}.od-ShareLinkDetails--div .od-ShareLinkDetails--header{height:2.5rem;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-negative:0;flex-shrink:0;font-size:.875rem;margin:10px -20px 0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";position:relative}[dir='ltr'] .od-ShareLinkDetails--div .od-ShareLinkDetails--header{padding-left:20px}[dir='rtl'] .od-ShareLinkDetails--div .od-ShareLinkDetails--header{padding-right:20px}.od-ShareLinkDetails--div .od-ShareLinkDetails--changeSettings{padding:22px 0 12px;margin-bottom:50px}.od-ShareLinkDetails--div .od-ShareLinkDetails--footer{position:absolute;width:100%;right:0;bottom:0;left:0}.od-ShareLinkDetails--absolute{position:absolute}.od-ShareLinkDetails--settingIcon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:1.125rem}[dir='ltr'] .od-ShareLinkDetails--settingIcon{padding-left:8px}[dir='rtl'] .od-ShareLinkDetails--settingIcon{padding-right:8px}[dir='ltr'] .od-ShareLinkDetails--settingIcon{padding-right:12px}[dir='rtl'] .od-ShareLinkDetails--settingIcon{padding-left:12px}.od-ShareLinkDetails--setting{margin-bottom:12px;display:block;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-title{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-bottom:.0625rem solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}[dir='ltr'] .od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-title{padding-left:0px}[dir='rtl'] .od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-title{padding-right:0px}.od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-caretDownWrapper{display:none}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--changePermissions .od-RoleSelector-settingIcon{padding-left:8px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--changePermissions .od-RoleSelector-settingIcon{padding-right:8px}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker{width:100%}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-Content{display:-webkit-box;display:-ms-flexbox;display:flex}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-Content{margin-left:0px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-Content{margin-right:0px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .ms-DatePicker{margin-left:0px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .ms-DatePicker{margin-right:0px}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{font-size:1.125rem}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{padding-left:8px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{padding-right:8px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{padding-right:12px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{padding-left:12px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{margin-right:0px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{margin-left:0px}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ShareLink-actionButton .ms-Button-icon{outline:transparent;position:relative;font-size:.75rem}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ShareLink-actionButton .ms-Button-icon::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ShareLink-actionButton .ms-Button-icon:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ShareLink-actionButton .ms-Button-icon:focus:after{border-color:ActiveBorder}}.od-ShareLinkDetails--setting .od-ShareLinkDetails--expirationError{font-size:.75rem;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";display:block}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--expirationError{margin-left:37px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--expirationError{margin-right:37px}.od-ShareLinkDetails--setting .od-ShareLinkDetails--requireVerification{width:100%;margin:0}.od-ShareLinkDetails--setting .od-ShareLinkDetails--requireVerification .od-RequireVerificationToggle .ms-Toggle-label{margin:0;cursor:default}.od-ShareLinkDetails--setting .od-ShareLinkDetails--requireVerification .od-ShareLinkDetails-setting--RequireVerification-Icon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:1.125rem}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--requireVerification .od-ShareLinkDetails-setting--RequireVerification-Icon{padding-left:8px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--requireVerification .od-ShareLinkDetails-setting--RequireVerification-Icon{padding-right:8px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--requireVerification .od-ShareLinkDetails-setting--RequireVerification-Icon{padding-right:12px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--requireVerification .od-ShareLinkDetails-setting--RequireVerification-Icon{padding-left:12px}.od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle{width:100%;margin:0}.od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PreventDownloadToggle .ms-Toggle-label{margin:0;cursor:default}.od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:1.125rem}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{padding-left:8px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{padding-right:8px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{padding-right:12px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{padding-left:12px}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordFieldWrapper{width:100%}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField{width:100%;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-shareLinkDetails--passwordFieldMainContent{display:-webkit-box;display:-ms-flexbox;display:flex}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-ShareLink-passwordFieldContent{margin:0}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-ShareLinkDetails--passwordTextField{display:-webkit-box;display:-ms-flexbox;display:flex;width:100%;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";cursor:pointer}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-ShareLinkDetails--passwordTextField:hover{border-bottom-color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .ms-TextField{width:100%;margin:0;padding:0;border-bottom:none}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .ms-TextField-field{width:100%;padding:0;border-bottom:none}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:1.125rem}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{padding-left:8px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{padding-right:8px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{padding-right:12px}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{padding-left:12px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{margin-right:0}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{margin-left:0}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .ms-Toggle-label{margin:0}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-delete{background-color:transparent;background:none;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";cursor:pointer;font-size:.75rem;line-height:0px}[dir='ltr'] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-delete{margin-left:auto}[dir='rtl'] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-delete{margin-right:auto}.od-ShareLinkDetails--passwordCreatedByLabel{font-size:.75rem;font-style:italic;margin-top:-5px;padding:0}[dir='ltr'] .od-ShareLinkDetails--passwordCreatedByLabel{margin-left:37px}[dir='rtl'] .od-ShareLinkDetails--passwordCreatedByLabel{margin-right:37px}.od-ShareLinkDetails--sectionHeader{position:relative;padding:12px 20px;margin:10px -20px 0px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:";font-size:.875rem}.od-ShareLinkDetails--sectionHeader .ms-Button:not(:hover){background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}.od-ShareLinkDetails--sectionHeader .ms-Button:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-ShareLink--detailsPanel{top:50px}.od-ShareLink--detailsPanel .od-ShareLinkDetails--header{height:2.5rem;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-negative:0;flex-shrink:0;font-size:.875rem}[dir='ltr'] .od-ShareLink--detailsPanel .od-ShareLinkDetails--header{padding-left:20px}[dir='rtl'] .od-ShareLink--detailsPanel .od-ShareLinkDetails--header{padding-right:20px}.od-ShareLink--detailsPanel .ms-Panel-content{padding:0}.od-ShareLink--detailsPanel .ms-Panel-content .od-ShareLinkDetails--content{max-height:100%;overflow-y:auto;overflow-x:hidden;padding:0 20px 0}.od-ShareLink--detailsPanel .ms-Panel-content .od-Share-PeoplePicker-wrapper{padding-top:20px}.od-ShareLinkDetails--actions{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-ms-flex-negative:0;flex-shrink:0;margin-top:auto;height:3.5rem;background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:";margin:10px -20px 0}[dir='ltr'] .od-ShareLinkDetails--actions{padding-right:35px}[dir='rtl'] .od-ShareLinkDetails--actions{padding-left:35px}.od-ShareLinkDetails--actions button.ms-Button{font-size:.875rem;height:2rem;border-width:.0625rem}.od-ShareLinkDetails--actions .ms-Button--default{outline:transparent;position:relative}.od-ShareLinkDetails--actions .ms-Button--default::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareLinkDetails--actions .ms-Button--default:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ShareLinkDetails--actions .ms-Button--default:focus:after{border-color:ActiveBorder}}[dir='ltr'] .od-ShareLinkDetails--actions .ms-Button:not(:first-of-type){margin-left:10px}[dir='rtl'] .od-ShareLinkDetails--actions .ms-Button:not(:first-of-type){margin-right:10px}.od-ShareLinkDetails--actions #od-ShareLinkDetails-save.ms-Button--primary::after{left:2px;right:2px;top:2px;bottom:2px}@media screen and (-ms-high-contrast: active){.od-ShareLinkDetails--actions #od-ShareLinkDetails-save.ms-Button:focus::after{left:-2px;right:-2px;top:-2px;bottom:-2px}}.od-ShareLinkDetails--noParticipants{font-size:.75rem;padding-top:20px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";min-height:50px}.od-ShareLinkDetails-addressBarChoiceGroup{padding-top:10px}.od-ShareLinkDetails-addressBarChoiceGroupLabel{font-weight:600;font-size:.75rem}.od-ShareLinkDetails--sectionHeader-share button.ms-Button-flexContainer{font-size:.875rem}\n"}]);var nt=n(2027),rt=n(182),it=n(1753),st=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this;i._onPeoplePickerChange=function(e){var t=pe.s({selectedItems:i.state.participants,sharingLinkKind:i._link.sharingLinkKind,canAddExternalPrincipal:i.props.sharingInformation.canAddExternalPrincipal,sharingInformation:i.props.sharingInformation,viewPolicyTipCallback:i._store.getPolicyTipInformation,permissionsMap:i._store.getPermissionsMap()}),n=e[0],r=[];r=!0===n.isExternal?i.state.participants.filter(function(e){return e.email===n.email}):i.state.participants.filter(function(e){return e.userId===n.userId});i.setState({participants:0===r.length?i.state.participants.concat(e):i.state.participants,hasPeopleChange:0===r.length,peoplePickerError:t});i.props.onPeoplePickerChange(r,e)};i._onRemoveParticipant=function(e,t){i.setState({participants:t,participantRemovedText:y.format(b.fs,e.name)});i.props.updateLinkSettings(e)};i._onRoleChange=function(e){i.setState({hasSettingsChange:!0});i.props.onRoleChange(e)};i._onOptionChange=function(e){i.props.onOptionChange(e)};i._onAudienceChange=function(e){var t=e===f.e.organization;i.setState(function(){return Object(r.__assign)(Object(r.__assign)({},i.state),{isAddressBarLinkEnabled:t,hasSettingsChange:e!==i._selectedAudience,currentAudience:e,confirmationCode:a.addressBarLinkOff})})};i._onPasswordChange=function(e){i.setState(function(){return Object(r.__assign)(Object(r.__assign)({},i.state),{hasSettingsChange:e.length>0})});i.props.onPasswordChange(e)};i._onConfirmationSave=function(){if(i.props.addressBarLinkDetails){if(i.state.confirmationCode===a.addressBarLinkOff){i._store.setAddressBarLinkCapability(!1);i._link&&i._store.unshareLink(i._link.sharingLinkKind,i._link.shareId)}else i._store.setAddressBarLinkCapability(!0);i.setState(function(){return Object(r.__assign)(Object(r.__assign)({},i.state),{isAddressBarLinkEnabled:!1,showConfirmationDialog:!1,hasSettingsChange:!1,confirmationCode:a.none})})}else{i.props.updateLinkSettings(null);i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{showConfirmationDialog:!1,confirmationCode:a.none,hasSettingsChange:!1,hasPeopleChange:!1}))}};i._onCancel=function(){i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{showConfirmationDialog:!1,confirmationCode:a.none}));i.props.onCancel()};i._onSave=function(){if(i.state.hasSettingsChange){var e=i.props.addressBarLinkDetails&&i.state.currentAudience===f.e.existing?a.addressBarLinkOff:a.linkSettings;i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{confirmationCode:e,showConfirmationDialog:!0}))}else if(i.state.hasPeopleChange){i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{hasPeopleChange:!1}));i.props.updateLinkSettings(null)}};i._onBack=function(){i.state.hasPeopleChange||i.state.hasSettingsChange?i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{showConfirmationDialog:!0,confirmationCode:a.back})):i.props.onCancel()};i._onSelectDate=function(e){var t=i.props.sharingInformation.anonymousLinkExpirationRestrictionDays;i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{expirationErrorCode:Object(Z.d)(e,t)}),function(){i._updateExpirationErrorCode(Object(Z.d)(e,t))});i._onExpirationChange(e)};i._store=n.sharingStore;i._link=i.props.link;var s=i.props.sharingInformation.sharingAbilities;i._canManageAddressBarLink=Object(Z.i)(s);i.state={expirationErrorCode:Z.e.none,hasSettingsChange:i.props.hasSettingsChange||!1,hasPeopleChange:!1,showConfirmationDialog:!1,confirmationCode:a.none,participants:i.props.participants,participantRemovedText:"",selectedPermissions:i.props.selectedPermissions,currentAudience:i._getCurrentAudience(),peoplePickerError:pe.s({selectedItems:Object(r.__assign)({},i.props.participants),sharingLinkKind:1,canAddExternalPrincipal:i.props.sharingInformation.canAddExternalPrincipal,sharingInformation:i.props.sharingInformation,viewPolicyTipCallback:i._store.getPolicyTipInformation})};i._audienceOptions=i._getAudienceOptions();return i}t.prototype.render=function(){var e=!this.props.inlineInDialog&&C.o(this.props.clientId)?" od-ShareLinkDetails--absolute":"";return h.createElement("div",{className:"od-ShareLinkDetails--div"+e},this._renderDetailsPanelHeader(),this._renderDetailsPanelContent(),this._renderDetailsPanelActions())};t.prototype._renderDetailsPanelContent=function(){return this.props.addressBarLinkDetails?this._renderAddressBarLinkDetails():h.createElement("div",{className:"od-ShareLinkDetails--content"},this._renderShareLink(),h.createElement("div",{role:"heading","aria-level":1,className:"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":b.Nn},b.Nn),h.createElement("ul",{className:"od-ShareLinkDetails--changeSettings","aria-labelledby":b.Nn},this.props.link.isCreateOnlyLink?this._renderRequestFileEntry():this._renderChangePermission(),this._renderOfficeReviewModeToggle(),this._renderExpirationDatePicker(),this.props.sharingInformation.anyoneLinkTrackUsers&&this._renderRequireVerificationToggle(),this._renderPasswordField(),this._renderPreventDownloadToggle()),this.props.selectedPermissions.audience!==f.e.specificPeopleFlex&&this.state.participants.length>0&&h.createElement("div",{role:"heading","aria-level":1,className:"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":b.Rn},b.Rn),this.props.selectedPermissions.audience===f.e.specificPeopleFlex&&h.createElement("div",{role:"heading","aria-level":1,className:"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":b.Dt},b.Dt),this._renderPeoplePicker(),this._renderParticipantsList(),it.e(this.state.participantRemovedText,"assertive","alert"),this.state.showConfirmationDialog&&this._renderConfirmationDialog())};t.prototype._renderRequireVerificationToggle=function(){var e=this.state.selectedPermissions.trackLinkUsers,t=Ae.h()&&C.n(this.props.clientId);return h.createElement("li",{className:"od-ShareLinkDetails--setting"},h.createElement("div",{className:"od-ShareLinkDetails--requireVerification"},h.createElement("div",{className:"od-RequireVerificationToggle"},h.createElement("div",{className:"od-ShareLinkDetails-setting--RequireVerification-Icon"},h.createElement(Y.e,Object(r.__assign)({iconName:"ReminderPerson"},{alt:b.Vt}))),h.createElement(O.e,{"aria-disabled":!0,role:"checkbox",checked:e,disabled:!0,label:t?b.ds:b.ms}))))};t.prototype._renderAddressBarLinkDetails=function(){return h.createElement("div",{className:"od-ShareLinkDetails--content"},h.createElement("span",{className:"od-ShareLinkDetails-addressBarChoiceGroupLabel"},b.Ee),h.createElement("div",{className:"od-ShareLinkDetails-addressBarChoiceGroup"},h.createElement(k,{items:this._audienceOptions,onChange:this._onOptionChange,onAudienceChange:this._onAudienceChange,companyName:this.props.companyName,clientId:this.props.clientId,engagementExtraData:this.props.engagementExtraData})),h.createElement("div",{role:"heading","aria-level":1,className:"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":b.Nn},b.Nn),h.createElement("ul",{className:"od-ShareLinkDetails--changeSettings","aria-labelledby":b.Nn},this._renderChangePermission()),this.state.participants.length>0&&h.createElement("div",{role:"heading","aria-level":1,className:"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":b.Rn},b.Rn),this._link&&this._renderParticipantsList(),this.state.showConfirmationDialog&&this._renderConfirmationDialog())};t.prototype._renderShareLink=function(){return h.createElement(ot,{link:this._link,companyName:this.props.companyName,clientId:this.props.clientId,mode:this.props.mode,sharingInformation:this.props.sharingInformation,groupsMemberCount:this.props.groupsMemberCount,linkRecipients:this.props.linkRecipients,enableLinkSettings:this.props.enableLinkSettings,showMoreOptions:!1,showPermissionsList:this.props.showPermissionsList,onRemoveLink:this.props.onRemoveLink,engagementExtraData:this.props.engagementExtraData})};t.prototype._renderDetailsPanelHeader=function(){return h.createElement("div",{className:"od-ShareLinkDetails--header"},it.t(h.createElement(ue.e,{"data-is-focusable":!0,className:"od-ShareLink-actionButton",iconProps:{iconName:"Back"},onClick:this._onBack,ariaLabel:b.Z}),b.Z,{position:U.e.bottomLeftEdge}),h.createElement("span",null,b.yn))};t.prototype._renderDetailsPanelActions=function(){var e=!(this.state.hasPeopleChange||this.state.hasSettingsChange)||this.state.expirationErrorCode!==Z.e.none;return h.createElement("div",{className:"od-ShareLinkDetails--actions"},h.createElement(g.e,{id:"od-ShareLinkDetails-save",onClick:this._onSave,disabled:e},b.bs),h.createElement(m.e,{onClick:this.props.showPermissionsList,disabled:e},b.Ze))};t.prototype._renderParticipantsList=function(){return this.state.participants.length>0?h.createElement(We,{link:this._link,showDetailsPanel:!0,participants:this.state.participants,updateLinkSettings:this.props.updateLinkSettings,onRemoveParticipant:this._onRemoveParticipant}):this._link.audience===f.e.specificPeopleFlex?h.createElement("div",{className:"od-ShareLinkDetails--noParticipants"},b.jn):void 0};t.prototype._renderPeoplePicker=function(){var e=this.props,t=this.state,n=pe.n(t.participants),r=pe.r(t.participants,this.props.groupsMemberCount);if(this.props.selectedPermissions.audience===f.e.specificPeopleFlex)return h.createElement(de.e,{defaultSelectedItems:[],onChange:this._onPeoplePickerChange,oversharingExternalsWarning:n,oversharingGroupsWarning:r,pickerSettings:e.sharingInformation.peoplePickerSettings,error:t.peoplePickerError,sharingInformation:e.sharingInformation,sharingLinkKind:e.link.sharingLinkKind,clientId:this.props.clientId,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),inputTextPlaceholder:b.ai,onResolvedSuggestions:null})};t.prototype._renderChangePermission=function(){var e=this.props,t=e.selectedPermissions.audience,n=t==f.e.organization||t==f.e.anyone||t===f.e.existing;if(ce.o(t,e.sharingInformation.sharingAbilities,e.sharingInformation.fileExtension))return h.createElement("li",{className:"od-ShareLinkDetails--setting"},h.createElement("div",{className:"od-ShareLinkDetails--changePermissions"},h.createElement(he,{clientId:e.clientId,mode:e.mode,selectedPermissions:e.getLinkSettings(),onRoleChange:this._onRoleChange,canChangePermission:n,sharingInformation:this.props.sharingInformation})));ce.u(t,e.sharingInformation.sharingAbilities,e.sharingInformation.fileExtension);return h.createElement("li",{className:"od-ShareLinkDetails--setting"},h.createElement("div",{className:"od-ShareLinkDetails--changePermissions"},h.createElement(he,{mode:e.mode,clientId:e.clientId,selectedPermissions:e.getLinkSettings(),onRoleChange:this._onRoleChange,canChangePermission:n,sharingInformation:this.props.sharingInformation})))};t.prototype._renderRequestFileEntry=function(){var e=[{key:b.le,text:b.le,data:b.le,ariaLabel:b.le}];return h.createElement("li",{className:"od-ShareLinkDetails--setting"},h.createElement("div",{className:"od-ShareLinkDetails--changePermissions"},h.createElement("div",{className:"od-RoleSelector-wrapper"},it.t(h.createElement(Y.e,{className:"od-RoleSelector-settingIcon",iconName:"Upload"}),b.le),h.createElement(nt.e,{className:"od-RoleSelector-rolesDropdown",disabled:!0,label:"",defaultSelectedKey:b.le,calloutProps:{className:"od-RoleSelector-rolesDropdownOptionsCallout"},responsiveMode:rt.e.large,ariaLabel:b.le,options:e}),this.props.children)))};t.prototype._getCurrentAudience=function(){var e=this.props.addressBarLinkSettings;return e&&e.linkDisabled||!this._canManageAddressBarLink?f.e.existing:f.e.organization};t.prototype._getAudienceOptions=function(){var e=[],t={icon:fe.e[1],isChecked:!1,isDisabled:!1,key:f.e.existing,label:b.hi,linkKinds:[1],permissionsType:4},n={disabledText:b.Ye,icon:fe.e[1],isChecked:!1,isDisabled:!this._canManageAddressBarLink,key:f.e.organization,label:y.format(b.ci,this.props.companyName),linkKinds:[2,3],permissionsType:1};if(this._canManageAddressBarLink&&this.state.currentAudience!==f.e.existing){n.isChecked=!0;t.isChecked=!1;this._selectedAudience=f.e.organization}else{n.isChecked=!1;t.isChecked=!0;this._selectedAudience=f.e.existing}e.push(n,t);return e};t.prototype._renderExpirationDatePicker=function(){var e=this.state.selectedPermissions;if(e.audience===f.e.anyone)return h.createElement("li",{className:"od-ShareLinkDetails--setting"},h.createElement("div",{className:"od-ShareLinkDetails--datePicker"},h.createElement(ne,{clientId:this.props.clientId,onSelectDate:this._onSelectDate,value:e.expiration,expiryRestriction:this.props.sharingInformation.anonymousLinkExpirationRestrictionDays})),this._renderExpirationDatePickerErrorMessage())};t.prototype._renderExpirationDatePickerErrorMessage=function(){var e=this.state.expirationErrorCode,t=Object(Z.p)(e,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays);if(""!==t)return h.createElement("span",{className:"od-ShareLinkDetails--expirationError",role:"alert","aria-live":"assertive"},t)};t.prototype._renderPasswordField=function(){if(this.state.selectedPermissions.hasPassword){var e="",t=this._link.passwordLastModifiedBy;t&&(e=t.primaryText?t.primaryText:t.email?t.email:"");return h.createElement("li",{className:"od-ShareLinkDetails--setting"},h.createElement("div",{className:"od-ShareLink-detailsPanel-passwordFieldWrapper"},h.createElement("div",{className:"od-ShareLink-detailsPanel-passwordField"},h.createElement(ae,{onPasswordChange:this._onPasswordChange,detailsPane:!0,lastModifiedBy:e}))))}};t.prototype._renderPreventDownloadToggle=function(){var e=this.state.selectedPermissions.preventDownload;if(e)return h.createElement("li",{className:"od-ShareLinkDetails--setting"},h.createElement("div",{className:"od-ShareLinkDetails--preventDownloadToggle"},h.createElement(me,{isToggled:e,disablePreventDownload:!0,detailsPane:!0,clientId:this.props.clientId,mode:this.props.mode})))};t.prototype._renderOfficeReviewModeToggle=function(){var e=this.props,t=e.selectedPermissions.audience;if(ce.o(t,e.sharingInformation.sharingAbilities,e.sharingInformation.fileExtension)){var n=e.selectedPermissions.isReview||e.selectedPermissions.sharingRole===l.e.review;return h.createElement("li",{className:"od-ShareLinkDetails--setting"},h.createElement("div",{className:"od-ShareLinkDetails--officeReviewModeToggle"},h.createElement(xe,{isToggled:n,disableOfficeReviewMode:!0,detailsPane:!0,clientId:this.props.clientId,mode:this.props.mode})))}};t.prototype._renderConfirmationDialog=function(){var e=this,t=this.state,n=t.confirmationCode,r=t.participants,i=t.participant;return h.createElement(w,{confirmationCode:n,participants:r,participant:i,companyName:this.props.companyName,onApply:this._onConfirmationSave,onCancel:this.state.confirmationCode===a.back?this._onCancel:function(){e.setState({showConfirmationDialog:!1,confirmationCode:a.none})},onDiscard:this.props.showPermissionsList})};t.prototype._onExpirationChange=function(e){var t=this;this.setState(function(){return Object(r.__assign)(Object(r.__assign)({},t.state),{selectedPermissions:Object(r.__assign)(Object(r.__assign)({},t.state.selectedPermissions),{expiration:e}),hasSettingsChange:e!==t.state.selectedPermissions.expiration||t.state.hasSettingsChange})});this.props.onExpirationChange(e)};t.prototype._updateExpirationErrorCode=function(e){e!==this.state.expirationErrorCode&&this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{expirationErrorCode:e}))};t.contextTypes={sharingStore:i.object.isRequired};return t})(h.Component),ot=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this;i._onOptionChange=function(e){i.setState(function(){return Object(r.__assign)(Object(r.__assign)({},i.state),{hasSettingsChange:!0})});i.context.sharingStore.getEngagementHelper().manageAccessAddressBarLinkTypeClicked(i.props.engagementExtraData)};i._onChevronClick=function(){i.setState({linkMemberExpanded:!i.state.linkMemberExpanded})};i._onCancel=function(){i.setState(function(){return Object(r.__assign)(Object(r.__assign)({},i.state),{showConfirmationDialog:!1,participants:i._link?Object(Z.w)(i._link):[],expirationErrorCode:Z.e.none,selectedPermissions:i._getLinkSettings(),hasSettingsChange:!1,hasPeopleChange:!1})});i.state.hasSettingsChange||i.state.hasPeopleChange||i._showPermissionsList()};i._showPermissionsList=function(){i.setState(function(){return Object(r.__assign)(Object(r.__assign)({},i.state),{hasSettingsChange:!1,hasPeopleChange:!1,addressBarDetailsView:!1})});var e=i.props.showPermissionsList;e&&e()};i._onConfirmationDeleteLink=function(){if(i.state.confirmationCode===a.link){i._onShareLinkDelete();i.setState({showConfirmationDialog:!1,confirmationCode:a.none,hasSettingsChange:!1,linkDetailsView:!1})}i._showPermissionsList()};i._showLinkDetails=function(){var e=i.props.onShowLinkDetailsClicked;e&&e(i._link)};i._onShareLinkDelete=function(){var e=i._link;i.props.onRemoveLink&&i.props.onRemoveLink();i._store.unshareLink(e.sharingLinkKind,e.shareId)};i._onLinkClicked=function(e){try{var t=e.target;t.focus();t.setSelectionRange(0,t.value.length)}catch(e){}};i._copySharingLinkToClipboard=function(){var e=i.props.clientId,t=i._link.url,n=i._textField;Object(Z.o)(e,n,t).then(function(e){i.setState({copyLinkToClipboardSuccess:e,copyLinkAlert:b.Wn});i._copyButton.focus();e&&setTimeout(function(){i.setState({copyLinkToClipboardSuccess:!1,copyLinkAlert:""})},2e3)})};i._updateLinkSettings=function(e){var t=[],n=[],r=i.state.participants;if(e)for(var s=0,o=r;s<o.length;s++){if((d=o[s]).principalName&&d.principalName===e.principalName||d.email===e.email){t.push(Object(Z.s)(d));i.setState({participantRemovedText:y.format(b.fs,d.name)});i._chevronButton&&i._chevronButton.focus();break}}else{for(var u=function(e){0===(!0===e.isExternal?r.filter(function(t){return t.email===e.email}):r.filter(function(t){return t.userId===e.loginName})).length&&t.push(e)},a=0,l=i._link.invitees;a<l.length;a++){u(l[a])}for(var c=function(e){if(!0===e.isExternal&&i.state.selectedPermissions.audience===f.e.organization)return"continue";0===(!0===e.isExternal?i._link.invitees.filter(function(t){return t.email===e.email}):i._link.invitees.filter(function(t){return t.loginName===e.userId})).length&&!0===e.isResolved&&n.push(e)},h=0,p=r;h<p.length;h++){var d;c(d=p[h])}}if(t.length>0||n.length>0||i.state.hasSettingsChange){i._store.shareLink({settings:i.state.selectedPermissions,recipients:n,copyLinkCommand:!1,allRecipientsHaveAccess:!1,shareId:i._link.shareId,inviteesToRemove:t});i._store.addListener(function(){i.setState(function(){var e=i._store.getSharingInformation().sharingLinks.filter(function(e){return e.shareId===i._link.shareId});if(e&&e.length>0){i._link=e[0];return{link:i._link,participants:6===i._link.sharingLinkKind?Object(Z.w)(i._link):[]}}})})}};i._onPeoplePickerChange=function(e,t){i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{selectedPermissions:i.state.selectedPermissions,participants:0===e.length?i.state.participants.concat(t):i.state.participants,hasPeopleChange:0===e.length}))};i._onRoleChange=function(e){var t=i.state.selectedPermissions,n=Object(Z.y)(t.audience,Object(Z.k)(e));i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{selectedPermissions:Object(r.__assign)(Object(r.__assign)({},t),{sharingRole:e,isEdit:Object(Z.k)(e),sharingLinkKind:n}),hasSettingsChange:e!==i._getSharingRole()||i.state.hasSettingsChange}))};i._onExpirationChange=function(e){e||i._link.expiration||(e=Object(Z.l)(i.props.sharingInformation.anonymousLinkExpirationRestrictionDays));i.setState(function(){return Object(r.__assign)(Object(r.__assign)({},i.state),{selectedPermissions:Object(r.__assign)(Object(r.__assign)({},i.state.selectedPermissions),{expiration:e,shareId:i._link.shareId}),hasSettingsChange:e!==i.state.selectedPermissions.expiration||i.state.hasSettingsChange})})};i._onPasswordChange=function(e){i.setState(function(){return Object(r.__assign)(Object(r.__assign)({},i.state),{selectedPermissions:Object(r.__assign)(Object(r.__assign)({},i.state.selectedPermissions),{password:e,updatePassword:e.length>0,shareId:i._link.shareId}),hasSettingsChange:!0})})};i._getLinkSettings=function(){return i._link?{allowEditing:!0,audience:i._link.audience,expiration:i._link.expiration,isEdit:i._link.isEdit,isReview:i._link.isReview,isManageList:i._link.isManageList,isCreateOnlyLink:i._link.isCreateOnlyLink,sharingLinkKind:i._link.sharingLinkKind,specificPeople:Object(Z.w)(i._link),updatePassword:i._link.updatePassword,password:i._link.password,sharingRole:i._getSharingRoleFromLink(),preventDownload:i._link.blockDownload,hasPassword:i._link.hasPassword,description:i._link.description,trackLinkUsers:i._link.trackLinkUsers}:i.props.isAddressBarLink?{allowEditing:!0,audience:i.props.addressBarLinkSettings.linkDisabled?f.e.existing:f.e.organization,expiration:null,isEdit:i.props.addressBarLinkSettings.linkPermission===l.e.edit,sharingLinkKind:6,specificPeople:i._link?Object(Z.w)(i._link):[],updatePassword:!1,password:""}:void 0};i._store=n.sharingStore;i._resize=n.resize;i._link=i.props.link;i.state={linkRemovedText:"",copyLinkToClipboardSuccess:!1,copyLinkAlert:"",link:i._link,allowPasswordChange:!1,linkMemberExpanded:!1,hasSettingsChange:!1,hasPeopleChange:!1,participants:i._link?Object(Z.w)(i._link):[],showConfirmationDialog:!1,confirmationCode:a.none,selectedPermissions:i._getLinkSettings(),expirationErrorCode:Z.e.none,linkDetailsView:i.props.linkDetailsView,addressBarDetailsView:!1,participantRemovedText:""};return i}t.prototype.render=function(){var e=this;if(this.props.enableLinkSettings&&(this.state.linkDetailsView||this.props.isAddressBarLink))return this._renderLinkDetails();var t=this.props.link,n=t.url,r=Object(Z.m)(this.props.link),i=Object(Z.b)(this.props.link,this.props.companyName,this.props.clientId,null,this.props.sharingInformation.fileExtension),s=t.principals&&t.principals.length>0||t.invitees&&t.invitees.length>0;return this.props.enableLinkSettings?h.createElement("div",null,this._renderShareLink(),it.e(this.state.copyLinkAlert,"assertive","alert",!0),!t.isUnhealthy&&this.props.showMoreOptions&&s&&h.createElement("div",{"aria-label":b.un,className:"od-ShareLink--inviteesHolder","data-is-focusable":!0,"aria-expanded":this.state.linkMemberExpanded},h.createElement("div",{className:"od-ShareLink--inviteesHolder-header",onClick:this._onChevronClick},!this.state.linkMemberExpanded&&this._link.audience===f.e.specificPeopleFlex&&this._renderLinkMembersForEditPanel(),!!this.state.linkMemberExpanded&&h.createElement("div",{className:"od-ShareLink--inviteesHolder-headerExpanded"},b.Zt),this._link.audience===f.e.specificPeopleFlex&&this._renderChevron()),this.state.linkMemberExpanded&&this._renderParticipantsList(),it.e(this.state.participantRemovedText,"assertive","alert",!0)),this.state.showConfirmationDialog&&this._renderConfirmationDialogDeleteLink()):h.createElement("div",null,h.createElement("div",{className:"od-ShareLink flightOff"},h.createElement("div",{className:"od-ShareLink-main"},h.createElement("div",{className:"od-ShareLink-icon"},h.createElement(Y.e,{iconName:r})),h.createElement("div",{className:"od-ShareLink-details","aria-live":"assertive","aria-relevant":"all"},h.createElement(z.e,{"data-is-focusable":!0,autoFocus:!0,onClick:this._onLinkClicked,className:"od-ShareLink-url",defaultValue:n,readOnly:!0,ariaLabel:i,componentRef:function(t){return e._textField=t}})),h.createElement(ee.e,{content:b.os,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},h.createElement(ue.e,{"data-is-focusable":!0,className:"od-ShareLink-actionButton",onClick:this._onShareLinkDelete,iconProps:{iconName:"Cancel"},ariaLabel:b.os}))),h.createElement("div",{className:"od-ShareLink-description flightOff"},i)),s&&this._renderLinkMembers())};t.prototype.componentDidUpdate=function(){this._resize()};t.prototype._renderLinkDetails=function(){return h.createElement(st,Object(r.__assign)({link:this._link,participants:this.state.participants,updateLinkSettings:this._updateLinkSettings,getLinkSettings:this._getLinkSettings,selectedPermissions:this.state.selectedPermissions,onRoleChange:this._onRoleChange,onExpirationChange:this._onExpirationChange,onPasswordChange:this._onPasswordChange,onPeoplePickerChange:this._onPeoplePickerChange,hasSettingsChange:this.state.hasSettingsChange,onCancel:this._onCancel,showPermissionsList:this._showPermissionsList,addressBarLinkDetails:this.props.isAddressBarLink,onOptionChange:this._onOptionChange},this.props))};t.prototype._renderParticipantsList=function(){return h.createElement(We,{link:this._link,showDetailsPanel:!1,participants:this.state.participants,updateLinkSettings:this._updateLinkSettings})};t.prototype._renderLinkMembersForEditPanel=function(){var e=this.state.participants.map(function(e){return{personaName:e.name,imageUrl:e.image}});return h.createElement(tt,{personas:e,personaSize:Ue.n.size24,maxDisplayablePersonas:4,overflowButtonType:qe.descriptive,overflowButtonProps:{ariaLabel:b.Er}})};t.prototype._renderChevron=function(){var e=this;return h.createElement(ee.e,{content:b.Yt,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},h.createElement(ue.e,{ariaLabel:b.Yt,"aria-expanded":this.state.linkMemberExpanded,className:"od-ShareLink--inviteesHolder-headerChevron",iconProps:!0===this.state.linkMemberExpanded?{iconName:"ChevronUp"}:{iconName:"ChevronDown"},componentRef:function(t){return e._chevronButton=t}}))};t.prototype._renderConfirmationDialogDeleteLink=function(){var e=this,t=this.state,n=t.confirmationCode,r=t.participants,i=t.participant;return h.createElement(w,{confirmationCode:n,participants:r,participant:i,onApply:this._onConfirmationDeleteLink,onCancel:this.state.confirmationCode===a.back?this._onCancel:function(){e.setState({showConfirmationDialog:!1,confirmationCode:a.none})}})};t.prototype._renderShareLink=function(){var e=this,t=this._link,n=t.url,r=this.state.copyLinkToClipboardSuccess,i=Object(Z.m)(this.props.link),s=Object(Z.b)(t,this.props.companyName,this.props.clientId,null,this.props.sharingInformation.fileExtension),o=this._canManageLink(t);return h.createElement("div",{className:"od-ShareLink"},h.createElement("div",{className:"od-ShareLink-main"},h.createElement("div",{className:"od-ShareLink-icon2 icon-"+i},h.createElement(Y.e,{iconName:i,"aria-hidden":!0})),h.createElement("div",{className:"od-ShareLink-details"},h.createElement(z.e,{"data-is-focusable":!0,className:"od-ShareLink-url",defaultValue:n,readOnly:!0,ariaLabel:this._getAriaLabel(),componentRef:function(t){return e._textField=t}})),h.createElement(m.e,{onClick:this._copySharingLinkToClipboard,"data-is-focusable":!0,ariaLabel:r?b.Wn:b.Pe,componentRef:function(t){return e._copyButton=t}},r?b.Ne:b.Ce),this.props.showMoreOptions&&o?h.createElement(ee.e,{content:b.An,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},h.createElement(ue.e,{"data-is-focusable":!0,className:"od-ShareLink-actionButton",onClick:this._showLinkDetails,iconProps:{iconName:"More"},ariaLabel:b.An})):o?h.createElement(ee.e,{content:b.os,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},h.createElement(ue.e,{"data-is-focusable":!0,className:"od-ShareLink-actionButton",onClick:function(){return e.setState({showConfirmationDialog:!0,confirmationCode:a.link})},iconProps:{iconName:"Cancel"},ariaLabel:b.os})):null),o?h.createElement("div",{className:"od-ShareLink-description",onClick:this._showLinkDetails},h.createElement("div",{className:"od-ShareLink-description-label"},this._link.isUnhealthy?h.createElement("span",{className:"od-ShareHintDetail-statusUnhealthyText"},b.vo):h.createElement("span",{className:"od-ShareHintDetail-statusText"},s),this._renderStatusIcons())):h.createElement("div",{className:"od-ShareLink-description"},h.createElement("div",{className:"od-ShareLink-description-label"},this._link.isUnhealthy?h.createElement("span",{className:"od-ShareHintDetail-statusUnhealthyText"},b.vo):h.createElement("span",{className:"od-ShareHintDetail-statusText"},s),this._renderStatusIcons())))};t.prototype._renderStatusIcons=function(){if(!this._link.isUnhealthy){var e=this._link.expiration,t=this._link.hasPassword,n=this._link.blockDownload,r=this._link.isCreateOnlyLink,i=this._link.trackLinkUsers,s=[],o=this.props;e&&(e<new Date(Date.now())?s.push({icon:"EventDateMissed12",tooltip:""+y.format(b.gt,Object(Te.s)(e))}):e.getTime()!==new Date(0).getTime()&&s.push({icon:"Calendar",tooltip:""+y.format(b.bt,Object(Te.s)(e))}));t&&s.push({icon:"Lock",tooltip:b.Ds});n&&!r&&s.push({icon:"Blocked2",tooltip:b.Li});this._link.isReview&&Ce.t[this.props.sharingInformation.fileExtension]&&s.push({icon:"Feedback",tooltip:b.lr});i&&s.push({icon:"ReminderPerson",tooltip:Ae.h()&&C.n(o.clientId)?b.ps:b.vs});var u=s.map(function(e,t){return h.createElement("i",{className:"EventDateMissed12"!==e.icon?"od-ShareHintDetail-item":"od-ShareHintDetail-item od-ShareHintDetail-item-expired"},h.createElement(ee.e,{content:e.tooltip,id:e.icon},h.createElement(Y.e,{iconName:e.icon,"aria-describedby":e.icon})))});return h.createElement("div",{className:"od-ShareHintDetail-iconsList"},u)}};t.prototype._getAriaLabel=function(){var e=this._link.expiration,t=this._link.hasPassword,n=this._link.blockDownload,r=Object(Z.b)(this._link,this.props.companyName,this.props.clientId,null,this.props.sharingInformation.fileExtension);e&&(e<new Date(Date.now())?r+=" "+y.format(b.gt,Object(Te.s)(e))+".":e.getTime()!==new Date(0).getTime()&&(r+=" "+y.format(b.bt,Object(Te.s)(e))+"."));t&&(r+=" "+b.Ds+".");n&&(r+=" "+b.Li+".");return r};t.prototype._renderLinkMembers=function(){var e=this.props.link.principals.map(function(e){return{primaryText:e.primaryText,imageUrl:e.imageUrl,email:e.email}}).concat(this.props.link.invitees.map(function(e){return{primaryText:e.primaryText,imageUrl:e.imageUrl,email:e.email}}));return h.createElement(x.e,null,h.createElement("ul",{"aria-label":b.un,className:"od-ShareLink--inviteesHolder flightOff","data-is-focusable":!0},e.map(function(e){return h.createElement("li",{className:"od-ShareLink-linkMember",key:e.primaryText,"data-is-focusable":!0,tabIndex:0},h.createElement(ze,{primaryText:e.primaryText,imageUrl:e.imageUrl}))})))};t.prototype._getSharingRole=function(){return this.state.selectedPermissions.isManageList?l.e.manageList:this.state.selectedPermissions.isEdit?Object(Z.c)(this.props.clientId,this.props.sharingInformation):this.state.selectedPermissions.isReview?l.e.review:l.e.view};t.prototype._getSharingRoleFromLink=function(){return this._link.isManageList?l.e.manageList:this._link.isEdit?Object(Z.c)(this.props.clientId,this.props.sharingInformation):this._link.isReview?l.e.review:l.e.view};t.prototype._canManageLink=function(e){if(this._store.isConsumer())return!0;var t=ce.r(e.audience,this.props.sharingInformation.sharingAbilities);return e.isEdit?!!t.canManageEditLink&&t.canManageEditLink.enabled:e.isReview?!!t.canManageReviewLink&&t.canManageReviewLink.enabled:!!t.canManageReadLink&&t.canManageReadLink.enabled};t.contextTypes={sharingStore:i.object.isRequired,resize:i.func.isRequired};return t})(h.Component);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-SharePrincipal{padding:8px 0;display:-webkit-box;display:-ms-flexbox;display:flex;outline:none}.od-SharePrincipal-persona{display:inline-block;width:52px;height:52px}[dir='ltr'] .od-SharePrincipal-persona{margin-right:8px}[dir='rtl'] .od-SharePrincipal-persona{margin-left:8px}.od-SharePrincipal-persona .ms-Persona{height:50px}.od-SharePrincipal-persona .ms-Persona-imageArea{width:50px;height:50px;max-width:50px}.od-SharePrincipal-persona .ms-Persona-initials{line-height:50px;height:50px}.od-SharePrincipal-details{display:inline-block;vertical-align:top;width:200px}.od-SharePrincipal-details-primaryText{font-size:17px;font-weight:300;font-weight:400;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.od-SharePrincipal-permissions{outline:transparent;position:relative;cursor:pointer;background:none;border:none;padding:0}.od-SharePrincipal-permissions::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-SharePrincipal-permissions:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-SharePrincipal-permissions:focus:after{border-color:ActiveBorder}}.od-SharePrincipal-details-secondaryText,.od-SharePrincipal-permissions-role{font-size:12px;font-weight:400;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SharePrincipal-permissions-role{display:inline-block}.od-SharePrincipal-permissions-icon{display:inline-block;font-size:12px;margin-top:2px;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}[dir='ltr'] .od-SharePrincipal-permissions-icon{margin-left:4px}[dir='rtl'] .od-SharePrincipal-permissions-icon{margin-right:4px}.od-SharePrincipal-deleteIcon{position:absolute;top:12px;cursor:pointer;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}[dir='ltr'] .od-SharePrincipal-deleteIcon{right:8px}[dir='rtl'] .od-SharePrincipal-deleteIcon{left:8px}\n"}]);var ut=n(1552),at=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._onStopSharingClick=function(){r.setState({isUpdatingRole:!0});r._store.updatePermissions(r.props.principal,l.e.none)};r.state={showContextualMenu:!1,isUpdatingRole:!1,roleText:r._computeInitialRoleText(t.principal)};r._store=n.sharingStore;r._onChangeRoleClick=r._onChangeRoleClick.bind(r);r._onPermissionsClick=r._onPermissionsClick.bind(r);return r}t.prototype.componentDidMount=function(){this._focusElement&&this.props.takeFocus&&!C.s(this.props.clientId)&&this._focusElement.focus()};t.prototype.componentDidUpdate=function(){var e=this._computeInitialRoleText(this.props.principal);e!==this.state.previousRoleText&&this.setState({isUpdatingRole:!1,roleText:e,previousRoleText:this.state.roleText})};t.prototype.render=function(){var e=this,t=this.props.principal;return h.createElement("div",{className:"od-SharePrincipal",role:"presentation",ref:function(t){e._focusElement=t}},h.createElement(Re.e,{className:"od-SharePrincipal-persona",hidePersonaDetails:!0,initialsColor:Ue.e.blue,primaryText:t.primaryText,size:Ue.n.regular,imageUrl:t.imageUrl}),h.createElement("div",{className:"od-SharePrincipal-details",role:"presentation"},h.createElement("div",{className:"od-SharePrincipal-details-primaryText"},t.primaryText),this._renderChangePermissionsButton(t)))};t.prototype._computeInitialRoleText=function(e){var t=this.props.principal.role;if("number"!=typeof t)return e.sharingLinkKind?b.f:"";switch(t){case l.e.edit:return b.te;case l.e.review:return b.ae;case l.e.view:return b.ce;case l.e.owner:return b.Nr;default:return""}};t.prototype._computeRoleText=function(){return this.state.isUpdatingRole?b.Mo:this.state.roleText};t.prototype._renderChangePermissionsButton=function(e){var t=e.role;return this.state.isUpdatingRole||this.props.userRole!==l.e.owner||t!==l.e.edit&&t!==l.e.view&&t!==l.e.review?h.createElement("div",{className:"od-SharePrincipal-permissions-role"},this._computeRoleText()):h.createElement("button",{className:"od-SharePrincipal-permissions",onClick:this._onPermissionsClick,"data-is-focusable":!0,"aria-describedby":"changePermissionsDescription"+e.id},h.createElement("div",{className:"od-SharePrincipal-permissions-role"},this._computeRoleText()),this._renderChevron(e.role),this._renderContextualMenu(e.role),h.createElement("div",{role:"tooltip","aria-hidden":"true",className:"od-Share-screenReaderOnly",id:"changePermissionsDescription"+e.id},"Set permissions for "+e.primaryText))};t.prototype._renderChevron=function(e){if(e===l.e.edit||e===l.e.view||e===l.e.review)return h.createElement("div",{className:"od-SharePrincipal-permissions-icon"},h.createElement(Y.e,{iconName:"ChevronDown"}))};t.prototype._renderContextualMenu=function(e){var t,n,r=this;switch(e){case l.e.view:t=l.e.edit;n=b.N;l.e.review;b.i;break;case l.e.review:t=l.e.edit;n=b.N;l.e.view;b.be;break;case l.e.edit:t=l.e.view;n=b.be;l.e.review;b.i}if(this.state.showContextualMenu)return h.createElement(ut.e,{items:[{key:"editable1",name:n,onClick:this._onChangeRoleClick.bind(this,t)},{key:"stopSharing",name:""+b.mo,onClick:this._onStopSharingClick}],onDismiss:function(){r.setState({showContextualMenu:!1})},directionalHint:U.e.bottomLeftEdge,isBeakVisible:!0,target:this.state.target})};t.prototype._onChangeRoleClick=function(e){this.setState({isUpdatingRole:!0,previousRoleText:this.state.roleText});this._store.updatePermissions(this.props.principal,e)};t.prototype._onPermissionsClick=function(e){var t=this.props.principal.role;(t===l.e.edit||t===l.e.view||t===l.e.review)&&this.setState({showContextualMenu:!0,target:e.nativeEvent.target})};t.contextTypes={sharingStore:i.object.isRequired};return t})(h.Component);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-SharePrincipal2{padding:18px 20px;margin:0 -20px;border-bottom:.0625rem solid "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-ShareLink-personaItem.od-SharePrincipal2 .ms-FocusZone{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ShareLink-personaItem.od-SharePrincipal2 .ms-Persona-secondaryText{color:"},{theme:"bodySubtext",defaultValue:"#605e5c"},{rawString:"}.od-SharePrincipal-permissions{font-size:.875rem}.od-SharePrincipal-permissions .od-SharePrincipal-changePermissions{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}[dir='ltr'] .od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{margin-left:4px}[dir='rtl'] .od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{margin-right:4px}[dir='ltr'] .od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{margin-right:4px}[dir='rtl'] .od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{margin-left:4px}.ms-SharePrincipal_contextMenu .ms-ContextualMenu-icon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}\n"}]);var ft=n(1709),lt=n(705),ct=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._menuElement=Object(h.createRef)();r._showMenu=function(){var e=r.state.showMenu;r.setState({showMenu:!e})};r._hideMenu=function(){r.setState({showMenu:!1})};r._stopSharingConfirmation=function(){r.setState({showConfirmationDialog:!0})};r._onCancel=function(){r.setState({showConfirmationDialog:!1})};r._onStopSharingClick=function(){r._store.getEngagementHelper().manageAccessRemoveDirectAccess(r.props.engagementExtraData);r._store.updatePermissions(r.props.principal,l.e.none)};r.state={showMenu:!1,showConfirmationDialog:!1,selectedRole:t.principal.role};r._store=n.sharingStore;r._onChangeRoleClick=r._onChangeRoleClick.bind(r);r._enableCompactRoleSelector=!0;return r}t.prototype.render=function(){var e=this.props.principal,t=e.role===l.e.owner,n=e.type===ft.e.sharePointGroup,r=!t,i=this.props.sharingInformation;i&&i.sharedObjectType===Oe.e.list&&(r=!n&&!e.isSiteAdmin||n&&!t);return h.createElement("div",{className:"od-ShareLink-personaItem od-SharePrincipal2","data-is-focusable":!0,"aria-label":this._computeAriaLabel(e,t),tabIndex:-1},h.createElement(x.e,{direction:T.e.horizontal},h.createElement(Re.e,{className:"od-SharePrincipal-persona2",size:Ue.n.size32,primaryText:e.primaryText,secondaryText:e.isExternal?b.Tt:e.secondaryText,showSecondaryText:!(!e.isExternal&&!e.secondaryText),imageUrl:e.imageUrl}),h.createElement("div",{className:"od-SharePrincipal-permissions"},r?this._renderChangePermissions(e):h.createElement("span",{className:"od-SharePrincipal-ownerLabel"},b.Nr))),this.state.showConfirmationDialog&&this._renderConfirmationDialog())};t.prototype._getRoleSelectorProps=function(e){return{compact:!0,menuPermissionOptions:Object(ce.e)({sharingInformation:this.props.sharingInformation}),sharingRole:e,mode:o.e.addPeople,clientId:this.props.clientId,ariaLabel:b.b,showStopSharing:!0,onRoleChange:this._onChangeRoleClick.bind(this),onStopSharing:this._stopSharingConfirmation.bind(this)}};t.prototype._renderRoleSelector=function(e){var t=this._getRoleSelectorProps(e);return h.createElement(le.e,Object(r.__assign)({},t))};t.prototype._renderChangePermissions=function(e){var t=this.state.selectedRole;return this.props.userRole!==l.e.owner||t!==l.e.edit&&t!==l.e.view&&t!==l.e.review&&t!==l.e.owner&&t!==l.e.manageList?h.createElement("div",{className:"od-SharePrincipal-permissionsRole"},this._renderRoleIcon(e)):this._enableCompactRoleSelector?h.createElement("div",{className:"od-SharePrincipal-changePermissions"},this._renderRoleSelector(t)):h.createElement("div",{className:"od-SharePrincipal-changePermissions"},this._renderRoleIcon(e),this._renderChangePermissionDropdown())};t.prototype._renderRoleIcon=function(e){var t=Object(Z.E)(e.role),n=this._computeRoleText(e);return h.createElement(ee.e,{id:e.id.toString(),content:n,calloutProps:{gapSpace:0}},h.createElement(Y.e,{className:"od-SharePrincipal-roleIcon",iconName:t.name,"aria-describedby":"od-SharePrincipal-tooltip"}))};t.prototype._renderChangePermissionDropdown=function(){var e=Object(lt.e)();return h.createElement("div",{ref:this._menuElement},h.createElement(ue.e,{className:"od-SharePrincipal-changePermissionsChevron",onClick:this._showMenu,iconProps:{iconName:"ChevronDown"},ariaLabel:y.format(b.pi,this.props.principal.primaryText)}),this.state.showMenu&&h.createElement(ut.e,{target:this._menuElement.current,items:this._getContextualMenuItems(),directionalHint:e?U.e.bottomLeftEdge:U.e.bottomRightEdge,onDismiss:this._hideMenu,className:"ms-SharePrincipal_contextMenu"}))};t.prototype._onChangeRoleClick=function(e){if(e!==this.props.principal.role){this._store.updatePermissions(this.props.principal,e);this.setState({selectedRole:e})}};t.prototype._renderConfirmationDialog=function(){var e=this.props.principal,t={id:e.id,name:e.primaryText,image:e.imageUrl,isResolved:!0,principalName:e.loginName,userId:e.loginName,email:e.email,job:e.secondaryText,isExternal:e.isExternal,loginName:e.loginName,principalType:e.type};return h.createElement(w,{confirmationCode:a.participant,participant:t,onApply:this._onStopSharingClick,onCancel:this._onCancel})};t.prototype._getContextualMenuItems=function(){var e=this,t=this.props.principal.role,n=ce.u(f.e.existing,this.props.sharingInformation.sharingAbilities,this.props.sharingInformation.fileExtension),r=this.props.sharingInformation.sharedObjectType===Oe.e.list&&this.props.principal.type!==ft.e.sharePointGroup,i={key:"currentRole",name:Object(Z.E)(t).title,onClick:function(){e._onChangeRoleClick(t)},checked:!0,iconProps:{iconName:"CheckMark"}},s={key:"fullControl",name:b.Bt,onClick:function(){e._onChangeRoleClick(l.e.owner)}},o={key:"editRole",name:b.te,onClick:function(){e._onChangeRoleClick(l.e.edit)}},u={key:"reviewRole",name:b.ae,onClick:function(){e._onChangeRoleClick(l.e.review)}},a={key:"viewRole",name:b.ce,onClick:function(){e._onChangeRoleClick(l.e.view)}},c={key:"stopSharing",name:""+b.mo,onClick:this._stopSharingConfirmation},h=[i];r&&t!=l.e.owner&&h.push(s);t!=l.e.edit&&h.push(o);n&&t!=l.e.review&&h.push(u);t!=l.e.view&&h.push(a);h.push(c);return h};t.prototype._computeAriaLabel=function(e,t){var n=this._computeRoleText(e),r=e.primaryText+", "+n+".";t||(r+=" "+b.Ps);return r};t.prototype._computeRoleText=function(e){var t=e.role;if("number"!=typeof t)return e.sharingLinkKind?b.f:"";switch(t){case l.e.edit:return b.te;case l.e.review:return b.ae;case l.e.view:return b.ce;case l.e.owner:return b.Nr;default:return""}};t.contextTypes={sharingStore:i.object.isRequired};return t})(h.Component),ht=n(1952),pt=n(1526),dt=n(1972),vt=n(141),mt=n(2021),gt={ODB:1466},yt=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this;i._focusAnchorRef=h.createRef();i._showPermissionsList=function(){i.setState({showLinkDetails:!1,showAddressBarLinkDetails:!1})};i._onRemoveLink=function(){i.setState({linkRemovedText:b.ln});setTimeout(function(){i.setState({linkRemovedText:""})},3e3)};i._onLinkSelected=function(e){i.setState({currentSharingLink:e,showLinkDetails:!0})};i._onShareClick=function(e){i._targetElement=e.target;i._mode=o.e.share;i.setState({showShare:!0})};i._onGrantAccessClick=function(e){i._targetElement=e.target;i._mode=o.e.addPeople;i.setState({showGrantAccess:!0})};i._onDismiss=function(){Ae.v()&&window.parent.postMessage(JSON.stringify({name:"share_dismiss"}),"*");i._mode===o.e.share?i.setState({showShare:!1}):i.setState({showGrantAccess:!1})};i._onAddressBarLinkClicked=function(){i.setState(function(){return Object(r.__assign)(Object(r.__assign)({},i.state),{showAddressBarLinkDetails:!0})})};i._shareClickTime=n.shareClickTime;i._sharingStore=n.sharingStore;i._resize=n.resize;i._mode=i.props.mode;i._addressBarLink=null;i.state={showLinkDetails:!1,showAddressBarLinkDetails:!1,currentSharingLink:void 0,linkRemovedText:"",showShare:!1,showGrantAccess:!1,selectedKey:f.e.existing};i._isShareCommandsExperimentOn=C.o(i.props.clientId);i._isLinkSettingsEditPanelEnabled=i._sharingStore.showManageAccess()&&(i.props.mode===o.e.manageAccess||i.props.mode===o.e.share||i.props.mode===o.e.addPeople);if(we.e.isFeatureEnabled(gt)){var s=i.props.sharingInformation.sharingLinks?i.props.sharingInformation.sharingLinks.filter(function(e){return e.isAddressBarLink}):[];s.length>0&&(i._addressBarLink=s[0])}i._hasBackButton=i.props.mode!==o.e.manageAccess;return i}t.prototype.componentDidMount=function(){if(this._focusAnchorRef&&this._focusAnchorRef.current){this._focusAnchorRef.current.focus();this._focusAnchorRef.current.blur()}_e.l(this._shareClickTime,this.props.clientId,this.props.mode,this.props.scenarioId,this.props.correlationId)};t.prototype.componentDidUpdate=function(){this.props.hideElementsInManageAccess(this.state.showLinkDetails);this._resize()};t.prototype.getChildContext=function(){return{onDismiss:this._onDismiss}};t.prototype.render=function(){var e,t=this.props.sharingInformation,n=this.props.sharingInformation.sharingLinks.reduce(function(e,t){return e+(t.isActive?1:0)},-1)>0;if(t.hasPermissionsInformation)if(t.isShared){var r=t.sharedObjectType===Oe.e.list,i=this.props.mode!==o.e.manageAccess||Ae.e()?"od-PermissionsList-content":"od-PermissionsList-content-wac";e=h.createElement("div",{className:i,"aria-label":b.yn},h.createElement("div",{className:"od-PermissionsList-links"},this._renderLinks()),!r&&h.createElement("div",{className:"od-PermissionsList-addressbar"},this._renderAddressBarAccess()," "),h.createElement("div",{className:"od-PermissionsList-entities"},this._renderPrincipals(n)))}else e=h.createElement("div",null,b.Un);else e=h.createElement("div",{className:"od-Share-spinnerHolder"},h.createElement(Be.e,{className:"od-Share-spinner",label:b.Te,type:je.t.large}));var s=t.hasInheritedLinks,u=(this.props.showHeader||!C.o(this.props.clientId))&&!this.state.showLinkDetails&&!this.state.showAddressBarLinkDetails;return h.createElement("div",{tabIndex:-1,ref:this._focusAnchorRef,className:"od-PermissionsList od-Share-noFocusBorder"},it.e(b.yn,"assertive","alert",!0),u&&this._renderHeader(),s&&this._renderInheritance(n),this.state.showLinkDetails||this.state.showAddressBarLinkDetails?this._renderLinkDetails():e)};t.prototype._renderHeader=function(){var e=this.props.mode!==o.e.manageAccess||Ae.e()?"od-PermissionsList-header":"od-PermissionsList-header-no-position";return h.createElement("div",{className:e},this._hasBackButton&&it.t(h.createElement(ue.e,{className:"od-Share-backButton",id:"od-PermissionsList-backButton",onClick:this.props.backButtonClicked,iconProps:{iconName:"Back"},ariaLabel:b.Z}),b.Z,{position:U.e.bottomLeftEdge,targetElementId:"od-PermissionsList-backButton"}),h.createElement(S.e,Object(r.__assign)({},Object(E.e)(this.props),{item:this.props.sharingInformation.item,viewState:3,"data-is-focusable":!0,mode:this.props.mode,hasBackButton:this._hasBackButton})))};t.prototype._renderInheritance=function(e){var t,n;this.props.sharingInformation.item.itemType===vt.t.Folder?n=b.Jt:this.props.sharingInformation.item&&(n=b.$t);t=e?y.format(b.l,n):y.format(b.vr,n);return h.createElement("div",{className:"od-PermissionsList-inheritance"},h.createElement(dt.e,null,t))};t.prototype._renderLinkDetails=function(){if(this.state.showAddressBarLinkDetails){var e=this.props.sharingInformation.addressBarLinkSettings;return h.createElement(ot,{companyName:this.props.companyName,link:this._addressBarLink,clientId:this.props.clientId,mode:this.props.mode,sharingInformation:this.props.sharingInformation,showPermissionsList:this._showPermissionsList,enableLinkSettings:!0,isAddressBarLink:!0,addressBarLinkSettings:e,engagementExtraData:this.props.engagementExtraData,inlineInDialog:this.props.showHeader})}return h.createElement(ot,{key:this.state.currentSharingLink.shareId,mode:this.props.mode,companyName:this.props.companyName,link:this.state.currentSharingLink,clientId:this.props.clientId,sharingInformation:this.props.sharingInformation,groupsMemberCount:this.props.groupsMemberCount,linkRecipients:this.props.linkRecipients,enableLinkSettings:this._isLinkSettingsEditPanelEnabled,showMoreOptions:!1,onShowLinkDetailsClicked:this._onLinkSelected,linkDetailsView:!0,showPermissionsList:this._showPermissionsList,onRemoveLink:this._onRemoveLink,engagementExtraData:this.props.engagementExtraData,inlineInDialog:this.props.showHeader})};t.prototype._renderLinks=function(){var e=this,t=this.props.sharingInformation.sharingLinks,n=!1;return h.createElement("div",{className:"od-PermissionsList-linksListHolder"},this._isLinkSettingsEditPanelEnabled&&h.createElement("div",{className:"od-ShareLinkDetails--sectionHeader"},h.createElement("span",null,h.createElement(Y.e,{iconName:"Link","aria-label":b.on,className:"ms-Icon ms-Icon--Link",role:"img","aria-hidden":"true"}),h.createElement("h2",{className:"od-PermissionsList-header"},b.dn),it.t(h.createElement("span",null,h.createElement(Y.e,{iconName:"Info",className:"ms-Icon ms-Icon--Info","aria-label":b.dn+" "+b.vn,role:"img",tabIndex:0})),b.vn,{tooltipId:"od-ShareLinkDetails-tooltip-links",position:U.e.bottomCenter})),this._isShareCommandsExperimentOn&&this.props.mode===o.e.manageAccess&&h.createElement("div",{className:"od-ShareLinkDetails--sectionHeader-share"},h.createElement(pt.e,{iconProps:{iconName:"Share"},"aria-label":b.Os,onClick:this._onShareClick,"aria-haspopup":!0},h.createElement("span",{className:"od-ShareLinkDetails-Share-buttonText"},b.Os)),this.state.showShare&&this._renderShare())),h.createElement("ul",{className:"od-PermissionsList-links"},t.map(function(t,r){if(t.audience!==f.e.specificPeople&&t.isActive&&!t.isAddressBarLink){n=!0;return h.createElement("li",{key:t.shareId},h.createElement(ot,{key:t.shareId,mode:e.props.mode,companyName:e.props.companyName,link:t,clientId:e.props.clientId,sharingInformation:e.props.sharingInformation,groupsMemberCount:e.props.groupsMemberCount,linkRecipients:e.props.linkRecipients,enableLinkSettings:e._isLinkSettingsEditPanelEnabled,showMoreOptions:e._isLinkSettingsEditPanelEnabled,onShowLinkDetailsClicked:e._onLinkSelected,linkDetailsView:!1,showPermissionsList:e._showPermissionsList,engagementExtraData:e.props.engagementExtraData,inlineInDialog:e.props.showHeader}))}}),!n&&this._renderNoSharingLinks()),this._isLinkSettingsEditPanelEnabled&&h.createElement("div",null,it.e(n?"":b.Fn,"polite","alert",!0),it.e(this.state.linkRemovedText,"assertive","alert",!0)))};t.prototype._renderNoSharingLinks=function(){if(this._isLinkSettingsEditPanelEnabled)return h.createElement("div",{className:"od-PermissionsList-emptyLinks"},b.Fn)};t.prototype._renderPrincipals=function(e){var t=this,n=this.props.sharingInformation,r=n.sharingPrincipals.slice();return this._isLinkSettingsEditPanelEnabled?h.createElement("div",{className:"od-PermissionsList-entitiesListHolder"},this._isLinkSettingsEditPanelEnabled&&h.createElement("div",{className:"od-ShareLinkDetails--sectionHeader"},h.createElement("span",null,h.createElement(Y.e,{iconName:"PlayerSettings","aria-label":b._i,className:"ms-Icon ms-Icon--PlayerSettings",role:"img","aria-hidden":"true"}),h.createElement("h2",{className:"od-PermissionsList-header"},b._i),it.t(h.createElement("span",null,h.createElement(Y.e,{iconName:"Info",className:"ms-Icon ms-Icon--Info","aria-label":b._i+" "+b.Di,role:"img",tabIndex:0})),b.Di,{tooltipId:"od-ShareLinkDetails-tooltip-principals"})),this._isShareCommandsExperimentOn&&this.props.mode===o.e.manageAccess&&h.createElement("div",{className:"od-ShareLinkDetails--sectionHeader-grantAccess"},it.t(h.createElement(ue.e,{iconProps:{iconName:"Add"},"aria-label":b.y,onClick:this._onGrantAccessClick,"aria-haspopup":!0}),b.y),this.state.showGrantAccess&&this._renderShare())),h.createElement("ul",{className:"od-PermissionsList-entities","aria-label":b.di},h.createElement(x.e,{direction:T.e.vertical,isInnerZoneKeystroke:function(e){return e.which===Object(lt.t)(L.e.right)}},r.map(function(e,r){return h.createElement("li",{key:e.id},h.createElement(ct,{key:e.id,principal:e,userRole:n.userRole,clientId:t.props.clientId,mode:o.e.manageAccess,sharingInformation:n,engagementExtraData:t.props.engagementExtraData}))})))):h.createElement("ul",{className:"od-PermissionsList-entities",role:"list","aria-label":b.di},r.map(function(r,i){return h.createElement("li",{key:r.id,tabIndex:0,"aria-atomic":!0,"aria-live":"assertive",className:"od-PermissionsList-principalGroup"},h.createElement(at,{principal:r,takeFocus:!e&&0===i,userRole:n.userRole,clientId:t.props.clientId,sharingInformation:n}))}))};t.prototype._renderShare=function(){return h.createElement(R.e,{target:this._targetElement,preventDismissOnScroll:!0,role:"alert","aria-live":"assertive",directionalHint:U.e.bottomCenter,onDismiss:this._onDismiss},h.createElement(X.e,{isClickableOutsideFocusTrap:!0},h.createElement(on,{mode:this._mode,hideShareDialogOverflowButton:!0,clientId:this.props.clientId,maxWidth:Ae.m()?Z.n:Z.t})))};t.prototype._renderAddressBarAccess=function(){if(we.e.isFeatureEnabled(gt)){var e=this.props.sharingInformation.addressBarLinkSettings,t=Object(mt.e)(this.props.sharingInformation.fileExtension),n="word"===t||"excel"===t||"powerpoint"===t;if(!!e&&(e.linkPermission!==l.e.none&&n||!!this._addressBarLink))return h.createElement("div",{className:"od-PermissionsList-addressBarAccess","aria-label":b.x},h.createElement("div",{role:"heading","aria-level":1,className:"od-ShareLinkDetails--sectionHeader"},b.S),h.createElement("div",{className:"od-PermissionsList-addressBarDescription"},b.x),h.createElement("div",{className:"od-AddressBarLinkHint"},h.createElement(ht.e,{clientId:this.props.clientId,companyName:this.props.companyName,currentSettings:null,onShareHintClick:this._onAddressBarLinkClicked,sharingInformation:this.props.sharingInformation,linkRecipients:this.state.currentSharingLink?Object(Z.w)(this.state.currentSharingLink):[],customLabeledAudienceConfig:null,isAddressBarLinkHint:!0,addressBarLink:this._addressBarLink})))}};t.contextTypes={shareClickTime:i.number,sharingStore:i.object.isRequired,resize:i.func.isRequired};t.childContextTypes={onDismiss:i.func};return t})(h.Component);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareMain.blocker{position:relative}.od-ShareMain.blocker:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:0.8}.od-ShareMain.wide{min-width:480px}@media (max-width: 480px){.od-ShareMain.wide{min-width:320px}}.od-ShareMain-section{padding:12px 16px 0 16px}.isFluent .od-ShareMain-section{padding:16px 16px 0}.od-ShareMain-section.full-bleed{padding:0}.od-ShareMain-section.separator-top{border-top:1px solid "},{theme:"variantBorder",defaultValue:"#edebe9"},{rawString:"}.od-ShareMain-section.od-ShareMain-SharedWith{-ms-flex-item-align:stretch;align-self:stretch;padding-bottom:20px}.od-ShareMain-targets{clear:both;padding:0 20px 20px 20px}.od-ShareMain-section-body{margin-bottom:44px}.od-ShareMain-footer{outline:transparent;position:relative;font-size:12px;font-weight:400;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;padding:0 16px;width:100%;height:44px;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:";cursor:pointer;border:none;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";font:-apple-system-subheadline;bottom:0}.od-ShareMain-footer::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareMain-footer:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ShareMain-footer:focus:after{border-color:ActiveBorder}}.ms-Fabric .od-ShareMain-footer{position:fixed}.od-ShareMain-attachIcon{margin-top:2px;font-size:16px}[dir='ltr'] .od-ShareMain-attachIcon{margin-right:4px}[dir='rtl'] .od-ShareMain-attachIcon{margin-left:4px}.od-ShareMain-attachmentOptions .is-open{border:none;width:auto}.od-ShareMain-attachmentOptions button{width:auto}@media screen and (-ms-high-contrast: active){.od-ShareMain-footer:focus,.od-ShareMain-footer:hover{outline:2px solid}}\n"}]);var bt=n(2239),wt=n(2062);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-ShareTargets{padding-top:20px}.od-ShareTargets-items{list-style:none;display:inline-block}[dir='ltr'] .od-ShareTargets-items{margin-right:-10px}[dir='rtl'] .od-ShareTargets-items{margin-left:-10px}.od-ShareTargets-item{vertical-align:top;display:inline-block;text-align:center}[dir='ltr'] .od-ShareTargets-item{margin-right:10px}[dir='rtl'] .od-ShareTargets-item{margin-left:10px}.od-ShareTargets-item--bottomMargin{margin-bottom:16px}.od-ShareTargets-itemImage{-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-radius:50%;color:"},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:";cursor:pointer;display:inline-block;height:48px;margin-bottom:8px;width:48px}.od-ShareTargets-icon{font-size:25px;padding-top:11px}.isFluent .od-ShareTargets-icon{font-size:26px}.od-ShareTargets-itemImage--border{border:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-ShareTargets-itemText{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font:-apple-system-short-caption2}.isFluent .od-ShareTargets-itemText{font-size:10px}.od-ShareTargets-target{outline:transparent;position:relative;background:none;border:none}.od-ShareTargets-target::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-ShareTargets-target:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-ShareTargets-target:focus:after{border-color:ActiveBorder}}.od-ShareTargets-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}@media screen and (-ms-high-contrast: active){.od-Share button:not(.ms-Button).od-ShareTargets-target{outline:1px solid windowText}.od-Share button:not(.ms-Button).od-ShareTargets-target:focus{outline:2px solid highlight}}\n"}]);var Et,St=n(2160),xt=n(70),Tt=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.sharingInformation.requiresAccessApproval&&this.props.currentSettings.audience!==f.e.existing&&this.props.currentSettings.audience!==f.e.anyone&&this.props.currentSettings.audience!==f.e.organization;this._shareTargetsData=this._getShareTargetsData();return e?h.createElement("div",{className:"od-ShareTargets"},h.createElement(ee.e,{content:b.u,calloutProps:{calloutWidth:300,directionalHint:U.e.topCenter}},h.createElement("ul",{className:"od-ShareTargets-items","aria-label":b.gr},this._renderTargets()))):h.createElement("div",{className:"od-ShareTargets"},h.createElement("ul",{className:"od-ShareTargets-items","aria-label":b.gr},this._renderTargets()))};t.prototype._renderTargets=function(){for(var e=[],t=this.props.sharingInformation.requiresAccessApproval&&this.props.currentSettings.audience!==f.e.existing&&this.props.currentSettings.audience!==f.e.anyone&&this.props.currentSettings.audience!==f.e.organization,n=!xt.t.isActivated("2f033097-46da-4c25-9748-ce932d169987","07/01/2021","Blocking share targets (e.g. CopyLink) by blockPeoplePickerAndSharing.")&&this.props.sharingInformation.blockPeoplePickerAndSharing&&this.props.currentSettings.audience!==f.e.existing,r=0,i=this._shareTargetsData;r<i.length;r++){var s=i[r],o=void 0,u=s.icon,a=u.split(":",2)[1],l=t||n||Object(Z.L)(this.props.sharingInformation),c="od-ShareTargets-icon "+(l?"od-ShareTargets-disabled":""),p="od-ShareTargets-itemText ms-font-xs "+(l?"od-ShareTargets-disabled":"");o=u.indexOf("font:")>-1?h.createElement(Y.e,{iconName:a,className:c}):h.createElement("img",{src:a,className:c});e.push(h.createElement("li",{role:"presentation",key:s.shareType,className:"od-ShareTargets-item"},h.createElement("button",{className:"od-ShareTargets-target",disabled:l,onClick:s.action},h.createElement("div",{role:"presentation","aria-hidden":"true",className:"od-ShareTargets-itemImage"},o),h.createElement("div",{className:p},s.label))))}return e};t.prototype._getShareTargetsData=function(){var e=[{label:b.He,icon:"font:Link",bgColor:"ms-bgColor-themePrimary",shareType:u.e.copy,action:this._onClick.bind(this,u.e.copy)}],t=this._determineMailShareTarget(this.props.clientId);t===St.e.available?e.push({label:b.yr,icon:"font:OutlookLogo",bgColor:"ms-bgColor-themePrimary",shareType:u.e.outlook,action:this._onClick.bind(this,u.e.outlook)}):t===St.e.other&&e.push({label:b.qn,icon:"font:Mail",bgColor:"ms-bgColor-themePrimary",shareType:u.e.nonOutlook,action:this._onClick.bind(this,u.e.nonOutlook)});this._isTeamsShareTargetEnabled()&&e.push({label:b.No,icon:"font:TeamsLogo",bgColor:"ms-bgColor-themePrimary",shareType:u.e.teams,action:this._onClick.bind(this,u.e.teams)});this._isMoreAppsShareTargetEnabled()&&e.push({label:b.Ln,icon:"font:More",bgColor:"ms-bgColor-themePrimary",shareType:u.e.moreApps,action:this._onClick.bind(this,u.e.moreApps)});return e};t.prototype._onClick=function(e){this.props.onShareTargetClicked(e)};t.prototype._determineMailShareTarget=function(e){if(C.m(this.props.clientId)&&this.props.outlookAvailability===St.e.available)return St.e.available;try{return window.external.CheckSendViaOutlookAvailability()}catch(e){return St.e.none}};t.prototype._isTeamsShareTargetEnabled=function(){try{return window.external.IsTeamsEnabled()}catch(e){return!1}};t.prototype._isMoreAppsShareTargetEnabled=function(){try{return window.external.IsMoreAppsEnabled()}catch(e){return!1}};return t})(h.Component);(Et||(Et={})).getAttachAsCopyOptions=function(e,t,n,r){var i=[],s=(function(e,t,n,r){var i=!1,s=n.name.split("."),o="";s.length>1&&(o=s[1].toLowerCase());try{var u=window.external;i=u.IsSendCopyEnabled()}catch(e){}if(i){var a=function(){(function(e,t){e.getEngagementHelper().sendACopyOfficeClicked(t);try{window.external.SendCopy()}catch(e){}})(e,r)};return C.p(t)||(function(e){return["doc","docx","dot","docm","odt","rtf","txt"].indexOf(e)>-1})(o)?{key:"word",name:b.Ro,iconProps:{iconName:"WordDocument",className:"Share-wordIcon"},onClick:a}:C.l(t)||(function(e){return["ppt","pptx","pptm","ppsx","pps","ppsm","odp"].indexOf(e)>-1})(o)?{key:"powerpoint",name:b.Ci,iconProps:{iconName:"PowerPointDocument",className:"Share-powerpointIcon"},onClick:a}:C.r(t)||(function(e){return["xlsx","xlsm","xlsb","xls","ods","csv","xlt","xltm","xltx"].indexOf(e)>-1})(o)?{key:"excel",name:b.ut,iconProps:{iconName:"ExcelDocument",className:"Share-excelIcon"},onClick:a}:C.h(t)||(function(e){return["vsd","vsdx"].indexOf(e)>-1})(o)?{key:"visio",name:b.Io,iconProps:{iconName:"VisioLogo"},onClick:a}:{key:"document",name:b.et,iconProps:{iconName:"Document"},onClick:a}}})(n,e,t,r);s&&i.push(s);var o=(function(e,t){var n=!1;try{var r=window.external;n=r.IsSendPdfEnabled()}catch(e){}if(n)return{key:"pdf",name:b.Ur,iconProps:{iconName:"PDF",className:"Share-pdfIcon"},onClick:function(){(function(e,t){e.getEngagementHelper().sendACopyPdfClicked(t);try{window.external.SendPdf()}catch(e){}})(e,t)}}})(n,r);o&&i.push(o);return i};var Nt=Et,Ct=n(2057),kt=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._headerControl=Object(h.createRef)();r._peoplePickerHasUnresolvedText=!1;r._onSharedWithClicked=function(){r.context.sharingStore.getEngagementHelper().manageAccessFacePileClicked(r._engagementExtraData);r.props.onShowPermissionsListClicked()};r._onSelectedPeopleChange=function(e){var t=r.props,n=pe.s({selectedItems:e,sharingLinkKind:t.currentSettings.sharingLinkKind,canAddExternalPrincipal:t.sharingInformation.canAddExternalPrincipal,sharingInformation:t.sharingInformation,viewPolicyTipCallback:t.onViewPolicyTipClicked,onShareHintClick:Object(Z.r)(t.sharingInformation)?t.onShareHintClicked:void 0,permissionsMap:t.permissionsMap});if(n){for(var i=t.currentSettings.sharingLinkKind,s=3===i||2===i,o=!1,u=0,a=e;u<a.length;u++){if(a[u].isExternal&&s){o=!0;break}}o&&r.context.sharingStore.getEngagementHelper().externalSharingCslError(r._engagementExtraData)}r.setState({peoplePickerErrorMessage:n},function(){t.onSelectedPeopleChange(e)})};r._onPeoplePickerInputChange=function(e){r._peoplePickerHasUnresolvedText=""!==e};r._onShareTargetClicked=function(e){!r._isPeoplePickerValid(e)&&(r.props.currentSettings.audience===f.e.specificPeopleFlex||r.props.currentSettings.audience===f.e.specificPeople||r.props.linkRecipients.length>0)||r.setState({showActivityIndicator:!0,shareType:e},function(){r.props.onShareTargetClicked(e)})};r._onSendLinkClicked=function(e,t){r._isPeoplePickerValid(u.e.share)&&r.setState({showActivityIndicator:!0,shareType:u.e.share},function(){r.props.onSendLinkClicked(e,t)})};r._onAttachAsCopyClicked=function(){var e=r.props.clientId;r.context.sharingStore.getEngagementHelper().sendACopyClicked(r._engagementExtraData);if(C.u(e)){var t=!r.state.isAttachAsCopyContextualMenuVisible;r.setState({isAttachAsCopyContextualMenuVisible:t},function(){})}else if(e===Ie.e.ngsc||C.s(e))try{window.external.SendCopy()}catch(e){}};r._shareClickTime=n.shareClickTime;r._shouldRenderSharedWith=!Ae.o()&&n.sharingStore.isConsumer&&!n.sharingStore.isConsumer();r._engagementExtraData=t.engagementExtraData;r.state={isAttachAsCopyContextualMenuVisible:!1,shareType:u.e.share,showActivityIndicator:!1,peoplePickerErrorMessage:null};return r}t.prototype.componentDidMount=function(){_e.l(this._shareClickTime,this.props.clientId,o.e.share,this.props.scenarioId,this.props.correlationId);this._updatePeoplePickerError(this.props);C.s(this.props.clientId)&&this._headerControl.current&&this._headerControl.current.focusCloseButton()};t.prototype.UNSAFE_componentWillReceiveProps=function(e){this._updatePeoplePickerError(e)};t.prototype.render=function(){var e=this.props,t=this.state.showActivityIndicator?this._getActivityMessage():"",n=this.props.hideShareDialogOverflowButton||this._shouldRenderSharedWith,i=this._renderFooter(),s=i?{className:"od-ShareMain-section-body"}:null;return h.createElement("div",{className:"od-ShareMain "+(this.state.showActivityIndicator?" blocker":"")+" "+(Ae.m()?"wide":"")},h.createElement(S.e,Object(r.__assign)({},Object(E.e)(this.props),{item:e.item,onManageExistingAccessClick:this.props.onShowPermissionsListClicked,viewState:0,hideShareDialogOverflowButton:n,ref:this._headerControl,closeButtonOnBlur:this.props.closeButtonOnBlur,closeButtonOnFocus:this.props.closeButtonOnFocus})),h.createElement("div",Object(r.__assign)({},s),h.createElement("div",{className:"od-ShareMain-section full-bleed"},h.createElement(ht.e,{clientId:e.clientId,companyName:e.companyName,currentSettings:e.currentSettings,onShareHintClick:e.onShareHintClicked,sharingInformation:e.sharingInformation,linkRecipients:null,customLabeledAudienceConfig:e.customLabeledAudienceConfig,useDarkBorder:!1})),this._renderSendLink(),this._renderTargets(),this._renderSharedWith()),i,this._renderActivityIndicator(),it.e(t,"assertive","alert",!0))};t.prototype._renderTargets=function(){return h.createElement("div",{className:"od-ShareMain-targets"},h.createElement(Tt,{clientId:this.props.clientId,currentSettings:this.props.currentSettings,onShareTargetClicked:this._onShareTargetClicked,outlookAvailability:this.props.outlookAvailability,sharingInformation:this.props.sharingInformation}))};t.prototype._renderFooter=function(){var e=this.props,t=e.clientId;if(C.u(t)){var n=Nt.getAttachAsCopyOptions(t,e.item,this.context.sharingStore,this._engagementExtraData);if(1===n.length&&"pdf"!==n[0].key)return h.createElement("div",null,h.createElement("button",{className:"od-ShareMain-footer",onClick:n[0].onClick},h.createElement("div",{"aria-hidden":!0,role:"presentation",className:"od-ShareMain-attachIcon"},h.createElement(Y.e,{iconName:"Copy"})),h.createElement("span",null,b.Q)));if(n.length>0)return h.createElement("div",null,h.createElement(m.e,{className:"od-ShareMain-footer",text:b.Q,iconProps:{iconName:"Copy"},menuProps:{shouldFocusOnMount:!0,items:n}}))}else if((t===Ie.e.ngsc||C.s(t))&&this._isSendCopyEnabled())return h.createElement("div",null,h.createElement("button",{className:"od-ShareMain-footer",onClick:this._onAttachAsCopyClicked},h.createElement("div",{className:"od-ShareMain-attachIcon"},h.createElement(Y.e,{iconName:"Copy"})),h.createElement("span",null,b.Q)))};t.prototype._renderSendButtonLabel=function(){if(Ae.f()){var e=void 0;switch(Le.t()){case 0:e=b.xs;break;case 1:e=b.Ts;break;default:e=b.xs}return e}return b.xs};t.prototype._renderSendLink=function(){if(!this.props.sharingInformation.blockPeoplePickerAndSharing||Object(Z.L)(this.props.sharingInformation)){var e=this.props;return h.createElement("div",{className:"od-ShareMain-section"},h.createElement(bt.e,{ctaLabel:this._renderSendButtonLabel(),showTextArea:!0,sharingInformation:e.sharingInformation,onSendLinkClicked:this._onSendLinkClicked,currentSettings:e.currentSettings,onSelectedPeopleChange:this._onSelectedPeopleChange,groupsMemberCount:e.groupsMemberCount,onViewPolicyTipClicked:e.onViewPolicyTipClicked,linkRecipients:e.linkRecipients,permissionsMap:e.permissionsMap,messageText:e.messageText,subjectText:e.subjectText,onSendLinkMessageChange:e.onSendLinkMessageChange,onSendLinkSubjectChange:e.onSendLinkSubjectChange,createPeopleSharingLinks:e.createPeopleSharingLinks,errorMessage:this.state.peoplePickerErrorMessage,clientId:e.clientId,showSendButton:!0,maximumMessageLength:500,maximumSubjectLength:100,isLoadingDefaultRecipients:e.isLoadingDefaultRecipients,onManageExistingAccessClick:this.props.onShowPermissionsListClicked,engagementExtraData:this._engagementExtraData,onShareHintClicked:this.props.onShareHintClicked,onRoleChange:this.props.onRoleChange,onPeoplePickerInputChange:this._onPeoplePickerInputChange,onLinkSettingsClicked:e.onShareHintClicked}))}};t.prototype._renderSharedWith=function(){if(this._shouldRenderSharedWith){var e=this.props.sharingInformation,t=e.sharingLinks,n=e.sharingPrincipals,r=t.filter(function(e){return e.isActive&&1!==e.sharingLinkKind&&(!e.expiration||e.expiration.getTime()>Date.now())&&!(e.isAddressBarLink&&!0===e.isUnhealthy)}),i=!!r.length;if(!i&&n.length)for(var s=0,o=n;s<o.length;s++){if(o[s].role!==l.e.owner){i=!0;break}}if(i)return h.createElement("div",{className:"od-ShareMain-section od-ShareMain-SharedWith separator-top"},h.createElement(wt.e,{ariaLabel:b.yn,label:b.Bs,getPhotoUrl:Object(Ct.e)(this.props.sharingInformation.webUrl),onClick:this._onSharedWithClicked,sharingLinks:r,sharingPrincipals:n}))}return null};t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return h.createElement(c.e,{message:this._getActivityMessage(),ariaHidden:!0})};t.prototype._getActivityMessage=function(){switch(this.state.shareType){case u.e.share:return b.d;case u.e.copy:case u.e.outlook:case u.e.nonOutlook:case u.e.teams:case u.e.moreApps:default:return b.p}};t.prototype._isSendCopyEnabled=function(){try{return window.external.IsSendCopyEnabled()}catch(e){return!1}};t.prototype._isPeoplePickerValid=function(e){if(!this.state.peoplePickerErrorMessage){if(e!==u.e.share&&!this.props.createPeopleSharingLinks&&this.props.currentSettings.audience===f.e.specificPeople){for(var t=!1,n=!1,r=0,i=this.props.linkRecipients;r<i.length;r++){var s=i[r];t||(t=s.isExternal&&!s.providerName);n||(n=!s.isExternal||s.isExternal&&!!s.providerName)}if(t&&n){this.setState({peoplePickerErrorMessage:h.createElement("span",null,b.Tn)});return!1}}var o=this.props.currentSettings.audience===f.e.specificPeopleFlex||this.props.currentSettings.audience===f.e.specificPeople||e===u.e.share;if(this._peoplePickerHasUnresolvedText){this.setState({peoplePickerErrorMessage:h.createElement("span",null,b.Ao)});return!1}if(0===this.props.linkRecipients.length&&o){this.setState({peoplePickerErrorMessage:h.createElement("span",null,b.rs)});return!1}return!0}};t.prototype._updatePeoplePickerError=function(e){if(e.linkRecipients){var t=pe.s({selectedItems:e.linkRecipients,sharingLinkKind:e.currentSettings.sharingLinkKind,canAddExternalPrincipal:e.sharingInformation.canAddExternalPrincipal,sharingInformation:e.sharingInformation,viewPolicyTipCallback:e.onViewPolicyTipClicked,onShareHintClick:Object(Z.r)(e.sharingInformation)?e.onShareHintClicked:void 0,permissionsMap:e.permissionsMap});this.setState({peoplePickerErrorMessage:t,showActivityIndicator:!t&&this.state.showActivityIndicator})}};t.prototype.shouldShowActivityIndicator=function(e){this.setState({showActivityIndicator:e})};t.contextTypes={shareClickTime:i.number,sharingStore:i.object.isRequired};return t})(h.Component);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-Share-PolicyTip{padding:0px 16px 10px 16px}.od-Share-PolicyTip .od-PolicyTip-title{display:none}\n"}]);var Lt=n(2543),At=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this;i._onOverrideClicked=function(){var e=i.props.policyTipInformation.info.overrideOption;1===e?i._store.updatePolicy(0):2===e&&i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{showJustificationInput:!0}))};i._onOverrideSubmitClicked=function(e){i._store.updatePolicy(0,e)};i._onReportClicked=function(){i._store.updatePolicy(1)};i._store=n.sharingStore;i._resize=n.resize;i.state={showJustificationInput:!1};return i}t.prototype.componentDidUpdate=function(){this._resize()};t.prototype.render=function(){var e=this.props,t=this.state,n=e.policyTipInformation.info;return h.createElement("div",{className:"od-SharePolicyDetails"},h.createElement(S.e,Object(r.__assign)({},Object(E.e)(this.props),{item:e.sharingInformation.item,viewState:6,hasBackButton:!0})),h.createElement("div",{className:"od-Share-PolicyTip"},h.createElement(Lt.e,{confirmationText:this._getConfirmationText(),onDismissed:function(){},onOverrideClicked:this._onOverrideClicked,onOverrideSubmitClicked:this._onOverrideSubmitClicked,overrideRequiresJustification:n?2===n.overrideOption:void 0,showJustificationInput:t.showJustificationInput,onReportClicked:this._onReportClicked,strings:this._getStrings()})))};t.prototype._getStrings=function(){var e=this.props.policyTipInformation.info,t=e&&(1===e.overrideOption||2===e.overrideOption);return{headerText:b.Ii,issues:e?e.issueDescriptions:void 0,lastScannedText:e&&e.lastScanned?b.qi+": "+Object(Te.r)(e.lastScanned):void 0,learnMoreActionLabel:e?b.Ri:void 0,learnMoreLabel:e?b.Ui:void 0,learnMoreUrl:e?e.policyInfoUrl:void 0,noPolicyTipInfoError:e?void 0:b.zi,overrideActionLabel:t?b.Wi:void 0,overrideLabel:b.Vi,policyTipDescription:e?e.explanationText:void 0,reportActionLabel:b.$i,reportLabel:b.Qi,reportInProgressLabel:b.Ki,submitButtonLabel:b.Gi,titleText:void 0}};t.prototype._getConfirmationText=function(){var e=this.props.policyTipInformation.actionResult;return null===e?"":1===e?b.Ji:2===e||3===e?b.Xi:""};t.contextTypes={sharingStore:i.object.isRequired,resize:i.func.isRequired};return t})(h.Component),Ot=n(1636),Mt=n(2236);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-Notify{padding:0px 4px}.od-Notify.blocker{position:relative}.od-Notify.blocker:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:0.8}.od-Notify .ms-Checkbox-label{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-Notify-message{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;font-size:15px;padding:6px 0px 4px 0px;margin:0px 3px 0px 0px}[dir='rtl'] .od-Notify-message{margin:0px 0px 0px 3px}.od-Notify-horizontalLine{border-bottom:1px solid "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";padding-top:10px}.od-Notify-show-link{display:block;font-size:14px;margin:8px 0px 0px auto}[dir='rtl'] .od-Notify-show-link{margin:8px auto 0px 0px}.od-Notify-sendNotification-button{margin:24px auto 6px 0px}[dir='ltr'] .od-Notify-sendNotification-button{text-align:right}[dir='rtl'] .od-Notify-sendNotification-button{text-align:left}[dir='rtl'] .od-Notify-sendNotification-button{margin:24px 0px 6px auto}.od-Notify-group-recipient{display:-webkit-box;display:-ms-flexbox;display:flex}.od-Notify-group-checkbox .ms-Checkbox-checkbox{height:14px;width:14px}.od-Notify-PickerPersona-checkbox .ms-Checkbox-checkbox{height:14px;width:14px}.od-Notify-PickerPersona-checkbox{margin:0px 0px 0px auto}[dir='rtl'] .od-Notify-PickerPersona-checkbox{margin:0px auto 0px 0px}.od-Notify-people-selectAll-checkbox .ms-Checkbox-checkbox{height:14px;width:14px;margin:0px 10px 0px 0px;font-size:13px}[dir='rtl'] .od-Notify-people-selectAll-checkbox .ms-Checkbox-checkbox{margin:0px 0px 0px 10px}.od-Notify-recipientWarning-container{height:38px}.od-Notify-recipientWarning{position:absolute;background-color:rgba(255,185,0,0.3)}[dir='ltr'] .od-Notify-recipientWarning{left:0}[dir='rtl'] .od-Notify-recipientWarning{right:0}.od-Notify-recipientWarning .ms-MessageBar-content{height:43px;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.ms-PickerItem-content{max-width:250px}.od-Notify-PickerPersona-container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-Notify-PickerPersona{border-radius:16px;position:relative;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;vertical-align:top;white-space:nowrap;cursor:default}.od-Notify-PickerPersona .ms-Persona-secondaryText{font-size:11px}.od-Notify-PickerPersona.is-listbelow{width:100%}.od-Notify-groupLabel{font-weight:600;font-size:13px}.od-Notify-totalGroupsMembersCount{font-size:11px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";padding:0px 0px 12px}.od-Notify-totalMembersCount{font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";padding:6px 0px;margin:0px 0px 0px auto}[dir='ltr'] .od-Notify-totalMembersCount{text-align:right}[dir='rtl'] .od-Notify-totalMembersCount{text-align:left}[dir='rtl'] .od-Notify-totalMembersCount{margin:0px auto 0px 0px}.od-Notify-groups-expand{height:26px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;margin:14px 0px 0px}.od-Notify-group-expand-icon .ms-Button-icon{font-size:12px}.od-Notify-groups-listItem{margin:5px 1px}.od-Notify-groups-recipient-container{max-height:145px;overflow-x:hidden}.od-Notify-groups-recipient-container.expanded{margin-bottom:15px}.od-Notify-groups-recipient-container.expanded.scroll{overflow-y:scroll}.od-Notify-group-checkbox .ms-Checkbox-text{max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.od-Notify-peopleLabel{padding:5px 0px 14px;font-weight:600;font-size:13px}.od-Notify-people-recipient-container{max-height:190px;overflow-x:hidden;padding:8px 0px 10px;margin-top:6px}.od-Notify-people-recipient-container.scroll{overflow-y:scroll}.od-Notify-PeoplePicker .ms-Persona-primaryText{max-width:150px;overflow-y:hidden;overflow-x:hidden;white-space:nowrap;text-overflow:ellipsis}.od-Notify-PickerPersona-container{margin:8px 0px}.od-Notify-groupMembersCount{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";font-size:11px}[dir='ltr'] .od-Notify-groupMembersCount{margin-left:28px}[dir='rtl'] .od-Notify-groupMembersCount{margin-right:28px}.od-Notify-groupMembersCount .ms-Spinner-circle{margin:0px}\n"}]);var _t=n(1845),Dt=n(1635),Pt=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._onCheckboxChange=function(e,t){var n=r.props.group;n.checked=t;r.setState({group:n},function(){r._sharingStore.getEngagementHelper().log("Notify.GroupCheckboxClicked",r.props.engagementExtraData);r.props.updateCountCallback();r.props.updateCheckboxForGroup(n)})};r._sharingStore=n.sharingStore;r.state={group:t.group};return r}t.prototype.UNSAFE_componentWillMount=function(){this._sharingStore.fetchMemberCount(this.props.group)};t.prototype.componentDidMount=function(){this._sharingStore.addListener(this.props.updateCountCallback)};t.prototype._renderGroup=function(){var e=this.state.group,t=e.disabled;return h.createElement(A.e,{id:e.email,boxSide:"start",label:t?e.name+" ("+b.Qn+")":e.name,checked:e.checked,defaultChecked:!1,onChange:this._onCheckboxChange,className:Object(F.e)("od-Notify-group-checkbox"),disabled:e.disabled})};t.prototype.render=function(){var e=this.state.group,t=e.disabled;return h.createElement(ee.e,{className:Object(F.e)("od-Notify-group-recipient"),id:e.email,content:t?e.name+" ("+b.Qn+")":e.name,directionalHint:U.e.bottomCenter},this._renderGroup())};t.contextTypes={sharingStore:i.object.isRequired,strings:i.object.isRequired};return t})(h.Component),Ht=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._onCheckboxChange=function(e,t){var n=r.props.person;n.checked=t;r.setState({person:n});r.context.sharingStore.getEngagementHelper().log("Notify.PersonCheckboxClicked",r.props.engagementExtraData);r.props.updateCheckboxForPerson(n)};r.state={person:t.person};return r}t.prototype.render=function(){var e=this.state.person;return h.createElement("div",{className:Object(F.e)("od-Notify-PickerPersona-container")},h.createElement(Re.e,{imageUrl:e.image,text:e.name,secondaryText:e.job,showSecondaryText:!!e.job,size:Ue.n.extraSmall,className:Object(F.e)("od-Notify-PickerPersona")}),h.createElement(A.e,{id:e.email,boxSide:"end",checked:e.checked,defaultChecked:!1,onChange:this._onCheckboxChange,className:Object(F.e)("od-Notify-PickerPersona-checkbox")}))};t.contextTypes={sharingStore:i.object.isRequired,strings:i.object.isRequired};return t})(h.Component),Bt=n(2066),jt=n(1938),Ft=n(1737),It=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this;i._topLevelDivRef=h.createRef();i._onExpandClick=function(){i.setState(function(e){return Object(r.__assign)(Object(r.__assign)({},e),{isExpanded:!e.isExpanded})},function(){i._sharingStore.getEngagementHelper().log("Notify.ExpandLinkClicked",i.props.engagementExtraData)})};i._onStoreUpdate=function(){var e=i._sharingStore.getPermissionsMap(),t=pe.s({selectedItems:i.state.peoplePickerRecipients,sharingLinkKind:1,canAddExternalPrincipal:i.props.sharingInformation.canAddExternalPrincipal,sharingInformation:i.props.sharingInformation,viewPolicyTipCallback:i._sharingStore.getPolicyTipInformation,permissionsMap:e});t&&i._sharingStore.getEngagementHelper().log("Notify.AddedUserWhoDoesNotHaveAccess",i.props.engagementExtraData);e=Object(r.__assign)(Object(r.__assign)({},i.state.permissionsMap),e);i.setState(function(n){return Object(r.__assign)(Object(r.__assign)({},n),{peoplePickerError:t,permissionsMap:e})})};i._onPeoplePickerSelected=function(e){i._sharingStore.checkPermissions(e);e.filter(function(e){return e.principalType!==ft.e.user}).forEach(function(e){i._sharingStore.fetchMemberCount(e)});i._sharingStore.getEngagementHelper().log("Notify.AddedUserFromPeoplePicker",i.props.engagementExtraData);var t=i._sharingStore.getPermissionsMap(),n=pe.s({selectedItems:i.state.peoplePickerRecipients,sharingLinkKind:1,canAddExternalPrincipal:i.props.sharingInformation.canAddExternalPrincipal,sharingInformation:i.props.sharingInformation,viewPolicyTipCallback:i._sharingStore.getPolicyTipInformation,permissionsMap:t});t=Object(r.__assign)(Object(r.__assign)({},i.state.permissionsMap),t);i.setState(function(i){return Object(r.__assign)(Object(r.__assign)({},i),{peoplePickerRecipients:e,peoplePickerError:n,permissionsMap:t})})};i._onResolvedSuggestions=function(e){i._sharingStore.getEngagementHelper().peoplePickerLinkedinSuggestions(i.props.engagementExtraData,e);return e};i._updateGroupCount=function(){for(var e=i._sharingStore.getMembersCounts(),t=i.state.groups.slice(0),n=0;n<t.length;n++){var s=i.state.groups[n];if(e[s.email]!==s.memberCount){s.memberCount=e[s.email];s.checked=!1;s.disabled=s.memberCount>=100;t[n]=s}}i.setState(function(e){return Object(r.__assign)(Object(r.__assign)({},e),{groups:t})})};i._updateCheckboxForGroup=function(e){var t=i.state.groups;t.map(function(t){return t.email===e.email?e:t});i.setState({groups:t})};i._updateCheckboxForPerson=function(e){var t=i.state.people;t.map(function(t){return t.email===e.email?e:t});i.setState({people:t})};i._sendNotification=function(){var e=i._allRecipients();i.setState({showActivityIndicator:!0},function(){_e.p();i._sharingStore.shareLink({settings:i.props.currentSettings,recipients:e,allRecipientsHaveAccess:!0});i._sharingStore.getEngagementHelper().shareCompleted(Object(r.__assign)(Object(r.__assign)({},i.props.engagementExtraData),{recipientsCount:e.length}));_e.d(u.e.share);i._showSuccessMessage()})};i._onGroupsExpandClick=function(){var e=i.state.groupsIsExpanded;i.setState(function(t){return Object(r.__assign)(Object(r.__assign)({},t),{groupsIsExpanded:!e})},function(){i._sharingStore.getEngagementHelper().log("Notify.GroupsExpandClicked",i.props.engagementExtraData)})};i._selectAllPeopleCheckbox=function(e,t){var n=i.state.people;n.map(function(e){e.checked=t;return e});i.setState({people:n})};i._sharingStore=n.sharingStore;i._shareClickTime=n.shareClickTime;i._resize=n.resize;i.state={isExpanded:!1,groupsIsExpanded:!1,count:0,peoplePickerRecipients:[],groups:[],people:[],peoplePickerError:null,showActivityIndicator:!1,permissionsMap:{},viewState:9};i._resizeTracker=new oe.e(n.resize);return i}t.prototype.UNSAFE_componentWillMount=function(){var e=this,t=this.props;this._sharingStore.addListener(this._onStoreUpdate);var n=t.sharingInformation.sharingPrincipals,i=t.sharingInformation.sharingLinks.reduce(function(e,t){return e.concat(t.principals)},[]).concat(n).map(function(e){return{userId:e.loginName,name:e.primaryText,job:e.secondaryText,email:""!==e.email?e.email:e.loginName,principalType:e.type,image:e.imageUrl,rawPersonData:{Key:e.loginName,EntityData:{SPGroupID:e.id}}}}),s=i.filter(function(e){return e.principalType!==ft.e.user}).map(function(e){return Object(r.__assign)(Object(r.__assign)({},e),{checked:!1,expanded:!1,disabled:!0,groupId:e.rawPersonData.groupId,memberCount:null})});s.forEach(function(t){e._sharingStore.fetchMemberCount(t)});var o=i.filter(function(e){return e.principalType===ft.e.user}),u={};o.concat(s).forEach(function(e){u[e.email]=3});this.state.peoplePickerRecipients.filter(function(e){return e.principalType!==ft.e.user}).forEach(function(t){e._sharingStore.fetchMemberCount(t)});this.setState({isExpanded:!0,groupsIsExpanded:!0,count:0,peoplePickerRecipients:[],groups:s,people:o,peoplePickerError:null,permissionsMap:u,viewState:9})};t.prototype.componentDidMount=function(){_e.l(this._shareClickTime,this.props.clientId,o.e.notify,this.props.scenarioId,this.props.correlationId);this.setState({groupsIsExpanded:!1,isExpanded:!1});this._resizeIfNeeded()};t.prototype.componentDidUpdate=function(e,t){this._resizeIfNeeded()};t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)};t.prototype._renderPeoplePicker=function(){var e=this.state,t=this.props;return h.createElement("div",{className:Object(F.e)("od-Notify-PeoplePicker")},h.createElement(de.e,{defaultSelectedItems:e.peoplePickerRecipients,onChange:this._onPeoplePickerSelected,onResolvedSuggestions:this._onResolvedSuggestions,pickerSettings:t.sharingInformation.peoplePickerSettings,sharingLinkKind:t.currentSettings.sharingLinkKind,error:e.peoplePickerError,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),sharingInformation:t.sharingInformation,permissionsMap:e.permissionsMap,clientId:t.clientId}))};t.prototype._computeTotalGroupsMembersCount=function(){var e=this.state,t=this._sharingStore.getMembersCounts();return e.groups.filter(function(e){return e.checked&&t[e.email]}).map(function(e){return t[e.email]}).reduce(function(e,t){return e+t},0)};t.prototype._computeTotalMemberCount=function(){var e=this._sharingStore.getMembersCounts(),t={};this._allRecipients().forEach(function(e){t[e.email]||(t[e.email]=e)});return Object.keys(t).map(function(n){return t[n].principalType===ft.e.user?1:e[n]||0}).reduce(function(e,t){return e+t},0)};t.prototype._allRecipients=function(){var e=this.state;return e.peoplePickerRecipients.concat(e.people.filter(function(e){return e.checked})).concat(e.groups.filter(function(e){return e.checked}))};t.prototype._showSuccessMessage=function(){this.setState(function(e){return Object(r.__assign)(Object(r.__assign)({},e),{viewState:4,showActivityIndicator:!1})})};t.prototype._renderGroup=function(e){return h.createElement(Pt,{clientId:this.props.clientId,group:e,updateCountCallback:this._updateGroupCount,updateCheckboxForGroup:this._updateCheckboxForGroup,engagementExtraData:this.props.engagementExtraData})};t.prototype._renderGroups=function(e){var t=this,n=this.state,r=n.groupsIsExpanded?" expanded ":"",i=n.groups.length>5?" scroll ":"";if(0!==e.length)return h.createElement("div",{className:Object(F.e)("od-Notify-groups-container")},h.createElement("div",{className:Object(F.e)("od-Notify-groups-expand")},h.createElement(_t.e,{className:Object(F.e)("od-Notify-groupLabel")},b.Gn),h.createElement(ue.e,{className:"od-Notify-group-expand-icon",iconProps:{iconName:r?"ChevronUp":"ChevronDown"},onClick:this._onGroupsExpandClick})),this._displayTotalGroupsMembersCount(),h.createElement("div",{className:Object(F.e)("od-Notify-groups-recipient-container"+r+i)},r&&e.map(function(e){return h.createElement("div",{key:e.email,className:Object(F.e)("od-Notify-groups-listItem")},t._renderGroup(e))})))};t.prototype._renderPerson=function(e){return h.createElement(Ht,{clientId:this.props.clientId,person:e,updateCheckboxForPerson:this._updateCheckboxForPerson,engagementExtraData:this.props.engagementExtraData})};t.prototype._renderPeople=function(e){var t=this,n=this.state,r=n.people.length>5?" scroll ":"";return h.createElement("div",{className:Object(F.e)("od-Notify-people-container")},h.createElement(_t.e,{className:Object(F.e)("od-Notify-peopleLabel")},b.sr),n.people.length>0&&h.createElement(A.e,{label:b.or,onChange:this._selectAllPeopleCheckbox,defaultChecked:!1,className:Object(F.e)("od-Notify-people-selectAll-checkbox")}),h.createElement("div",{className:Object(F.e)("od-Notify-people-recipient-container"+r)},e.map(function(e){return t._renderPerson(e)})))};t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return h.createElement(c.e,{message:b.d})};t.prototype._renderNotification=function(){var e=this.props,t=e.sharingInformation,n=e.currentSettings,i={companyName:this._sharingStore.getCompanyName(),currentSettings:n,sharingInformation:t,clientId:e.clientId,onShareHintClick:null,linkRecipients:this._allRecipients(),customLabeledAudienceConfig:e.customLabeledAudienceConfig};return h.createElement(He.e,Object(r.__assign)({},Object(E.e)(this.props),{shareType:u.e.share,itemName:t.item.name,linkUrl:null,sharingHintProps:i,shouldCopyLinkToClipboard:!0,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig}))};t.prototype._displayTotalMemberCountString=function(){var e=this._computeTotalMemberCount();return this.state.groups.filter(function(e){return e.checked}).length>0?y.format(b.nr,e):1===e?y.format(b.er):0===e?"":y.format(b.tr,e)};t.prototype._tooManyRecipientsErrorString=function(){return b.ii};t.prototype._displayTotalMembersCountOrError=function(){return h.createElement(_t.e,{className:Object(F.e)("od-Notify-totalMembersCount")},this._computeTotalMemberCount()>=100?this._tooManyRecipientsErrorString():this._displayTotalMemberCountString())};t.prototype._displayTotalGroupMemberCountString=function(){var e=this._computeTotalGroupsMembersCount();return 0===e?"":y.format(b.Yn,e)};t.prototype._displayTotalGroupsMembersCount=function(){return h.createElement(_t.e,{className:Object(F.e)("od-Notify-totalGroupsMembersCount")},this._displayTotalGroupMemberCountString())};t.prototype._renderWarning=function(){var e=this._computeTotalMemberCount(),t=y.format(b.Zn,e);return e>20&&e<100&&h.createElement("div",{className:"od-Notify-recipientWarning-container"},h.createElement(dt.e,{className:Object(F.e)("od-Notify-recipientWarning"),messageBarType:Ft.e.severeWarning,isMultiline:!0},t))};t.prototype._sendButtonError=function(){return h.createElement(_t.e,null,b.ur)};t.prototype._renderNotifyMain=function(){var e=this.state,t=this.props,n=e.showActivityIndicator?" blocker":"",i=Z.D(this.props.sharingInformation.item.name,10);return h.createElement("div",{className:"od-Notify"+n},h.createElement("div",{className:"od-Notify-headerAndMessage"},h.createElement(S.e,Object(r.__assign)({},Object(E.e)(this.props),{viewState:9})),h.createElement(_t.e,{className:Object(F.e)("od-Notify-message")},y.format(b.rr,i))),this._renderWarning(),!e.isExpanded&&h.createElement("div",null,h.createElement("div",{className:Object(F.e)("od-Notify-horizontalLine")}),h.createElement(Dt.e,{onClick:this._onExpandClick,className:Object(F.e)("od-Notify-show-link")},b.Cs)),e.isExpanded&&h.createElement("div",null,this._renderGroups(e.groups),this._renderPeople(e.people),this._renderPeoplePicker(),h.createElement("div",{className:Object(F.e)("od-Notify-sendNotification-button")},h.createElement(Bt.e,{ctaLabel:b.Ns,currentSettings:t.currentSettings,errorMessage:this._allRecipients().length<1||this._computeTotalMemberCount()>=100?this._sendButtonError():e.peoplePickerError,linkRecipients:this._allRecipients(),maximumMessageLength:1,maximumSubjectLength:1,messageText:"",subjectText:"",onSendLinkClicked:this._sendNotification,permissionsMap:e.permissionsMap,sendButtonType:jt.e.button,sharingInformation:t.sharingInformation})),this._displayTotalMembersCountOrError()))};t.prototype._renderViews=function(){switch(this.state.viewState){case 4:return this._renderNotification();default:return this._renderNotifyMain()}};t.prototype.render=function(){var e=this.state.showActivityIndicator?" blocker":"";return h.createElement("div",{className:"od-Notify"+e},this._renderViews(),this._renderActivityIndicator())};t.contextTypes={resize:i.func.isRequired,strings:i.object.isRequired,sharingStore:i.object.isRequired,shareClickTime:i.number};return t})(h.Component),qt=n(66),Rt=n(156);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-AddPeople{padding-bottom:24px}.od-AddPeople.blocker{position:relative}.od-AddPeople.blocker:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:0.8}.od-AddPeople.wide{min-width:480px}@media (max-width: 480px){.od-AddPeople.wide{min-width:320px}}.od-AddPeople .od-Share-PeoplePicker .ms-BasePicker-input{width:100%}.isFluent .od-AddPeople .od-Share-PeoplePicker .ms-BasePicker-input{font-size:.875rem;height:2.5rem}.od-AddPeople-Success{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.od-AddPeople-Success .od-ShareNotification-icon{margin-top:24px;font-size:1.3125rem;width:2.75rem;height:2.75rem}.od-AddPeople-Success .od-AddPeople-SuccessMessage{font-size:.875rem}.od-AddPeople-Failure{padding:24px 16px 0 16px;font-size:.875rem}.od-AddPeople-NotAllowed{padding:0 16px;font-size:.875rem}.od-AddPeople-NotAllowed button{font-size:.875rem;height:2rem}\n"}]);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-AddPeople-Edit-Header{width:100%;margin-bottom:.75rem}.od-AddPeople-Edit-Section{margin:0px 16px 0px 16px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column nowrap}.od-AddPeople-Edit-Section .od-AddPeople-Edit-Section-PermissionAlert{margin-bottom:8px}.od-AddPeople-Edit-Section .ms-TextField-wrapper{margin:6px 0}.od-AddPeople-Message{margin-top:12px}.od-AddPeople-Message div{border-color:transparent}.od-AddPeople-Message textarea{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";padding:0}.od-PeoplePicker-RoleSelector-wrapper{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.od-AddPeople-NotificationSelector{-ms-flex-item-align:start;align-self:flex-start;margin-top:12px;margin-bottom:12px}[dir='ltr'] .od-AddPeople-NotificationSelector .ms-Checkbox-text{margin-left:4px}[dir='rtl'] .od-AddPeople-NotificationSelector .ms-Checkbox-text{margin-right:4px}[dir='ltr'] .od-AddPeople-NotificationSelector .ms-Checkbox-checkbox{margin-right:4px}[dir='rtl'] .od-AddPeople-NotificationSelector .ms-Checkbox-checkbox{margin-left:4px}.od-AddPeople-AddButton{-ms-flex-item-align:start;align-self:flex-start;font-size:.875rem;height:2rem;padding:0 1rem}\n"}]);var Ut,zt=n(1922),Wt=(function(e){Object(r.__extends)(t,e);function t(t,n){var i,s=e.call(this,t)||this;s._peoplePickerHasUnresolvedText=!1;s._topLevelDivRef=h.createRef();s._onPeoplePickerChange=function(e){s.setState(function(t,n){var i=pe.s({selectedItems:e,sharingLinkKind:1,canAddExternalPrincipal:n.sharingInformation.canAddExternalPrincipal,sharingInformation:n.sharingInformation,viewPolicyTipCallback:function(){return null}}),o=s.state.notifyRecipients||e.filter(function(e){return e.isExternal}).length>0;return Object(r.__assign)(Object(r.__assign)({},t),{people:e,notifyRecipients:o,peoplePickerError:i})})};s._onPeoplePickerInputChange=function(e){s._peoplePickerHasUnresolvedText=""!==e};s._onMessageChange=function(e,t){s.setState({messageText:t})};s._validateMessage=function(e){var t,n=Object(Z.h)(e);s.setState({messageText:e});if(n<=500){t="";s.setState({shareMessageError:!1})}else{t=n+"/500";s.setState({shareMessageError:!0})}return t};s._onRoleSelectorChange=function(e){s.setState({roleSelection:e})};s._onAllowEditChange=function(e,t){s.setState({notifyRecipients:t})};s._onAddButtonClick=function(){if(s._peoplePickerHasUnresolvedText)s.setState(Object(r.__assign)(Object(r.__assign)({},s.state),{peoplePickerError:h.createElement("span",null,b.Ao)}));else{var e=s.state.messageText||null;s._store.addPeople(s.state.people,s.state.roleSelection,s.userRequiresAccessApproval(),s.state.notifyRecipients,e);s.props.onLoading&&s.props.onLoading({notifiedRecipients:s.state.notifyRecipients,requestedAccess:s.userRequiresAccessApproval()})}};s._store=n.sharingStore;s._resize=n.resize;s._store.addListener(function(){var e=s._store.getAddPeopleResult();if(null!==e){var t=e===zt.e.AccessRequestsQueued||e===zt.e.CompletedSuccessfully,n=s.userRequiresAccessApproval();t&&s.props.onSuccess?s.props.onSuccess({notifiedRecipients:s.state.notifyRecipients,requestedAccess:n}):s.props.onFailure&&s.props.onFailure({notifiedRecipients:s.state.notifyRecipients,requestedAccess:n})}});i=s.props.sharingInformation.userRole===l.e.owner?l.e.edit:s.props.sharingInformation.userRole;var o=pe.s({selectedItems:s.props.currentSettings.specificPeople,sharingLinkKind:1,canAddExternalPrincipal:s.props.sharingInformation.canAddExternalPrincipal,sharingInformation:s.props.sharingInformation,viewPolicyTipCallback:t.onViewPolicyTipClicked});s.state={people:[],messageText:"",roleSelection:i,notifyRecipients:!0,peoplePickerError:o,shareMessageError:!1};s._resizeTracker=new oe.e(n.resize);return s}t.prototype.componentDidMount=function(){this._resizeIfNeeded()};t.prototype.componentDidUpdate=function(e,t){this._resizeIfNeeded()};t.prototype.render=function(){return h.createElement("div",{ref:this._topLevelDivRef,className:"od-AddPeople-Edit"},h.createElement("div",{className:"od-AddPeople-Edit-Header"},this._renderHeader()),h.createElement("div",{className:"od-AddPeople-Edit-Section"},this.userRequiresAccessApproval()&&this._renderRequestAccessAlert(),this._renderPeoplePicker(),!1,this._renderMessageArea(),this._renderNotificationSelector(),this._renderAddButton()))};t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)};t.prototype.isAddButtonEnabled=function(){return this.state.people.length>0&&null===this.state.peoplePickerError&&!1===this.state.shareMessageError};t.prototype.userRequiresAccessApproval=function(){return this.props.sharingInformation.requiresAccessApproval};t.prototype.numberSelectedUnverifiedExternals=function(){return this.state.people.filter(function(e){return Object(pe.i)(e)}).length};t.prototype._getRoleSelectorProps=function(e){return{compact:e,menuPermissionOptions:Object(ce.e)({sharingInformation:this.props.sharingInformation}),sharingRole:this.state.roleSelection,mode:o.e.addPeople,clientId:this.props.clientId,ariaLabel:b.b,showStopSharing:!1,onRoleChange:this._onRoleSelectorChange}};t.prototype._renderPeoplePicker=function(){var e=this.state.people,t=pe.n(e),n=pe.r(e,0);return h.createElement("div",{className:"od-Share-PeoplePicker"},h.createElement(de.e,{defaultSelectedItems:this.state.people,error:this.state.peoplePickerError,onChange:this._onPeoplePickerChange,oversharingExternalsWarning:t,oversharingGroupsWarning:n,pickerSettings:this.props.sharingInformation.peoplePickerSettings,sharingLinkKind:1,sharingInformation:this.props.sharingInformation,clientId:this.props.clientId,allowSPGroups:!0,disableGraph:this.context.sharingStore.shouldDisableGraphForPeopleSearch(),onResolvedSuggestions:null,onInputChange:this._onPeoplePickerInputChange,roleSelectorProps:this._getRoleSelectorProps(!0),renderRoleSelector:!0}))};t.prototype._renderHeader=function(){return h.createElement(S.e,Object(r.__assign)({},Object(E.e)(this.props),{item:this.props.sharingInformation.item,hideShareDialogOverflowButton:!this.props.onManageExistingAccessClick,onManageExistingAccessClick:this.props.onManageExistingAccessClick,viewState:10}))};t.prototype._renderMessageArea=function(){if(this.state.notifyRecipients)return h.createElement(z.e,{borderless:!0,className:"od-AddPeople-Message",disabled:!this.state.notifyRecipients,placeholder:b.xn,ariaLabel:b.Sn,multiline:!0,resizable:!1,onGetErrorMessage:this._validateMessage,styles:{field:{fontSize:".875rem",lineHeight:" 1.0625rem",selectors:{"::placeholder":{fontSize:".875rem"}},borderColor:"transparent",border:"none"}}})};t.prototype._renderNotificationSelector=function(){var e=this.numberSelectedUnverifiedExternals()>0;return h.createElement(A.e,{className:"od-AddPeople-NotificationSelector",disabled:e,label:b.ir,onChange:this._onAllowEditChange,checked:this.state.notifyRecipients,styles:{text:{fontSize:"0.875rem",lineHeight:"1.25rem"},checkbox:{width:"1.25rem",height:"1.25rem"},checkmark:{fontSize:"0.875rem"}}})};t.prototype._renderAddButton=function(){var e=b.m;return h.createElement(g.e,{disabled:!this.isAddButtonEnabled(),onClick:this._onAddButtonClick,className:"od-AddPeople-AddButton"},e)};t.prototype._renderRequestAccessAlert=function(){return h.createElement(dt.e,{className:"od-AddPeople-Edit-Section-PermissionAlert"},b.cs)};t.contextTypes={sharingStore:i.object.isRequired,resize:i.func.isRequired};return t})(h.Component),Xt=n(1917);(function(e){e[e.edit=0]="edit";e[e.successGrantingPermissions=1]="successGrantingPermissions";e[e.successRequestingPermissions=2]="successRequestingPermissions";e[e.failure=3]="failure";e[e.notAllowed=4]="notAllowed"})(Ut||(Ut={}));var Vt=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this;i._topLevelDivRef=h.createRef();i._onLoading=function(e){i.setState(function(t,n){if(t.view===Ut.edit){var i=void 0;i=e.requestedAccess?b.v:e.notifiedRecipients?b.h:b.c;return Object(r.__assign)(Object(r.__assign)({},t),{loading:!0,message:i})}return t})};i._onSuccess=function(e){var t,n;if(e.requestedAccess){t=b.a;n=Ut.successRequestingPermissions}else{t=e.notifiedRecipients?b.E:b.w;n=Ut.successGrantingPermissions}i.setState({view:n,message:t,loading:!1});i._store.getEngagementHelper().log(Xt.t.Completed,{accessRequested:e.requestedAccess});_e.e(!0,t)};i._onFailure=function(e){var t=b.g;i.setState({view:Ut.failure,message:t,loading:!1});_e.e(!1,t)};i._store=n.sharingStore;i._shareClickTime=n.shareClickTime;i._resize=n.resize;i._dismiss=n.onDismiss;var s=!1===t.sharingInformation.canAddExternalPrincipal&&!1===t.sharingInformation.canAddInternalPrincipal&&!1===t.sharingInformation.canRequestAccessForGrantAccess;i.state={message:"",view:s?Ut.notAllowed:Ut.edit,loading:!1};i._resizeTracker=new oe.e(n.resize);return i}t.prototype.componentDidMount=function(){_e.l(this._shareClickTime,this.props.clientId,o.e.addPeople,this.props.scenarioId,this.props.correlationId);this._resizeIfNeeded()};t.prototype.componentDidUpdate=function(e,t){this._resizeIfNeeded()};t.prototype.render=function(){return h.createElement("div",{ref:this._topLevelDivRef,className:"od-AddPeople "+(this.state.loading?" blocker":"")+" "+(Ae.m()?"wide":"")},this.renderView(),this.state.loading?h.createElement(c.e,{message:this.state.message}):null)};t.prototype.renderView=function(){switch(this.state.view){case Ut.edit:return h.createElement(Wt,Object(r.__assign)({},Object(E.e)(this.props),{sharingInformation:this.props.sharingInformation,onLoading:this._onLoading,onSuccess:this._onSuccess,onFailure:this._onFailure,currentSettings:this.props.currentSettings,onViewPolicyTipClicked:this.props.onViewPolicyTipClicked,onManageExistingAccessClick:this.props.onManageExistingAccessClick}));case Ut.successGrantingPermissions:return this._renderSuccessGranting();case Ut.successRequestingPermissions:return this._renderSuccessRequesting();case Ut.failure:return this._renderFailure();case Ut.notAllowed:return this._renderNotAllowed()}};t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)};t.prototype._renderSuccessGranting=function(){return h.createElement("div",{className:"od-AddPeople-Success"},h.createElement(S.e,Object(r.__assign)({},Object(E.e)(this.props),{viewState:9,onManageExistingAccessClick:this.props.onManageExistingAccessClick})),h.createElement(Y.e,{className:"od-ShareNotification-icon",iconName:"CheckMark"}),h.createElement("p",{className:"od-AddPeople-SuccessMessage",role:"presentation"},this.state.message),h.createElement("input",{autoFocus:!0,className:"od-Share-screenReaderOnly",role:"alert","aria-live":"assertive","aria-label":this.state.message,value:this.state.message}))};t.prototype._renderSuccessRequesting=function(){return h.createElement("div",{className:"od-AddPeople-Success"},h.createElement(S.e,Object(r.__assign)({},Object(E.e)(this.props),{viewState:9,onManageExistingAccessClick:this.props.onManageExistingAccessClick})),h.createElement(Y.e,{className:"od-ShareNotification-icon",iconName:"PeopleAlert"}),h.createElement("p",{className:"od-AddPeople-SuccessMessage",role:"presentation"},this.state.message),h.createElement("input",{autoFocus:!0,className:"od-Share-screenReaderOnly",role:"alert","aria-live":"assertive","aria-label":this.state.message,value:this.state.message}))};t.prototype._renderFailure=function(){return h.createElement("div",{className:"od-AddPeople-Failure"},h.createElement(S.e,Object(r.__assign)({},Object(E.e)(this.props),{viewState:9,onManageExistingAccessClick:this.props.onManageExistingAccessClick})),h.createElement("p",null,this.state.message))};t.prototype._renderNotAllowed=function(){var e=this;return h.createElement(h.Fragment,null,h.createElement(S.e,Object(r.__assign)({},Object(E.e)(this.props),{hideShareDialogOverflowButton:!0,title:b.Mn,onManageExistingAccessClick:this.props.onManageExistingAccessClick})),h.createElement("div",{className:"od-AddPeople-NotAllowed"},h.createElement("p",null,b._n),h.createElement("p",null,b.Dn),h.createElement(g.e,{autoFocus:!0,onClick:function(){e._dismiss()}},b.pr)))};t.contextTypes={sharingStore:i.object.isRequired,shareClickTime:i.number,resize:i.func.isRequired,onDismiss:i.func.isRequired};return t})(h.Component),$t=n(2538),Jt=n(2219);Object(s.n)([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast: active){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#1aebff}}@media screen and (-ms-high-contrast: black-on-white){.Share-pdfIcon,.Share-wordIcon,.Share-excelIcon,.Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: active){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#37006e}}@media screen and (-ms-high-contrast: black-on-white){.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-wordIcon,.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon{color:#1aebff}}.od-Share-error{padding:16px;font-size:.875rem;font-weight:400;word-break:break-word;outline:transparent;position:relative;margin-bottom:30px}.od-Share-error::-moz-focus-inner{border:0}.ms-Fabric--isFocusVisible .od-Share-error:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-Fabric--isFocusVisible .od-Share-error:focus:after{border-color:ActiveBorder}}[dir='ltr'] .od-Share-error-details{float:left}[dir='rtl'] .od-Share-error-details{float:right}.od-Share-error-copy{margin-top:10px}[dir='ltr'] .od-Share-error-copy{float:right}[dir='rtl'] .od-Share-error-copy{float:left}.od-Share-error-clear{clear:both;display:block}.od-Share-error-message{min-height:3.125rem}[dir='ltr'] .od-Share-error-report{float:right}[dir='rtl'] .od-Share-error-report{float:left}[dir='ltr'] .od-Share-error-report{margin-right:5px}[dir='rtl'] .od-Share-error-report{margin-left:5px}.od-Share-error-chevron{font-size:.625rem}[dir='ltr'] .od-Share-error-chevron{margin-left:5px}[dir='rtl'] .od-Share-error-chevron{margin-right:5px}.od-Share-error-technical{border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";padding:0 10px 10px 10px;margin-bottom:10px}[dir='rtl'] .od-Share-error-technical{padding:0 10px 10px 10px}.od-Share-error-technical button.od-Share-error-copy{font-size:.875rem;padding:0 1rem;border-radius:.125rem;min-width:5rem;height:2rem}\n"}]);var Kt=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._errorMessage=Object(h.createRef)();r._onToggleDetailsClicked=function(){r.setState({areDetailsVisible:!r.state.areDetailsVisible})};r._onCopyToClipboardClicked=function(){Object(Jt.e)(r.props.sharingInformation.debugErrorMessage||"")};r._resize=n.resize;r.state={areDetailsVisible:!1};return r}t.prototype.componentDidUpdate=function(e,t){this._errorMessage.current&&this._errorMessage.current.focus();this._resize()};t.prototype.render=function(){var e=this.state.areDetailsVisible&&this.props.sharingInformation.debugErrorMessage?h.createElement("div",{className:"od-Share-error-technical"},h.createElement("h4",null," ",b.st," "),h.createElement("div",null,this.props.sharingInformation.debugErrorMessage),h.createElement($t.e,{className:"od-Share-error-copy",onClick:this._onCopyToClipboardClicked},b.tt),h.createElement("span",{className:"od-Share-error-clear"})):null,t=this.props.showReportProblem?h.createElement("div",{className:"od-Share-error-report"},b.rt):null,n=this.props.sharingInformation.debugErrorMessage?h.createElement("div",{className:"od-Share-error-details",onClick:this._onToggleDetailsClicked},this.state.areDetailsVisible?b.nt:b.it,h.createElement(Y.e,{iconName:this.state.areDetailsVisible?"ChevronUp":"ChevronDown",className:"od-Share-error-chevron"})):null;return this.props.sharingInformation.isStubFile?h.createElement("div",{className:"od-Share-error",role:"alert",tabIndex:0,ref:this._errorMessage},h.createElement("h2",null," ",b.zs),h.createElement("div",{className:"od-Share-error-message"},h.createElement("p",null,b.wo))):h.createElement("div",{className:"od-Share-error",role:"alert",tabIndex:0,ref:this._errorMessage},h.createElement("h2",null," ",b.ot," "),h.createElement("div",{className:"od-Share-error-message"},h.createElement("p",null," ",this.props.sharingInformation.errorMessage," "),this.props.sharingInformation.fixItUrl&&h.createElement("a",{href:this.props.sharingInformation.fixItUrl,target:"_blank"},b._t),e),h.createElement("div",null,n,t))};t.contextTypes={resize:i.func.isRequired};return t})(h.Component),Qt=n(2256),Gt=n(125),Yt=n(2105),Zt=n(48),en=n(358),tn=n(152),nn=n(429),rn=n(101),sn=(function(){function e(){this.computeRenderTime=function(e,t){return e&&t&&t.startTime&&t.endTime?t.endTime-t.startTime:0};this.checkRenderTimeRequiredDataAvailable=function(e,t){return!(!e||!t)&&(!!t.startTime&&!!t.endTime)};this._rumone=en.r.getRUMOneLogger("sharedialog")}e.prototype.logSharingPerformance=function(e,t){var n=this;if(this._rumone&&this._rumone.isRunning()){var i=this.breakdownData;this._rumone.writeScenarioId("ShareDialog."+e.modeName);this._rumone.addExpectedControl("ShareControl");this._rumone.writePageTransitionType(t||tn.e.fullPageLoad);this._rumone.collectW3CPerfTimings();this._rumone.collectW3cResourceTimings();var s=location.href.toLowerCase().indexOf("sharedialog.aspx")>=0;s&&this._rumone.collectSPClientFlights(window._spPageContextInfo);this._rumone.setSettings({TTISettings:{TTIPolyfillSettings:{enabled:!0,calculateTTI:function(t,r,i){var s=n._regulateTime(t)-n._regulateTime(e.startTime);n._rumone.addEUPLBreakdown("ttiAbsoluteTime_"+i,{data:t,needFlatten:!1});n._rumone.addEUPLBreakdown("transactionStartTime_"+i,{data:e.startTime,needFlatten:!1});n._rumone.addEUPLBreakdown(i,{data:s,needFlatten:!1});return s},options:Object(r.__assign)({useMutationObserver:!1,trackNetworkRequests:!1},{requiredMainThreadQuietnessDurationInMilliseconds:1e3,requiredNetworkQuietnessDurationInMilliseconds:1e3})}}});var o=new nn.e("ShareControl",e.startTime,e.endTime,this.computeRenderTime,this.checkRenderTimeRequiredDataAvailable);this._rumone.writeControlPerformanceData(o);var u=e.breakDownData,a=this._getResponseEnd();u=Object(r.__assign)(Object(r.__assign)({},u),{herf:i(location.href),parentHref:i(window.parent.location.href),parentManifest:i(window.parent._spModuleLink&&window.parent._spModuleLink.manifestName||""),parentBuild:i(window.parent._spModuleLink&&window.parent._spModuleLink.buildNumber||""),isShareDialogASPXHosted:i(s),w3cResponseEnd:i(a-performance.timing.navigationStart),appStart:i(this._regulateTime(this._rumone.getMarkerTime("EUPL.AppStart"))-this._regulateTime(a)),render:i(this._regulateTime(e.endTime)-this._regulateTime(this._rumone.getMarkerTime("EUPL.AppStart")))});this._rumone.writeEUPLBreakdown(JSON.stringify(u))}};e.prototype.resetRumOne=function(){if(!this._rumone.isRunning()){this._rumone.resetLogger();return!0}return!1};e.prototype.breakdownData=function(e){return{data:e,needFlatten:!0}};e.prototype._isDateTime=function(e){var t=new Date;return e>new Date(t.setDate(t.getDate()-1)).getTime()};e.prototype._regulateTime=function(e){return this._isDateTime(e)&&rn.e?e-performance.timing.navigationStart:e};e.prototype._getResponseEnd=function(){return performance&&performance.timing?window.g_responseEnd&&(performance.timing.responseEnd&&Number(window.g_responseEnd)<performance.timing.responseEnd||!performance.timing.responseEnd)?Number(window.g_responseEnd):performance.timing.responseEnd:NaN};return e})(),on=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,t)||this;i._viewStates=[];i._shareMainControl=Object(h.createRef)();i._topLevelDivRef=h.createRef();i._copyLinkOnCancelClicked=function(){i._returnToPreviousView()};i._copyLinkOnApplyClicked=function(e){i.setState({currentSettings:e,linkRecipients:e.specificPeople},function(){i._store.getEngagementHelper().linkSettingsApplyClicked(i._engagementExtraData);i._onCopyLinkClicked(!0)})};i._closeButtonOnBlur=function(){i.setState({isCloseButtonOnFocus:!1})};i._closeButtonOnFocus=function(){i.setState({isCloseButtonOnFocus:!0})};i.onRoleChange=function(e){var t=Object(Z.k)(e),n=e===l.e.view,s=e===l.e.review,o=e==l.e.manageList;if(!(t||n||s||o))throw new Error("Role not implemented: "+l.e[e]);var u=i.state.currentSettings,a=s||o?6:Object(Z.y)(u.audience,t);u.sharingRole!==e&&i._store.getEngagementHelper().log("SharingRoleChanged",{isEdit:t,isReview:s});i.setState(Object(r.__assign)(Object(r.__assign)({},i.state),{currentSettings:Object(r.__assign)(Object(r.__assign)({},u),{sharingRole:e,isEdit:t,isReview:s,sharingLinkKind:a})}))};i._onShareTargetClicked=function(e){if(Ae.l()){if(e===u.e.share)return;if(e===u.e.copy){_e.t();i._onCopyLinkClicked();return}i.setState({shareType:e,shareTargetClicked:!0},function(){i._store.shareLink({settings:i.state.currentSettings,recipients:i.state.linkRecipients,copyLinkCommand:!1,shareType:e})})}else if(e===u.e.copy){_e.t();i._onCopyLinkClicked()}else e===u.e.outlook?i._onOutlookClicked():e===u.e.nonOutlook?i._onNonOutlookClicked():e===u.e.teams?i._onTeamsClicked():e===u.e.moreApps&&i._onMoreAppsClicked()};i._onLinkPermissionsApplyClicked=function(e){i._store.getEngagementHelper().linkSettingsApplyClicked(i._engagementExtraData);i._onSelectedPermissionsChange(e);i.props.mode===o.e.linkSettings&&i.setState({shareType:u.e.share,applyLinkSettingsClicked:!0},function(){var e=i.state.linkRecipients;if(C.c(i.props.clientId)){var t=i.state.currentSettings.sharingLinkKind;3!==t&&2!==t||(e=e.filter(function(e){return!e.isExternal}))}i._store.shareLink({settings:i.state.currentSettings,recipients:e,copyLinkCommand:!1})})};i._onLinkPermissionsCancelClicked=function(){i.props.mode===o.e.linkSettings&&_e.n();i._returnToPreviousView()};i._returnToPreviousView=function(){if(i._viewStates&&i._viewStates.length){i.setState({viewState:i._viewStates.pop()});2===i.state.viewState&&i._store.getEngagementHelper().linkSettingsCancelClicked(i._engagementExtraData)}};i._hideElementsInManageAccess=function(e){i.props.hideElementsInManageAccess&&i.props.hideElementsInManageAccess(e)};i._onSelectedPeopleChange=function(e){var t=i.state.permissionsMap;i.state.currentSettings.audience===f.e.existing&&i._store.checkPermissions(e);i._store.resetPeoplePickerError();i.setState({linkRecipients:e,permissionsMap:t},function(){i._store.fetchGroupsMemberCount(e)})};i._onSendLinkClicked=function(e,t){var n=i.state.linkRecipients;i.setState({shareType:u.e.share,recipientsCount:n.length,externalRecipientsCount:pe.e(n),linkedinRecipientsCount:pe.t(n),hasMessage:!!e,hasSubject:!!t,messageLength:e?e.length:0,shareTargetClicked:!0},function(){_e.p();i._store.shareLink({settings:i.state.currentSettings,recipients:n,emailMessage:e,emailSubject:t})})};i._onViewPolicyTipClicked=function(){i._viewStates.push(i.state.viewState);i.setState({viewState:6})};i._onSendLinkMessageChange=function(e){i.setState({messageText:e})};i._onSendLinkSubjectChange=function(e){i.setState({subjectText:e})};i._onInterruptUseNew=function(){i._store.getEngagementHelper().copyLinkInterruptEditLinkChosen(i._engagementExtraData);i.setState({shareType:u.e.copy,shareTargetClicked:!0,showCopyLinkInterrupt:!1},function(){i._store.shareLink({settings:i.state.currentSettings,recipients:i.state.linkRecipients,copyLinkCommand:!1})})};i._onInterruptUseExisting=function(){i._store.getEngagementHelper().copyLinkInterruptExistingLinkChosen(i._engagementExtraData);i.setState({shareType:u.e.copy,shareTargetClicked:!0,showCopyLinkInterrupt:!1},function(){i._store.shareLink({settings:i.state.currentSettings,recipients:i.state.linkRecipients,copyLinkCommand:!0})})};i._onInterruptCancel=function(){i._store.getEngagementHelper().copyLinkInterruptCancelled(i._engagementExtraData);i.setState({showCopyLinkInterrupt:!1});i._shareMainControl.current.shouldShowActivityIndicator(!1)};i._showModifyPermissions=function(e){i._viewStates.push(i.state.viewState);i.setState({viewState:2},function(){i._store.getEngagementHelper().linkSettingsOpened(i._engagementExtraData)})};i._showPermissionsList=function(){i._viewStates.push(i.state.viewState);i._store.getEngagementHelper().manageAccessOpened(i._engagementExtraData);var e=i.props,t=e.invokeManageAccess,n=e.onManageAccessClicked,r=n&&!t;t?_e.s():r?n():i.setState({viewState:3,showHeaderInManagedAccess:!0})};i._dismiss=n.onDismiss;i._resize=n.resize;i._store=n.sharingStore;i._shareClickTime=n.shareClickTime;i._isPeopleSharingLinksEnabled=!1;i._rumoneLogger=new sn;var s=_e.o(),a=t.theme;a||(a=_e.r());(a&&i.props.clientId!==Ie.e.wac||s)&&i._loadTheme(s?Object(Z.f)():a);i._sizeConstraints={maxHeight:C.s(i.props.clientId)?"none":i.props.maxHeight||"none",maxWidth:i.props.maxWidth||"none"};var c={companyName:null,currentSettings:null,sharingInformation:null,sharingLinkCreated:null,viewState:0,readyToCopy:!1,shareType:u.e.share,groupsMemberCount:0,policyTipInformation:null,linkRecipients:[],shareTargetClicked:!1,applyLinkSettingsClicked:!1,showActivityIndicator:!1,permissionsMap:{},messageText:t.messageText||"",subjectText:t.subjectText||"",isLoadingDefaultRecipients:i._store.isValidatingDefaultRecipients(),isCloseButtonOnFocus:!1,showCopyLinkInterrupt:!1};c.viewState=t.mode===o.e.share?1:14;i.state=c;i._baseProps=Object(E.e)(t);i._correlationId=i.props.correlationId||Gt.e.generate();i._baseProps.correlationId=i._correlationId;i._engagementExtraData={clientId:t.clientId,scenarioId:t.scenarioId,correlationId:i._correlationId,hostSessionId:t.hostSessionId||"",mode:t.mode||(t.copyLinkShortcut?o.e.copy:o.e.share)};i._resizeTracker=new oe.e(n.resize);return i}t.prototype.componentDidMount=function(){var e=this;try{this._store.getEngagementHelper().log(Xt.t.Opening,this._engagementExtraData);this._copyLinkCustomerPromise=new Yt.e({scenario:"CopyLink",extraData:{clientId:this.props.clientId}});var t=this._store;new Rt.t(this).on(window,"keydown",function(t){t&&t.keyCode===L.e.escape&&e._handleEscKeyPress(t)});t.addListener(function(n){try{if(7===e.state.viewState)return;if(e.props.mode===o.e.copy&&n&&n.type===zt.t.UnshareLink)return;var i=t.getSharingInformation(),s=t.getSharingLinkCreated(),a=t.getCompanyName(),f=t.getGroupsMemberCount(),l=t.getPolicyTipInformation(),c=t.getPermissionsMap(),h=t.getDefaultRecipients();e._outlookAvailability=t.getOutlookAvailability();e._isPeopleSharingLinksEnabled=t.isPeopleSharingLinksEnabled();if(!i)return;i.webTemplateId&&(e._engagementExtraData.webTemplateId=i.webTemplateId);i.itemUniqueId&&(e._engagementExtraData.itemUniqueId=i.itemUniqueId);if(i.isStubFile){e._store.getEngagementHelper().shareErrorFileIsUploading(e._engagementExtraData);t.fetchSharingInformation(!0,!0)}var p=e._store.getItemInformationForLogging(),d=p.itemType,v=p.extension;e._engagementExtraData.itemType=d;e._engagementExtraData.extension=v;e._sanitizeSharingContextInfo(i);var m=e._getSettings(i),g=Object(r.__assign)({},e.state);if(1===e.state.viewState||14===e.state.viewState){g.viewState=e._getInitialViewState(i,m,s);1!==g.viewState&&14!==g.viewState&&_e.m()}if(i&&(i.error||i.isStubFile)){_e.f(e._shareClickTime,e.props.clientId,e.props.mode,e.props.scenarioId,i,e._correlationId);g.viewState=7;g.sharingInformation=i}else if(s&&(e.state.shareTargetClicked||e.props.copyLinkShortcut||e.state.applyLinkSettingsClicked)){e._modifiedSharingLinkUrl=e._getModifiedSharingLinkUrl(s,m,i);var y=e.state.shareType,b=e.state.currentSettings,w=b?b.isEdit:m.isEdit,E=b?b.isReview:m.isReview,S=b?b.preventDownload:m.preventDownload,x=b?b.audience:m.audience,T=ce.o(x,i.sharingAbilities,i.fileExtension),N=ce.u(x,i.sharingAbilities,i.fileExtension),k=Object(r.__assign)(Object(r.__assign)({},e._engagementExtraData),{shareType:y,audience:s.audience,isEdit:w,isReview:N&&E,recipientsCount:e.state.recipientsCount,externalRecipientsCount:e.state.externalRecipientsCount,linkedinRecipientsCount:e.state.linkedinRecipientsCount,hasMessage:e.state.hasMessage,hasSubject:e.state.hasSubject,messageLength:e.state.messageLength,daysUntilExpiry:e._getNumberOfDaysUntilExpiry(s),isDefaultLink:i.defaultSharingLink.sharingLinkKind===s.sharingLinkKind,linkBlocksDownload:!!S,linkWithOfficeReviewMode:T&&E,groupRecipientCount:e.state.linkRecipients.filter(function(e){return 2===e.entityType&&null==e.familySharingTargetType}).length});if(we.e.isFeatureEnabled({ODC:"FamilySharing"})&&C.g(e.props.clientId)){k.sharedToFamilyGroup=e.state.linkRecipients.some(function(e){return e.familySharingTargetType===Qt.e.Family});k.sharedToFamilyMember=e.state.linkRecipients.some(function(e){return e.familySharingTargetType===Qt.e.FamilyMember})}e._store.getEngagementHelper().shareCompleted(k);var L=Object(Z.T)(s.sharingLinkKind);_e.d(e.state.shareType,L);if(y===u.e.outlook||y===u.e.nonOutlook)if(C.m(e.props.clientId)){e._store.navigateToOwa(e._getRecipientEmails(e.state.linkRecipients),e._modifiedSharingLinkUrl);_e.a();e._dismiss()}else try{window.external.SendViaOutlookWithContext(e._getRecipientEmails(e.state.linkRecipients),e.state.linkRecipients.length,e.state.messageText,e._modifiedSharingLinkUrl)}catch(e){}else if(y===u.e.teams){e._dismiss();_e.v(s,e._getRecipientEmails(e.state.linkRecipients),e.state.messageText)}else if(y===u.e.moreApps)try{g=Object(r.__assign)(Object(r.__assign)({},g),{viewState:4,companyName:a,sharingLinkCreated:s,showActivityIndicator:!1});window.external.SendLinkViaMoreApps(s.url)}catch(e){}else e.props.mode===o.e.linkSettings?_e.u(s,a,e.props.customLabeledAudienceConfig,e.props.clientId):g=Object(r.__assign)(Object(r.__assign)({},g),{viewState:4,sharingLinkCreated:s,companyName:a,showActivityIndicator:!1,sharingInformation:i,currentSettings:e._getSettings(i)})}else{if(e.props.copyLinkShortcut&&i&&!e.props.shareId&&!i.error&&!e._copyLinkShortcutInvoked){e._copyLinkShortcutInvoked=!0;e._onCopyLinkClicked(!0,m)}g=Object(r.__assign)(Object(r.__assign)({},g),{sharingInformation:i,companyName:a,groupsMemberCount:f,currentSettings:m,policyTipInformation:l,isLoadingDefaultRecipients:t.isValidatingDefaultRecipients(),showActivityIndicator:!1,permissionsMap:c});if(h&&!h.isConsumed){g.linkRecipients=h.recipients;e._store.consumeDefaultRecipients()}}if(!e._isOpenEventLogged){e._store.getEngagementHelper().log(Xt.t.Opened,e._engagementExtraData);e._isOpenEventLogged=!0}e.setState(g)}catch(t){e._setGenericErrorState(t)}});var n=!Ae.o()||this.props.copyLinkShortcut||this.props.mode===o.e.linkSettings||this.props.mode===o.e.manageAccess||this.props.mode===o.e.notify,i=this.props.mode===o.e.manageAccess;t.fetchSuiteNavInformation();t.fetchSharingInformation(n,i);t.fetchPolicyTipInformation();if(this.props.useVroomCreateDefaultLink&&!this._copyLinkShortcutInvoked&&this.props.mode===o.e.copy&&!this.props.shareId&&C.c(this.props.clientId)){this._copyLinkShortcutInvoked=!0;this._store.shareLink({settings:this.state.currentSettings,recipients:this.state.linkRecipients,copyLinkCommand:!0});this.setState({shareType:u.e.copy,shareTargetClicked:!0})}this._resizeIfNeeded();if(this.state.sharingInformation&&(0===this.state.viewState||4===this.state.viewState)){var s=this.props.mode,a=this.state.viewState;setTimeout(function(){e._writeShareDataToRumoneLogger({mode:s,viewState:a})},0)}}catch(e){this._setGenericErrorState(e)}};t.prototype._getInitialViewState=function(e,t,n){switch(this.props.mode){case o.e.share:if(e&&t)return 0;break;case o.e.atMention:if(e&&t)return 13;break;case o.e.linkSettings:if(t)return 8;break;case o.e.manageAccess:if(t)return 3;break;case o.e.copy:if(e&&t&&n)return 4;break;case o.e.notify:if(e)return 9;break;case o.e.addPeople:if(e)return 10;break;default:throw new Error("Mode not implemented: "+this.props.mode)}return this.props.mode===o.e.share?1:14};t.prototype.componentDidUpdate=function(){var e=this;this._resizeIfNeeded();if(this.state.sharingInformation)if(this.props.mode===o.e.share)if(0!==this.state.viewState||this.state.shareTargetClicked){if(4===this.state.viewState){var t=this.props.mode,n=this.state.viewState;setTimeout(function(){e._writeCopyLinkTargetDataToRumoneLogger({mode:t,viewState:n,clickTime:e._copyTargetClickTime})})}}else{var r=this.props.mode,i=this.state.viewState;setTimeout(function(){e._writeShareDataToRumoneLogger({mode:r,viewState:i})},0)}else if(this.props.mode===o.e.copy&&4===this.state.viewState){var s=this.props.mode,u=this.state.viewState;setTimeout(function(){e._writeShareDataToRumoneLogger({mode:s,viewState:u})},0)}};t.prototype.componentDidCatch=function(e,t){this._setGenericErrorState(e)};t.prototype.render=function(){var e,t,n,i=this.props,s=(i.clientId,i.copyLinkShortcut),o=this.state,a=o.sharingInformation,l=o.currentSettings,c=o.showActivityIndicator,p=o.sharingLinkCreated,d="od-Share",v=!1;if(a&&l&&s&&p&&7!==this.state.viewState){v=!0;t=this._renderPostCopyShortcutView()}else switch(this.state.viewState){case 7:t=this._renderError(a);!1===this.state.shareTargetClicked?this._copyLinkCustomerPromise.end({resultType:Zt.e.Failure,errorCode:null!==a.error?null===(e=a.error)||void 0===e?void 0:e.toString():"RenderSharingDialogFailure"}):this.state.shareType===u.e.copy&&this._copyLinkCustomerPromise.end({resultType:Zt.e.Failure,errorCode:null!==a.error?a.error.toString():"ClientCopyLinkFailure"});break;case 0:d+=c?" od-Share--hasActivity":"";v=!0;t=this._renderShareMain(this.state.sharingInformation,this.state.currentSettings);break;case 2:t=h.createElement(h.Fragment,null,this._renderModifyPermissions(2),this._renderActivityIndicator());break;case 4:t=this._renderNotification();this.state.shareType===u.e.copy&&this._copyLinkCustomerPromise.end({resultType:Zt.e.Success});break;case 3:v=!0;t=this._renderPermissionsList();break;case 6:t=h.createElement(h.Fragment,null,this._renderBackButtonForPolicyDetails(),this._renderPolicyDetails());break;case 13:d="";t=this._renderAtMention();break;case 8:d+=c?" od-Share--hasActivity":"";v=!0;t=h.createElement(h.Fragment,null,this._renderModifyPermissions(8));break;case 1:d+=" od-Share--hasShimmer";v=!0;t=this._renderShareMainShimmer();break;case 9:l.sharingLinkKind=1;l.audience=f.e.existing;this._engagementExtraData=Object(r.__assign)(Object(r.__assign)({},this._engagementExtraData),{appMap:a.item.appmap});d="";t=h.createElement(It,Object(r.__assign)({},this._baseProps,{currentSettings:l,sharingInformation:a,engagementExtraData:this._engagementExtraData,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig}));break;case 10:v=!0;t=this._renderAddPeople();break;case 14:t=h.createElement("div",{className:"od-Share-spinnerHolder"},h.createElement(Be.e,{className:"od-Share-spinner",label:b.Te,size:je.e.large,styles:{circle:{width:"1.75rem",height:"1.75rem",borderWidth:"0.09375rem"},label:{fontSize:"0.75rem"}}}))}n=v||d?h.createElement("div",{className:d,style:v?this._sizeConstraints:void 0},t):t;var m=C.c(this.props.clientId)?" teams":"";return h.createElement(Ot.e,null,h.createElement("div",{ref:this._topLevelDivRef,role:"presentation",className:m+" isFluent"},n))};t.prototype._renderAtMention=function(){var e=this.props.callbacks?this.props.callbacks.onAtMentionComplete:void 0;return h.createElement(Mt.e,Object(r.__assign)({},this._baseProps,{currentSettings:this.state.currentSettings,sharingInformation:this.state.sharingInformation,recipients:this.state.linkRecipients,onComplete:e}))};t.prototype._renderPostCopyShortcutView=function(){var e=this.state,t=e.sharingInformation,n=e.currentSettings,i=e.companyName,s=e.sharingLinkCreated,o=e.viewState,u=e.groupsMemberCount;return h.createElement(Fe,Object(r.__assign)({},this._baseProps,{mode:this.props.mode,shareId:this.props.shareId,companyName:i,currentSettings:n,item:t.item,onLinkPermissionsApplyClicked:this._copyLinkOnApplyClicked,onLinkPermissionsCancelClicked:this._copyLinkOnCancelClicked,onSelectedPeopleChange:this._onSelectedPeopleChange,onShareHintClicked:this._getNotificationHintClickHandler(s.createdViaCopyLinkCommand),sharingInformation:t,showExistingAccessOption:this.props.showExistingAccessOption,viewState:o,groupsMemberCount:u,onViewPolicyTipClicked:this._onViewPolicyTipClicked,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,displayUrl:this._modifiedSharingLinkUrl,engagementExtraData:this._engagementExtraData,recipients:this.state.linkRecipients,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience}))};t.prototype._renderError=function(e){return h.createElement(h.Fragment,null,h.createElement(S.e,Object(r.__assign)({},this._baseProps,{viewState:7})),h.createElement(Kt,{sharingInformation:e,showReportProblem:this._store.isReportProblemSupported()}))};t.prototype._getSettings=function(e){var t=this,n=this.state.currentSettings,r=e&&e.error,i=e.sharingLinks&&e.sharingLinks.length&&this.props.shareId,s=ce.i(e.sharingAbilities,e.sharingLinkTemplates),o=!1;if(!n&&!r){var u=e.defaultSharingLink;if(i){if(a=e.sharingLinks.filter(function(e){return e.shareId===t.props.shareId&&e.isActive})[0]){u=a;o=!0}}if(void 0!==s&&s.length>0){var a;if(a=s.filter(function(t){return t.sharingLinkKind===e.defaultSharingLink.sharingLinkKind})[0]){u=a;o=!0}else if(a=s.filter(function(t){return t.audience===e.defaultSharingLink.audience})[0]){u=a;o=!0}else{u=s[0];o=!0}}n=this._initializeCurrentSettings(u,e,this.props.copyLinkShortcut,o);if(s.length>0){n.shareId=u.shareId;n.fetchLinkOnly=!0;n.audience=u.audience;n.expiration=u.expiration;n.isEdit=u.isEdit;n.isReview=u.isReview;n.sharingRole=u.isEdit?Object(Z.c)(this.props.clientId,e):u.isReview?l.e.review:l.e.view;n.trackLinkUsers=u.trackLinkUsers;n.preventDownload=u.blockDownload;n.sharingLinkKind=u.sharingLinkKind;this._engagementExtraData.isRedeemedUserResharing=!0;this._engagementExtraData.redeemedLinksCount=s.length}}return n};t.prototype._getRecipientEmails=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n].email;i&&t.push(i)}return t};t.prototype._getNumberOfDaysUntilExpiry=function(e){var t=e.expiration&&new Date(e.expiration),n=new Date;if(t){var r=(t.getTime()-n.getTime())/864e5;return Math.floor(r)}};t.prototype._handleEscKeyPress=function(e){this._viewStates.length>0?this._returnToPreviousView():this._dismiss();e.stopPropagation()};t.prototype._initializeCurrentSettings=function(e,t,n,r){if(we.e.isFeatureEnabled({ODC:"ODCRequestAccess"})&&this._store.isConsumer())return this._store.getInitialLinkSettings(e);if(t.requiresAccessApproval&&n)return{allowEditing:!0,audience:f.e.existing,expiration:null,isEdit:!0,sharingRole:Object(Z.c)(this.props.clientId,t),sharingLinkKind:1,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:"",trackLinkUsers:!1};if(t.defaultSharingLink===e&&t.sharingAbilities)return this._initializeCurrentSettingsWithSharingAbilities(e,t,n);if(e.audience===f.e.specificPeople)if(!t.canManagePermissions||t.blockPeoplePickerAndSharing)e.audience=f.e.existing;else if(this._isPeopleSharingLinksEnabled)return{allowEditing:!0,audience:f.e.specificPeopleFlex,expiration:null,isEdit:!0,sharingRole:Object(Z.c)(this.props.clientId,t),sharingLinkKind:6,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:"",trackLinkUsers:!1};if(e.audience===f.e.specificPeopleFlex&&n&&!r){e.audience=f.e.existing;e.sharingLinkKind=1}var i=e.sharingLinkKind,s=5===i||3===i||1===i||6===i,o=e.isEdit&&2===t.defaultShareLinkPermission,u=[];this.props.shareId&&e.principals&&(u=Object(Z.w)(e));return{allowEditing:s,audience:this.props.preferCustomLabeledAudience&&e.audience===f.e.specificPeopleFlex?f.e.customLabeledSpecificPeople:e.audience,expiration:e.expiration||null,isEdit:o,sharingRole:o?Object(Z.c)(this.props.clientId,t):l.e.view,sharingLinkKind:e.sharingLinkKind,specificPeople:u,updatePassword:!1,password:"",preventDownload:e.blockDownload,shareId:"",trackLinkUsers:t.anyoneLinkTrackUsers}};t.prototype._initializeCurrentSettingsWithSharingAbilities=function(e,t,n){var r,i,s,o,u=t.sharingAbilities,a="00000000-0000-0000-0000-000000000000"===this.props.shareId,c=a?1:t.defaultSharingLink.sharingLinkKind,h=Object(Z.C)(this.props.clientId,this.props.mode,this.props.customLabeledAudienceConfig)?f.e.customLabeledSpecificPeople:f.e.specificPeople;if(t.defaultShareLinkToExistingAccess){h=f.e.existing;c=1}else switch(c){case 5:case 4:h=f.e.anyone;break;case 3:case 2:h=f.e.organization;break;case 1:default:if(a||!t.canManagePermissions||t.blockPeoplePickerAndSharing)h=f.e.existing;else if(this._isPeopleSharingLinksEnabled){h!==f.e.customLabeledSpecificPeople&&(h=f.e.specificPeopleFlex);c=6}else h=f.e.existing}if(h===f.e.specificPeopleFlex&&n){h=f.e.existing;c=1}var p=null,d=ce.r(h,u).linkExpiration;(d?d.defaultExpirationInDays:null)>0&&(p=new Date((new Date).toDateString())).setDate(p.getDate()+d.defaultExpirationInDays);var v,m=ce.s(h,u),g=m&&2===t.defaultShareLinkPermission,y=g?Object(Z.c)(this.props.clientId,t):l.e.view;(v=7===t.defaultShareLinkPermission)&&(y=l.e.restrictedview);var b=(null===(i=null===(r=this.props)||void 0===r?void 0:r.hostOptions)||void 0===i?void 0:i.hiddenAudienceOptions)||[],w=(null===(o=null===(s=this.props)||void 0===s?void 0:s.hostOptions)||void 0===o?void 0:o.disabledAudienceOptions)||[];return{allowEditing:m,audience:h=-1===b.indexOf(h)&&-1===w.indexOf(h)?h:f.e.existing,expiration:p,isEdit:g,sharingRole:y,isReview:!1,preventDownload:v,sharingLinkKind:h===f.e.existing?1:c,specificPeople:[],updatePassword:!1,password:"",shareId:"",trackLinkUsers:t.anyoneLinkTrackUsers}};t.prototype._loadTheme=function(e){try{var t=e;Object(K.D)(t)}catch(e){}};t.prototype._onCopyLinkClicked=function(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,i=this;return Object(r.__generator)(this,function(s){switch(s.label){case 0:n=Object(r.__assign)(Object(r.__assign)({sendInvitation:!1},t),this.state.currentSettings);this._copyTargetClickTime=Date.now();return[4,this._store.shouldInterruptCopyLink(n.isEdit)];case 1:if(s.sent()){this._store.getEngagementHelper().copyLinkInterruptOpened(this._engagementExtraData);this.setState({showCopyLinkInterrupt:!0})}else this.setState({shareType:u.e.copy,shareTargetClicked:!0},function(){i._store.shareLink({settings:n,recipients:i.state.linkRecipients,copyLinkCommand:e,shareType:u.e.copy})});return[2]}})})};t.prototype._onOutlookClicked=function(){var e=this;this.setState({shareType:u.e.outlook,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1,shareType:u.e.outlook})})};t.prototype._onNonOutlookClicked=function(){var e=this;this.setState({shareType:u.e.nonOutlook,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1,shareType:u.e.nonOutlook})})};t.prototype._onTeamsClicked=function(){var e=this;this.setState({shareType:u.e.teams,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1,shareType:u.e.teams})})};t.prototype._onMoreAppsClicked=function(){var e=this;this.setState({shareType:u.e.moreApps,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1,shareType:u.e.moreApps})})};t.prototype._onSelectedPermissionsChange=function(e){var t=this.state.permissionsMap;e.audience===f.e.existing?this._store.checkPermissions(this.state.linkRecipients):t={};var n=0;this.props.mode===o.e.linkSettings&&(n=this.state.viewState);this.setState({viewState:n,currentSettings:{allowEditing:e.allowEditing,trackLinkUsers:e.trackLinkUsers,audience:e.audience,expiration:e.expiration,isEdit:e.isEdit,isReview:e.isReview,sharingRole:e.sharingRole,sharingLinkKind:e.sharingLinkKind,specificPeople:e.specificPeople,updatePassword:e.updatePassword,password:e.password,hasPassword:e.hasPassword,preventDownload:e.preventDownload,shareId:e.shareId,fetchLinkOnly:e.fetchLinkOnly,requireSignIn:e.audience===f.e.specificPeople},permissionsMap:t})};t.prototype._renderBackButtonForPolicyDetails=function(){if(6===this.state.viewState)return it.t(h.createElement(ue.e,{className:"od-Share-backButton",onClick:this._returnToPreviousView,iconProps:{iconName:"Back"},ariaLabel:b.Z}),b.Z)};t.prototype._renderViews=function(){switch(this.state.viewState){case 2:return this._renderModifyPermissions(2);case 8:return this._renderModifyPermissions(8);case 4:return this._renderNotification();case 3:return this._renderPermissionsList();case 6:return this._renderPolicyDetails();default:return this._renderShareMain(this.state.sharingInformation,this.state.currentSettings)}};t.prototype._renderShareMain=function(e,t){return h.createElement("div",null,h.createElement(kt,Object(r.__assign)({},this._baseProps,{key:"share",ref:this._shareMainControl,companyName:this.state.companyName,currentSettings:t,item:e.item,onSelectedPeopleChange:this._onSelectedPeopleChange,onSendLinkClicked:this._onSendLinkClicked,onShareHintClicked:this._showModifyPermissions,onShowPermissionsListClicked:this._showPermissionsList,sharingInformation:e,groupsMemberCount:this.state.groupsMemberCount,onViewPolicyTipClicked:this._onViewPolicyTipClicked,linkRecipients:this.state.linkRecipients,permissionsMap:this.state.permissionsMap,messageText:this.state.messageText,subjectText:this.state.subjectText,onSendLinkMessageChange:this._onSendLinkMessageChange,onSendLinkSubjectChange:this._onSendLinkSubjectChange,onShareTargetClicked:this._onShareTargetClicked,hideShareDialogOverflowButton:this.props.hideShareDialogOverflowButton,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,outlookAvailability:this._outlookAvailability,engagementExtraData:this._engagementExtraData,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,closeButtonOnFocus:this._closeButtonOnFocus,closeButtonOnBlur:this._closeButtonOnBlur,onRoleChange:this.onRoleChange})),this.state.showCopyLinkInterrupt&&this._renderCopyLinkInterrupt({updatePassword:!!t.password}))};t.prototype._renderPolicyDetails=function(){return h.createElement(At,{clientId:this.props.clientId,sharingInformation:this.state.sharingInformation,policyTipInformation:this.state.policyTipInformation})};t.prototype._renderCopyLinkInterrupt=function(e){var t=e.updatePassword;return h.createElement(w,{confirmationCode:t?a.copyInterruptUpdate:a.copyInterruptRemove,participant:null,onApply:t?this._onInterruptUseNew:this._onInterruptUseExisting,onCancel:this._onInterruptCancel,onDiscard:t?this._onInterruptUseExisting:this._onInterruptUseNew})};t.prototype._renderModifyPermissions=function(e){return h.createElement(Pe,Object(r.__assign)({},this._baseProps,{shareId:this.props.shareId,mode:this.props.mode,companyName:this.state.companyName,currentSettings:this.state.currentSettings,doesCreate:!0,onCancel:this._onLinkPermissionsCancelClicked,onSelectedPermissionsChange:this._onLinkPermissionsApplyClicked,onSelectedPeopleChange:this._onSelectedPeopleChange,sharingInformation:this.state.sharingInformation,showExistingAccessOption:!0,groupsMemberCount:this.state.groupsMemberCount,onViewPolicyTipClicked:this._onViewPolicyTipClicked,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,copyLinkShortcut:!1,engagementExtraData:this._engagementExtraData,recipients:this.state.linkRecipients,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience}))};t.prototype._renderNotification=function(){var e=this.state,t=e.sharingInformation,n=e.sharingLinkCreated,i={companyName:e.companyName,currentSettings:e.currentSettings,sharingInformation:t,clientId:this.props.clientId,onShareHintClick:this._getNotificationHintClickHandler(n.createdViaCopyLinkCommand),linkRecipients:e.shareType===u.e.share?this.state.linkRecipients:null,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig};return h.createElement(He.e,Object(r.__assign)({},Object(E.e)(this.props),{shareType:e.shareType,itemName:t.item.name,linkUrl:this._modifiedSharingLinkUrl,sharingHintProps:i,shouldCopyLinkToClipboard:!0,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig}))};t.prototype._getNotificationHintClickHandler=function(e){return e?this._showModifyPermissions.bind(this,e):null};t.prototype._renderShareMainShimmer=function(){var e={allowEditing:!1,audience:f.e.existing,expiration:void 0,isEdit:!1,sharingLinkKind:0,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:"",sharingRole:l.e.none},t={anonymousLinkExpirationRestrictionDays:0,blockPeoplePickerAndSharing:!0,canAddExternalPrincipal:!1,canAddInternalPrincipal:!1,canManagePermissions:!1,canRequestAccessForGrantAccess:!1,defaultSharingLink:void 0,defaultShareLinkToExistingAccess:!1,hasInheritedLinks:!1,isShared:!1,item:this.props.sharingItemInformation?this.props.sharingItemInformation:{name:"",childCount:0,hasDlpPolicy:!1},fileExtension:"",sharingLinks:[],sharingPrincipals:[],peoplePickerSettings:{},userDisplayName:"",defaultShareLinkPermission:1,defaultLinkKind:0,userRole:l.e.none,hasPermissionsInformation:!1,sharingAbilities:null,directLink:null,sharingLinkTemplates:null,webTemplateId:void 0,itemUniqueId:void 0};return this._renderShareMain(t,e)};t.prototype._renderPermissionsList=function(){this._store.isConsumer()?this.state.sharingInformation&&this.state.sharingInformation.hasPermissionsInformation||this._store.fetchSharingInformation(!0,!1):this.state.sharingInformation&&this.state.sharingInformation.hasPermissionsInformation&&this.state.sharingInformation.addressBarLinkSettings||this._store.fetchSharingInformation(!0,!0);this.state.sharingInformation&&this.state.sharingInformation.sharedObjectType===Oe.e.list&&Ae.s();return h.createElement(yt,Object(r.__assign)({},this._baseProps,{showHeader:this.state.showHeaderInManagedAccess,mode:this.props.mode,companyName:this.state.companyName,sharingInformation:this.state.sharingInformation,linkRecipients:this.state.linkRecipients,groupsMemberCount:this.state.groupsMemberCount,backButtonClicked:this._returnToPreviousView,hideElementsInManageAccess:this._hideElementsInManageAccess,engagementExtraData:this._engagementExtraData}))};t.prototype._renderAddPeople=function(){var e=this,t=!this.props.hideShareDialogOverflowButton;return h.createElement(h.Fragment,null,h.createElement(Vt,Object(r.__assign)({},this._baseProps,{onManageExistingAccessClick:t?function(){return e._showPermissionsList()}:void 0,sharingInformation:this.state.sharingInformation,currentSettings:this.state.currentSettings,onViewPolicyTipClicked:this._onViewPolicyTipClicked})))};t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return h.createElement(c.e,{message:b.q})};t.prototype._resizeIfNeeded=function(){this._resizeTracker&&this._resizeTracker.checkSizeChangeForRef(this._topLevelDivRef)};t.prototype._getModifiedSharingLinkUrl=function(e,t,n){var r=this.state.shareType,i=e.url;if(r!==u.e.copy&&r!==u.e.outlook)return i;var s=this._getBase62Id(),o=new qt.t(i);o.setQueryParameter("e",s);var a=this._store.getNavId();a&&o.setQueryParameter("nav",a);return o.toString()};t.prototype._getBase62Id=function(){var e=new Uint8Array(6);(window.crypto||window.msCrypto).getRandomValues(e);for(var t=[],n=0;n<e.length;n++)t.push("abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"[e[n]%62]);return t.join("")};t.prototype._setGenericErrorState=function(e){var t=e.stack?e.stack:e.toString();t.length>1024&&(t=t.substr(0,1024));var n=Object(r.__assign)(Object(r.__assign)({},this.state.sharingInformation),{error:t,errorCategory:0,errorMessage:b.Lo,debugErrorMessage:"CorrelationId: "+this._correlationId});this.setState({sharingInformation:n,viewState:7})};t.prototype._sanitizeSharingContextInfo=function(e){if(e){this._isSanitizedUrl(e.customizedExternalSharingServiceUrl)||(e.customizedExternalSharingServiceUrl="");this._isSanitizedUrl(e.fixItUrl)||(e.fixItUrl="");e.defaultSharingLink&&!this._isSanitizedUrl(e.defaultSharingLink.url)&&(e.defaultSharingLink.url="");e.directLink&&!this._isSanitizedUrl(e.directLink.url)&&(e.directLink.url="");if(e.sharingLinks)for(var t=0;t<e.sharingLinks.length;t++)e.sharingLinks[t]&&!this._isSanitizedUrl(e.sharingLinks[t].url)&&(e.sharingLinks[t].url="")}};t.prototype._isSanitizedUrl=function(e){return!e||0===e.length||0===e.toLowerCase().indexOf("http://")||0===e.toLowerCase().indexOf("https://")};t.prototype._writeShareDataToRumoneLogger=function(e){var t=e.mode,n=e.viewState,r=this.props.clickTime||this._store.getSharingClickTime()||performance.timing.navigationStart;this._writePerfData({pageTransitionType:tn.e.fullPageLoad,startTime:r,mode:this.props.mode,originalMode:t,viewState:this.state.viewState,originalViewState:n,audience:this.state.currentSettings.audience})};t.prototype._writeCopyLinkTargetDataToRumoneLogger=function(e){if(this._rumoneLogger.resetRumOne()){var t=e.mode,n=e.viewState,r=e.clickTime;this._writePerfData({pageTransitionType:tn.e.onePageAppNavigation,startTime:r,mode:o.e.copy,originalMode:t,viewState:this.state.viewState,originalViewState:n,audience:this.state.currentSettings.audience})}};t.prototype._writePerfData=function(e){var t=this,n=e.pageTransitionType,r=e.startTime,i=e.mode,s=e.originalMode,u=e.viewState,a=e.originalViewState,f=e.audience;if(this.props&&r&&this.props.clientId){var l=Object.keys(o.e).filter(function(e){return o.e[e]===i})[0],c=Object.keys(o.e).filter(function(e){return o.e[e]===s})[0],h=Object.keys(Ie.e).filter(function(e){return Ie.e[e]===t.props.clientId})[0],p=this._store.getSharingInformationAPIStats(),d=this._store.getShareLinkAPIStats(),v=this._rumoneLogger.breakdownData,m={modeName:l,startTime:r,endTime:Date.now(),breakDownData:{sharingClientId:v(h),mode:v(l),audience:v(f),originalMode:v(c),viewState:v(u),originalViewState:v(a),getSharingInformationAPIStats:v(p),shareLinkAPIStats:v(d),realUserClickTime:v(r!==performance.timing.navigationStart),beforeNavigation:v(r<performance.timing.navigationStart?performance.timing.navigationStart-r:0)}};this._rumoneLogger.logSharingPerformance(m,n)}};t.contextTypes={resize:i.func.isRequired,onDismiss:i.func.isRequired,sharingStore:i.object.isRequired,shareClickTime:i.number};return t})(h.Component),un=n(87),an=n(2020),fn=n(1990),ln=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._resize=function(){var e=n._share.current;if(e){n._onResize&&n._onResize();var t=n._maxHeight,r=e.clientHeight>t?t:e.clientHeight,i=e.clientWidth;if(r>0&&i>0)try{xt.t.isActivated("b954de8d-255b-436b-8319-ebea85353bfa","07/22/2021","make share dialog body overflow auto")||we.e.isFeatureEnabled({ECS:90418})||(r+=10);0;window.external.Resize(i,r)}catch(e){var s={name:"share_resize",width:i,height:r};window.parent.postMessage(JSON.stringify(s),"*")}}};n._dismiss=function(){try{window.external.Dismiss()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_dismiss"}),"*")}};var r=window._sharingContextInfo;n._copyLinkShortcut=t.copyLinkShortcut;n._onDismiss=t.onDismiss;n._dismissed=!1;n._onResize=t.onResize;n._peoplePickerProvider=t.peoplePickerProvider;n._mode=t.mode||(n._copyLinkShortcut?o.e.copy:o.e.share);n._messageText=t.messageText;n._sharingStore=t.sharingStore;n._premiumLearnMore=t.premiumLearnMore;n._goPremium=t.goPremium;n._platformDetection=new un.e;n._breakpoint=an.t.DEFAULT_BREAKPOINTS[an.t.determineWindowSize(window.innerWidth)];n._share=h.createRef();if(!t.noMaxHeightRestriction){var i=n.props.maxHeight;n._maxHeight=i<650?i:650}r&&(n._hostSessionId=r.hostSessionId);var s=0,u=" ",a=" ",f=" ",l=0;if(t.item&&t.item.properties){var c=t.item.properties,p=c.ItemChildCount?parseInt(c.ItemChildCount,10):0,d=c.FolderChildCount?parseInt(c.FolderChildCount,10):0;s=t.item.type===vt.t.OneNote?0:p+d;u=t.item.name;a=t.item.extension;f=t.item.appMap;l=t.item.type}else if(r){u=r.itemName||" ";s=r.itemCount||0;a=r.itemExtension;f=r.itemAppmap;l=r.itemType}t.items&&t.items.length>1&&(u=y.format(fn.x,t.items.length));n._sharingItemInformation={name:u,childCount:s,hasDlpPolicy:void 0,extension:a,appmap:f,itemType:l};return n}t.prototype.getChildContext=function(){return{peoplePickerProvider:this._peoplePickerProvider,resize:this._resize,onDismiss:this._onDismiss||this._dismiss,sharingStore:this._sharingStore,platformDetection:this._platformDetection,breakpoint:this._breakpoint,premiumLearnMore:this._premiumLearnMore,goPremium:this._goPremium,shareClickTime:window._sharingStartTime||Date.now()}};t.prototype.render=function(){var e=this._mode===o.e.copy?b.He:fn.p;return this._sharingStore?h.createElement("div",Object(r.__assign)({className:"od-share-v3",ref:this._share},this.props.renderInline&&this._mode===o.e.manageAccess?{}:{role:"dialog"},{"aria-label":e}),this._renderShareComponent()):null};t.prototype.componentWillUnmount=function(){this._shareDismiss()};t.prototype._shareDismiss=function(){if(!this._dismissed&&this._onDismiss){this._dismissed=!0;this._onDismiss()}};t.prototype._renderShareComponent=function(){var e=this.props,t=e.clientId||e.sharingProvider.getClientId(),n=h.createElement(on,{copyLinkShortcut:this._copyLinkShortcut,shareId:e.shareId,theme:e.theme,clientId:t,scenarioId:e.scenarioId||"",omitCustomLabeledAudience:e.omitCustomLabeledAudience,customLabeledAudienceConfig:e.customLabeledAudienceConfig,showExistingAccessOption:!!e.sharingProvider&&e.sharingProvider.supportsExistingAccessOption(e.item),onManageAccessClicked:e.onManageAccessClicked,hideShareDialogOverflowButton:e.hideShareDialogOverflowButton,maxHeight:this._maxHeight,maxWidth:this.props.maxWidth,mode:this._mode,messageText:this._messageText,useVroomCreateDefaultLink:this._mode===o.e.copy&&C.c(e.clientId),sharingItemInformation:this._sharingItemInformation,hideElementsInManageAccess:this.props.hideElementsInManageAccess,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,invokeManageAccess:this.props.invokeManageAccess,hostSessionId:this._hostSessionId,hostOptions:this.props.hostOptions,clickTime:this.props.clickTime}),r=this._mode===o.e.share||this._mode===o.e.addPeople;return e.useFocusTrap?h.createElement(X.e,{isClickableOutsideFocusTrap:!0,disableFirstFocus:r,forceFocusInsideTrap:!r},n):n};t.childContextTypes={peoplePickerProvider:i.object.isRequired,resize:i.func.isRequired,onDismiss:i.func,sharingStore:i.object.isRequired,platformDetection:i.object.isRequired,breakpoint:i.object.isRequired,premiumLearnMore:i.func,goPremium:i.func,shareClickTime:i.number};return t})(h.Component);t.e=ln},function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(1419),i=n(4),s=n("react-lib"),o=n(472),u=n(653),a=Object(o.e)(),f=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;n._onRenderProgress=function(e){var t=n.props,r=t.ariaValueText,i=t.barHeight,o=t.className,u=t.description,f=t.label,l=void 0===f?n.props.title:f,c=t.styles,h=t.theme,p="number"==typeof n.props.percentComplete?Math.min(100,Math.max(0,100*n.props.percentComplete)):void 0,d=a(c,{theme:h,className:o,barHeight:i,indeterminate:void 0===p}),v={width:void 0!==p?p+"%":void 0,transition:void 0!==p&&p<.01?"none":void 0},m=void 0!==p?0:void 0,g=void 0!==p?100:void 0,y=void 0!==p?Math.floor(p):void 0;return s.createElement("div",{className:d.itemProgress},s.createElement("div",{className:d.progressTrack}),s.createElement("div",{className:d.progressBar,style:v,role:"progressbar","aria-describedby":u?n._descriptionId:void 0,"aria-labelledby":l?n._labelId:void 0,"aria-valuemin":m,"aria-valuemax":g,"aria-valuenow":y,"aria-valuetext":r}))};var r=Object(u.e)("progress-indicator");n._labelId=r+"-label";n._descriptionId=r+"-description";return n}t.prototype.render=function(){var e=this.props,t=e.barHeight,n=e.className,r=e.label,o=void 0===r?this.props.title:r,u=e.description,f=e.styles,l=e.theme,c=e.progressHidden,h=e.onRenderProgress,p=void 0===h?this._onRenderProgress:h,d="number"==typeof this.props.percentComplete?Math.min(100,Math.max(0,100*this.props.percentComplete)):void 0,v=a(f,{theme:l,className:n,barHeight:t,indeterminate:void 0===d});return s.createElement("div",{className:v.root},o?s.createElement("div",{id:this._labelId,className:v.itemName},o):null,c?null:p(Object(i.e)(Object(i.e)({},this.props),{percentComplete:d}),this._onRenderProgress),u?s.createElement("div",{id:this._descriptionId,className:v.itemDescription},u):null)};t.defaultProps={label:"",description:"",width:180};return t})(s.Component),l=n(25),c=n(86),h=n(705),p={root:"ms-ProgressIndicator",itemName:"ms-ProgressIndicator-itemName",itemDescription:"ms-ProgressIndicator-itemDescription",itemProgress:"ms-ProgressIndicator-itemProgress",progressTrack:"ms-ProgressIndicator-progressTrack",progressBar:"ms-ProgressIndicator-progressBar"},d=Object(c.t)(function(){return Object(l._)({"0%":{left:"-30%"},"100%":{left:"100%"}})}),v=Object(c.t)(function(){return Object(l._)({"100%":{right:"-30%"},"0%":{right:"100%"}})}),m=Object(r.e)(f,function(e){var t,n,r,s=Object(h.e)(e.theme),o=e.className,u=e.indeterminate,a=e.theme,f=e.barHeight,c=void 0===f?2:f,m=a.palette,g=a.semanticColors,y=a.fonts,b=Object(l.x)(p,a),w=m.neutralLight;return{root:[b.root,y.medium,o],itemName:[b.itemName,l.B,{color:g.bodyText,paddingTop:4,lineHeight:20}],itemDescription:[b.itemDescription,{color:g.bodySubtext,fontSize:y.small.fontSize,lineHeight:18}],itemProgress:[b.itemProgress,{position:"relative",overflow:"hidden",height:c,padding:"8px 0"}],progressTrack:[b.progressTrack,{position:"absolute",width:"100%",height:c,backgroundColor:w,selectors:(t={},t[l.s]={borderBottom:"1px solid WindowText"},t)}],progressBar:[{backgroundColor:m.themePrimary,height:c,position:"absolute",transition:"width .3s ease",width:0,selectors:(n={},n[l.s]=Object(i.e)({backgroundColor:"highlight"},Object(l.T)()),n)},u?{position:"absolute",minWidth:"33%",background:"linear-gradient(to right, "+w+" 0%, "+m.themePrimary+" 50%, "+w+" 100%)",animation:(s?v():d())+" 3s infinite",selectors:(r={},r[l.s]={background:"highlight"},r)}:{transition:"width .15s linear"},b.progressBar]}},void 0,{scope:"ProgressIndicator"})},function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(1664),s=n(48),o=n(7),u=n(11),a=new o.t({name:"SharingProvider.key",loader:new u.t(function(){return n.ee(["344"],1794).then(function(e){return e.resourceKey})})}),f=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="UpdatePermissions";n._item=t.item;n._person=t.person;n._role=t.role;n._isExecuting=t.isExecuting;n._callback=t.callback;n._expiration=t.expiration;return n}t.prototype.onExecute=function(e,t){var n=this;this._isExecuting&&this._isExecuting(!0);return this.resources.consumeAsync(a).then(function(e){return e.updatePermissions([n._person],n._item,n._role,n._expiration)}).then(function(e){n._callback(e.people[0]);n._isExecuting(!1);return{resultType:s.e.Success}},function(e){n._isExecuting(!1);return{resultType:s.e.Failure}})};return t})(i.e);t.default=f},,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n("react-lib"),i=n(37);function s(e){var t=e.width,n=e.iconUrl,s=e.iconTitle,o=e.overlayUrl,u=e.isDisabled,a=e.tooltipText,f=e.isClickable,l=e.onClick,c=e.ariaLabel,h=void 0===c?s:c,p={width:t,height:t},d=a||s||h,v=r.createElement("img",{className:Object(i.e)("FileTypeIcon-icon",{"od-FieldRenderer--disabled":u}),alt:"",src:n,style:p});if(o){var m=r.createElement("img",{className:Object(i.e)("FileTypeIcon-overlay",{"od-FieldRenderer--disabled":u}),src:o});return r.createElement("div",{className:Object(i.e)("FileTypeIcon",{"FileTypeIcon--clickable":f}),"data-is-focusable":!!f||!!l,title:d,"aria-label":h,onClick:l},v,m)}return r.createElement("div",{className:"FileTypeIcon","aria-label":h,title:d},v)}}],Array(13),[function(e,t,n){"use strict";n.d(t,"n",function(){return E});n.d(t,"e",function(){return S});var r=n(0),i=n(1743),s=n(1666),o=n(2380),u=n(22),a=n(391),f=n(46),l=n(1649),c=n(1661),h=n(7),p=n(11),d=new h.t({name:"Share.key",loader:new p.t(function(){return n.ee(["504","deferred.resx-deferred","odsp.react.lib","ondemand.resx-ondemand"],4451).then(function(e){return e.resourceKey.local})})}),v=n(1669),m=n(2217),g=n(293),y=n(1915),b=n(2367),w=n(477),E=y.shareFocusItemResourceKey,S=y.copyLinkFocusItemResourceKey,x=y.copyFormLinkFocusItemResourceKey,T=y.shareFromDetailPaneFocusItemResourceKey,N=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this,i=r,s=i.observables,o=i.resources,u=t.renderLabel,l=void 0===u?0:u,c=t.mode,h=t.item,p=t.engagementName,d=t.automationId,m=t.location;r._automationId=d;r._mode=c;r._overrideSelectedItem=h&&h.peek();r._overrideEngagementName=p;r._copyLinkShortcut=1===r._mode||3===r._mode;r._hideShareDialogOverflowButton=2===r._mode;r._actionMap=o.consume(a.e);r._itemsStore=o.consume(v.t);if(Object(f.isFeatureEnabled)(f.ShareV3)){r._focusItemResourceKey=r._getShareItemResourceKey();r._itemBeingShared=o.consume(r._focusItemResourceKey);s.backgroundCompute(r._computeIsOpen)}r._renderLabel=l;r._location=m;r._initializeCommand();return r}t.prototype._initializeCommand=function(){var e=this._getCommandProperties();this.command=new(this.managed(i.e))(e)};t.prototype._computeIsOpen=function(){this._itemBeingShared()&&this.command.isOpen(!0)};t.prototype._computeShouldClearItem=function(){this.command.isOpen()||this._itemBeingShared(void 0)};t.prototype._resizeShare=function(){if(!this._registeredClear){this._registeredClear=!0;this.observables.backgroundCompute(this._computeShouldClearItem)}};t.prototype._dismissShare=function(){this._itemBeingShared(void 0)};t.prototype._getPayload=function(){var e=this,t=this.observables,n=this.createPureComputed(this._computeShareParams),r=this.createPureComputed(function(){return!!e._itemBeingShared()}),i=t.create();t.backgroundCompute(function(){r.peek()?e.trackPromise(e.resources.consumeAsync(d.local)).done(function(e){i(e)}):r()});return this.createPureComputed(function(){var e=i(),t=n();if(e&&t)return e.toSpecification(t)})};t.prototype._computeShareParams=function(){var e=this._itemBeingShared(),t=e?this._itemsStore.getItem(e.items[0].key):void 0;if(t)return{item:t,copyLinkShortcut:this._copyLinkShortcut,onDismiss:this._dismissShare.bind(this),onResize:this._resizeShare.bind(this),hideShareDialogOverflowButton:this._hideShareDialogOverflowButton,mode:4===this._mode?b.e.addPeople:void 0,scenarioId:e.scenarioId,defaultRecipients:e.defaultRecipients,isEdit:e.isEdit,isSecureShare:e.isSecureShare,clickTime:Date.now()}};t.prototype._getShareItemResourceKey=function(){switch(this._mode){case 0:return E;case 1:return S;case 2:return T;case 3:return x;case 4:return y.shareFromGrantAccessItemResourceKey;default:return E}};t.prototype._getCommandProperties=function(){var e,t={text:void 0,accessibleLabel:void 0,tooltip:void 0,icon:void 0,keys:void 0,action:void 0,payload:void 0,engagementName:void 0,renderLabel:this._renderLabel,enableRecoverFocusBinding:void 0,beakColor:void 0,location:void 0,automationId:this._automationId},n=Object(f.isFeatureEnabled)(f.ShareV3);if(4===this._mode){t.text=s.grantAccess;t.icon=new c.e("PlayerSettings");e=s.grantAccessCommandLabel}else if(this._copyLinkShortcut){t.text=n?s.CopyLinkCommandText:s.GetLink;e=s.CopyLinkCommandTooltipV3;t.icon=new c.e("Link")}else{t.text=s.Share;e=s.ShareCommandTooltipV3;t.icon=new c.e("Share");t.keys=["S"]}this._overrideEngagementName?t.engagementName=this._overrideEngagementName:this._copyLinkShortcut?t.engagementName="GetLink":t.engagementName="Share";if(n){t.action=new(this.managed(this._actionMap.ShowShareAction))({focusItemResourceKey:this._focusItemResourceKey,overrideItem:this._overrideSelectedItem});t.payload={control:this._getPayload(),timeout:36e5,announce:!1,autoDismiss:!0,preventDismissOnScroll:!0,preventDismissOnResize:!0};t.enableRecoverFocusBinding=!1;t.beakColor=g.e.neutralLighterAlt}else this._copyLinkShortcut?t.action=new(this.managed(this._actionMap.GetLinkAction)):t.action=new(this.managed(this._actionMap.ShareByLinkAction))({sharingMethod:2});t.location=Object(w.i)()?4:this._location;var r=this.resources.consume(m.e),i=this.createPureComputed(function(){return r()}),a=this.createPureComputed(function(){return r()?u.format(o.c,e):e}),l=this.createPureComputed(function(){return r()?u.format(o.c,t.text):t.text});t.isDisabled=i;t.tooltip=a;t.accessibleLabel=l;t.prependTextToAccessibleLabel=!1;return t};return t})(l.n);t.t=N},,,,,,,,,,,,function(e,t,n){"use strict";var r;(function(e){e[e.specificPeople=0]="specificPeople";e[e.organization=1]="organization";e[e.anyone=2]="anyone";e[e.existing=3]="existing";e[e.specificPeopleFlex=4]="specificPeopleFlex";e[e.customLabeledSpecificPeople=5]="customLabeledSpecificPeople"})(r||(r={}));t.e=r}],Array(15),[function(e,t,n){"use strict";n.d(t,"e",function(){return I});var r=n(1419),i=n(25),s=n(86),o=n(705),u=n(506),a=Object(s.t)(function(){return Object(i._)({"0%":{transform:"translate(0, 0)",animationTimingFunction:"linear"},"78.57%":{transform:"translate(0, 0)",animationTimingFunction:"cubic-bezier(0.62, 0, 0.56, 1)"},"82.14%":{transform:"translate(0, -5px)",animationTimingFunction:"cubic-bezier(0.58, 0, 0, 1)"},"84.88%":{transform:"translate(0, 9px)",animationTimingFunction:"cubic-bezier(1, 0, 0.56, 1)"},"88.1%":{transform:"translate(0, -2px)",animationTimingFunction:"cubic-bezier(0.58, 0, 0.67, 1)"},"90.12%":{transform:"translate(0, 0)",animationTimingFunction:"linear"},"100%":{transform:"translate(0, 0)"}})}),f=Object(s.t)(function(){return Object(i._)({"0%":{transform:" scale(0)",animationTimingFunction:"linear"},"14.29%":{transform:"scale(0)",animationTimingFunction:"cubic-bezier(0.84, 0, 0.52, 0.99)"},"16.67%":{transform:"scale(1.15)",animationTimingFunction:"cubic-bezier(0.48, -0.01, 0.52, 1.01)"},"19.05%":{transform:"scale(0.95)",animationTimingFunction:"cubic-bezier(0.48, 0.02, 0.52, 0.98)"},"21.43%":{transform:"scale(1)",animationTimingFunction:"linear"},"42.86%":{transform:"scale(1)",animationTimingFunction:"cubic-bezier(0.48, -0.02, 0.52, 1.02)"},"45.71%":{transform:"scale(0.8)",animationTimingFunction:"cubic-bezier(0.48, 0.01, 0.52, 0.99)"},"50%":{transform:"scale(1)",animationTimingFunction:"linear"},"90.12%":{transform:"scale(1)",animationTimingFunction:"cubic-bezier(0.48, -0.02, 0.52, 1.02)"},"92.98%":{transform:"scale(0.8)",animationTimingFunction:"cubic-bezier(0.48, 0.01, 0.52, 0.99)"},"97.26%":{transform:"scale(1)",animationTimingFunction:"linear"},"100%":{transform:"scale(1)"}})}),l=Object(s.t)(function(){return Object(i._)({"0%":{transform:"rotate(0deg)",animationTimingFunction:"linear"},"83.33%":{transform:" rotate(0deg)",animationTimingFunction:"cubic-bezier(0.33, 0, 0.67, 1)"},"83.93%":{transform:"rotate(15deg)",animationTimingFunction:"cubic-bezier(0.33, 0, 0.67, 1)"},"84.52%":{transform:"rotate(-15deg)",animationTimingFunction:"cubic-bezier(0.33, 0, 0.67, 1)"},"85.12%":{transform:"rotate(15deg)",animationTimingFunction:"cubic-bezier(0.33, 0, 0.67, 1)"},"85.71%":{transform:"rotate(-15deg)",animationTimingFunction:"cubic-bezier(0.33, 0, 0.67, 1)"},"86.31%":{transform:"rotate(0deg)",animationTimingFunction:"linear"},"100%":{transform:"rotate(0deg)"}})});var c,h=n(4),p=n("react-lib"),d=n(472),v=n(129),m=n(774),g=n(207),y=n(95),b=n(886),w=n(1377),E=n(973),S=n(180),x=n(991),T=n(69),N=n(1647),C=Object(s.t)(function(){var e;return Object(i.P)({root:[{position:"absolute",boxSizing:"border-box",border:"1px solid ${}",selectors:(e={},e[i.s]={border:"1px solid WindowText"},e)},Object(i.E)()],container:{position:"relative"},main:{backgroundColor:"#ffffff",overflowX:"hidden",overflowY:"hidden",position:"relative"},overFlowYHidden:{overflowY:"hidden"}})}),k=n(1493),L=n(97),A=n(37),O=n(91),M={opacity:0},_=((c={})[T.t.top]="slideUpIn20",c[T.t.bottom]="slideDownIn20",c[T.t.left]="slideLeftIn20",c[T.t.right]="slideRightIn20",c),D=(function(e){Object(h.r)(t,e);function t(t){var n=e.call(this,t)||this;n._positionedHost=p.createRef();n._contentHost=p.createRef();n.dismiss=function(e){n.onResize(e)};n.onResize=function(e){var t=n.props.onDismiss;t?t(e):n._updateAsyncPosition()};n._setInitialFocus=function(){if(n._contentHost.current&&n.props.setInitialFocus&&!n._didSetInitialFocus&&n.state.positions){n._didSetInitialFocus=!0;Object(m.n)(n._contentHost.current)}};n._onComponentDidMount=function(){n._async.setTimeout(function(){n._events.on(n._targetWindow,"scroll",n._async.throttle(n._dismissOnScroll,10),!0);n._events.on(n._targetWindow,"resize",n._async.throttle(n.onResize,10),!0);n._events.on(n._targetWindow.document.body,"focus",n._dismissOnLostFocus,!0);n._events.on(n._targetWindow.document.body,"click",n._dismissOnLostFocus,!0)},0);n.props.onLayerMounted&&n.props.onLayerMounted();n._updateAsyncPosition();n._setHeightOffsetEveryFrame()};Object(b.e)(n);n._async=new g.e(n);n._events=new y.e(n);n._didSetInitialFocus=!1;n.state={positions:void 0,heightOffset:0};n._positionAttempts=0;return n}t.prototype.UNSAFE_componentWillMount=function(){this._setTargetWindowAndElement(this._getTarget())};t.prototype.componentDidMount=function(){this._onComponentDidMount()};t.prototype.componentDidUpdate=function(){this._setInitialFocus();this._updateAsyncPosition()};t.prototype.UNSAFE_componentWillUpdate=function(e){var t=this._getTarget(e);if(t!==this._getTarget()||"string"==typeof t||t instanceof String){this._maxHeight=void 0;this._setTargetWindowAndElement(t)}e.offsetFromTarget!==this.props.offsetFromTarget&&(this._maxHeight=void 0);e.finalHeight!==this.props.finalHeight&&this._setHeightOffsetEveryFrame()};t.prototype.componentWillUnmount=function(){this._async.dispose();this._events.dispose()};t.prototype.render=function(){if(!this._targetWindow)return null;var e=this.props,t=e.className,n=e.positioningContainerWidth,r=e.positioningContainerMaxHeight,s=e.children,o=this.state.positions,u=C(),a=o&&o.targetEdge?i.e[_[o.targetEdge]]:"",f=this._getMaxHeight()+this.state.heightOffset,l=r&&r>f?f:r,c=p.createElement("div",{ref:this._positionedHost,className:Object(A.e)("ms-PositioningContainer",u.container)},p.createElement("div",{className:Object(i.H)("ms-PositioningContainer-layerHost",u.root,t,a,!!n&&{width:n}),style:o?o.elementPosition:M,tabIndex:-1,ref:this._contentHost},s,l));return this.props.doNotLayer?c:p.createElement(k.e,null,c)};t.prototype._dismissOnScroll=function(e){var t=this.props.preventDismissOnScroll;this.state.positions&&!t&&this._dismissOnLostFocus(e)};t.prototype._dismissOnLostFocus=function(e){var t=e.target,n=this._positionedHost.current&&!Object(x.e)(this._positionedHost.current,t);(!this._target&&n||e.target!==this._targetWindow&&n&&(this._target.stopPropagation||!this._target||t!==this._target&&!Object(x.e)(this._target,t)))&&this.onResize(e)};t.prototype._updateAsyncPosition=function(){var e=this;this._async.requestAnimationFrame(function(){return e._updatePosition()})};t.prototype._updatePosition=function(){var e=this.state.positions,t=this.props,n=t.offsetFromTarget,r=t.onPositioned,i=this._positionedHost.current,s=this._contentHost.current;if(i&&s){var o=Object(h.e)({},this.props);o.bounds=this._getBounds();o.target=this._target;if(document.body.contains(o.target)){o.gapSpace=n;var u=Object(N.s)(o,i,s);if(!e&&u||e&&u&&!this._arePositionsEqual(e,u)&&this._positionAttempts<5){this._positionAttempts++;this.setState({positions:u},function(){r&&r(u)})}else{this._positionAttempts=0;r&&r(u)}}else void 0!==e&&this.setState({positions:void 0})}};t.prototype._getBounds=function(){if(!this._positioningBounds){var e=this.props.bounds;e||(e={top:0+this.props.minPagePadding,left:0+this.props.minPagePadding,right:this._targetWindow.innerWidth-this.props.minPagePadding,bottom:this._targetWindow.innerHeight-this.props.minPagePadding,width:this._targetWindow.innerWidth-2*this.props.minPagePadding,height:this._targetWindow.innerHeight-2*this.props.minPagePadding});this._positioningBounds=e}return this._positioningBounds};t.prototype._getMaxHeight=function(){var e=this.props,t=e.directionalHintFixed,n=e.offsetFromTarget,r=e.directionalHint;if(!this._maxHeight)if(t&&this._target){var i=n||0;this._maxHeight=Object(N.t)(this._target,r,i,this._getBounds())}else this._maxHeight=this._getBounds().height-2;return this._maxHeight};t.prototype._arePositionsEqual=function(e,t){return this._comparePositions(e.elementPosition,t.elementPosition)};t.prototype._comparePositions=function(e,t){for(var n in t)if(t.hasOwnProperty(n)){var r=e[n],i=t[n];if(r&&i&&r.toFixed(2)!==i.toFixed(2))return!1}return!0};t.prototype._setTargetWindowAndElement=function(e){var t=this._positionedHost.current;if(e)if("string"==typeof e){var n=Object(S.e)();this._target=n?n.querySelector(e):null;this._targetWindow=Object(O.e)(t)}else if(e.stopPropagation){this._targetWindow=Object(O.e)(e.target);this._target=e}else if(void 0===e.left&&void 0===e.x||void 0===e.top&&void 0===e.y){var r=e;this._targetWindow=Object(O.e)(r);this._target=e}else{this._targetWindow=Object(O.e)(t);this._target=e}else this._targetWindow=Object(O.e)(t)};t.prototype._setHeightOffsetEveryFrame=function(){var e=this;this._contentHost&&this.props.finalHeight&&(this._setHeightOffsetTimer=this._async.requestAnimationFrame(function(){if(e._contentHost.current){var t=e._contentHost.current.lastChild,n=t.scrollHeight-t.offsetHeight;e.setState({heightOffset:e.state.heightOffset+n});t.offsetHeight<e.props.finalHeight?e._setHeightOffsetEveryFrame():e._async.cancelAnimationFrame(e._setHeightOffsetTimer)}}))};t.prototype._getTarget=function(e){void 0===e&&(e=this.props);return e.target};t.defaultProps={preventDismissOnScroll:!1,offsetFromTarget:0,minPagePadding:8,directionalHint:L.e.bottomAutoEdge};return t})(p.Component);function P(e){var t;return{root:[{position:"absolute",boxShadow:"inherit",border:"none",boxSizing:"border-box",transform:e.transform,width:e.width,height:e.height,left:e.left,top:e.top,right:e.right,bottom:e.bottom}],beak:{fill:e.color,display:"block",selectors:(t={},t[i.s]={fill:"windowtext"},t)}}}var H=(function(e){Object(h.r)(t,e);function t(t){var n=e.call(this,t)||this;Object(b.e)(n);return n}t.prototype.render=function(){var e,t,n,r,i,s,o=this.props,u=o.left,a=o.top,f=o.bottom,l=o.right,c=o.color,h=o.direction,v=void 0===h?T.t.top:h;if(v===T.t.top||v===T.t.bottom){e=10;t=18}else{e=18;t=10}switch(v){case T.t.top:default:n="9, 0";r="18, 10";i="0, 10";s="translateY(-100%)";break;case T.t.right:n="0, 0";r="10, 10";i="0, 18";s="translateX(100%)";break;case T.t.bottom:n="0, 0";r="18, 0";i="9, 10";s="translateY(100%)";break;case T.t.left:n="10, 0";r="0, 10";i="10, 18";s="translateX(-100%)"}var m=Object(d.e)()(P,{left:u,top:a,bottom:f,right:l,height:e+"px",width:t+"px",transform:s,color:c});return p.createElement("div",{className:m.root,role:"presentation"},p.createElement("svg",{height:e,width:t,className:m.beak},p.createElement("polygon",{points:n+" "+r+" "+i})))};return t})(p.Component),B=n(1646),j=Object(d.e)(),F=(function(e){Object(h.r)(t,e);function t(t){var n=e.call(this,t)||this;n._entityHost=p.createRef();n._entityInnerHostElement=p.createRef();n._translateAnimationContainer=p.createRef();n._ariaAlertContainer=p.createRef();n._childrenContainer=p.createRef();n._positioningContainer=p.createRef();n.dismiss=function(e){var t=n.props.onDismiss;t&&t(e)};n._onKeyDown=function(e){(e.altKey&&e.which===v.e.c||e.which===v.e.enter&&n._translateAnimationContainer.current&&n._translateAnimationContainer.current.contains(e.target))&&n._onFocusHandler()};n._onFocusHandler=function(){n.state.isCollapsed&&n._openCoachmark()};n._onPositioned=function(e){n._async.requestAnimationFrame(function(){n.setState({targetAlignment:e.alignmentEdge,targetPosition:e.targetEdge})})};n._setBeakPosition=function(){var e,t,r,i,s,u,a=n.state.targetAlignment;switch(n._beakDirection){case T.t.top:case T.t.bottom:if(a)if(a===T.t.left){e="7px";s="left"}else{r="7px";s="right"}else{e="calc(50% - 9px)";s="center"}if(n._beakDirection===T.t.top){t="3px";u="top"}else{i="3px";u="bottom"}break;case T.t.left:case T.t.right:if(a)if(a===T.t.top){t="7px";u="top"}else{i="7px";u="bottom"}else{t="calc(50% - 9px)";u="center"}if(n._beakDirection===T.t.left){Object(o.e)(n.props.theme)?r="3px":e="3px";s="left"}else{Object(o.e)(n.props.theme)?e="3px":r="3px";s="right"}}n.setState({beakLeft:e,beakRight:r,beakBottom:i,beakTop:t,transformOrigin:s+" "+u})};n._openCoachmark=function(){n.setState({isCollapsed:!1});n.props.onAnimationOpenStart&&n.props.onAnimationOpenStart();n._entityInnerHostElement.current&&n._entityInnerHostElement.current.addEventListener("transitionend",function(){n._async.setTimeout(function(){n._entityInnerHostElement.current&&Object(m.n)(n._entityInnerHostElement.current)},1e3);n.props.onAnimationOpenEnd&&n.props.onAnimationOpenEnd()})};n._async=new g.e(n);n._events=new y.e(n);Object(b.e)(n);Object(w.e)("Coachmark",t,{teachingBubbleRef:void 0,collapsed:"isCollapsed",beakWidth:void 0,beakHeight:void 0,width:void 0,height:void 0});n.state={isCollapsed:t.isCollapsed,isBeaconAnimating:!0,isMeasuring:!0,entityInnerHostRect:{width:0,height:0},isMouseInProximity:!1,isMeasured:!1};return n}Object.defineProperty(t.prototype,"_beakDirection",{get:function(){var e=this.state.targetPosition;return void 0===e?T.t.bottom:Object(N.n)(e)},enumerable:!0,configurable:!0});t.prototype.render=function(){var e=this.props,t=e.beaconColorOne,n=e.beaconColorTwo,r=e.children,i=e.target,s=e.color,o=e.positioningContainerProps,u=e.ariaDescribedBy,a=e.ariaDescribedByText,f=e.ariaLabelledBy,l=e.ariaLabelledByText,c=e.ariaAlertText,d=e.delayBeforeCoachmarkAnimation,v=e.styles,m=e.theme,g=e.className,y=e.persistentBeak,b=this.state,w=b.beakLeft,E=b.beakTop,S=b.beakRight,x=b.beakBottom,T=b.isCollapsed,N=b.isBeaconAnimating,C=b.isMeasuring,k=b.entityInnerHostRect,L=b.transformOrigin,A=b.alertText,O=b.isMeasured,M=s;!M&&m&&(M=m.semanticColors.primaryButtonBackground);var _=j(v,{theme:m,beaconColorOne:t,beaconColorTwo:n,className:g,isCollapsed:T,isBeaconAnimating:N,isMeasuring:C,color:M,transformOrigin:L,isMeasured:O,entityHostHeight:k.height+"px",entityHostWidth:k.width+"px",width:"32px",height:"32px",delayBeforeCoachmarkAnimation:d+"ms"}),P=T?32:k.height;return p.createElement(D,Object(h.e)({target:i,offsetFromTarget:10,componentRef:this._positioningContainer,finalHeight:P,onPositioned:this._onPositioned,bounds:this._getBounds()},o),p.createElement("div",{className:_.root},c&&p.createElement("div",{className:_.ariaContainer,role:"alert",ref:this._ariaAlertContainer,"aria-hidden":!T},A),p.createElement("div",{className:_.pulsingBeacon}),p.createElement("div",{className:_.translateAnimationContainer,ref:this._translateAnimationContainer},p.createElement("div",{className:_.scaleAnimationLayer},p.createElement("div",{className:_.rotateAnimationLayer},this._positioningContainer.current&&(T||y)&&p.createElement(H,{left:w,top:E,right:S,bottom:x,direction:this._beakDirection,color:M}),p.createElement("div",{className:_.entityHost,ref:this._entityHost,tabIndex:-1,"data-is-focusable":!0,role:"dialog","aria-labelledby":f,"aria-describedby":u},T&&[f&&p.createElement("p",{id:f,key:0,className:_.ariaContainer},l),u&&p.createElement("p",{id:u,key:1,className:_.ariaContainer},a)],p.createElement(B.e,{isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:!1},p.createElement("div",{className:_.entityInnerHost,ref:this._entityInnerHostElement},p.createElement("div",{className:_.childrenContainer,ref:this._childrenContainer,"aria-hidden":T},r)))))))))};t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.props.isCollapsed&&!e.isCollapsed&&this._openCoachmark()};t.prototype.shouldComponentUpdate=function(e,t){return!Object(E.n)(e,this.props)||!Object(E.n)(t,this.state)};t.prototype.componentDidUpdate=function(e,t){t.targetAlignment===this.state.targetAlignment&&t.targetPosition===this.state.targetPosition||this._setBeakPosition();e.preventDismissOnLostFocus!==this.props.preventDismissOnLostFocus&&this._addListeners()};t.prototype.componentDidMount=function(){var e=this;this._async.requestAnimationFrame(function(){if(e._entityInnerHostElement.current&&e.state.entityInnerHostRect.width+e.state.entityInnerHostRect.width===0){e.setState({isMeasuring:!1,entityInnerHostRect:{width:e._entityInnerHostElement.current.offsetWidth,height:e._entityInnerHostElement.current.offsetHeight},isMeasured:!0});e._setBeakPosition();e.forceUpdate()}e._addListeners();e._async.setTimeout(function(){e._addProximityHandler(e.props.mouseProximityOffset)},e.props.delayBeforeMouseOpen);e.props.ariaAlertText&&e._async.setTimeout(function(){e.props.ariaAlertText&&e._ariaAlertContainer.current&&e.setState({alertText:e.props.ariaAlertText})},0);e.props.preventFocusOnMount||e._async.setTimeout(function(){e._entityHost.current&&e._entityHost.current.focus()},1e3)})};t.prototype.componentWillUnmount=function(){this._async.dispose();this._events.dispose()};t.prototype._addListeners=function(){var e=this.props.preventDismissOnLostFocus,t=Object(S.e)();this._events.off();if(t){this._events.on(t,"keydown",this._onKeyDown,!0);if(!e){this._events.on(t,"click",this._dismissOnLostFocus,!0);this._events.on(t,"focus",this._dismissOnLostFocus,!0)}}};t.prototype._dismissOnLostFocus=function(e){var t=e.target,n=this._translateAnimationContainer.current&&!Object(x.e)(this._translateAnimationContainer.current,t),r=this.props.target;n&&t!==r&&!Object(x.e)(r,t)&&this.dismiss(e)};t.prototype._getBounds=function(){var e=this.props,t=e.isPositionForced,n=e.positioningContainerProps;return t?!n||n.directionalHint!==L.e.topAutoEdge&&n.directionalHint!==L.e.bottomAutoEdge?{left:-1/0,top:-1/0,bottom:1/0,right:1/0,width:1/0,height:1/0}:{left:0,top:-1/0,bottom:1/0,right:window.innerWidth,width:window.innerWidth,height:1/0}:void 0};t.prototype._addProximityHandler=function(e){var t=this;void 0===e&&(e=0);var n=[];this._async.setTimeout(function(){t._setTargetElementRect();t._events.on(window,"resize",function(){n.forEach(function(e){clearInterval(e)});n.push(t._async.setTimeout(function(){t._setTargetElementRect()},100))})},10);this._events.on(document,"mousemove",function(n){if(t.state.isCollapsed){var r=n.clientY,i=n.clientX;t._setTargetElementRect();t._isInsideElement(i,r,e)!==t.state.isMouseInProximity&&t._openCoachmark()}t.props.onMouseMove&&t.props.onMouseMove(n)})};t.prototype._setTargetElementRect=function(){this._translateAnimationContainer&&this._translateAnimationContainer.current&&(this._targetElementRect=this._translateAnimationContainer.current.getBoundingClientRect())};t.prototype._isInsideElement=function(e,t,n){void 0===n&&(n=0);return e>this._targetElementRect.left-n&&e<this._targetElementRect.left+this._targetElementRect.width+n&&t>this._targetElementRect.top-n&&t<this._targetElementRect.top+this._targetElementRect.height+n};t.defaultProps={isCollapsed:!0,mouseProximityOffset:10,delayBeforeMouseOpen:3600,delayBeforeCoachmarkAnimation:0,isPositionForced:!0,positioningContainerProps:{directionalHint:L.e.bottomAutoEdge}};return t})(p.Component),I=Object(r.e)(F,function(e){var t,n=e.theme,r=e.className,s=e.color,c=e.beaconColorOne,h=e.beaconColorTwo,p=e.delayBeforeCoachmarkAnimation,d=e.isCollapsed,v=e.isBeaconAnimating,m=e.isMeasuring,g=e.isMeasured,y=e.entityHostHeight,b=e.entityHostWidth,w=e.transformOrigin;if(!n)throw new Error("theme is undefined or null in base Dropdown getStyles function.");var E=i.a.continuousPulseAnimationDouble(c||n.palette.themePrimary,h||n.palette.themeTertiary,"35px","150px","10px"),S=i.a.createDefaultAnimation(E,p);return{root:[n.fonts.medium,{position:"relative"},r],pulsingBeacon:[{position:"absolute",top:"50%",left:"50%",transform:Object(o.e)(n)?"translate(50%, -50%)":"translate(-50%, -50%)",width:"0px",height:"0px",borderRadius:"225px",borderStyle:"solid",opacity:"0"},d&&v&&S],translateAnimationContainer:[{width:"100%",height:"100%"},d&&{animationDuration:"14s",animationTimingFunction:"linear",animationDirection:"normal",animationIterationCount:"1",animationDelay:"0s",animationFillMode:"forwards",animationName:a(),transition:"opacity 0.5s ease-in-out"},!d&&{opacity:"1"}],scaleAnimationLayer:[{width:"100%",height:"100%"},d&&{animationDuration:"14s",animationTimingFunction:"linear",animationDirection:"normal",animationIterationCount:"1",animationDelay:"0s",animationFillMode:"forwards",animationName:f()}],rotateAnimationLayer:[{width:"100%",height:"100%"},d&&{animationDuration:"14s",animationTimingFunction:"linear",animationDirection:"normal",animationIterationCount:"1",animationDelay:"0s",animationFillMode:"forwards",animationName:l()},!d&&{opacity:"1"}],entityHost:[{position:"relative",outline:"none",overflow:"hidden",backgroundColor:s,borderRadius:32,transition:"border-radius 250ms, width 500ms, height 500ms cubic-bezier(0.5, 0, 0, 1)",visibility:"hidden",selectors:(t={},t[i.s]={backgroundColor:"Window",border:"2px solid WindowText"},t["."+u.e+" &:focus"]={outline:"1px solid "+n.palette.themeTertiary},t)},!m&&{width:32,height:32,visibility:"visible"},!d&&{borderRadius:"1px",opacity:"1",width:b,height:y}],entityInnerHost:[{transition:"transform 500ms cubic-bezier(0.5, 0, 0, 1)",transformOrigin:w,transform:"scale(0)"},!d&&{width:b,height:y,transform:"scale(1)"},!m&&{visibility:"visible"}],childrenContainer:[{display:g&&d?"none":"block"}],ariaContainer:{position:"fixed",opacity:0,height:0,width:0,pointerEvents:"none"}}},void 0,{scope:"Coachmark"})},function(e,t,n){"use strict";n.d(t,"e",function(){return yt});var r={};n.r(r);n.d(r,"root",function(){return w});n.d(r,"picker",function(){return E});n.d(r,"holder",function(){return S});n.d(r,"pickerIsOpened",function(){return x});n.d(r,"frame",function(){return T});n.d(r,"wrap",function(){return N});n.d(r,"goTodaySpacing",function(){return C});n.d(r,"dayPicker",function(){return k});n.d(r,"header",function(){return L});n.d(r,"divider",function(){return A});n.d(r,"monthAndYear",function(){return O});n.d(r,"year",function(){return M});n.d(r,"decade",function(){return _});n.d(r,"currentYear",function(){return D});n.d(r,"currentDecade",function(){return P});n.d(r,"table",function(){return H});n.d(r,"dayWrapper",function(){return B});n.d(r,"weekday",function(){return j});n.d(r,"day",function(){return F});n.d(r,"daySelection",function(){return I});n.d(r,"dayIsToday",function(){return q});n.d(r,"dayIsDisabled",function(){return R});n.d(r,"dayIsUnfocused",function(){return U});n.d(r,"dayIsFocused",function(){return z});n.d(r,"dayIsHighlighted",function(){return W});n.d(r,"pickerIsFocused",function(){return X});n.d(r,"dayDisabled",function(){return V});n.d(r,"dayBackground",function(){return $});n.d(r,"dayHover",function(){return J});n.d(r,"dayPress",function(){return K});n.d(r,"weekBackground",function(){return Q});n.d(r,"showWeekNumbers",function(){return G});n.d(r,"weekNumbers",function(){return Y});n.d(r,"weekIsHighlighted",function(){return Z});n.d(r,"showWeekNumbersRTL",function(){return ee});n.d(r,"monthComponents",function(){return te});n.d(r,"yearComponents",function(){return ne});n.d(r,"decadeComponents",function(){return re});n.d(r,"closeButton",function(){return ie});n.d(r,"prevMonth",function(){return se});n.d(r,"nextMonth",function(){return oe});n.d(r,"prevYear",function(){return ue});n.d(r,"nextYear",function(){return ae});n.d(r,"prevDecade",function(){return fe});n.d(r,"nextDecade",function(){return le});n.d(r,"prevMonthIsDisabled",function(){return ce});n.d(r,"nextMonthIsDisabled",function(){return he});n.d(r,"prevYearIsDisabled",function(){return pe});n.d(r,"nextYearIsDisabled",function(){return de});n.d(r,"prevDecadeIsDisabled",function(){return ve});n.d(r,"nextDecadeIsDisabled",function(){return me});n.d(r,"headerToggleView",function(){return ge});n.d(r,"optionGrid",function(){return ye});n.d(r,"monthOption",function(){return be});n.d(r,"yearOption",function(){return we});n.d(r,"isHighlighted",function(){return Ee});n.d(r,"monthOptionIsDisabled",function(){return Se});n.d(r,"yearOptionIsDisabled",function(){return xe});n.d(r,"goToday",function(){return Te});n.d(r,"goToTodayIsDisabled",function(){return Ne});n.d(r,"goTodayInlineMonth",function(){return Ce});n.d(r,"isPickingYears",function(){return ke});n.d(r,"monthPicker",function(){return Le});n.d(r,"yearPicker",function(){return Ae});n.d(r,"monthPickerVisible",function(){return Oe});n.d(r,"toggleMonthView",function(){return Me});n.d(r,"calendarsInline",function(){return _e});n.d(r,"monthPickerOnly",function(){return De});n.d(r,"monthPickerAsOverlay",function(){return Pe});n.d(r,"holderWithButton",function(){return He});n.d(r,"monthIsHighlighted",function(){return Be});n.d(r,"monthIsCurrentMonth",function(){return je});n.d(r,"yearIsHighlighted",function(){return Fe});n.d(r,"yearIsCurrentYear",function(){return Ie});n.d(r,"topLeftCornerDate",function(){return qe});n.d(r,"topRightCornerDate",function(){return Re});n.d(r,"bottomLeftCornerDate",function(){return Ue});n.d(r,"bottomRightCornerDate",function(){return ze});n.d(r,"weekSelection",function(){return We});n.d(r,"monthSelection",function(){return Xe});n.d(r,"topDate",function(){return Ve});n.d(r,"rightDate",function(){return $e});n.d(r,"bottomDate",function(){return Je});n.d(r,"leftdate",function(){return Ke});var i=n(4),s=n("react-lib"),o=n(1991),u=n(129),a=n(886),f=n(653),l=n(37),c=n(705),h=/[\{\}]/g,p=/\{\d+\}/g;function d(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=t;function i(e){var t=r[e.replace(h,"")];null==t&&(t="");return t}return e.replace(p,i)}var v=n(1372),m=n(1648),g=n(993),y=n(2321),b=n(138);Object(b.n)([{rawString:".root_3822b975{-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:none;box-shadow:none;margin:0;padding:0}.root_3822b975 *{overflow:visible}.root_3822b975 ::-moz-focus-inner{border:0}.root_3822b975 *{outline:transparent}.root_3822b975 *{position:relative}.ms-Fabric--isFocusVisible .root_3822b975 :focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.picker_3822b975{color:"},{theme:"black",defaultValue:"#000000"},{rawString:";font-size:14px;position:relative}html[dir=ltr] .picker_3822b975{text-align:left}html[dir=rtl] .picker_3822b975{text-align:right}.holder_3822b975{-webkit-overflow-scrolling:touch;-webkit-box-sizing:border-box;box-sizing:border-box;display:none}.picker_3822b975.pickerIsOpened_3822b975 .holder_3822b975{-webkit-box-sizing:border-box;box-sizing:border-box;display:inline-block}.pickerIsOpened_3822b975{position:relative}.frame_3822b975{position:relative}.wrap_3822b975{min-height:212px;padding:12px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-sizing:content-box;box-sizing:content-box}.wrap_3822b975.goTodaySpacing_3822b975{min-height:228px}.dayPicker_3822b975{display:block}.header_3822b975{position:relative;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;height:28px;line-height:44px;width:100%}.divider_3822b975{top:0;margin-top:-12px;margin-bottom:-12px}html[dir=ltr] .divider_3822b975{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}html[dir=rtl] .divider_3822b975{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.decade_3822b975,.monthAndYear_3822b975,.year_3822b975{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;font-size:14px;font-weight:400;font-weight:600;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";padding:0 5px}.currentDecade_3822b975:hover,.currentYear_3822b975:hover,.monthAndYear_3822b975:hover{cursor:default}.table_3822b975{text-align:center;border-collapse:collapse;border-spacing:0;table-layout:fixed;font-size:inherit;margin-top:4px;width:197px}.table_3822b975 td{margin:0;padding:0}.dayWrapper_3822b975,.weekday_3822b975{width:28px;height:28px;padding:0;line-height:28px;font-size:12px;font-size:15px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:default}.dayWrapper_3822b975 ::-moz-focus-inner,.weekday_3822b975 ::-moz-focus-inner{border:0}.dayWrapper_3822b975 *,.weekday_3822b975 *{outline:transparent}.dayWrapper_3822b975 *,.weekday_3822b975 *{position:relative}.ms-Fabric--isFocusVisible .dayWrapper_3822b975 :focus:after,.ms-Fabric--isFocusVisible .weekday_3822b975 :focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.day_3822b975{width:24px;height:24px;border-radius:2px;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;border:none;padding:0;background-color:transparent;line-height:100%;color:inherit;font-size:inherit;font-weight:inherit;font-family:inherit}@media screen and (-ms-high-contrast:active){.daySelection_3822b975 .day_3822b975:active,.daySelection_3822b975 .day_3822b975:hover{outline:1px solid Highlight;-ms-high-contrast-adjust:none}}@media screen and (-ms-high-contrast:active){.daySelection_3822b975 .day_3822b975:active{color:Highlight;-ms-high-contrast-adjust:none}}.dayIsToday_3822b975{border-radius:100%}.dayIsToday_3822b975,.dayIsToday_3822b975:hover{position:relative;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}@media screen and (-ms-high-contrast:active){.dayIsToday_3822b975,.dayIsToday_3822b975:hover{background-color:Highlight;-ms-high-contrast-adjust:none}}.dayIsToday_3822b975:hover,.dayIsToday_3822b975:hover:hover{border-radius:100%}.dayIsDisabled_3822b975:before{border-top-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.dayIsUnfocused_3822b975{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-weight:400}.dayIsFocused_3822b975:hover,.dayIsUnfocused_3822b975:hover{cursor:pointer;background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.daySelection_3822b975.dayIsHighlighted_3822b975:hover,.pickerIsFocused_3822b975 .dayIsHighlighted_3822b975.daySelection_3822b975{cursor:pointer;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-radius:2px}@media screen and (-ms-high-contrast:active){.daySelection_3822b975.dayIsHighlighted_3822b975:hover,.pickerIsFocused_3822b975 .dayIsHighlighted_3822b975.daySelection_3822b975{outline:2px solid Highlight}.daySelection_3822b975.dayIsHighlighted_3822b975:hover :not(.dayIsToday_3822b975) span,.pickerIsFocused_3822b975 .dayIsHighlighted_3822b975.daySelection_3822b975 :not(.dayIsToday_3822b975) span{color:Highlight;-ms-high-contrast-adjust:none}}@media screen and (-ms-high-contrast:active){.dayIsHighlighted_3822b975 button.dayIsToday_3822b975{border-radius:100%}}@media screen and (-ms-high-contrast:active){.dayIsHighlighted_3822b975 button.dayIsToday_3822b975 span{color:Window;-ms-high-contrast-adjust:none}}.dayIsFocused_3822b975:active,.dayIsHighlighted_3822b975{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.dayIsFocused_3822b975:active.day_3822b975,.dayIsHighlighted_3822b975.day_3822b975{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.dayIsHighlighted_3822b975.dayDisabled_3822b975,.dayIsHighlighted_3822b975.dayDisabled_3822b975:hover{background:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.dayBackground_3822b975,.dayBackground_3822b975:active,.dayBackground_3822b975:hover{border-radius:2px}.dayHover_3822b975,.dayHover_3822b975:hover{cursor:pointer;background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.dayPress_3822b975,.dayPress_3822b975:hover{cursor:pointer;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.dayPress_3822b975 .dayIsToday_3822b975,.dayPress_3822b975:hover .dayIsToday_3822b975{background:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";border-radius:100%}.dayIsFocused_3822b975:active,.dayIsHighlighted_3822b975,.dayIsHighlighted_3822b975:active,.dayIsHighlighted_3822b975:hover,.dayIsUnfocused_3822b975:active,.weekBackground_3822b975,.weekBackground_3822b975:active,.weekBackground_3822b975:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.dayIsToday_3822b975,.dayIsToday_3822b975.day_3822b975:active,.pickerIsFocused_3822b975 .dayIsToday_3822b975{position:relative;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-weight:600;background:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";border-radius:100%}@media screen and (-ms-high-contrast:active){.dayIsToday_3822b975,.dayIsToday_3822b975.day_3822b975:active,.pickerIsFocused_3822b975 .dayIsToday_3822b975{background-color:Highlight;color:HighlightText;-ms-high-contrast-adjust:none}}.showWeekNumbers_3822b975 .weekNumbers_3822b975{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";-webkit-box-sizing:border-box;box-sizing:border-box;width:28px;padding:0}.showWeekNumbers_3822b975 .weekNumbers_3822b975 .dayWrapper_3822b975{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.showWeekNumbers_3822b975 .weekNumbers_3822b975 .dayWrapper_3822b975.weekIsHighlighted_3822b975{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.showWeekNumbers_3822b975 .table_3822b975{width:225px}.showWeekNumbers_3822b975 .table_3822b975 .dayWrapper_3822b975,.showWeekNumbers_3822b975 .table_3822b975 .weekday_3822b975{width:30px}.showWeekNumbersRTL_3822b975 .weekNumbers_3822b975{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";-webkit-box-sizing:border-box;box-sizing:border-box}.showWeekNumbersRTL_3822b975 .weekNumbers_3822b975 .dayWrapper_3822b975{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.showWeekNumbersRTL_3822b975 .weekNumbers_3822b975 .dayWrapper_3822b975.weekIsHighlighted_3822b975{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.showWeekNumbersRTL_3822b975 .table_3822b975{width:225px}.showWeekNumbersRTL_3822b975 .table_3822b975 .dayWrapper_3822b975,.showWeekNumbersRTL_3822b975 .table_3822b975 .weekday_3822b975{width:30px}.decadeComponents_3822b975,.monthComponents_3822b975,.yearComponents_3822b975{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-ms-flex-item-align:end;align-self:flex-end}.closeButton_3822b975,.nextDecade_3822b975,.nextMonth_3822b975,.nextYear_3822b975,.prevDecade_3822b975,.prevMonth_3822b975,.prevYear_3822b975{font-family:inherit;width:28px;height:28px;display:block;text-align:center;line-height:28px;text-align:center;font-size:12px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";border-radius:2px;position:relative;background-color:transparent;border:none;padding:0}.closeButton_3822b975:hover,.nextDecade_3822b975:hover,.nextMonth_3822b975:hover,.nextYear_3822b975:hover,.prevDecade_3822b975:hover,.prevMonth_3822b975:hover,.prevYear_3822b975:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";cursor:pointer;outline:1px solid transparent}.nextDecadeIsDisabled_3822b975,.nextMonthIsDisabled_3822b975,.nextYearIsDisabled_3822b975,.prevDecadeIsDisabled_3822b975,.prevMonthIsDisabled_3822b975,.prevYearIsDisabled_3822b975{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";pointer-events:none}.headerToggleView_3822b975{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:4px 8px}.headerToggleView_3822b975:hover{color:"},{theme:"black",defaultValue:"#000000"},{rawString:";cursor:pointer}@media screen and (-ms-high-contrast:active){.headerToggleView_3822b975:hover{outline:1px solid highlight}}@media screen and (-ms-high-contrast:active){.headerToggleView_3822b975:hover:active{color:highlight}}.currentDecade_3822b975,.currentYear_3822b975{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;padding:0 5px;font-size:14px;font-weight:400;font-weight:600;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";height:28px;line-height:28px}html[dir=ltr] .currentDecade_3822b975,html[dir=ltr] .currentYear_3822b975{margin-left:5px}html[dir=rtl] .currentDecade_3822b975,html[dir=rtl] .currentYear_3822b975{margin-right:5px}.optionGrid_3822b975{position:relative;height:210px;width:196px;margin:4px 0 0 0}html[dir=rtl] .optionGrid_3822b975{margin:4px 0 0 0}.monthOption_3822b975,.yearOption_3822b975{width:60px;height:60px;line-height:100%;cursor:pointer;margin:0 10px 10px 0;font-size:13px;font-weight:400;font-family:inherit;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";text-align:center;border:none;padding:0;background-color:transparent;border-radius:2px}html[dir=ltr] .monthOption_3822b975,html[dir=ltr] .yearOption_3822b975{float:left}html[dir=rtl] .monthOption_3822b975,html[dir=rtl] .yearOption_3822b975{float:right}html[dir=rtl] .monthOption_3822b975,html[dir=rtl] .yearOption_3822b975{margin:0 0 10px 10px}.monthOption_3822b975:hover,.yearOption_3822b975:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";outline:1px solid transparent}@media screen and (-ms-high-contrast:active){.monthOption_3822b975:hover,.yearOption_3822b975:hover{outline-color:highlight}}@media screen and (-ms-high-contrast:active){.monthOption_3822b975:active,.yearOption_3822b975:active{color:highlight}}.monthOption_3822b975.isHighlighted_3822b975,.yearOption_3822b975.isHighlighted_3822b975{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.dayIsDisabled_3822b975,.monthOptionIsDisabled_3822b975,.yearOptionIsDisabled_3822b975{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";pointer-events:none}.goToday_3822b975{bottom:0;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";cursor:pointer;font-size:12px;font-weight:400;font-family:inherit;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";height:30px;line-height:30px;padding:0 10px;background-color:transparent;border:none;position:absolute!important;-webkit-box-sizing:content-box;box-sizing:content-box}[dir=ltr] .goToday_3822b975{right:13px}[dir=rtl] .goToday_3822b975{left:13px}.goToday_3822b975:hover{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";outline:1px solid transparent}@media screen and (-ms-high-contrast:active){.goToday_3822b975:hover{outline-color:highlight}}.goToday_3822b975:active{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}@media screen and (-ms-high-contrast:active){.goToday_3822b975:active{color:highlight}}.goToTodayIsDisabled_3822b975{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";pointer-events:none}.goTodayInlineMonth_3822b975{top:212px}.wrap_3822b975.goTodaySpacing_3822b975{padding-bottom:28px}.root_3822b975.isPickingYears_3822b975 .dayPicker_3822b975,.root_3822b975.isPickingYears_3822b975 .monthComponents_3822b975{display:none}.root_3822b975.isPickingYears_3822b975 .monthPicker_3822b975{display:none}.root_3822b975.isPickingYears_3822b975 .yearPicker_3822b975{display:block}@media (min-device-width:460px){.wrap_3822b975{padding:12px}.dayPicker_3822b975,.monthPicker_3822b975{min-height:200px}.header_3822b975{height:28px;line-height:28px;width:100%}.dayWrapper_3822b975,.weekday_3822b975{width:28px;height:28px;line-height:28px;font-size:12px}.closeButton_3822b975,.nextDecade_3822b975,.nextMonth_3822b975,.nextYear_3822b975,.prevDecade_3822b975,.prevMonth_3822b975,.prevYear_3822b975{font-size:12px;width:28px;height:28px;line-height:28px}.holder_3822b975{display:inline-block;height:auto;overflow:hidden}.decade_3822b975,.monthAndYear_3822b975,.year_3822b975{font-size:14px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.yearComponents_3822b975{margin-left:1px}.goToday_3822b975{padding:0 3px}[dir=ltr] .goToday_3822b975{right:20px}[dir=rtl] .goToday_3822b975{left:20px}.showWeekNumbers_3822b975 .table_3822b975 .dayWrapper_3822b975,.showWeekNumbers_3822b975 .table_3822b975 .weekday_3822b975{width:28px}.showWeekNumbersRTL_3822b975 .table_3822b975 .dayWrapper_3822b975,.showWeekNumbersRTL_3822b975 .table_3822b975 .weekday_3822b975{width:28px}.monthPickerVisible_3822b975 .wrap_3822b975{padding:12px}.monthPickerVisible_3822b975 .dayPicker_3822b975{margin:-10px 0;padding:10px 0}.monthPickerVisible_3822b975 .dayPicker_3822b975{-webkit-box-sizing:border-box;box-sizing:border-box;width:212px;min-height:200px}.monthPickerVisible_3822b975 .monthPicker_3822b975{display:block}.monthPickerVisible_3822b975 .optionGrid_3822b975{height:150px;width:196px}.monthPickerVisible_3822b975 .toggleMonthView_3822b975{display:none}.monthPickerVisible_3822b975 .currentDecade_3822b975,.monthPickerVisible_3822b975 .currentYear_3822b975{font-size:14px;margin:0;height:28px;line-height:28px;display:inline-block}.monthPickerVisible_3822b975 .monthOption_3822b975,.monthPickerVisible_3822b975 .yearOption_3822b975{width:40px;height:40px;line-height:100%;font-size:12px;margin:0 12px 16px 0}html[dir=rtl] .monthPickerVisible_3822b975 .monthOption_3822b975,html[dir=rtl] .monthPickerVisible_3822b975 .yearOption_3822b975{margin:0 0 16px 12px}.monthPickerVisible_3822b975 .monthOption_3822b975:hover,.monthPickerVisible_3822b975 .yearOption_3822b975:hover{outline:1px solid transparent}.monthPickerVisible_3822b975 .monthOption_3822b975:nth-child(4n+4),.monthPickerVisible_3822b975 .yearOption_3822b975:nth-child(4n+4){margin:0 0 16px 0}html[dir=rtl] .monthPickerVisible_3822b975 .monthOption_3822b975:nth-child(4n+4),html[dir=rtl] .monthPickerVisible_3822b975 .yearOption_3822b975:nth-child(4n+4){margin:0 0 16px 0}.monthPickerVisible_3822b975 .goToday_3822b975{font-size:12px;height:28px;line-height:28px;padding:0 10px}[dir=ltr] .monthPickerVisible_3822b975 .goToday_3822b975{right:8px}[dir=rtl] .monthPickerVisible_3822b975 .goToday_3822b975{left:8px}html[dir=ltr] .monthPickerVisible_3822b975 .goToday_3822b975{text-align:right}html[dir=rtl] .monthPickerVisible_3822b975 .goToday_3822b975{text-align:left}.monthPickerVisible_3822b975 .root_3822b975.isPickingYears_3822b975 .dayPicker_3822b975,.monthPickerVisible_3822b975 .root_3822b975.isPickingYears_3822b975 .monthComponents_3822b975{display:block}.monthPickerVisible_3822b975 .root_3822b975.isPickingYears_3822b975 .monthPicker_3822b975{display:none}.monthPickerVisible_3822b975 .root_3822b975.isPickingYears_3822b975 .yearPicker_3822b975{display:block}.calendarsInline_3822b975 .wrap_3822b975{padding:12px}.calendarsInline_3822b975 .holder_3822b975{height:auto}html[dir=ltr] .calendarsInline_3822b975 .table_3822b975{margin-right:12px}html[dir=rtl] .calendarsInline_3822b975 .table_3822b975{margin-left:12px}.calendarsInline_3822b975 .dayPicker_3822b975{width:auto}html[dir=ltr] .calendarsInline_3822b975 .monthPicker_3822b975{margin-left:12px}html[dir=rtl] .calendarsInline_3822b975 .monthPicker_3822b975{margin-right:12px}html[dir=ltr] .calendarsInline_3822b975 .yearPicker_3822b975{margin-left:12px}html[dir=rtl] .calendarsInline_3822b975 .yearPicker_3822b975{margin-right:12px}.calendarsInline_3822b975 .goToday_3822b975{padding:0 10px}[dir=ltr] .calendarsInline_3822b975 .goToday_3822b975{right:14px}[dir=rtl] .calendarsInline_3822b975 .goToday_3822b975{left:14px}html[dir=ltr] .calendarsInline_3822b975 .monthComponents_3822b975{margin-right:12px}html[dir=rtl] .calendarsInline_3822b975 .monthComponents_3822b975{margin-left:12px}.monthPickerOnly_3822b975 .wrap_3822b975{padding:12px}.monthPickerAsOverlay_3822b975 .wrap_3822b975{padding-bottom:28px;margin-bottom:6px}.monthPickerAsOverlay_3822b975 .holder_3822b975{height:240px;min-height:240px}.monthPickerAsOverlay_3822b975 .holderWithButton_3822b975{padding-top:6px;height:auto}}@media (max-device-width:459px){.calendarsInline_3822b975 .monthPicker_3822b975,.calendarsInline_3822b975 .yearPicker_3822b975{display:none}.yearComponents_3822b975{margin-top:2px}}.goToday_3822b975{width:auto}.closeButton_3822b975,.nextDecade_3822b975,.nextMonth_3822b975,.nextYear_3822b975,.prevDecade_3822b975,.prevMonth_3822b975,.prevYear_3822b975{display:inline-block}.closeButton_3822b975:hover,.nextDecade_3822b975:hover,.nextMonth_3822b975:hover,.nextYear_3822b975:hover,.prevDecade_3822b975:hover,.prevMonth_3822b975:hover,.prevYear_3822b975:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}@media screen and (-ms-high-contrast:active){.closeButton_3822b975:hover,.nextDecade_3822b975:hover,.nextMonth_3822b975:hover,.nextYear_3822b975:hover,.prevDecade_3822b975:hover,.prevMonth_3822b975:hover,.prevYear_3822b975:hover{outline:1px solid Highlight}}.closeButton_3822b975:active,.nextDecade_3822b975:active,.nextMonth_3822b975:active,.nextYear_3822b975:active,.prevDecade_3822b975:active,.prevMonth_3822b975:active,.prevYear_3822b975:active{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}@media screen and (-ms-high-contrast:active){.closeButton_3822b975:active,.nextDecade_3822b975:active,.nextMonth_3822b975:active,.nextYear_3822b975:active,.prevDecade_3822b975:active,.prevMonth_3822b975:active,.prevYear_3822b975:active{color:highlight}}.monthIsHighlighted_3822b975{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.monthIsHighlighted_3822b975.monthOption_3822b975:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}@media screen and (-ms-high-contrast:active){.monthIsHighlighted_3822b975{color:highlight;border:2px solid highlight;border-radius:2px}.monthIsHighlighted_3822b975:hover{outline:0!important}}.monthIsCurrentMonth_3822b975{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.monthIsCurrentMonth_3822b975.monthOption_3822b975:hover{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.monthOption_3822b975:active{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.yearIsHighlighted_3822b975{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.yearIsHighlighted_3822b975.yearOption_3822b975:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.yearIsCurrentYear_3822b975{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.yearIsCurrentYear_3822b975.yearOption_3822b975:hover{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.yearOption_3822b975:active{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.topLeftCornerDate_3822b975{border-top-left-radius:2px}.topRightCornerDate_3822b975{border-top-right-radius:2px}.bottomLeftCornerDate_3822b975{border-bottom-left-radius:2px}.bottomRightCornerDate_3822b975{border-bottom-right-radius:2px}@media screen and (-ms-high-contrast:active){.weekBackground_3822b975{border-top:1px solid highlight;border-bottom:1px solid highlight}.weekBackground_3822b975.bottomRightCornerDate_3822b975.topRightCornerDate_3822b975{border-right:1px solid highlight;border-left:none;padding-left:1px}.weekBackground_3822b975.bottomLeftCornerDate_3822b975.topLeftCornerDate_3822b975{border-left:1px solid highlight;border-right:none;padding-right:1px}.weekBackground_3822b975 :not(.dayIsToday_3822b975) span{color:highlight}.weekSelection_3822b975.dayHover_3822b975{border-top:1px solid highlight;border-bottom:1px solid highlight}.weekSelection_3822b975.dayHover_3822b975.bottomLeftCornerDate_3822b975.topLeftCornerDate_3822b975{border-left:1px solid highlight;padding-right:1px}.weekSelection_3822b975.dayHover_3822b975.bottomRightCornerDate_3822b975.topRightCornerDate_3822b975{border-right:1px solid highlight;padding-left:1px}.weekSelection_3822b975.dayHover_3822b975.dayPress_3822b975 :not(.dayIsToday_3822b975) span{color:highlight}.monthSelection_3822b975.dayHover_3822b975.bottomLeftCornerDate_3822b975,.monthSelection_3822b975.dayHover_3822b975.topLeftCornerDate_3822b975{border-left:1px solid highlight;padding-right:1px}.monthSelection_3822b975.dayHover_3822b975.bottomRightCornerDate_3822b975,.monthSelection_3822b975.dayHover_3822b975.topRightCornerDate_3822b975{border-right:1px solid highlight;padding-left:1px}.monthSelection_3822b975.dayIsFocused_3822b975.dayHover_3822b975.topDate_3822b975,.monthSelection_3822b975.dayIsUnfocused_3822b975.dayHover_3822b975.topDate_3822b975{border-top:1px solid highlight;padding-bottom:1px}.monthSelection_3822b975.dayIsFocused_3822b975.dayHover_3822b975.rightDate_3822b975,.monthSelection_3822b975.dayIsUnfocused_3822b975.dayHover_3822b975.rightDate_3822b975{border-right:1px solid highlight;padding-left:1px}.monthSelection_3822b975.dayIsFocused_3822b975.dayHover_3822b975.bottomDate_3822b975,.monthSelection_3822b975.dayIsUnfocused_3822b975.dayHover_3822b975.bottomDate_3822b975{border-bottom:1px solid highlight;padding-top:1px}.monthSelection_3822b975.dayIsFocused_3822b975.dayHover_3822b975.leftdate_3822b975,.monthSelection_3822b975.dayIsUnfocused_3822b975.dayHover_3822b975.leftdate_3822b975{border-left:1px solid highlight;padding-right:1px}.monthSelection_3822b975.dayIsFocused_3822b975.dayHover_3822b975.dayPress_3822b975 :not(.dayIsToday_3822b975) span,.monthSelection_3822b975.dayIsUnfocused_3822b975.dayHover_3822b975.dayPress_3822b975 :not(.dayIsToday_3822b975) span{color:highlight}}"}]);var w="root_3822b975",E="picker_3822b975",S="holder_3822b975",x="pickerIsOpened_3822b975",T="frame_3822b975",N="wrap_3822b975",C="goTodaySpacing_3822b975",k="dayPicker_3822b975",L="header_3822b975",A="divider_3822b975",O="monthAndYear_3822b975",M="year_3822b975",_="decade_3822b975",D="currentYear_3822b975",P="currentDecade_3822b975",H="table_3822b975",B="dayWrapper_3822b975",j="weekday_3822b975",F="day_3822b975",I="daySelection_3822b975",q="dayIsToday_3822b975",R="dayIsDisabled_3822b975",U="dayIsUnfocused_3822b975",z="dayIsFocused_3822b975",W="dayIsHighlighted_3822b975",X="pickerIsFocused_3822b975",V="dayDisabled_3822b975",$="dayBackground_3822b975",J="dayHover_3822b975",K="dayPress_3822b975",Q="weekBackground_3822b975",G="showWeekNumbers_3822b975",Y="weekNumbers_3822b975",Z="weekIsHighlighted_3822b975",ee="showWeekNumbersRTL_3822b975",te="monthComponents_3822b975",ne="yearComponents_3822b975",re="decadeComponents_3822b975",ie="closeButton_3822b975",se="prevMonth_3822b975",oe="nextMonth_3822b975",ue="prevYear_3822b975",ae="nextYear_3822b975",fe="prevDecade_3822b975",le="nextDecade_3822b975",ce="prevMonthIsDisabled_3822b975",he="nextMonthIsDisabled_3822b975",pe="prevYearIsDisabled_3822b975",de="nextYearIsDisabled_3822b975",ve="prevDecadeIsDisabled_3822b975",me="nextDecadeIsDisabled_3822b975",ge="headerToggleView_3822b975",ye="optionGrid_3822b975",be="monthOption_3822b975",we="yearOption_3822b975",Ee="isHighlighted_3822b975",Se="monthOptionIsDisabled_3822b975",xe="yearOptionIsDisabled_3822b975",Te="goToday_3822b975",Ne="goToTodayIsDisabled_3822b975",Ce="goTodayInlineMonth_3822b975",ke="isPickingYears_3822b975",Le="monthPicker_3822b975",Ae="yearPicker_3822b975",Oe="monthPickerVisible_3822b975",Me="toggleMonthView_3822b975",_e="calendarsInline_3822b975",De="monthPickerOnly_3822b975",Pe="monthPickerAsOverlay_3822b975",He="holderWithButton_3822b975",Be="monthIsHighlighted_3822b975",je="monthIsCurrentMonth_3822b975",Fe="yearIsHighlighted_3822b975",Ie="yearIsCurrentYear_3822b975",qe="topLeftCornerDate_3822b975",Re="topRightCornerDate_3822b975",Ue="bottomLeftCornerDate_3822b975",ze="bottomRightCornerDate_3822b975",We="weekSelection_3822b975",Xe="monthSelection_3822b975",Ve="topDate_3822b975",$e="rightDate_3822b975",Je="bottomDate_3822b975",Ke="leftdate_3822b975",Qe=r,Ge=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;n.days={};n._onKeyDown=function(e,t){t.which!==u.e.enter&&t.which!==u.e.space||e()};n._onDayKeyDown=function(e,t,r){return function(i){if(i.which===u.e.enter){n._onSelectDate(e,i);i.preventDefault()}else n._navigateMonthEdge(i,e,t,r)}};n._onDayMouseDown=function(e,t,r,i){return function(r){i===o.e.Month?n._applyFunctionToDayRefs(function(t,n){t&&n.originalDate.getMonth()===e.getMonth()&&n.isInBounds&&t.classList.add(Qe.dayPress)}):n._applyFunctionToDayRefs(function(e,n,r){if(e&&r===t&&n.isInBounds){e.classList.add(Qe.dayPress);e.classList.add(Qe.dayIsHighlighted)}else e&&e.classList.remove(Qe.dayIsHighlighted)})}};n._onDayMouseUp=function(e,t,r,i){return function(r){i===o.e.Month?n._applyFunctionToDayRefs(function(t,n){t&&n.originalDate.getMonth()===e.getMonth()&&n.isInBounds&&t.classList.remove(Qe.dayPress)}):n._applyFunctionToDayRefs(function(e,n,r){e&&r===t&&n.isInBounds&&e.classList.remove(Qe.dayPress)})}};n._onDayMouseOver=function(e,t,r,i){return function(r){i===o.e.Month?n._applyFunctionToDayRefs(function(t,n){t&&n.originalDate.getMonth()===e.getMonth()&&n.isInBounds&&t.classList.add(Qe.dayHover)}):n._applyFunctionToDayRefs(function(e,n,r){e&&r===t&&n.isInBounds&&e.classList.add(Qe.dayHover)})}};n._onDayMouseLeave=function(e,t,r,i){return function(r){i===o.e.Month?n._applyFunctionToDayRefs(function(t,n){t&&n.originalDate.getMonth()===e.getMonth()&&n.isInBounds&&t.classList.remove(Qe.dayHover)}):n._applyFunctionToDayRefs(function(e,n,r){e&&r===t&&n.isInBounds&&e.classList.remove(Qe.dayHover)})}};n._onTableMouseLeave=function(e){e.target.contains&&e.relatedTarget&&e.relatedTarget.contains&&e.target.contains(e.relatedTarget)||n._applyFunctionToDayRefs(function(e,t){if(e){e.classList.remove(Qe.dayHover);e.classList.remove(Qe.dayPress)}})};n._onTableMouseUp=function(e){e.target.contains&&e.relatedTarget&&e.relatedTarget.contains&&e.target.contains(e.relatedTarget)||n._applyFunctionToDayRefs(function(e,t){e&&e.classList.remove(Qe.dayPress)})};n._onSelectDate=function(e,t){var r=n.props,i=r.onSelectDate,s=r.dateRangeType,u=r.firstDayOfWeek,a=r.navigatedDate,f=r.autoNavigateOnSelection,l=r.minDate,c=r.maxDate,h=r.workWeekDays;t&&t.stopPropagation();var p=Object(y.o)(e,s,u,h);s!==o.e.Day&&(p=n._getBoundedDateRange(p,l,c));p=p.filter(function(e){return!n._getIsRestrictedDate(e)});i&&i(e,p);if(f&&e.getMonth()!==a.getMonth()){var d=Object(y.i)(e,a);d<0?n._onSelectPrevMonth():d>0&&n._onSelectNextMonth()}};n._onSelectNextMonth=function(){n.props.onNavigateDate(Object(y.t)(n.props.navigatedDate,1),!1)};n._onSelectPrevMonth=function(){n.props.onNavigateDate(Object(y.t)(n.props.navigatedDate,-1),!1)};n._onClose=function(){n.props.onDismiss&&n.props.onDismiss()};n._onHeaderSelect=function(){var e=n.props.onHeaderSelect;e&&e(!0)};n._onHeaderKeyDown=function(e){var t=n.props.onHeaderSelect;!t||e.which!==u.e.enter&&e.which!==u.e.space||t(!0)};n._onPrevMonthKeyDown=function(e){e.which===u.e.enter&&n._onKeyDown(n._onSelectPrevMonth,e)};n._onNextMonthKeyDown=function(e){e.which===u.e.enter&&n._onKeyDown(n._onSelectNextMonth,e)};n._onCloseButtonKeyDown=function(e){e.which===u.e.enter&&n._onKeyDown(n._onClose,e)};Object(a.e)(n);n.state={activeDescendantId:Object(f.e)("DatePickerDay-active"),weeks:n._getWeeks(t)};n._onSelectNextMonth=n._onSelectNextMonth.bind(n);n._onSelectPrevMonth=n._onSelectPrevMonth.bind(n);n._onClose=n._onClose.bind(n);return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({weeks:this._getWeeks(e)})};t.prototype.render=function(){var e,t,n=this,r=this.state,i=r.activeDescendantId,u=r.weeks,a=this.props,h=a.firstDayOfWeek,p=a.strings,v=a.navigatedDate,b=a.selectedDate,w=a.dateRangeType,E=a.navigationIcons,S=a.showWeekNumbers,x=a.firstWeekOfYear,T=a.dateTimeFormatter,N=a.minDate,C=a.maxDate,k=a.showCloseButton,L=a.allFocusable,A=Object(f.e)("DatePickerDay-dayPicker"),O=Object(f.e)("DatePickerDay-monthAndYear"),M=E.leftNavigation,_=E.rightNavigation,D=E.closeIcon,P=S?Object(y.l)(u.length,h,x,v):null,H=S?Object(y.f)(b,h,x):void 0,B=this._getWeekCornerStyles(u,w),j=!N||Object(y.i)(N,Object(y.a)(v))<0,F=!C||Object(y.i)(Object(y.u)(v),C)<0;return s.createElement("div",{className:Object(l.e)("ms-DatePicker-dayPicker",Qe.dayPicker,S&&(Object(c.e)()?Qe.showWeekNumbersRTL:Qe.showWeekNumbers)),id:A},s.createElement("div",{className:Object(l.e)("ms-DatePicker-header",Qe.header)},s.createElement("div",{"aria-live":"polite","aria-relevant":"text","aria-atomic":"true",id:O,className:Qe.monthAndYear},this.props.onHeaderSelect?s.createElement("div",{className:Object(l.e)("ms-DatePicker-monthAndYear js-showMonthPicker",Qe.headerToggleView),onClick:this._onHeaderSelect,onKeyDown:this._onHeaderKeyDown,"aria-label":T.formatMonthYear(v,p),role:"button",tabIndex:0},T.formatMonthYear(v,p)):s.createElement("div",{className:Object(l.e)("ms-DatePicker-monthAndYear",Qe.monthAndYear)},T.formatMonthYear(v,p))),s.createElement("div",{className:Object(l.e)("ms-DatePicker-monthComponents",Qe.monthComponents)},s.createElement("div",{className:Object(l.e)("ms-DatePicker-navContainer",Qe.navContainer)},s.createElement("button",{className:Object(l.e)("ms-DatePicker-prevMonth js-prevMonth",Qe.prevMonth,(e={},e["ms-DatePicker-prevMonth--disabled "+Qe.prevMonthIsDisabled]=!j,e)),disabled:!L&&!j,"aria-disabled":!j,onClick:j?this._onSelectPrevMonth:void 0,onKeyDown:j?this._onPrevMonthKeyDown:void 0,"aria-controls":A,title:p.prevMonthAriaLabel?p.prevMonthAriaLabel+" "+p.months[Object(y.t)(v,-1).getMonth()]:void 0,role:"button",type:"button"},s.createElement(g.e,{iconName:M})),s.createElement("button",{className:Object(l.e)("ms-DatePicker-nextMonth js-nextMonth",Qe.nextMonth,(t={},t["ms-DatePicker-nextMonth--disabled "+Qe.nextMonthIsDisabled]=!F,t)),disabled:!L&&!F,"aria-disabled":!F,onClick:F?this._onSelectNextMonth:void 0,onKeyDown:F?this._onNextMonthKeyDown:void 0,"aria-controls":A,title:p.nextMonthAriaLabel?p.nextMonthAriaLabel+" "+p.months[Object(y.t)(v,1).getMonth()]:void 0,role:"button",type:"button"},s.createElement(g.e,{iconName:_})),k&&s.createElement("button",{className:Object(l.e)("ms-DatePicker-closeButton js-closeButton",Qe.closeButton),onClick:this._onClose,onKeyDown:this._onCloseButtonKeyDown,title:p.closeButtonAriaLabel,role:"button",type:"button"},s.createElement(g.e,{iconName:D}))))),s.createElement(m.e,null,s.createElement("table",{className:Object(l.e)("ms-DatePicker-table",Qe.table),"aria-readonly":"true","aria-multiselectable":"false","aria-labelledby":O,"aria-activedescendant":i,role:"grid"},s.createElement("thead",null,s.createElement("tr",null,S&&s.createElement("th",{className:Object(l.e)("ms-DatePicker-weekday",Qe.weekday)}),p.shortDays.map(function(e,t){return s.createElement("th",{className:Object(l.e)("ms-DatePicker-weekday",Qe.weekday),role:"columnheader",scope:"col",key:t,title:p.days[(t+h)%7],"aria-label":p.days[(t+h)%7],"data-is-focusable":!!L||void 0},p.shortDays[(t+h)%7])}))),s.createElement("tbody",{onMouseLeave:w!==o.e.Day?this._onTableMouseLeave:void 0,onMouseUp:w!==o.e.Day?this._onTableMouseUp:void 0},u.map(function(e,t){var r;return s.createElement("tr",{key:P?P[t]:t},S&&P&&s.createElement("th",{className:Object(l.e)("ms-DatePicker-weekNumbers","ms-DatePicker-weekday",Qe.weekday,Qe.weekNumbers),key:t,title:P&&p.weekNumberFormatString&&d(p.weekNumberFormatString,P[t]),"aria-label":P&&p.weekNumberFormatString&&d(p.weekNumberFormatString,P[t]),scope:"row"},s.createElement("div",{className:Object(l.e)("ms-DatePicker-day",Qe.day,(r={},r["ms-DatePicker-week--highlighted "+Qe.weekIsHighlighted]=H===P[t],r))},s.createElement("span",null,P[t]))),e.map(function(e,r){var u,a,f=Object(y.s)(v,e.originalDate);return s.createElement("td",{key:e.key,onClick:e.isInBounds?e.onSelected:void 0,className:Object(l.e)(Qe.dayWrapper,"ms-DatePicker-day",n._getHighlightedCornerStyle(B,r,t),(u={},u["ms-DatePicker-weekBackground "+Qe.weekBackground]=e.isSelected&&(w===o.e.Week||w===o.e.WorkWeek),u["ms-DatePicker-dayBackground "+Qe.dayBackground]=w===o.e.Day,u["ms-DatePicker-day--highlighted "+Qe.dayIsHighlighted]=e.isSelected&&w===o.e.Day,u["ms-DatePicker-day--infocus "+Qe.dayIsFocused]=e.isInBounds&&e.isInMonth,u["ms-DatePicker-day--outfocus "+Qe.dayIsUnfocused]=e.isInBounds&&!e.isInMonth,u[Qe.daySelection]=w===o.e.Day,u[Qe.weekSelection]=w===o.e.Week||w===o.e.WorkWeek,u[Qe.monthSelection]=w===o.e.Month,u)),ref:function(t){return n._setDayCellRef(t,e,f)},onMouseOver:w!==o.e.Day&&e.isInBounds?n._onDayMouseOver(e.originalDate,t,r,w):void 0,onMouseLeave:w!==o.e.Day&&e.isInBounds?n._onDayMouseLeave(e.originalDate,t,r,w):void 0,onMouseDown:w!==o.e.Day&&e.isInBounds?n._onDayMouseDown(e.originalDate,t,r,w):void 0,onMouseUp:w!==o.e.Day&&e.isInBounds?n._onDayMouseUp(e.originalDate,t,r,w):void 0,role:"presentation"},s.createElement("button",{key:e.key+"button",onClick:e.isInBounds?e.onSelected:void 0,className:Object(l.e)(Qe.day,"ms-DatePicker-day-button",(a={},a["ms-DatePicker-day--disabled "+Qe.dayIsDisabled]=!e.isInBounds,a["ms-DatePicker-day--today "+Qe.dayIsToday]=e.isToday,a)),onKeyDown:n._onDayKeyDown(e.originalDate,t,r),"aria-label":T.formatMonthDayYear(e.originalDate,p),id:f?i:void 0,"aria-readonly":!0,"aria-current":e.isToday?"date":void 0,"aria-selected":e.isInBounds?e.isSelected:void 0,"data-is-focusable":L||!!e.isInBounds||void 0,ref:function(t){return n._setDayRef(t,e,f)},disabled:!L&&!e.isInBounds,"aria-disabled":!e.isInBounds,type:"button",role:"gridcell"},s.createElement("span",{"aria-hidden":"true"},T.formatDay(e.originalDate))))}))})))))};t.prototype.focus=function(){if(this.navigatedDay){this.navigatedDay.tabIndex=0;this.navigatedDay.focus()}};t.prototype._setDayRef=function(e,t,n){n&&(this.navigatedDay=e)};t.prototype._setDayCellRef=function(e,t,n){this.days[t.key]=e};t.prototype._getWeekCornerStyles=function(e,t){var n=this,r={};switch(t){case o.e.Month:e.forEach(function(t,n){t.forEach(function(t,i){var s=e[n-1]&&e[n-1][i]&&e[n-1][i].originalDate.getMonth()===e[n][i].originalDate.getMonth(),o=e[n+1]&&e[n+1][i]&&e[n+1][i].originalDate.getMonth()===e[n][i].originalDate.getMonth(),u=e[n][i-1]&&e[n][i-1].originalDate.getMonth()===e[n][i].originalDate.getMonth(),a=e[n][i+1]&&e[n][i+1].originalDate.getMonth()===e[n][i].originalDate.getMonth(),f=!s&&!a,l=!o&&!u,h=!o&&!a,p="";!s&&!u&&(p=Object(c.e)()?p.concat(Qe.topRightCornerDate+" "):p.concat(Qe.topLeftCornerDate+" "));f&&(p=Object(c.e)()?p.concat(Qe.topLeftCornerDate+" "):p.concat(Qe.topRightCornerDate+" "));l&&(p=Object(c.e)()?p.concat(Qe.bottomRightCornerDate+" "):p.concat(Qe.bottomLeftCornerDate+" "));h&&(p=Object(c.e)()?p.concat(Qe.bottomLeftCornerDate+" "):p.concat(Qe.bottomRightCornerDate+" "));s||(p=p.concat(Qe.topDate+" "));o||(p=p.concat(Qe.bottomDate+" "));a||(p=p.concat(Qe.rightDate+" "));u||(p=p.concat(Qe.leftdate+" "));r[n+"_"+i]=p})});break;case o.e.Week:case o.e.WorkWeek:e.forEach(function(e,t){var i=Object(v.r)(e,function(e){return e.isInBounds}),s=n._findLastIndex(e,function(e){return e.isInBounds}),o=Qe.topLeftCornerDate+" "+Qe.bottomLeftCornerDate,u=Qe.topRightCornerDate+" "+Qe.bottomRightCornerDate;r[t+"_"+i]=Object(c.e)()?u:o;r[t+"_"+s]=Object(c.e)()?o:u})}return r};t.prototype._getHighlightedCornerStyle=function(e,t,n){return e[n+"_"+t]?e[n+"_"+t]:""};t.prototype._navigateMonthEdge=function(e,t,n,r){var i=this.props,s=i.minDate,o=i.maxDate,a=void 0;0===n&&e.which===u.e.up?a=Object(y.n)(t,-1):n===this.state.weeks.length-1&&e.which===u.e.down?a=Object(y.n)(t,1):0===r&&e.which===Object(c.t)(u.e.left)?a=Object(y.e)(t,-1):6===r&&e.which===Object(c.t)(u.e.right)&&(a=Object(y.e)(t,1));if(a&&(!s||Object(y.i)(s,a)<1)&&(!o||Object(y.i)(a,o)<1)){this.props.onNavigateDate(a,!0);e.preventDefault()}};t.prototype._applyFunctionToDayRefs=function(e){var t=this;this.state.weeks&&this.state.weeks.forEach(function(n,r){n.forEach(function(n){var i=t.days[n.key];e(i,n,r)})})};t.prototype._getWeeks=function(e){for(var t=e.navigatedDate,n=e.selectedDate,r=e.dateRangeType,i=e.firstDayOfWeek,s=e.today,u=e.minDate,a=e.maxDate,f=e.showSixWeeksByDefault,l=e.workWeekDays,c=new Date(t.getFullYear(),t.getMonth(),1),h=s||new Date,p=[];c.getDay()!==i;)c.setDate(c.getDate()-1);var d=!1,v=r===o.e.WorkWeek?o.e.Week:r,m=Object(y.o)(n,v,i,l);r!==o.e.Day&&(m=this._getBoundedDateRange(m,u,a));for(var g=!0,b=0;g;b++){var w=[];d=!0;for(var E=0;E<7;E++){var S=new Date(c),x={key:c.toString(),date:c.getDate().toString(),originalDate:S,isInMonth:c.getMonth()===t.getMonth(),isToday:Object(y.s)(h,c),isSelected:Object(y.p)(c,m),onSelected:this._onSelectDate.bind(this,S),isInBounds:(!u||Object(y.i)(u,c)<1)&&(!a||Object(y.i)(c,a)<1)&&!this._getIsRestrictedDate(c)};w.push(x);x.isInMonth&&(d=!1);c.setDate(c.getDate()+1)}(g=f?!d||b<=5:!d)&&p.push(w)}return p};t.prototype._getIsRestrictedDate=function(e){var t=this.props.restrictedDates;return!!t&&!!Object(v.n)(t,function(t){return Object(y.s)(t,e)})};t.prototype._getBoundedDateRange=function(e,t,n){var r=Object(i.o)(e);t&&(r=r.filter(function(e){return Object(y.i)(e,t)>=0}));n&&(r=r.filter(function(e){return Object(y.i)(e,n)<=0}));return r};t.prototype._findLastIndex=function(e,t){for(var n=e.length-1;n>=0;n--){if(t(e[n]))return n}return-1};return t})(s.Component),Ye=r,Ze={prevRangeAriaLabel:void 0,nextRangeAriaLabel:void 0},et={leftNavigation:"Up",rightNavigation:"Down",closeIcon:"CalculatorMultiply"},tt=(function(e){Object(i.r)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._buttonRef=s.createRef();t._onRenderYear=function(){var e=t.props,n=e.year,r=e.onRenderYear;return r?r(n):n};t._onClick=function(){t.props.onSelectYear&&t.props.onSelectYear(t.props.year)};t._onKeyDown=function(e){t.props.onSelectYear&&e.which===u.e.enter&&t.props.onSelectYear(t.props.year)};return t}t.prototype.focus=function(){this._buttonRef.current&&this._buttonRef.current.focus()};t.prototype.render=function(){var e,t=this.props,n=t.year,r=t.selected,i=t.disabled,o=t.onSelectYear;return s.createElement("button",{className:Object(l.e)("ms-DatePicker-yearOption",Ye.yearOption,(e={},e["ms-DatePicker-day--highlighted "+Ye.yearIsHighlighted]=r,e["ms-DatePicker-yearOption--disabled "+Ye.yearOptionIsDisabled]=i,e)),type:"button",role:"gridcell",onClick:!i&&o?this._onClick:void 0,onKeyDown:!i&&o?this._onKeyDown:void 0,disabled:i,"aria-label":String(n),"aria-selected":r,ref:this._buttonRef},this._onRenderYear())};return t})(s.Component),nt=(function(e){Object(i.r)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._selectedCellRef=s.createRef();t._currentCellRef=s.createRef();t._renderCell=function(e){var n=e===t.props.selectedYear,r=t.props,i=r.minYear,o=r.maxYear,u=r.onSelectYear,a=void 0!==i&&e<i||void 0!==o&&e>o,f=e===(new Date).getFullYear();return s.createElement(tt,{key:e,year:e,selected:n,current:f,disabled:a,onSelectYear:u,ref:n?t._selectedCellRef:f?t._currentCellRef:void 0})};return t}t.prototype.focus=function(){this._selectedCellRef.current?this._selectedCellRef.current.focus():this._currentCellRef.current&&this._currentCellRef.current.focus()};t.prototype.render=function(){for(var e=this.props,t=e.fromYear,n=e.toYear,r=t,i=[];r<=n;){i.push(this._renderCell(r));r++}return s.createElement(m.e,null,s.createElement("div",{className:Object(l.e)("ms-DatePicker-optionGrid",Ye.optionGrid),role:"grid"},s.createElement("div",{role:"row"},i)))};return t})(s.Component),rt=(function(e){Object(i.r)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onSelectPrev=function(){!t.isDisabled&&t.props.onSelectPrev&&t.props.onSelectPrev()};t._onKeyDown=function(e){e.which===u.e.enter&&t._onSelectPrev()};return t}t.prototype.render=function(){var e,t=this.props.navigationIcons||et,n=(this.props.strings||Ze).prevRangeAriaLabel,r={fromYear:this.props.fromYear-12,toYear:this.props.toYear-12},i=n?"string"==typeof n?n:n(r):void 0,o=this.isDisabled,u=this.props.onSelectPrev;return s.createElement("button",{className:Object(l.e)("ms-DatePicker-prevDecade",Ye.prevDecade,(e={},e["ms-DatePicker-prevDecade--disabled "+Ye.prevDecadeIsDisabled]=o,e)),onClick:!o&&u?this._onSelectPrev:void 0,onKeyDown:!o&&u?this._onKeyDown:void 0,type:"button",tabIndex:0,title:i,disabled:o},s.createElement(g.e,{iconName:Object(c.e)()?t.rightNavigation:t.leftNavigation}))};Object.defineProperty(t.prototype,"isDisabled",{get:function(){var e=this.props.minYear;return void 0!==e&&this.props.fromYear<e},enumerable:!0,configurable:!0});return t})(s.Component),it=(function(e){Object(i.r)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onSelectNext=function(){!t.isDisabled&&t.props.onSelectNext&&t.props.onSelectNext()};t._onKeyDown=function(e){e.which===u.e.enter&&t._onSelectNext()};return t}t.prototype.render=function(){var e,t=this.props.navigationIcons||et,n=(this.props.strings||Ze).nextRangeAriaLabel,r={fromYear:this.props.fromYear+12,toYear:this.props.toYear+12},i=n?"string"==typeof n?n:n(r):void 0,o=this.props.onSelectNext,u=this.isDisabled;return s.createElement("button",{className:Object(l.e)("ms-DatePicker-nextDecade",Ye.nextDecade,(e={},e["ms-DatePicker-nextDecade--disabled "+Ye.nextDecadeIsDisabled]=u,e)),onClick:!u&&o?this._onSelectNext:void 0,onKeyDown:!u&&o?this._onKeyDown:void 0,type:"button",tabIndex:0,title:i,disabled:this.isDisabled},s.createElement(g.e,{iconName:Object(c.e)()?t.leftNavigation:t.rightNavigation}))};Object.defineProperty(t.prototype,"isDisabled",{get:function(){var e=this.props.maxYear;return void 0!==e&&this.props.fromYear+12>e},enumerable:!0,configurable:!0});return t})(s.Component),st=(function(e){Object(i.r)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return s.createElement("div",{className:Object(l.e)("ms-DatePicker-decadeComponents",Ye.decadeComponents)},s.createElement("div",{className:Object(l.e)("ms-DatePicker-navContainer",Ye.navContainer)},s.createElement(rt,Object(i.e)({},this.props)),s.createElement(it,Object(i.e)({},this.props))))};return t})(s.Component),ot=(function(e){Object(i.r)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onHeaderSelect=function(){t.props.onHeaderSelect&&t.props.onHeaderSelect(!0)};t._onHeaderKeyDown=function(e){!t.props.onHeaderSelect||e.which!==u.e.enter&&e.which!==u.e.space||t.props.onHeaderSelect(!0)};t._onRenderYear=function(e){return t.props.onRenderYear?t.props.onRenderYear(e):e};return t}t.prototype.render=function(){var e=this.props,t=e.fromYear,n=e.toYear;if(e.onHeaderSelect){var r=this.props.strings||Ze,i=r.rangeAriaLabel,o=i?"string"==typeof i?i:i(this.props):void 0,u=r.headerAriaLabelFormatString?d(r.headerAriaLabelFormatString,o):o;return s.createElement("div",{className:Object(l.e)("ms-DatePicker-currentDecade js-showYearPicker",Ye.currentDecade,Ye.headerToggleView),onClick:this._onHeaderSelect,onKeyDown:this._onHeaderKeyDown,"aria-label":u,role:"button","aria-atomic":!0,"aria-live":"polite",tabIndex:0},this._onRenderYear(t)," - ",this._onRenderYear(n))}return s.createElement("div",{className:Object(l.e)("ms-DatePicker-currentDecade js-showYearPicker",Ye.currentDecade)},this._onRenderYear(t)," - ",this._onRenderYear(n))};return t})(s.Component),ut=(function(e){Object(i.r)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onRenderTitle=function(){return t.props.onRenderTitle?t.props.onRenderTitle(t.props):s.createElement(ot,Object(i.e)({},t.props))};t._onRenderNav=function(){return s.createElement(st,Object(i.e)({},t.props))};return t}t.prototype.render=function(){return s.createElement("div",{className:Object(l.e)("ms-DatePicker-header",Ye.header)},this._onRenderTitle(),this._onRenderNav())};return t})(s.Component),at=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;n._gridRef=s.createRef();n._onNavNext=function(){n.setState({fromYear:n.state.fromYear+12})};n._onNavPrev=function(){n.setState({fromYear:n.state.fromYear-12})};n._renderHeader=function(){return s.createElement(ut,Object(i.e)({},n.props,{fromYear:n.state.fromYear,toYear:n.state.fromYear+12-1,onSelectPrev:n._onNavPrev,onSelectNext:n._onNavNext}))};n._renderGrid=function(){return s.createElement(nt,Object(i.e)({},n.props,{fromYear:n.state.fromYear,toYear:n.state.fromYear+12-1,ref:n._gridRef}))};n.state=n._calculateInitialStateFromProps(t);return n}t.prototype.focus=function(){this._gridRef.current&&this._gridRef.current.focus()};t.prototype.render=function(){return s.createElement("div",{className:Object(l.e)("ms-DatePicker-yearPicker",Ye.yearPicker)},this._renderHeader(),this._renderGrid())};t.prototype._calculateInitialStateFromProps=function(e){var t=e.selectedYear,n=e.navigatedYear,r=t||n||(new Date).getFullYear();return{fromYear:10*Math.floor(r/10),navigatedYear:n,selectedYear:t}};return t})(s.Component),ft=r,lt=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;n._navigatedMonthRef=s.createRef();n._onCalendarYearRef=function(e){n._calendarYearRef=e};n._onKeyDown=function(e,t){t.which===u.e.enter&&e()};n._onSelectYear=function(e){n._focusOnUpdate=!0;var t=n.props,r=t.navigatedDate,i=t.onNavigateDate,s=t.maxDate,o=t.minDate;if(r.getFullYear()!==e){var u=new Date(r.getTime());u.setFullYear(e);s&&u>s?u=Object(y.d)(u,s.getMonth()):o&&u<o&&(u=Object(y.d)(u,o.getMonth()));i(u,!0)}n.setState({isYearPickerVisible:!1})};n._yearToString=function(e){var t=n.props,r=t.navigatedDate,i=t.dateTimeFormatter;if(i){var s=new Date(r.getTime());s.setFullYear(e);return i.formatYear(s)}return String(e)};n._yearRangeToString=function(e){return n._yearToString(e.fromYear)+" - "+n._yearToString(e.toYear)};n._yearRangeToNextDecadeLabel=function(e){var t=n.props.strings;return t.nextYearRangeAriaLabel?t.nextYearRangeAriaLabel+" "+n._yearRangeToString(e):""};n._yearRangeToPrevDecadeLabel=function(e){var t=n.props.strings;return t.prevYearRangeAriaLabel?t.prevYearRangeAriaLabel+" "+n._yearRangeToString(e):""};n._onRenderYear=function(e){return n._yearToString(e)};n._onSelectNextYear=function(){var e=n.props,t=e.navigatedDate;(0,e.onNavigateDate)(Object(y.r)(t,1),!1)};n._onSelectNextYearKeyDown=function(e){e.which===u.e.enter&&n._onKeyDown(n._onSelectNextYear,e)};n._onSelectPrevYear=function(){var e=n.props,t=e.navigatedDate;(0,e.onNavigateDate)(Object(y.r)(t,-1),!1)};n._onSelectPrevYearKeyDown=function(e){e.which===u.e.enter&&n._onKeyDown(n._onSelectPrevYear,e)};n._onSelectMonthKeyDown=function(e){return function(t){return n._onKeyDown(function(){return n._onSelectMonth(e)},t)}};n._onSelectMonth=function(e){var t=n.props,r=t.navigatedDate,i=t.onNavigateDate,s=t.onHeaderSelect;s&&s(!0);i(Object(y.d)(r,e),!0)};n._onHeaderSelect=function(){var e=n.props,t=e.onHeaderSelect;if(e.yearPickerHidden)t&&t(!0);else{n._focusOnUpdate=!0;n.setState({isYearPickerVisible:!0})}};n._onYearPickerHeaderSelect=function(e){n._focusOnUpdate=e;n.setState({isYearPickerVisible:!1})};n._onHeaderKeyDown=function(e){!n._onHeaderSelect||e.which!==u.e.enter&&e.which!==u.e.space||n._onHeaderSelect()};Object(a.e)(n);n._selectMonthCallbacks=[];t.strings.shortMonths.forEach(function(e,t){n._selectMonthCallbacks[t]=n._onSelectMonth.bind(n,t)});n._isCurrentMonth=n._isCurrentMonth.bind(n);n._onSelectNextYear=n._onSelectNextYear.bind(n);n._onSelectPrevYear=n._onSelectPrevYear.bind(n);n._onSelectMonth=n._onSelectMonth.bind(n);n.state={isYearPickerVisible:!1};return n}t.prototype.componentDidUpdate=function(){if(this._focusOnUpdate){this.focus();this._focusOnUpdate=!1}};t.prototype.render=function(){var e,t,n=this,r=this.props,i=r.navigatedDate,o=r.selectedDate,u=r.strings,a=r.today,f=r.highlightCurrentMonth,h=r.highlightSelectedMonth,p=r.navigationIcons,v=r.dateTimeFormatter,b=r.minDate,w=r.maxDate,E=r.yearPickerHidden;if(this.state.isYearPickerVisible){var S=i?i.getFullYear():void 0;return s.createElement(at,{key:"calendarYear_"+(S&&S.toString()),minYear:b?b.getFullYear():void 0,maxYear:w?w.getFullYear():void 0,onSelectYear:this._onSelectYear,navigationIcons:p,onHeaderSelect:this._onYearPickerHeaderSelect,selectedYear:S,onRenderYear:this._onRenderYear,strings:{rangeAriaLabel:this._yearRangeToString,prevRangeAriaLabel:this._yearRangeToPrevDecadeLabel,nextRangeAriaLabel:this._yearRangeToNextDecadeLabel,headerAriaLabelFormatString:u.yearPickerHeaderAriaLabel},ref:this._onCalendarYearRef})}for(var x=[],T=0;T<u.shortMonths.length/4;T++)x.push(T);var N=p.leftNavigation,C=p.rightNavigation,k=!b||Object(y.i)(b,Object(y.h)(i))<0,L=!w||Object(y.i)(Object(y.c)(i),w)<0,A=v.formatYear(i),O=u.monthPickerHeaderAriaLabel?d(u.monthPickerHeaderAriaLabel,A):A;return s.createElement("div",{className:Object(l.e)("ms-DatePicker-monthPicker",ft.monthPicker)},s.createElement("div",{className:Object(l.e)("ms-DatePicker-header",ft.header)},this.props.onHeaderSelect||!E?s.createElement("div",{className:Object(l.e)("ms-DatePicker-currentYear js-showYearPicker",ft.currentYear,ft.headerToggleView),onClick:this._onHeaderSelect,onKeyDown:this._onHeaderKeyDown,"aria-label":O,role:"button","aria-atomic":!0,"aria-live":"polite",tabIndex:0},v.formatYear(i)):s.createElement("div",{className:Object(l.e)("ms-DatePicker-currentYear js-showYearPicker",ft.currentYear)},v.formatYear(i)),s.createElement("div",{className:Object(l.e)("ms-DatePicker-yearComponents",ft.yearComponents)},s.createElement("div",{className:Object(l.e)("ms-DatePicker-navContainer",ft.navContainer)},s.createElement("button",{className:Object(l.e)("ms-DatePicker-prevYear js-prevYear",ft.prevYear,(e={},e["ms-DatePicker-prevYear--disabled "+ft.prevYearIsDisabled]=!k,e)),disabled:!k,onClick:k?this._onSelectPrevYear:void 0,onKeyDown:k?this._onSelectPrevYearKeyDown:void 0,title:u.prevYearAriaLabel?u.prevYearAriaLabel+" "+v.formatYear(Object(y.r)(i,-1)):void 0,role:"button",type:"button"},s.createElement(g.e,{iconName:Object(c.e)()?C:N})),s.createElement("button",{className:Object(l.e)("ms-DatePicker-nextYear js-nextYear",ft.nextYear,(t={},t["ms-DatePicker-nextYear--disabled "+ft.nextYearIsDisabled]=!L,t)),disabled:!L,onClick:L?this._onSelectNextYear:void 0,onKeyDown:L?this._onSelectNextYearKeyDown:void 0,title:u.nextYearAriaLabel?u.nextYearAriaLabel+" "+v.formatYear(Object(y.r)(i,1)):void 0,role:"button",type:"button"},s.createElement(g.e,{iconName:Object(c.e)()?N:C}))))),s.createElement(m.e,null,s.createElement("div",{className:Object(l.e)("ms-DatePicker-optionGrid",ft.optionGrid),role:"grid","aria-readonly":"true"},x.map(function(e){var t=u.shortMonths.slice(4*e,4*(e+1));return s.createElement("div",{key:"monthRow_"+e,role:"row"},t.map(function(t,r){var c,p=4*e+r,d=Object(y.d)(i,p),m=n._isCurrentMonth(p,i.getFullYear(),a),g=i.getMonth()===p,E=o.getMonth()===p,S=o.getFullYear()===i.getFullYear(),x=(!b||Object(y.i)(b,Object(y.u)(d))<1)&&(!w||Object(y.i)(Object(y.a)(d),w)<1);return s.createElement("button",{role:"gridcell",className:Object(l.e)("ms-DatePicker-monthOption",ft.monthOption,(c={},c["ms-DatePicker-day--today "+ft.monthIsCurrentMonth]=f&&m,c["ms-DatePicker-day--highlighted "+ft.monthIsHighlighted]=(f||h)&&E&&S,c["ms-DatePicker-monthOption--disabled "+ft.monthOptionIsDisabled]=!x,c)),disabled:!x,key:p,onClick:x?n._selectMonthCallbacks[p]:void 0,onKeyDown:x?n._onSelectMonthKeyDown(p):void 0,"aria-label":v.formatMonthYear(d,u),"aria-selected":g,"data-is-focusable":!!x||void 0,ref:g?n._navigatedMonthRef:void 0,type:"button"},t)}))}))))};t.prototype.focus=function(){if(this._calendarYearRef)this._calendarYearRef.focus();else if(this._navigatedMonthRef.current){this._navigatedMonthRef.current.tabIndex=0;this._navigatedMonthRef.current.focus()}};t.prototype._isCurrentMonth=function(e,t,n){return n.getFullYear()===t&&n.getMonth()===e};return t})(s.Component),ct=n(991),ht=n(270),pt=n(1483),dt=r,vt={leftNavigation:"Up",rightNavigation:"Down",closeIcon:"CalculatorMultiply"},mt=[o.t.Monday,o.t.Tuesday,o.t.Wednesday,o.t.Thursday,o.t.Friday],gt={formatMonthDayYear:function(e,t){return t.months[e.getMonth()]+" "+e.getDate()+", "+e.getFullYear()},formatMonthYear:function(e,t){return t.months[e.getMonth()]+" "+e.getFullYear()},formatDay:function(e){return e.getDate().toString()},formatYear:function(e){return e.getFullYear().toString()}},yt=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;n._dayPicker=s.createRef();n._monthPicker=s.createRef();n._hasFocus=!1;n._onBlur=function(e){if(!Object(ct.e)(e.currentTarget,e.relatedTarget)){n._hasFocus=!1;n.props.onBlur&&n.props.onBlur(e)}};n._onFocus=function(e){if(!n._hasFocus){n._hasFocus=!0;n.props.onFocus&&n.props.onFocus(e)}};n._navigateDayPickerDay=function(e){n.setState({navigatedDayDate:e,navigatedMonthDate:e})};n._navigateMonthPickerDay=function(e){n.setState({navigatedMonthDate:e})};n._onNavigateDayDate=function(e,t){n._navigateDayPickerDay(e);n._focusOnUpdate=t};n._onNavigateMonthDate=function(e,t){if(t){!n.props.showMonthPickerAsOverlay&&!n.props.isDayPickerVisible&&n._onSelectDate(e);n._navigateDayPickerDay(e)}else{n._navigateMonthPickerDay(e);n._focusOnUpdate=t}};n._onSelectDate=function(e,t){var r=n.props.onSelectDate;n.setState({selectedDate:e});r&&r(e,t)};n._onHeaderSelect=function(e){n.setState({isDayPickerVisible:!n.state.isDayPickerVisible,isMonthPickerVisible:!n.state.isMonthPickerVisible});e&&(n._focusOnUpdate=!0)};n._onGotoToday=function(){var e=n.props,t=e.dateRangeType,r=e.firstDayOfWeek,i=e.today,s=e.workWeekDays;if(e.selectDateOnClick){var o=Object(y.o)(i,t,r,s);n._onSelectDate(i,o)}n._navigateDayPickerDay(i);n._focusOnUpdate=!0};n._onGotoTodayClick=function(e){n._onGotoToday()};n._onGotoTodayKeyDown=function(e){if(e.which===u.e.enter){e.preventDefault();n._onGotoToday()}};n._onDatePickerPopupKeyDown=function(e){switch(e.which){case u.e.enter:case u.e.backspace:e.preventDefault();break;case u.e.escape:n._handleEscKey(e)}};n._handleEscKey=function(e){n.props.onDismiss&&n.props.onDismiss()};Object(a.e)(n);var r=t.value&&!isNaN(t.value.getTime())?t.value:t.today||new Date;n.state={selectedDate:r,navigatedDayDate:r,navigatedMonthDate:r,isMonthPickerVisible:!n.props.showMonthPickerAsOverlay&&n.props.isMonthPickerVisible,isDayPickerVisible:!!n.props.showMonthPickerAsOverlay||n.props.isDayPickerVisible};n._focusOnUpdate=!1;return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.autoNavigateOnSelection,n=e.value,r=e.today,i=void 0===r?new Date:r;t&&!Object(y.s)(n,this.props.value)&&this.setState({navigatedMonthDate:n,navigatedDayDate:n});this.setState({selectedDate:n||i})};t.prototype.componentDidUpdate=function(){if(this._focusOnUpdate){this.focus();this._focusOnUpdate=!1}};t.prototype.render=function(){var e,t=this.props,n=t.firstDayOfWeek,r=t.dateRangeType,o=t.strings,u=t.showMonthPickerAsOverlay,a=t.autoNavigateOnSelection,f=t.showGoToToday,c=t.highlightCurrentMonth,h=t.highlightSelectedMonth,p=t.navigationIcons,d=t.minDate,v=t.maxDate,m=t.restrictedDates,g=t.className,y=t.showCloseButton,b=t.allFocusable,w=t.yearPickerHidden,E=t.today,S=Object(ht.u)(this.props,ht.s,["value"]),x=this.state,T=x.selectedDate,N=x.navigatedDayDate,C=x.navigatedMonthDate,k=x.isMonthPickerVisible,L=x.isDayPickerVisible,A=u?this._onHeaderSelect:void 0,O=!u&&!L,M=u&&f,_=f;_&&N&&C&&E&&(_=N.getFullYear()!==E.getFullYear()||N.getMonth()!==E.getMonth()||C.getFullYear()!==E.getFullYear()||C.getMonth()!==E.getMonth());return s.createElement("div",{className:Object(l.e)("ms-DatePicker",dt.root,g),role:"application"},s.createElement("div",Object(i.e)({},S,{onBlur:this._onBlur,onFocus:this._onFocus,className:Object(l.e)("ms-DatePicker-picker ms-DatePicker-picker--opened ms-DatePicker-picker--focused",dt.picker,dt.pickerIsOpened,dt.pickerIsFocused,k&&"ms-DatePicker-monthPickerVisible "+dt.monthPickerVisible,k&&L&&"ms-DatePicker-calendarsInline "+dt.calendarsInline,O&&"ms-DatePicker-monthPickerOnly "+dt.monthPickerOnly,u&&"ms-DatePicker-monthPickerAsOverlay "+dt.monthPickerAsOverlay)}),s.createElement("div",{className:Object(l.e)("ms-DatePicker-holder ms-slideDownIn10",dt.holder,M&&dt.holderWithButton),onKeyDown:this._onDatePickerPopupKeyDown},s.createElement("div",{className:Object(l.e)("ms-DatePicker-frame",dt.frame)},s.createElement("div",{className:Object(l.e)("ms-DatePicker-wrap",dt.wrap,f&&dt.goTodaySpacing)},L&&s.createElement(Ge,{selectedDate:T,navigatedDate:N,today:this.props.today,onSelectDate:this._onSelectDate,onNavigateDate:this._onNavigateDayDate,onDismiss:this.props.onDismiss,firstDayOfWeek:n,dateRangeType:r,autoNavigateOnSelection:a,strings:o,onHeaderSelect:A,navigationIcons:p,showWeekNumbers:this.props.showWeekNumbers,firstWeekOfYear:this.props.firstWeekOfYear,dateTimeFormatter:this.props.dateTimeFormatter,showSixWeeksByDefault:this.props.showSixWeeksByDefault,minDate:d,maxDate:v,restrictedDates:m,workWeekDays:this.props.workWeekDays,componentRef:this._dayPicker,showCloseButton:y,allFocusable:b}),L&&k&&s.createElement("div",{className:dt.divider}),k&&s.createElement(lt,{navigatedDate:C,selectedDate:N,strings:o,onNavigateDate:this._onNavigateMonthDate,today:this.props.today,highlightCurrentMonth:c,highlightSelectedMonth:h,onHeaderSelect:A,navigationIcons:p,dateTimeFormatter:this.props.dateTimeFormatter,minDate:d,maxDate:v,componentRef:this._monthPicker,yearPickerHidden:w||u}),f&&s.createElement("button",{role:"button",className:Object(l.e)("ms-DatePicker-goToday js-goToday",dt.goToday,(e={},e[dt.goTodayInlineMonth]=k,e[dt.goToTodayIsDisabled]=!_,e)),onClick:this._onGotoTodayClick,onKeyDown:this._onGotoTodayKeyDown,tabIndex:0,disabled:!_,type:"button"},o.goToToday))))),s.createElement(pt.e,null))};t.prototype.focus=function(){this.state.isDayPickerVisible&&this._dayPicker.current?this._dayPicker.current.focus():this.state.isMonthPickerVisible&&this._monthPicker.current&&this._monthPicker.current.focus()};t.defaultProps={onSelectDate:void 0,onDismiss:void 0,isMonthPickerVisible:!0,isDayPickerVisible:!0,showMonthPickerAsOverlay:!1,value:void 0,today:new Date,firstDayOfWeek:o.t.Sunday,dateRangeType:o.e.Day,autoNavigateOnSelection:!1,showGoToToday:!0,strings:null,highlightCurrentMonth:!1,highlightSelectedMonth:!1,navigationIcons:vt,showWeekNumbers:!1,firstWeekOfYear:o.n.FirstDay,dateTimeFormatter:gt,showSixWeeksByDefault:!1,workWeekDays:mt,showCloseButton:!1,allFocusable:!1};return t})(s.Component)},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"n",function(){return o});n.d(t,"t",function(){return u});n.d(t,"r",function(){return a});n.d(t,"a",function(){return f});n.d(t,"u",function(){return l});n.d(t,"h",function(){return c});n.d(t,"c",function(){return h});n.d(t,"d",function(){return p});n.d(t,"s",function(){return d});n.d(t,"i",function(){return v});n.d(t,"o",function(){return m});n.d(t,"p",function(){return g});n.d(t,"l",function(){return y});n.d(t,"f",function(){return b});var r=n(1991),i={MillisecondsInOneDay:864e5,MillisecondsIn1Sec:1e3,MillisecondsIn1Min:6e4,MillisecondsIn30Mins:18e5,MillisecondsIn1Hour:36e5,MinutesInOneDay:1440,MinutesInOneHour:60,DaysInOneWeek:7,MonthInOneYear:12};function s(e,t){var n=new Date(e.getTime());n.setDate(n.getDate()+t);return n}function o(e,t){return s(e,t*i.DaysInOneWeek)}function u(e,t){var n=new Date(e.getTime()),r=n.getMonth()+t;n.setMonth(r);n.getMonth()!==(r%i.MonthInOneYear+i.MonthInOneYear)%i.MonthInOneYear&&(n=s(n,-n.getDate()));return n}function a(e,t){var n=new Date(e.getTime());n.setFullYear(e.getFullYear()+t);n.getMonth()!==(e.getMonth()%i.MonthInOneYear+i.MonthInOneYear)%i.MonthInOneYear&&(n=s(n,-n.getDate()));return n}function f(e){return new Date(e.getFullYear(),e.getMonth(),1,0,0,0,0)}function l(e){return new Date(e.getFullYear(),e.getMonth()+1,0,0,0,0,0)}function c(e){return new Date(e.getFullYear(),0,1,0,0,0,0)}function h(e){return new Date(e.getFullYear()+1,0,0,0,0,0,0)}function p(e,t){return u(e,t-e.getMonth())}function d(e,t){return!e&&!t||!(!e||!t)&&(e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate())}function v(e,t){return E(e)-E(t)}function m(e,t,n,o,a){void 0===a&&(a=1);var f,l=new Array,c=null;o||(o=[r.t.Monday,r.t.Tuesday,r.t.Wednesday,r.t.Thursday,r.t.Friday]);a=Math.max(a,1);switch(t){case r.e.Day:c=s(f=w(e),a);break;case r.e.Week:case r.e.WorkWeek:f=(function(e,t){var n=t-e.getDay();n>0&&(n-=i.DaysInOneWeek);return s(e,n)})(w(e),n);c=s(f,i.DaysInOneWeek);break;case r.e.Month:c=u(f=new Date(e.getFullYear(),e.getMonth(),1),1);break;default:throw new Error("Unexpected object: "+t)}var h=f;do{(t!==r.e.WorkWeek||-1!==o.indexOf(h.getDay()))&&l.push(h);h=s(h,1)}while(!d(h,c));return l}function g(e,t){for(var n=0,r=t;n<r.length;n++){if(d(e,r[n]))return!0}return!1}function y(e,t,n,s){var o=s.getFullYear(),u=s.getMonth(),a=1,f=new Date(o,u,a),l=a+(t+i.DaysInOneWeek-1)-(function(e,t){return e!==r.t.Sunday&&t<e?t+i.DaysInOneWeek:t})(t,f.getDay()),c=new Date(o,u,l);a=c.getDate();for(var h=[],p=0;p<e;p++){h.push(b(c,t,n));a+=i.DaysInOneWeek;c=new Date(o,u,a)}return h}function b(e,t,n){switch(n){case r.n.FirstFullWeek:return S(e,t,i.DaysInOneWeek);case r.n.FirstFourDayWeek:return S(e,t,4);default:return(function(e,t){var n=x(e)-1,r=(e.getDay()-n%i.DaysInOneWeek-t+2*i.DaysInOneWeek)%i.DaysInOneWeek;return Math.floor((n+r)/i.DaysInOneWeek+1)})(e,t)}}function w(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function E(e){return e.getDate()+(e.getMonth()<<5)+(e.getFullYear()<<9)}function S(e,t,n){var s=x(e)-1,o=e.getDay()-s%i.DaysInOneWeek,u=x(new Date(e.getFullYear()-1,r.r.December,31))-1,a=(t-o+2*i.DaysInOneWeek)%i.DaysInOneWeek;0!==a&&a>=n&&(a-=i.DaysInOneWeek);var f=s-a;if(f<0){0!==(a=(t-(o-=u%i.DaysInOneWeek)+2*i.DaysInOneWeek)%i.DaysInOneWeek)&&a+1>=n&&(a-=i.DaysInOneWeek);f=u-a}return Math.floor(f/i.DaysInOneWeek+1)}function x(e){for(var t=e.getMonth(),n=e.getFullYear(),r=0,i=0;i<t;i++)r+=T(i+1,n);return r+=e.getDate()}function T(e,t){return new Date(t,e,0).getDate()}}],Array(19),[function(e,t,n){"use strict";n.d(t,"e",function(){return v});var r=n(0),i=n(1649),s=n(52),o=n(530),u=n(49),a=n(1001),f=n(290),l=n(1766),c=n(2887),h=n(11),p=n(970),d=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._pageContext=n.pageContext;r._apiUrlHelper=n.apiUrlHelper;r._itemUrlHelper=n.itemUrlHelper;r._dataRequestor=new o.t({qosName:"ComplianceTagDataSource"},{pageContext:r._pageContext});return r}t.prototype.getAvailableTagsForSite=function(){var e=this;return this._dataRequestor.getData({url:this._buildComplianceTagsListUrl(),qosName:"GetAvailableTagsForSite",method:"GET",noRedirect:!0}).then(function(t){return e._transformToComplianceTags(t.d.GetAvailableTagsForSite.results)},function(e){return s.n.wrapError(c.e)})};t.prototype.updateComplianceTagInBatch=function(e,t,n){if(!e||0===e.length){p.e.logData({name:"ComplianceTagDataSource.EmptyItemIds",message:"Empty item IDs selected for list: "+n});return s.n.wrap([])}var r=JSON.stringify({itemIds:e,listUrl:n,complianceTagValue:t.tagValue,blockDelete:t.blockDelete,blockEdit:t.blockEdit});return this._dataRequestor.getData({url:this._buildApplyLabelOnBulkItemsUrl(),qosName:"ApplyLabelOnBulkItems",additionalPostData:r,method:"POST"}).then(function(e){return e&&e.d&&e.d.ApplyLabelOnBulkItems&&e.d.ApplyLabelOnBulkItems.results?e.d.ApplyLabelOnBulkItems.results:[]},function(e){return s.n.wrapError(e)})};t.prototype.updateComplianceTag=function(e,t){var n=t.blockEdit||t.blockDelete,r=t.blockEdit,i=t.isEventTag,o=JSON.stringify({complianceTag:t.tagValue,isTagPolicyHold:n,isTagPolicyRecord:r,isEventBasedTag:i,isTagSuperLock:t.superLock,isUnlockedAsDefault:t.unlockedAsDefault});return this._dataRequestor.getData({url:this._buildUpdateHashtagsUrl(e,"SetComplianceTag"),qosName:"SetComplianceTag",additionalPostData:o,method:"POST",noRedirect:!0}).then(function(){return t.tagName},function(e){return s.n.wrapError(e)})};t.prototype.unlockRecord=function(e,t){var n=JSON.stringify({listUrl:t,itemId:e.properties.ID});return this._dataRequestor.getData({url:this._buildUnlockRecordUrl(),qosName:"UnlockRecordItem",additionalPostData:n,method:"POST"}).then(function(e){if(e&&e.d&&e.d.UnlockRecordItem&&e.d.UnlockRecordItem.results){var t=e.d.UnlockRecordItem.results;return l.p(t)}return!1},function(e){return s.n.wrapError(e)})};t.prototype.lockRecord=function(e,t){var n=JSON.stringify({listUrl:t,itemId:e.properties.ID});return this._dataRequestor.getData({url:this._buildLockRecordUrl(),qosName:"LockRecordItem",additionalPostData:n,method:"POST"}).then(function(e){if(e&&e.d&&e.d.LockRecordItem&&e.d.LockRecordItem.results){var t=e.d.LockRecordItem.results;return l.p(t)}return!1},function(e){return s.n.wrapError(e)})};t.prototype._buildComplianceTagsListUrl=function(){return this._apiUrlHelper.build().methodWithAliases("SP.CompliancePolicy.SPPolicyStoreProxy.GetAvailableTagsForSite",{siteUrl:this._pageContext.webAbsoluteUrl}).toString()};t.prototype._buildUpdateHashtagsUrl=function(e,t){var n=this._itemUrlHelper.getItemUrlParts(e.key);return this._apiUrlHelper.build().webByItemUrl(n).method("GetList",n.serverRelativeListUrl).method("items",e.properties.ID).method(t).toString()};t.prototype._transformToComplianceTags=function(e){var t=[],n={tagName:c.n,tagValue:"",blockDelete:!1,blockEdit:!1,tagDescription:c.t,tagTooltip:c.t,hasRetentionAction:!1,autoDelete:!1,isEventTag:!1,reviewerEmail:"",notes:"",displayName:"",superLock:!1,tagId:"",unlockedAsDefault:!1};t.push(n);for(var r=0,i=e;r<i.length;r++){var s=i[r],o=l.f(s),u=l.l(s),a={tagName:s.TagName,tagValue:s.TagName,blockDelete:s.BlockDelete,blockEdit:!!s.BlockEdit,tagDescription:o,tagTooltip:u,hasRetentionAction:s.HasRetentionAction,autoDelete:s.AutoDelete,isEventTag:s.IsEventTag,reviewerEmail:s.ReviewerEmail,notes:s.Notes,displayName:s.DisplayName,superLock:s.SuperLock,tagId:s.TagId,unlockedAsDefault:s.UnlockedAsDefault};t.push(a)}return t};t.prototype._buildApplyLabelOnBulkItemsUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.ApplyLabelOnBulkItems").toString()};t.prototype._buildUnlockRecordUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.UnlockRecordItem").toString()};t.prototype._buildLockRecordUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.LockRecordItem").toString()};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{pageContext:u.h,apiUrlHelper:a.e,itemUrlHelper:f.o});return t})(i.n),v=Object(h.s)("ComplianceTagDataSource",d)},,,,,,,,,,,,function(e,t,n){"use strict";var r=n(0),i=n(138);Object(i.n)([{rawString:".od-addCommentTextField{display:-webkit-box;display:-ms-flexbox;display:flex;margin:4px 0px 16px 0px}.od-addCommentTextField .ms-TextField-suffix{margin:8px 0;padding:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-addCommentTextField-input{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.od-addCommentTextField-input .ms-TextField-fieldGroup{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-addCommentTextField-sendButton{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";background-color:unset}.od-addCommentTextField-spinner{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:4px}.od-addCommentTextField-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}]);Object(i.n)([{rawString:".od-addNewCommentTextField{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;margin:4px 0px 16px 0px}.od-addNewCommentTextField .ms-TextField-suffix{padding:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.od-addNewCommentTextField .od-TextBox-infoMessage{margin:4px 0;padding:8px 4px;background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:";display:-webkit-box;display:-ms-flexbox;display:flex;vertical-align:middle;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.od-addNewCommentTextField .od-TextBox-infoMessage .od-info-icon{padding:0 8px;-ms-flex-item-align:start;align-self:flex-start}.od-addNewCommentTextField .od-TextBox-infoMessage .od-info-message{padding:0 4px;font-size:10px}.od-addNewCommentTextField-input{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.od-addNewCommentTextField-input .ms-TextField-fieldGroup{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;max-height:174px;min-height:0px;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";border-radius:2px}.od-addNewCommentTextField-input .ms-TextField-fieldGroup .ms-TextField-field{height:100%;min-height:0px}.od-addNewCommentTextField-input .ms-TextField-fieldGroup .ms-TextField-field:empty{max-height:-webkit-min-content;max-height:-moz-min-content;max-height:min-content}.od-addNewCommentTextField-input .ms-TextField-fieldGroup:hover{border-color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-addNewCommentTextField-disabled .ms-TextField-fieldGroup{border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";border-radius:2px;background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-addNewCommentTextField-disabled .ms-TextField-fieldGroup:hover{border-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-addNewCommentTextField-disabled .ms-TextField-suffix{background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-addNewCommentTextField-sendButton{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";background-color:unset;margin:4px}.od-addNewCommentTextField-spinner{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:4px}.od-addNewCommentTextField-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}]);var s=n("react-lib"),o=n(129),u=n(37),a=n(1486),f=n(1637),l=n(390),c=n(1893),h=n(1508),p=n(993),d=n(1547),v=n(97),m=n(2438),g=n(133),y=/(^@|\s@)/m,b=(function(e){Object(r.__extends)(t,e);function t(t){var n,r,i=e.call(this,t)||this;i._textField=s.createRef();i.COMMENT_TEXT_MAX_LENGTH=2e3;i.charLimitExceededMessage="Maximum character limit exceeded";i._onSend=function(){var e=i.props,t=e.onSend,n=e.engagementSource,r=e.engagementExtraData,s=e.engagementExecutor,o=i.state.text;if(o&&t){i.setState({sending:!0,errorMessage:"",successMessage:""});t(o,function(){i._onClearTextField();i.setState({successMessage:m.e})},function(e){i.setState({sending:!1,errorMessage:e})});var u=n?n+".":"AddCommentTextField.";(s||g.e).logData({name:u+"Send.Click",isIntentional:!0,extraData:r})}};i._onClearTextField=function(){i.setState(i._getResetState(),function(){i._textField&&i._textField.current&&i._textField.current.focus()})};i._onTextFieldChange=function(e,t){if(!t||t.length<=i.COMMENT_TEXT_MAX_LENGTH){var n=i._isIE&&y.test(t),r=i.props.isMentionsEnabled&&n?m.r:"";i.setState({text:t||"",errorMessage:"",enableSendButton:!(!t||!t.trim()),infoMessage:r})}else i.setState({text:i.state.text,errorMessage:i.charLimitExceededMessage,enableSendButton:!1,infoMessage:""})};i._onKeyDown=function(e){e.which===o.e.enter&&i.state.enableSendButton&&i._onSend()};i._isIE=!!(null===(r=null===(n=t)||void 0===n?void 0:n.platform)||void 0===r?void 0:r.isIE);i.state=i._getResetState();return i}t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.commentItemId===this.props.commentItemId&&e.disabled===this.props.disabled||this.setState(Object(r.__assign)(Object(r.__assign)({},this._getResetState()),{errorMessage:"",successMessage:""}))};t.prototype.componentDidMount=function(){this.props.focusOnMount&&!this.props.disabled&&this._textField.current&&this._textField.current.focus()};t.prototype.render=function(){var e=this.props,t=e.overrideStyleName,n=e.enableNewCommentingExperience;return s.createElement("div",{className:Object(u.e)({"od-addCommentTextField":!n},{"od-addNewCommentTextField":n},t)},s.createElement(c.e,Object(r.__assign)({componentRef:this._textField,"data-lpignore":"true"},this._getTextFieldProps())),s.createElement("div",{className:Object(u.e)({"od-addCommentTextField-screenReaderOnly":!n},{"od-addNewCommentTextField-screenReaderOnly":n}),"aria-live":"assertive",role:"status","aria-label":this.state.successMessage},this.state.successMessage),this._renderInfoMessage())};t.prototype._getTextFieldProps=function(){var e=this,t=this.props,n=t.placeholderText,r=t.disabled,i=t.enableNewCommentingExperience,s=this.state,o=s.sending,a=s.text,f=s.errorMessage;return{className:Object(u.e)({"od-addCommentTextField-input":!i},{"od-addNewCommentTextField-input":i},{"od-addNewCommentTextField-disabled":i&&(r||o)}),placeholder:n,onChange:this._onTextFieldChange,value:a||"",disabled:r||o,onKeyDown:this._onKeyDown,autoComplete:"off",errorMessage:f,autoAdjustHeight:i,multiline:i,rows:1,resizable:!1,onRenderSuffix:function(t){return e._onRenderSuffix()},ariaLabel:m.o}};t.prototype._onRenderSuffix=function(){return this.props.enableNewCommentingExperience?this.state.text.length>0&&s.createElement(s.Fragment,null,this._getSendButton()):s.createElement(s.Fragment,null,this._getCancelButton(),this._getSendButton())};t.prototype._getCancelButton=function(){this.props.enableNewCommentingExperience;return s.createElement(d.e,{content:m.s,styles:{root:{display:"inline-block"}},directionalHint:v.e.bottomAutoEdge},s.createElement(h.e,{iconProps:{iconName:"Cancel"},ariaLabel:m.s,onClick:this._onClearTextField}))};t.prototype._getSendButton=function(){var e=this.props,t=e.sendButtonTitle,n=e.enableNewCommentingExperience;return this.state.sending?s.createElement("div",{className:Object(u.e)({"od-addCommentTextField-spinner":!n},{"od-addNewCommentTextField-spinner":n})},s.createElement(f.e,{size:l.e.small})):s.createElement(d.e,{content:m.u||t,styles:{root:{display:"inline-block"}},directionalHint:v.e.bottomAutoEdge},s.createElement(h.e,{className:Object(u.e)({"od-addCommentTextField-sendButton":!n},{"od-addNewCommentTextField-sendButton":n}),iconProps:{iconName:"Send"},ariaLabel:m.u||t,onClick:this._onSend,disabled:!this.state||!this.state.enableSendButton}))};t.prototype._getResetState=function(){return{text:"",enableSendButton:!1,sending:!1,errorMessage:"",infoMessage:""}};t.prototype._renderInfoMessage=function(){return!this.state.errorMessage&&!!this.state.infoMessage&&s.createElement("div",{className:"od-TextBox-infoMessage"},s.createElement("span",{className:"ms-Icon od-info-icon","aria-hidden":!0},s.createElement(p.e,{iconName:"Info"})),s.createElement("span",{className:"od-info-message"},this.state.infoMessage))};return t})(a.e);t.e=b}],Array(13),[function(e,t,n){"use strict";var r;(function(e){e[e.share=1]="share";e[e.copy=2]="copy";e[e.atMention=3]="atMention";e[e.linkSettings=4]="linkSettings";e[e.manageAccess=5]="manageAccess";e[e.notify=6]="notify";e[e.addPeople=7]="addPeople"})(r||(r={}));t.e=r},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){var t="",n=!1;if(e>=36e5){var r=Math.floor(e/36e5);e%=36e5;t+=r+":";n=!0}var i=Math.floor(e/6e4);e%=6e4;i<10&&n&&(t+="0");t+=i+":";var s=Math.floor(e/1e3);s<10&&(t+="0");return t+=s}},,,function(e,t,n){"use strict";var r=n(138);Object(r.n)([{rawString:".InfoPane-sharing{margin-top:.5rem}.InfoPane-sectionHeaderText{font-size:.875rem}.od-SharingSection-ManageAccessLink{font-size:.75rem}.SharingSection-shareLink{line-height:1.625rem;font-size:.75rem}html[dir=ltr] .SharingSection-shareLink{float:right}html[dir=rtl] .SharingSection-shareLink{float:left}.SharingSection-entity{padding:.5rem 0;font-size:.75rem}.SharingSection-entity .ms-Persona{white-space:nowrap}.SharingSection-entity .ms-Persona .ms-Persona-details{display:inline-block;max-width:10.625rem;padding:0}.SharingSection-addPeople{font-size:1.125rem;min-height:3.125rem;margin-top:.625rem}.SharingSection-addPeople-icon{display:inline-block;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:1.25rem;border-radius:50%;width:3.125rem;height:3.125rem}[dir=ltr] .SharingSection-addPeople-icon{margin-right:.625rem}[dir=rtl] .SharingSection-addPeople-icon{margin-left:.625rem}.SharingSection-addPeople-icon .ms-Icon--PeopleAdd{position:relative;top:.75rem}[dir=ltr] .SharingSection-addPeople-icon .ms-Icon--PeopleAdd{left:.9375rem}[dir=rtl] .SharingSection-addPeople-icon .ms-Icon--PeopleAdd{right:.9375rem}.SharingSection-addPeople-text{display:inline-block;vertical-align:top;line-height:3.125rem}.SharingSection-linksBox a{display:inline-block;margin-top:.3125rem}.SharingSection-link,.od-PermissionsPanel-link{padding-top:.5rem}.od-alert{display:none}.od-alert.od-PermissionsPanel-alert{display:block}div.ms-ContextualMenu.is-open{z-index:299}.od-PermissionsPanel{height:100%;overflow-y:auto;overflow-x:hidden}.od-PermissionsPanel .od-SharingLink-linkSwitcher{font-size:.75rem}.od-PermissionPile-FacePile{display:inline-block;margin:0;padding:0}.od-PermissionPile-FacePile.od-PermissionPile-Unshared{display:inline-flex;flex-wrap:wrap;justify-content:start}.od-PermissionsPanel-shareLink{line-height:1.625rem;font-size:.75rem}html[dir=ltr] .od-PermissionsPanel-shareLink{float:right}html[dir=rtl] .od-PermissionsPanel-shareLink{float:left}.od-PermissionPile-accessibleLabel{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.od-PermissionsPanel-stopSharing{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:1rem;background:0 0;border:none;padding:0;cursor:pointer}.od-PermissionsPanel-stopSharing:focus,.od-PermissionsPanel-stopSharing:hover{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-PermissionsPanel-stopSharing a:focus{border:.0625rem solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.od-PermissionsPanel-stopSharing a:focus{border:.0625rem solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}}.od-PermissionsPanel-entity{padding:.5rem 0;font-size:.75rem}.od-PermissionsPanel-entity .od-Persona .od-Persona-details{display:inline-block;max-width:200px;padding:0}.od-PermissionsPanel-addPeople{font-size:1.0625rem;min-height:3.125rem;padding-bottom:.625rem}.od-PermissionsPanel-addPeople-icon{display:inline-block;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:1.25rem;border-radius:50%;width:3.125rem;height:3.125rem}[dir=ltr] .od-PermissionsPanel-addPeople-icon{margin-right:.625rem}[dir=rtl] .od-PermissionsPanel-addPeople-icon{margin-left:.625rem}.od-PermissionsPanel-addPeople-icon .ms-Icon--PeopleAdd{position:relative;top:.75rem;left:.9375rem}.od-PermissionsPanel-addPeople-text{display:inline-block;vertical-align:top;line-height:3.125rem}.od-PermissionsPanel-linksBox a{display:inline-block;margin-top:.3125rem}.od-PermissionsPanel-link{padding-top:.5rem}.od-PermissionsPanel-container{overflow:hidden}.od-PermissionsPanel-container-withCommandbar{top:40px}.od-PermissionsPanel-head{font-size:1.25rem}.isFluent .od-PermissionsPanel-head{font-weight:600;margin-bottom:.5rem}.od-PermissionsPanel-fileName{font-size:.875rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";overflow:hidden;text-overflow:ellipsis;white-space:nowrap;height:1.5625rem}[dir=ltr] .od-PermissionsPanel-fileName{padding-right:2.5rem}[dir=rtl] .od-PermissionsPanel-fileName{padding-left:2.5rem}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path{padding:.1875rem;display:inline-block;vertical-align:middle}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path .od-PermissionsPanel-Path-Element{display:inline;word-break:break-all}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path .od-PermissionsPanel-Path-Element:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";padding:0 .3125rem;font-size:.5rem;font-weight:800;content:'\\E76C'}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path .od-PermissionsPanel-Path-Element:last-child:after{content:'';display:none}html[dir=rtl] .od-PermissionsPanel-Path-Element:after{content:'\\E76B'}.od-PermissionsPanel-titleBar{padding-top:1rem;padding-bottom:.25rem;border-bottom:solid .0625rem "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}[dir=ltr] .od-PermissionsPanel-titleBar{padding-left:1rem}[dir=rtl] .od-PermissionsPanel-titleBar{padding-right:1rem}.od-PermissionsPanel-parent{height:100%}.od-PermissionsPanel-content{padding-top:15px;padding-left:32px;padding-right:5px}.od-PermissionsPanel-linksBox,.od-PermissionsPanel-linksBox-row{right:0;bottom:0}.od-SharingSection-PermissionsPile{width:20rem;padding:1rem;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-sizing:border-box;margin-bottom:1rem}.isFluent .od-SharingSection-PermissionsPile{padding:1rem 1.5rem}.od-SharingSection-PermissionsPile .InfoPane-sectionHeader{padding-bottom:.625rem;cursor:default}.isFluent .od-SharingSection-PermissionsPile .InfoPane-sectionHeader{padding-bottom:0}.od-SharingSection-PermissionsPile .od-Link:focus-visible{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SharingSection-ManageAccessLink-Button{border:0;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:inherit}.isFluent .od-SharingSection-ManageAccessLink-Button{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-SharingSection-PermissionsPile-personas{margin-bottom:.25rem}.od-SharingSection-PermissionsPile-personas .od-Persona{display:inline-block;width:2rem;height:2rem;box-sizing:border-box;cursor:pointer;vertical-align:top}[dir=ltr] .od-SharingSection-PermissionsPile-personas .od-Persona{margin-right:.25rem}[dir=rtl] .od-SharingSection-PermissionsPile-personas .od-Persona{margin-left:.25rem}.od-SharingSection-PermissionsPile-personas .od-Persona.od-Persona--xs{border:.0625rem solid transparent}.od-SharingSection-PermissionsPile-personas .od-Persona.od-Persona--xs .od-Persona-initials{font-size:1rem}.od-SharingSection-PermissionsPile-personas .od-Persona.od-HasAccessControl{text-align:center;padding:.375rem 0;height:unset;width:unset}.od-SharingSection-PermissionsPile-personas .od-Persona.od-Pointer{cursor:auto}.od-SharingSection-PermissionsPile-personas .od-Persona-presence{box-sizing:border-box;border:.0625rem solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-SharingSection-PermissionsPile-personas .od-PersonaTile{outline:0}.od-SharingSection-PermissionsPile-personas .od-Persona-image[disabled] .od-SharingSection-PermissionsPile-addFriend{cursor:default;background-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-focus--enabled .od-Persona--xs:focus{box-shadow:0 0 0 .0625rem "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:" inset}.od-SharingSection-PermissionsPile-addFriend{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";height:100%;border-radius:50%;position:relative;font-size:1.0625rem}.od-SharingSection-PermissionsPile-numberText{font-size:.625rem;padding-top:1rem;text-align:center;pointer-events:none;color:"},{theme:"black",defaultValue:"#000000"},{rawString:";line-height:normal}.od-SharingSection-PermissionsPile-personaBorder{box-sizing:border-box}.od-SharingSection-PermissionsPile-personaBorder:focus{outline:.0625rem solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SharingSection-PermissionsPile-personaBorder .ms-Icon{font-size:.875rem}.od-SharingSection-PermissionsPile-personaIcon{position:relative;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";height:100%;pointer-events:none;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";border-radius:50%}.od-SharingSection-PermissionsPile-personaIcon.od-SharingSection-PermissionsPile-personaIcon--many .ms-Icon{position:absolute;top:.25rem;transform:translateX(-50%);color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";font-size:.75rem;line-height:normal}[dir=ltr] .od-SharingSection-PermissionsPile-personaIcon.od-SharingSection-PermissionsPile-personaIcon--many .ms-Icon{left:50%}[dir=rtl] .od-SharingSection-PermissionsPile-personaIcon.od-SharingSection-PermissionsPile-personaIcon--many .ms-Icon{right:50%}.od-SharingSection-PermissionsPile-personaMore{position:relative;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";height:100%}.od-SharingSection-PermissionsPile-moreNumber{position:absolute;font-size:.625rem;top:50%;transform:translate(-50%,-50%);color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}[dir=ltr] .od-SharingSection-PermissionsPile-moreNumber{left:50%}[dir=rtl] .od-SharingSection-PermissionsPile-moreNumber{right:50%}.od-SharingSection-PermissionsPile-description{margin-bottom:.25rem;padding:.125rem}.od-SharingSection-PermissionsPile-description .ms-Icon{font-size:.75rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SharingSection-PermissionsPile-descriptionText{display:inline-block;font-size:.75rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";vertical-align:top;padding:.1875rem}.od-Persona .od-Persona--xs{display:inline-block}.od-SharingSection-PermissionsPile-personas .od-Persona .od-Persona-details{display:none}.od-Panel-button--close .ms-Icon--Cancel{font-size:1rem}.od-ShowPermissions-commandBar{outline:0;margin:0;border:0;top:0;width:100%;padding:0;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-ShowPermissions-commandBar .ms-CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.5s;padding:0}@media (prefers-reduced-motion:reduce){.od-ShowPermissions-commandBar .ms-CommandBar{animation:none}}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-shadow:inset 0 .0625rem 0 0 "},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button i{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button:hover{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:none}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button:focus{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:0 0 0 .0625rem "},{theme:"white",defaultValue:"#ffffff"},{rawString:" inset}.od-ShowPermissions-commandBar .CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.5s}@media (prefers-reduced-motion:reduce){.od-ShowPermissions-commandBar .CommandBar{animation:none}}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-shadow:inset 0 .0625rem 0 0 "},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-icon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-icon .od-IconGlyph{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-commandText{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-linkWrapper{padding-left:.75rem;padding-right:.75rem}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:hover{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:none}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:hover .CommandBarItem-icon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:hover .CommandBarItem-commandText{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:focus{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:focus .CommandBarItem-link:before{border:.0625rem solid "},{theme:"themeDarker",defaultValue:"#004578"},{rawString:";margin:-.375rem}"}])},function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"n",function(){return u});n.d(t,"t",function(){return a});var r=n(2255),i=n(22),s=n(2298);function o(e,t,n,o){if(null===e)return"";if(6===e.kind){if(e.blockDownload){if(e.audience===s.e.anyone)return e.expiration?i.format(e.hasPassword?r.g:r.m,new Date(e.expiration).toLocaleDateString()):e.hasPassword?r.y:r.v;if(e.audience===s.e.organization)return i.format(r.z,t);if(e.audience===s.e.specificPeopleFlex)return r.Y}if(e.audience!==s.e.anyone)return 2===e.role?r.ae:6===e.role?r.fe:1===e.role?r.le:r.ue;if(e.expiration&&e.hasPassword){if(2===e.role||6===e.type)return l(6,new Date(e.expiration));if(1===e.role||5===e.type)return l(5,new Date(e.expiration))}else if(!e.expiration&&e.hasPassword){if(2===e.role||6===e.type)return r.a;if(1===e.role||5===e.type)return r.c}else if(e.expiration&&!e.hasPassword){if(2===e.role||6===e.type)return f(6,new Date(e.expiration));if(1===e.role||5===e.type)return f(5,new Date(e.expiration))}else{if(2===e.role||6===e.type)return r.r;if(1===e.role||5===e.type)return r.b}}if(8===e.type&&n&&n.length>0&&o&&1===o){for(var u=n[0].sharingInfo.role,a=1;a<n.length;a++){if(u!==n[a].sharingInfo.role){u=5;break}}return 1===n.length?2===u?i.format(r.N,n[0].name):1===u?i.format(r.C,n[0].name):i.format(r.T,n[0].name):2===n.length?2===u?i.format(r.P,n[0].name,n[1].name):1===u?i.format(r.H,n[0].name,n[1].name):i.format(r.D,n[0].name,n[1].name):3===n.length?2===u?i.format(r.L,n[0].name,n[1].name):1===u?i.format(r._,n[0].name,n[1].name):i.format(r.k,n[0].name,n[1].name):2===u?i.format(r.O,n[0].name,n[1].name,n.length-2):1===u?i.format(r.M,n[0].name,n[1].name,n.length-2):i.format(r.A,n[0].name,n[1].name,n.length-2)}var c=e.expiration?new Date(e.expiration).toLocaleDateString():null;if(4===e.entityType)return r.b;switch(e.type){case 9:return 2===e.role?t?i.format(r.U,t):r.I:t?i.format(r.W,t):r.q;case 8:return 2===o?2===e.role?r.Z:r.te:r.S;case 6:return e.supportsExpiration&&c?f(6,new Date(e.expiration)):r.r;case 5:return e.supportsExpiration&&c?f(5,new Date(e.expiration)):r.b;case 3:return r.i;case 4:return i.format(r.re,e.name);case 7:return r.h;case 10:return r.R;default:return""}}function u(e,t,n){var s=[];if(1===n||2===n){e.anonymousLinksEnabled&&e.canManageLinks&&s.push({text:r.s,type:6});e.organizationLinksEnabled&&e.canManageLinks&&(t?s.push({text:i.format(r.F,t),type:9}):s.push({text:r.ne,type:9}))}1===n?s.push({text:r.G,type:8}):s.push({text:r.ee,type:8});return s}function a(e){return 0===e.length?null:1===e.length?i.format(r.X,e[0].name):2===e.length?i.format(r.J,e[0].name,e[1].name):3===e.length?i.format(r.V,e[0].name,e[1].name):i.format(r.$,e[0].name,e[1].name,e.length-2)}function f(e,t){var n=new Date(t).toLocaleDateString(),s=t.getTime()<Date.now();return 6===e?i.format(s?r.t:r.n,n):5===e?i.format(s?r.p:r.d,n):""}function l(e,t){var n=new Date(t).toLocaleDateString(),s=t.getTime()<Date.now();return 6===e?i.format(s?r.o:r.u,n):5===e?i.format(s?r.f:r.l,n):""}}],Array(19),[function(e,t,n){"use strict";n.d(t,"e",function(){return g});var r=n(25),i={root:"ms-ScrollablePane",contentContainer:"ms-ScrollablePane--contentContainer"},s=n(4),o=n("react-lib"),u=n(472),a=n(705),f=n(886),l=n(207),c=n(95),h=n(270),p=n(1897),d=Object(u.e)(),v=(function(e){Object(s.r)(t,e);function t(t){var n=e.call(this,t)||this;n._root=o.createRef();n._stickyAboveRef=o.createRef();n._stickyBelowRef=o.createRef();n._contentContainer=o.createRef();n.subscribe=function(e){n._subscribers.add(e)};n.unsubscribe=function(e){n._subscribers.delete(e)};n.addSticky=function(e){n._stickies.add(e);if(n.contentContainer){e.setDistanceFromTop(n.contentContainer);n.sortSticky(e)}};n.removeSticky=function(e){n._stickies.delete(e);n._removeStickyFromContainers(e);n.notifySubscribers()};n.sortSticky=function(e,t){if(n.stickyAbove&&n.stickyBelow){t&&n._removeStickyFromContainers(e);e.canStickyTop&&e.stickyContentTop&&n._addToStickyContainer(e,n.stickyAbove,e.stickyContentTop);e.canStickyBottom&&e.stickyContentBottom&&n._addToStickyContainer(e,n.stickyBelow,e.stickyContentBottom)}};n.updateStickyRefHeights=function(){var e=n._stickies,t=0,r=0;e.forEach(function(e){var i=e.state,s=i.isStickyTop,o=i.isStickyBottom;if(e.nonStickyContent){s&&(t+=e.nonStickyContent.offsetHeight);o&&(r+=e.nonStickyContent.offsetHeight);n._checkStickyStatus(e)}});n.setState({stickyTopHeight:t,stickyBottomHeight:r})};n.notifySubscribers=function(){n.contentContainer&&n._subscribers.forEach(function(e){e(n.contentContainer,n.stickyBelow)})};n.getScrollPosition=function(){return n.contentContainer?n.contentContainer.scrollTop:0};n.syncScrollSticky=function(e){e&&n.contentContainer&&e.syncScroll(n.contentContainer)};n._getScrollablePaneContext=function(){return{scrollablePane:{subscribe:n.subscribe,unsubscribe:n.unsubscribe,addSticky:n.addSticky,removeSticky:n.removeSticky,updateStickyRefHeights:n.updateStickyRefHeights,sortSticky:n.sortSticky,notifySubscribers:n.notifySubscribers,syncScrollSticky:n.syncScrollSticky}}};n._addToStickyContainer=function(e,t,r){if(t.children.length){if(!t.contains(r)){var i=[].slice.call(t.children),s=[];n._stickies.forEach(function(r){(t===n.stickyAbove&&e.canStickyTop||e.canStickyBottom)&&s.push(r)});for(var o=void 0,u=0,a=s.sort(function(e,t){return(e.state.distanceFromTop||0)-(t.state.distanceFromTop||0)}).filter(function(e){var r=t===n.stickyAbove?e.stickyContentTop:e.stickyContentBottom;return!!r&&i.indexOf(r)>-1});u<a.length;u++){var f=a[u];if((f.state.distanceFromTop||0)>=(e.state.distanceFromTop||0)){o=f;break}}var l=null;o&&(l=t===n.stickyAbove?o.stickyContentTop:o.stickyContentBottom);t.insertBefore(r,l)}}else t.appendChild(r)};n._removeStickyFromContainers=function(e){n.stickyAbove&&e.stickyContentTop&&n.stickyAbove.contains(e.stickyContentTop)&&n.stickyAbove.removeChild(e.stickyContentTop);n.stickyBelow&&e.stickyContentBottom&&n.stickyBelow.contains(e.stickyContentBottom)&&n.stickyBelow.removeChild(e.stickyContentBottom)};n._onWindowResize=function(){var e=n._getScrollbarWidth(),t=n._getScrollbarHeight();n.setState({scrollbarWidth:e,scrollbarHeight:t});n.notifySubscribers()};n._getStickyContainerStyle=function(e,t){return Object(s.e)(Object(s.e)({height:e},Object(a.e)(n.props.theme)?{right:"0",left:(n.state.scrollbarWidth||n._getScrollbarWidth()||0)+"px"}:{left:"0",right:(n.state.scrollbarWidth||n._getScrollbarWidth()||0)+"px"}),t?{top:"0"}:{bottom:(n.state.scrollbarHeight||n._getScrollbarHeight()||0)+"px"})};n._onScroll=function(){var e=n.contentContainer;e&&n._stickies.forEach(function(t){t.syncScroll(e)});n._notifyThrottled()};n._subscribers=new Set;n._stickies=new Set;Object(f.e)(n);n._async=new l.e(n);n._events=new c.e(n);n.state={stickyTopHeight:0,stickyBottomHeight:0,scrollbarWidth:0,scrollbarHeight:0};n._notifyThrottled=n._async.throttle(n.notifySubscribers,50);return n}Object.defineProperty(t.prototype,"root",{get:function(){return this._root.current},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"stickyAbove",{get:function(){return this._stickyAboveRef.current},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"stickyBelow",{get:function(){return this._stickyBelowRef.current},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"contentContainer",{get:function(){return this._contentContainer.current},enumerable:!0,configurable:!0});t.prototype.componentDidMount=function(){var e=this,t=this.props.initialScrollPosition;this._events.on(this.contentContainer,"scroll",this._onScroll);this._events.on(window,"resize",this._onWindowResize);this.contentContainer&&t&&(this.contentContainer.scrollTop=t);this.setStickiesDistanceFromTop();this._stickies.forEach(function(t){e.sortSticky(t)});this.notifySubscribers();if("MutationObserver"in window){this._mutationObserver=new MutationObserver(function(t){var n=e._getScrollbarHeight();n!==e.state.scrollbarHeight&&e.setState({scrollbarHeight:n});e.notifySubscribers();if(t.some(function(e){return null!==this.stickyAbove&&null!==this.stickyBelow&&(this.stickyAbove.contains(e.target)||this.stickyBelow.contains(e.target))}.bind(e)))e.updateStickyRefHeights();else{var r=[];e._stickies.forEach(function(e){e.root&&e.root.contains(t[0].target)&&r.push(e)});r.length&&r.forEach(function(e){e.forceUpdate()})}});this.root&&this._mutationObserver.observe(this.root,{childList:!0,attributes:!0,subtree:!0,characterData:!0})}};t.prototype.componentWillUnmount=function(){this._events.dispose();this._async.dispose();this._mutationObserver&&this._mutationObserver.disconnect()};t.prototype.shouldComponentUpdate=function(e,t){return this.props.children!==e.children||this.props.initialScrollPosition!==e.initialScrollPosition||this.props.className!==e.className||this.state.stickyTopHeight!==t.stickyTopHeight||this.state.stickyBottomHeight!==t.stickyBottomHeight||this.state.scrollbarWidth!==t.scrollbarWidth||this.state.scrollbarHeight!==t.scrollbarHeight};t.prototype.componentDidUpdate=function(e,t){var n=this.props.initialScrollPosition;this.contentContainer&&"number"==typeof n&&e.initialScrollPosition!==n&&(this.contentContainer.scrollTop=n);t.stickyTopHeight===this.state.stickyTopHeight&&t.stickyBottomHeight===this.state.stickyBottomHeight||this.notifySubscribers();this._async.setTimeout(this._onWindowResize,0)};t.prototype.render=function(){var e=this.props,t=e.className,n=e.theme,r=e.styles,i=this.state,u=i.stickyTopHeight,a=i.stickyBottomHeight,f=d(r,{theme:n,className:t,scrollbarVisibility:this.props.scrollbarVisibility});return o.createElement("div",Object(s.e)({},Object(h.u)(this.props,h.s),{ref:this._root,className:f.root}),o.createElement("div",{ref:this._stickyAboveRef,className:f.stickyAbove,style:this._getStickyContainerStyle(u,!0)}),o.createElement("div",{ref:this._contentContainer,className:f.contentContainer,"data-is-scrollable":!0},o.createElement(p.e.Provider,{value:this._getScrollablePaneContext()},this.props.children)),o.createElement("div",{className:f.stickyBelow,style:this._getStickyContainerStyle(a,!1)},o.createElement("div",{ref:this._stickyBelowRef,className:f.stickyBelowItems})))};t.prototype.setStickiesDistanceFromTop=function(){var e=this;this.contentContainer&&this._stickies.forEach(function(t){t.setDistanceFromTop(e.contentContainer)})};t.prototype.forceLayoutUpdate=function(){this._onWindowResize()};t.prototype._checkStickyStatus=function(e){if(this.stickyAbove&&this.stickyBelow&&this.contentContainer&&e.nonStickyContent)if(e.state.isStickyTop||e.state.isStickyBottom){e.state.isStickyTop&&!this.stickyAbove.contains(e.nonStickyContent)&&e.stickyContentTop&&e.addSticky(e.stickyContentTop);e.state.isStickyBottom&&!this.stickyBelow.contains(e.nonStickyContent)&&e.stickyContentBottom&&e.addSticky(e.stickyContentBottom)}else this.contentContainer.contains(e.nonStickyContent)||e.resetSticky()};t.prototype._getScrollbarWidth=function(){var e=this.contentContainer;return e?e.offsetWidth-e.clientWidth:0};t.prototype._getScrollbarHeight=function(){var e=this.contentContainer;return e?e.offsetHeight-e.clientHeight:0};return t})(o.Component),m=n(1419),g=Object(m.e)(v,function(e){var t,n,s=e.className,o=e.theme,u=Object(r.x)(i,o),a={position:"absolute",pointerEvents:"none"},f={position:"absolute",top:0,right:0,bottom:0,left:0,WebkitOverflowScrolling:"touch"};return{root:[u.root,o.fonts.medium,f,s],contentContainer:[u.contentContainer,{overflowY:"always"===e.scrollbarVisibility?"scroll":"auto"},f],stickyAbove:[{top:0,zIndex:1,selectors:(t={},t[r.s]={borderBottom:"1px solid WindowText"},t)},a],stickyBelow:[{bottom:0,selectors:(n={},n[r.s]={borderTop:"1px solid WindowText"},n)},a],stickyBelowItems:[{bottom:0},a,{width:"100%"}]}},void 0,{scope:"ScrollablePane"})},,function(e,t,n){"use strict";var r=n(0),i=n(133),s=n(996),o=n(1499),u=n(2543),a=n(2381),f=n(2110),l=n(76),c=n(1663),h=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.item,i=t.policyTipInfo;n._item=r;n._policyTipInfo=i;n.addBindingHandlers({react:c.t});n._itemProvider=n.resources.consume(o.resourceKey);n._policyTipDataSource=n.resources.consume(l.V);n._showJustificationInput=n.createObservable(!1);n._confirmationText=n.createObservable("").extend({notify:"always"});n.policyTipComponent=u.e;n.policyTipComponentProps=n.createPureComputed(n._computePolicyTipComponentParams);return n}t.prototype._computePolicyTipComponentParams=function(){var e=this._confirmationText(),t=this._showJustificationInput(),n=this._getPolicyTipStrings();return{confirmationText:e,onDismissed:this._onDismissed.bind(this),onOverrideClicked:this._onOverrideClicked.bind(this),onOverrideSubmitClicked:this._onOverrideSubmitClicked.bind(this),overrideRequiresJustification:this._policyTipInfo?2===this._policyTipInfo.overrideOption:void 0,showJustificationInput:t,onReportClicked:this._onReportClicked.bind(this),strings:n}};t.prototype._getPolicyTipStrings=function(){var e=this._policyTipInfo;if(!e)return{noPolicyTipInfoError:a.n,titleText:f.t(this._item.name),headerText:void 0,issues:void 0,lastScannedText:void 0,learnMoreActionLabel:void 0,learnMoreLabel:void 0,learnMoreUrl:void 0,overrideActionLabel:void 0,overrideLabel:void 0,policyTipDescription:void 0,reportActionLabel:void 0,reportInProgressLabel:void 0,reportLabel:void 0,submitButtonLabel:void 0};var t=1===e.overrideOption||2===e.overrideOption;return{headerText:a.v,issues:e.issueDescriptions,lastScannedText:e.lastScanned?a.m+": "+Object(s.r)(e.lastScanned):void 0,learnMoreActionLabel:a.e,learnMoreLabel:a.t,learnMoreUrl:e.policyInfoUrl,noPolicyTipInfoError:void 0,overrideActionLabel:t?a.r:void 0,overrideLabel:a.s,policyTipDescription:e.explanationText,reportActionLabel:a.l,reportInProgressLabel:a.h,reportLabel:a.p,submitButtonLabel:a.d,titleText:f.t(this._item.name)}};t.prototype._onReportClicked=function(){var e=this;this._logEngagementEvent("ReportClicked");var t={item:this._item,action:1};this._policyTipDataSource.updatePolicy(t).done(function(t){if(1===t){e._logEngagementEvent("FalsePositiveReported");e._confirmationText(a.c)}else if(3===t||2===t){e._logEngagementEvent("OverrideWithoutJustification");e._confirmationText(a.i)}})};t.prototype._onOverrideClicked=function(){var e=this;this._logEngagementEvent("OverrideClicked");var t=this._policyTipInfo.overrideOption;if(1===t){var n={item:this._item,action:0};this._policyTipDataSource.updatePolicy(n).done(function(t){e._logEngagementEvent("OverrideWithoutJustification");e._confirmationText(a.i)})}else if(2===t){this._logEngagementEvent("JustificationInputShown");this._showJustificationInput(!0)}};t.prototype._onOverrideSubmitClicked=function(e){var t=this;this._logEngagementEvent("OverrideSubmitClicked");var n={item:this._item,action:0,justification:e};this._policyTipDataSource.updatePolicy(n).done(function(e){t._logEngagementEvent("OverrideWithJustification");t._confirmationText(a.i)})};t.prototype._onDismissed=function(){this._itemProvider.invalidateItem(this._item.parentKey,{triggerFetch:!0})};t.prototype._logEngagementEvent=function(e){i.e.logData({name:"PolicyTipPanel."+e})};return t})(n(1651).t),p=n(1652).e({tagName:"od-policy-tip-panel",template:'<div data-bind="react:{componentType:policyTipComponent,props:policyTipComponentProps}"></div>',viewModel:h});t.e=p},function(e,t,n){"use strict";n.d(t,"e",function(){return y});n.d(t,"t",function(){return w});var r=n("react-lib"),i=n(1635),s=n(2056),o=n(2216),u=n(993),a=n(25),f=n(2254),l=n(22),c=n(1547),h=n(97),p=n(249),d={ODB:1306};var v=n(2834),m=n(37),g=new Date("0001-01-01T00:00:00-08:00"),y=function(e){var t,n,m,y,E=e.itemAnalytics,S=e.onClick,x=e.onLikeClick,T=(e.pageUrl,e.isLink),N=e.status,C=e.isCompact,k=e.disableViewerCount,L=void 0===k||k,A=e.ODBOptOutViewerList,O=void 0!==A&&A,M=e.itemKey,_=w();if(N===o.e.failed){var D=Object(a.O)();t=_.apiError&&(n="ErrorBadge",m=_.apiError,y={color:D.palette.redDark},r.createElement(r.Fragment,null,r.createElement(u.e,{iconName:n,className:"fileHoverCardErrorIcon_86ea3a8a",styles:{root:Object(a.H)([{paddingRight:"8px",position:"relative"},y])}}),m))}if(t)return null;if(!E||!E.viewCount||!E.viewerCount)return r.createElement(s.e,{className:"analyticsStats_86ea3a8a",isCompact:!0});var P=E.viewCount,H=E.viewerCount,B=E.activities,j=E.commentCount,F=E.likeCount,I=E.incompleteData&&E.incompleteData.missingDataBeforeDateTime&&new Date(E.incompleteData.missingDataBeforeDateTime).getTime()!==g.getTime(),q=E.incompleteData&&E.incompleteData.wasThrottled,R=I?f.fe:q?f.Ae:"",U=L?O?f.be:"":f.Ce,z=R||U,W=P>1?_.views:_.view,X=H>1?_.viewers:_.viewer,V=j&&j>1?_.comments:_.comment,$=F&&F>1?_.likes:_.like,J=j?""+l.format(V,j):"",K=F?""+l.format($,F):"",Q=p.e.isFeatureEnabled(d)?x:void 0,G=K&&b(K,Q),Y=J&&b(J,void 0,void 0);return C?T?r.createElement("div",{className:"analyticsStatsContainer_86ea3a8a"},r.createElement(i.e,{className:"analyticsStatsLink_86ea3a8a",onClick:S},r.createElement(s.e,{activityPersonas:B&&0!==B.length?B.slice(0,3).map(function(e){return{imageUrl:e&&e.actor&&e.actor.user&&e.actor.user.image}}).reverse():void 0,activityDescription:r.createElement("div",{className:"analyticsStatsLabel_86ea3a8a"},P&&r.createElement("div",{className:"analyticsStatsCount_86ea3a8a"},P+" "+W)),isCompact:!0})),K&&M?r.createElement(v.e,{likeLabel:K,itemKey:M}):G,Y):r.createElement("div",{className:"analyticsStatsContainer_86ea3a8a"},b(P+" "+W,void 0),b(H+" "+X,void 0),z&&r.createElement(c.e,{content:z,directionalHint:h.e.bottomCenter},r.createElement(u.e,{className:"analyticsStatsTeachingMessage_86ea3a8a",iconName:"Info","aria-describedby":z})),G,Y):r.createElement("div",{className:"analyticsStatsViews_86ea3a8a"},H+" "+X,r.createElement("span",{className:"analyticsStatsViewsDivider_86ea3a8a"}),P+" "+W,R&&r.createElement(c.e,{content:R,directionalHint:h.e.bottomCenter},r.createElement(u.e,{className:"analyticsStatsInfo_86ea3a8a",iconName:"Info","aria-describedby":R})))};y.defaultProps={isLink:!1};function b(e,t,n){var o=r.createElement(s.e,{activityDescription:r.createElement("div",{className:Object(m.e)("analyticsStatsLabel_86ea3a8a","analyticsStatsCount_86ea3a8a")},e),isCompact:!0});return t||n?r.createElement(i.e,{className:"analyticsStatsLink_86ea3a8a",href:n+"#comments",target:"_blank",onClick:t},o):r.createElement("div",{className:"analyticsStatsNoLink_86ea3a8a"},o)}function w(){return{details:f.Ne,viewer:f.Fe,viewers:f.Ie,view:f.Be,views:f.qe,comment:f.Ee,comments:f.Se,like:f.xe,likes:f.Te,apiError:f.te,suggestion:f.ke,unsupportMessage:f.He,accessActivity:f.Y,modifiedActivity:f.ye,activityTemplate:f.Z,inCompleteDataMessage:f.ae,throttledMessage:f.Le,trendingItem:f.Pe,loginUserYou:f.Re}}}],Array(22),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.none=0]="none";e[e.view=1]="view";e[e.edit=2]="edit";e[e.owner=3]="owner";e[e.review=6]="review";e[e.restrictedview=7]="restrictedview";e[e.submit=8]="submit";e[e.manageList=9]="manageList"})(r||(r={}))},,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.DeletedSingle=1]="DeletedSingle";e[e.DeletedAll=2]="DeletedAll";e[e.CommentsEnabled=3]="CommentsEnabled";e[e.CommentsDisabled=4]="CommentsDisabled"})(r||(r={}))},,function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r=n(109),i=n(48),s=!1,o=!1;function u(){if(!o){o=!0;(function(){if(s||!o)return;s=!0;new r.e({name:"ItemAnalytics.PageFinishedLoading",startTimeOverride:window._itemAnalyticsStartTime}).end({resultType:i.e.Success});try{window.external.PageFinishedLoading()}catch(e){window.parent.postMessage(JSON.stringify({name:"item_analytics_ready"}),"*")}})()}}function a(e){try{window.external.PageError(e,e.message)}catch(n){var t={name:"item_analytics_error",error:e,errorMessage:e.message};window.parent.postMessage(JSON.stringify(t),"*")}}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return i});function r(e,t){return e.getAccessToken(t,{apiVersion:"v2.1"})}function i(e,t){return e&&e.getItemUrl(t,{useDirectEndpoint:!0,apiVersion:"v2.1"})}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.fail=0]="fail";e[e.partialSuccess=1]="partialSuccess";e[e.success=2]="success"})(r||(r={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(4),i=n("react-lib"),s=n(886),o=n(25),u=n(1897),a=n(2069),f=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;n._root=i.createRef();n._stickyContentTop=i.createRef();n._stickyContentBottom=i.createRef();n._nonStickyContent=i.createRef();n._placeHolder=i.createRef();n.syncScroll=function(e){var t=n.nonStickyContent;t&&n.props.isScrollSynced&&(t.scrollLeft=e.scrollLeft)};n._getContext=function(){return n.context};n._onScrollEvent=function(e,t){if(n.root&&n.nonStickyContent){var r=n._getNonStickyDistanceFromTop(e),i=!1,s=!1;if(n.canStickyTop){i=r-n._getStickyDistanceFromTop()<e.scrollTop}n.canStickyBottom&&e.clientHeight-t.offsetHeight<=r&&(s=r-Math.floor(e.scrollTop)>=n._getStickyDistanceFromTopForFooter(e,t));document.activeElement&&n.nonStickyContent.contains(document.activeElement)&&(n.state.isStickyTop!==i||n.state.isStickyBottom!==s)?n._activeElement=document.activeElement:n._activeElement=void 0;n.setState({isStickyTop:n.canStickyTop&&i,isStickyBottom:s,distanceFromTop:r})}};n._getStickyDistanceFromTop=function(){var e=0;n.stickyContentTop&&(e=n.stickyContentTop.offsetTop);return e};n._getStickyDistanceFromTopForFooter=function(e,t){var r=0;n.stickyContentBottom&&(r=e.clientHeight-t.offsetHeight+n.stickyContentBottom.offsetTop);return r};n._getNonStickyDistanceFromTop=function(e){var t=0,r=n.root;if(r){for(;r&&r.offsetParent!==e;){t+=r.offsetTop;r=r.offsetParent}r&&r.offsetParent===e&&(t+=r.offsetTop)}return t};Object(s.e)(n);n.state={isStickyTop:!1,isStickyBottom:!1,distanceFromTop:void 0};n._activeElement=void 0;return n}Object.defineProperty(t.prototype,"root",{get:function(){return this._root.current},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"placeholder",{get:function(){return this._placeHolder.current},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"stickyContentTop",{get:function(){return this._stickyContentTop.current},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"stickyContentBottom",{get:function(){return this._stickyContentBottom.current},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"nonStickyContent",{get:function(){return this._nonStickyContent.current},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"canStickyTop",{get:function(){return this.props.stickyPosition===a.e.Both||this.props.stickyPosition===a.e.Header},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"canStickyBottom",{get:function(){return this.props.stickyPosition===a.e.Both||this.props.stickyPosition===a.e.Footer},enumerable:!0,configurable:!0});t.prototype.componentDidMount=function(){var e=this._getContext().scrollablePane;if(e){e.subscribe(this._onScrollEvent);e.addSticky(this)}};t.prototype.componentWillUnmount=function(){var e=this._getContext().scrollablePane;if(e){e.unsubscribe(this._onScrollEvent);e.removeSticky(this)}};t.prototype.componentDidUpdate=function(e,t){var n=this._getContext().scrollablePane;if(n){var r=this.state,i=r.isStickyBottom,s=r.isStickyTop,o=r.distanceFromTop,u=!1;if(t.distanceFromTop!==o){n.sortSticky(this,!0);u=!0}if(t.isStickyTop!==s||t.isStickyBottom!==i){this._activeElement&&this._activeElement.focus();n.updateStickyRefHeights();u=!0}u&&n.syncScrollSticky(this)}};t.prototype.shouldComponentUpdate=function(e,t){if(!this.context.scrollablePane)return!0;var n=this.state,r=n.isStickyTop,i=n.isStickyBottom,s=n.distanceFromTop;return r!==t.isStickyTop||i!==t.isStickyBottom||this.props.stickyPosition!==e.stickyPosition||this.props.children!==e.children||s!==t.distanceFromTop||l(this._nonStickyContent,this._stickyContentTop)||l(this._nonStickyContent,this._stickyContentBottom)||l(this._nonStickyContent,this._placeHolder)};t.prototype.render=function(){var e=this.state,t=e.isStickyTop,n=e.isStickyBottom,r=this.props,s=r.stickyClassName,u=r.children;return this.context.scrollablePane?i.createElement("div",{ref:this._root},this.canStickyTop&&i.createElement("div",{ref:this._stickyContentTop,style:{pointerEvents:t?"auto":"none"}},i.createElement("div",{style:this._getStickyPlaceholderHeight(t)})),this.canStickyBottom&&i.createElement("div",{ref:this._stickyContentBottom,style:{pointerEvents:n?"auto":"none"}},i.createElement("div",{style:this._getStickyPlaceholderHeight(n)})),i.createElement("div",{style:this._getNonStickyPlaceholderHeightAndWidth(),ref:this._placeHolder},(t||n)&&i.createElement("span",{style:o.M},u),i.createElement("div",{ref:this._nonStickyContent,className:t||n?s:void 0,style:this._getContentStyles(t||n)},u))):i.createElement("div",null,this.props.children)};t.prototype.addSticky=function(e){this.nonStickyContent&&e.appendChild(this.nonStickyContent)};t.prototype.resetSticky=function(){this.nonStickyContent&&this.placeholder&&this.placeholder.appendChild(this.nonStickyContent)};t.prototype.setDistanceFromTop=function(e){var t=this._getNonStickyDistanceFromTop(e);this.setState({distanceFromTop:t})};t.prototype._getContentStyles=function(e){return{backgroundColor:this.props.stickyBackgroundColor||this._getBackground(),overflow:e?"hidden":""}};t.prototype._getStickyPlaceholderHeight=function(e){var t=this.nonStickyContent?this.nonStickyContent.offsetHeight:0;return{visibility:e?"hidden":"visible",height:e?0:t}};t.prototype._getNonStickyPlaceholderHeightAndWidth=function(){var e=this.state,t=e.isStickyTop,n=e.isStickyBottom;if(t||n){var r=0,i=0;if(this.nonStickyContent&&this.nonStickyContent.firstElementChild){r=this.nonStickyContent.offsetHeight;i=this.nonStickyContent.firstElementChild.scrollWidth+(this.nonStickyContent.firstElementChild.offsetWidth-this.nonStickyContent.firstElementChild.clientWidth)}return{height:r,width:i}}return{}};t.prototype._getBackground=function(){if(this.root){for(var e=this.root;"rgba(0, 0, 0, 0)"===window.getComputedStyle(e).getPropertyValue("background-color")||"transparent"===window.getComputedStyle(e).getPropertyValue("background-color");){if("HTML"===e.tagName)return;e.parentElement&&(e=e.parentElement)}return window.getComputedStyle(e).getPropertyValue("background-color")}};t.defaultProps={stickyPosition:a.e.Both,isScrollSynced:!0};t.contextType=u.e;return t})(i.Component);function l(e,t){return e&&t&&e.current&&t.current&&e.current.offsetHeight!==t.current.offsetHeight}},function(e,t,n){"use strict";n.d(t,"e",function(){return f});n.d(t,"t",function(){return l});n.d(t,"n",function(){return c});var r=n(0),i=n(48),s=n(109),o={};function u(e){return o[e]}function a(e,t){o[e]=t}function f(e){var t=u(e);if(t){t.end({resultType:i.e.Failure});t=void 0}if(!t){var n={name:e};a(e,t=new s.e(n))}return t}function l(e){h(e,i.e.Success)}function c(e,t){h(e,i.e.Failure,t)}function h(e,t,n){var i=u(e);if(i){var s={resultType:t};n&&(s=Object(r.__assign)(Object(r.__assign)({},s),{resultCode:n.name||"Unknown",error:n.message||"Unknown",extraData:{errorStackTrace:n.stack}}));i.end(s);a(e,void 0)}}}],Array(33),[function(e,t,n){"use strict";n.d(t,"s",function(){return R});n.d(t,"u",function(){return U});n.d(t,"t",function(){return z});n.d(t,"n",function(){return W});n.d(t,"o",function(){return X});n.d(t,"h",function(){return V});n.d(t,"l",function(){return $});n.d(t,"f",function(){return J});n.d(t,"i",function(){return K});n.d(t,"r",function(){return Q});n.d(t,"c",function(){return G});n.d(t,"e",function(){return Y});n.d(t,"a",function(){return Z});var r=n(0),i=n("react-lib"),s=n("prop-types-lib"),o=n(1002),u=n(22),a=n(1648),f=n(287),l=n(705),c=n(129),h=n(1486),p=n(1919),d=n(1635),v=n(2353),m=n(1921),g=n(2056),y=n(974),b=n(996),w=(n(2123),(function(e){Object(r.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onRenderActivityDescription=function(){return i.createElement("div",{className:"od-ItemActivity-item-textContent"},t.props.reply.getDescription())};t._onRenderActivityTimeStamp=function(e,t){return t?t(e):null};t._onRenderHiddenTimeStamp=function(e,t){return null};return t}t.prototype.render=function(){var e=this.props,t=e.reply,n=e.hideDate,r=e.additionalClass,s=void 0===r?"":r;return i.createElement(a.e,{direction:f.e.horizontal,"data-is-focusable":!0,"aria-label":this._getAriaLabel()},i.createElement(g.e,{key:t.getKey(),className:"od-ItemActivity-item "+s,activityPersonas:this._activityPersonas(),onRenderActivityDescription:this._onRenderActivityDescription,timeStamp:this._onRenderDate(),onRenderTimeStamp:n?this._onRenderHiddenTimeStamp:this._onRenderActivityTimeStamp}))};t.prototype._onRenderDate=function(){var e=this.props.reply;return(y.e(e.getFriendlyDisplayTime()||"")||b.t(e.getDate())).toString()};t.prototype._getAriaLabel=function(){return this.props.reply.getDescription({stringOnly:!0}).join("")+" "+this._onRenderDate()};t.prototype._activityPersonas=function(){return[{imageUrl:this.props.reply.getPersonaImgUrl()}]};return t})(i.Component)),E=n(138);Object(E.n)([{rawString:".od-activityItem-replies-list .ms-List-cell{min-height:0}\n"}]);var S=n(37),x=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onFocus=function(){r._focusZone&&r._focusZone.focus()};r._onRenderCell=function(e,t){var n=r.props.onRenderUser,s=r.state,o=s.currentReplies,u=s.numberOfRepliesDisplayed,a=o.comments.length||0,f=u<=a&&a-u||0,l=new T({reply:e,onRenderUser:n});if(e&&t>=f)return i.createElement(w,{key:l.getKey(),reply:l,additionalClass:"od-ItemActivityList-commentReply"})};r._onSend=function(e,t,n){var i=r.props,s=i.parentComment,o=i.commentListItem,u=i.currentUserEmail;r._store&&r._store.addItemCommentReply({itemWrapper:o,currentUserEmail:u},s.id,e).then(function(e){r._store.fetchItemCommentReplies({itemWrapper:o,currentUserEmail:u,startIndex:0},s.id);t&&t()},function(e){var t=e&&e.message&&e.message.value;n&&n(t)})};r._onShowMore=function(){var e=r.props,t=e.onShowMore,n=e.parentComment,i=e.commentListItem,s=e.currentUserEmail,o=r.state.currentReplies,u=r.state.numberOfRepliesDisplayed;if(u<o.comments.length){r.setState({numberOfRepliesDisplayed:10*Math.floor(u/10)+10});o.nextLink&&r._store.fetchItemCommentReplies({itemWrapper:i,currentUserEmail:s},n.id)}t&&t()};r._store=n.itemCommentsStore;r._engagementSource=n.engagementSource||"";var s=t.parentComment,o=t.commentListItem,u=t.currentUserEmail;r._environment=t.environment;var a=r._store.getItemCommentReplies({itemWrapper:o,currentUserEmail:u},s.id),f=a&&a.comments&&a.comments.length,l=f?2:0;r.state={numberOfRepliesDisplayed:l,currentReplies:a,hasMore:l<f};return r}t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.parentComment.id!==this.props.parentComment.id&&this._addListener()};t.prototype.componentDidMount=function(){this._addListener()};t.prototype.componentWillUnmount=function(){this._store.removeRepliesListener(this._storeListener)};t.prototype.UNSAFE_componentWillUpdate=function(){this._focusElement=void 0};t.prototype.render=function(){var e=this.props,t=e.isReadonly,n=e.parentComment,r=this.state.currentReplies.comments||[],s=r.map(function(e){try{return e.action.comment.commentDetail}catch(e){}}),o="sharePointList"===this._environment,u="consumer"===this._environment;return i.createElement("div",{"data-is-focusable":!u&&!o,key:"activityResponse_"+n.id,onFocus:this._onFocus,"aria-label":m.activityCommentRepliesList,"aria-hidden":u||o},i.createElement(a.e,{componentRef:this._resolveRef("_focusZone"),className:Object(S.e)("od-ItemActivityList-activity-commentResponse",{"od-ItemActivityList-activity-withHiddenReply":u||o}),direction:f.e.vertical,isCircularNavigation:!1,handleTabKey:f.t.inputOnly,shouldInputLoseFocusOnArrowKey:function(e){return!0},isInnerZoneKeystroke:function(e){return e.which===Object(l.t)(c.e.right)}},this._getShowMoreLink(),r&&r.length>0&&i.createElement(p.e,{componentRef:!this._focusElement&&this._resolveRef("_focusElement"),className:"od-activityItem-replies-list",items:s,onRenderCell:this._onRenderCell}),!t&&!u&&!o&&i.createElement(v.e,{componentRef:!this._focusElement&&this._resolveRef("_focusElement"),commentItemId:n&&n.id,placeholderText:m.replyPlaceholder,sendButtonTitle:"",onSend:this._onSend,engagementSource:this._engagementSource+".AddReply"})))};t.prototype._addListener=function(){var e=this,t=this.props,n=t.parentComment,r=t.commentListItem,i=t.currentUserEmail;this._storeListener=this._store.addRepliesListener(function(){var t=e._store.getItemCommentReplies({itemWrapper:r,currentUserEmail:i},n.id),s=t.comments&&t.comments.length;e.setState({currentReplies:t,numberOfRepliesDisplayed:s>2?e.state.numberOfRepliesDisplayed:s,hasMore:!!t.nextLink||t.comments.length>e.state.numberOfRepliesDisplayed})},{item:r.activityItemWrapper,currentUserEmail:i},n.id)};t.prototype._getShowMoreLink=function(){this.props.parentComment;var e,t=this.state,n=t.currentReplies;if(t.numberOfRepliesDisplayed<(null===(e=n.comments)||void 0===e?void 0:e.length)||n.nextLink)return i.createElement("div",{className:"od-ItemActivityList-commentReply od-ItemActivityList-loadMoreReplies"},i.createElement(d.e,{componentRef:!this._focusElement&&this._resolveRef("_focusElement"),onClick:this._onShowMore,href:"javascript:void(0)"},m.commentRepliesGetMore))};t.contextTypes={itemCommentsStore:s.any,engagementSource:s.any};return t})(h.e),T=(function(){function e(e){var t=this;this._renderUser=function(e,n){var r=e.user;r||(r=t._getReplyAuthor());return t._renderUserLabel(r,{stringOnly:!1})};this._commentReply=e.reply;this._onRenderUser=e.onRenderUser}e.prototype.getKey=function(){return"Comment"+this._commentReply.parentId+"_Reply"+this._commentReply.id};e.prototype.getPersonaImgUrl=function(){var e=this._commentReply.author;return Object(o.getUserPhotoUrl)(e.email)};e.prototype.getFriendlyDisplayTime=function(){return this._commentReply.friendlyDisplayTime};e.prototype.getDate=function(){return this._commentReply.createdDate};e.prototype.getDescription=function(e){void 0===e&&(e={stringOnly:!1});var t=e.stringOnly,n=this._commentReply.text,r=this._getReplyAuthor(),s=this.renderUser(r,{stringOnly:t}),o=t?n:i.createElement("div",{className:"od-itemActivity-commentActivity-commentContent",dangerouslySetInnerHTML:{__html:n}});return r.self?u.formatToArray(m.youReplied,o):u.formatToArray(m.otherReplied,o,s)};e.prototype.renderUser=function(e,t){var n=t.stringOnly,r=this._renderUserLabel(e,{stringOnly:!0});return!e||n?r:i.createElement("span",{"aria-label":r},this._onRenderUser({user:e},this._renderUser))};e.prototype._renderUserLabel=function(e,t){var n,r=t.stringOnly;n=e&&e.self?m.youUpperCase:e&&e.displayName?e.displayName:e&&e.email?e.email:m.someoneUpperCase;return r?n:i.createElement("span",{className:"od-ItemActivity-item-nameText"},n)};e.prototype._getReplyAuthor=function(){return this._commentReply.author};return e})(),N=n(1508),C=n(1503),k=n(1871),L=n(1699),A=n(1739),O=n(97),M=n(133);Object(E.n)([{rawString:".od-itemActivityMenu-dialogButton-default{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border:1px solid "},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-itemActivityMenu-dialogButton-default:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-itemActivityMenu-dialogButton-default:active{background-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-itemActivityMenu-dialogButton-primary{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-itemActivityMenu-dialogButton-primary:hover{background-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-itemActivityMenu-dialogButton-primary:active{background-color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.spo-ItemActivity-menuItems{min-width:120px;padding:0}\n"}]);var _=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onDismissDialog=function(){r.setState({hideDialog:!0})};r.state={dialogTitle:"",dialogConfirm:"",onDialogConfirm:void 0,hideDialog:!0};return r}t.prototype.render=function(){var e=this,t=this.state,n=t.dialogTitle,r=t.dialogConfirm,s=t.onDialogConfirm,o=t.hideDialog,u=this.props.environment,a=this._getMenuItems(),f="sharePointList"===u,l="consumer"===u;if(a)return i.createElement(i.Fragment,null,i.createElement(N.e,{className:Object(S.e)("od-ItemActivity-contextMenu",{"od-ItemActivity-contextMenu-opacity":l||f}),role:"button",iconProps:{iconName:"More"},onRenderMenuIcon:function(){},title:m.activityMenuAriaLabel,menuProps:{directionalHint:O.e.bottomAutoEdge,isBeakVisible:!1,gapSpace:0,shouldFocusOnMount:!0,items:a,styles:{root:f?"spo-ItemActivity-menuItems":"od-ItemActivity-menuItems"}}}),i.createElement(k.e,{hidden:o,onDismiss:this._onDismissDialog,dialogContentProps:{type:L.e.normal,title:n}},i.createElement(A.e,null,i.createElement(C.e,{className:Object(S.e)({"od-itemActivityMenu-dialogButton-default":l||f}),disabled:!1,onClick:function(){s();e._onDismissDialog()},text:r||m.activityMenuDialogConfirm}),i.createElement(C.e,{className:Object(S.e)({"od-itemActivityMenu-dialogButton-primary":l||f}),disabled:!1,primary:!0,onClick:this._onDismissDialog,text:m.activityMenuDialogCancel}))))};t.prototype._getMenuItems=function(){var e=this,t=this.props,n=t.itemActivityMenuItems,r=t.activityId;return n.map(function(t){return{key:t.key,name:t.name,onClick:function(n,i){var s=t.dialogOnConfirm;t.dialogTitle&&s?e.setState({dialogTitle:t.dialogTitle,dialogConfirm:t.dialogConfirm,onDialogConfirm:s,hideDialog:!1}):t.onClickMenuOption&&t.onClickMenuOption(n,i);M.e.logData({name:"ActivityItemMenu."+t.name+".Click",isIntentional:!0,extraData:{activityId:r}})}}})};return t})(i.Component),D=n(1772),P=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onDialogConfirm=function(){r.props.dialogOnConfirm();r._onDismissDialog()};r._onShowDialog=function(){r.setState({hideDialog:!1})};r._onDismissDialog=function(){r.setState({hideDialog:!0})};r.state={hideDialog:!0};return r}t.prototype.render=function(){var e=this.state.hideDialog,t=this.props,n=t.name,r=t.dialogTitle,s=t.dialogConfirm,o=t.environment,u="sharePointList"===o,a="consumer"===o;return i.createElement(i.Fragment,null,i.createElement(N.e,{className:Object(S.e)("od-ItemActivity-contextMenu",{"od-ItemActivity-contextMenu-opacity":a||u}),iconProps:{iconName:"Delete"},title:n,onClick:this._onShowDialog}),i.createElement(k.e,{hidden:e,onDismiss:this._onDismissDialog,dialogContentProps:{type:L.e.close,title:r,subText:m.deleteCommentDialogPrompt}},i.createElement(A.e,null,i.createElement(D.e,{className:Object(S.e)({"od-itemActivityMenu-dialogButton-primary":a}),disabled:!1,onClick:this._onDialogConfirm,text:s}),i.createElement(C.e,{autoFocus:!0,className:Object(S.e)({"od-itemActivityMenu-dialogButton-default":a}),disabled:!1,onClick:this._onDismissDialog,text:m.activityMenuDialogCancel}))))};return t})(i.PureComponent),H=n(527),B=n(1547),j=n(653),F=n(2215);function I(e){return e?1:3}var q=(function(){function e(e){var t=this;this._onRenderUser=function(e,n){var r=e.user;return t._getUserLabel(r,{stringOnly:!1,isAccusative:e.isAccusative})};this.activity=e.activity;this.currentUserEmail=e.currentUserEmail;this.containingItem=e.containingItem;this.isSingleLevel=e.isSingleLevel;this.canOpenItem=e.canOpenItem;this.onItemClick=e.onItemClick;this.strings=e.strings;this.onRenderUser=e.onRenderUser;this.populateItemNameToDisplay=e.populateItemNameToDisplay;this.currentListTitle=e.currentListTitle;this.currentRootTitle=e.currentRootTitle;this.defaultItemTitle=e.defaultItemTitle;this.commentListItem=e.commentListItem;this.isReadonly=e.isReadonly;this.canDeleteActivity=e.canDeleteActivity;this.activityMenuFunctions=e.activityMenuFunctions;this.isNewCommentExperienceEnabled=e.isNewCommentExperienceEnabled;this.isAtMentionEnabled=!!e.isAtMentionEnabled;this.environment=e.environment;this.getpersonaIconUrl=e.getpersonaIconUrl;this.displayLargeText=e.displayLargeText;this.isListItem=e.isSingleLevel&&"sharePointList"===e.environment}e.prototype.getKey=function(){return this.activity.id};e.prototype.getTitle=function(e){void 0===e&&(e={});return this.getDescription(e)};e.prototype.getDescription=function(e){void 0===e&&(e={});return[]};e.prototype.getIconName=function(){return"ActivityFeed"};e.prototype.getPersonaIconUrl=function(){};e.prototype.getDate=function(){return this.activity.time};e.prototype.getFriendlyDisplayTime=function(){return this.activity.friendlyDisplayTime};e.prototype.getActivityTypeString=function(){return""};e.prototype.getResponse=function(){};e.prototype.getContextualMenu=function(){};e.prototype.getenvironment=function(){return this.environment};e.prototype.getCommentAuthorName=function(){};e.prototype.getcommentAuthorEmail=function(){};e.prototype.getCommentThreadId=function(){};e.prototype._getFilteredActors=function(e){for(var t,n,r=e.actors,i=void 0===r?this.activity.actors||[]:r,s=e.isCompact,o=[],u=0,a=i;u<a.length;u++){var f=a[u];f&&f.self?t=f:o.push(f)}t&&(o=[t].concat(o));var l=I(s);o.length>l&&(n=o.slice(l,o.length));return{youUser:t,additionalUsers:n,sortedUsers:o.length?o:[void 0]}};e.prototype._getAdditionalUsersTooltip=function(e,t){var n=t.stringOnly,r=t.isCompact,s=t.hideDate,o=t.isAccusative,a=void 0!==o&&o,f=r&&s?a?u.getLocalizedCountValue(this.strings.andOtherUsersCountFormShortAccusative,this.strings.otherActorsCountFormShortIntervals,e.length):u.getLocalizedCountValue(this.strings.andOtherActorsCountFormShort,this.strings.otherActorsCountFormIntervals,e.length):a?u.getLocalizedCountValue(this.strings.andOtherUsersCountFormAccusative,this.strings.otherActorsCountFormShortIntervals,e.length):u.getLocalizedCountValue(this.strings.andOtherActorsCountForm,this.strings.otherActorsCountFormIntervals,e.length),l=u.formatToArray(f,e.length);if(n)return l;var c={onRenderContent:function(){var t=e.map(function(e){return i.createElement("li",null,e.displayName)});return i.createElement("ul",{className:"od-ItemActivity-otherActors"},t)},id:Object(j.e)("otherUsersTooltip")};return i.createElement(B.e,{tooltipProps:c,id:c.id},i.createElement("span",{className:"od-ItemActivity-n-Others","aria-describedby":c.id,"data-is-focusable":!0},l))};e.prototype.getRenderedUsers=function(e,t){var n=this,r=t.stringOnly,i=t.isAccusative,s=t.isActor;return e&&0!==e.length?e.map(function(e,t){return n.renderUser(e,{stringOnly:r,isAccusative:i,isActor:s},t)||""}):[this.renderUser(void 0)]};e.prototype.renderUser=function(e,t,n){void 0===n&&(n=0);var r=this.onRenderUser,s=void 0===r?this._onRenderUser:r,o=t.stringOnly,u=t.isAccusative,a=t.isActor,f=this._getUserLabel(e,{stringOnly:!0,isAccusative:u});if(!e||o)return f;var l=(a?"_actor":"_")+n;return i.createElement("span",{key:e.email+l,"aria-label":f},s({user:e,isAccusative:u},this._onRenderUser))};e.prototype.renderMainItemLink=function(e,t,n){return this.isSingleLevel?e:u.formatToArray(t,this.renderItemLink({item:this.activity.item,stringOnly:n}))};e.prototype.renderItemLink=function(e){var t=this,n=e.item,r=e.itemLabel,s=e.stringOnly,o=e.keyPrefix,u=void 0===o?"":o,a=r;if(!a&&n&&!n.name&&this.populateItemNameToDisplay){this.populateItemNameToDisplay(n);a=n.name}a||(a=n&&n.isRoot?this._getRootFolderName():void 0);a||(a=n&&n.name?n.name:this._getDefaultItemName());if(a){if(s)return a;var f=void 0;if("string"==typeof a){f=a;var l=void 0,c=void 0;if(-1!==a.indexOf(".")){var h=a.split(".");l=h.slice(0,-1).join();c=h.slice(-1).join()}else{l=a;c=""}l.length>40&&(a=l.slice(0,37).concat("...").concat(c))}var p=a;if(this.canOpenItem&&this.canOpenItem(n)){var v=void 0;v=f?i.createElement("span",{className:"od-ItemActivity-item-textContent}",title:f}," ",a," "):i.createElement("span",{className:"od-ItemActivity-item-textContent}"}," ",a," ");return i.createElement(d.e,{key:u+"_"+p+"_link",className:Object(S.e)("od-ItemActivity-item-linkText","od-ItemActivity-item-clickableLinkText"),onClick:function(){return t.onItemClick(n,t.getActivityTypeString())},href:"javascript:void(0)"},v)}return f?i.createElement("span",{key:u+"_"+p+"_string",className:"od-ItemActivity-item-linkText",title:f},a):i.createElement("span",{key:u+"_"+p+"_string",className:"od-ItemActivity-item-linkText"},a)}};e.prototype._getRootFolderName=function(){return this.currentRootTitle};e.prototype._getDefaultItemName=function(){return(this.currentListTitle?this.currentListTitle:this.defaultItemTitle)||void 0};e.prototype._getUserLabel=function(e,t){var n,r=t.stringOnly,s=t.isAccusative;n=e&&e.self?s?this.strings.you:this.strings.youUpperCase:e&&e.displayName?e.displayName:e&&e.email?e.email:this.strings.someoneUpperCase;return r?n:i.createElement("span",{className:"od-ItemActivity-item-nameText"},n)};return e})(),R=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,i=t.stringOnly,s=t.hideDate,o=this.strings.editThisFile;this.isListItem&&(o=this.strings.thisItem);var a,f=this.renderMainItemLink(o,this.strings.editArbitraryFile,i),l=this._getFilteredActors({isCompact:n}),c=l.youUser,h=l.sortedUsers,p=l.additionalUsers,d=I(n);if(h.length>d){var v=n?!this.isNewCommentExperienceEnabled&&c?this.strings.youEditedCountFormShort:this.strings.othersEditedCountFormShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youEditedCountForm:this.strings.othersEditedCountForm;return u.formatToArray.apply(H,Object(r.__spreadArrays)([v,f],this.getRenderedUsers(h.slice(0,d),{stringOnly:i,isActor:!0}),[this._getAdditionalUsersTooltip(p,{stringOnly:i,isCompact:n,hideDate:s})]))}var m=n?!this.isNewCommentExperienceEnabled&&c?this.strings.youEditedListFormShort:this.strings.othersEditedListFormShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youEditedListForm:this.strings.othersEditedListForm;a=u.getLocalizedCountValue(m,n?this.strings.editedListFormShortIntervals:this.strings.editedListFormIntervals,h.length);return u.formatToArray.apply(H,Object(r.__spreadArrays)([a,f],this.getRenderedUsers(h,{stringOnly:i,isActor:!0})))};t.prototype.getIconName=function(){return"Edit"};t.prototype.getActivityTypeString=function(){return"edit"};return t})(q),U=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t,n=void 0===e?{}:e,r=n.isCompact,i=n.stringOnly,s=this.renderMainItemLink(this.strings.moveThisFile,this.strings.moveArbitraryFile,i),o=this._getFilteredActors({isCompact:r}),a=o.youUser,f=this.renderUser(o.sortedUsers[0],{stringOnly:i,isActor:!0});if(!r&&this.activity.action&&this.activity.action.move){var l=this.activity.action.move;if(l.from&&l.to){var c=this.renderItemLink({item:l.from,stringOnly:i,keyPrefix:"old"}),h=this.renderItemLink({item:l.to,stringOnly:i});t=!this.isNewCommentExperienceEnabled&&a?this.strings.youMovedFromFolderToFolder:this.strings.otherMovedFromFolderToFolder;return u.formatToArray(t,s,f,c,h)}if(l.from){c=this.renderItemLink({item:l.from,stringOnly:i,keyPrefix:"old"});t=!this.isNewCommentExperienceEnabled&&a?this.strings.youMovedFromFolder:this.strings.otherMovedFromFolder;return u.formatToArray(t,s,f,c)}if(l.to){h=this.renderItemLink({item:l.to,stringOnly:i});t=!this.isNewCommentExperienceEnabled&&a?this.strings.youMovedToFolder:this.strings.otherMovedToFolder;return u.formatToArray(t,s,f,void 0,h)}}t=r?!this.isNewCommentExperienceEnabled&&a?this.strings.youMovedShort:this.strings.otherMovedShort:!this.isNewCommentExperienceEnabled&&a?this.strings.youMoved:this.strings.otherMoved;return u.formatToArray(t,s,f)};t.prototype.getIconName=function(){return"FabricMovetoFolder"};t.prototype.getActivityTypeString=function(){return"move"};return t})(q),z=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,i=t.stringOnly,s=t.hideDate,o=this.strings.commentedOnThisFile;this.isListItem&&(o=this.strings.thisItem);var a,f,l=this.renderMainItemLink(o,this.strings.commentedOnArbitraryFile,i),c=this._getFilteredActors({isCompact:n}),h=c.youUser,p=c.sortedUsers,d=c.additionalUsers,v=I(n),m=this._isOnFileComment();if(m&&p.length<=1){var g=void 0;if(n)a=!this.isNewCommentExperienceEnabled&&h?this.strings.youCommentedListFormShort:this.strings.othersCommentedListFormShort;else{var y=this._getCommentMessage(i);if(this.isSingleLevel&&y){g=y;a=!this.isNewCommentExperienceEnabled&&h?this.strings.youCommentedOnThisFile:this.strings.othersCommentedOnThisFile}else{g=l;a=!this.isNewCommentExperienceEnabled&&h?this.strings.youCommentedOnFile:this.strings.othersCommentedOnFile}}f=u.formatToArray.apply(H,Object(r.__spreadArrays)([a,g],this.getRenderedUsers(p,{stringOnly:i,isActor:!0})))}else if(p.length>v){var b=n?!this.isNewCommentExperienceEnabled&&h?this.strings.youCommentedCountFormShort:this.strings.othersCommentedCountFormShort:!this.isNewCommentExperienceEnabled&&h?m?this.strings.youCommentedCountFormOnItem:this.strings.youCommentedCountForm:m?this.strings.othersCommentedCountFormOnItem:this.strings.othersCommentedCountForm;f=u.formatToArray.apply(H,Object(r.__spreadArrays)([b,l],this.getRenderedUsers(p.slice(0,v),{stringOnly:i,isActor:!0}),[this._getAdditionalUsersTooltip(d,{stringOnly:i,isCompact:n,hideDate:s})]))}else{var w=n?!this.isNewCommentExperienceEnabled&&h?this.strings.youCommentedListFormShort:this.strings.othersCommentedListFormShort:!this.isNewCommentExperienceEnabled&&h?m?this.strings.youCommentedListFormOnItem:this.strings.youCommentedListForm:m?this.strings.othersCommentedListFormOnItem:this.strings.othersCommentedListForm;a=u.getLocalizedCountValue(w,n?this.strings.commentedListFormShortIntervals:this.strings.commentedListFormIntervals,p.length);f=u.formatToArray.apply(H,Object(r.__spreadArrays)([a,l],this.getRenderedUsers(p,{stringOnly:i,isActor:!0})))}return f};t.prototype.getIconName=function(){if(this.isNewCommentExperienceEnabled){var e=this._getCommentDetail();return this.commentListItem&&e?void 0:"Comment"}return this.commentListItem?void 0:"Comment"};t.prototype.getPersonaIconUrl=function(){var e=this._getCommentDetail();if(void 0===this.getpersonaIconUrl){var t=this.commentListItem&&e&&e.author.email;return t&&Object(o.getUserPhotoUrl)(t)||void 0}var n=this.commentListItem&&e&&e.author.id;return n&&this.getpersonaIconUrl(n)||void 0};t.prototype.getActivityTypeString=function(){return"comment"};t.prototype.getContextualMenu=function(){var e=this,t=[],n=this.activityMenuFunctions&&this.activityMenuFunctions.delete,s=this.activity&&this.activity.action&&this.activity.action.comment&&this.activity.action.comment.commentId;if(this.canDeleteActivity&&this.canDeleteActivity(this.activity.type)&&n&&this.commentListItem&&s){var o={key:"od-itemActivity.deleteComment"+s,name:m.activityMenuOptionDelete,dialogTitle:m.deleteCommentDialogTitle,dialogConfirm:m.deleteCommentConfirm,dialogOnConfirm:function(){return n(e.commentListItem.activityItemWrapper,e.currentUserEmail,{commentItem:e.commentListItem,commentId:s})}};t.push(o)}return this.isNewCommentExperienceEnabled&&1===t.length?i.createElement(P,Object(r.__assign)({},t[0],{environment:this.environment})):t.length?i.createElement(_,{itemActivityMenuItems:t,activityId:this.activity.id,environment:this.environment}):void 0};t.prototype.getResponse=function(e){void 0===e&&(e=!1);var t=this._getCommentDetail(),n=t&&t.replies&&t.replies.comments&&t.replies.comments.length>0;if(this.commentListItem&&t&&(n||!this.isReadonly))return i.createElement(x,{key:this.containingItem.graphItemUrl+"_"+t.id,parentComment:t,commentListItem:this.commentListItem,currentUserEmail:this.currentUserEmail,onRenderUser:this.onRenderUser,isReadonly:this.isReadonly,environment:this.environment})};t.prototype.getCommentAuthorName=function(){var e=this._getCommentDetail();if(e&&e.author)return e.author.displayName};t.prototype.getcommentAuthorEmail=function(){var e=this._getCommentDetail();if(e&&e.author)return e.author.email};t.prototype.getCommentThreadId=function(){return this.activity&&this.activity.action&&this.activity.action.comment&&this.activity.action.comment.commentId};t.prototype._getCommentMessage=function(e){void 0===e&&(e=!1);var t=this._getCommentDetail();if(t&&t.text){if(e){var n=void 0;n="sharePoint"===this.environment||"sharePointList"===this.environment?F.e.htmlDecodeFromString(t.text):t.text;this.isAtMentionEnabled&&t.mentioned&&(n=n.replace(/@mention{(\d+)}/g,function(e,n){var r=parseInt(n),i=t.mentioned[r];return i?"@"+(i.displayName||i.email):e}));return n}return!0===this.isNewCommentExperienceEnabled&&this.displayLargeText?i.createElement("div",{className:"od-itemActivity-commentActivity-commentContent",key:"commentContent_"+this.getKey()},this.displayLargeText({seeMoreText:this.strings.seeMoreLabel,seeLessText:this.strings.seeLessLabel,text:"sharePointList"===this.environment?F.e.htmlDecodeFromString(t.text):t.text,mentioned:t.mentioned,isAtMentionEnabled:this.isAtMentionEnabled,environment:this.environment,onRenderUser:this.onRenderUser})):i.createElement("div",{className:"od-itemActivity-commentActivity-commentContent",dangerouslySetInnerHTML:{__html:t.text},key:"commentContent_"+this.getKey()})}};t.prototype._getCommentDetail=function(){var e=this.activity.action;return e&&e.comment&&e.comment.commentDetail};t.prototype._isOnFileComment=function(){var e=this.activity.action&&this.activity.action.comment;return!(!e||!e.commentId)};return t})(q),W=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,i=t.stringOnly,s=t.hideDate,o=this.activity.action.commentResponse,a=this._getFilteredActors({isCompact:n}),f=a.youUser,l=a.sortedUsers,c=a.additionalUsers,h=I(n),p=this.renderItemLink({item:this.activity.item,itemLabel:this.strings.commentResponseComment,stringOnly:i});if(o&&o.commentAuthor){var d=o.commentAuthor.self,v=this.renderUser(o.commentAuthor,{stringOnly:i,isAccusative:!0}),m=void 0;if(l.length>h){m=d?n?!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToYouCountFormShort:this.strings.otherRepliedToYouCountFormShort:!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToYouCountForm:this.strings.otherRepliedToYouCountForm:n?!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToOtherCountFormShort:this.strings.otherRepliedToOtherCountFormShort:!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToOtherCountForm:this.strings.otherRepliedToOtherCountForm;var g=Object(r.__spreadArrays)([v],this.getRenderedUsers(l.slice(0,h),{stringOnly:i,isActor:!0}),[this._getAdditionalUsersTooltip(c,{stringOnly:i,isCompact:n,hideDate:s})]);n||g.unshift(p);return u.formatToArray.apply(H,Object(r.__spreadArrays)([m],g))}var y=void 0;y=d?n?!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToYouListFormShort:this.strings.otherRepliedToYouListFormShort:!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToYouListForm:this.strings.otherRepliedToYouListForm:n?!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToOtherListFormShort:this.strings.otherRepliedToOtherListFormShort:!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToOtherListForm:this.strings.otherRepliedToOtherListForm;m=u.getLocalizedCountValue(y,n?this.strings.commentResponseListFormShortIntervals:this.strings.commentResponseListFormIntervals,l.length);g=Object(r.__spreadArrays)([v],this.getRenderedUsers(l.slice(0,h),{stringOnly:i,isActor:!0}));n||g.unshift(p);return u.formatToArray.apply(H,Object(r.__spreadArrays)([m],g))}m=void 0;if(l.length>h){m=n?!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToMissingAuthorCountFormShort:this.strings.otherRepliedToMissingAuthorCountFormShort:!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToMissingAuthorCountForm:this.strings.otherRepliedToMissingAuthorCountForm;return u.formatToArray.apply(H,Object(r.__spreadArrays)([m,p],this.getRenderedUsers(l.slice(0,h),{stringOnly:i,isActor:!0}),[this._getAdditionalUsersTooltip(c,{stringOnly:i,isCompact:n,hideDate:s})]))}y=n?!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToMissingAuthorListFormShort:this.strings.otherRepliedToMissingAuthorListFormShort:!this.isNewCommentExperienceEnabled&&f?this.strings.youRepliedToMissingAuthorListForm:this.strings.otherRepliedToMissingAuthorListForm;m=u.getLocalizedCountValue(y,n?this.strings.commentResponseListFormShortIntervals:this.strings.commentResponseListFormIntervals,l.length);return u.formatToArray.apply(H,Object(r.__spreadArrays)([m,p],this.getRenderedUsers(l,{stringOnly:i,isActor:!0})))};t.prototype.getIconName=function(){return"Reply"};t.prototype.getActivityTypeString=function(){return"commentResponse"};return t})(q),X=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,i=t.stringOnly,s=t.hideDate,o=this.strings.mentionedThisFile;this.isListItem&&(o=this.strings.thisItem);var a,f=this.renderMainItemLink(o,this.strings.mentionArbitraryFile,i),l=this._getFilteredActors({actors:this.activity.action.mention.mentionees,isCompact:n}),c=this.getRenderedUsers(l.sortedUsers,{stringOnly:i}),h=l.youUser,p=l.additionalUsers,d=this._getFilteredActors({isCompact:n}),v=d.youUser,m=d.sortedUsers,g=I(n);if(c.length>g){var y;y=h?n?!this.isNewCommentExperienceEnabled&&v?this.strings.youMentionedOthersCountFormShort:this.strings.othersMentionedYouAndOthersCountFormShort:!this.isNewCommentExperienceEnabled&&v?this.strings.youMentionedYouAndOthersCountForm:v?this.strings.youMentionedYourselfAndOthersCountForm:this.strings.othersMentionedYouAndOthersCountForm:n?!this.isNewCommentExperienceEnabled&&v?this.strings.youMentionedOthersCountFormShort:this.strings.othersMentionedOthersCountFormShort:!this.isNewCommentExperienceEnabled&&v?this.strings.youMentionedOthersCountForm:this.strings.othersMentionedOthersCountForm;return u.formatToArray.apply(H,Object(r.__spreadArrays)([y,f],this.getRenderedUsers(m,{stringOnly:i,isActor:!0}),c.slice(0,g),[this._getAdditionalUsersTooltip(p,{stringOnly:i,isCompact:n,hideDate:s})]))}var b=void 0;b=h?n?!this.isNewCommentExperienceEnabled&&v?this.strings.youMentionedYouListFormShort:this.strings.otherMentionedYouListFormShort:!this.isNewCommentExperienceEnabled&&v?this.strings.youMentionedYouAndOthersListForm:v?this.strings.youMentionedYourselfAndOthersListForm:this.strings.othersMentionedYouAndOthersListForm:n?!this.isNewCommentExperienceEnabled&&v?this.strings.youMentionedOthersListFormShort:this.strings.othersMentionedOthersListFormShort:!this.isNewCommentExperienceEnabled&&v?this.strings.youMentionedOthersListForm:this.strings.othersMentionedOthersListForm;a=u.getLocalizedCountValue(b,n?this.strings.mentionedListFormShortIntervals:this.strings.mentionedListFormIntervals,c.length);return u.formatToArray.apply(H,Object(r.__spreadArrays)([a,f],this.getRenderedUsers(m,{stringOnly:i,isActor:!0}),c.slice(0,g)))};t.prototype.getIconName=function(){return"Accounts"};t.prototype.getActivityTypeString=function(){return"mention"};return t})(q),V=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,r=t.stringOnly;if(this.activity.action&&this.activity.action.version&&this.activity.action.version.newVersion){var i=this._getFilteredActors({isCompact:n}),s=i.youUser,o=this.renderUser(i.sortedUsers[0],{stringOnly:r,isActor:!0}),a=n?!this.isNewCommentExperienceEnabled&&s?this.strings.youCreatedVersionShort:this.strings.otherCreatedVersionShort:!this.isNewCommentExperienceEnabled&&s?this.isSingleLevel?this.strings.youCreatedVersionThisFile:this.strings.youCreatedVersion:this.isSingleLevel?this.strings.otherCreatedVersionThisFile:this.strings.otherCreatedVersion,f=this.renderMainItemLink(this.strings.versionThisFile,this.strings.versionArbitraryFile,r),l=this.activity.action.version.newVersion;return u.formatToArray(a,f,o,l)}return[]};t.prototype.getIconName=function(){return"FabricMovetoFolder"};t.prototype.getActivityTypeString=function(){return"version"};return t})(q),$=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=(t.isCompact,t.stringOnly),r=this.strings.restoreThisFile;this.isListItem&&(r=this.strings.restoreThisItem);var i=this.renderMainItemLink(r,this.strings.restoreArbitraryFile,n),s=this.isSingleLevel?this.strings.thisFileRestored:this.strings.arbitraryFileRestored;return u.formatToArray(s,i)};t.prototype.getIconName=function(){return"Refresh"};t.prototype.getActivityTypeString=function(){return"restore"};return t})(q),J=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t,n=void 0===e?{}:e,r=n.isCompact,i=n.stringOnly,s=this._getFilteredActors({isCompact:r}),o=s.youUser,a=this.renderUser(s.sortedUsers[0],{stringOnly:i,isActor:!0});if(this.activity.action&&this.activity.action.rename&&this.activity.action.rename.oldItem){var f=this.renderItemLink({item:this.activity.action.rename.oldItem,stringOnly:i,keyPrefix:"old"}),l=this.renderItemLink({item:this.activity.item,stringOnly:i});t=r?!this.isNewCommentExperienceEnabled&&o?this.strings.youRenamedFileToFileShort:this.strings.otherRenamedFileToFileShort:!this.isNewCommentExperienceEnabled&&o?this.strings.youRenamedFileToFile:this.strings.otherRenamedFileToFile;return u.formatToArray(t,a,f,l)}var c=this.renderMainItemLink(this.strings.renameThisFile,this.strings.renameArbitraryFile,i);t=r?!this.isNewCommentExperienceEnabled&&o?this.strings.youRenamedFileShort:this.strings.otherRenamedFileShort:!this.isNewCommentExperienceEnabled&&o?this.strings.youRenamedFile:this.strings.otherRenamedFile;return u.formatToArray(t,a,c)};t.prototype.getIconName=function(){return"Rename"};t.prototype.getActivityTypeString=function(){return"restore"};return t})(q),K=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,r=t.stringOnly,i=this.strings.deleteThisFile;this.isListItem&&(i=this.strings.thisItem);var s=this.renderMainItemLink(i,this.strings.deleteArbitraryFile,r),o=this._getFilteredActors({isCompact:n}),a=o.youUser,f=this.renderUser(o.sortedUsers[0],{stringOnly:r,isActor:!0}),l=n?!this.isNewCommentExperienceEnabled&&a?this.strings.youDeletedShort:this.strings.otherDeletedShort:!this.isNewCommentExperienceEnabled&&a?this.strings.youDeleted:this.strings.otherDeleted;if(this.isSingleLevel)return u.formatToArray(l,s,f);var c=this.renderItemLink({item:this.activity.parentItem,stringOnly:r});l=!n&&c?!this.isNewCommentExperienceEnabled&&a?this.strings.youDeletedFromFolder:this.strings.otherDeletedFromFolder:l;return c?u.formatToArray(l,s,f,c):u.formatToArray(l,s,f)};t.prototype.getIconName=function(){return"Trash"};t.prototype.getActivityTypeString=function(){return"delete"};return t})(q),Q=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,r=t.stringOnly,i=this.strings.createThisFile;this.isListItem&&(i=this.strings.thisItem);var s=this.renderMainItemLink(i,this.strings.createArbitraryFile,r),o=this._getFilteredActors({isCompact:n}),a=o.youUser,f=this.renderUser(o.sortedUsers[0],{stringOnly:r,isActor:!0}),l=n?!this.isNewCommentExperienceEnabled&&a?this.strings.youCreatedShort:this.strings.otherCreatedShort:!this.isNewCommentExperienceEnabled&&a?this.strings.youCreated:this.strings.otherCreated;if(this.isSingleLevel)return u.formatToArray(l,s,f);var c=this.renderItemLink({item:this.activity.parentItem,stringOnly:r});l=!n&&c?!this.isNewCommentExperienceEnabled&&a?this.strings.youCreatedInLocation:this.strings.otherCreatedInLocation:l;return c?u.formatToArray(l,s,f,c):u.formatToArray(l,s,f)};t.prototype.getIconName=function(){return"Add"};t.prototype.getActivityTypeString=function(){return"create"};return t})(q),G=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,i=t.stringOnly,s=t.hideDate,o=this.strings.shareThisFile;this.isListItem&&(o=this.strings.thisItem);var a,f=this.renderMainItemLink(o,this.strings.shareArbitraryFile,i),l=this._getFilteredActors({isCompact:n}),c=l.youUser,h=this.activity.action.share.recipients;if(h&&h.length>0){var p=this.renderUser(l.sortedUsers[0],{stringOnly:i,isActor:!0}),d=this._getFilteredActors({actors:h,isCompact:n}),v=d.sortedUsers,m=d.youUser,g=d.additionalUsers,y=I(n);if(v.length>y){var b;b=m?n?!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedWithYouCountFormShort:this.strings.otherSharedWithYouCountFormShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedWithYouCountForm:this.strings.otherSharedWithYouCountForm:n?!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedWithOthersCountFormShort:this.strings.otherSharedWithOthersCountFormShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedWithOthersCountForm:this.strings.otherSharedWithOthersCountForm;return u.formatToArray.apply(H,Object(r.__spreadArrays)([b,f,p],this.getRenderedUsers(v.slice(0,y),{stringOnly:i,isAccusative:!0}),[this._getAdditionalUsersTooltip(g,{stringOnly:i,isCompact:n,hideDate:s,isAccusative:!0})]))}var w=void 0;w=m?n?!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedWithYouListFormShort:this.strings.otherSharedWithYouListFormShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedWithYouListForm:this.strings.otherSharedWithYouListForm:n?!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedWithOthersListFormShort:this.strings.otherSharedWithOthersListFormShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedWithOthersListForm:this.strings.otherSharedWithOthersListForm;var E=u.getLocalizedCountValue(w,n?this.strings.sharedWithOthersListFormShortIntervals:this.strings.sharedWithOthersListFormIntervals,v.length);return u.formatToArray.apply(H,Object(r.__spreadArrays)([E,f,p],this.getRenderedUsers(v,{stringOnly:i,isAccusative:!0})))}var S=l.sortedUsers,x=l.additionalUsers,T=I(n);if(S.length>T){a=n?!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedCountFormShort:this.strings.othersSharedCountFormShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedCountForm:this.strings.othersSharedCountForm;return u.formatToArray.apply(H,Object(r.__spreadArrays)([a,f],this.getRenderedUsers(S.slice(0,T),{stringOnly:i,isActor:!0}),[this._getAdditionalUsersTooltip(x,{stringOnly:i,isCompact:n,hideDate:s})]))}w=n?!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedListFormShort:this.strings.othersSharedListFormShort:!this.isNewCommentExperienceEnabled&&c?this.strings.youSharedListForm:this.strings.othersSharedListForm;a=u.getLocalizedCountValue(w,n?this.strings.sharedListFormShortIntervals:this.strings.sharedListFormIntervals,S.length);return u.formatToArray.apply(H,Object(r.__spreadArrays)([a,f],this.getRenderedUsers(S,{stringOnly:i,isActor:!0})))};t.prototype.getIconName=function(){return"Share"};t.prototype.getActivityTypeString=function(){return"share"};return t})(q),Y=((function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,r=t.stringOnly,i=this.renderMainItemLink(this.strings.shareThisFile,this.strings.createArbitraryFile,r),s=this._getFilteredActors({isCompact:n}),o=s.youUser,a=this.renderUser(s.sortedUsers[0],{stringOnly:r,isActor:!0}),f=n?!this.isNewCommentExperienceEnabled&&o?this.strings.youRestoredDocumentLibraryShort:this.strings.otherRestoredDocumentLibraryShort:!this.isNewCommentExperienceEnabled&&o?this.strings.youRestoredDocumentLibrary:this.strings.otherRestoredDocumentLibrary,l=this.activity.action&&this.activity.action.pointInTimeRestore,c=l&&l.restoreToDateTime;return u.formatToArray(f,a,i,b.r(c))};t.prototype.getIconName=function(){return"Refresh"};t.prototype.getActivityTypeString=function(){return"pointInTimeRestore"}})(q),(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,r=t.stringOnly,i=this.renderMainItemLink(this.strings.restoredVersionThisFile,this.strings.restoredVersionArbitraryFile,r),s=this._getFilteredActors({isCompact:n}),o=s.youUser,a=this.renderUser(s.sortedUsers[0],{stringOnly:r}),f=n?!this.isNewCommentExperienceEnabled&&o?this.strings.youRestoredVersionShort:this.strings.otherRestoredVersionShort:!this.isNewCommentExperienceEnabled&&o?this.strings.youRestoredVersion:this.strings.otherRestoredVersion,l=this.activity.action&&this.activity.action.restoreVersion,c=l&&l.fromVersion;return u.formatToArray(f,a,i,c)};t.prototype.getIconName=function(){return"Refresh"};t.prototype.getActivityTypeString=function(){return"restoreVesion"}})(q),(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,r=t.stringOnly,i=(t.hideDate,this.renderMainItemLink(this.strings.shortcutThisFolder,this.strings.shortcutArbitraryFolder,r)),s=this._getFilteredActors({isCompact:n}),o=s.youUser,a=this.renderUser(s.sortedUsers[0],{stringOnly:r}),f=n?!this.isNewCommentExperienceEnabled&&o?this.strings.youAddedAShortcutShort:this.strings.OtherAddedAShortcutShort:!this.isNewCommentExperienceEnabled&&o?this.strings.youAddedAShortcut:this.strings.OtherAddedAShortcut;return u.formatToArray(f,a,i)};t.prototype.getIconName=function(){return"FabricFolderLink"};t.prototype.getActivityTypeString=function(){return"addShortcutToOneDrive"};return t})(q)),Z=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,r=t.stringOnly,i=(t.hideDate,this.activity.action.removeShortcutFromOneDrive),s=this.renderItemLink({item:this.activity.item,itemLabel:i.mountPointName,stringOnly:r}),o=this._getFilteredActors({isCompact:n}),a=o.youUser,f=this.renderUser(o.sortedUsers[0],{stringOnly:r}),l=n?!this.isNewCommentExperienceEnabled&&a?this.strings.youRemovedAShortcutShort:this.strings.OtherRemovedAShortcutShort:!this.isNewCommentExperienceEnabled&&a?this.strings.youRemovedAShortcut:this.strings.OtherRemovedAShortcut;return u.formatToArray(l,f,s)};t.prototype.getIconName=function(){return"FabricFolderLink"};t.prototype.getActivityTypeString=function(){return"removeShortcutFromOneDrive"};return t})(q)},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(1956),i=n(4),s=n("react-lib"),o=n(1786),u=n(270),a=Object(r.e)(function(e){if(0===s.Children.count(e.children))return null;e.block,e.className;var t=e.as,n=void 0===t?"span":t,r=(e.variant,e.nowrap,Object(i.s)(e,["block","className","as","variant","nowrap"])),a=Object(o.t)(e,{root:n});return Object(o.n)(a.root,Object(i.e)({},Object(u.u)(r,u.a)))},{displayName:"Text",styles:function(e,t){var n=e.as,r=e.className,i=e.block,s=e.nowrap,o=e.variant,u=t.fonts[o||"medium"];return{root:[t.fonts.medium,{display:i?"td"===n?"table-cell":"block":"inline",fontFamily:u.fontFamily,fontSize:u.fontSize,fontWeight:u.fontWeight,color:u.color,mozOsxFontSmoothing:u.MozOsxFontSmoothing,webkitFontSmoothing:u.WebkitFontSmoothing},s&&{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},r]}}})},,function(e,t,n){"use strict";var r=n(0),i=n(888),s=n(391),o=n(46),u=n(1796),a=n(1794),f=n("knockout-lib"),l=n(52),c=n(1682),h=n(22),p=n(72),d=n(1651),v=n(476),m=n(219),g=n(2028),y=n(1661),b=n(2012),w=n(23),E=(function(e){Object(r.__extends)(t,e);function t(){var t=e.call(this)||this;t.keyboardOptions=[{target:null,mappings:{Enter:t.onKeyEnter}},{target:window,mappings:{}}];t.focusedTile=t.observables.create();t.focusableTiles=t.observables.createArray();return t}t.prototype.onKeyEnter=function(e,t){var n=e.keyNav.focusedTile();if(n){n.personaParams.inputEvent(t);n.personaParams.openContextMenu(!0)}t.stopPropagation();return!0};return t})(n(1649).n),S=n(1709),x=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.sharingApiErrorMessage=n.createObservable("");n._people=n.createObservable(Array());n.keyNav=new E;n.personaTileCollection=n._getPersonaTileCollection();n.personaTileByUser=n._getPersonaTileByUser();n.principalKeepSharing=n._getPrincipalKeepSharing();n.keyNav.focusableTiles=n.personaTileCollection;n.isNewSharingFlowEnabled=Object(o.isFeatureEnabled)(o.SharingDialogRedux);n.isLoading=f.observable(!1);n.scopes=f.observableArray();n.links=f.observableArray();n._scopesLinks=n.observables.createArray();n.hasFocus=t.hasFocus;n.personaSize=4;n.hasSettings=f.observable(!1);n.advancedUrl=f.observable("");n.canUnshare=f.observable(!1);n.showEmailLink=f.observable(!1);n.readPermissionsUpdated=n.createObservable(!1);n.updateComplete=n.createObservable("");n.canManagePermissions=n.createObservable(!1);n.hasInheritedLink=n.createObservable(!1);var r=n.resources.consume(s.e);n.privateDescription=n.createPureComputed(n._computeShareStatus);n._engagement=n.resources.consume(i.e);n._currentItemShareAction=n.isNewSharingFlowEnabled?new(n.managed(r.ShareByLinkAction)):new(n.managed(r.ShareAction));n._sharingProvider=n.resources.consume(a.resourceKey);n._item=t.item;n.isShareLinkVisible=n.createComputed(n._computeIsShareLinkVisible);n.fileItem=n._item();n.createComputed(function(){var e=n._item();n._onItemChanged(e)});n.totalNumberOfLinks=n.createPureComputed(n._computeTotalNumberOfLinks);n.statusText=n.createComputed(n._computeStatusText);n.fileName=n.createObservable("");n.personaTileKeepSharing=n.createComputed(n._getPersonaKeepSharing);n.keepSharingHasAccess=n.createComputed(n._getkeepSharingHasAccess);n.mailto=n.createComputed(function(){if(!n.hasSettings())return"";for(var e,t="mailto:",r=[],i=0,s=n.scopes();i<s.length;i++)for(var o=0,u=s[i].people;o<u.length;o++){var a=u[o];a.email&&r.push(a.email)}n.showEmailLink(r.length>0&&r.length<30);t+=p.e.encodeURIComponent(r.join(";"));t+="?subject="+p.e.encodeURIComponent(n._settings.itemName);e=v.e(n._settings.itemUrl);t+="&body="+p.e.encodeURIComponent(n._normalizeUrl(e));n.fileName(n._settings.itemName);n.canManagePermissions(n._settings.canManagePermissions);n.hasInheritedLink(n._settings.hasInheritedLink);n.sharingApiErrorMessage(n._settings.sharingApiErrorMessage);return t});return n}t.prototype.dispose=function(){e.prototype.dispose.call(this);if(this._getPermissionsPromise){this._sharingData.cancelGetPermissionsPromise();this._getPermissionsPromise=null}if(this._getLinksPromise){this._sharingData.cancelGetLinksPromise();this._getLinksPromise=null}};t.prototype.onLinkRemoved=function(){this._engagement.logData({name:"RemoveLinkFromPanel.Sharing.InfoPaneSection.Click",isIntentional:!0});this._onItemChanged(this._item.peek())};t.prototype.onScopeClick=function(e){this._executeShare(e);return!1};t.prototype.notifyPermissionsUpdated=function(){this.updateComplete(u.sharingPermissionsUpdated);this.readPermissionsUpdated(!0)};t.prototype.cleanPermissionsUpdated=function(){this.updateComplete("");this.readPermissionsUpdated(!1)};t.prototype.onShareClick=function(){this._executeShare(this._item.peek());return!1};t.prototype.stopSharing=function(e){this._engagement.logData({name:"StopSharing.Sharing.InfoPaneSection.Click",isIntentional:!0});this._stopSharingConfirm(e)};t.prototype.convertPersonToPersonaTile=function(e,t,n){return{personaParams:{inputEvent:this.observables.create(),openContextMenu:this.observables.create(!1),item:n,person:e,personaSize:this.personaSize,showPresence:!0,sharingRoleMenuRootElementClass:"OneDriveApp"},key:t,focused:this.observables.create(!1)}};t.prototype._computeIsShareLinkVisible=function(){return this._currentItemShareAction.isAvailable()};t.prototype._stopSharing=function(){return this._sharingProvider.unshare(this._item.peek())};t.prototype._stopSharingConfirm=function(e){var t=this,n=this.resources.consume(c.e),r=this._engagement,i=f.observable(!0);n.requestDialog({title:u.stopSharingConfirmationTitle,size:"Medium",component:{name:g.e.tagName,params:{message:u.stopSharingConfirmationMessage}},actions:[{name:u.stopSharingConfirmationButton,execute:function(){r.logData({name:"Unshare.Sharing.InfoPaneSection.Click",isIntentional:!0});i(!1);return t._stopSharing().then(function(n){t._item.peek().queryType===w.e.SharedByMe&&e();return 2},function(e){return 3})},isDefault:!0,isAvailable:i,icon:new y.e("Save"),automationId:"UnshareConfirm"},{name:u.stopSharingCancelButton,execute:function(){r.logData({name:"CancelStopSharing.Sharing.InfoPaneSection.Click",isIntentional:!0});return l.n.wrap(3)},isDefault:!1,icon:new y.e("Cancel"),automationId:"UnshareCancel"}],focusOnPrimaryAction:!0,dismissOnEsc:!0,shouldPreserveFocus:!0,executeDefaultAction:!1})};t.prototype._executeShare=function(e,t){void 0===t&&(t=this.resources);var n=this.resources.consume(s.e);(this.isNewSharingFlowEnabled?this.addDisposable(new(t.injected(n.ShareByLinkAction))):this.addDisposable(new(t.injected(n.ShareAction))({item:f.observable(e),startState:3}))).execute(null)};t.prototype._computeStatusText=function(){var e=this._item.peek(),t=this.isLoading(),n="",r=this.scopes();this._hasError&&(n=this._errorText);t?n=u.sharingLoadingStatus:0!==this.totalNumberOfLinks()||this._hasNonOwnerScopes(r)||(n=e.type===m.e.Folder?u.sharingUnsharedFolderStatus:u.sharingUnsharedFileStatus);return n};t.prototype._hasNonOwnerScopes=function(e){var t=!0,n=!1;e&&0!==e.length||(t=!1);if(t)for(var r=0;r<e.length&&!n;r++)for(var i=e[r].people,s=0;s<i.length&&!n;s++){0!==i[s].sharingInfo.role&&(n=!0)}return t&&n};t.prototype._computeShareStatus=function(){var e=this.scopes(),t="";if(0===this.totalNumberOfLinks()&&!this._hasNonOwnerScopes(e)&&0===this._item().sharingRole)if(e&&0!==e.length){if(1===e.length&&this._areAllOwners(e[0].people)){var n=e[0].people[0];t=1===e[0].people.length&&2===n.entityType?h.format(u.sharingUnsharedOwnedByGroup,n.name):u.sharingUnsharedNotShared}}else t=u.sharingUnsharedNotShared;return t};t.prototype._areAllOwners=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];if(r.sharingInfo&&0!==r.sharingInfo.role)return!1}return!0};t.prototype._computeTotalNumberOfLinks=function(){var e=this.links(),t=this._scopesLinks();return e.length+t.length};t.prototype._onItemChanged=function(e){var t=this;this.cleanPermissionsUpdated();if(this._getPermissionsPromise){this.isLoading(!1);this._sharingData.cancelGetPermissionsPromise();this._getPermissionsPromise=null}if(this._getLinksPromise){this._sharingData.cancelGetLinksPromise();this._getLinksPromise=null}if(e&&e.key!==this._itemKey){this._itemKey=e.key;this.scopes([]);this.links([]);this.isLoading(!0)}if(e){this._sharingData=this._sharingProvider.getSharingData(e);this._sharingData.getSettings().then(function(e){t._settings=e;t.advancedUrl(e.advancedUrl);t.hasSettings(!0)},function(e){});this._hasError=!1;this._getPermissionsPromise=this._sharingData.getPermissions();this._sharingData.doSharingScopesContainLinks()||(this._getLinksPromise=this._sharingData.getLinks());this.trackPromise(this._getPermissionsPromise.then(function(n){t.isLoading(!1);t.scopes(t._processScopes(e,n))},function(e){e&&403===e.status?t._errorText=u.accessDenied:e&&e.code&&e.code.indexOf("-2130575139")>-1?t._errorText=u.noscriptErrorStatus:t._errorText=u.serverError;t._hasError=!0;t.isLoading(!1)}));this._getLinksPromise&&this._getLinksPromise.then(function(e){e&&t.links(e.filter(function(e){return e.isActive&&8!==e.type}))},function(e){});this.fileItem=e}};t.prototype._processScopes=function(e,t){var n=this,i=[];t.length>0&&this.canUnshare(t[0].canUnshare);this._scopesLinks([]);for(var s=0;s<t.length;s++){var o=t[s];if(o&&o.people.length){var a=Object(r.__assign)(Object(r.__assign)({},o),{headerHtml:"",sharingPeople:[]});if(o.item&&o.item.key!==this._item.peek().key){var f;f="<span data-bind=\"component: { name: '"+b.e.tagName+"', params: { item: scope.item } }\"></span>";a.headerHtml=h.format(u.sharingScopeHeaderFormat,f)}o.people.forEach(function(e){var t;if(e.sharingInfo&&e.sharingInfo.link){var r=e.sharingInfo.link;11===r.type&&(r.email=null===(t=e.sharingInfo)||void 0===t?void 0:t.email);n._scopesLinks.push(r)}a.sharingPeople.push({personInfo:e,sharingItem:o.item})});i.push(a)}}for(var l=new Array,c=0;c<i.length;c++)l=l.concat(i[c].sharingPeople);this._people().length&&this.notifyPermissionsUpdated();this._people(l);return i};t.prototype._getkeepSharingHasAccess=function(){var e=this.personaTileKeepSharing(),t=this.totalNumberOfLinks();return e.length>0||t>0};t.prototype._getPersonaKeepSharing=function(){for(var e=this.principalKeepSharing(),t={},n=0,r=e;n<r.length;n++){t[(c=r[n]).personaParams.person().userId]=!0}for(var i=0,s=this.links();i<s.length;i++){var o=s[i];if(o.linkMembers)for(var u=0,a=o.linkMembers;u<a.length;u++){var f=a[u],l=f.userId,c=this.convertPersonToPersonaTile(this.createObservable(f),f.userId);if(!t[l]){t[l]=!0;e.push(c)}}}return e};t.prototype._getPrincipalKeepSharing=function(){return this._getPersonaTileHelper(!0)};t.prototype._getPersonaTileCollection=function(){return this._getPersonaTileHelper()};t.prototype._getPersonaTileHelper=function(e){var t=this,n=this.createPureComputed(e?this._getPeopleKeepSharing:this._getPeopleByUserId),i=this.observables.createArray();this.createBackgroundComputed(function(){i.splice.apply(i,Object(r.__spreadArrays)([0,i.peek().length],t._people().map(function(e){return e.personInfo.userId})))});return i.filter(function(e){return e in n()}).map({mappingWithDisposeCallback:function(e){var r=t.createObservable(),i=t.createComputed(function(){r(n()[e].personInfo||r.peek())});return{mappedValue:t.convertPersonToPersonaTile(r,e,n()[e].sharingItem),dispose:function(){i.dispose()}}}})};t.prototype._getPeopleKeepSharing=function(){return this._getPeopleByUserId(!1,!0)};t.prototype._getPeopleByUserId=function(e,t){for(var n={},r=0,i=this._people();r<i.length;r++){var s=i[r],o=s.personInfo,u=o&&o.sharingInfo;u&&3===u.type||(e&&o.principalType===S.e.sharePointGroup||t&&o&&o.sharingInfo&&0===o.sharingInfo.role||(n[o.userId]=s))}return n};t.prototype._getPersonaTileByUser=function(){var e=this;return this.createComputed(function(){for(var t={},n=0,r=e.personaTileCollection();n<r.length;n++){var i=r[n];t[i.key]=i}return t})};t.prototype._normalizeUrl=function(e){var t=document.createElement("A");t.href=e;return t.href};return t})(d.t);t.e=x},,function(e,t,n){"use strict";n.d(t,"e",function(){return h});var r=n("react-lib"),i=n(472),s=n(1419),o=n(1508),u=n(25),a=n(227),f=n(705),l={root:"ms-TagItem",text:"ms-TagItem-text",close:"ms-TagItem-close",isSelected:"is-selected"};var c=Object(i.e)(),h=Object(s.e)(function(e){var t=e.theme,n=e.styles,i=e.selected,s=e.disabled,u=e.enableTagFocusInDisabledPicker,a=e.children,f=e.className,l=e.index,h=e.onRemoveItem,p=e.removeButtonAriaLabel,d=e.title,v=void 0===d?"string"==typeof e.children?e.children:e.item.name:d,m=c(n,{theme:t,className:f,selected:i,disabled:s});return r.createElement("div",{className:m.root,role:"listitem",key:l,"data-selection-index":l,"data-is-focusable":(u||!s)&&!0},r.createElement("span",{className:m.text,"aria-label":v,title:v},a),r.createElement(o.e,{onClick:h,disabled:s,iconProps:{iconName:"Cancel",styles:{root:{fontSize:"12px"}}},className:m.close,ariaLabel:p}))},function(e){var t,n,r,i,s=e.className,o=e.theme,c=e.selected,h=e.disabled,p=o.palette,d=o.effects,v=o.fonts,m=o.semanticColors,g=Object(u.x)(l,o);return{root:[g.root,v.medium,Object(u.S)(o),{boxSizing:"content-box",flexShrink:"1",margin:2,height:26,lineHeight:26,cursor:"default",userSelect:"none",display:"flex",flexWrap:"nowrap",maxWidth:300,minWidth:0,borderRadius:d.roundedCorner2,color:m.inputText,background:!c||h?p.neutralLighter:p.themePrimary,selectors:(t={":hover":[!h&&!c&&{color:p.neutralDark,background:p.neutralLight,selectors:{".ms-TagItem-close":{color:p.neutralPrimary}}},h&&{background:p.neutralLighter},c&&!h&&{background:p.themePrimary}]},t[u.s]={border:"1px solid "+(c?"WindowFrame":"WindowText")},t)},h&&{selectors:(n={},n[u.s]={borderColor:"GrayText"},n)},c&&!h&&[g.isSelected,{color:p.white}],s],text:[g.text,{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",minWidth:30,margin:"0 8px"},h&&{selectors:(r={},r[u.s]={color:"GrayText"},r)}],close:[g.close,{color:p.neutralSecondary,width:30,height:"100%",flex:"0 0 auto",borderRadius:Object(f.e)(o)?d.roundedCorner2+" 0 0 "+d.roundedCorner2:"0 "+d.roundedCorner2+" "+d.roundedCorner2+" 0",selectors:{":hover":{background:p.neutralQuaternaryAlt,color:p.neutralPrimary},":active":{color:p.white,backgroundColor:p.themeDark}}},c&&{color:p.white,selectors:{":hover":{color:p.white,background:p.themeDark}}},h&&{selectors:(i={},i["."+a.e.msButtonIcon]={color:p.neutralSecondary},i)}]}},void 0,{scope:"TagItem"})}],Array(17),[function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(52),i=n("knockout-lib"),s=n(1702),o=n(888),u=n(477),a=Object(s.e)("ms-client-form-react","./ReactClientFormConnector",function(){return r.n.resolve(n.ee(["169","deferred.resx-deferred","ondemand.resx-ondemand"],3346))});i.components.isRegistered(a.tagName)||i.components.register(a.tagName,a);var f=Object(s.e)("ms-properties-form","./propertiesForm/PropertiesFormConnector",function(){return r.n.resolve(n.ee(["514","deferred.resx-deferred","ondemand.resx-ondemand"],3356))});i.components.isRegistered(f.tagName)||i.components.register(f.tagName,f);function l(e,t){void 0===t&&(t=!1);var n=e&&e.consume(o.e)||null;if(t){n&&n.logData({name:"ClientForm.Instantiate.PropertiesForm",extraData:{TagName:"ms-properties-form",Host:Object(u.e)()}});return"ms-properties-form"}n&&n.logData({name:"ClientForm.Instantiate.ReactClientForm",extraData:{TagName:"ms-client-form-react",Host:Object(u.e)()}});return"ms-client-form-react"}},function(e,t,n){"use strict";var r;(function(e){e[e.share=0]="share";e[e.copy=1]="copy";e[e.outlook=2]="outlook";e[e.nonOutlook=3]="nonOutlook";e[e.moreApps=4]="moreApps";e[e.teams=5]="teams"})(r||(r={}));t.e=r}],Array(33),[function(e,t,n){"use strict";n.d(t,"e",function(){return w});var r=n(4),i=n("react-lib"),s=n(479),o=n(1521),u=n(1503),a=n(1505),f=n(434),l=n(1484),c=n(25),h=n(86),p=n(432),d=n(544),v=n(904),m=Object(h.t)(function(e,t,n){var i,s,o,u,a,f=e.fonts,l=e.palette,h=Object(p.e)(e),m=Object(d.e)(e),g={root:{maxWidth:"280px",minHeight:"72px",height:"auto",padding:"16px 12px"},flexContainer:{flexDirection:"row",alignItems:"flex-start",minWidth:"100%",margin:""},textContainer:{textAlign:"left"},icon:{fontSize:"2em",lineHeight:"1em",height:"1em",margin:"0px 8px 0px 0px",flexBasis:"1em",flexShrink:"0"},label:{margin:"0 0 5px",lineHeight:"100%",fontWeight:c.i.semibold},description:[f.small,{lineHeight:"100%"}]},y={description:{color:l.neutralSecondary},descriptionHovered:{color:l.neutralDark},descriptionPressed:{color:"inherit"},descriptionChecked:{color:"inherit"},descriptionDisabled:{color:"inherit"}},b={description:{color:l.white,selectors:(i={},i[c.s]=Object(r.e)({backgroundColor:"WindowText",color:"Window"},Object(c.T)()),i)},descriptionHovered:{color:l.white,selectors:(s={},s[c.s]={backgroundColor:"Highlight",color:"Window"},s)},descriptionPressed:{color:"inherit",selectors:(o={},o[c.s]=Object(r.e)({color:"Window",backgroundColor:"WindowText"},Object(c.T)()),o)},descriptionChecked:{color:"inherit",selectors:(u={},u[c.s]=Object(r.e)({color:"Window",backgroundColor:"WindowText"},Object(c.T)()),u)},descriptionDisabled:{color:"inherit",selectors:(a={},a[c.s]={color:"inherit"},a)}};return Object(c.y)(h,g,n?Object(v.e)(e):Object(v.t)(e),n?b:y,m,t)}),g=(function(e){Object(r.r)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.primary,n=void 0!==t&&t,s=e.styles,o=e.theme;return i.createElement(f.e,Object(r.e)({},this.props,{variantClassName:n?"ms-Button--compoundPrimary":"ms-Button--compound",styles:m(o,s,n)}))};return t=Object(r.n)([Object(l.e)("CompoundButton",["theme","styles"],!0)],t)})(i.Component),y=n(1508),b=n(1772),w=(function(e){Object(r.r)(t,e);function t(t){var n=e.call(this,t)||this;Object(s.e)("The Button component has been deprecated. Use specific variants instead. (PrimaryButton, DefaultButton, IconButton, ActionButton, etc.)");return n}t.prototype.render=function(){var e=this.props;switch(e.buttonType){case o.e.command:return i.createElement(a.e,Object(r.e)({},e));case o.e.compound:return i.createElement(g,Object(r.e)({},e));case o.e.icon:return i.createElement(y.e,Object(r.e)({},e));case o.e.primary:return i.createElement(b.e,Object(r.e)({},e));default:return i.createElement(u.e,Object(r.e)({},e))}};return t})(i.Component)},,,function(e,t,n){"use strict";n.d(t,"e",function(){return g});var r=n(7),i=n(76),s=n(0),o=n(2216),u=n(2189),a=n(2439),f=n(356),l=n(66),c=n(144),h=(function(){function e(e,t){this._pageContext=t.pageContext;this._dataRequestor=new t.dataRequestorType({qosName:"FileHoverCardFeedback"});this._itemUrlHelper=new c.e({},{pageContext:this._pageContext})}e.prototype.dismissRecommendedAction=function(e,t,n,r,i){var s=this._itemUrlHelper.getUrlParts({path:e.path}),o=s.webRelativeItemUrl.replace("/"+t,""),u={ListId:this._pageContext.listId,ListItemUniqueId:r,Operation:"RecommendationActedOn",AffectedResourceUrl:s.fullItemUrl,ItemType:"File",json:JSON.stringify({FileName:t,Scenario:"RecommendedActions",SourceRelativeUrl:o,DismissRecommendationsCategory:"FocusedTask",PositionNumber:(i+1).toString(),TotalRecommendationsPresented:"3",RecommendationAlgorithmVersion:"1",ReferringCorrelationId:n,Canvas:"Web",Workload:"SharePoint",WebId:this._pageContext.webId,SiteId:this._pageContext.siteId,SiteUrl:this._pageContext.siteAbsoluteUrl,ClientLocalTime:(new Date).toISOString(),SourceFileName:t,SourceFileExtension:e.extension,ClientUTCOffsetInMinutes:(new Date).getTimezoneOffset().toString(),RecommendationId:n,ActionType:"Dismiss"})},a=new l.t(this._pageContext.webAbsoluteUrl+"/_api/web/ActivityLogger/FeedbackDirect");this._dataRequestor.getData({url:a.toString(),qosName:"DismissActions",method:"POST",needsRequestDigest:!0,additionalPostData:JSON.stringify(u),timeout:6e3,qosExtraData:{Caller:"HoverCard"}})};return e})(),p=0,d=(function(){function e(e,t){this._dictListener={};this._itemAnalyticsDataSource=t.itemAnalyticsDataSource;this._dictItemAnalytics={};this._promiseDeduplicator=new u.e;t.pageContext&&(this._feedbackProvider=new h({},{pageContext:t.pageContext,dataRequestorType:(function(e){Object(s.__extends)(n,e);function n(n){return e.call(this,n,{pageContext:t.pageContext})||this}return n})(f.e)}));setInterval(this._cleanCache.bind(this),18e5)}e.prototype.addListener=function(e,t){var n=""+ ++p;this._dictListener[t.itemId]||(this._dictListener[t.itemId]={});this._dictListener[t.itemId][n]=e;return{key:n}};e.prototype.fetchItemAnalytics=function(e,t){this._clearErrorResponse();if(!this._dictItemAnalytics[e.itemId]||!this._dictItemAnalytics[e.itemId].data){this._dictItemAnalytics[e.itemId]={status:o.e.failed,data:void 0,actions:void 0};this._getAllAnalyticsData(e)}};e.prototype.getItemAnalytics=function(e){return this._dictItemAnalytics[e.itemId]};e.prototype.removeListener=function(e,t){this._dictListener[t.itemId][e.key]&&delete this._dictListener[t.itemId][e.key]};e.prototype.getDailyItemAnalytics=function(e){return this._getItemAnalyticsByInterval(e)};e.prototype.getMonthlyItemAnalytics=function(e){return this._getItemAnalyticsByInterval(e,720)};e.prototype.getAllTimeItemAnalytics=function(e){return this._itemAnalyticsDataSource.getItemAnalytics(e).then(function(e){var t=e.incompleteData&&e.incompleteData.missingDataBeforeDateTime;return Object(s.__assign)({activity:{},incompleteData:{missingDataBeforeDateTime:t&&new Date(t),wasThrottled:e.incompleteData&&e.incompleteData.wasThrottled},startDateTime:e.startDateTime&&new Date(e.startDateTime)},e)})};e.prototype.cleanCachedItem=function(e){this._dictItemAnalytics[e.itemId]&&delete this._dictItemAnalytics[e.itemId]};e.prototype.updateItemKeyPoints=function(e,t){var n=this;return this._itemAnalyticsDataSource.updateItemKeyPoints(e,t).then(function(t){var r=n._dictItemAnalytics[e.itemId];if(r&&r.data&&r.data.keyPointsData&&r.data.keyPointsData.keyPoints){var i=t.filter(function(e){return"Deleted"!==e.state});r.data.keyPointsData.keyPoints=i}n._emitChange(e)},function(){n._dictItemAnalytics[e.itemId]&&(n._dictItemAnalytics[e.itemId].status=o.e.failed);n._emitChange(e)})};e.prototype.dismissRecommendedAction=function(e,t,n,r,i){this._feedbackProvider.dismissRecommendedAction(e,t,n,r,i)};e.prototype._getItemAnalyticsByInterval=function(e,t){var n=new Date;n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate()));var r=new Date,i=new Date;r.setDate(r.getDate()-90);i.setHours(r.getHours()-1440);return this._itemAnalyticsDataSource.getItemAnalyticsByInterval(e,r,n,t)};e.prototype._clearErrorResponse=function(){for(var e in this._dictItemAnalytics)this._dictItemAnalytics[e].status===o.e.failed&&delete this._dictItemAnalytics[e]};e.prototype._emitChange=function(e){var t=this._dictListener[e.itemId];for(var n in t)t&&t[n]()};e.prototype._cleanCache=function(){for(var e in this._dictItemAnalytics)this._dictItemAnalytics[e].status!==o.e.unsupport&&delete this._dictItemAnalytics[e]};e.prototype._getAllAnalyticsData=function(e){var t=this;this._promiseDeduplicator.deduplicate(e.itemId,function(){return t._itemAnalyticsDataSource.getItemAnalyticsSections(e)}).then(function(n){t._dictItemAnalytics[e.itemId].status=o.e.succeed;t._dictItemAnalytics[e.itemId].data=n;t._emitChange(e)},function(n){var r,i=n&&n.allTimeItemAnalytics;if(i&&"FileTypeNotSupported"===i.message)r=o.e.unsupport;else{if(i&&"Canceled"===i.message||"Canceled"===n)return;r=o.e.failed}t._dictItemAnalytics[e.itemId].status=r;t._dictItemAnalytics[e.itemId].data=void 0;i&&i.error&&a.e(i.error);t._emitChange(e)})};return e})(),v=n(49),m=n(530),g=new r.t({name:"FileHoverCardStore",factory:{dependencies:{itemAnalyticsDataSource:i.e,pageContext:v.h,dataRequestorType:m.n},create:function(e){var t=new d({item:void 0},e);return{instance:t,disposable:t}}}})},,function(e,t,n){"use strict";n.d(t,"e",function(){return h});var r=n(0),i=n(138);Object(i.n)([{rawString:".od-PolicyTip-container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.od-PolicyTip-title{font-size:"},{theme:"xLargeFontSize",defaultValue:"20px"},{rawString:";font-weight:100;margin:0px 0px 8px 0px}.od-PolicyTip-description{font-size:"},{theme:"mediumFontSize",defaultValue:"14px"},{rawString:";font-weight:400;margin-top:20px}.od-PolicyTip-header{display:-webkit-box;display:-ms-flexbox;display:flex;margin:20px 0px}.od-PolicyTip-blockedIcon{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";font-size:21px;padding-top:2px}.od-PolicyTip-headerText{font-size:"},{theme:"largeFontSize",defaultValue:"18px"},{rawString:";font-weight:300;font-weight:600}[dir='ltr'] .od-PolicyTip-headerText{margin-left:12px}[dir='rtl'] .od-PolicyTip-headerText{margin-right:12px}.od-PolicyTip-issue{font-size:"},{theme:"mediumFontSize",defaultValue:"14px"},{rawString:";font-weight:400;margin-bottom:12px}[dir='ltr'] .od-PolicyTip-issue{margin-left:33px}[dir='rtl'] .od-PolicyTip-issue{margin-right:33px}.od-PolicyTip-minorText{font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-PolicyTip-learnMoreContainer{display:-webkit-box;display:-ms-flexbox;display:flex}[dir='ltr'] .od-PolicyTip-learnMoreContainer a{padding-right:4px}[dir='rtl'] .od-PolicyTip-learnMoreContainer a{padding-left:4px}.od-PolicyTip-actions{margin-top:60px}.od-PolicyTip-action{font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";font-weight:400;margin-bottom:8px}.od-PolicyTip-actionLabel{font-weight:600;cursor:pointer}[dir='ltr'] .od-PolicyTip-label{margin-left:4px}[dir='rtl'] .od-PolicyTip-label{margin-right:4px}.od-PolicyTip-status{display:-webkit-box;display:-ms-flexbox;display:flex;margin-top:34px;margin-bottom:8px}.od-PolicyTip-status{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-PolicyTip-statusText{font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";font-weight:400}[dir='ltr'] .od-PolicyTip-statusText{margin-left:4px}[dir='rtl'] .od-PolicyTip-statusText{margin-right:4px}.od-PolicyTip-justificationInputContainer{overflow-y:auto;max-height:110px}.od-PolicyTip-submitButton{margin-top:8px}.od-PolicyTip-error{margin-top:36px;font-size:"},{theme:"largeFontSize",defaultValue:"18px"},{rawString:";font-weight:300}\n"}]);var s=n(1486),o=n(1772),u=n(1637),a=n(1893),f=n("react-lib"),l=n(22),c=n(993),h=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onReportClicked=function(){n.setState(Object(r.__assign)(Object(r.__assign)({},n.state),{isLoading:!0,reportButtonClicked:!0}),function(){n.props.onReportClicked()})};n._onOverrideClicked=function(){n.setState(Object(r.__assign)(Object(r.__assign)({},n.state),{overrideButtonClicked:!0}),function(){n.props.onOverrideClicked()})};n._onOverrideSubmitClicked=function(){n.setState(Object(r.__assign)(Object(r.__assign)({},n.state),{isLoading:!0,overrideSubmitClicked:!0}),function(){n.props.onOverrideSubmitClicked(n.state.justificationText)})};n._onJustificationChanged=function(e,t){n.props.overrideRequiresJustification&&n.setState(Object(r.__assign)(Object(r.__assign)({},n.state),{justificationText:t||"",overrideSubmitDisabled:!t}))};n.state={isLoading:!1,justificationText:"",reportButtonClicked:!1,overrideButtonClicked:!1,overrideSubmitClicked:!1,overrideSubmitDisabled:t.overrideRequiresJustification};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e,t){this.state.isLoading&&e.confirmationText&&this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{isLoading:!1}))};t.prototype.componentWillUnmount=function(){this.props.onDismissed()};t.prototype.render=function(){var e=this.props.strings,t=e.noPolicyTipInfoError?f.createElement("div",{className:"od-PolicyTip-container"},f.createElement("span",{className:"od-PolicyTip-error"},e.noPolicyTipInfoError)):f.createElement("div",{className:"od-PolicyTip-container"},f.createElement("span",{className:"od-PolicyTip-description"},e.policyTipDescription),f.createElement("div",{className:"od-PolicyTip-header"},f.createElement(c.e,{iconName:"Blocked2",className:"od-PolicyTip-blockedIcon"}),f.createElement("span",{className:"od-PolicyTip-headerText"},e.headerText)),this._renderIssues(),f.createElement("span",{className:"od-PolicyTip-minorText"},e.lastScannedText),this._renderLearnMore(),f.createElement("div",{className:"od-PolicyTip-actions"},this._renderActions()),this._renderJustificationInput(),this._renderStatus());return f.createElement("div",null,f.createElement("h2",{className:"od-PolicyTip-title"},e.titleText),t)};t.prototype._renderIssues=function(){for(var e=[],t=0,n=0,r=this.props.strings.issues;n<r.length;n++){var i=r[n];e.push(f.createElement("span",{className:"od-PolicyTip-issue",key:t++},i))}return e};t.prototype._renderLearnMore=function(){var e=this.props.strings;if(e.learnMoreUrl){var t=f.createElement("a",{href:e.learnMoreUrl,target:"_blank"},e.learnMoreActionLabel),n=l.formatToArray(e.learnMoreLabel,t);return f.createElement("div",{className:"od-PolicyTip-learnMoreContainer od-PolicyTip-minorText"},n)}};t.prototype._getAction=function(e,t,n,r){if(n)return f.createElement("div",{className:"od-PolicyTip-action"},f.createElement("span",null,""+l.format(e,t)));var i=f.createElement("a",{className:"od-PolicyTip-actionLabel",onClick:r,role:"button",href:"javascript:;"},t),s=l.formatToArray(e,i);return f.createElement("div",{className:"od-PolicyTip-action"},s)};t.prototype._renderActions=function(){var e=this.props,t=this.state,n=e.strings,r=[],i=this._getAction(n.reportLabel,n.reportActionLabel,t.reportButtonClicked,this._onReportClicked);r.push(i);if(n.overrideActionLabel){var s=this._getAction(n.overrideLabel,n.overrideActionLabel,t.overrideButtonClicked,this._onOverrideClicked);r.push(s)}return r};t.prototype._renderStatus=function(){var e=this.props;return this.state.isLoading?f.createElement("div",{className:"od-PolicyTip-status"},f.createElement(u.e,null),f.createElement("span",{className:"od-PolicyTip-statusText"},e.strings.reportInProgressLabel)):e.confirmationText?f.createElement("div",{className:"od-PolicyTip-status"},f.createElement(c.e,{iconName:"CheckMark"}),f.createElement("span",{className:"od-PolicyTip-statusText"},e.confirmationText)):void 0};t.prototype._renderJustificationInput=function(){var e=this.props,t=this.state;if(e.showJustificationInput)return f.createElement("div",{className:"od-PolicyTip-justificationInputContainer"},f.createElement(a.e,{autoAdjustHeight:!0,multiline:!0,value:t.justificationText,onChange:this._onJustificationChanged,underlined:!0,resizable:!1}),!t.overrideSubmitClicked&&f.createElement(o.e,{className:"od-PolicyTip-submitButton",disabled:t.overrideSubmitDisabled,onClick:this._onOverrideSubmitClicked},e.strings.submitButtonLabel))};return t})(s.e)}],Array(19),[function(e,t,n){"use strict";n.d(t,"e",function(){return p});var r=n(0),i=n("react-lib"),s=n(1910),o=n(2213),u=n(97),a=n(2314),f=n(73),l=n(133),c=n(1878),h=n(134),p=(function(e){Object(r.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onDismiss=function(){l.e.logData({name:t._getEngagementNamePrefix()+".Close",extraData:{campaignGuid:t._getCampaignGuid()}});var e=t.props.onDismiss;e&&e()};t._onTeachingBubbleSeen=function(){l.e.logData({name:t._getEngagementNamePrefix()+".Rendered",extraData:{campaignGuid:t._getCampaignGuid()}});var e=t.props.onTeachingBubbleSeen;e&&e()};t._getCampaignGuid=function(){return t.props.teachingBubbleCampaign.campaignGuid};t._getEngagementNamePrefix=function(){return t.props.teachingBubbleCampaign.isCoachmark?"Coachmark":"TeachingBubble"};return t}t.prototype.render=function(){var e,t=this.props,n=t.teachingBubbleCampaign,r=t.onAnimationOpenStart,l=t.directionalHint;e=n.automateExperimentBodyCopy&&Object(c.n)()?n.automateExperimentBodyCopy:n.bodyCopy;var p=n.teachingBubbleContentAs?Object(h.e)(n.teachingBubbleContentAs,s.e):s.e,d=n.teachingBubbleContentAs?Object(h.e)(n.teachingBubbleContentAs,o.e):o.e;return n.isCoachmark?i.createElement(a.e,{target:this.props.target,positioningContainerProps:{directionalHint:l||u.e.bottomCenter},styles:n.coachMarkStyles,onAnimationOpenStart:r,persistentBeak:n.persistentBeak,onAnimationOpenEnd:this._onTeachingBubbleSeen,preventFocusOnMount:!0},i.createElement(p,{headline:n.title,illustrationImage:n.illustrationImage,styles:n.teachingBubbleStyles,calloutProps:{doNotLayer:!0},hasCloseIcon:n.isDismissable,closeButtonAriaLabel:f.a,onDismiss:this._onDismiss,hasCondensedHeadline:!n.disableCondensedHeadline},e)):i.createElement(d,{target:this.props.target,headline:n.title,hasCloseIcon:!0,closeButtonAriaLabel:f.a,onDismiss:this._onDismiss,hasCondensedHeadline:!0,calloutProps:{onLayerMounted:this._onTeachingBubbleSeen}},e)};return t})(i.PureComponent)},function(e,t,n){"use strict";var r=n(138);Object(r.n)([{rawString:".InfoPaneSection-informationBody{margin:0}.InfoPaneSection-informationBody dt{margin-bottom:3px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:14px;font-weight:600}.InfoPaneSection-informationBody dd{margin:0 0 16px 0;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:14px}.InfoPaneSection-entryTile{display:flex;flex-direction:row;align-items:center}[dir=ltr] .InfoPaneSection-copyButton{margin-left:2px}[dir=rtl] .InfoPaneSection-copyButton{margin-right:2px}.InfoPaneSection-information-folderType{display:inline}.InfoPaneSection-information-changeFolderType{margin-left:10px;margin-right:10px;text-decoration:none}.InfoPaneSection-information-changeFolderType:visited{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.InfoPaneSection-information-path{display:inline;word-break:break-all}.InfoPaneSection-information-path:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";padding:0 5px;font-size:8px;font-weight:800;content:'\\E76C'}.InfoPaneSection-information-path:last-child:after{content:'';display:none}html[dir=rtl] .InfoPaneSection-information-path:after{content:'\\E76B'}.od-DetailsPane-LegacySection .InfoPaneSection-informationBody dd{margin-bottom:12px}.od-DetailsPane-LegacySection .InfoPaneSection--information .InfoPane-sectionHeader .InfoPane-sectionHeaderText{border-bottom:.5px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";padding-bottom:4px}.od-InfoPane-ReactSections .InfoPaneSection-informationBody dd{margin-bottom:12px}.od-InfoPane-ReactSections .InfoPaneSection--information .InfoPane-sectionHeader{display:none;padding:12px 16px}"}])},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n("react-lib"),i=n(1972),s=n(1737),o=n(22),u=n(2886);function a(){var e=r.createElement("a",{key:"learn_more_link",href:"https://go.microsoft.com/fwlink/?linkid=862871",target:"_blank"},u.r),t=o.formatToArray(u.n,e);return r.createElement(i.e,{messageBarType:s.e.severeWarning,isMultiline:!0},t)}}],Array(37),[function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(11),i=n(2610),s=Object(r.s)("ItemActivitiesResultProcessor",i.e,{}),o=n(891),u=n(52),a={folderDoesNotExist:!0,itemNotFound:!0,accessDenied:!0,unauthenticated:!0},f=(function(){function e(e,t){this._dataRequestor=t.vroomDataRequestor;this._itemActivitiesResultProcessor=t.itemActivitiesResultProcessor}e.prototype.getItemActivities=function(e){var t=this;e.environment=e.environment||"sharePoint";if(e.mockData)return u.n.resolve({activities:e.mockData,isPlaceholder:!1,success:!0});var n=this._getRequestUrl(e);return this._dataRequestor.send({apiName:e.qosPrefix?e.qosPrefix+".GetItemActivities":"GetItemActivities",path:n,headers:e.headers,accessToken:e.item.accessToken,apiVersion:e.apiVersion,expectedErrorCodes:a}).then(function(n){return t._itemActivitiesResultProcessor.processResponse({item:e.item,response:n})},function(e){return{error:e,isPlaceholder:!1,activities:[],success:!1}})};e.prototype.getActivitiesByDate=function(e){e.environment=e.environment||"sharePoint";return e.mockData?u.n.resolve({activitiesByDate:e.mockData,success:!0}):this.getActivitiesByInterval({item:e.item,headers:e.headers,interval:"day",startDateTime:e.startDateTime,endDateTime:e.endDateTime}).then(function(e){return{error:e.error,success:e.success,activitiesByDate:e.activitiesByInterval.map(function(e){var t=e.startDateTime;return{createCount:e.createCount,deleteCount:e.deleteCount,editCount:e.editCount,moveCount:e.moveCount,restoreCount:e.restoreCount,copyCount:e.copyCount,totalCount:e.totalCount,date:l(t)}})}},function(e){return u.n.resolve({activitiesByDate:[],error:new Error("Not implemented"),success:!1})})};e.prototype.getActivitiesByInterval=function(e){var t=this,n=e.endDateTime?"&endDateTime="+e.endDateTime.toISOString():"",r=e.item.graphItemUrl+"/action.getActivitiesByInterval?startDateTime="+e.startDateTime.toISOString()+"&interval=day"+n;return this._dataRequestor.send({apiName:"GetActivitiesByInterval",headers:e.headers,path:r}).then(function(e){return t._itemActivitiesResultProcessor.processActivitiesByIntervalResponse(e)},function(e){return{error:e,activitiesByInterval:[],success:!1}})};e.prototype._getRequestUrl=function(e){var t=e.pageSize?e.pageSize:25,n="sharePointList"===e.environment?e.item.graphItemUrl+"/activities?$expand=listItem($select=id,name,webUrl)":e.item.graphItemUrl+"/activities?$expand=driveItem($select=id,name,webUrl,parentReference,file,folder)";n+="&$top="+t;e.filter&&(n+="&$filter="+e.filter);e.orderBy&&(n+="&$orderby="+e.orderBy);e.nextRequestToken&&(n+="&$skiptoken="+e.nextRequestToken);return n};return e})();function l(e){function t(e){return e<10?"0"+e:e}return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())}var c=Object(r.s)("ItemActivitiesService",f,{vroomDataRequestor:o.e,itemActivitiesResultProcessor:s})},function(e,t,n){"use strict";var r=n(138);Object(r.n)([{rawString:".ms-IFrameCtrl-title{font-size:17px}.ms-IFrameCtrl-iFrame{width:100%;border:0;min-height:200px}"}]);var i=n(0),s=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=n.observables;n.url=r.wrap(t.url);n.title=r.wrap(t.title);n.iFrameTitle=r.wrap(t.iFrameTitle||"iFrame");var i=t.isExcludeFromScreenReader;n.tabindex=i?"-1":null;n.role=i?"presentation":null;n._isEmailAttestationPage=r.create(!1);n.isVisible=r.pureCompute(n._computeIsVisible);n.isTitleVisible=r.pureCompute(n._computeIsTitleVisible);n.iframeOnLoad=function(e,r){try{r.target.contentWindow.location.href.toLowerCase().indexOf("emailattestation.aspx")>-1&&n._isEmailAttestationPage(!0)}catch(r){}t.onload&&t.onload(r)};return n}t.prototype._computeIsVisible=function(){return!!this.url()&&!this._isEmailAttestationPage()};t.prototype._computeIsTitleVisible=function(){return!!this.title()};return t})(n(1651).t),o=n(1652).e({tagName:"ms-iframe",template:'\x3c!--ko if:isVisible--\x3e<div class="IFrame">\x3c!--ko if:title--\x3e<div class="ms-IFrameCtrl-title" data-bind="text:title"></div>\x3c!--/ko--\x3e<iframe class="ms-IFrameCtrl-iFrame" data-bind="attr:{src:url,role:role,tabindex:tabindex,title:iFrameTitle},event:{load:iframeOnLoad}"></iframe></div>\x3c!--/ko--\x3e',viewModel:s,synchronous:!0});t.e=o},function(e,t,n){"use strict";var r=n(138);Object(r.n)([{rawString:".od-PersonaTile:focus{border:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}"}]);var i=n(0),s=n(1954),o=n(2049),u=n(2142),a=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.personaTagName=o.e.tagName;n.addBindingHandlers({scrollIntoView:u.e});var r=t.tile;n.tile=r;n.tile.personaParams.disableTab=!0;n.tile.personaParams.canManagePermissions=t.canManagePermissions;n.disableTab=t.disableTab;n._person=n.tile.personaParams.person.peek();n.ariaLabel=n.createComputed(n._computeAriaLabel);return n}t.prototype._computeAriaLabel=function(){var e=this._person.sharingInfo.role,t="",n=this.tile.personaParams.canManagePermissions?s.i:"";if(0===e)t=s.o;else if(2===e){t=s.n;t+=n}else if(1===e){t=s.h;t+=n}return this._person.name+" "+t};return t})(n(1651).t),f=n(1652).e({tagName:"od-persona-tile",template:'<div class="od-PersonaTile" role="treeitem" data-bind="attr:{tabindex:tile.index===0&&!(disableTab===true)?0:-1,\'aria-label\':ariaLabel},hasFocus:tile.focused,scrollIntoView:{isSelected:tile.focused}"><div class="od-PersonaTile-Persona" data-bind="attr:{\'aria-hidden\':true},component:{name:personaTagName,params:tile.personaParams}"></div></div>',viewModel:a,synchronous:!0});t.e=f},,,,,function(e,t,n){"use strict";function r(e){return void 0!==e.action}function i(e){return void 0!==e.activityDateTime}function s(e){var t=y(e).comment;return void 0!==t&&!t.isReply}function o(e){var t=y(e).comment;return void 0!==t&&t.isReply}function u(e){return void 0!==y(e).mention}function a(e){return void 0!==y(e).version}function f(e){return void 0!==y(e).pointInTimeRestore}function l(e){return void 0!==y(e).restoreVersion}function c(e){return void 0!==y(e).move}function h(e){return void 0!==y(e).rename}function p(e){return void 0!==y(e).delete}function d(e){return void 0!==y(e).share}function v(e){var t=y(e).addToOneDrive;return void 0!==t&&!t.removedDateTime}function m(e){var t=y(e).addToOneDrive;return void 0!==t&&!!t.removedDateTime}function g(e){return function(t){return u(t)?e.Mention(t):s(t)?e.Comment(t):o(t)?e.CommentResponse(t):(function(e){return void 0!==y(e).create})(t)?e.Create(t):p(t)?e.Delete(t):(function(e){return void 0!==y(e).edit})(t)?e.Edit(t):c(t)?e.Move(t):h(t)?e.Rename(t):(function(e){return void 0!==y(e).restore})(t)?e.Restore(t):l(t)?e.RestoreVersion(t):d(t)?e.Share(t):a(t)?e.Version(t):(function(e){return void 0!==y(e).copy})(t)?e.Copy(t):f(t)?e.PointInTimeRestore(t):v(t)?e.AddShortcutToOneDrive(t):m(t)?e.RemoveShortcutFromOneDrive(t):void 0}}function y(e){return r(e)?e.action:e}function b(e){return e.driveItem||e.listItem}var w=n(66),E=!n(70).t.isActivated("DC1B3A2B-2469-49B2-9230-7F6CD01BD84C","12/30/2020","Enable deeplinking for comment activities"),S=(function(){function e(){}e.prototype.processResponse=function(e){var t=this,n=e.item,r=e.response;return{isPlaceholder:!1,activities:r.value.map(function(e){if(i(e))if(s(e)||o(e)){var r=y(e).comment;(r.contentId||r.navigationId)&&(e.docDetails={contentId:r.contentId,navigationId:r.navigationId})}else if(u(e)){var a=y(e).mention;(a.contentId||a.navigationId)&&(e.docDetails={contentId:a.contentId,navigationId:a.navigationId})}return t._processActivityResponse(n,e)}),nextRequestToken:this._getNextRequestToken(r),success:!0}};e.prototype.processActivitiesByIntervalResponse=function(e){var t=this;return{activitiesByInterval:e.value.map(function(e){return t._processActivitySummaryResponse(e)}),success:!0}};e.prototype._processActivitySummaryResponse=function(e){return{totalCount:(void 0!==e.create?e.create.actionCount:0)+(void 0!==e.delete?e.delete.actionCount:0)+(void 0!==e.edit?e.edit.actionCount:0)+(void 0!==e.move?e.move.actionCount:0)+(void 0!==e.rename?e.rename.actionCount:0)+(void 0!==e.restore?e.restore.actionCount:0)+(void 0!==e.copy?e.copy.actionCount:0),startDateTime:new Date(e.startDateTime),endDateTime:new Date(e.endDateTime)}};e.prototype._getNextRequestToken=function(e){if(e.value&&!(e.value.length<1)){var t=e["@odata.nextLink"],n=t&&t.match(/skiptoken=([^&]+)/i);return n?n[1]:void 0}};e.prototype._processActivityResponse=function(e,t){var n=this._getItem(e,t),r=this._getParentItem(t),s=this._getAction(e,n,r,t);if(i(t)){var o=t.actor&&t.actor.user,u=o&&{displayName:o.displayName,id:o.id,email:o.email,self:o.self};return{id:t.id,type:this._getActivityType(t),actors:u?[u]:[],item:n,parentItem:r,time:new Date(t.activityDateTime),action:s}}var a=t.actor&&t.actor.user,f=a&&{displayName:a.displayName,email:a.email,self:a.self,userPrincipalName:a.userPrincipalName};return{id:t.id,type:this._getActivityType(t),actors:[f],item:n,parentItem:r,time:t.times.recordedTime?new Date(t.times.recordedTime):new Date(t.times.recordedDateTime),friendlyDisplayTime:t["@sharePoint.localizedRelativeTime"],action:s}};e.prototype._getActivityType=function(e){return g({Comment:function(){return 2},CommentResponse:function(){return 3},Create:function(){return 11},Delete:function(){return 10},Edit:function(){return 0},Mention:function(){return 4},Move:function(){return 1},Rename:function(){return 9},Restore:function(){return 6},RestoreVersion:function(){return 7},PointInTimeRestore:function(){return 8},Share:function(){return 12},Version:function(){return 5},Copy:function(){return 13},AddShortcutToOneDrive:function(){return 14},RemoveShortcutFromOneDrive:function(){return 15}})(e)};e.prototype._getItem=function(e,t){var n=b(t);if(c(t)){if(r(t)){var s=y(t).move;if(s&&s.to)return{name:this._getFileNameFromPath(s.to),isRoot:this._isRootItem(s.to),graphItemUrl:void 0,relativePath:void 0,absolutePath:s.to}}}else if(p(t)&&r(t)){var o=y(t).delete;if(o&&o.name){var u=(f=(a=n&&n.parentReference)&&this._getRelativePathFromVroomPath(a.path))&&n&&f+"/"+n.name+"/"+o.name;return{name:o.name,isRoot:this._isRootItem(o.name),graphItemUrl:void 0,relativePath:u,absolutePath:void 0,isFolder:"Folder"===o.objectType}}}if(n){t.docDetails&&(n.webUrl=this._getNavLink(n,t.docDetails));var a,f;u=(f=(a=n&&(n.parentReference||n.remoteItem&&n.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(a.path))&&f+"/"+n.name;return p(t)?{name:n.name,isRoot:this._isRootItem(n.name),graphItemUrl:void 0,relativePath:u,absolutePath:void 0}:{name:n.name,isRoot:this._isRootItem(n.name),graphItemUrl:a&&"/drives/"+a.driveId+"/items/"+n.id,relativePath:u,absolutePath:void 0,driveItem:n,navigationId:this._getNavigationId(t)}}if(!i(t))return e};e.prototype._getParentItem=function(e){var t=b(e);if(c(e)){var n=y(e).move;if(n&&n.to){var i=this._getDirNameFromPath(n.to),s=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference);return{name:this._getFileNameFromPath(i),isRoot:this._isRootItem(i),graphItemUrl:s&&"/drives/"+s.driveId+"/items/"+s.id,relativePath:void 0,absolutePath:this._getDirNameFromPath(i),isFolder:!0,driveItem:s&&{id:s.id}}}}else if(p(e)&&t){if(r(e)){var o=(a=(s=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(s.path))&&a+"/"+name;return{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:s&&"/drives/"+s.driveId+"/items/"+t.id,relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:t}}if(s=t&&t.parentReference){o=this._getRelativePathFromVroomPath(s.path);var u=s.name?s.name:o&&this._getFileNameFromPath(o);if(void 0===o||void 0===u||void 0===s.id)return;return{name:u,isRoot:this._isRootItem(u),graphItemUrl:"/drives/"+s.driveId+"/items/"+s.id,relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:{id:s.id}}}}else{if(l(e)&&t){o=(a=(s=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(s.path))&&a+"/"+name;return{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:s&&"/drives/"+s.driveId+"/items/"+t.id,relativePath:o,absolutePath:void 0,isFolder:!1,driveItem:t}}if(f(e)&&t){var a;o=(a=(s=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(s.path))&&a+"/"+name;return{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:s&&"/drives/"+s.driveId+"/items/"+t.id,relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:t}}if(t){if(s=t.parentReference&&t.parentReference){o=this._getRelativePathFromVroomPath(s.path);var h=s.name?s.name:o&&this._getFileNameFromPath(o);return{name:h,isRoot:this._isRootItem(h),graphItemUrl:"/drives/"+s.driveId+"/items/"+s.id,relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:{id:s.id}}}}}};e.prototype._getNavLink=function(e,t){var n=e.webUrl,r=n&&new w.t(n),i=t.navigationId;r&&i&&r.setQueryParameter("nav",i);return r.toString()||n};e.prototype._getNavId=function(e){return e&&e.navigationId};e.prototype._getNavigationId=function(e){var t,n,r,i,o,u,a;if(null===(t=e)||void 0===t?void 0:t.docDetails)return this._getNavId(e.docDetails);if(E&&s(e)){var f=y(e);return(null===(r=null===(n=f)||void 0===n?void 0:n.comment)||void 0===r?void 0:r.navigationId)?null===(o=null===(i=f)||void 0===i?void 0:i.comment)||void 0===o?void 0:o.navigationId:null===(a=null===(u=f)||void 0===u?void 0:u.comment)||void 0===a?void 0:a.commentId}};e.prototype._getAction=function(e,t,n,r){var f={};a(r)&&(f.version={newVersion:y(r).version.newVersion});if(c(r)){var l=y(r).move;if(i(r)){var p=void 0,g=void 0;l.from&&(p=this._getDirNameFromPath(l.from));l.to&&(g=this._getDirNameFromPath(l.to));f.move={from:{name:this._getFileNameFromPath(p),isRoot:this._isRootItem(p),graphItemUrl:void 0,absolutePath:p},to:{name:this._getFileNameFromPath(g),isRoot:this._isRootItem(g),graphItemUrl:void 0,absolutePath:g}}}else if(l.From){var b=this._getDirNameFromPath(l.From);f.move={from:{name:this._getFileNameFromPath(b),isRoot:this._isRootItem(b),graphItemUrl:void 0,absolutePath:b},to:void 0}}else if(l.to){var w=this._getDirNameFromPath(l.to);f.move={from:void 0,to:{name:this._getFileNameFromPath(w),isRoot:this._isRootItem(w),graphItemUrl:void 0,absolutePath:w}}}}if(h(r)){var E=y(r).rename;f.rename={newItem:{name:E.newName,isRoot:this._isRootItem(E.newName),graphItemUrl:t?t.graphItemUrl:void 0,relativePath:t?t.relativePath:void 0,absolutePath:t?t.absolutePath:void 0,driveItem:t?t.driveItem:void 0},oldItem:{name:E.oldName,isRoot:this._isRootItem(E.oldName),graphItemUrl:t?t.graphItemUrl:void 0,relativePath:t?t.relativePath:void 0,absolutePath:t?t.absolutePath:void 0,driveItem:t?t.driveItem:void 0}}}if(o(r)){(S=y(r).comment).isReply&&(f.commentResponse={commentAuthor:S.parentAuthor&&S.parentAuthor.user})}if(s(r)){var S;(S=y(r).comment).isReply||(f.comment={commentId:S.commentId})}if(u(r)){var x=y(r).mention;f.mention={mentionees:x.mentionees&&x.mentionees.map(function(e){return e.user})||[],commentId:i(r)?x.navigationId:void 0}}if(d(r)){var T=y(r).share;f.share={recipients:T.recipients&&T.recipients.map(function(e){return e.user})||[]}}v(r)&&(f.addShortcutToOneDrive={});if(m(r)){var N=y(r).addToOneDrive;f.removeShortcutFromOneDrive={mountPointName:N.mountPointName}}return f};e.prototype._getRelativePathFromVroomPath=function(e){if(e){return e.split(":",2)[1]}};e.prototype._getDirNameFromPath=function(e){return e&&e.substring(0,e.lastIndexOf("/"))};e.prototype._getFileNameFromPath=function(e){return e&&e.substring(e.lastIndexOf("/")+1)};e.prototype._isRootItem=function(e){return e&&"/LiveFolders"===e};return e})();t.e=S},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(11),i=n(0),s=n(52),o=n(2437),u=n(2189),a=(function(){function e(e,t){this._itemCommentsDataSource=t.itemCommentsDataSource;this._lastListenerId=-1;this._lastRepliesListenerId=-1;this._dictListener={};this._dictRepliesListener={};this._dictItemComments={};this._dictItemCommentReplies={};this._dictItemCommentIsDiabled={};this._dictItemCommentSettingsListener={};this._promiseDeduplicator=new u.e}e.prototype.addListener=function(e,t){this._lastListenerId++;var n=t.commentItemWrapper,r={item:n&&n.activityItemWrapper,currentUserEmail:t.currentUserEmail},i=this._getItemActivitiesDictionaryKey(r);this._dictListener[i]||(this._dictListener[i]={});this._dictListener[i][this._lastListenerId]=e;this._dictItemCommentIsDiabled[i]=n&&n.item.comments&&n.item.comments.settings&&n.item.comments.settings.isCommentDisabled;return{key:this._lastListenerId,itemKey:i}};e.prototype.removeListener=function(e){this._dictListener[e.itemKey]&&this._dictListener[e.itemKey][e.key]?delete this._dictListener[e.itemKey][e.key]:new Error("Listener with key "+e.key+" for item "+e.itemKey+" not found")};e.prototype.fetchItemComments=function(e){var t=this,n={item:e.itemWrapper.activityItemWrapper,currentUserEmail:e.currentUserEmail},r=this._getItemActivitiesDictionaryKey(n),o=this._dictItemComments[r];(!o||0===e.startIndex)&&(o={itemComments:{nextLink:"",comments:[],success:!0},noOfUnsuccessfulRequests:0});var u=o.itemComments;if(u.nextLink||e.itemWrapper.item&&0===e.startIndex){var a=this._dictItemComments[r]&&this._dictItemComments[r].noOfUnsuccessfulRequests||0,f=(u.nextLink||e.itemWrapper.item.id)+"_"+a;this._promiseDeduplicator.deduplicate(f,function(){var f={itemWrapper:e.itemWrapper,nextLink:u.nextLink,currentUserEmail:e.currentUserEmail,qosPrefix:e.qosPrefix};return t._itemCommentsDataSource.getComments(f).then(function(s){if(s&&s.success||o.noOfUnsuccessfulRequests>3){var f=t._updatedComments(u,s);t._dictItemComments[r]={itemComments:f,noOfUnsuccessfulRequests:0};for(var l=0,c=f.comments;l<c.length;l++){var h=c[l],p=h.action&&h.action.comment&&h.action.comment.commentDetail,d=t._getItemCommentRepliesDictionaryKey(n,p.id);t._dictItemCommentReplies[d]={itemComments:p.replies,noOfUnsuccessfulRequests:0}}t._emitChange(n)}else if(s&&s.isPermanentFailure||a>=3){t._dictItemComments[r]={itemComments:Object(i.__assign)(Object(i.__assign)({},u),{missingComments:!0}),noOfUnsuccessfulRequests:a+1};e.onError&&e.onError();t._emitChange(n)}else{t._dictItemComments[r]={itemComments:u,noOfUnsuccessfulRequests:a+1};t.fetchItemComments(e)}},function(t){e.onError&&e.onError();return s.n.reject(t)})})}};e.prototype.addRepliesListener=function(e,t,n){this._lastRepliesListenerId++;var r=this._getItemCommentRepliesDictionaryKey(t,n);this._dictRepliesListener[r]||(this._dictRepliesListener[r]={});this._dictRepliesListener[r][this._lastRepliesListenerId]=e;return{key:this._lastRepliesListenerId,itemKey:r}};e.prototype.removeRepliesListener=function(e){this._dictRepliesListener[e.itemKey]&&this._dictRepliesListener[e.itemKey][e.key]?delete this._dictRepliesListener[e.itemKey][e.key]:new Error("Listener with key "+e.key+" for item "+e.itemKey+" not found")};e.prototype.getItemComments=function(e){var t={item:e.itemWrapper.activityItemWrapper,currentUserEmail:e.currentUserEmail},n=this._getItemActivitiesDictionaryKey(t),r=this._dictItemComments[n];if(r)return r.noOfUnsuccessfulRequests>3?Object(i.__assign)(Object(i.__assign)({},r.itemComments),{missingComments:!0}):r.itemComments;this.fetchItemComments(Object(i.__assign)(Object(i.__assign)({},e),{startIndex:r?e.startIndex:0}));return{isPlaceHolder:!0,comments:void 0,success:!0}};e.prototype.addComment=function(e,t,n,r){return this._itemCommentsDataSource.addComment(e,t,n,r)};e.prototype.addItemCommentReply=function(e,t,n){return this._itemCommentsDataSource.addReply(e.itemWrapper,t,n,e.qosPrefix)};e.prototype.getItemCommentReplies=function(e,t){var n={item:e.itemWrapper.activityItemWrapper,currentUserEmail:e.currentUserEmail},r=this._getItemCommentRepliesDictionaryKey(n,t),s=this._dictItemCommentReplies[r];if(s)return s.itemComments;this.fetchItemCommentReplies(Object(i.__assign)(Object(i.__assign)({},e),{startIndex:0}),t);return{isPlaceHolder:!0,comments:void 0,success:!0}};e.prototype.addCommentSettingsListener=function(e,t){var n=t.commentItemWrapper,r={item:n&&n.activityItemWrapper,currentUserEmail:t.currentUserEmail},i=this._getItemActivitiesDictionaryKey(r);this._dictItemCommentSettingsListener[i]=e;this._dictItemCommentIsDiabled[i]=n&&n.item.comments&&n.item.comments.settings&&n.item.comments.settings.isCommentDisabled;return{key:1,itemKey:i}};e.prototype.removeCommentSettingsListener=function(e){this._dictItemCommentSettingsListener[e.itemKey]&&this._dictItemCommentSettingsListener[e.itemKey][e.key]?delete this._dictItemCommentSettingsListener[e.itemKey][e.key]:new Error("Listener with key "+e.key+" for item "+e.itemKey+" not found")};e.prototype.fetchIsCommentsDisabled=function(e){return this._itemCommentsDataSource.getIsCommentsDisabled(e)};e.prototype.getIsCommentsDisabled=function(e,t){var n={item:e.activityItemWrapper,currentUserEmail:t},r=this._getItemActivitiesDictionaryKey(n);return this._dictItemCommentIsDiabled[r]};e.prototype.setCommentsDisabled=function(e,t,n){var r=this;return this._itemCommentsDataSource.setCommentsDisabled(e,t).then(function(i){var s={item:e.activityItemWrapper,currentUserEmail:n},o=r._getItemActivitiesDictionaryKey(s);r._dictItemCommentIsDiabled[o]=t;r._emitCommentsSettingChange(s);return i})};e.prototype.deleteCommentById=function(e,t,n,r){var u=this;return this._itemCommentsDataSource.deleteCommentById(e,t,r).then(function(){var r={item:e.activityItemWrapper,currentUserEmail:n},a=u._getItemActivitiesDictionaryKey(r),f=u._dictItemComments[a],l=f&&f.itemComments&&f.itemComments.comments;if(l){var c=l.filter(function(e){return(e&&e.action&&e.action.comment&&e.action.comment.commentId)!==t});u._dictItemComments[a]=Object(i.__assign)(Object(i.__assign)({},f),{itemComments:Object(i.__assign)(Object(i.__assign)({},f.itemComments),{comments:c})});u._emitChange(r,o.e.DeletedSingle)}return s.n.resolve(!0)},function(e){return s.n.reject(e)})};e.prototype.deleteAllComments=function(e,t){var n=this;return this._itemCommentsDataSource.deleteAllComments(e).then(function(){var r={item:e.activityItemWrapper,currentUserEmail:t},i=n._getItemActivitiesDictionaryKey(r);n._dictItemComments[i]=void 0;n._emitChange(r,o.e.DeletedAll);return s.n.resolve(!0)},function(e){return s.n.reject(e)})};e.prototype.fetchItemCommentReplies=function(e,t){var n=this,r={item:e.itemWrapper.activityItemWrapper,currentUserEmail:e.currentUserEmail},i=this._getItemCommentRepliesDictionaryKey(r,t),o=this._dictItemCommentReplies[i];(!o||0===e.startIndex)&&(o={itemComments:{nextLink:"",comments:[],success:!0},noOfUnsuccessfulRequests:0});var u=o.itemComments;if(u.nextLink||e.itemWrapper.item&&0===e.startIndex){var a=(u.nextLink||e.itemWrapper.item.id)+"_"+o.noOfUnsuccessfulRequests;this._promiseDeduplicator.deduplicate(a,function(){var a={itemWrapper:e.itemWrapper,nextLink:u.nextLink,currentUserEmail:e.currentUserEmail,qosPrefix:e.qosPrefix};return n._itemCommentsDataSource.getReplies(a,t).then(function(s){var a=n._dictItemCommentReplies[i]&&n._dictItemCommentReplies[i].noOfUnsuccessfulRequests||0;if(s&&s.success||a>3){n._dictItemCommentReplies[i]={itemComments:n._updatedCommentWithReplies(u,s),noOfUnsuccessfulRequests:a};n._emitChangeForReplies(r,t)}else{n._dictItemComments[i]={itemComments:u,noOfUnsuccessfulRequests:o.noOfUnsuccessfulRequests+1};n.fetchItemCommentReplies(e,t)}},function(e){return s.n.reject(e)})})}};e.prototype._emitChange=function(e,t){var n=this._getItemActivitiesDictionaryKey(e),r=this._dictListener[n];if(r)for(var i=0,s=Object.getOwnPropertyNames(r);i<s.length;i++){(0,r[s[i]])(t)}};e.prototype._emitChangeForReplies=function(e,t){var n=this._getItemCommentRepliesDictionaryKey(e,t),r=this._dictRepliesListener[n];if(r)for(var i=0,s=Object.getOwnPropertyNames(r);i<s.length;i++){(0,r[s[i]])()}};e.prototype._emitCommentsSettingChange=function(e){var t=this._getItemActivitiesDictionaryKey(e),n=this._dictItemCommentSettingsListener[t];n&&n()};e.prototype._getItemActivitiesDictionaryKey=function(e){var t=e.item&&(e.item.graphItemUrl||e.item.absolutePath);e.currentUserEmail&&(t+="_"+e.currentUserEmail);return t};e.prototype._getItemCommentRepliesDictionaryKey=function(e,t){var n=e.item&&(e.item.graphItemUrl||e.item.absolutePath);e.currentUserEmail&&t&&(n+="_"+e.currentUserEmail+"_"+t);return n};e.prototype._updatedComments=function(e,t){return{comments:(e&&e.comments||[]).concat(t.comments),nextLink:t.nextLink,success:!0}};e.prototype._updatedCommentWithReplies=function(e,t){var n=e&&e.comments||[];return{comments:t.comments.concat(n),nextLink:t.nextLink,success:!0}};return e})(),f=n(76),l=Object(r.s)("ItemCommentsStore",a,{itemCommentsDataSource:f.M.optional})}],Array(20),[function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"n",function(){return i});n.d(t,"r",function(){return s});n.d(t,"i",function(){return o});n.d(t,"s",function(){return u});n.d(t,"e",function(){return a});var r="socialBarList_36611a00",i="socialBarPanel_36611a00",s="socialBarPanelContent_36611a00",o="socialBarPanelPersona_36611a00",u="socialBarPanelPersonaDescription_36611a00",a="analyticsStatsLink_36611a00"}],Array(150),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){var t=document.createElement("input");t.setAttribute("type","text");t.setAttribute("value",e);document.body.appendChild(t);var n=!1;try{t.focus();t.select();n=document.execCommand("copy")}catch(e){}if(!n&&window.navigator&&window.navigator.clipboard)try{window.navigator.clipboard.writeText(t.value);n=!0}catch(e){}document.body.removeChild(t);return n}},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(7),i=n(1649),s=new r.t({name:"RefreshClientForm.key.RefreshClienForm",factory:{dependencies:{observablesFactoryType:i.i},create:function(e){var t=new e.observablesFactoryType;return{instance:t.create(!1),disposable:t}}}})}],Array(25),[function(e,t,n){"use strict";var r=n(138);Object(r.n)([{rawString:".od-SharingLink{margin-bottom:.625rem;display:block}.od-SharingLink-cell{display:inline-block}.od-SharingLink-iconCell{vertical-align:top;width:3rem;height:3rem;position:relative}[dir=ltr] .od-SharingLink-iconCell{padding-right:.625rem}[dir=rtl] .od-SharingLink-iconCell{padding-left:.625rem}.od-SharingLink-icon{display:inline-block;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";font-size:1.125rem;min-width:3rem;height:3rem;text-align:center;line-height:3rem;position:absolute;background-color:transparent;border-width:.0625rem;border-style:solid;border-radius:50%}.od-SharingLink-iconBackground{display:inline-block;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";border-radius:50%;min-width:3rem;height:3rem;border-style:solid;border-width:.0625rem;position:absolute}[dir=ltr] .od-SharingLink-iconBackground{margin-right:.625rem}[dir=rtl] .od-SharingLink-iconBackground{margin-left:.625rem}.od-SharingLink-url .od-SharingLink-cell{width:100%}.od-SharingLink-table{display:table;width:100%}.od-SharingLink-row{display:flex;flex-wrap:wrap}.od-SharingLink-input{width:100%;text-overflow:ellipsis;margin-bottom:.1875rem;margin-top:.3125rem;font-size:.875rem;min-width:5rem;height:2rem}.od-SharingLink-removeLinkButton{margin:0;padding:.3125rem;border:0;background:0 0;cursor:pointer;font-size:.75rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}[dir=ltr] .od-SharingLink-removeLinkButton-leftMargin{margin-left:.25rem}[dir=rtl] .od-SharingLink-removeLinkButton-leftMargin{margin-right:.25rem}.od-SharingLink-linkSwitcher{display:inline;cursor:pointer}.od-SharingLink-linkMember{display:inline-block;padding:.125rem .25rem}.od-SharingLink-linkMember .ms-Icon{font-size:.75rem;width:1.5rem;text-align:center;line-height:1.5rem}.od-SharingLink-linkUser{width:12.5rem}.od-SharingLink-linkUser .ms-Icon.ms-Icon--ChevronDown,.od-SharingLink-linkUser .ms-Icon.ms-Icon--ChevronUp{width:1.5rem;height:1.5rem;border-radius:50%;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";display:inline-block;margin:0 .25rem;line-height:1.5rem}.od-SharingLink-linkUser .ms-Icon--ChevronDown:before,.od-SharingLink-linkUser .ms-Icon--ChevronUp:before,.od-SharingLink-linkUser .ms-Icon.ms-Icon--ChevronUp:before,.od-SharingLink-linkUser .ms-Icon.ms-Icon--chevronDown:before{line-height:1.5rem;display:table-cell;width:1.5rem;text-align:center}.od-SharingLink-chevron{font-size:.6875rem}[dir=ltr] .od-SharingLink-chevron{margin-left:.25rem}[dir=rtl] .od-SharingLink-chevron{margin-right:.25rem}.od-SharingLink-sharingHint{display:inline;border:none;background:0 0;padding:0;cursor:pointer;font-size:.75rem}html[dir=ltr] .od-SharingLink-sharingHint{text-align:left}html[dir=rtl] .od-SharingLink-sharingHint{text-align:right}.od-SharingLink-anonymous{color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.od-SharingLink-csl{color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:"}.od-SharingLink-psl{color:"},{theme:"orangeLighter",defaultValue:"#ff8c00"},{rawString:"}.od-SharingLink-generic{border-color:transparent}.od-SharingLink-anonymous-bg{background-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:";border-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:";opacity:.1}.od-SharingLink-csl-bg{background-color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:";border-color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:";opacity:.1}.od-SharingLink-psl-bg{background-color:"},{theme:"orangeLighter",defaultValue:"#ff8c00"},{rawString:";border-color:"},{theme:"orangeLighter",defaultValue:"#ff8c00"},{rawString:";opacity:.1}.od-SharingLink-generic-bg{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}html[dir=ltr] .od-SharingLink-lock{margin-left:.75rem}html[dir=rtl] .od-SharingLink-lock{margin-right:.75rem}.od-SharingLink-sharingHintContainer{display:flex}.od-SharingLink-primaryText{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-weight:400;font-size:1.0625rem;white-space:nowrap;max-width:100%;overflow:hidden;text-overflow:ellipsis;padding-bottom:.1875rem;display:inline;padding-right:.3125rem}.od-SharingLink-emailText,.od-SharingLink-sharingRole-Text{font-weight:400;font-size:.75rem;padding-bottom:.1875rem;white-space:nowrap;height:auto;overflow:hidden;text-overflow:ellipsis}.od-SharingLink-secondaryText{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SharingLink-readonly{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-SharingLink-tooltipHost{display:inline}.od-SharingLink-infoIconToolTipBind{vertical-align:baseline;font-size:.75rem}.od-SharingLink-infoTooltipContent{font-size:.75rem}.od-SharingLink-learnMoreText{padding-left:.3125rem}"}]);var i=n(0),s=n("knockout-lib"),o=n(888),u=n(1794),a=n(1819),f=n(52),l=n(1682),c=n(2383),h=n(2019),p=n(1887),d=n(1749),v=n(2567),m=n(1796),g=n(22),y=n(1651),b=n(2049),w=n(2298),E=n(2131),S=n(2638);Object(r.n)([{rawString:".od-EditLink{margin-top:20px}.od-EditLink-linkExpiresInputDiv{display:inline-block;margin:12px 0 14px}.od-EditLink-linkExpiresInput{width:40px}.od-EditLink-linkExpiresCheckbox{display:flex;flex-direction:column}.od-EditLink-setPasswordInputContainer{margin-top:12px}.od-EditLink-setPasswordInput{height:28px}.od-EditLink-invalidPasswordOutline{outline:1px solid "},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-EditLink-invalidPasswordError{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";font-size:12px;margin-top:8px}.od-EditLink-setPasswordCheckbox{display:flex;flex-direction:column}.od-EditLink-removeLinkHolder{align-items:center;color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";display:flex;margin:34px 0}.od-EditLink-removeLinkText{font-size:14px;font-weight:400;background:0 0;border:none;color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";cursor:pointer}[dir=ltr] .od-EditLink-removeLinkText{margin-left:4px}[dir=rtl] .od-EditLink-removeLinkText{margin-right:4px}.od-EditLink-passwordProtectedLinkInformationArea{margin-top:8px;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";display:flex}.od-EditLink-passwordProtectedLinkInformationTextArea{padding:10px;font-size:14px}.od-EditLink-passwordProtectedLinkInformationIcon{font-size:17px;padding-top:14px}html[dir=ltr] .od-EditLink-passwordProtectedLinkInformationIcon{padding-left:10px}html[dir=rtl] .od-EditLink-passwordProtectedLinkInformationIcon{padding-right:10px}"}]);var x,T=n(1499),N=n(2255),C=n(996),k=n(1649);(function(e){e[e.Invalid=0]="Invalid";e[e.Empty=1]="Empty";e[e.Valid=2]="Valid"})(x||(x={}));var L=(function(e){Object(i.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.computeExpirationValidity=function(e){if(""===e)return x.Empty;var t=e.match(/^-?[0-9]+/);if(t&&t[0]!==e||!t)return x.Invalid;var n=parseInt(e,10);return n<=0||n>1825?x.Invalid:x.Valid};t.prototype.computeLinkExpiresInputLabel=function(e){if(this.computeExpirationValidity(e)===x.Valid){var t=parseInt(e,10),n=new Date;n.setDate(n.getDate()+t);return g.format(N.se,Object(C.s)(n))}return N.ie};t.prototype.getDaysFromToday=function(e){var t=new Date;return Math.round((e.getTime()-t.getTime())/864e5)};t.prototype.calculateLinkExpiration=function(e){if(e>0&&e<=1825){var t=new Date;t.setDate(t.getDate()+e);return t.toISOString()}return null};return t})(k.n),A=n(46),O=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.setPasswordAriaLabel=S.s;var r=t.onClose,i=t.onLinkRemoved,s=t.sharingLink;n._onClose=r;n._onLinkRemoved=i;n._sharingLink=s;n.addBindingHandlers({selectOnFocus:p.e});n._itemProvider=n.resources.consume(T.resourceKey);n._sharingProvider=n.resources.consume(u.resourceKey);n._engagement=n.resources.consume(o.e);n._sharingLinkExpirationHelper=new(n.managed(L));n.cancelButtonText=S.e;n.createBackgroundComputed(n._computeValidInput);n.invalidPasswordText=N.oe;n.linkExpirationInDays=n.createObservable(n._getDefaultLinkExpirationInDays(n._sharingLink.expiration));n.linkExpiresChecked=n.createObservable(!!n._sharingLink.expiration);n.linkExpiresInputLabel=n.createPureComputed(n._computeLinkExpiresInputLabel);n.linkExpiresText=S.i;n.passwordChanged=n.createObservable(!1);n.passwordValue=n.createObservable("");n.updateButtonText=S.f;n.setPasswordPermissionsWarning=N.Q;n.removeLinkButtonText=S.r;n.arePasswordLinksEnabled=Object(A.isFeatureEnabled)(A.EnablePasswordProtectedLinks);n.isSetPasswordChecked=n.createObservable(!!n._sharingLink.hasPassword);n.setPasswordLabel=S.o;n.arePasswordLinksEnabled&&n._onSetPasswordChecked();n.isPasswordInvalid=n.createComputed(n._computeIsPasswordInvalid);n.isUpdateButtonDisabled=n.createComputed(n._computeIsUpdateButtonDisabled);return n}t.prototype.onUpdateClick=function(){var e=this;this._logEngagementEvent("Update");var t=this._sharingLink,n=[t.item],r=this.linkExpiresChecked.peek()?this._sharingLinkExpirationHelper.calculateLinkExpiration(parseInt(this.linkExpirationInDays.peek(),10)):null,i={type:t.type,role:t.role,create:!0,expiration:r,name:t.name,id:t.id};if(this.arePasswordLinksEnabled){var s=this.isSetPasswordChecked.peek(),o=s&&this.passwordChanged.peek(),u=!s&&t.hasPassword;o&&(i.password=this.passwordValue.peek());u&&(i.password="")}this._sharingProvider.manageSharingLinks(n,i).then(function(t){e._itemProvider.invalidateItem(n[0].key,{triggerFetch:!0});e._onClose()})};t.prototype.changePasswordInput=function(){this.passwordChanged(!0);this.passwordValue("")};t.prototype.onCancelClick=function(){this._logEngagementEvent("Cancel");this._onClose()};t.prototype.onRemoveLinkClicked=function(){var e=this,t=this._sharingLink,n=this.resources.consume(l.e);this._logEngagementEvent("RemoveLink");h.e(function(){e._engagement.logData({name:"Disable "+t.tag+" Link.SharingLink.Click",isIntentional:!0});var r={link:t,type:t.type,role:t.role,create:!1};return e._sharingProvider.manageSharingLinks([t.item],r).then(function(t){e._onLinkRemoved&&e._onLinkRemoved();return f.n.wrap(!0)},function(e){var t=e&&e.message||S.u;h.t(t,S.a,n);return!1})},function(e){},n,"EditLink")};t.prototype._onSetPasswordChecked=function(){if(this._sharingLink&&this._sharingLink.hasPassword){this.passwordValue("        ")}};t.prototype._computeValidInput=function(){var e=this.linkExpirationInDays(),t=parseInt(e,10),n=t.toString();if(t<=0&&t>1825){n="";this.linkExpiresChecked(!1)}this.linkExpirationInDays(n)};t.prototype._computeIsPasswordInvalid=function(){var e=this.passwordValue();return this.isSetPasswordChecked()&&this.passwordChanged()&&e.length>0&&0===e.trim().length};t.prototype._computeIsUpdateButtonDisabled=function(){var e=this.linkExpiresChecked(),t=this.isSetPasswordChecked(),n=this.isPasswordInvalid();if(!e&&!t)return!1;var r=this.linkExpirationInDays();return this._sharingLinkExpirationHelper.computeExpirationValidity(r)!==x.Valid||n};t.prototype._computeLinkExpiresInputLabel=function(){var e=this.linkExpirationInDays();return this._sharingLinkExpirationHelper.computeLinkExpiresInputLabel(e)};t.prototype._getDefaultLinkExpirationInDays=function(e){var t=parseInt("30",10);e&&(t=this._sharingLinkExpirationHelper.getDaysFromToday(new Date(e)));return t.toString()};t.prototype._logEngagementEvent=function(e){this._engagement.logData({name:"EditLinkPanel."+e+".Click",isIntentional:!0,extraData:{linkExpiration:this.linkExpirationInDays.peek(),hasPassword:0!==this.passwordValue.peek().length}})};return t})(y.t),M=n(1652),_=M.e({tagName:"od-editLink",template:'<div class="od-EditLink"><div class="od-CheckBox od-EditLink-linkExpiresCheckbox"><input type="checkbox" id="od-EditLink-linkExpires" data-bind="checked:linkExpiresChecked" class="od-CheckBox-input"><label for="od-EditLink-linkExpires" class="od-CheckBox-field" data-bind="css:{\'is-checked\':linkExpiresChecked}"><span data-bind="text:linkExpiresText,automation:\'linkExpiresText\'" class="od-Label"></span></label>\x3c!--ko if:linkExpiresChecked()--\x3e<div class="od-EditLink-linkExpiresInputDiv"><input id="od-EditLink-linkExpiresInput" class="od-EditLink-linkExpiresInput" type="number" data-bind="value:linkExpirationInDays,selectOnFocus:{isPermanent:false,isReentrant:true}"><label for="od-EditLink-linkExpiresInput"><span class="od-EditLink-linkExpiresInputLabel" data-bind="text:linkExpiresInputLabel"></span></label></div>\x3c!--/ko--\x3e</div>\x3c!--ko if:arePasswordLinksEnabled--\x3e<div class="od-CheckBox od-EditLink-setPasswordCheckbox"><input type="checkbox" id="od-EditLink-setPassword" data-bind="checked:isSetPasswordChecked" class="od-CheckBox-input"><label for="od-EditLink-setPassword" class="od-CheckBox-field" data-bind="css:{\'is-checked\':isSetPasswordChecked}"><span data-bind="text:setPasswordLabel,automation:\'setPasswordLabel\'" class="od-Label"></span></label>\x3c!--ko if:isSetPasswordChecked()--\x3e<div class="od-EditLink-setPasswordInputContainer"><input id="od-EditLink-setPasswordInput" class="od-EditLink-setPasswordInput" type="password" data-bind="attr:{\'aria-label\':setPasswordAriaLabel,\'aria-invalid\':isPasswordInvalid()},value:passwordValue,valueUpdate:\'input\',click:changePasswordInput,selectOnFocus:{isPermanent:false,isReentrant:true},css:{\'od-EditLink-invalidPasswordOutline\':isPasswordInvalid()}"></div>\x3c!--ko if:isPasswordInvalid()--\x3e<div class="od-EditLink-invalidPasswordError" role="alert" data-bind="text:invalidPasswordText"></div>\x3c!--/ko--\x3e<div class="od-EditLink-passwordProtectedLinkInformationArea"><i class="ms-Icon ms-Icon--Info od-EditLink-passwordProtectedLinkInformationIcon" data-bind="icon:true"></i><div class="od-EditLink-passwordProtectedLinkInformationTextArea" data-bind="text:setPasswordPermissionsWarning"></div></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e<div class="od-EditLink-removeLinkHolder"><i class="ms-Icon ms-Icon--Delete" data-bind="icon:true"></i><button class="od-EditLink-removeLinkText" data-bind="click:onRemoveLinkClicked,text:removeLinkButtonText"></button></div><div class="od-EditLink-buttons"><button class="od-Button od-Button--primary" role="button" data-bind="click:onUpdateClick,disable:isUpdateButtonDisabled"><span class="od-Button-label" data-bind="text:updateButtonText"></span></button><button class="od-Button" role="button" data-bind="click:onCancelClick"><span class="od-Button-label" data-bind="text:cancelButtonText"></span></button></div></div>',viewModel:O,synchronous:!0}),D=n(1663),P=n(977),H=n(1966),B=n("react-lib"),j=n(1486),F=n(1635),I=n(1547),q=v.l,R=v.c,U={onRenderContent:function(){return B.createElement("p",{className:"od-SharingLink-infoTooltipContent"},q,B.createElement(F.e,{className:"od-SharingLink-learnMoreText",target:"_blank",href:"https://go.microsoft.com/fwlink/?linkid=2150444"},R))}},z=(function(e){Object(i.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return B.createElement(I.e,{tooltipProps:U,hostClassName:"od-SharingLink-tooltipHost"},B.createElement(P.e,{iconName:"Info",className:"ms-Icon ms-Icon--Info od-SharingLink-infoIconToolTipBind"}))};return t})(j.e),W=(function(e){Object(i.__extends)(t,e);function t(t){var n,r=e.call(this,t)||this;r.passwordProtectedLinkIndicatorLabel=S.n;r._engagement=r.resources.consume(o.e);r.link=t.link;var i=!t.isShareLinkVisible||t.isShareLinkVisible,f=6===r.link.kind?r._dedupeLinkMembers(r.link.linkInvitees.concat(r.link.linkMembers)):r.link.linkMembers;r.totalLinkMembers=r.createObservable(f);r._extraMembersCount=r.createPureComputed(r._getExtraMembers);r.extraMembersText=r.createPureComputed(r._getExtraMemberText);r.briefLinkMembers=r.createPureComputed(r._getBriefLinkMembers);r.extraLinkMembers=r.createPureComputed(r._getExtraLinkMembers);r.extraMembersName=r.createPureComputed(r._getExtraMembersName);r.showTotal=r.createObservable(!1);r.personaTagName=b.e.tagName;r.personaSize=7;r.isLinkVisible=10!==r.link.type&&i;r._onLinkRemoved=t.onLinkRemoved;r.isEditable=t.isEditable||!1;r.arePasswordLinksEnabled=Object(A.isFeatureEnabled)(A.EnablePasswordProtectedLinks);r.isPasswordProtectedLink=r.link&&r.link.hasPassword;r.linkEmail=r.link.email;r.sharingRoleText=h.r(null===(n=r.link)||void 0===n?void 0:n.role);r.panelOverlayTagName=E.e.tagName;r.editLinkTagName=_.tagName;r.editLinkPanelTitle=S.t;r.editLinkParams={onClose:r.onClosePanel.bind(r),onLinkRemoved:r._onLinkRemoved,sharingLink:r.link};r.showEditLinkPanel=r.createObservable(!1);r._sharingProvider=r.resources.consume(u.resourceKey);r.disableLinkText=S.r;r.shareableLinkText=v.d;r.requestAccessLinkText=v.f;r.isInheritedText=r.link.isInherited?v.s:"";r.sharingHintText=s.observable("");var l=r.resources.consume(a.resourceKey.optional);l&&l.loadData().then(function(e){r.sharingHintText(c.e(r.link,e.CompanyDisplayName))});r.canManageLinks=s.observable(!1);r._sharingProvider.getSharingData(r.link.item).getSettings().then(function(e){Object(A.isFeatureEnabled)(A.EnableLinkLevelManageAccess)?r.canManageLinks(r.link.linkMembers&&!r.link.isInherited&&!H.i(r.link.item)):r.canManageLinks(e.canManageLinks&&!r.link.isInherited&&!H.i(r.link.item))});r.addBindingHandlers({tooltip:d.e,selectOnFocus:p.e,react:D.t});r.iconComponent=P.e;r.iconComponentProps=r._getLinkIconProps(r.link);r.showNewRequestAccessUi=r.isRequestAccess&&Object(A.isFeatureEnabled)(A.ShowRequestAccessLinkUi);r.showNewRequestAccessUi&&(r.tooltipComponent=z);return r}t.prototype.logCopy=function(){this._engagement.logData({name:this.link.tag+"Link.SharingLink.Copy",isIntentional:!0});return!0};t.prototype.removeSharingLink=function(){var e=this,t=this.resources.consume(l.e);h.e(function(){e._engagement.logData({name:"Disable "+e.link.tag+" Link.SharingLink.Click",isIntentional:!0});var t={link:e.link,type:e.link.type,role:e.link.role,create:!1};return e._sharingProvider.manageSharingLinks([e.link.item],t).then(function(t){e._onLinkRemoved&&e._onLinkRemoved();return f.n.wrap(!0)},function(e){return!1})},function(t){e.isReady=t},t,"SharingLink")};t.prototype.onSharingHintClick=function(){if(this.isEditable){this._engagement.logData({name:this.link.tag+"Link.SharingLink.EditPermissions",isIntentional:!0});this.showEditLinkPanel(!0)}};t.prototype.onClosePanel=function(){this.showEditLinkPanel(!1)};t.prototype.showTotalLinkMembers=function(){this.showTotal(!0)};t.prototype.hideTotalLinkMembers=function(){this.showTotal(!1)};t.prototype._getExtraMembers=function(){var e=(this.link.linkMembers?this.link.linkMembers.length:0)-6;return e>0?e+1:0};t.prototype._getExtraMemberText=function(){var e="",t=this._extraMembersCount();if(t){t>99&&(e=m.sharingExtraNumberOverflow);e=g.format(m.sharingExtraNumberText,t)}return e};t.prototype._getBriefLinkMembers=function(){var e=this.totalLinkMembers(),t=e?e.slice(0,5):[];return this._extraMembersCount()?t:e};t.prototype._getExtraLinkMembers=function(){var e=this.totalLinkMembers();return e?e.slice(5):[]};t.prototype._getExtraMembersName=function(){return this.totalLinkMembers().slice(5).map(function(e){return e.name}).join(v.a)};t.prototype._dedupeLinkMembers=function(e){for(var t=[],n=[],r=0,i=e;r<i.length;r++){var s=i[r],o=s.email;if(!t[o]){t[o]=!0;n.push(s)}}return n};t.prototype._getLinkIconProps=function(e){var t=e.kind;this.isAnonymousLink=e.audience===w.e.anyone||5===t||4===t;this.isCSL=e.audience===w.e.organization||3===t||2===t;this.isPSL=e.audience===w.e.specificPeople||e.audience===w.e.specificPeopleFlex;this.isGeneric=!this.isAnonymousLink&&!this.isCSL&&!this.isPSL;this.isRequestAccess=11===e.type;var n="Link";this.isAnonymousLink?n="Globe":this.isCSL?n="Work":this.isPSL?n="PeopleAdd":this.isRequestAccess&&(n="Mail");return{iconName:n}};return t})(y.t),X=M.e({tagName:"od-sharingLink",template:'<div class="od-SharingLink" role="group" data-bind="attr:{\'aria-label\':sharingHintText}"><div class="od-SharingLink-cell od-SharingLink-iconCell"><div class="od-SharingLink-iconBackground" data-bind="css:{\'od-SharingLink-anonymous-bg\':isAnonymousLink,\'od-SharingLink-csl-bg\':isCSL,\'od-SharingLink-psl-bg\':isPSL,\'od-SharingLink-generic-bg\':isGeneric}"></div><div class="od-SharingLink-icon" role="presentation" data-bind="react:{componentType:iconComponent,props:iconComponentProps},css:{\'od-SharingLink-anonymous\':isAnonymousLink,\'od-SharingLink-csl\':isCSL,\'od-SharingLink-psl\':isPSL,\'od-SharingLink-generic\':isGeneric}"></div></div><div class="od-SharingLink-cell"><div class="od-Sharinglink-table od-Sharinglink-url"><div class="od-Sharinglink-row"><div class="od-SharingLink-cell">\x3c!--ko if:isLinkVisible--\x3e\x3c!--ko if:showNewRequestAccessUi--\x3e<div><div class="od-SharingLink-primaryTextContainer"><div class="od-SharingLink-primaryText" data-bind="text:requestAccessLinkText"></div><div class="od-SharingLink-tooltipHost" data-bind="react:{componentType:tooltipComponent}"></div></div><div class="od-SharingLink-emailText od-SharingLink-secondaryText" data-bind="text:linkEmail"></div><div class="od-SharingLink-sharingRole-Text od-SharingLink-readonly" data-bind="text:sharingRoleText"></div></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:showNewRequestAccessUi--\x3e<input class="od-SharingLink-input od-TextField-field" type="text" readonly data-bind="value:link.url,selectOnFocus:{isPermanent:true},attr:{title:shareableLinkText,\'aria-label\':shareableLinkText},event:{copy:$component.logCopy.bind($component)}">\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot:isLinkVisible--\x3e<span class="od-SharingLink-linkSwitcher" data-bind="text:sharingHintText"></span>\x3c!--/ko--\x3e</div>\x3c!--ko if:canManageLinks--\x3e<div class="od-SharingLink-cell od-SharingLink-removeLinkCell"><button class="od-SharingLink-removeLinkButton" data-bind="css:{\'od-SharingLink-removeLinkButton-leftMargin\':isLinkVisible},click:removeSharingLink,attr:{title:disableLinkText,\'aria-label\':disableLinkText}"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button></div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if:isLinkVisible--\x3e<div class="od-SharingLink-linkSwitcher">\x3c!--ko if:isEditable--\x3e<div class="od-SharingLink-sharingHintContainer"><button class="od-SharingLink-sharingHint" data-bind="click:onSharingHintClick">\x3c!--ko text:sharingHintText--\x3e\x3c!--/ko--\x3e<i class="ms-Icon ms-Icon--ChevronDown od-SharingLink-chevron" data-bind="icon:true"></i></button>\x3c!--ko if:arePasswordLinksEnabled--\x3e\x3c!--ko if:isPasswordProtectedLink--\x3e<i class="ms-Icon ms-Icon--Lock od-SharingLink-lock" role="img" data-bind="icon:true,attr:{\'aria-label\':passwordProtectedLinkIndicatorLabel}"></i>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if:!isEditable--\x3e<div class="od-SharingLink-sharingHint" data-bind="text:sharingHintText"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if:link.linkMembers--\x3e<div class="od-SharingLink-linkUser"><div class="od-Sharing-briefLinkMembers">\x3c!--ko foreach:briefLinkMembers--\x3e<div class="od-SharingLink-linkMember" data-bind="component:{name:$parent.personaTagName,params:{person:$data,personaSize:$parent.personaSize}}"></div>\x3c!--/ko--\x3e\x3c!--ko if:extraMembersText()--\x3e\x3c!--ko if:!showTotal()--\x3e<div class="ms-Icon ms-Icon--ChevronDown" role="button" data-bind="icon:true,click:showTotalLinkMembers,tooltip:{content:extraMembersName}"></div>\x3c!--/ko--\x3e\x3c!--ko if:showTotal()--\x3e<div class="ms-Icon ms-Icon--ChevronUp" role="button" data-bind="icon:true,click:hideTotalLinkMembers"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if:showTotal()--\x3e<div class="od-Sharing-extraLinkMembers">\x3c!--ko foreach:extraLinkMembers--\x3e<div class="od-SharingLink-linkMember" data-bind="component:{name:$parent.personaTagName,params:{person:$data,personaSize:$parent.personaSize}}"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if:showEditLinkPanel--\x3e\x3c!--ko component:{name:panelOverlayTagName,params:{onClose:$component.onClosePanel.bind($component),title:editLinkPanelTitle}}--\x3e\x3c!--ko component:{name:editLinkTagName,params:editLinkParams}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e',viewModel:W,synchronous:!0});t.e=X},,,,,,function(e,t,n){"use strict";var r=n(0),i=n(52),s=n(763),o=n(48),u=n(1661),a=n(1796),f=n(1664),l=n(138);Object(l.n)([{rawString:".FolderTypeEditor-option+.FolderTypeEditor-option{margin-top:10px}"}]);var c=n(1651),h=n(2141),p=n("knockout-lib"),d=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.infoPaneResx=a;n.category=t.category;n.typeDocuments=h.e[h.e.documents];n.typePhotos=h.e[h.e.photos];n.categoryText=p.observable(h.e[n.category()]);n.subscribe(n.categoryText,function(){n.category(h.e[n.categoryText()])});return n}return t})(c.t),v=n(1652).e({tagName:"ms-folder-type-editor",template:'<div class="FolderTypeEditor"><div class="FolderTypeEditor-option"><div class="ms-RadioButton"><input class="ms-RadioButton-input" type="radio" name="folderType" id="folderTypeDocuments" data-bind="attr:{value:typeDocuments},checked:categoryText"><label for="folderTypeDocuments" class="ms-RadioButton-field"><span class="od-Label" data-bind="text:infoPaneResx.informationFolderTypeDocuments"></span></label></div></div><div class="FolderTypeEditor-option"><div class="ms-RadioButton"><input type="radio" name="folderType" id="folderTypePhotos" value="photos" data-bind="attr:{value:typePhotos},checked:categoryText" class="ms-RadioButton-input"><label for="folderTypePhotos" class="ms-RadioButton-field"><span class="od-Label" data-bind="text:infoPaneResx.informationFolderTypePhotos"></span></label></div></div></div>',viewModel:d,synchronous:!0}),m=n(76),g=n(1499),y=n(1682),b=n(1674),w=n(46),E=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="ChangeFolderType";r._itemProvider=r.resources.consume(g.resourceKey);r._urlDataSource=r.resources.consume(m.ve);r._identityDataSource=r.resources.consume(m.S);r._itemSelectionHelper=new(r.child(b.e))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){if(Object(w.isFeatureEnabled)(w.ChangeFolderTypeDisabled))return!1;var e=this._itemSelectionHelper.firstItem(),t=this._identityDataSource.getIdentity();return!(!e||!t||void 0===e.queryType||t.type===s.e.anonymous||void 0===e.category||this._urlDataSource.isRecycleBin(e.queryType))};t.prototype.onExecute=function(e,t){return Object(r.__awaiter)(this,void 0,i.n,function(){var e,t,n,s,f=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:if(!(e=r.sent()))return[2,i.n.resolve({resultCode:"EmptySelection",resultType:o.e.Failure})];t=e.category;n=this.observables.create(t);s=this.resources.consume(y.e);return[2,s.requestDialog({title:a.informationChangeFolderTitle,component:{name:v.tagName,params:{category:n}},actions:[{name:a.informationSave,execute:function(){return i.n.resolve(2)},isAvailable:this.createComputed(function(){return e.category!==n()}),isDefault:!0,icon:new u.e("Save"),automationId:"changeFolderTypeSave"}]}).wait().then(function(){return f._itemProvider.changeFolderType({category:n(),item:e}).then(function(){return{resultType:o.e.Success}})})]}})})};return t})(f.e);t.e=E},,,function(e,t,n){"use strict";var r=n(138);Object(r.n)([{rawString:".od-PolicyTipMessageBar{padding:8px;display:flex}.od-PolicyTipMessageBar-content{display:flex;flex-direction:row}.od-PolicyTipMessageBar-text{font-size:12px;font-weight:400;display:flex;flex-direction:column;overflow-x:auto}.od-PolicyTipMessageBar-icon{font-size:16px}[dir=ltr] .od-PolicyTipMessageBar-icon{padding-right:8px}[dir=rtl] .od-PolicyTipMessageBar-icon{padding-left:8px}.od-PolicyTipMessageBar-block{background-color:#fde7e9}.od-PolicyTipMessageBar-block .od-PolicyTipMessageBar-icon{color:#a80000}.od-PolicyTipMessageBar-severeWarning{background-color:#fed9cc}.od-PolicyTipMessageBar-severeWarning .od-PolicyTipMessageBar-icon{color:#d83b01}.od-PolicyTipMessageBar-severeWarning .od-PolicyTipMessageBar-text{color:#323130}.od-PolicyTipMessageBar-warning{background-color:#fff4ce}.od-PolicyTipMessageBar-warning .od-PolicyTipMessageBar-icon{color:#323130}.od-PolicyTipMessageBar-warning .od-PolicyTipMessageBar-text{color:#323130}"}]);var i=n(0),s=n(2110),o=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.item,i=t.onClick;n.item=r;n.onClick=i;var o=r.policyTip,u=s.r(o,2),a=s.r(o,1);n.isBlock=u;n.isNotify=!u&&a;n.isInfo=!u&&!a;n.hasPolicyTip=n.observables.create(!!o);n.messageBarAction=n.onClick;n.messageBarActionText=s.e();n.messageBarText=s.n(o);return n}return t})(n(1651).t),u=n(1652).e({tagName:"od-policy-tip-message-bar",template:'\x3c!--ko if:hasPolicyTip()--\x3e<div class="od-PolicyTipMessageBar" data-bind="css:{\'od-PolicyTipMessageBar-block\':isBlock,\'od-PolicyTipMessageBar-severeWarning\':isNotify,\'od-PolicyTipMessageBar-warning\':isInfo}"><div class="od-PolicyTipMessageBar-content"><div class="od-PolicyTipMessageBar-icon"><i class="ms-Icon" data-bind="icon:true,css:{\'ms-Icon--Blocked2\':isBlock,\'ms-Icon--Warning\':isNotify,\'ms-Icon--Info\':isInfo}"></i></div><div class="od-PolicyTipMessageBar-text"><span data-bind="text:messageBarText"></span><a role="button" class="od-Link" href="javascript:;" data-bind="text:messageBarActionText,click:messageBarAction"></a></div></div></div>\x3c!--/ko--\x3e',viewModel:o,synchronous:!0});t.e=u},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(11),i=n(1814),s=n(1001),o=n(49),u=n(1999),a=n(1784),f=n(1964),l=n(2104),c=n(52),h=n(109),p=n(48),d=(function(){function e(e,t){this._pageContext=t.pageContext;this._oAuthTokenProvider=t.oAuthTokenProvider}e.prototype.getUserPrincipalName=function(){return this._pageContext.userLoginName};e.prototype.getLppOptions=function(){var e=this;return{hostAppPlatform:"Web",hostAppRing:this._pageContext.env2,hostAppName:"ShareDialog",clientCorrelationId:this._pageContext.CorrelationId,clientType:"ShareDialog",refreshAuthToken:function(){return e.getLokiToken()},offline:this._pageContext.isExternalGuestUser}};e.prototype.getLokiToken=function(){if(this._oAuthTokenProvider){var e=new h.e({name:"PeoplePicker.GetLokiToken"});return this._oAuthTokenProvider.getToken("https://loki.delve.office.com").then(function(t){e.end({resultType:p.e.Success});return t},function(t){if(c.n.isCanceled(t)){e.end({resultType:p.e.ExpectedFailure,resultCode:"Canceled"});return c.n.reject(t)}e.end({resultCode:"PeoplePicker.GetLokiTokenError",resultType:p.e.Failure,extraData:{serverErrorCode:t._serverErrorCode,message:t.message}})})}};return e})(),v=Object(r.s)("LivePeoplePickerHelper",d,{oAuthTokenProvider:a.e,pageContext:o.h}),m=Object(r.s)("PeoplePickerDataSourceWithLivePeoplePickerHelper",i.e,{apiUrlHelper:s.e,pageContext:o.h,dataRequestor:u.e,oAuthTokenProvider:a.e,graphPeoplePickerHelper:f.e,substratePeoplePickerHelper:l.e,livePeoplePickerHelper:v})},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(0),i=n("react-lib"),s=n(1635),o=n(2056),u=n(18),a=n(26),f=n(30),l=n(176),c=n(47),h=n(40),p=Object(l.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(["45","ondemand.resx-ondemand"],4251)];case 1:return[2,e.sent().default]}})})}),d=Object(h.t)(function(e,t){var n=t.itemKey,s=Object(u.o)(function(e){return i.createElement(p,Object(r.__assign)({},e,{itemKey:n}))},{scope:"global"});return i.createElement(f.e,Object(r.__assign)({onExecute:s},Object(c.t)(e,{itemKey:n,engagement:{name:"SocialBar",isIntentional:!0}})))}),v=(Object(a.i)()(d),n(2636)),m=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.likeLabel,n=e.itemKey,r=i.createElement(o.e,{activityDescription:t,isCompact:!0});return i.createElement(u.n,{action:i.createElement(d,{itemKey:n})},function(e){var t=e.isAvailable,n=e.execute,o=t?function(){n().catch(function(){})}:void 0;return i.createElement(s.e,{disabled:!1,className:v.e,onClick:o},r)})};return t})(i.Component)}],Array(49),[function(e,t,n){"use strict";n.r(t);var r=n(0),i=n("react-lib"),s=n(2056),o=n(1975),u=n(1976),a=n(993),f=n(1648),l=n(287),c=n(25),h=n(974),p=n(996),d=n(37),v=(n(2123),n(1765)),m=n(1547),g=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.charsWithinParenthesisRegex=/\(([^)]*)\)/gi;r.excludedCharactersRegex=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/gi;r.multipleSpacesRegex=/\s+/gi;r._onRenderIcon=function(){var e=r.props.activity.getIconName();return i.createElement(a.e,{iconName:e})};r._onRenderActivityDescription=function(){return i.createElement("div",{className:"od-ItemActivity-item-textContent"},r.props.activity.getTitle({isCompact:r.props.isCompact,hideDate:r.props.hideDate}))};r._onRenderActivityTimeStamp=function(e,t){if(r.props.isCompact){var n=Object(o.e)(void 0,void 0),s=Object(u.e)(n,e.className,e.activityPersonas,e.isCompact);return i.createElement("div",{className:Object(d.e)(s.timeStamp,"od-ItemActivity-timeStamp")},e.timeStamp)}return t?t(e):null};r._onRenderHiddenTimeStamp=function(e,t){return null};r._onRenderActivityDescription=r._onRenderActivityDescription.bind(r);r._onRenderIcon=r._onRenderIcon.bind(r);r.state={isFirstLoad:!0};r._focusZoneElement=null;return r}t.prototype.componentDidMount=function(){this.props.isFocusedOnFirstLoad&&this._focusZoneElement&&this.state.isFirstLoad&&this._focusZoneElement.focus()};t.prototype.componentDidUpdate=function(){this.props.isFocusedOnFirstLoad&&this._focusZoneElement&&this.state.isFirstLoad&&this._focusZoneElement.focus()};t.prototype.render=function(){var e=this,t=this.props,n=t.activity,r=t.isCompact,o=t.hideDate,u=t.isInGrid,a=t.isFocusedOnFirstLoad,h=n.getIconName(),p={root:{color:Object(c.O)().palette.neutralDark},activityTypeIcon:{color:Object(c.O)().palette.themePrimary,height:"16px",marginTop:"8px"}},v=n.getResponse(),m=n.getContextualMenu(),g=!!a&&!!this.state.isFirstLoad;return i.createElement(f.e,{className:Object(d.e)("od-ItemActivity-item-focusZone",{"activitycard-deeplink-animate":g}),direction:l.e.horizontal,handleTabKey:l.t.all,"data-is-focusable":!0,role:u?"row":void 0,onBlur:function(){e._onBlur()},allowFocusRoot:!0,ref:function(t){e._focusZoneElement=t}},i.createElement("div",{role:u?"gridcell":void 0,key:"activity_"+n.getKey(),className:Object(d.e)({"od-ItemActivityList-activity-withCommentResponse":!!v},{"od-ItemActivityList-activity-commentWithContent":"comment"===n.getActivityTypeString()&&void 0===h},"od-ItemActivityList-activity"),"aria-label":this._getAriaLabel()},i.createElement(s.e,{key:n.getKey(),className:"od-ItemActivity-item",onRenderActivityDescription:this._onRenderActivityDescription,onRenderIcon:h&&this._onRenderIcon||void 0,activityPersonas:this._getPersonaProperties(),timeStamp:this._onRenderDate(),onRenderTimeStamp:o?this._onRenderHiddenTimeStamp:this._onRenderActivityTimeStamp,isCompact:r,styles:p})),m,v)};t.prototype._onRenderDate=function(){var e=this.props.activity;return(h.e(e.getFriendlyDisplayTime()||"")||p.t(e.getDate())).toString()};t.prototype._getAriaLabel=function(){return this.props.activity.getDescription({stringOnly:!0}).join("")+" "+this._onRenderDate()};t.prototype._onBlur=function(){this.setState({isFirstLoad:!1})};t.prototype._getInitial=function(e){var t="";if(!e)return t;var n=(e=(e=(e=(e=e.replace(this.charsWithinParenthesisRegex,"")).replace(this.excludedCharactersRegex,"")).replace(this.multipleSpacesRegex," ")).trim()).split(" ");if(n.length>=2){t+=n[0].charAt(0).toUpperCase();t+=n[n.length-1].charAt(0).toUpperCase()}else 0!==n.length&&(t+=n[0].charAt(0).toUpperCase());return t};t.prototype._getPersonaProperties=function(){var e=this.props,t=e.activity,n=e.isNewCommentExperienceEnabled,r=t.getPersonaIconUrl();if(!n){return[{imageUrl:r}]}var s=t.getCommentAuthorName(),o=t.getcommentAuthorEmail(),u=s||o,a=this._getInitial(u),f=i.createElement("div",{className:"od-ItemActivity-persona"},a,i.createElement("img",{className:"od-ItemActivity-personaIcon",src:r})),l=t.getenvironment();return[{imageInitials:a,initialsColor:Object(v.e)({text:u}),onRenderInitials:function(){return"consumer"===l?i.createElement(m.e,{content:o},f):f}}]};return t})(i.Component);t.default=g}],Array(48),[function(e,t,n){"use strict";n.r(t);var r=n(0),i=n("react-lib"),s=n("prop-types-lib"),o=n(2188),u=n(138);Object(u.n)([{rawString:".od-ItemActivityFeed-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}.od-ItemActivityFeed{-webkit-touch-callout:text;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text;font-size:14px}\n"}]);var a=n(2437),f=n(133),l=n(2884),c=n(705),h=n(129),p=n(1637),d=n(390),v=n(1648),m=n(287),g=n(2084),y=n(1553);Object(u.n)([{rawString:".od-ItemActivityList-activity-withCommentResponse{display:inline-block;margin-bottom:0;margin-right:-38px}.od-ItemActivityList-activity-commentWithContent .od-ItemActivity-item-textContent{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-ItemActivityList-activity-Shimmer{width:calc(100% - 32px);background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";padding:14px 16px}.od-ItemActivityList-activity-Shimmer .ms-Shimmer-container{width:100%}.od-ItemActivityList-activity{width:calc(100% - 32px)}.od-ItemActivityList-activity .od-ItemActivity-item-textContent{word-wrap:break-word}.od-ItemActivityList-activity .od-ItemActivity-item{max-width:100%}.od-ItemActivity-item .livePersonaCardAdapterRoot{display:inline}.od-ItemActivity-item-focusZone{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;max-width:100%}.od-ItemActivity-item-focusZone:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-ItemActivity-item-focusZone:focus-visible{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-ItemActivity-contextMenu{display:inline-block;vertical-align:top;margin-top:6px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-ItemActivity-contextMenu:hover,.od-ItemActivity-contextMenu:active,.od-ItemActivity-contextMenu.is-expanded{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.isTeamsApp .od-ItemActivity-contextMenu.ms-Button:hover,.od-DetailsPane-SecondaryPane-body .od-ItemActivity-contextMenu.ms-Button:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.isTeamsApp .od-ItemActivity-contextMenu.ms-Button:active,.isTeamsApp .od-ItemActivity-contextMenu.ms-Button.is-expanded,.od-DetailsPane-SecondaryPane-body .od-ItemActivity-contextMenu.ms-Button:active,.od-DetailsPane-SecondaryPane-body .od-ItemActivity-contextMenu.ms-Button.is-expanded{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.od-ItemActivity-item-focusZone .od-ItemActivity-contextMenu-opacity{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";opacity:0}.od-ItemActivity-item-focusZone .od-ItemActivity-contextMenu-opacity.is-expanded{opacity:1}.od-ItemActivity-item-focusZone:hover .od-ItemActivity-contextMenu-opacity,.od-ItemActivity-item-focusZone:focus .od-ItemActivity-contextMenu-opacity{opacity:1}.od-ItemActivity-item-focusZone:focus-within .od-ItemActivity-contextMenu-opacity{opacity:1}.od-itemActivity-commentActivity-commentContent{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";white-space:pre-wrap;word-wrap:break-word}.od-itemActivity-commentActivity-commentContent a,.od-itemActivity-commentActivity-commentContent a:visited,.od-itemActivity-commentActivity-commentContent a:hover,.od-itemActivity-commentActivity-commentContent a:active{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-decoration:none}@media (forced-colors: active){.od-itemActivity-commentActivity-commentContent a.lpc-hoverTarget,.od-itemActivity-commentActivity-commentContent a:visited.lpc-hoverTarget,.od-itemActivity-commentActivity-commentContent a:hover.lpc-hoverTarget,.od-itemActivity-commentActivity-commentContent a:active.lpc-hoverTarget{color:ButtonText}}.od-ItemActivityList-missingActivity{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.od-ItemActivityList-activity-commentResponse{padding:8px;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";margin-bottom:8px}.od-ItemActivityList-commentReply{padding:8px 8px 8px 24px}[dir='rtl'] .od-ItemActivityList-commentReply{padding:8px 24px 8px 8px}.od-ItemActivityList-loadMoreReplies{text-align:center;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-ItemActivityList-grouplistTitle{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:12px;font-weight:600}.od-ItemActivity-menuItems{min-width:108px;padding:0}.od-ItemActivityList-activity-withHiddenReply{padding:0}\n"}]);var b=n(1216),w=n(267),E={display:"flex",flexWrap:"wrap",width:"100%"},S=function(){return i.createElement("div",{style:E},i.createElement(b.e,{shimmerElements:[{type:w.e.circle,height:32,verticalAlign:"top"},{type:w.e.gap,width:14,height:54}]}),i.createElement(b.e,{flexWrap:!0,width:"calc(100% - 46px)",shimmerElements:[{type:w.e.line,width:"50%",height:12,verticalAlign:"top"},{type:w.e.gap,width:"50%",height:18},{type:w.e.line,width:"90%",height:12,verticalAlign:"top"},{type:w.e.gap,width:"10%",height:18},{type:w.e.line,width:"40%",height:10,verticalAlign:"top"},{type:w.e.gap,width:"60%",height:10,verticalAlign:"top"}]}))},x=function(){return i.createElement("div",{style:E},i.createElement(b.e,{shimmerElements:[{type:w.e.line,height:32,width:32},{type:w.e.gap,width:12,height:44}]}),i.createElement(b.e,{flexWrap:!0,width:"calc(100% - 44px)",shimmerElements:[{type:w.e.line,width:"90%",height:12},{type:w.e.gap,width:"10%",height:22},{type:w.e.line,width:"40%",height:10},{type:w.e.gap,width:"60%",height:10}]}))},T=n(881),N=n(1486),C=new(n(220).e),k=(function(e){Object(r.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onScrollEvent=function(e){var n=t.props,r=n.onGetMoreActivities,i=n.activityIndex;C.setTimeout(function(){t._isCurrentElementInView()&&r(i,!0)},100)};return t}t.prototype.componentDidMount=function(){var e=this.props,t=e.onGetMoreActivities,n=e.activityIndex;this._containingScrollablePane=this._findContainingScrollablePane();this._isCurrentElementInView()&&t(n);this._containingScrollablePane&&this._events.on(this._containingScrollablePane,"scroll",this._onScrollEvent,!0)};t.prototype.componentWillUnmount=function(){this._containingScrollablePane&&this._events.off(this._containingScrollablePane,"scroll",this._onScrollEvent,!0)};t.prototype.render=function(){var e=this;return i.createElement("div",{ref:function(t){return e._missingActivityElement=t}},i.Children.only(this.props.children))};t.prototype._findContainingScrollablePane=function(){return Object(T.i)(this._missingActivityElement)};t.prototype._isCurrentElementInView=function(){if(this._missingActivityElement&&this._containingScrollablePane){var e=this._missingActivityElement.getBoundingClientRect(),t=this._containingScrollablePane.getBoundingClientRect(),n=e.top,r=e.bottom,i=t.top,s=t.bottom;return n<=s&&n>=i||r>=i&&r<=s}return!1};return t})(N.e),L=(function(e){Object(r.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onRenderCell=function(e,n,r){var s=t.props,o=s.onRenderMissingActivity,u=s.enableShimmer,a=s.isDataReady,f=s.isNewCommentExperienceEnabled,c=s.deeplinkCommentThreadId,h=s.onHighlightCommentCard,v=s.commentsOnly;if(n){if(!a&&u)return i.createElement("div",{className:"od-ItemActivityList-activity-Shimmer"},i.createElement(y.e,{customElementsGroup:v?S():x()}));var m=n.getCommentThreadId(),g=m&&m===c;g&&h&&h();return i.createElement(l.default,{key:n.getKey(),activity:n,isInGrid:!0,isNewCommentExperienceEnabled:f,isFocusedOnFirstLoad:g})}if(o)return i.createElement(k,{activityIndex:r,onGetMoreActivities:t._onRequestMissingItemActivity},i.createElement("div",{className:"od-ItemActivityList-activity od-ItemActivityList-missingActivity"},i.createElement(p.e,{size:d.e.large})))};t._onRenderHeader=function(e){var n=e.group,r=t.props.groupHeadingLevel,s=void 0===r?4:r;return i.createElement("div",{role:"heading","aria-level":s,className:"od-ItemActivityList-grouplistTitle"},n.name)};t._onRequestMissingItemActivity=function(e,n){var r=t.props.onRenderMissingActivity;n&&f.e.logData({name:"ItemActivityFeed.scrolled",isIntentional:!0});r&&r(e,n)};return t}t.prototype.render=function(){var e=this.props,t=e.activities,n=e.groups;return i.createElement(v.e,{direction:m.e.vertical,isCircularNavigation:!1,isInnerZoneKeystroke:function(e){return e.which===Object(c.t)(h.e.right)}},i.createElement(g.e,{items:t,onRenderCell:this._onRenderCell,groupProps:{onRenderHeader:this._onRenderHeader},groups:n,onShouldVirtualize:function(){return!1}}))};return t})(i.Component),A=n(2353);Object(u.n)([{rawString:".od-mentionableTextBox-buttons{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse;cursor:text}.od-addNewCommentTextField-sendButton{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";background-color:unset;margin:4px}.od-addNewCommentTextField-spinner{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:4px}.od-addNewCommentTextField-mentionableTextBox-outer{width:auto;height:auto;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";padding:1px;border-width:1px;border-style:solid;border-color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:2px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.od-addNewCommentTextField-mentionableTextBox-outer-disabled{width:auto;height:auto;background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";padding:0px;border-width:1px;border-style:solid;border-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:2px;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-addNewCommentTextField-mentionableTextBox-outer:focus-within{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";padding:0;border-width:2px;border-style:solid;border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:2px}.od-addNewCommentTextField-mentionableTextBox-outer:hover:not(:focus-within){background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";padding:1px;border-width:1px;border-style:solid;border-color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:2px}.od-addNewCommentTextField-mentionableTextBox{width:auto;height:auto;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border:none;outline:none;padding:4px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";overflow-y:auto;overflow-x:hidden;white-space:pre-wrap;cursor:text;position:relative;max-height:144px;-webkit-touch-callout:text;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.od-addNewCommentTextField-mentionableTextBox a,.od-addNewCommentTextField-mentionableTextBox a:visited,.od-addNewCommentTextField-mentionableTextBox a:hover,.od-addNewCommentTextField-mentionableTextBox a:active{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-decoration:none}.od-addNewCommentTextField-mentionableTextBox .no-access-mention{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";border-bottom:1px dashed "},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";text-decoration:none}.od-addNewCommentTextField-mentionableTextBox .no-access-mention::before{color:#a4262c;font-family:'FabricMDL2Icons-17';font-size:16px;font-weight:700;content:'\\f13b';vertical-align:text-top}.od-addNewCommentTextField-mentionableTextBox .no-access-mention:visited,.od-addNewCommentTextField-mentionableTextBox .no-access-mention:hover,.od-addNewCommentTextField-mentionableTextBox .no-access-mention:active{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-ItemActivityFeed .PlaceholderExclamationIcon{display:inline;font-size:1px}.od-addNewCommentTextField-mentionableTextBox:not(:empty){color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-addNewCommentTextField-mentionableTextBox-disabled{width:auto;height:auto;background:none;pointer-events:none;border:none;outline:none;padding:5px}@media (forced-colors: active){.od-addNewCommentTextField-mentionableTextBox-disabled{color:GrayText}}.od-addNewCommentTextField-mentionableTextBox[placeholder]:empty:before{content:attr(placeholder)}.od-addNewCommentTextField-mentionableTextBox-disabled[placeholder]:empty:before{content:attr(placeholder)}.od-TextBox-errorMessage{-webkit-font-smoothing:antialiased;font-size:12px;font-weight:400;color:#a4262c;margin:0px;padding-top:5px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-addNewCommentTextField-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}]);var O=n(2215),M=n(37),_=n(1508),D=n(1547),P=n(97),H=n(2438),B=n(103),j=n(63),F=n(2051),I=n(1670),q=n(1709),R=n(52),U=n(3267),z=n(1864),W=n(2060),X=n(1439),V=(function(){function e(e){this._inputElement=e}Object.defineProperty(e.prototype,"current",{get:function(){return this},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"cursorLocation",{get:function(){return-1},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isValueSelected",{get:function(){return!1},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"selectionStart",{get:function(){return-1},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"selectionEnd",{get:function(){return-1},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"inputElement",{get:function(){return this._inputElement},enumerable:!0,configurable:!0});e.prototype.focus=function(){this._inputElement&&this._inputElement.focus()};e.prototype.clear=function(e){this._inputElement&&e&&(this._inputElement.innerHTML="");this.value=""};e.prototype.setAriaLabels=function(e){var t=this;e.forEach(function(e){void 0===e.label?t._inputElement.removeAttribute("aria-"+e.attr):t._inputElement.setAttribute("aria-"+e.attr,e.label.toString())})};e.prototype.setAriaAttributesOnParent=function(e){var t,n=null===(t=this._inputElement)||void 0===t?void 0:t.parentElement;n&&e.forEach(function(e){void 0===e.label?n.removeAttribute("aria-"+e.attr):n.setAttribute("aria-"+e.attr,e.label.toString())})};return e})(),$=n(249),J={ODC:"LogPeoplePickerMounting"},K=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=!1;n._logPeoplePickerMounting=$.e.isFeatureEnabled(J)?function(){if(!r){f.e.logData({name:"AtMention.PeoplePickerMounted",isIntentional:!0});r=!0}}:void 0;return n}t.prototype.render=function(){var e;!(null===(e=this.input)||void 0===e?void 0:e.current)&&this.props.calloutTarget&&(this.input.current=new V(this.props.calloutTarget));return i.createElement("div",{ref:this.root},this.renderSuggestions(),this.props.children)};t.prototype.componentDidMount=function(){this._updateAriaAttributes()};t.prototype.componentWillUnmount=function(){this._updateAriaAttributes();this.input=void 0};t.prototype.componentDidUpdate=function(e){if(this.props.mentionQuery!==e.mentionQuery){this.input.current.value=this.props.mentionQuery;this.updateValue(this.props.mentionQuery)}this._updateAriaAttributes()};t.prototype.handleKeyDown=function(e){if(this.state.suggestionsVisible){var t=e.keyCode,n=e.shiftKey;switch(t){case h.e.tab:case h.e.enter:if(this.suggestionElement.current&&this.suggestionElement.current.hasSuggestedActionSelected())this.suggestionElement.current.executeSelectedAction();else if(!n&&this.suggestionStore.hasSelectedSuggestion()){this.addItem(this.suggestionStore.currentSuggestion&&this.suggestionStore.currentSuggestion.item);this.updateValue("")}break;case h.e.up:case h.e.down:this.onKeyDown(e)}}};t.prototype.renderSuggestions=function(){return this.state.suggestionsVisible&&this.input&&this.input.current&&i.createElement(X.e,{isBeakVisible:!1,gapSpace:5,target:this.input.current.inputElement,onDismiss:this.dismissSuggestions,calloutWidth:this.props.calloutTarget.clientWidth,directionalHint:P.e.bottomLeftEdge,directionalHintForRTL:P.e.bottomRightEdge,onLayerMounted:this._logPeoplePickerMounting},i.createElement(z.e,Object(r.__assign)({suggestionsListId:this._ariaMap.suggestionList,onRenderSuggestion:this.props.onRenderSuggestionsItem,onSuggestionClick:this.onSuggestionClick,onSuggestionRemove:this.onSuggestionRemove,suggestions:this.suggestionStore.getSuggestions(),componentRef:this.suggestionElement,onGetMoreResults:this.onGetMoreResults,moreSuggestionsAvailable:this.state.moreSuggestionsAvailable,isLoading:this.state.suggestionsLoading,isSearching:this.state.isSearching,isMostRecentlyUsedVisible:this.state.isMostRecentlyUsedVisible,isResultsFooterVisible:this.state.isResultsFooterVisible,refocusSuggestions:this.refocusSuggestions,removeSuggestionAriaLabel:this.props.removeButtonAriaLabel},this.props.pickerSuggestionsProps)))};t.prototype._updateAriaAttributes=function(){var e;if(null===(e=this.input)||void 0===e?void 0:e.current){var t=!!this.state.suggestionsVisible,n=this.props.enableSelectedSuggestionAlert?this._ariaMap.selectedSuggestionAlert:"",r=t?this._ariaMap.suggestionList:"",i=this.getActiveDescendant();this.input.current.setAriaLabels([{attr:"activedescendant",label:t?i:void 0},{attr:"controls",label:r||n?(r+" "+n).trim():void 0}]);this.input.current.setAriaAttributesOnParent([{attr:"owns",label:r||void 0},{attr:"expanded",label:t}])}};return t})(W.e),Q=n(70);Object(u.n)([{rawString:".mentionSuggestions_5ec0ff81{min-width:100%;width:auto !important;border:solid 1px "},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";border-radius:3px;-webkit-box-sizing:border-box;box-sizing:border-box}.mentionSuggestions_5ec0ff81 .ms-Suggestions-title{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}\n"}]);var G,Y,Z=/no-?reply/i,ee=(function(e){Object(r.__extends)(t,e);function t(n){var r=e.call(this,n)||this;r._cache=new B.e("MentionsControl",j.e.sharedMemory);r._relevantSuggestionsKey="RelevantSuggestions";r._ppQueryParamsKey="PeoplePickerQueryParams";r._isNoReplyEmail=function(e){var t;return null===(t=e)||void 0===t?void 0:t.match(Z)};r._getPeoplePickerFilters=function(e){var t,n;return{removeNoReplyEmail:!0,principalType:null===(t=e)||void 0===t?void 0:t.principalType,allowExternalUsers:!(null===(n=e)||void 0===n?void 0:n.filterExternalUsers)}};r._onBeforeInputText=function(e){var t,n=null===(t=r.props.editorElementRef)||void 0===t?void 0:t.current;n===e.target&&(r._previousEditorInnerText=n.innerText)};r._onInputText=function(e){var t,n,i,s=null===(t=r.props.editorElementRef)||void 0===t?void 0:t.current;if(s===e.target){var o=s.innerText;if(o&&r._previousEditorInnerText&&"paste"!==e.type&&((null===(i=null===(n=e)||void 0===n?void 0:n.inputType)||void 0===i?void 0:i.indexOf("deleteContent"))>-1||o.length<r._previousEditorInnerText.length)&&(r._processBackSpace()||r._isBackspaceKSActivated)){e.preventDefault();e.stopPropagation()}r._handleMention();r.props.onUpdateText&&r.props.onUpdateText()}};r._shortenDisplayName=function(e){var n=e.innerText;if(t.BRACKET_REGEX.test(n))n=n.replace(t.BRACKET_REGEX,"");else if(t.LAST_NAME_SECTION_REGEX.test(n))n=n.replace(t.LAST_NAME_SECTION_REGEX,"");else{n="";e.remove?e.remove():e.parentElement.removeChild(e);e=void 0}if(n){e.innerText=n.trim();r._moveCursorToEnd(e)}return e};r._moveCursorToEnd=function(e){var t,n,i,s;if(e){null===(n=null===(t=r.props.editorElementRef)||void 0===t?void 0:t.current)||void 0===n||n.focus();var o=document.createRange();e.insertAdjacentText("afterend",r._isBackspaceKSActivated?" ":" ");o.selectNodeContents(e.nextSibling);o.collapse(!1);var u=document.getSelection();null===(i=u)||void 0===i||i.removeAllRanges();null===(s=u)||void 0===s||s.addRange(o)}};r._isMentionAnchor=function(e){return!(!e||"A"!==e.nodeName||!e.getAttribute("email-id"))};r._convertPasteToPlainText=function(e){var t,n=null===(t=r.props.editorElementRef)||void 0===t?void 0:t.current;if(n){var i="";e.clipboardData||e.originalEvent.clipboardData?i=(e.originalEvent||e).clipboardData.getData("text/plain"):window.clipboardData&&(i=window.clipboardData.getData("Text"));var s=document.getSelection();if(s.rangeCount){s.deleteFromDocument();var o=n.scrollTop,u=document.createTextNode(i);s.getRangeAt(0).insertNode(u);s.collapse(u,i.length);e.preventDefault();var a=document.createElement("span");a.innerText=i;a.setAttribute("style","visibility: hidden;");n.appendChild(a);n.scrollHeight>144&&(n.scrollTop=o+a.offsetHeight);n.removeChild(a);n.normalize();r._onInputText(e)}}};r._fetchRelevantSuggestions=function(){var e;if(r._isRelevantUsersFetched&&(null===(e=r._relevantUsers)||void 0===e?void 0:e.length)&&r._relevantUsers.length>0)return R.n.wrap(r._relevantUsers);var t=r._getValueFromCache(r._relevantSuggestionsKey);if(t){r._relevantUsers=t;return R.n.wrap(r._relevantUsers)}return r._getPeoplePickerQueryParams().then(function(e){return r._dataProvider.search("",e).promise.then(function(t){r._relevantUsers=r._filterPeoplePickerResults(t,r._getPeoplePickerFilters(e));r._updateCache(r._relevantSuggestionsKey,r._relevantUsers);r._isRelevantUsersFetched=!0;r.setState({mentionQuery:""});r._handleMention();return r._relevantUsers}).catch(function(e){r._isRelevantUsersFetched=!1;return r._relevantUsers})})};r._handleSuggestionsDisplay=function(e){r._async.setTimeout(function(){0===e.length&&r.state.mentionQuery.length>0?document.getElementsByClassName("ms-Suggestions-title")[0].innerHTML!==U.t&&(document.getElementsByClassName("ms-Suggestions-title")[0].style.display="none"):document.getElementsByClassName("ms-Suggestions-title")[0].style.display="inherit"},0)};r._updateCache=function(e,t){var n={valueObject:t,timestamp:Date.now()};r._cache.setValue(e,n,j.e.sharedMemory,!0)};r._getValueFromCache=function(e){var t,n=Date.now(),i=r._cache.getValue(e,j.e.sharedMemory,!0,!1);if((null===(t=i)||void 0===t?void 0:t.timestamp)&&n-144e5<i.timestamp&&i.valueObject)return i.valueObject;r._cache.remove(e,j.e.sharedMemory,!0)};r._handleResolveSuggestions=r._handleResolveSuggestions.bind(r);r._handleMention=r._handleMention.bind(r);r._handleFilterChanged=r._handleFilterChanged.bind(r);r._onPersonaSelected=r._onPersonaSelected.bind(r);r._getTextFromItem=r._getTextFromItem.bind(r);r._onGetMoreResults=r._onGetMoreResults.bind(r);r._onRenderSuggestionItem=r._onRenderSuggestionItem.bind(r);r._handleKeydown=r._handleKeydown.bind(r);r._handleKeyUp=r._handleKeyUp.bind(r);r._filterPeoplePickerResults=r._filterPeoplePickerResults.bind(r);r._dataProvider=r.props.peoplePickerProvider;r._newMentionNode=document.createElement("a");r._relevantUsers=[];r._lastPersonListLength=0;r._lastPersonListAtSpaceLength=0;r.state={mentionQuery:""};r._isRelevantUsersFetched=!1;r._isIE11=!!window.MSInputMethodContext&&!!document.documentMode;r._isBackspaceKSActivated=Q.t.isActivated("34EA2080-5D1C-44D6-BF88-9BD3C06F1AB9","9/6/2021","Disable new backspace behavior for @mention text box");return r}t.prototype.render=function(){var e,n=this.props.editorElementRef,r=this.state.mentionQuery===t.RELEVANT_USER_QUERY&&this._relevantUsers.length<1,s={className:"mentionSuggestions_5ec0ff81",loadingText:U.e,suggestionsHeaderText:r?U.t:U.s,noResultsFoundText:U.n,suggestionsAvailableAlertText:U.r,suggestionsContainerAriaLabel:U.i};return i.createElement(K,{onResolveSuggestions:this._handleResolveSuggestions,onRenderSuggestionsItem:this._onRenderSuggestionItem,getTextFromItem:this._getTextFromItem,pickerSuggestionsProps:s,componentRef:this._resolveRef("_picker"),resolveDelay:300,mentionQuery:this.state.mentionQuery,calloutTarget:null===(e=n)||void 0===e?void 0:e.current,onItemSelected:this._onPersonaSelected,onGetMoreResults:this._onGetMoreResults})};t.prototype.shouldComponentUpdate=function(e,t){return this.state.lastInvalidMention!==t.lastInvalidMention||!this._lastResolvedQuery||this._lastResolvedQuery!==t.mentionQuery};t.prototype.componentDidMount=function(){var e,t,n,r,i,s,o=null===(e=this.props.editorElementRef)||void 0===e?void 0:e.current;null===(t=o)||void 0===t||t.addEventListener("keydown",this._handleKeydown);null===(n=o)||void 0===n||n.addEventListener("beforeinput",this._onBeforeInputText);null===(r=o)||void 0===r||r.addEventListener("input",this._onInputText);null===(i=o)||void 0===i||i.addEventListener("keyup",this._handleKeyUp);null===(s=o)||void 0===s||s.addEventListener("paste",this._convertPasteToPlainText)};t.prototype.componentWillUnmount=function(){var e,t,n,r,i,s,o=null===(e=this.props.editorElementRef)||void 0===e?void 0:e.current;null===(t=o)||void 0===t||t.removeEventListener("keydown",this._handleKeydown);null===(n=o)||void 0===n||n.removeEventListener("input",this._onInputText);null===(r=o)||void 0===r||r.removeEventListener("beforeinput",this._onBeforeInputText);null===(i=o)||void 0===i||i.removeEventListener("keyup",this._handleKeyUp);null===(s=o)||void 0===s||s.removeEventListener("paste",this._convertPasteToPlainText)};t.prototype.getMentionData=function(){var e,n="",r="",i=-1,s=-1,o=1,u=this._caretRange;if(u&&"#text"===u.endContainer.nodeName){i=(r=(e=u.endContainer).textContent).substring(0,u.endOffset).lastIndexOf("@");this.props.allowEmailAddresses&&(s=r.substring(0,u.endOffset).lastIndexOf("@",i-1));" "===r[r.length-1]&&(this._lastPersonListAtSpaceLength=this._lastPersonListLength);if(0===i||i>0&&this._isTerminatingCharacter(r[i-1])){""===(n=r.substring(i+1,u.endOffset).trim())&&(n=t.RELEVANT_USER_QUERY);if(-1!==r.substring(i,u.endOffset).indexOf(" ")&&0===this._lastPersonListAtSpaceLength){n="";o=0}}if(""===n&&this.props.allowEmailAddresses&&o&&(0===s||s>0&&this._isTerminatingCharacter(r[s-1])))if(-1!==r.substring(s,u.endOffset).indexOf(" "))n="";else{n=r.substring(s+1,u.endOffset).trim();i=s}n.length>=320&&(n="")}return{currentNode:e,lastAtIndex:i,mentionQuery:n,nodeText:r}};t.prototype._filterPeoplePickerResults=function(e,t){var n=this;return t&&e?e.filter(function(e){var r;if((null===(r=e)||void 0===r?void 0:r.email)&&t.removeNoReplyEmail){if(n._isNoReplyEmail(e.email)&&!n._isNoReplyEmail(n.state.mentionQuery))return!1}return(!t.principalType||!e.principalType||t.principalType===q.e.all||e.principalType===t.principalType)&&!(!t.allowExternalUsers&&e.isExternal)}):e};t.prototype._getPeoplePickerQueryParams=function(){var e=this,t=this._getValueFromCache(this._ppQueryParamsKey);if(t)return R.n.wrap(t);var n=this.props.getPeoplePickerQueryParams;if(n){return R.n.wrap(n()).then(function(t){e._updateCache(e._ppQueryParamsKey,t);return t})}};t.prototype._handleKeyUp=function(e){if(e&&"keyup"===e.type&&"Shift"===e.key){e.preventDefault();e.stopPropagation()}else;};t.prototype._handleKeydown=function(e){var t=this.state.mentionQuery,n=this.props.onPostComment;switch(e.which){case h.e.escape:if(t){e.preventDefault();e.stopPropagation();this.setState({mentionQuery:""})}break;case h.e.del:case h.e.backspace:if(this._selection&&this._processBackSpace()){e.preventDefault();e.stopPropagation()}break;case h.e.tab:case h.e.up:case h.e.down:if(!e.shiftKey&&t.length>0){e.preventDefault();e.stopPropagation();this._picker.handleKeyDown(e)}break;case h.e.enter:if(e.shiftKey||this._lastPersonListLength){if(t.length>0){e.preventDefault();e.stopPropagation();this._picker.handleKeyDown(e)}}else{this.setState({mentionQuery:""});e.preventDefault();e.stopPropagation();n()}break;default:return}};t.prototype._handleMention=function(e){var t=this,n=this.getMentionData(),r=n.currentNode,i=n.mentionQuery;i===this.state.mentionQuery||e&&(e.which===h.e.escape||e.which===h.e.enter)||this.setState({currentNode:r,mentionQuery:i});setTimeout(function(){t._normalizeContent()},0)};t.prototype._transformMentionQuery=function(e){var t,n,r=this._caretRange,i=e.email,s=e.name,o=null===(t=this.props.editorElementRef)||void 0===t?void 0:t.current;if(r&&s&&i&&o){var u=this.props.platform,a=this.getMentionData(),f=a.currentNode,l=a.lastAtIndex;if(a.mentionQuery.length>0&&f&&this._selection){var c=this._newMentionNode.cloneNode(!0);c.setAttribute("email-id",i);c.setAttribute("contenteditable",(!!(null===(n=u)||void 0===n?void 0:n.isMobile)).toString());c.setAttribute("access-type","?");c.appendChild(document.createTextNode("@".concat(s)));var h=document.createTextNode(this._isBackspaceKSActivated?" ":" "),p=document.createRange();p.setStart(f,l);p.setEnd(f,r.endOffset);p.deleteContents();p.insertNode(h);p.insertNode(c);o.focus();this._selection.collapse(h,this._isBackspaceKSActivated?1:2);this.setState({mentionQuery:""});this._normalizeContent();this._verifyUserAccess(i,c)}}};t.prototype._verifyUserAccess=function(e,t){var n=this.props,r=n.onCheckUserAccess,i=n.isShareAndNotifyDialogDisabled;if(r){r(e,function(e,n){if(e||i&&n)t.setAttribute("access-type","1");else{t.setAttribute("access-type","0");i&&t.setAttribute("class","no-access-mention")}})}};t.prototype._handleFilterChanged=function(e,t){return e.filter(function(e){return 0===e.name.indexOf(t)||0===e.email.split("@")[0].indexOf(t)})};t.prototype._onPersonaSelected=function(e){this._transformMentionQuery(e);return e};t.prototype._getTextFromItem=function(e){return e.primaryText};t.prototype._processBackSpace=function(){var e=this._selection.anchorNode,t=this._selection.anchorOffset;if(this._selection.isCollapsed){var n=void 0;n="#text"===e.nodeName?0===t?e.previousSibling:e.parentElement:e.hasChildNodes()&&t>0?e.childNodes[t-1]:e;if(this._isMentionAnchor(n)){(n=this._shortenDisplayName(n))?this.setState({lastInvalidMention:n}):this.setState({lastInvalidMention:void 0,mentionQuery:""});return!0}this.setState({lastInvalidMention:void 0,mentionQuery:""});return!1}};t.prototype._normalizeContent=function(){var e,t=null===(e=this.props.editorElementRef)||void 0===e?void 0:e.current;if(t){if(!this._isIE11){var n=t.querySelectorAll("br[end_break]"),r=!0;if(1===n.length){var i=n[0],s=i.previousSibling;t.lastChild===i&&s&&(r=!1)}if(r){var o=n.length;if(o>0)for(var u=0;u<o;u++)t.removeChild(n[u]);if(t.lastChild){var a=document.createElement("br");a.setAttribute("end_break","true");t.appendChild(a)}}}t.normalize()}};Object.defineProperty(t.prototype,"_selection",{get:function(){var e,t,n,r=document.getSelection(),i=null===(e=this.props.editorElementRef)||void 0===e?void 0:e.current;return r&&r.focusNode&&((null===(t=i)||void 0===t?void 0:t.contains(r.focusNode))||(null===(n=i)||void 0===n?void 0:n.contains(r.focusNode.parentNode)))?r:void 0},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_caretRange",{get:function(){var e=this._selection;if(e&&e.isCollapsed&&e.rangeCount>0){return e.getRangeAt(0)}},enumerable:!0,configurable:!0});t.prototype._isTerminatingCharacter=function(e){return t.TERMINATING_CHAR_REGEX.test(e)};t.prototype._handleResolveSuggestions=function(e){var n,r,i,s=this;if(this._peoplePickerSearchPromise){this._peoplePickerSearchPromise.cancel();this._peoplePickerSearchPromise=void 0}if(!e){this._lastResolvedQuery="";n=[];this._lastPersonListLength=n.length;return R.n.resolve(n)}if(this.state.mentionQuery===t.RELEVANT_USER_QUERY){this._lastResolvedQuery=t.RELEVANT_USER_QUERY;this._lastPersonListAtSpaceLength=0;r={promise:this._fetchRelevantSuggestions().then(function(e){s._relevantUsers=e;n=e;return s._relevantUsers}),cached:null};i=R.n.wrap(r)}else if(e.length<1){this._lastResolvedQuery=this.state.mentionQuery;n=this._handleFilterChanged(this._relevantUsers,e);r={promise:R.n.wrap(n),cached:n};i=R.n.wrap(r)}else i=this._getPeoplePickerQueryParams().then(function(t){return s._dataProvider.search(e.trim(),t)});return i?i.then(function(t){return s._resolvePeoplePickerSearch(t).then(function(t){s._lastResolvedQuery=e;s._handleSuggestionsDisplay(t);s._lastPersonListLength=t.length;return t})}):R.n.resolve(this._handleFilterChanged(this._relevantUsers,e))};t.prototype._onGetMoreResults=function(e,t){var n=this;return e.length<1?[]:this._getPeoplePickerQueryParams().then(function(t){var r=n._dataProvider.search(e.trim(),t);return n._resolvePeoplePickerSearch(r).then(function(t){n._lastResolvedQuery=e;return t})})};t.prototype._resolvePeoplePickerSearch=function(e){var t=this,n=e.cached||[];this._peoplePickerSearchPromise=e.promise;return this._peoplePickerSearchPromise.then(function(e){t._peoplePickerSearchPromise=void 0;return t._getPeoplePickerQueryParams().then(function(r){return e?n.concat(t._filterPeoplePickerResults(e,t._getPeoplePickerFilters(r))):[]})}).catch(function(e){return R.n.reject(e)})};t.prototype._onRenderSuggestionItem=function(e){return i.createElement("div",{className:"ms-PeoplePicker-personaContent"},i.createElement(F.e,{text:e.name||"",secondaryText:e.email||"",tertiaryText:"",presence:I.t.none,size:I.n.size40,className:"ms-PeoplePicker-pickerPersona",imageUrl:e.image}))};t.BRACKET_REGEX=/\s\(([^)]*)\)[^(]*$/g;t.LAST_NAME_SECTION_REGEX=/\s[^\s]*$/g;t.TERMINATING_CHAR_REGEX=/[\s\t\r\n]/;t.RELEVANT_USER_QUERY="@@";return t})(N.e),te=n(993),ne=n(176),re=n(2108),ie=Object(ne.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(["366","ondemand.resx-ondemand"],4249)];case 1:return[2,e.sent().TextBoxTeachingBubble]}})})}),se=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._warningIcon=function(){return i.createElement(i.Fragment,null,i.createElement(te.e,{key:"StatusTriangleExclamationIcon","aria-hidden":!0,"data-is-focusable":!1,iconName:"StatusTriangleExclamation",className:"PlaceholderExclamationIcon"}))};n._removeNoAccessMentionees=function(e,t){var n;if(!(null===(n=t)||void 0===n?void 0:n.length))return e;for(var r=[],i=t.map(function(e){var t;return null===(t=e.user)||void 0===t?void 0:t.email}),s=0;s<e.length;s++){var o=e[s];i.indexOf(o.user.email)<0&&r.push(o)}return r};n._onClearTextField=function(e){n.setState(n._getResetState());n._checkAccessPromises=[];if(n._inputElement.current){n._inputElement.current.innerHTML="";e&&n._inputElement.current.focus()}};n._doesTextContainMentionsWithNoAccess=function(){var e,t,r,i=null===(r=null===(t=null===(e=n._inputElement)||void 0===e?void 0:e.current)||void 0===t?void 0:t.getElementsByClassName("no-access-mention"))||void 0===r?void 0:r.length;return i&&i>0};n._onCommentPost=n._onCommentPost.bind(n);n._startPostComment=n._startPostComment.bind(n);n._updateText=n._updateText.bind(n);n._onCheckUserAccess=n._onCheckUserAccess.bind(n);n._dismissTeachingBubble=n._dismissTeachingBubble.bind(n);n.state=n._getResetState();n._peoplePickerProvider=n.props.peoplePickerProvider;n._allMentionees=[];n._noAccessMentionees=[];n._inputElement=i.createRef();n._isIE11=O.e.isIE11();n._isFirefox=O.e.isFireFox();n._checkAccessPromises=[];n._isBackspaceKSActivated=Q.t.isActivated("34EA2080-5D1C-44D6-BF88-9BD3C06F1AB9","9/6/2021","Disable new backspace behavior for @mention text box");return n}t.getDerivedStateFromProps=function(e,t){return e.disabled?{enableSendButton:!1,sending:!1,errorMessage:"",successMessage:""}:t};t.prototype.render=function(){var e=this.props,t=e.disabled,n=e.isPublicEmailAddressSupported,r=e.platform,s=e.getPeoplePickerQueryParams,o=e.isShareAndNotifyDialogDisabled,u=this.state,a=u.sending,f=u.showTeachingBubble;return i.createElement(i.Fragment,null,i.createElement("div",{className:Object(M.e)({"od-addNewCommentTextField-mentionableTextBox-outer":!t},{"od-addNewCommentTextField-mentionableTextBox-outer-disabled":t}),role:t?void 0:"combobox","aria-haspopup":!t&&"listbox","aria-expanded":!!t&&void 0,"aria-label":H.o},i.createElement("div",{className:Object(M.e)({"od-addNewCommentTextField-mentionableTextBox":!t},{"od-addNewCommentTextField-mentionableTextBox-disabled":t}),contentEditable:!t&&!a&&(!(!this._isIE11&&!this._isFirefox)||"plaintext-only"),placeholder:this.props.placeholderText,ref:this._inputElement,tabIndex:t?void 0:0,role:"textbox","aria-disabled":!!t,"aria-label":H.o}),this._renderButtons(),i.createElement(ee,{allowEmailAddresses:n,editorElementRef:this._inputElement,onUpdateText:this._updateText,onPostComment:this._onCommentPost,peoplePickerProvider:this._peoplePickerProvider,getPeoplePickerQueryParams:s,onCheckUserAccess:this._onCheckUserAccess,platform:r,isShareAndNotifyDialogDisabled:o})),this._renderErrorMessage(),i.createElement("div",{className:"od-addNewCommentTextField-screenReaderOnly","aria-live":"assertive",role:"status","aria-atomic":!0,"aria-label":this.state.successMessage},this.state.successMessage),i.createElement(re.e,null,f&&!!this._inputElement.current&&!t&&i.createElement(ie,{target:this._inputElement.current,onDismiss:this._dismissTeachingBubble})),!!o&&this._warningIcon())};t.prototype._dismissTeachingBubble=function(){this.setState({showTeachingBubble:!1});this._inputElement.current&&this._inputElement.current.focus()};t.prototype._onCheckUserAccess=function(e,t,n){var r=this,i=t;this.props.isShareAndNotifyDialogDisabled&&(i=function(e,n){e&&n||r.setState({errorMessage:H.i});t(e,n)});this._checkAccessPromises.push(R.n.resolve(this.props.onCheckUserAccess(e,i,n)))};t.prototype._renderErrorMessage=function(){return""!==this.state.errorMessage&&i.createElement("span",null,i.createElement("div",{role:"alert"},i.createElement("p",{className:"od-TextBox-errorMessage"},i.createElement("span",null,this.state.errorMessage))))};t.prototype.commentInputValid=function(){return this._textLength()>0&&this._textLength()<=2e3};t.prototype.componentDidMount=function(){this.props.focusOnMount&&!this.props.disabled&&this._inputElement.current&&this._inputElement.current.focus();this.checkAndShowTeachingBubble()};t.prototype.componentDidUpdate=function(e){if(this.props.commentItemId!==e.commentItemId){this._onClearTextField();this.checkAndShowTeachingBubble()}};t.prototype.componentWillUnmount=function(){clearTimeout(this._statusMessageTimer);clearTimeout(this._teachingBubbleTimer)};t.prototype.checkAndShowTeachingBubble=function(){var e,t=this;if((null===(e=this.props.showTeachingBubbleOnTextBox)||void 0===e?void 0:e.isPending)&&!this.props.disabled&&this._inputElement.current){this.props.showTeachingBubbleOnTextBox.isPending=!1;this._teachingBubbleTimer=setTimeout(function(){t.setState({showTeachingBubble:!0})},500)}};t.prototype._renderButtons=function(){return this.state.enableSendButton&&i.createElement("div",{className:"od-mentionableTextBox-buttons"},this._renderSendButton())};t.prototype._renderSendButton=function(){return this.state.sending?i.createElement("div",{className:"od-addNewCommentTextField-spinner"},i.createElement(p.e,{size:d.e.small})):i.createElement(D.e,{content:H.u,styles:{root:{display:"inline-block"}},directionalHint:P.e.bottomAutoEdge},i.createElement(_.e,{className:"od-addNewCommentTextField-sendButton",iconProps:{iconName:"Send"},ariaLabel:H.u,onClick:this._onCommentPost}))};t.prototype._limitConsecutiveNewlines=function(e){return e.replace(/\n{3,}/gm,"\n\n")};t.prototype._cleanupMentionedAttributes=function(){if(this._inputElement.current)for(var e=this._inputElement.current.querySelectorAll("a[email-id]"),t=0;t<e.length;t++){var n=e[t];n.removeAttribute("access-type");n.removeAttribute("contenteditable")}};t.prototype._removeDuplicateIdentities=function(e){for(var t={},n=[],r=0;r<e.length;r++)if(e[r]&&e[r].user&&e[r].user.email&&!t[e[r].user.email]){t[e[r].user.email]=!0;n.push(e[r])}return n};t.prototype._updateMentionedData=function(){if(this._inputElement.current){for(var e=[],t=[],n=this._inputElement.current.querySelectorAll("a[email-id]"),r=0;r<n.length;r++){var i=n[r],s=i.getAttribute("email-id"),o=i.textContent.substr(1),u=i.getAttribute("access-type");e.push({user:{displayName:o,email:s.trim().toLowerCase()}});"0"!==u&&"?"!==u||t.push({user:{displayName:o,email:s.trim().toLowerCase()}})}this._allMentionees=e;this._noAccessMentionees=this._removeDuplicateIdentities(t);this.props.isShareAndNotifyDialogDisabled&&(this._allMentionees=this._removeNoAccessMentionees(e,t))}};t.prototype._sendComment=function(){var e=this,t=this.props,n=t.onSend,i=t.engagementSource,s=t.engagementExtraData,o=t.engagementExecutor;if(n){this.setState({sending:!0,successMessage:"",errorMessage:""});this._cleanupMentionedAttributes();n(this._textContent(),function(){e._onClearTextField(!0);var t=i?i+".":"AddCommentTextField.";(o||f.e).logData({name:t+"Send.Click",isIntentional:!0,extraData:Object(r.__assign)(Object(r.__assign)({},s),{mentionCount:e._allMentionees.length})});e._allMentionees=[];e._noAccessMentionees=[];clearTimeout(e._statusMessageTimer);e.setState({successMessage:H.e},function(){clearTimeout(e._statusMessageTimer);e._statusMessageTimer=setTimeout(function(){e.setState({successMessage:""})},15e3)})},function(t){e.setState({sending:!1,errorMessage:t})},this._allMentionees)}};t.prototype._onCommentPost=function(){if(this.state.enableSendButton&&!this.state.sending&&this.commentInputValid()){this.setState({sending:!0,errorMessage:"",successMessage:""});R.n.all(this._checkAccessPromises).then(this._startPostComment,this._startPostComment)}};t.prototype._startPostComment=function(){var e=this,t=this.props,n=t.onGrantAccess,i=t.engagementSource,s=t.engagementExtraData,o=t.isShareAndNotifyDialogDisabled,u=void 0!==o&&o,a=t.engagementExecutor;this.setState({sending:!1});this._updateMentionedData();if(!u&&n&&this._noAccessMentionees&&this._noAccessMentionees.length>0){var l=function(t){e.setState({sending:!1,errorMessage:t||H.n})};n(this._noAccessMentionees,function(t){if("share_grantAccessCompleted"===t){e._sendComment();var n=i?i+".":"AtMention.ShareDialog.";(a||f.e).logData({name:n+"Share.Click",isIntentional:!0,extraData:Object(r.__assign)(Object(r.__assign)({},s),{shareCount:e._noAccessMentionees.length})})}else"share_dismiss"!==t&&l(H.n)},l)}else this._sendComment()};t.prototype._removeAllTags=function(e){return e.replace(/<(?:.|\n)*?>/gm,"")};t.prototype._replaceDivsWithNewLines=function(e){return e.replace(/<div>/gi,"\n").replace(/<\/div>/gi,"")};t.prototype._textLength=function(){if(!this._inputElement.current)return 0;if(this._textLengthCache&&this._lastHTML===this._inputElement.current.innerHTML)return this._textLengthCache;this._lastHTML=this._inputElement.current.innerHTML;return this._textLengthCache=this._textContent().length};t.prototype._textContent=function(){var e=this._inputElement.current?this._inputElement.current.innerHTML:"";e=this._replaceDivsWithNewLines(e);e=this._limitConsecutiveNewlines(e);e=this._trimSurroundingWhitespace(e);this._isBackspaceKSActivated||(e=this._removeTerminatingWJ(e));e=this._replaceMentionsWithPlaceholders(e);e=this._removeAllTags(e);return e=O.e.htmlDecodeFromString(e)};t.prototype._removeTerminatingWJ=function(e){return e.replace(/(<\s*\/\s*a\s*>)\u2060/gi,"$1")};t.prototype._replaceMentionsWithPlaceholders=function(e){var t=0;if(this.props.isShareAndNotifyDialogDisabled){e=e.replace(/<\s*a\s*email-id[^<>]*access-type\s*=\s*[\\"]+0[\\"]+[^<>]*>([^<]*)<\s*\/\s*a\s*>/g,"$1")}return e.replace(/<\s*a\s*email-id\s*=\s*"[^"]+"\s*>[^<]*<\s*\/\s*a\s*>/gi,function(){return"@mention{"+t+++"}"})};t.prototype._trimSurroundingWhitespace=function(e){return e.replace(/^\s+|\s+$/g,"")};t.prototype._updateText=function(){var e=this._textLength()>2e3?H.t:"";this.props.isShareAndNotifyDialogDisabled&&this._doesTextContainMentionsWithNoAccess()&&(e=H.i);this.setState({enableSendButton:this.commentInputValid(),errorMessage:e})};t.prototype._getResetState=function(){return{enableSendButton:!1,sending:!1,errorMessage:"",showTeachingBubble:!1}};return t})(i.Component),oe=n(2477),ue=n(425),ae=n(2378);(function(e){e.today="Today";e.yesterday="Yesterday";e.thisWeek="This week";e.lastWeek="Last week";e.twoWeeksAgo="Two weeks ago";e.threeWeeksAgo="Three weeks ago";e.thisMonth="This month";e.lastMonth="Last month";e.older="Older"})(Y||(Y={}));var fe=((G={})[Y.today]=ae.y,G[Y.yesterday]=ae.E,G[Y.thisWeek]=ae.m,G[Y.lastWeek]=ae.c,G[Y.twoWeeksAgo]=ae.b,G[Y.threeWeeksAgo]=ae.g,G[Y.thisMonth]=ae.v,G[Y.lastMonth]=ae.l,G);function le(e){var t=e.time,n=new Date;return t?(function(e,t){return ce(t,e)})(t,n)?Y.today:(function(e,t){return ce(new Date(t.getTime()-864e5),e)})(t,n)?Y.yesterday:(function(e,t){var n=t.setHours(0,0,0,0)-864e5*t.getDay();return e.getTime()>n})(t,n)?Y.thisWeek:(function(e,t){var n=t.setHours(0,0,0,0)-864e5*(t.getDay()+7);return e.getTime()>n})(t,n)?Y.lastWeek:(function(e,t){var n=t.setHours(0,0,0,0)-12096e5;return e.getTime()>n})(t,n)?Y.twoWeeksAgo:(function(e,t){var n=t.setHours(0,0,0,0)-18144e5;return e.getTime()>n})(t,n)?Y.threeWeeksAgo:(function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()})(t,n)?Y.thisMonth:(function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()-e.getMonth()==1})(t,n)?Y.lastMonth:(function(e,t){return t.getFullYear()===e.getFullYear()})(t,n)?t.toLocaleString(ue.e.language,{month:"long"}):(function(e,t){return t.getFullYear()>e.getFullYear()})(t,n)?t.toLocaleString(ue.e.language,{month:"long",year:"numeric"}):Y.older:Y.older}function ce(e,t){return e.toDateString()===t.toDateString()}var he=n(1921);Object(u.n)([{rawString:'.od-ItemActivity-SeeMoreText{font-family:"Segoe UI",-apple-system,BlinkMacSystemFont,"Roboto","Helvetica Neue",sans-serif;font-style:normal;font-size:12px;color:'},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";background:none;padding:0px 2px 2px 2px;border:transparent;cursor:pointer;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;min-width:-webkit-min-content;min-width:-moz-min-content;min-width:min-content}.od-ItemActivity-SeeMoreText:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:";text-decoration:underline;background:none}.od-ItemActivity-SeeMoreText .ms-Button-label{margin-left:0px;margin-right:0px;font-weight:400}\n"}]);var pe=n(1503),de=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.state={charLimit:t.charLimit?t.charLimit:140,expanded:!1};return n}t.prototype.render=function(){return i.createElement("div",null,this.getSeeMoreContent())};t.prototype.getSeeMoreContent=function(){var e,t=this.state,n=t.charLimit,r=t.expanded,s=this.props,o=s.text,u=s.seeMoreText,a=s.seeLessText;e=o.length<=n?o:r?o+" ":o.substr(0,n)+"... ";return i.createElement("span",null,e,o.length>n&&i.createElement(pe.e,{className:"od-ItemActivity-SeeMoreText",onClick:this.toggleExpanded.bind(this),"aria-expanded":r},r?a:u))};t.prototype.toggleExpanded=function(){var e=this.state.expanded;this.setState({expanded:!e})};return t})(i.PureComponent),ve=n(22),me=function(e){var t=e.user,n=e.onRenderUser,r=e.environment,s=t.email,o={user:t,isAccusative:!1};return"sharePointList"===r&&n?i.createElement(i.Fragment,null,n(o,ge)):i.createElement(D.e,{content:s,styles:{root:{display:"inline-block",overflowWrap:"anywhere"}}},ge(o))},ge=function(e){var t=e.user,n=t.email,r="@"+(t.displayName||n||ae.w);return i.createElement("a",{"aria-label":ve.format(ae.h,r,n)},r)};var ye,be,we,Ee=function(e){var t,n=i.useState(!1),s=n[0],o=n[1],u=e.text,a=e.mentioned,f=e.seeLessText,l=e.seeMoreText,c=e.charLimit,h=void 0===c?140:c,p=i.useMemo(function(){return(function(e){for(var t,n=e.text,r=e.onRenderUser,s=e.environment,o=e.mentioned,u=void 0===o?[]:o,a=/@mention\{(\d+)\}/g,f=0,l=[];t=a.exec(n);){var c=u[parseInt(t[1])];t.index>f&&l.push(n.substring(f,t.index));f=a.lastIndex;if(c){var h=i.createElement(me,{key:l.length,user:c,onRenderUser:r,environment:s});l.push(h)}else l.push(t[0])}f!==n.length&&l.push(n.substring(f,n.length));return l})(e)},[u,a]),d=0;if(s)t=Object(r.__spreadArrays)(p);else{t=[];for(var v=0,m=p;v<m.length;v++){var g=m[v];if("string"==typeof g)(d+=g.length)>h?t.push(g.substr(0,h-d+g.length)):t.push(g);else{t.push(g);d+=12}if(d>h)break}}s?t.push(" "):d>h&&t.push("...");return i.createElement("span",null,t,(s||d>h)&&i.createElement(pe.e,{className:"od-ItemActivity-SeeMoreText",onClick:function(){o(!s)},"aria-expanded":s},s?f:l))},Se=n(364),xe=n(87),Te={ODC:"EnableMentionsDisplay"},Ne={ODB:1061,ODC:"EnableItemFeedAtMention"},Ce={isPlaceholder:!1,activities:[],success:!0},ke=!Q.t.isActivated("4A9B46AD-36D9-475A-BEFA-E567AFBE2176","03/05/2021","Disable the mentions in comment card."),Le=(function(e){Object(r.__extends)(t,e);function t(t,n){var s=e.call(this,t,n)||this;s._onRenderMissingActivity=function(e,t){var n=s.state,r=n.isEndOfActivities,i=n.showComments,o=n.deeplinkCommentThreadId,u=s.props,a=u.commentsOnly,f=u.containingItem,l=u.currentUserEmail,c=u.environment,h=u.activityApiHeaders,p=u.commentListItem;if(!r&&!a){var d="sharePointList"===c?"ItemActivityFeed-spList":"ItemActivityFeed";s._store.fetchItemActivities({item:f,startIndex:e,currentUserEmail:l,qosPrefix:d,environment:c,isScrollEvent:t,activityApiHeaders:h})}i&&s._itemCommentsStore.fetchItemComments({itemWrapper:p,currentUserEmail:l,qosPrefix:"sharePointList"===c?"SPList":void 0});s.setState({deeplinkCommentThreadId:t?void 0:o})};s._onFetchCommentsError=function(e){var t=s.props.onFetchCommentsError;t&&t(e);s.setState({showAllCommentActivities:!0,itemCommentsQueried:!0})};s._displayLargeText=function(e){return s._displayMentionEnabled?i.createElement(Ee,Object(r.__assign)({},e)):i.createElement(de,Object(r.__assign)({},e))};var o="sharePointList"===t.environment;s._displayMentionEnabled="consumer"===t.environment&&$.e.isFeatureEnabled(Te)||o&&ke;s._store=n.itemActivityFeedStore;s._itemCommentsStore=n.itemCommentsStore;s._engagementSource=n.engagementSource||"ActivityFeed";var u=!!t.commentListItem,a=!!t.commentsOnly?Ce:s._store.getItemActivities({item:s.props.containingItem,currentUserEmail:t.currentUserEmail}),f=u&&s._itemCommentsStore.getItemComments({itemWrapper:t.commentListItem,currentUserEmail:t.currentUserEmail,startIndex:0,qosPrefix:o?"SPList":void 0,onError:s._onFetchCommentsError,isReplyDisabled:o})||void 0;s.state={activities:a,itemComments:f,isEndOfActivities:!1,itemCommentsQueried:f&&!f.isPlaceHolder,showAllCommentActivities:!u,showComments:u,feedUpdatedMessage:"",isSPCustomListFeed:o,deeplinkCommentThreadId:t.deeplinkCommentThreadId};return s}t.prototype.UNSAFE_componentWillReceiveProps=function(e){if(e.containingItem.graphItemUrl!==this.props.containingItem.graphItemUrl||e.currentUserEmail!==this.props.currentUserEmail){var t="sharePointList"===e.environment,n=!!e.commentListItem,r=!!e.commentsOnly?Ce:this._store.getItemActivities({item:this.props.containingItem,currentUserEmail:e.currentUserEmail}),i=n&&this._itemCommentsStore.getItemComments({itemWrapper:e.commentListItem,currentUserEmail:e.currentUserEmail,startIndex:0,qosPrefix:t?"SPList":void 0,onError:this._onFetchCommentsError,isReplyDisabled:t})||void 0;this.setState({activities:r,showComments:n,itemComments:i,showAllCommentActivities:!n,itemCommentsQueried:i&&!i.isPlaceHolder,isEndOfActivities:!1,feedUpdatedMessage:"",isSPCustomListFeed:t});clearTimeout(this._feedUpdatedMessageTimer);this._removeCurrentListeners();this._addListeners(e)}this.props.isAtMentionEnabled?e.containingItem.graphItemUrl!==this.props.containingItem.graphItemUrl&&this._refreshActivityFeed(e):e.containingItem!==this.props.containingItem&&this._refreshActivityFeed(e);if(e.commentsOnly!==this.props.commentsOnly){this.props.isAtMentionEnabled&&this._refreshActivityFeed(e);this.setState({isEndOfActivities:!1})}};t.prototype.componentDidMount=function(){this._addListeners(this.props)};t.prototype.componentWillUnmount=function(){this._removeCurrentListeners();clearTimeout(this._feedUpdatedMessageTimer)};t.prototype.render=function(){var e=this.state,t=e.activities,n=e.itemComments,r=e.showComments,s=e.itemCommentsQueried,o=e.deeplinkCommentThreadId,u=this.props,a=u.isReadonly,f=u.commentsOnly,l=u.isNewCommentExperienceEnabled,c=u.onHighlightCommentCard,h=u.groupHeadingLevel,p=this._getViewableItemActivitiesAndGroups(t,n),d=p.activities,v=p.dateGroups;if((!f&&(t.isPlaceholder||t.nextRequestToken)||n&&n.nextLink)&&(!f||!this._noCommentActivities())){var m=v.length;d.push(void 0);0===m?v.push({key:"",name:"",startIndex:0,count:1}):m>0&&(v[v.length-1].count+=1)}var g=this._renderNoActivitiesNote(d),y=this._renderError(),b=d.slice(0,d.length);return i.createElement("div",{className:"od-ItemActivityFeed"},i.createElement("div",{"aria-live":"assertive",role:"status","aria-atomic":"true",className:"od-ItemActivityFeed-screenReaderOnly"},this.state.feedUpdatedMessage),this._renderAddCommentField(),i.createElement("div",{"aria-label":ae.e},g,i.createElement(L,{activities:b,groups:v,onRenderMissingActivity:this._onRenderMissingActivity,enableShimmer:!0,isDataReady:!r||!!s,commentsOnly:f,groupHeadingLevel:h,isReadonly:a,isNewCommentExperienceEnabled:l,deeplinkCommentThreadId:o,onHighlightCommentCard:c}),y))};t.prototype._renderError=function(){var e=this.state,t=e.activities,n=e.itemComments,r=!!this.props.commentsOnly;if(r||t.success){if(r&&n&&n.missingComments){s=n.comments.length>0?ae.a:ae.o;return i.createElement("div",{className:"od-ItemActivityFeed-error"},s)}return null}var s=t.activities.length>0?ae.f:ae.u;return i.createElement("div",{className:"od-ItemActivityFeed-error"},s)};t.prototype._renderNoActivitiesNote=function(e){var t=this.state,n=t.activities,r=t.showComments,s=t.itemComments,o=t.isEndOfActivities,u=this.props,a=u.commentsOnly,f=u.NoCommentsView;return!n.success||n.isPlaceholder||0!==n.activities.length&&e&&0!==e.length||n.nextRequestToken||!o||r&&!this._noCommentActivities()||a?a&&this._noCommentActivities()&&s&&!s.missingComments?f&&i.createElement(f,null)||i.createElement("div",{className:"od-ItemActivityFeed-noActivities"},ae.d):null:i.createElement("div",{className:"od-ItemActivityFeed-noActivities"},ae.p)};t.prototype._noCommentActivities=function(){var e=this.state,t=e.itemComments;return e.showComments&&(!t||t&&t.comments&&t.comments.length<1)};t.prototype._renderAddCommentField=function(){var e=this,t=this.props,n=t.commentListItem,r=t.isReadonly,s=t.environment,o=t.onGrantAccess,u=t.onCheckUserAccess,a=t.commentTextBoxPlaceholder,f=t.isPublicEmailAddressMentionSupported,l=t.focusCommentInputOnMount,c=t.refreshCurrentItemCallback,h=t.isWXPCommentingDisabled,p=t.platform,d=t.getPeoplePickerQueryParams,v=t.isAtMentionEnabled,m=t.isShareAndNotifyDialogDisabled,g=void 0!==m&&m,y=t.engagementExecutor,b="consumer"===s,w="sharePointList"===s,E=w?"SPList":void 0;if((!r||b||w)&&n&&!h){var S=function(t,r,i,s){e._itemCommentsStore.addComment(n,t,s,E).then(function(t){e._refreshActivityFeed(e.props);r&&r();c&&c()},function(e){var t=e&&e.message&&e.message.value;i&&i(t)})},x=n&&n.item,T=x.isRootFolder?"driveRoot":x.folder?"folder":x.extension||"file",N=void 0!==x.sharingType?Se.e[x.sharingType]:void 0;return v?i.createElement(se,{commentItemId:n.item&&n.item.id,isPublicEmailAddressSupported:f,placeholderText:a,peoplePickerProvider:this.context.peoplePickerProvider,getPeoplePickerQueryParams:d,onSend:S,onGrantAccess:o,onCheckUserAccess:u,disabled:r,focusOnMount:l,engagementSource:this._engagementSource+".AddComment",engagementExtraData:{itemType:T,sharingType:N,environment:s},platform:p||new xe.e,showTeachingBubbleOnTextBox:this.props.showTeachingBubbleOnTextBox,isShareAndNotifyDialogDisabled:g,engagementExecutor:y}):i.createElement(A.e,{commentItemId:n.item&&n.item.id,placeholderText:r?a:ae.t,sendButtonTitle:"",onSend:S,engagementSource:this._engagementSource+".AddComment",engagementExtraData:{itemType:T,sharingType:N,environment:s},disabled:r,focusOnMount:l,enableNewCommentingExperience:b||w,platform:p||new xe.e,isMentionsEnabled:$.e.isFeatureEnabled(Ne),engagementExecutor:y})}};t.prototype._refreshActivityFeed=function(e){var t="sharePointList"===e.environment?"ItemActivityFeed-spList":"ItemActivityFeed";e.commentsOnly||this._store.fetchItemActivities({item:e.containingItem,startIndex:0,currentUserEmail:e.currentUserEmail,qosPrefix:t,environment:e.environment,activityApiHeaders:e.activityApiHeaders});var n=!!e.commentListItem;n&&this._itemCommentsStore.fetchItemComments({itemWrapper:e.commentListItem,startIndex:0,currentUserEmail:e.currentUserEmail,qosPrefix:"sharePointList"===e.environment?"SPList":void 0});this.setState({itemCommentsQueried:!1,showComments:n,isEndOfActivities:!1,deeplinkCommentThreadId:void 0});this._removeCurrentListeners();this._addListeners(e)};t.prototype._getViewableItemActivitiesAndGroups=function(e,t){var n,r=this.props.commentsOnly,i=[],s=[],o=function(){if(0===s.length)return 0;var e=s[s.length-1];return e.startIndex+e.count};if(e)for(var u=this.canAppendCommentsAfterOldestActivity(!!r,e,t),a=0,f=this._prepareActivitiesList(e.activities,t,u);a<f.length;a++){var l=f[a];if(l){var c=void 0;(!r||l instanceof oe.t||2===l.type)&&(c=this._getViewableItemActivity(l));if(c){i.push(c);var h=le(l),p=fe[h]||h;if(p!==n){s.push({key:"activityDateGroup-"+s.length,name:p,count:1,startIndex:o()});n=p}else s[s.length-1].count+=1}}}return{activities:i,dateGroups:s}};t.prototype.canAppendCommentsAfterOldestActivity=function(e,t,n){return!!((e||t&&t.success&&!t.isPlaceholder&&!t.nextRequestToken)&&n&&n.comments)};t.prototype._prepareActivitiesList=function(e,t,n){var r,i=this.props,s=i.commentsOnly,o=i.commentListItem,u=i.isAtMentionEnabled;if(s)return(null===(r=t)||void 0===r?void 0:r.comments)||[];if(!(t&&t.comments&&t.comments.length>0)){if(!o&&u){var a=new Set(e.filter(function(e){return 4===e.type&&!!e.action.mention.commentId}).map(function(e){return e.item.graphItemUrl+"_"+e.action.mention.commentId}));return e.filter(function(e){return 2!==e.type||!e.action.comment.commentId||!a.has(e.item.graphItemUrl+"_"+e.action.comment.commentId)})}return e}var f=e.length>0?e[e.length-1].time:new Date,l=t.comments,c=new Set;return e.concat(l).filter(function(e){if(e.time<f&&!n)return!1;if(e instanceof oe.t||2===e.type){if(c.has(e.action.comment.commentId))return!1;c.add(e.action.comment.commentId);return!0}return!0}).sort(function(e,t){return e.time>t.time?-1:e.time<t.time?1:0})};t.prototype._getViewableItemActivity=function(e){var t=this.props,n=t.currentUserEmail,i=t.containingItem,s=t.canOpenItem,o=t.onItemClick,u=t.isSingleLevel,a=t.onRenderUser,f=t.populateItemNameToDisplay,l=t.currentListTitle,c=t.currentRootTitle,h=t.defaultItemTitle,p=t.commentListItem,d=t.commentsOnly,v=t.isReadonly,m=t.canDeleteActivity,g=t.activityMenuFunctions,y=t.isNewCommentExperienceEnabled,b=t.isAtMentionEnabled,w=t.environment,E=t.getpersonaIconUrl,S=this.state,x=S.showComments,T=S.itemComments,N=S.isSPCustomListFeed,C={currentUserEmail:n,containingItem:i,canOpenItem:s,onItemClick:o,isSingleLevel:u,activity:e,strings:he,onRenderUser:a,populateItemNameToDisplay:f,currentListTitle:l,currentRootTitle:c,defaultItemTitle:h,commentListItem:p,isReadonly:v,canDeleteActivity:m,activityMenuFunctions:g&&g[e.type],isNewCommentExperienceEnabled:y,isAtMentionEnabled:b,environment:w,getpersonaIconUrl:E,displayLargeText:this._displayLargeText,isListItem:N};if(!d||2===e.type)switch(e.type){case 0:return new oe.s(C);case 1:return"sharePointList"!==w&&new oe.u(C);case 2:var k=void 0;if(x&&T){var L=this._getPopulatedCommentActivity(e);if(L&&L.isDeleted)return;k=Object(r.__assign)(Object(r.__assign)({},C),{activity:L})}return new oe.t(k||C);case 3:return new oe.n(C);case 4:if(p)return;return new oe.o(C);case 5:return new oe.h(C);case 6:return new oe.l(C);case 9:return new oe.f(C);case 10:return"sharePointList"!==w&&new oe.i(C);case 11:return new oe.r(C);case 12:return new oe.c(C);case 14:return new oe.e(C);case 15:return new oe.a(C);default:return}};t.prototype._addStoreListener=function(e){var t=this;this._storeListener=this._store.addListener(function(){var n=t._store.getItemActivities({item:e.containingItem,currentUserEmail:e.currentUserEmail});t.setState({activities:n,isEndOfActivities:n.success&&!n.isPlaceholder&&!n.nextRequestToken})},{item:e.containingItem,currentUserEmail:e.currentUserEmail,environment:e.environment,activityApiHeaders:e.activityApiHeaders})};t.prototype._addCommentsStoreListener=function(e){var t=this,n=e.currentUserEmail,r=e.commentsOnly,i=e.commentListItem;this._commentsStoreListener=this._itemCommentsStore.addListener(function(n){var i=t._itemCommentsStore.getItemComments({itemWrapper:e.commentListItem,currentUserEmail:e.currentUserEmail,qosPrefix:t.state.isSPCustomListFeed?"SPList":void 0,onError:t._onFetchCommentsError,isReplyDisabled:t.state.isSPCustomListFeed});t.setState({itemComments:i,itemCommentsQueried:!!i.comments,showAllCommentActivities:!i.isPlaceHolder&&i.missingComments,isEndOfActivities:r&&i.success&&!i.isPlaceHolder&&!i.nextLink});n&&t._announceCommentUpdate(n)},{commentItemWrapper:i,currentUserEmail:n})};t.prototype._addCommentSettingsListener=function(e){var t=this,n=e.onCommentSettingsChanged,r=e.currentUserEmail,i=e.commentListItem;this._commentSettingsListener=this._itemCommentsStore.addCommentSettingsListener(function(){var e=t._itemCommentsStore.getIsCommentsDisabled(i,r);if("boolean"==typeof e&&n){n(e);t._announceCommentUpdate(e?a.e.CommentsDisabled:a.e.CommentsEnabled)}},{commentItemWrapper:i,currentUserEmail:r})};t.prototype._addListeners=function(e){this._addStoreListener(e);if(e.commentListItem){this._addCommentsStoreListener(e);this._addCommentSettingsListener(e)}};t.prototype._removeCurrentListeners=function(){this._storeListener&&this._store.removeListener(this._storeListener);if(this._commentsStoreListener){this._itemCommentsStore.removeListener(this._commentsStoreListener);this._commentsStoreListener=void 0}if(this._commentSettingsListener){this._itemCommentsStore.removeCommentSettingsListener(this._commentSettingsListener);this._commentSettingsListener=void 0}};t.prototype._getPopulatedCommentActivity=function(e){var t=e.action&&e.action.comment;if(t&&t.commentId){var n=this._getCommentById(t.commentId);if(n){return Object(r.__assign)(Object(r.__assign)({},n),{time:e.time,friendlyDisplayTime:e.friendlyDisplayTime})}if(this.state.itemCommentsQueried&&!this.state.showAllCommentActivities)return Object(r.__assign)(Object(r.__assign)({},e),{isDeleted:!0})}return e};t.prototype._getCommentById=function(e){var t=this.state.itemComments,n=t&&t.comments;if(n)for(var r=0,i=n;r<i.length;r++){var s=i[r],o=s.action&&s.action.comment&&s.action.comment.commentDetail;if(o&&o.id===e)return s}};t.prototype._announceCommentUpdate=function(e){var t=this,n="";e===a.e.DeletedAll?n=ae.i:e===a.e.DeletedSingle?n=ae.s:e===a.e.CommentsEnabled?n=ae.r:e===a.e.CommentsDisabled&&(n=ae.n);clearTimeout(this._feedUpdatedMessageTimer);this.setState({feedUpdatedMessage:n},function(){clearTimeout(t._feedUpdatedMessageTimer);t._feedUpdatedMessageTimer=window.setTimeout(function(){t.setState({feedUpdatedMessage:""})},15e3)})};t.contextTypes={itemActivityFeedStore:s.object.isRequired,itemCommentsStore:s.object.isRequired,peoplePickerProvider:s.object,engagementSource:s.string};return t})(i.Component),Ae=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.state={isActivityClicked:!n.props.isCommentsOnlyView,isCommentClicked:n.props.isCommentsOnlyView};return n}t.prototype.render=function(){var e=this.props,t=e.item,n=e.extraClassName;return i.createElement(i.Fragment,null,this._isMenuVisible()?i.createElement(pe.e,{className:Object(M.e)("od-ItemActivityFeed-viewOption",n),text:this._getCurrentViewOption(),menuProps:this._getViewMenuProps(t),ariaLabel:ve.format(o.h,this._getCurrentViewOption())}):void 0)};t.prototype._isCommentsAvailable=function(e){return this.props.itemActivityFeedHelper.isActivityContextMenuAvailable(e)};t.prototype._getViewMenuProps=function(e){return{directionalHint:P.e.bottomLeftEdge,isBeakVisible:!1,gapSpace:0,shouldFocusOnMount:!0,items:this._getMenuItems(),styles:{root:"od-ItemActivityFeed-menuItems"},calloutProps:{className:"od-smallWidth"}}};t.prototype._getMenuItems=function(){var e=this,t=this.props.onSelectMenuOption;return[{key:"activityFeed.viewAll",name:o.l,ariaLabel:o.l,checked:!!this.state.isActivityClicked,onClick:function(n,r){if(t){t(!1);e.setState({isActivityClicked:!0,isCommentClicked:!1})}},iconProps:{iconName:this.state.isActivityClicked?"CheckMark":void 0}},{key:"activityFeed.commentOnly",name:o.a,ariaLabel:o.a,checked:!!this.state.isCommentClicked,onClick:function(n,r){if(t){t(!0);e.setState({isActivityClicked:!1,isCommentClicked:!0})}},iconProps:{iconName:this.state.isCommentClicked?"CheckMark":void 0}}]};t.prototype._isMenuVisible=function(){var e=this.props.item;return this._isCommentsAvailable(e)};t.prototype._getCurrentViewOption=function(){return this.props.isCommentsOnlyView?o.a:o.l};return t})(i.Component),Oe=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props.item;return i.createElement(i.Fragment,null,this._isMenuVisible()?i.createElement(pe.e,{className:"od-ItemActivityFeed-viewOption-old",text:ve.format(o.c,this._getCurrentViewOption()),menuProps:this._getViewMenuProps(e),ariaLabel:ve.format(o.h,this._getCurrentViewOption())}):void 0)};t.prototype._isCommentsAvailable=function(e){return this.props.itemActivityFeedHelper.isActivityContextMenuAvailable(e)};t.prototype._getViewMenuProps=function(e){return{directionalHint:P.e.bottomAutoEdge,isBeakVisible:!1,gapSpace:0,shouldFocusOnMount:!0,items:this._getMenuItems(),styles:{root:"od-ItemActivityFeed-menuItems"}}};t.prototype._getMenuItems=function(){var e=this.props.onSelectMenuOption;return[{key:"activityFeed.viewAll",name:o.l,onClick:function(t,n){e&&e(!1)}},{key:"activityFeed.commentOnly",name:o.a,onClick:function(t,n){e&&e(!0)}}]};t.prototype._isMenuVisible=function(){var e=this.props.item;return this._isCommentsAvailable(e)&&!this.props.isCommentDisabledInItemSetting};t.prototype._getCurrentViewOption=function(){return this.props.isCommentsOnlyView?o.a:o.l};return t})(i.Component),Me=n(1712),_e=n(76),De=n(11),Pe=n(999),He=n(141),Be={sharePoint:(ye={},ye[0]=30,ye[3]=30,ye),consumer:(be={},be[0]=30,be[3]=30,be),sharePointList:(we={},we[0]=720,we[12]=720,we[2]=30,we)},je={"SharePoint App":!0,"System Account":!0},Fe=(function(){function e(e,t){this._baseStore=t.itemActivityFeedStore;this._dictItemActivities={}}e.prototype.addListener=function(e,t){var n=this,r=this._getItemActivitiesDictionaryKey(t);this._dictItemActivities[r]=this._transformItemActivities(t,this._baseStore.getItemActivities(t));return this._baseStore.addListener(function(){n._dictItemActivities[r]=n._transformItemActivities(t,n._baseStore.getItemActivities(t));e()},t)};e.prototype.fetchItemActivities=function(e){this._baseStore.fetchItemActivities(e)};e.prototype.getItemActivities=function(e){var t=this._getItemActivitiesDictionaryKey(e);return this._dictItemActivities[t]?this._dictItemActivities[t]:this._baseStore.getItemActivities(e)};e.prototype.removeListener=function(e){this._baseStore.removeListener(e)};e.prototype._getItemActivitiesDictionaryKey=function(e){var t=e.item.graphItemUrl;e.currentUserEmail&&(t+="_"+e.currentUserEmail);return t};e.prototype._areNewActivitiesFetched=function(e,t){var n=this._getItemActivitiesDictionaryKey(e);return!this._dictItemActivities[n]||this._dictItemActivities[n].activities.length!==t.length};e.prototype._transformItemActivities=function(e,t){var n=[];if(t.activities.length>0)for(var r={},i=0;i<t.activities.length;i++){var s=t.activities[i];if(!this._shouldHideActivity(s,e.currentUserEmail)){var o=t.activities[i-1],u=this._getCacheItemKeyAndGroupingRange(s,e.environment),a=u.cacheItemKey,f=u.groupingRange,l=s.actors[0];o&&this._isMergableMoveActivity(o,s)?this._handleMergableMoveActivity(o,s,n):a&&l?this._handleGroupableActivity(r,a,f,s,n):n.push(s)}}!this._areNewActivitiesFetched(e,n)&&t.nextRequestToken&&this.fetchItemActivities(e);return{isPlaceholder:t.isPlaceholder,activities:n,nextRequestToken:t.nextRequestToken,success:t.success}};e.prototype._handleMergableMoveActivity=function(e,t,n){n[n.length-1]={id:e.id,type:e.type,actors:e.actors,item:e.item,parentItem:e.parentItem,time:e.time,friendlyDisplayTime:e.friendlyDisplayTime,action:{move:{from:e&&e.action&&e.action.move&&e.action.move.from,to:t&&t.action&&t.action.move&&t.action.move.to}}}};e.prototype._handleGroupableActivity=function(e,t,n,r,i){var s=r.actors[0],o=this._getActorKey(s),u=e[t],a=u&&this._shouldResetGroupingItem(u,r,n);if(!u||a){var f={};f[o]=s;e[t]={activity:r,lastActivityTime:r.time,actors:f,groupedIndex:i.length};i.push(r)}else if(!u.actors[o]){u.actors[o]=s;if(1===u.activity.actors.length){var l=u.activity,c={id:l.id,type:l.type,actors:[l.actors[0]],item:l.item,parentItem:l.parentItem,time:l.time,action:l.action,friendlyDisplayTime:l.friendlyDisplayTime};u.activity=c;i[u.groupedIndex]=c}u.activity.actors.push(s)}};e.prototype._shouldResetGroupingItem=function(e,t,n){return e.lastActivityTime.getTime()-6e4*n>t.time.getTime()};e.prototype._getCacheItemKeyAndGroupingRange=function(e,t){var n,r,i,s=t&&Be[t]&&Be[t][e.type]||0;if(s){var o=void 0;e.item.driveItem&&e.item.driveItem.id?o=e.type.toString()+"_"+e.item.driveItem.id:e.item.graphItemUrl&&(o=e.type.toString()+"_"+e.item.graphItemUrl);var u=e.action.commentResponse;o&&u&&u.commentAuthor&&(o+="_"+u.commentAuthor.email);if(12===e.type){var a=null===(i=null===(r=null===(n=e)||void 0===n?void 0:n.action)||void 0===r?void 0:r.share)||void 0===i?void 0:i.recipients;if(a&&0!==a.length)return{}}return{cacheItemKey:o,groupingRange:s}}return{}};e.prototype._shouldHideActivity=function(e,t){var n=!1,r=e.item&&e.item.name&&e.item.name.toLowerCase();if(r){var i=r.lastIndexOf(".");if(-1!==i){var s=r.substring(i+1);He.t.File;Pe.r(s)===He.t.OneNote&&(n=!0)}}return n||this._isSystemAccount(e)||5===e.type||!e.item};e.prototype._isSystemAccount=function(e){var t=e.actors.length>0&&e.actors[0];return t&&je[t.displayName]};e.prototype._isMergableMoveActivity=function(e,t){return 1===e.type&&1===t.type&&!!e.action.move.from&&!e.action.move.to&&!t.action.move.from&&!!t.action.move.to&&e.item&&t.item&&e.item.name===t.item.name};e.prototype._getActorKey=function(e){return e.email||"@@noemail@@_"+e.displayName};return e})(),Ie=n(2189),qe=(function(){function e(e,t){this._itemActivitiesService=t.itemActivitiesService;this._lastListenerId=-1;this._dictListener={};this._dictItemActivities={};this._promiseDeduplicator=new Ie.e}e.prototype.addListener=function(e,t){var n=this._getItemActivitiesDictionaryKey(t);this._lastListenerId++;this._dictListener[n]||(this._dictListener[n]={});this._dictListener[n][this._lastListenerId]=e;return{key:this._lastListenerId,itemKey:n}};e.prototype.fetchItemActivities=function(e){var t=this,n=this._getItemActivitiesDictionaryKey(e),r=this._dictItemActivities[n];if(!r||0===e.startIndex){var i=0;r&&0===r.startIndex&&(i=r.noOfUnsuccessfulRequests);r={activities:{isPlaceholder:!0,activities:[],success:!0},noOfUnsuccessfulRequests:i,startIndex:0}}var s=r.activities;if(s.nextRequestToken||e.item.graphItemUrl){var o=(s.nextRequestToken||e.item.graphItemUrl)+"_"+(e.startIndex||0),u={};"consumer"===e.environment&&(u.Prefer=e.activityApiHeaders?e.activityApiHeaders:"Get-Self,Force-VaultItems-Filter");this._promiseDeduplicator.deduplicate(o,function(){var i={item:e.item,nextRequestToken:s.nextRequestToken,qosPrefix:e.qosPrefix,headers:u,environment:e.environment};return t._itemActivitiesService.getItemActivities(i).then(function(i){if(i&&i.success||r.noOfUnsuccessfulRequests+1>=2){t._dictItemActivities[n]={activities:t._mergeItemActivities(s,i,e.isScrollEvent,e.environment),noOfUnsuccessfulRequests:0,startIndex:e.startIndex};t._emitChange(e)}else{t._dictItemActivities[n]={activities:s,noOfUnsuccessfulRequests:r.noOfUnsuccessfulRequests+1,startIndex:r.startIndex};t.fetchItemActivities(e)}},function(e){return R.n.reject(e)})})}};e.prototype.getItemActivities=function(e){var t=this._getItemActivitiesDictionaryKey(e);return this._dictItemActivities[t]?this._dictItemActivities[t].activities:{isPlaceholder:!0,activities:[],success:!0}};e.prototype.removeListener=function(e){if(!this._dictListener[e.itemKey]||!this._dictListener[e.itemKey][e.key])throw"Listener with key "+e.key+" for item "+e.itemKey+" not found";delete this._dictListener[e.itemKey][e.key]};e.prototype._emitChange=function(e){var t=this._getItemActivitiesDictionaryKey(e),n=this._dictListener[t];if(n)for(var r=0,i=Object.getOwnPropertyNames(n);r<i.length;r++){(0,n[i[r]])()}};e.prototype._getItemActivitiesDictionaryKey=function(e){var t=e.item&&(e.item.graphItemUrl||e.item.absolutePath);e.currentUserEmail&&(t+="_"+e.currentUserEmail);return t};e.prototype._mergeItemActivities=function(e,t,n,r){this._logActivitiesTelemetry(t.activities,n,r);var i=(e.activities||[]).concat(t.activities||[]);return{isPlaceholder:!e&&!t||e.isPlaceholder&&t.isPlaceholder,activities:i,nextRequestToken:t.nextRequestToken||!t&&e.nextRequestToken,success:e.success&&t&&t.success}};e.prototype._logActivitiesTelemetry=function(e,t,n){f.e.logData({name:"ActivityFeed.activitiesFetched",isIntentional:!0,extraData:{isScrollEvent:!!t,noOfActivities:e.length,environment:n}})};return e})(),Re=n(2603),Ue=Object(De.s)("ItemActivityFeedStore",qe,{itemActivitiesService:Re.e}),ze=Object(De.s)("GroupedItemActivityFeedStore",Fe,{itemActivityFeedStore:Ue}),We=n(888),Xe=n(2615),Ve=n(1499),$e=n(110),Je=n(94),Ke=n(1003),Qe=n(1018),Ge=n(137),Ye=n(326),Ze=n(1735),et=n(1731);Object(u.n)([{rawString:".InfoPane-itemDetails-notificationBellODB{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";height:auto;margin-bottom:2px;font-size:16px;margin-top:3px}.InfoPane-itemDetails-notificationBellODB--loading{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";height:auto;margin-bottom:2px;font-size:16px;margin-top:3px}"}]);var tt=n(3266),nt=n(653),rt={on:{bellButtonClassName:"InfoPane-itemDetails-notificationBellODB",bellButtonIconName:"Ringer",tooltips:tt.u,isAriaChecked:!0,ariaLabel:tt.r},off:{bellButtonClassName:"InfoPane-itemDetails-notificationBellODB",bellButtonIconName:"RingerOff",tooltips:tt.o,isAriaChecked:!1,ariaLabel:tt.n},loading:{bellButtonClassName:"InfoPane-itemDetails-notificationBellODB--loading",bellButtonIconName:"Ringer",tooltips:tt.s,ariaLabel:tt.t},error:{bellButtonClassName:"InfoPane-itemDetails-notificationBellODB--loading",bellButtonIconName:"Ringer",tooltips:tt.i,ariaLabel:tt.e}},it=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._toggleNotifications=function(){if(3!==r.state.notificationState&&2!==r.state.notificationState){r.setState(function(e){return{notificationState:0===e.notificationState?1:0}});var e=r.state.notificationState,t=0===e||1!==e&&void 0;r._updateNotificationState(t)}};r._loadNotificationState=function(e){r._itemMuteNotificationDataSource.getNotificationState(e,"getNotification").then(function(e){void 0!==e?r.setState(function(){return{notificationState:e?0:1}}):r.setState({notificationState:3})})};r._updateNotificationState=function(e){void 0!==e&&r._itemMuteNotificationDataSource.updateNotificationState(e,r.props.item,"updateNotification",r._getSiteDetailsForUpdate())};var i=r.context.dependencies;r._itemCacheStore=r.props.itemCacheStore||i.itemCacheStore;r._itemsScopeItemKey=r.props.itemsScopeItemKey||i.itemsScopeItemKey;r._scope=new Ye.e;r._itemMuteNotificationDataSource=r.props.itemMuteNotificationDataSource||r._scope.attach(i.itemMuteNotificationDataSource);r.state={notificationState:2};return r}t.prototype.render=function(){var e;switch(this.state.notificationState){case 0:e=rt.on;break;case 1:e=rt.off;this.props.isODC&&(e.bellButtonIconName="RingerRemove");break;case 2:e=rt.loading;break;case 3:e=rt.error}return i.createElement(D.e,{content:e.tooltips,id:Object(nt.e)("bellIconTooltipHost"),styles:{root:{display:"inline-block"}},directionalHint:P.e.bottomAutoEdge},i.createElement(_.e,{className:e.bellButtonClassName,onClick:this._toggleNotifications,iconProps:{iconName:e.bellButtonIconName},role:"switch","aria-checked":e.isAriaChecked,"aria-label":e.ariaLabel}))};t.prototype.componentDidMount=function(){this._loadNotificationState(this.props.item)};t.prototype.componentWillUnmount=function(){this._scope.dispose()};t.prototype.UNSAFE_componentWillUpdate=function(e){e.item!==this.props.item&&this._loadNotificationState(e.item)};t.prototype._getSiteDetailsForUpdate=function(){var e="",t="",n=this._itemsScopeItemKey;this._itemCacheStore&&this._itemCacheStore.dispatch(Object(Ge.e)(function(r){var i=Object($e.e)(r,{itemsScopeItemKey:n}),s=Object(Je.e)(r,i);t=(null==s?void 0:s.siteId)||"";e=(null==s?void 0:s.webId)||""}));return{webId:e,siteId:t}};t.contextTypes=Ze.e;return t})(i.PureComponent),st=Object(et.e)("ItemMuteNotification",it,{itemMuteNotificationDataSource:_e.D,itemCacheStore:Ke.e,itemsScopeItemKey:Qe.e}),ot=n(2072),ut=n(1774);Object(u.n)([{rawString:".od-ItemActivityFeedWrapper .sp-livePersonaCardAdapter-root{font-family:inherit;font-size:inherit}.od-ItemActivityFeedWrapper{display:flex;flex-direction:column}.od-SharingDialogWrapper .ms-Dialog-header{display:none}.od-SharingDialogWrapper .ms-Dialog-inner{padding:0}.od-SharingDialogWrapper .ms-Dialog-inner .ms-Dialog-content{padding:0;margin:0}.od-SharingDialogWrapper .od-AtMention{min-width:unset}.od-ItemActivityFeed-header-old{display:flex;align-items:center;margin-bottom:4px}.od-ItemActivityFeed-header{display:flex;align-items:center}.od-ItemActivityFeed-header .ms-TooltipHost{margin-left:auto}.od-ItemActivityFeed-title-old{font-size:14px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";margin:0}.isFluent .od-ItemActivityFeed-title-old{font-size:14px;font-weight:600}.od-ItemActivityFeed-title{font-size:14px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";margin:0 0 5px}.isFluent .od-ItemActivityFeed-title{font-size:14px;font-weight:600}.od-ItemActivityFeed-viewOption{padding:0;align-self:flex-end;width:auto;border:none;margin-left:-4px;font-weight:600;background-color:transparent;box-shadow:none}.od-ItemActivityFeed-viewOption .ms-Button-menuIcon{font-weight:600;margin-top:3px}.od-ItemActivityFeed-viewOption.inListForm{font-size:18px;height:28px;padding:0 4px;margin-left:-8px;margin-bottom:8px;margin-top:2px}.od-ItemActivityFeed-viewOption.inListForm:hover{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.od-ItemActivityFeed-viewOption.inListForm.is-expanded{background-color:"},{theme:"neutralQuaternary",defaultValue:"#d2d0ce"},{rawString:"}.od-ItemActivityFeed-viewOption.inListForm.is-expanded:hover{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.od-DetailsPane-PrimaryPane-body .od-ItemActivityFeed-viewOption:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-DetailsPane-PrimaryPane-body .od-ItemActivityFeed-viewOption.is-expanded{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.od-DetailsPane-PrimaryPane-body .od-ItemActivityFeed-viewOption.is-expanded:hover{background-color:"},{theme:"neutralQuaternary",defaultValue:"#d2d0ce"},{rawString:"}.od-DetailsPane-SecondaryPane-body .od-ItemActivityFeed-viewOption:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-DetailsPane-SecondaryPane-body .od-ItemActivityFeed-viewOption.is-expanded{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-DetailsPane-SecondaryPane-body .od-ItemActivityFeed-viewOption.is-expanded:hover{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.od-ItemActivityFeed-viewOption-old{background-color:transparent;padding:0;align-self:flex-end;margin-left:auto;width:auto}.od-ItemActivityFeed-viewOption-old .ms-Button-label{font-weight:400}.od-ItemActivityFeed-menuItems{min-width:180px;padding:0}.od-ItemActivityFeed-menuItems .ms-ContextualMenu-icon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}@media (forced-colors:active){.od-ItemActivityFeed-menuItems .ms-ContextualMenu-icon{color:HighlightText}}.od-ItemActivityFeed-NoCommentsView{text-align:center;top:282px;position:absolute;width:calc(100% - 32px)}.od-ItemActivityFeed-NoCommentsView .noCommentsView-Image{margin-bottom:12px}.od-ItemActivityFeed-NoCommentsView .noCommentsView-Message{font-size:14px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-weight:400}.od-ItemActivityFeed-NoCommentsView .noCommentsView-MessagePrimary{font-size:16px;margin-top:5px;margin-bottom:10px;color:"},{theme:"black",defaultValue:"#000000"},{rawString:";font-weight:600}.default .activity-feed-panel-root.isTeamsApp .od-ItemActivityFeedWrapper .od-ItemActivityFeed .ms-ActivityItem-timeStamp,.default .activity-feed-panel-root.isTeamsApp .od-ItemActivityFeedWrapper .od-ItemActivityFeed .od-ItemActivity-item-textContent,.default .activity-feed-panel-root.isTeamsApp .od-ItemActivityFeedWrapper .od-ItemActivityFeed .od-ItemActivityList-grouplistTitle,.default .activity-feed-panel-root.isTeamsApp .od-ItemActivityFeedWrapper .od-ItemActivityFeed .od-addNewCommentTextField-mentionableTextBox,.default .od-listAllItems .od-ItemActivityFeedWrapper .od-ItemActivityFeed .ms-ActivityItem-timeStamp,.default .od-listAllItems .od-ItemActivityFeedWrapper .od-ItemActivityFeed .od-ItemActivity-item-textContent,.default .od-listAllItems .od-ItemActivityFeedWrapper .od-ItemActivityFeed .od-ItemActivityList-grouplistTitle,.default .od-listAllItems .od-ItemActivityFeedWrapper .od-ItemActivityFeed .od-addNewCommentTextField-mentionableTextBox{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.default .activity-feed-panel-root.isTeamsApp .od-ItemActivityFeedWrapper .od-ItemActivityFeed .od-ItemActivity-item-nameText,.default .activity-feed-panel-root.isTeamsApp .od-ItemActivityFeedWrapper .od-ItemActivityFeed .od-addNewCommentTextField-mentionableTextBox:not(:empty),.default .activity-feed-panel-root.isTeamsApp .od-ItemActivityFeedWrapper .od-ItemActivityFeed .od-itemActivity-commentActivity-commentContent,.default .od-listAllItems .od-ItemActivityFeedWrapper .od-ItemActivityFeed .od-ItemActivity-item-nameText,.default .od-listAllItems .od-ItemActivityFeedWrapper .od-ItemActivityFeed .od-addNewCommentTextField-mentionableTextBox:not(:empty),.default .od-listAllItems .od-ItemActivityFeedWrapper .od-ItemActivityFeed .od-itemActivity-commentActivity-commentContent{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}"}]);var at=n(1871),ft=n(1699),lt=n(774),ct=n(1990),ht=n(477),pt=window.require.toUrl("odsp-media/images/commentspane/nocomments.svg"),dt=function(e){var t=Object(ht.i)();return i.createElement("div",{className:"od-ItemActivityFeed-NoCommentsView"},i.createElement("div",{className:"noCommentsView-Image","aria-hidden":!0},i.createElement("img",{src:e.illustrationUrl||pt})),t?i.createElement("div",{className:"noCommentsView-MessagePrimary"},o.v):void 0,i.createElement("div",{className:"noCommentsView-Message"},e.message||(t?o.m:o.d)))},vt=n(183),mt=n(181),gt=n(1110),yt=n(3),bt=n(46),wt=Object(ot.e)(st.local.bypass),Et=(function(e){Object(r.__extends)(t,e);function t(t,n){var s=e.call(this,t,n)||this;s._isAtMentionEnabled=function(e){var t;return!(null===(t=s._platform)||void 0===t?void 0:t.isIE)&&s._itemActivityFeedHelper.isAtMentionEnabled(e)};s._populateItemNameToDisplay=function(e){var t=s._itemActivityFeedHelper.getItemNameToDisplay(s.props.item,e);e.name=t;return t};s._canOpenItem=function(e){return!!s._getItemUrl(e)};s._onItemClick=function(e,t){var n=s.props.item,r=s._getItemUrl(e);s._itemActivityFeedHelper.navigateToItem(n,e,r,function(e){s._engagement.logData({name:"ActivityFeed.ItemClicked",isIntentional:!0,extraData:{activityType:t||"",itemType:e||""}})})};s._onItemCommentsSettingChanged=function(e){var t=s.props.item;if(e!==(t.comments&&t.comments.settings&&t.comments.settings.isCommentDisabled)){var n=Object(r.__assign)(Object(r.__assign)({},t.comments&&t.comments.settings),{isCommentDisabled:e}),i=s._resources.consume(Ve.resourceKey);i.invalidateItem(t.key);i.invalidateItem(t.parentKey);s._itemActivityFeedHelper.updateItem(t,{comments:Object(r.__assign)(Object(r.__assign)({},t.comments),{settings:n})});var o=t&&t.properties&&t.properties.ID;s._isItemsScopeEnabled()&&s._resources.consumeAsync(_e._).then(function(e){e.refreshItemsInCurrentItemSet([o])})}};s._refreshCurrentItem=function(){var e=s.props.item,t=e&&e.properties&&e.properties.ID;t&&s._isItemsScopeEnabled()&&s._resources.consumeAsync(_e._).then(function(e){e.refreshItemsInCurrentItemSet([t])})};s._canDeleteActivity=function(e){var t=s.props.item;switch(e){case 2:return s._isCommentsAvailable(t)&&s._itemActivityFeedHelper.checkHasDeletePermission(t)&&!s._itemActivityFeedHelper.isReadOnly(t);default:return!1}};s._onRenderUser=function(e,t){return s._itemActivityFeedHelper.renderUser(e,t)};s._deleteCommentActivity=function(e,t,n){var r=n.commentItem,i=n.commentId,o=s.props.item,u=o.isRootFolder?"driveRoot":o.folder?"folder":o.extension||"file",a=void 0!==o.sharingType?ut.e[o.sharingType]:void 0;if(e&&r&&i){var f="sharePointList"===s._itemActivityFeedHelper.getAPIEnvironment(o),l=f?"SPList":void 0;s._itemCommentsStore.deleteCommentById(r,i,t,l).then(function(){f&&s._refreshCurrentItem()});s._engagement.logData({name:"ActivityFeed.DeleteComment",isIntentional:!0,extraData:{itemType:u,sharingType:a}})}};s._onHighlightCommentCard=function(){var e;if(s._deeplinkCommentThreadId){s._engagement.logData({name:"ActivityFeed.DeeplinkComment.Success",isIntentional:!0,extraData:{itemId:null===(e=s.props.item)||void 0===e?void 0:e.itemId,deeplinkCommentId:s._deeplinkCommentThreadId}});s._cleanupDeeplinkCommentId()}};s._cleanupDeeplinkCommentId=function(){s._itemActivityFeedHelper.cleanupDeeplinkCommentId();s._deeplinkCommentThreadId&&(s._deeplinkCommentThreadId=void 0)};s._onCheckUserAccess=function(e,t,n){var r=s.props.item;return s._itemActivityFeedHelper.checkUserAccess(r,s.state.graphDataSource,e,t,n)};s._onGrantAccess=function(e,t,n){t&&(s._grantAccessStatusCallback=t);if(e&&0===e.length)s._sharingStatusCallBack("share_grantAccessCompleted");else{s._itemActivityFeedSharingHelper.setGrantees(e);s._itemActivityFeedSharingHelper.setDismissCallback(s._onDismissSharingDialog);s._itemActivityFeedSharingHelper.setStatusCallback(s._sharingStatusCallBack);s._itemActivityFeedSharingHelper.setResizeCallback(s._onResizeSharingDialog);s._itemActivityFeedSharingHelper.waitUntilReady().then(function(e){"ready"===e?s.setState({showSharingDialog:!0}):n&&n(e)})}};s._onDismissSharingDialog=function(){s.setState({showSharingDialog:!1});s._grantAccessStatusCallback&&s._grantAccessStatusCallback("share_dismiss");s._itemActivityFeedSharingHelper.init(s._resources,s.props.item);s._wrapperDiv.current&&Object(lt.n)(s._wrapperDiv.current)};s._onResizeSharingDialog=function(){};s._sharingStatusCallBack=function(e){s.setState({showSharingDialog:!1});s._grantAccessStatusCallback&&(e?s._grantAccessStatusCallback(e):s._grantAccessStatusCallback("share_error"));s._itemActivityFeedSharingHelper.init(s._resources,s.props.item)};s._resources=t.resources;s._itemActivityFeedStore=s._resources.consume(ze);s._itemCommentsStore=s._resources.consume(Xe.e);s._itemActivityFeedHelper=s._resources.consume(_e.C);Object(yt.Wi)(bt.MentionTeachingUIAA)&&(s._showTeachingBubbleOnTextBox=s._resources.consume(gt.e));s._engagement=s._resources.consume(We.e);s._isItemsScopeEnabled=s._resources.consume(Me.h.lazy);s._platform=s._resources.consume(mt.e.optional);s._focusActivityFeedOnMount=!1;s._wrapperDiv=i.createRef();if(s._isAtMentionEnabled(t.item)){s._itemActivityFeedSharingHelper=s._resources.consume(_e.k);s._isSharingDialogEnabled=s._itemActivityFeedSharingHelper.isShareAndNotifyDialogEnabled(s.props.item)}s._deeplinkCommentThreadId=s._itemActivityFeedHelper.getDeepLinkCommentThreadId();s.state={graphDataSource:s._resources.consume(_e.b.optional),commentsOnly:"comments"===t.defaultViewOption||void 0!==s._deeplinkCommentThreadId,showSharingDialog:!1};return s}t.prototype.getChildContext=function(){return{itemActivityFeedStore:this._itemActivityFeedStore,itemCommentsStore:this._itemCommentsStore,peoplePickerProvider:this._itemActivityFeedHelper.getPeoplePickerProvider(),engagementSource:"ActivityFeed"}};t.prototype.componentDidMount=function(){this._focusActivityFeedOnMount&&this._wrapperDiv.current&&Object(lt.n)(this._wrapperDiv.current);this.state.graphDataSource||this._loadGraphDataSource();if(this._itemActivityFeedSharingHelper){this._itemActivityFeedSharingHelper.init(this._resources,this.props.item);this._isSharingDialogEnabled=this._itemActivityFeedSharingHelper.isShareAndNotifyDialogEnabled(this.props.item)}this._logActivityFeedRendersEvent()};t.prototype.componentDidUpdate=function(e){if(this._itemActivityFeedSharingHelper&&e.item&&this.props.item&&e.item.key!==this.props.item.key){this._itemActivityFeedSharingHelper.init(this._resources,this.props.item);this._isSharingDialogEnabled=this._itemActivityFeedSharingHelper.isShareAndNotifyDialogEnabled(this.props.item)}this._logActivityFeedRendersEvent()};t.prototype.shouldComponentUpdate=function(e,t){var n=e.item,r=this.props.item;return n&&r&&n.key!==r.key&&(Object(yt.Wi)(yt.Ci)||0===n.revision)||this._isCommentSettingsChanged(n,r)||e.resources!==this.props.resources||t.graphDataSource!==this.state.graphDataSource||t.commentsOnly!==this.state.commentsOnly||t.showSharingDialog!==this.state.showSharingDialog};t.prototype.render=function(){var e,t=this.props,n=t.item,r=t.focusCommentInputOnMount,s=t.scenario,u=t.onCloseButtonClick,a=this.state,f=a.commentsOnly,l=a.showSharingDialog,c=this._itemActivityFeedHelper.getAPIEnvironment(n),h="sharePointList"===c,p="consumer"===c||h,d=n.displayName||"",v=this._itemActivityFeedHelper.getGraphItemUrl(n,this.state.graphDataSource),m=h?{accessToken:""}:this._itemActivityFeedHelper.getAccessToken(n,this.state.graphDataSource),g=v&&(!this._itemActivityFeedHelper.isAccessTokenRequired()||m),y=this._itemActivityFeedHelper.isCommentOnItemDisabled(n);if(g){var b={name:d,graphItemUrl:v,accessToken:m},w=this._itemActivityFeedHelper.getCommentListItem(n,b)||void 0,E=this._itemActivityFeedHelper.isCommentsOnly(n,!!f),S=this._itemActivityFeedHelper.isReadOnly(n)||this._itemActivityFeedHelper.isCommentingDisabledOnTenant(c)||this._itemActivityFeedHelper.isCommentingDisabledOnList(n);this._focusActivityFeedOnMount=!(!S||!r);var x=this._itemActivityFeedHelper.isSingleLevel(n);return"consumer"===c&&w&&this._itemActivityFeedHelper.isAnonymousUser()?i.createElement(dt,{message:o.r}):i.createElement(vt.e,{componentName:"ItemActivityFeed"},u&&i.createElement("div",{className:"activityFeed-Close"},i.createElement(_.e,{onClick:u,iconProps:{iconName:"Cancel"},title:o.g})),i.createElement("div",{className:"od-ItemActivityFeedWrapper",ref:this._wrapperDiv},i.createElement(vt.e,{componentName:"ItemActivityFeed.ViewOption"},p?this._renderItemActivityFeedViewOption(f,n,y):this._renderOldItemActivityFeedViewOption(f,n,y)),i.createElement(vt.e,{componentName:"ItemActivityFeed.MentionSharingDialog"},!0===this._isSharingDialogEnabled&&this._itemActivityFeedSharingHelper&&l&&i.createElement(at.e,{hidden:!l,onDismiss:this._onDismissSharingDialog,"aria-label":ct.p,dialogContentProps:{className:"od-SharingDialogWrapper",type:ft.e.normal,title:""}},this._itemActivityFeedSharingHelper.renderGrantAccess())),i.createElement(Le,{currentUserEmail:this._itemActivityFeedHelper.getCurrentUserEmail(),containingItem:b,isSingleLevel:x,canOpenItem:this._canOpenItem,onItemClick:this._onItemClick,onRenderUser:this._onRenderUser,populateItemNameToDisplay:h&&!x?this._populateItemNameToDisplay:void 0,currentRootTitle:this._itemActivityFeedHelper.getCurrentRootTitle(n),defaultItemTitle:this._itemActivityFeedHelper.getDefaultItemTitle(n),commentListItem:w,isReadonly:S,commentsOnly:E,groupHeadingLevel:"spListForm"===s?2:4,canDeleteActivity:this._canDeleteActivity,activityMenuFunctions:this._getActionMenuFunctions(),onCommentSettingsChanged:this._onItemCommentsSettingChanged,environment:c,isNewCommentExperienceEnabled:p,getpersonaIconUrl:this._itemActivityFeedHelper.getPersonaIconUrl(),commentTextBoxPlaceholder:this._getCommentTextBoxPlaceholder(n,c),activityApiHeaders:this._itemActivityFeedHelper.getActivityApiHeaders(n),isAtMentionEnabled:this._isAtMentionEnabled(n),isPublicEmailAddressMentionSupported:this._itemActivityFeedHelper.isPublicEmailAddressMentionSupported(n),onCheckUserAccess:this._onCheckUserAccess,focusCommentInputOnMount:r,onGrantAccess:this._onGrantAccess,deeplinkCommentThreadId:this._deeplinkCommentThreadId,refreshCurrentItemCallback:h?this._refreshCurrentItem:void 0,NoCommentsView:"spListForm"!==s||S?void 0:dt,isWXPCommentingDisabled:this._itemActivityFeedHelper.isWXPCommentingDisabled(n),onHighlightCommentCard:this._onHighlightCommentCard,platform:this._platform,getPeoplePickerQueryParams:null===(e=this._itemActivityFeedSharingHelper)||void 0===e?void 0:e.getPeoplePickerQueryParams,showTeachingBubbleOnTextBox:this._showTeachingBubbleOnTextBox,isShareAndNotifyDialogDisabled:!this._isSharingDialogEnabled,engagementExecutor:this._engagement})))}return i.createElement("div",null)};t.prototype._logActivityFeedRendersEvent=function(){var e=this.props.item,t=e.isRootFolder?"driveRoot":e.folder?"folder":e.extension||"file";this._engagement.logData({name:"ActivityFeed.Renders",isIntentional:!0,extraData:{itemType:t||""}})};t.prototype._isCommentsAvailable=function(e){return this._itemActivityFeedHelper.isNonOfficeFileCommentsAvailable(e)};t.prototype._isCommentSettingsChanged=function(e,t){return(e.comments&&e.comments.settings&&e.comments.settings.isCommentDisabled)!==(t.comments&&t.comments.settings&&t.comments.settings.isCommentDisabled)};t.prototype._getItemUrl=function(e){return this._itemActivityFeedHelper.getActivityItemUrl(e)};t.prototype._loadGraphDataSource=function(){var e=this;this._resources.consumeAsync(_e.b).then(function(t){e.setState({graphDataSource:t})})};t.prototype._getActionMenuFunctions=function(){var e;return(e={})[2]={delete:this._deleteCommentActivity},e};t.prototype._renderItemActivityFeedViewOption=function(e,t,n){var r=this,s=this._itemActivityFeedHelper.activityHeaderToDisplay(t);return i.createElement("div",{className:"od-ItemActivityFeed-header"},s&&i.createElement("h3",{className:"od-ItemActivityFeed-title"},s),i.createElement(Ae,{isCommentsOnlyView:!!e,item:t,onSelectMenuOption:function(e){r.state.commentsOnly!==e&&r._engagement.logData({name:"ActivityFeedViewOption.Toggle."+(e?"Comments_Only":"All_Activity"),isIntentional:!0});r.setState({commentsOnly:e})},itemActivityFeedHelper:this._itemActivityFeedHelper,isCommentsInActivityFeedEnabled:this._itemActivityFeedHelper.isCommentsInActivityFeedEnabled(),isCommentDisabledInItemSetting:n,extraClassName:"spListForm"===this.props.scenario?"inListForm":void 0}),this._itemActivityFeedHelper.isItemNotificationActive(t)&&i.createElement(wt,{item:t,isODC:"consumer"===this._itemActivityFeedHelper.getAPIEnvironment(t)}))};t.prototype._renderOldItemActivityFeedViewOption=function(e,t,n){var r=this;return i.createElement("div",{className:"od-ItemActivityFeed-header-old"},i.createElement("h3",{className:"od-ItemActivityFeed-title-old"},o.f),this._itemActivityFeedHelper.isItemNotificationActive(t)&&i.createElement(wt,{item:t}),i.createElement(Oe,{isCommentsOnlyView:e,item:t,onSelectMenuOption:function(e){r.state.commentsOnly!==e&&r._engagement.logData({name:"ActivityFeedViewOption.Toggle."+(e?"Comments_Only":"All_Activity"),isIntentional:!0});r.setState({commentsOnly:e})},itemActivityFeedHelper:this._itemActivityFeedHelper,isCommentsInActivityFeedEnabled:this._itemActivityFeedHelper.isCommentsInActivityFeedEnabled(),isCommentDisabledInItemSetting:n}))};t.prototype._getCommentTextBoxPlaceholder=function(e,t){return this._itemActivityFeedHelper.isCommentingDisabledOnTenant(t)?o.o:this._itemActivityFeedHelper.isCommentingDisabledOnList(e)?o.s:this._itemActivityFeedHelper.isCommentOnItemDisabled(e)?o.u:this._itemActivityFeedHelper.isAnonymousUser()?o.n:this._itemActivityFeedHelper.checkHasCommentingPermission(e)?this._isAtMentionEnabled(e)?o.t:o.e:o.i};t.childContextTypes={itemActivityFeedStore:s.object.isRequired,itemCommentsStore:s.object.isRequired,peoplePickerProvider:s.object,engagementSource:s.string.isRequired};return t})(i.Component);t.default=Et}],Array(41),[function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(7),i=n(11),s=new r.t({name:"ItemColumnDataSource.key",loader:new i.t(function(){return n.ee(["276"],3455).then(function(e){return e.resourceKey})})})},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(7).t)("InfoPaneManager.key")}],Array(45),[function(e,t,n){"use strict";var r=n(138);Object(r.n)([{rawString:".od-DetailsPane-ItemActivityFeedSection{margin:12px 0;padding:0 16px}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-error,.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-noActivities,.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";padding:14px 16px}.isFluent .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-error,.isFluent .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-noActivities,.isFluent .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity{padding:14px 16px;border-radius:2px}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-grouplistTitle{margin-bottom:8px;margin-top:16px}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivity-item-focusZone{margin:8px 0}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity{margin:0 -38px 0 0;width:calc(100% - 32px);display:inline-block}html[dir=rtl] .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity{margin:0 0 0 -38px}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-error,.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-noActivities{font-size:12px;margin:8px 0}.od-DetailsPane-ItemActivityFeedSection-content .ms-ActivityItem-activityContent{padding:0 0 0 8px}html[dir=rtl] .od-DetailsPane-ItemActivityFeedSection-content .ms-ActivityItem-activityContent{padding:0 8px 0 0}.isFluent .od-DetailsPane-ItemActivityFeedSection-content .ms-ActivityItem-activityContent{padding:0 0 0 16px}html[dir=rtl] .isFluent .od-DetailsPane-ItemActivityFeedSection-content .ms-ActivityItem-activityContent{padding:0 16px 0 0}.od-DetailsPane-ItemActivityFeedSection-content .ms-ActivityItem-timeStamp{padding-top:2px}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-missingActivity{margin-bottom:8px}.od-DetailsPane-ItemActivityFeedSection-content .ms-ActivityItem-activityTypeIcon{font-size:16px!important;width:32px;text-align:center;margin-top:8px}.od-DetailsPane-SecondaryPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-error,.od-DetailsPane-SecondaryPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-noActivities,.od-DetailsPane-SecondaryPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}.Files-rightPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity-withCommentResponse{width:calc(100% - 32px)}.Files-infoPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity-withCommentResponse,.OneUp-infoPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity-withCommentResponse{width:calc(100% - 32px)}"}])},,function(e,t,n){"use strict";var r=n(138);Object(r.n)([{rawString:".InfoPaneSection--itemStatus{display:flex}html[dir=ltr] .InfoPaneSection--itemStatus .itemStatus-icon{margin-right:8px}html[dir=rtl] .InfoPaneSection--itemStatus .itemStatus-icon{margin-left:8px}.InfoPaneSection--itemStatus .itemStatus-message{font-size:14px;font-weight:400}"}])},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(25),i={root:"ms-BasePicker",text:"ms-BasePicker-text",itemsWrapper:"ms-BasePicker-itemsWrapper",input:"ms-BasePicker-input"};function s(e){var t,n=e.className,s=e.theme,o=e.isFocused,u=e.inputClassName,a=e.disabled;if(!s)throw new Error("theme is undefined or null in base BasePicker getStyles function.");var f=s.semanticColors,l=s.effects,c=s.fonts,h=f.inputBorder,p=f.inputBorderHovered,d=f.inputFocusBorderAlt,v=Object(r.x)(i,s);return{root:[v.root,n],text:[v.text,{display:"flex",position:"relative",flexWrap:"wrap",alignItems:"center",boxSizing:"border-box",minWidth:180,minHeight:30,border:"1px solid "+h,borderRadius:l.roundedCorner2},!o&&!a&&{selectors:{":hover":{borderColor:p}}},o&&!a&&Object(r.k)(d,l.roundedCorner2),a&&{borderColor:"rgba(218, 218, 218, 0.29)",selectors:(t={":after":{content:'""',position:"absolute",top:0,right:0,bottom:0,left:0,background:"rgba(218, 218, 218, 0.29)"}},t[r.s]={borderColor:"GrayText",selectors:{":after":{background:"none"}}},t)}],itemsWrapper:[v.itemsWrapper,{display:"flex",flexWrap:"wrap",maxWidth:"100%"}],input:[v.input,c.medium,{height:30,border:"none",flexGrow:1,outline:"none",padding:"0 6px 0",alignSelf:"flex-end",borderRadius:l.roundedCorner2,backgroundColor:"transparent",color:f.inputText,selectors:{"::-ms-clear":{display:"none"}}},u],screenReaderText:r.M}}}],Array(158),[function(e,t,n){"use strict";n.d(t,"t",function(){return se});var r='<div class="InfoPane-section InfoPaneSection--activitiesfeed" data-bind="keyboard:keyNav.keyboardOptions,css:{\'is-expanded\':sectionHelper.isExpanded,\'no-arrow\':!sectionHelper.showArrow},selection:{data:keyNav.focusableTiles,mode:\'single\',direction:\'vertical\',focused:keyNav.focusedItem}"><div class="InfoPane-sectionHeader" id="od-ActivitiesFeed-sectionHeader" data-bind="hasFocus:keyNav.sectionHeaderFocus,toggle:sectionHelper.isExpanded,attr:{\'aria-expanded\':sectionHelper.isExpanded(),tabindex:sectionHelper.showArrow?0:-1,role:sectionHelper.showArrow?\'button\':undefined}">\x3c!--ko if:sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i>\x3c!--/ko--\x3e<h2 class="InfoPane-sectionHeaderText" data-bind="text:resxStrings.ActivitiesHeader"></h2></div><div class="InfoPane-sectionContent" role="tree" data-bind="foreach:{data:tileCollections}"><div class="od-ActivitiesFeed-listTitle ms-font-s ms-fontColor-neutralSecondaryAlt ms-fontWeight-semibold" data-bind="text:title"></div><div class="od-ActivitiesFeed-list" data-bind="foreach:{data:tiles}"><ms-item-activity-tile params="activity: $data"></ms-item-activity-tile></div></div><div class="InfoPane-sectionContent">\x3c!--ko if:isLoading()--\x3e<div class="od-ActivitiesFeed-loadingSpinnerFlat" data-bind="component:{name:loadingSpinnerFlatTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko if:!isLoading()--\x3e\x3c!--ko if:errorMessage()--\x3e<span class="ms-fontColor-error" data-bind="text:errorMessage"></span>\x3c!--/ko--\x3e\x3c!--ko if:!errorMessage&&!hasChanges()--\x3e<span class="ms-font-s" data-bind="text:resxStrings.NoChange"></span>\x3c!--/ko--\x3e\x3c!--ko if:showForEarlierChangesMsg()--\x3e<span class="od-ActivitiesFeed-sectionForEarlierChanges ms-font-s" data-bind="bindableHtml:forEarlierChangesMsg,click:onFileVersionClick,clickBubble:false"></span>\x3c!--/ko--\x3e\x3c!--ko if:showSeeMore()--\x3e<a data-bind="click:onSeeMore,clickBubble:false,text:seeMoreText" href="#"></a>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div></div>',i=n(138);Object(i.n)([{rawString:".od-ActivitiesFeed-sectionForEarlierChanges{margin-top:15px}"}]);Object(i.n)([{rawString:"[dir=ltr] .od-ItemActivityTile-section{padding-right:10px}[dir=rtl] .od-ItemActivityTile-section{padding-left:10px}html[dir=ltr] .od-ItemActivityTile-identity{float:left}html[dir=rtl] .od-ItemActivityTile-identity{float:right}[dir=ltr] .od-ItemActivityTile-identity{margin-right:5px}[dir=rtl] .od-ItemActivityTile-identity{margin-left:5px}.od-ItemActivityTile-sectionExpandButton{font-size:17px;position:absolute;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";width:32px;height:32px;line-height:32px;text-align:center;transition:transform 167ms cubic-bezier(.1,.9,.2,1)}[dir=ltr] .od-ItemActivityTile-sectionExpandButton{right:0}[dir=rtl] .od-ItemActivityTile-sectionExpandButton{left:0}.od-ItemActivityTile-section.is-expanded .od-ItemActivityTile-sectionExpandButton{transform:rotate(-180deg)}.od-ItemActivityTile-section .od-ItemActivityTile-sectionContent{display:none}.od-ItemActivityTile-section.is-expanded .od-ItemActivityTile-sectionContent{display:block}.od-ItemActivityTile-sectionHeader{padding:15px 0;min-height:40px}.od-ItemActivityTile-sectionContent{font-size:12px;min-height:40px}[dir=ltr] .od-ItemActivityTile-sectionContent{padding-left:25px}[dir=rtl] .od-ItemActivityTile-sectionContent{padding-right:25px}.od-ItemActivityTile-sectionToggle{cursor:pointer}.od-ItemActivityTile-sectionFocused{background-color:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:"}.od-ItemActivityTile-details{display:table}.od-ItemActivityTile-date{display:block}.odItemActivityTile-headline{display:block}.od-ItemActivityTile-entity{font-size:12px}html[dir=ltr] .od-ItemActivityTile-entity{float:left}html[dir=rtl] .od-ItemActivityTile-entity{float:right}.od-ItemActivityTile-entity .od-Persona{overflow:hidden;display:inline-block}.od-ItemActivityTile-entity .od-Persona.od-Persona--lg .od-Persona-image{width:40px;height:40px;line-height:40px}.od-ItemActivityTile-entity .od-Persona-details{display:none}.od-ItemActivityTile-ellipsisWrapper{white-space:nowrap}.od-ItemActivityTile-ellipsis{white-space:nowrap;max-width:130px;overflow:hidden;text-overflow:ellipsis;display:inline-block;vertical-align:text-bottom}.od-ItemActivityTile-ellipsis:hover{cursor:pointer}"}]);var s=n(0),o=n("knockout-lib"),u=n(1651),a=n(1863),f=n(2885),l=n(2142),c=n(22),h=n(2075),p=n(2159),d=n(109),v=n(48),m=n(108),g=n(181),y=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({bindableHtml:a.e,scrollIntoView:l.e,toggle:h.e});n._navigation=n.resources.consume(m.e);n._platform=n.resources.consume(g.e);n.tile=t.activity;n._initObservables();n.accessibleLabel=n.createComputed(n._computeAccessibleLabel);n.expanded=o.observable(!1);n.isAggregate=!1;if(1===n.tile.type){n.isAggregate=!0;var r=n.tile;n.activities=r.activities}return n}t.prototype.onClick=function(e,t){if(e.navigateToOptions){this._navigation.navigateTo(e.navigateToOptions);var n={url:e.navigateToOptions.url,qosEventName:"RecentActivityItemLink",timeout:this._platform.isMobile?7e3:3e3};this._validateLink(n)}};t.prototype._validateLink=function(e){try{var t=new d.e({name:"NavigationLinkValidation"}),n=new XMLHttpRequest;n.open("GET",e.url,!0);e.timeout&&(n.timeout=e.timeout);n.onload=function(r){if(n.status>=200&&n.status<400){e.onComplete&&e.onComplete(n.status);t.end({resultType:v.e.Success,extraData:{source:e.qosEventName,httpCode:n.status}})}else{e.onError&&e.onError(n.status);t.end({resultCode:"LinkDoesNotExist",resultType:v.e.Failure,extraData:{source:e.qosEventName,httpCode:n.status}})}};n.ontimeout=function(n){e.onTimeout&&e.onTimeout();t.end({resultCode:"ValidationTimedOut",resultType:v.e.Failure,extraData:{source:e.qosEventName}})};n.send()}catch(n){e.onFailValidation&&e.onFailValidation();t.end({resultCode:"FailedToValidate",resultType:v.e.Failure,extraData:{source:e.qosEventName}})}};t.prototype._initObservables=function(){var e=this;if(1===this.tile.type){var t=this.tile;this.addDisposable(t.expanded.subscribe(function(t){e.expanded(t)}))}};t.prototype._computeAccessibleLabel=function(){var e,t=p.e(this,this.tile.headline),n=f;0===this.tile.index?0===this.tile.type?e=n.FirstActivityAccessibleLabel:1===this.tile.type&&(e=n.FirstAggregateAccessibleLabel):e=1===this.tile.type?n.AggregateAccessibleLabel:n.ActivityAccessibleLabel;return c.format(e,t,this.tile.date)};return t})(u.t),b=n(1652),w=(b.e({tagName:"ms-item-activity-tile",template:'<div class="od-ItemActivityTile-section" data-bind="css:{\'is-expanded\':expanded},scrollIntoView:{isSelected:tile.focused||expanded}"><div class="od-ItemActivityTile-sectionHeader ms-font-s" role="treeitem" data-bind="attr:{\'aria-label\':accessibleLabel,\'aria-expanded\':expanded,tabindex:tile.index===0?0:-1},css:{\'od-ItemActivityTile-sectionToggle\':isAggregate,\'od-ItemActivityTile-sectionFocused\':tile.focused},hasFocus:tile.focused,toggle:expanded">\x3c!--ko if:isAggregate--\x3e<i class="od-ItemActivityTile-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i>\x3c!--/ko--\x3e<div class="od-ItemActivityTile-entity" data-bind="component:{name:\'od-persona\',params:{person:tile.editor,showName:false,personaSize:$component.personaSize,showPresence:false}},attr:{\'aria-hidden\':true}"></div><div class="od-ItemActivityTile-details"><span data-bind="bindableHtml:tile.headline" class="od-ItemActivityTile-headline"></span><span data-bind="text:tile.date" class="od-ItemActivityTile-date ms-fontColor-neutralSecondary"></span></div></div>\x3c!--ko if:isAggregate--\x3e<div data-bind="foreach:{data:activities,as:\'activity\'}" role="group"><div class="od-ItemActivityTile-sectionContent" data-bind="css:{\'od-ItemActivityTile-sectionFocused\':activity.focused}"><ms-item-activity-tile params="activity: activity"></ms-item-activity-tile></div></div>\x3c!--/ko--\x3e</div>',viewModel:y,synchronous:!0}),n(52)),E=n(391),S=n(219),x=n(257),T=n(3443),N=(function(){function e(){var e=this;this.keyboardOptions=[{target:null,mappings:{Left:this.keyLeft,Right:this.keyRight,Enter:this.onEnter,Space:this.onSpace}},{target:window,mappings:{}}];this.focusableTiles=o.observableArray([]);this.focusedItem=o.observable();this.sectionHeaderFocus=o.observable(!1);this.sectionHeaderFocus.subscribe(function(t){!t&&e.focusedItem()&&e.focusedItem().focused(!1)})}e.prototype.keyRight=function(e,t){e.keyNav.trySetExpansion(!0);t.stopPropagation();return!0};e.prototype.keyLeft=function(e,t){e.keyNav.trySetExpansion(!1);t.stopPropagation();return!0};e.prototype.onEnter=function(e,t){e.keyNav.trySetExpansion();t.stopPropagation();return!0};e.prototype.onSpace=function(e,t){return e.keyNav.onEnter(e,t)};e.prototype.trySetExpansion=function(e){var t=this.focusedItem();if(t&&1===t.type){var n=t,r=n.expanded();n.expanded(void 0===e?!r:e);if(r!==e){var i=this.focusableTiles,o=i.indexOf(n)+1;if(o>0&&n.focused()){var u=n.activities;n.expanded()?i.splice.apply(i,Object(s.__spreadArrays)([o,0],u)):i.splice(o,u.length)}}}};return e})(),C=n(1649),k=n(974),L=n(996),A=n(76),O=n(3433),M=n(3434),_=n(3436),D=n(3437),P=n(3438),H=n(3439),B=n(3440),j=n(3441),F=n(3442),I=n(3435),q=n(608),R=n(11),U='<span class="ms-fontWeight-semibold">',z='<span class="od-ItemActivityTile-ellipsisWrapper">',W="</span>",X=(function(){function e(e,t){void 0===e&&(e={});this._userLoginName=t.identityDataSource.getIdentity().loginName}Object.defineProperty(e.prototype,"userLoginName",{get:function(){return this._userLoginName},enumerable:!1,configurable:!0});e.prototype.generateHeadline=function(e){var t=null;if(1===e.type){var n=e,r=this._encodeAggregate(n);t=this._generateAggregateHeadline(r)}else if(0===e.type){var i=e,s=this._encodeActivity(i);t=this.generateActivityHeadline(s)}return t};e.prototype.generateActivityHeadline=function(e){var t=this._encodeActivity(e),n=null,r=this._getEllipsisText(e,t.latestName),i=this._getEllipsisText(e,t.previousName,!0);this._isListItem="a list item"===e.latestName;switch(t.itemActivityChangeType){case 1:n=this._generateAddHeadline(t,r,i);break;case 2:n=this._generateCommentHeadline(t,r);break;case 3:n=this._generateEditHeadline(t,r);break;case 4:n=this._generateMoveHeadline(t,r);break;case 5:n=this._generateRemoveHeadline(t,r);break;case 6:n=this._generateRenameHeadline(t,r,i);break;case 7:n=this._generateRenameOrMoveHeadline(t,r);break;case 8:n=this._generateRestoreHeadline(t,r);break;case 9:n=this._generateShareHeadline(t,r);break;case 11:n=this._generateVersionHeadline(t,r);break;default:n=f.DataFetchError}return n};e.prototype._encodeAggregate=function(e){for(var t=new Array,n=0;n<e.editors.length;n++){var r=this._encodePerson(e.editors[n]);t.push(r)}var i=new Array;for(n=0;n<e.activities.length;n++){var s=this._encodeActivity(e.activities[n]);i.push(s)}return{activities:i,editors:t,date:e.date,itemActivityChangeType:e.itemActivityChangeType,type:e.type}};e.prototype._encodeActivity=function(e){var t=this._encodePerson(e.editor),n=e.sharedWith,r=new Array;if(n)for(var i=0;i<e.sharedWith.length;i++){var s=this._encodePerson(e.sharedWith[i]);r.push(s)}return{id:e.id,changeToken:q.e.encodeText(e.changeToken),editor:t,latestName:q.e.encodeText(e.latestName),latestFolder:q.e.encodeText(e.latestFolder),previousName:q.e.encodeText(e.previousName),previousFolder:q.e.encodeText(e.previousFolder),sharedWith:r,date:e.date,itemActivityChangeType:e.itemActivityChangeType,type:e.type,navigateToOptions:e.navigateToOptions}};e.prototype._encodePerson=function(e){return{userId:q.e.encodeText(e.userId),email:q.e.encodeText(e.email),name:q.e.encodeText(e.name)}};e.prototype._generateAddHeadline=function(e,t,n){var r=O;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?this._isListItem?c.format(r.AddListItemYou,U,W):c.format(r.AddItemYou,U,W,z,t,W):this._isListItem?c.format(r.AddListItem,U,e.editor.name,W):c.format(r.AddItem,U,e.editor.name,W,z,t,W):this._isListItem?r.AddListItemNoEditors:c.format(r.AddItemNoEditors,z,t,W)};e.prototype._generateCommentHeadline=function(e,t){var n=M;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?this._isListItem?c.format(n.CommentListItemYou,U,W):c.format(n.CommentItemYou,U,W,z,t,W):this._isListItem?c.format(n.CommentListItem,U,e.editor.name,W):c.format(n.CommentItem,U,e.editor.name,W,z,t,W):this._isListItem?n.CommentListItemNoEditors:c.format(n.CommentItemNoEditors,z,t,W)};e.prototype._generateVersionHeadline=function(e,t){var n=I;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?this._isListItem?c.format(n.VersionListItemYou,U,W):c.format(n.VersionItemYou,U,W,z,t,W):this._isListItem?c.format(n.VersionListItem,U,e.editor.name,W):c.format(n.VersionItem,U,e.editor.name,W,z,t,W):this._isListItem?n.VersionListItemNoEditors:c.format(n.VersionItemNoEditors,z,t,W)};e.prototype._generateEditHeadline=function(e,t){var n=_;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?this._isListItem?c.format(n.ListItemEditYou,U,W):c.format(n.EditYou,U,W,z,t,W):this._isListItem?c.format(n.ListItemEdit,U,e.editor.name,W):c.format(n.Edit,U,e.editor.name,W,z,t,W):this._isListItem?n.ListItemEditNoEditors:c.format(n.EditNoEditors,z,t,W)};e.prototype._generateMoveHeadline=function(e,t){var n=D,r=this._getEllipsisText(e,e.latestFolder),i=this._getEllipsisText(e,e.previousFolder,!0),s=!!e.latestFolder&&!!e.previousFolder,o=!e.latestFolder&&!!e.previousFolder,u=!!e.latestFolder&&!e.previousFolder;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?s?c.format(n.MoveFromToYou,U,W,z,t,W,z,i,W,z,r,W):o?c.format(n.MoveFromYou,U,W,z,t,W,z,i,W):u?c.format(n.MoveToYou,U,W,z,t,W,z,r,W):c.format(n.MoveYou,U,W,z,t,W):s?c.format(n.MoveFromTo,U,e.editor.name,W,z,t,W,z,i,W,z,r,W):o?c.format(n.MoveFrom,U,e.editor.name,W,z,t,W,z,i,W):u?c.format(n.MoveTo,U,e.editor.name,W,z,t,W,z,r,W):c.format(n.Move,U,e.editor.name,W,z,t,W):s?c.format(n.MoveFromToNoEditors,z,t,W,z,i,W,z,r,W):o?c.format(n.MoveFromNoEditors,z,t,W,z,i,W):u?c.format(n.MoveToNoEditors,z,t,W,z,r,W):c.format(n.MoveNoEditors,z,t,W)};e.prototype._generateRemoveHeadline=function(e,t){var n=P;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?this._isListItem?c.format(n.ListItemRemoveYou,U,W):c.format(n.RemoveYou,U,W,z,t,W):this._isListItem?c.format(n.ListItemRemove,U,e.editor.name,W):c.format(n.Remove,U,e.editor.name,W,z,t,W):this._isListItem?n.ListItemRemoveNoEditors:c.format(n.RemoveNoEditors,z,t,W)};e.prototype._generateRenameHeadline=function(e,t,n){var r=H;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?e.previousName?c.format(r.RenameFromToYou,U,W,z,n,W,z,t,W):c.format(r.RenameToYou,U,W,z,t,W):e.previousName?c.format(r.RenameFromTo,U,e.editor.name,W,z,n,W,z,t,W):c.format(r.RenameTo,U,e.editor.name,W,z,t,W):e.previousName?c.format(r.RenameFromToNoEditors,z,n,W,z,t,W):c.format(r.RenameToNoEditors,z,t,W)};e.prototype._generateRenameOrMoveHeadline=function(e,t){var n=B;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?c.format(n.RenameOrMoveYou,U,W,z,t,W):c.format(n.RenameOrMove,U,e.editor.name,W,z,t,W):c.format(n.RenameOrMoveNoEditors,z,t,W)};e.prototype._generateRestoreHeadline=function(e,t){var n=j;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?c.format(n.RestoreYou,U,W,z,t,W):c.format(n.Restore,U,e.editor.name,W,z,t,W):c.format(n.RestoreNoEditors,z,t,W)};e.prototype._generateShareHeadline=function(e,t){return e.editor&&e.editor.name?e.editor.email===this._userLoginName?this._generateYouSharedWith(e.sharedWith,t):this._generateSharedWith(e.editor,e.sharedWith,t):this._generateNoEditorSharedWith(e.editor,e.sharedWith,t)};e.prototype._generateNoEditorSharedWith=function(e,t,n){var r=F,i=null;switch(t.length){case 0:i=this._isListItem?r.ListItemShareNoEditors:c.format(r.ShareNoEditors,z,n,W);break;case 1:i=this._isListItem?c.format(r.ListItemShareWithNoEditorsOnePerson,t[0].name):c.format(r.ShareWithNoEditorsOnePerson,z,n,W,t[0].name);break;case 2:i=this._isListItem?c.format(r.ListItemShareWithNoEditorsTwoPersons,t[0].name,t[1].name):c.format(r.ShareWithNoEditorsTwoPersons,z,n,W,t[0].name,t[1].name);break;default:if(this._isListItem){var s=c.getLocalizedCountValue(r.ListItemShareWithNoEditorsMultiplePersons,r.ShareWithNoEditorsMultiplePersonsIntervals,t.length-2);i=c.format(s,t[0].name,t[1].name,String(t.length-2))}else{s=c.getLocalizedCountValue(r.ShareWithNoEditorsMultiplePersons,r.ShareWithNoEditorsMultiplePersonsIntervals,t.length-2);i=c.format(s,z,n,W,t[0].name,t[1].name,String(t.length-2))}}return i};e.prototype._generateSharedWith=function(e,t,n){var r=F,i=null;if(t)switch(t.length){case 0:i=this._isListItem?c.format(r.ListItemShareWithNoPersons,U,e.name,W):c.format(r.ShareWithNoPersons,U,e.name,W,z,n,W);break;case 1:i=this._isListItem?c.format(r.ListItemShareWithOnePerson,U,e.name,W,t[0].name):c.format(r.ShareWithOnePerson,U,e.name,W,z,n,W,t[0].name);break;case 2:i=this._isListItem?c.format(r.ListItemShareWithTwoPersons,U,e.name,W,t[0].name,t[1].name):c.format(r.ShareWithTwoPersons,U,e.name,W,z,n,W,t[0].name,t[1].name);break;default:if(this._isListItem){var s=c.getLocalizedCountValue(r.ListItemShareWithMultiplePersons,r.ShareWithMultiplePersonsIntervals,t.length-2);i=c.format(s,U,e.name,W,t[0].name,t[1].name,String(t.length-2))}else{s=c.getLocalizedCountValue(r.ShareWithMultiplePersons,r.ShareWithMultiplePersonsIntervals,t.length-2);i=c.format(s,U,e.name,W,z,n,W,t[0].name,t[1].name,String(t.length-2))}}else i=c.format(r.ShareWithNoPersons,U,e.name,W,z,n,W);return i};e.prototype._generateYouSharedWith=function(e,t){var n=F,r=null;if(e)switch(e.length){case 0:r=this._isListItem?c.format(n.ListItemShareWithNoPersonsYou,U,W):c.format(n.ShareWithNoPersonsYou,U,W,z,t,W);break;case 1:r=this._isListItem?c.format(n.ListItemShareWithOnePersonYou,U,W,e[0].name):c.format(n.ShareWithOnePersonYou,U,W,z,t,W,e[0].name);break;case 2:r=this._isListItem?c.format(n.ListItemShareWithTwoPersonsYou,U,W,e[0].name,e[1].name):c.format(n.ShareWithTwoPersonsYou,U,W,z,t,W,e[0].name,e[1].name);break;default:if(this._isListItem){var i=c.getLocalizedCountValue(n.ListItemShareWithMultiplePersonsYou,n.ShareWithMultiplePersonsYouIntervals,e.length-2);r=c.format(i,U,W,e[0].name,e[1].name,String(e.length-2))}else{i=c.getLocalizedCountValue(n.ShareWithMultiplePersonsYou,n.ShareWithMultiplePersonsYouIntervals,e.length-2);r=c.format(i,U,W,z,t,W,e[0].name,e[1].name,String(e.length-2))}}else r=this._isListItem?c.format(n.ListItemShareWithNoPersonsYou,U,W):c.format(n.ShareWithNoPersonsYou,U,W,z,t,W);return r};e.prototype._generateAggregateHeadline=function(e){var t=null,n=e.editors,r=_;if(3===e.itemActivityChangeType&&r)if(this._didYouEdit(e.editors))t=this._generateAggregateHeadlineYou(e);else switch(n.length){case 0:t=c.format(r.AggregateNoEditors);break;case 1:t=c.format(r.AggregateOneEditor,U,n[0].name,W);break;case 2:t=c.format(r.AggregateTwoEditors,U,n[0].name,W,U,n[1].name,W);break;default:var i=c.getLocalizedCountValue(r.AggregateMultipleEditors,r.AggregateMultipleEditorsIntervals,n.length-2);t=c.format(i,U,n[0].name,n[1].name,W,String(n.length-2))}else t=f.DataFetchError;return t};e.prototype._generateAggregateHeadlineYou=function(e){var t,n,r=this,i=_,s=null,o=e.editors;o.some(function(e){if(e.email===r._userLoginName){t=e;return!0}});if((n=o.indexOf(t))>-1){o.splice(n,1);o.unshift(t)}if(3===e.itemActivityChangeType&&i)switch(o.length){case 1:s=c.format(i.AggregateEditYou,U,W);break;case 2:s=c.format(i.AggregateTwoEditorsYou,U,W,U,o[1].name,W);break;default:var u=c.getLocalizedCountValue(i.AggregateMultipleEditorsYou,i.AggregateMultipleEditorsYouIntervals,o.length-2);s=c.format(u,U,o[1].name,W,String(o.length-2))}else s=f.DataFetchError;return s};e.prototype._getEllipsisText=function(e,t,n){return!e.navigateToOptions||n?'<span class="od-ItemActivityTile-ellipsis" title="'+t+'">'+t+"</span>":'<a class="od-ItemActivityTile-ellipsis" title="'+t+'" data-bind="event: { click: function(obj, ev) { return $data.onClick($data.tile, ev); } }">'+t+"</a>"};e.prototype._didYouEdit=function(e){var t=this;return e.some(function(e){return e.email===t._userLoginName})};e.dependencies={identityDataSource:A.S};return e})(),V=Object(R.s)("HeadlineGenerator",X),$=n(425),J=(function(e){Object(s.__extends)(t,e);function t(){var t=e.call(this)||this;t._headlineGenerator=t.resources.consume(V);return t}t.prototype.convertToTile=function(e,t){var n,r=e.relativeTime?Object(k.e)(e.relativeTime):Object(L.i)(e.date);if(1===e.type){for(var i=e,s=this._getMainEditor(i.editors),u=new Array,a=0,f=i.activities;a<f.length;a++){var l=f[a],c={date:l.date.toLocaleTimeString($.e.language,{hour:"numeric",minute:"2-digit"}),editor:l.editor,focused:o.observable(!1),headline:this._headlineGenerator.generateActivityHeadline(l),type:0,navigateToOptions:l.navigateToOptions};u.push(c)}n={activities:u,date:r,editor:s,expanded:o.observable(!1),focused:o.observable(!1),headline:this._headlineGenerator.generateHeadline(i),index:t,type:1}}else if(0===e.type){var h=e;n={date:r,editor:h.editor,focused:o.observable(!1),headline:this._headlineGenerator.generateActivityHeadline(h),index:t,type:0,navigateToOptions:h.navigateToOptions}}return n};t.prototype._getMainEditor=function(e){var t,n=this;e.some(function(e){var r=e.email===n._headlineGenerator.userLoginName;r&&(t=e);return r});!t&&e.length>0&&(t=e[0]);return t};return t})(C.n),K=(function(){function e(){}e.process=function(e){for(var t=new Array,n=0;n<e.length;n++)this._addActivity(e[n],t);var r=t.length;if(!(0===r)){var i=t[r-1];if(1===i.type){var s=i;s.activities.length>1?this._sort(s.activities):this._downgrade(s.activities,t)}}return t};e._addActivity=function(e,t){var n=t.length,r=0===n,i=!1,s=null;if(!r&&(i=(s=t[n-1]).itemActivityChangeType!==e.itemActivityChangeType||s.date.toDateString()!==e.date.toDateString())&&1===s.type){var o=s;o.activities.length>1?this._sort(o.activities):this._downgrade(o.activities,t)}if(3!==e.itemActivityChangeType)t.push(e);else if(r||i){var u=this._create(e);t.push(u)}else this._update(s,e)};e._downgrade=function(e,t){if(1===e.length){t.pop();t.push(e[0])}};e._sort=function(e){e.sort(function(e,t){return e.date.getTime()<t.date.getTime()?1:e.date.getTime()>t.date.getTime()?-1:e.changeToken.localeCompare(t.changeToken)})};e._create=function(e){var t=new Array;e.editor.name&&t.push(e.editor);var n=new Array;n.push(e);return{activities:n,date:e.date,relativeTime:e.relativeTime,editors:t,itemActivityChangeType:e.itemActivityChangeType,type:1}};e._update=function(e,t){e.editors.some(function(e){var n=!0;for(var r in t.editor)n=n&&t.editor[r]===e[r];return n})||e.editors.push(t.editor);e.itemActivityChangeType=t.itemActivityChangeType;e.activities.push(t)};return e})(),Q=n(1852),G=n(1662),Y=n(1744),Z=n(2109),ee=n(890),te=n(1674),ne=(function(e){Object(s.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this,i=r.observables,s=r.resources;r._item=t.item;var o=r.scope.attach(new(r.resources.consume(te.e))({canFallback:!0,ignoreSelection:!0}));r._currentItem=o.currentItem;r.addBindingHandlers({bindableHtml:a.e,keyboard:G.e,toggle:h.e,selection:Q.e});var u=s.consume(E.T.optional),f=r.resources.consume(E.e);r._showVersionHistoryAction=new(r.child(f.ShowVersionHistoryAction));r._itemActivityResults=i.create([]);r.isLoading=i.create(!0);r.loadingSpinnerFlatTagName=Y.e.tagName;r._helper=new(r.managed(J));r.sectionHelper=new(r.managed(Z.e))({shouldStartExpanded:!u||!u.peek()});r.keyNav=new N;var l=r.thisWeekCollection=i.createArray([]),p=r.lastWeekCollection=i.createArray([]),d=r.earlierCollection=i.createArray([]);r.resxStrings=T;r.hasChanges=i.pureCompute(r._computeHasChanges);r.showForEarlierChangesMsg=i.pureCompute(r._computeShowForEarlierChangesMsg);r.forEarlierChangesMsg=c.format(T.ForEarlierChanges,'<a href="#">',"</a>");r._activityComponents=null;r.showSeeMore=i.create(!1);r.seeMoreText=T.ActivitiesFeedShowMore;r.errorMessage=r.createObservable(null);var v=i.createArray([{title:T.ActivitiesFeedThisWeekListText,tiles:l},{title:T.ActivitiesFeedLastWeekListText,tiles:p},{title:T.ActivitiesFeedEarlierListText,tiles:d}]);r.tileCollections=r.addDisposable(v.filter(function(e){return e.tiles().length>0}));r._itemActivityQueryParams={add:!0,deleteObject:!0,fetchLimit:100,group:!0,item:!0,latestFirst:!0,move:!0,rename:!0,restore:!0,roleAssignmentAdd:!0,roleDefinitionAdd:!0,update:!0,user:!0};i.backgroundCompute(r._updateActivities);i.backgroundCompute(r._computeUpdateActivityComponents);return r}t.prototype.onFileVersionClick=function(e,t){this._showVersionHistoryAction.execute(t).done();return!1};t.prototype.onSeeMore=function(){var e=this;this.showSeeMore(!1);this.isLoading(!0);this.async.setTimeout(function(){e._generateCollectionsToRender(e._activityComponents,!0);e.isLoading(!1)},0);return!1};t.prototype._updateActivities=function(){var e=this,t=this._item();this.isLoading(!0);this.thisWeekCollection([]);this.lastWeekCollection([]);this.earlierCollection([]);this.keyNav.focusableTiles([]);this._activityComponents=null;var n=t.type===S.e.Folder&&t===this._currentItem.peek();this._getItemActivityDataSource().then(function(r){return r.getItemActivities(t,e._itemActivityQueryParams,n)}).done(function(t){e._itemActivityResults(t);e.errorMessage(null);e.isLoading(!1)},function(t){e.errorMessage(e.resxStrings.Error);e.isLoading(!1)})};t.prototype._computeHasChanges=function(){return 0!==this._itemActivityResults().length};t.prototype._computeUpdateActivityComponents=function(){if(this.hasChanges()){this._activityComponents=K.process(this._itemActivityResults());this._generateCollectionsToRender(this._activityComponents,!1)}};t.prototype._computeShowForEarlierChangesMsg=function(){var e=this._item(),t=this._itemActivityResults();return(e.type===S.e.File||!!e.appMap)&&(!this.hasChanges()||1!==t[t.length-1].itemActivityChangeType)&&!this.showSeeMore()&&this._showVersionHistoryAction.isAvailable()};t.prototype._generateCollectionsToRender=function(e,t){var n=[],r=[],i=[],s=[];this.showSeeMore(!1);if(e)for(var o=0;o<e.length;o++){var u=e[o],a=this._helper.convertToTile(u,o),f=u.date;(Object(x.h)(f)?n:Object(x.f)(f)?r:i).push(a);s.push(a);var l=o+1;if(!t&&6===l&&e.length>l){this.showSeeMore(!0);break}}this.thisWeekCollection(n);this.lastWeekCollection(r);this.earlierCollection(i);this.keyNav.focusableTiles(s)};t.prototype._getItemActivityDataSource=function(){var e=this,t=w.n.resolve(n.ee(["274"],4250)).then(ee.e).then(function(t){return new(e.managed(t))});this._getItemActivityDataSource=function(){return t};return t};t.dependencies=Object(s.__assign)({},u.t.dependencies);return t})(u.t),re=n(1653),ie=Object(b.e)({tagName:"ms-activities-feed",template:r,viewModel:ne,synchronous:!0}),se=Object(re.t)({automationName:"ms-activities-feed",name:"ActivitiesFeed",template:r,viewModelType:ne});t.e=ie},,,function(e,t,n){"use strict";n.d(t,"t",function(){return J});var r='<div class="InfoPane-section InfoPaneSection--properties" data-automationid="ms-properties-section" data-bind="css:{\'is-expanded\':sectionHelper.isExpanded,\'no-arrow\':!sectionHelper.showArrow}"><div class="InfoPane-sectionHeader" id="spo-Properties-sectionHeader" data-bind="toggle:sectionHelper.isExpanded,attr:{\'aria-expanded\':sectionHelper.isExpanded(),tabindex:sectionHelper.showArrow?0:-1,role:sectionHelper.showArrow?\'button\':\'\'}">\x3c!--ko if:sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i>\x3c!--/ko--\x3e\x3c!--ko if:isScheduling--\x3e<div class="InfoPane-sectionHeaderText" role="heading" aria-level="3" data-bind="text:clientFormTitle"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:isScheduling--\x3e<div class="InfoPane-sectionHeaderText" role="heading" aria-level="3" data-bind="text:clientFormTitle"></div>\x3c!--/ko--\x3e\x3c!--ko if:canEdit--\x3e<a class="spo-Properties-editLink" data-bind="click:onEditClick,clickBubble:false,text:clientFormEditLink" href="#"></a>\x3c!--/ko--\x3e</div><div class="InfoPane-sectionContent">\x3c!--ko if:isLoading--\x3e<div class="od-ClientFormFields-loadingSpinner" data-bind="component:{name:loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko if:propertiesErrorMessage--\x3e\x3c!--ko if:!propertiesFormFlight()--\x3e<div class="spo-Properties-sectionNotification" data-bind="component:{name:sectionNotificationTagName,params:{notificationText:propertiesErrorMessage,sectionNotificationIconAriaLabel:sectionNotificationIconLabel,notificationBackgroundCss:notificationBackgroundStyle}}"></div>\x3c!--/ko--\x3e\x3c!--ko if:propertiesFormFlight()--\x3e\x3c!--ko with:notificationSection()--\x3e\x3c!--ko component:$data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if:clientForm--\x3e<div class="spo-Properties-clientForm" data-bind="component:clientForm"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div></div>',i=n(138);Object(i.n)([{rawString:".InfoPaneSection--properties{width:100%;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.spo-Properties-editLink{line-height:26px;font-size:12px;color:"},{theme:"link",defaultValue:"#0078d4"},{rawString:";text-decoration:none}html[dir=ltr] .spo-Properties-editLink{float:right}html[dir=rtl] .spo-Properties-editLink{float:left}.ReactClientForm.is-bulkEdit{position:absolute;display:flex;top:64px;left:0;right:0;flex-direction:column;overflow:hidden;width:auto}.ReactClientForm.is-bulkEdit .ReactClientFormFields{overflow-y:auto;padding:0 16px;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";width:auto}.InfoPane .spo-Properties-clientForm .ReactClientForm.is-bulkEdit{top:116px}.od-DetailsPane-LegacySection .spo-Properties-clientForm .od-ClientForm.is-bulkEdit{top:64px}.od-DetailsPane-LegacySection .spo-Properties-clientForm .ReactClientForm .ReactClientForm-editButtons{padding-bottom:43px}.spo-Properties-sectionNotification{width:100%;overflow:auto}"}]);var s=n(0),o=n("knockout-lib"),u=n(1651),a=n(2503),f=n(2237),l=n(1672),c=n(2075),h=n(1744),p=n(1796);Object(i.n)([{rawString:".od-SectionNotification{padding:12px 6px;display:flex}.od-SectionNotification-Warning{background-color:"},{theme:"warningBackground",defaultValue:"#FFF4CE"},{rawString:"}.od-SectionNotification-Error{background-color:"},{theme:"errorBackground",defaultValue:"#FDE7E9"},{rawString:"}.od-SectionNotification-icon{padding-top:4px;font-size:14px}html[dir=ltr] .od-SectionNotification-icon{padding-right:4px}html[dir=rtl] .od-SectionNotification-icon{padding-left:4px}html[dir=ltr] .od-SectionNotification-icon{padding-left:2px}html[dir=rtl] .od-SectionNotification-icon{padding-right:2px}.od-SectionNotification-text{flex:1}"}]);var d=n(25),v=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.text=t.notificationText;n.iconClass=Object(d.C)(t.iconName||"Error");n.iconAriaLabel=t.sectionNotificationIconAriaLabel?t.sectionNotificationIconAriaLabel:"";n.backgroundCss=t.notificationBackgroundCss?t.notificationBackgroundCss:"";return n}return t})(u.t),m=n(1652),g=m.e({tagName:"ms-section-notification",template:'<div class="od-SectionNotification" data-bind="css:backgroundCss"><i class="od-SectionNotification-icon ms-Icon" role="img" data-bind="css:iconClass,attr:{\'aria-label\':iconAriaLabel}"></i><div class="od-SectionNotification-text"><span data-bind="text:text" role="status"></span></div></div>',viewModel:v,synchronous:!0}),y=n(46),b=n(329),w=n(52),E=n(62),S=n(48),x=n(29),T=n(1937),N=n(49),C=n(2380),k=n(1661),L=(function(){function e(){}e.getDialog=function(e,t,n){var r=null;return t.requestDialog({title:C.m,actions:[{name:C.d,icon:new k.e("Save"),execute:function(){null===r&&w.n.wrap(1);return r.processAndSaveChanges().then(function(e){return e?2:1})},isAvailable:o.observable(!0),isDefault:!1,automationId:"saveClientFormDialog"},{name:C.n,icon:new k.e("Cancel"),execute:function(){return w.n.wrap(3)},isAvailable:o.observable(!0),isDefault:!0,automationId:"cancelClientFormDialog"}],component:{name:Object(a.e)(n),params:{clientForm:e,interactiveSave:!1,fieldsManagerAccessor:function(e){r=e}}},size:"XLarge"})};return e})(),A=n(391),O=n(1664),M=n(76),_=n(1768),D=n(2181),P=n(1682),H=n(1674),B=n(888),j=n(13),F=(function(e){Object(s.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="EditItemAction";r._isFullPageApp=!!t.isFullPageApp;r._isBulkEdit=!!t.isBulkEdit;r._dialogProvider=r.resources.consume(P.e);r._itemParentHelper=r.resources.consume(l.e);r._itemCommandHelper=r.resources.consume(_.t);r._pageContext=r.resources.consume(N.h);r._actionMap=r.resources.consume(A.e);r._urlDataSource=r.resources.consume(M.ve);r._itemSelectionHelper=new(r.child(H.e))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this,t=this._itemSelectionHelper.firstItem(),n=t&&this.observables.unwrap(this._itemParentHelper.getFacetedAncestorOrSelf(t,"list"));return!(n&&n.list&&this._isBulkEdit&&(!j.e.isActivated("0F378815-7F92-48A5-B9E3-A127BEB75AC6","11/9/2020","disable bulk edit when list disableGridEditing is true")&&!0===n.list.disableGridEditing||this._itemSelectionHelper.selection().length<=1))&&(!!t&&!!n&&!!n.list&&n.list.templateType!==x.n.mySiteDocumentLibrary&&this._itemSelectionHelper.filterItems(function(t){return e._itemCommandHelper.isCommandSupported(t,D.t)&&E.e.hasItemPermission(t,E.e.editListItems)}))};t.prototype.onExecute=function(e,t){return Object(s.__awaiter)(this,void 0,w.n,function(){var t,n;return Object(s.__generator)(this,function(r){switch(r.label){case 0:return[4,this._itemSelectionHelper.resolveSelection()];case 1:if(!(t=r.sent())||!t.length)return[2,w.n.resolve({resultCode:"EmptySelection",resultType:S.e.Failure})];this.resources.consume(B.e).logData({name:"EditItem",isIntentional:!0,extraData:{isBulkEdit:t.length>1}});n=t[0];return t.length>1?[2,this._editInFullPageClientForm(n,e,!0)]:T.e.isCheckedOutByOther(n,this._pageContext.userId)?[2,T.e.showCheckedOutByOtherDialog(this._dialogProvider)]:[2,this._editInFullPageClientForm(n,e)]}})})};t.prototype._editInFullPageClientForm=function(e,t,n){return this._actionMap||n?new(this.managed(this._actionMap.LaunchListFormAction))({type:1,item:e,selection:n?this._itemSelectionHelper.selection():void 0,url:this._urlDataSource.getEditFormUrl(e),isFullPageApp:this._isFullPageApp}).execute(t):this._editInClientFormDialog(e)};t.prototype._editInClientFormDialog=function(e){var t=this;return this.resources.consume(f.resourceKey).getClientForm({item:this.observables.create(e),clientFormType:1,contentType:e.properties.ContentType}).then(function(e){var n=t.resources.consume(P.e);return L.getDialog(e,n,t.resources).wait()}).then(function(){return{resultType:S.e.Success}})};return t})(O.e),I=n(219),q=n(22),R=n(2109),U=n(1499),z=n(2788),W=n(70),X=(function(e){Object(s.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r._buildSectionNotification=function(){r.notificationSection({name:r.sectionNotificationTagName,params:{notificationText:r._computePropertiesErrorMessage(),sectionNotificationIconAriaLabel:r._computeNotificationIconAriaLabel(),notificationBackgroundCss:r._computeMessageSeverity()}})};r._handleRefreshClientForm=function(){r._refreshClientForm(!1);r._updateProperties(!0)};r._handleHasMissingMetaDataCallBack=function(e){r.hasMissingMetadata(e);r._buildSectionNotification()};r.sectionHelper=new(r.managed(R.e));r.loadingSpinnerTagName=h.e.tagName;r.clientFormEditLink=p.clientFormEditLink;r.sectionNotificationTagName=g.tagName;r._isScheduling=t.isScheduled;r.propertiesFormFlight=o.observable(Object(y.isFeatureEnabled)(y.PropertiesFormConnector));var i=r,s=i.observables,u=i.resources,a=n.itemParentHelper,d=void 0===a?u.consume(l.e):a,v=n.clientFormProvider,m=void 0===v?u.consume(f.resourceKey):v,w=n.itemSelectionHelperType,E=void 0===w?u.consume(H.e):w,S=n.itemProvider,x=void 0===S?u.consume(U.resourceKey):S,T=n.rumOneHelper,N=void 0===T?u.consume(b.e):T;r._itemParentHelper=d;r._itemSelectionHelper=new(r.scope.attached(E))({allowMultiSelect:!0,canFallback:!0});r._itemProvider=x;r._editItemAction=new(r.managed(F))({item:r._itemSelectionHelper.firstItem});r._isDocLib=s.pureCompute(r._computeIsDocLib);r.clientForm=s.create();r.notificationSection=s.create();r._serverError=s.create();r.canEdit=s.pureCompute(r._computeCanEdit);r.isLoading=s.pureCompute(r._computeIsLoading);r.hasMissingMetadata=o.observable(r._computeHasMissingMetadata());r.notificationBackgroundStyle=s.compute(r._computeMessageSeverity);r.sectionNotificationIconLabel=s.compute(r._computeNotificationIconAriaLabel);r.propertiesErrorMessage=s.pureCompute(r._computePropertiesErrorMessage);r.clientFormTitle=s.pureCompute(r._computeTitle);r._useDocSetsModernView=Object(y.isFeatureEnabled)(y.DocumentSetsModernView)&&Object(y.isFeatureEnabled)(y.UseItemsScopeInTeamSites);r.addBindingHandlers({toggle:c.e});r._rumOneHeler=N;r._clientFormProvider=m;s.compute(r._updateProperties);r._refreshClientForm=r.resources.consume(z.e);r.scope.attach(r._refreshClientForm.subscribe(r._handleRefreshClientForm));r.isScheduling=s.wrap(r._isScheduling);r.sectionNotificationIconLabel=s.compute(r._computeNotificationIconAriaLabel);return r}t.prototype.onEditClick=function(e){this._editItemAction.execute(e)};Object.defineProperty(t.prototype,"_item",{get:function(){return this._itemSelectionHelper.firstItem},enumerable:!1,configurable:!0});t.prototype._computeTitle=function(){if(this._isScheduling)return p.Scheduling;var e=this._itemSelectionHelper.selection();return e&&e.length>1?p.bulkEditClientFormTitle:p.clientFormTitle};t.prototype._computeIsLoading=function(){return!this._serverError()&&!this.clientForm()&&!this._isQuickEditDisabled()};t.prototype._computeCanEdit=function(){return!this._serverError()&&this._editItemAction&&this._editItemAction.isAvailable()&&!this._isBulkEdit()&&!this._isScheduling};t.prototype._computeIsDocLib=function(){var e=this._item(),t=e&&this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));return!t||!t.list||!!t.list.isDocumentLibrary};t.prototype._computePropertiesErrorMessage=function(){if(this._isScheduling)return"";var e=this._serverError();if(e){var t=e&&e.message&&(e.message.value||e.message);return t?q.format(p.propertiesNotificaiton_serverErrorWithDetails,t):p.propertiesNotificaiton_serverErrorNoDetails}var n=this._item();if(n&&n.type!==I.e.Folder){if(this.hasMissingMetadata()){if(this._isDocLib()){var r=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(n,"list"));return r&&r.list&&(119===r.list.templateType||850===r.list.templateType)?p.propertiesNotificaiton_missingMetadata_page:p.propertiesNotificaiton_missingMetadata_file}return p.propertiesNotificaiton_missingMetadata_item}if(this._isDocLib())return""}return""};t.prototype._computeMessageSeverity=function(){return Object(y.isFeatureEnabled)(y.PagesRequiredProperties)&&this.hasMissingMetadata()&&this._isPagesLibrary?"od-SectionNotification-Error":"od-SectionNotification-Warning"};t.prototype._computeNotificationIconAriaLabel=function(){var e=this.hasMissingMetadata();return Object(y.isFeatureEnabled)(y.PagesRequiredProperties)&&e&&this._isPagesLibrary?p.sectionNotificationIconAriaLabelError:p.sectionNotificationIconAriaLabelWarning};Object.defineProperty(t.prototype,"_isPagesLibrary",{get:function(){var e=this._item(),t=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")),n=t&&t.list&&(119===t.list.templateType||850===t.list.templateType);return Boolean(n)},enumerable:!1,configurable:!0});t.prototype._computeHasMissingMetadata=function(){var e=this._item(),t=!1;if(e){var n=this.clientForm(),r=n&&n.params.clientForm;t=e.hasMissingMetadata;if(r&&r.contentType)for(var i=r.contentTypeId===e.properties.ContentTypeId,s=0,o=r.fields;s<o.length;s++){var u=o[s];if(u&&u.schema){var a=u.schema;if(a.Required&&e.properties&&!e.properties[a.Name]&&i){t=!0;break}}}}return!!t};t.prototype._updateProperties=function(e){var t=this,n=this._isBulkEdit(),r=this._itemSelectionHelper.selection.peek(),i=this._item.peek();this.hasMissingMetadata(this._computeHasMissingMetadata());if(i&&this._lastUpdateClientFormParams&&this._lastUpdateClientFormParams.isBulkEdit===n&&!e)if(n){var s=this._clientFormProvider.getContentInfoTypes(this._lastUpdateClientFormParams),o=this._getClientFormParms(this._item,n,r),u=this._clientFormProvider.getContentInfoTypes(o);if(s.length===u.length){for(var f=!1,l=0;l<s.length;l++)if(s[l].contentType!==u[l].contentType||s[l].contentTypeId!==u[l].contentTypeId){f=!0;break}if(!f)return}}else if(i.properties&&this._lastUpdateClientFormParams&&this._lastUpdateClientFormParams.item&&this._lastUpdateClientFormParams.item.peek().properties&&i.properties.ID===this._lastUpdateClientFormParams.item.peek().properties.ID&&null!==this.clientForm.peek())return;n||(this._editItemAction=new(this.managed(F))({item:this._item}));this._rumOneHeler&&this._rumOneHeler.logPropertiesPaneUpdate();this.clientForm(void 0);this._serverError(void 0);this.async.setImmediate(function(){var n=t._item.peek(),i=t._isBulkEdit();if(n){t._lastUpdateClientFormParams=t._getClientFormParms(t._item,i,r);Object(y.isFeatureEnabled)(y.PropertiesFormConnector)?t.clientForm({name:Object(a.e)(t.resources,!0),params:{item:t._item,interactiveSave:!i,isInfoPane:!0,clientFormType:1,isReadOnly:!i&&t._isQuickEditDisabled(),isScheduling:t._isScheduling,isRenderingShowHideColumnsPanelBtn:!0,hasMissingMetadata:t._handleHasMissingMetaDataCallBack}}):t._clientFormProvider.getClientForm(t._lastUpdateClientFormParams,e).done(function(e){var n=i?"BulkEditForm.Render":"EditForm.Render";t.resources.consume(B.e).logData({name:n,isIntentional:!0});t.clientForm({name:Object(a.e)(t.resources),params:{clientForm:e,interactiveSave:!i,isInfoPane:!0,isReadOnly:!i&&t._isQuickEditDisabled(),suppressDefaultSaveBehavior:!0,isScheduling:t._isScheduling,isRenderingShowHideColumnsPanelBtn:!0}})},function(e){t._serverError(e)})}else t._lastUpdateClientFormParams=void 0})};t.prototype._isQuickEditDisabled=function(){for(var e=this._item&&this._item.peek(),t=!1;e;){if(e.list){t=!!e.list.disableGridEditing;break}e=e.parent}if(!t&&!this._useDocSetsModernView){t=!this._itemSelectionHelper.selection.peek().length}return!!t};t.prototype._isBulkEdit=function(){var e=this._itemSelectionHelper.selection();return e&&e.length>1};t.prototype._getClientFormParms=function(e,t,n){var r=e.peek().key,i=W.t.isActivated("CC02E6AD-D6A0-4FF6-909A-65F6A13FC0D6","3/17/2021","Bind form to properties of specific item")?e:this._itemProvider.getItemSync({parentKey:r}).item,s=i.peek().properties;return{clientFormType:1,item:i,contentType:s.ContentType,contentTypeId:s.ContentTypeId,isBulkEdit:t,selection:n}};t.dependencies=Object(s.__assign)(Object(s.__assign)({},u.t.dependencies),{itemParentHelper:l.e,itemProvider:U.resourceKey,clientFormProvider:f.resourceKey,itemSelectionHelperType:H.e,rumOneHelper:b.e});return t})(u.t),V=n(1653),$=Object(m.e)({tagName:"ms-properties-section",template:r,viewModel:X,synchronous:!0}),J=Object(V.t)({automationName:"ms-properties-section",name:"PropertiesSection",template:r,viewModelType:X});t.e=$},,,function(e,t,n){"use strict";n.d(t,"t",function(){return J});var r='\x3c!--ko if:!sharingApiErrorMessage()--\x3e<div class="od-SharingSection-PermissionsPile" role="group" data-bind="attr:{\'aria-label\':sharingSectionSummary}"><div class="InfoPane-sectionHeader"><div class="InfoPane-sectionHeaderText" data-bind="text:strings.sharingHasAccess"></div></div>\x3c!--ko if:isLoading()--\x3e<div class="SharingSection-status" data-bind="text:statusText"></div>\x3c!--/ko--\x3e\x3c!--ko if:!isLoading()--\x3e<div class="od-SharingSection-PermissionsPile-personas">\x3c!--ko if:isShareLinkVisible--\x3e<div class="od-Persona od-Persona--xs"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder" role="button" tabindex="0" data-bind="tooltip:{content:addPeopleText},keyboard:{Enter:onShareClick,Space:onShareClick},click:onShareClick,attr:{\'aria-label\':addPeopleScreenReaderText,disabled:disabledPermissionsPanelActions,\'aria-disabled\':disabledPermissionsPanelActions}"><div class="od-SharingSection-PermissionsPile-addFriend"><i class="ms-Icon ms-Icon--AddFriend" data-bind="icon:true"></i></div></div>\x3c!--ko if:shareCalloutActive()--\x3e<div data-bind="react:{componentType:shareCalloutComponent,props:shareCalloutProps}"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if:!privateDescription()--\x3e<div class="od-PermissionPile-accessibleLabel" data-bind="text:accessSummaryScreenReaderText"></div><ul class="od-PermissionPile-FacePile">\x3c!--ko foreach:permissionsFacepileCollection--\x3e\x3c!--ko if:linkNum--\x3e<li class="od-Persona od-Persona--xs"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder" role="button" tabindex="0" data-bind="tooltip:{content:$parent.linksDetails()},keyboard:{Enter:$parent.launchPermissionsPanel.bind($component),Space:$parent.launchPermissionsPanel.bind($component)},click:$parent.launchPermissionsPanel.bind($component),attr:{\'aria-label\':screenReadText,setsize:$parent.totalFacePileCount(),posinset:index+1}"><div class="od-SharingSection-PermissionsPile-personaIcon" data-bind="css:{\'od-SharingSection-PermissionsPile-personaIcon--many\':$parent.hasMultiLinks()}"><i class="ms-Icon ms-Icon--Link" data-bind="icon:true"></i>\x3c!--ko if:linkNum>1--\x3e<div class="od-SharingSection-PermissionsPile-numberText" data-bind="text:linkNum.toString()"></div>\x3c!--/ko--\x3e</div></div></li>\x3c!--/ko--\x3e\x3c!--ko if:groupNum>1--\x3e<li class="od-Persona od-Persona--xs"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder" role="button" tabindex="0" data-bind="tooltip:{content:$parent.groupsDetails()},keyboard:{Enter:$parent.launchPermissionsPanel.bind($component),Space:$parent.launchPermissionsPanel.bind($component)},click:$parent.launchPermissionsPanel.bind($component),attr:{\'aria-label\':screenReadText}"><div class="od-SharingSection-PermissionsPile-personaIcon" data-bind="css:{\'od-SharingSection-PermissionsPile-personaIcon--many\':groupNum>1}"><i class="ms-Icon ms-Icon--Group" data-bind="icon:true"></i><div class="od-SharingSection-PermissionsPile-numberText" data-bind="text:groupNum"></div></div></div></li>\x3c!--/ko--\x3e\x3c!--ko if:personaTile&&(!groupNum||groupNum===1&&!$parent.showPermissionsPanel())--\x3e<li class="od-Persona od-Persona--xs"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder" role="button" tabindex="0" data-bind="tooltip:{content:personaTile.personaParams.person().name},keyboard:{Enter:$parent.launchPermissionsPanel.bind($component),Space:$parent.launchPermissionsPanel.bind($component)},click:$parent.launchPermissionsPanel.bind($component),attr:{\'aria-label\':screenReadText}"><div class="od-PersonaTile-Persona" data-bind="component:{name:\'od-persona\',params:personaTile.personaParams}"></div></div></li>\x3c!--/ko--\x3e\x3c!--ko if:extraPersona--\x3e<li class="od-Persona od-Persona--xs"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder" role="button" tabindex="0" data-bind="tooltip:{content:$parent.extraPersonaTooltipText},keyboard:{Enter:$parent.launchPermissionsPanel.bind($component),Space:$parent.launchPermissionsPanel.bind($component)},click:$parent.launchPermissionsPanel.bind($component),attr:{\'aria-label\':screenReadText}"><div class="od-SharingSection-PermissionsPile-personaMore"><div class="od-SharingSection-PermissionsPile-moreNumber" data-bind="text:$parent.extraPersonaText"></div></div></div></li>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</ul>\x3c!--/ko--\x3e\x3c!--ko if:privateDescription()&&!hasInheritedLink()&&isNewHasAccessControlEnable--\x3e<ul class="od-PermissionPile-FacePile od-PermissionPile-Unshared"><li class="od-Persona od-Persona--xs od-Pointer"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder"><i data-bind="icon:true" class="ms-Icon ms-Icon--Lock"></i></div></li><li class="od-Persona od-Persona--xs od-HasAccessControl od-Pointer"><div class="od-SharingSection-PermissionsPile-descriptionText" data-bind="text:privateDescription"></div></li></ul>\x3c!--/ko--\x3e</div>\x3c!--ko if:privateDescription()&&!hasInheritedLink()&&!isNewHasAccessControlEnable--\x3e<div class="od-SharingSection-PermissionsPile-description"><i class="ms-Icon ms-Icon--Lock" data-bind="icon:true"></i><div class="od-SharingSection-PermissionsPile-descriptionText" data-bind="text:privateDescription"></div></div>\x3c!--/ko--\x3e\x3c!--ko if:hasGuest--\x3e<div class="od-SharingSection-PermissionsPile-description"><i class="ms-Icon ms-Icon--Globe" data-bind="icon:true"></i><div class="od-SharingSection-PermissionsPile-descriptionText" data-bind="text:sharedWithGuestText"></div></div>\x3c!--/ko--\x3e\x3c!--ko if:isShortcut--\x3e<div data-bind="react:{componentType:manageAccessLinkComponent,props:manageAccessLinkProps}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:isShortcut()||isVault()--\x3e<div class="od-SharingSection-ManageAccessLink"><button class="od-SharingSection-ManageAccessLink-Button" data-bind="click:launchPermissionsPanel,attr:{\'aria-label\':showPermissionsPanelTooltipText,title:showPermissionsPanelTooltipText,disabled:disabledPermissionsPanelActions,\'aria-disabled\':disabledPermissionsPanelActions}"><span data-bind="text:showPermissionsPanelHintText"></span></button></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e',i=(n(2382),n(2049),n(2814),n(0)),s=n(888),o=n(1863),u=n(391),a=n(1796),f=n(22),l=n(2075),c=n(1749),h=n(1651),p=n(2131),d=n(1969),v=n(2483),m=n("knockout-lib"),g=(function(){function e(e){this.focused=m.observable(!1);this.index=e.key;this.linkNum=e.linkNum;this.groupNum=e.groupNum;this.personaTile=e.personaTile;this.extraPersona=e.extraPersona;this.screenReadText=e.screenReadText;this._disablePictureAlt()}e.prototype._disablePictureAlt=function(){this.personaTile&&(this.personaTile.personaParams.disablePictrueAlt=!0)};return e})(),y=n(1662),b=n(2605),w=n(1852),E=n(1663),S=n(1830),x=n(1964),T=n(1794),N=n(1819),C=n(2036),k=n(1439),L=n(1646),A=n(2262),O=n("react-lib"),M=(function(e){Object(i.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props.calloutProps,t=this.props.shareProps;return O.createElement(k.e,Object(i.__assign)({},e),O.createElement(L.e,{isClickableOutsideFocusTrap:!0},O.createElement(A.e,Object(i.__assign)({onDismiss:e.onDismiss},t))))};return t})(O.Component),_=n(97),D=n(46),P=n(2367),H=n(2220),B=n(1077),j=n(1131),F=n(1003),I=n(18),q=n(138);Object(q.n)([{rawString:".od-SharingSection-manageAccess{cursor:pointer}"}]);function R(e){var t=e.resources.consume(F.e);return O.createElement(B.e,{store:t},O.createElement(I.n,{action:O.createElement(j.ManageAccessAction,null)},function(e){e.isAvailable;var t=e.execute,n=function(){t()};return O.createElement("div",{className:"od-SharingSection-manageAccess","data-is-focusable":!!n,onClick:n,tabIndex:0},O.createElement("a",{className:"ms-font-s"},a.sharingOpenPermissionsPanelHintText))}))}var U=n(2828),z=n(2217),W=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.personaTileTagName=b.e.tagName;r.panelOverlayTagName=p.e.tagName;r.dialogHostTagName=d.e.tagName;r.addBindingHandlers({toggle:l.e,bindableHtml:o.e,keyboard:y.e,selection:w.e,tooltip:c.e,react:E.t});r._engagement=r.resources.consume(s.e);var i=r.resources.consume(z.e),h=r.observables;r.permissionsFacepileCollection=h.createArray();r.infoPanePersonaTileCollection=h.createArray([]);r.groupPersonaTileCollection=h.createArray([]);r.peoplePersonaTileCollection=h.createArray([]);r.isExpanded=r.resources.consume(u.T.optional)||h.create(!0);r.strings=a;r.hasFocus=t.hasFocus;r.openPanelActionText=a.openPanel;r.advancedText=a.advanced;r.stopSharingText=a.stopSharing;r.emailText=a.emailEveryone;r.showPermissionsPanel=h.create(!1);r.shouldShowLinks=h.create(!1);r.hasMultiLinks=h.create(!1);r.linksDetails=h.create("");r.groupsDetails=h.create("");r.numberOfGroups=h.create(0);r.totalFacePileCount=h.create(0);r.extraPersonaTooltipText=h.create("");r.addPeopleText=h.pureCompute(function(){return i()?f.format(a.OfflineCommandFormat,a.addPeople):a.addPeople});r.addPeopleScreenReaderText=h.pureCompute(function(){return i()?f.format(a.OfflineCommandFormat,a.addPeopleButtonName):a.addPeopleButtonName});r.disabledPermissionsPanelActions=h.pureCompute(function(){return i()});r.showPermissionsPanelTooltipText=h.pureCompute(function(){return i()?f.format(a.OfflineCommandFormat,a.sharingOpenPermissionsPanelHintText):a.sharingOpenPermissionsPanelHintText});r.showPermissionsPanelHintText=a.sharingOpenPermissionsPanelHintText;r.extraPersonaText=h.create("");r.extraPersonaNumber=h.create(0);r.sharedWithGuestText=a.sharingGuestShared;r.permissionsPanelName=a.sharingPermissionsPanelName;r.isAddPeopleInReactEnabled=Object(D.isFeatureEnabled)(D.AddPeopleReact);r.shareCalloutComponent=M;r.shareCalloutProps=r.createPureComputed(r._computeShareCalloutComponentProps);r.manageAccessLinkComponent=R;r.manageAccessLinkProps=r.createObservable({resources:r.resources});r.shareCalloutTarget=h.create(null);r.shareCalloutActive=h.create(!1);var m=t.item;r.item=m;r.isVault=h.pureCompute(function(){return!!r.item().vault});var g=r._sharingSectionHelper=new(r.managed(v.e))({item:m,hasFocus:t.hasFocus});r.fileName=g.fileName;r.accessSummaryScreenReaderText=h.pureCompute(r._setAccessSummary);r.sharingSectionSummary=h.pureCompute(function(){return f.format(a.sharingSectionSummary,r.fileName())});r.privateDescription=g.privateDescription;r.hasInheritedLink=g.hasInheritedLink;r.isShareLinkVisible=g.isShareLinkVisible;r.isShortcut=r.createComputed(r._computeIsShortcut);r.isLoading=g.isLoading;r.scopes=g.scopes;r.links=g.links;r.canUnshare=g.canUnshare;r.personaTileCollection=g.personaTileCollection;r.hasSettings=g.hasSettings;r.advancedUrl=g.advancedUrl;r.keyNav=g.keyNav;r.mailto=g.mailto;r.showEmailLink=g.showEmailLink;r.sharingApiErrorMessage=g.sharingApiErrorMessage;r._totalNumberOfLinks=g.totalNumberOfLinks;r.statusText=g.statusText;r.hasGuest=r.createPureComputed(r._calculateExternalUser);r.accessSummaryScreenReaderText=h.pureCompute(r._setAccessSummary);r.sharingSectionSummary=h.pureCompute(function(){return f.format(a.sharingSectionSummary,r.fileName())});r._actionMap=r.resources.consume(u.e);r._showAction=new(r.managed(r._actionMap.ShowPermissionsAction))({item:m,engagementSource:"InfoPane"});r.isNewHasAccessControlEnable=Object(D.isFeatureEnabled)(D.EnableNewHasAccessControl);h.compute(r._computeSparateGroupAndPeoplePersona);h.compute(r._calculateExtraPersona);h.compute(r._updateLinksData);return r}t.prototype.launchPermissionsPanel=function(e,t){if(!this.disabledPermissionsPanelActions()){this._engagement.logData({name:"ViewPermission.Sharing.InfoPaneSection.Click",isIntentional:!0});this._executeShowPermissionsPanel(t)}};t.prototype.closeDialog=function(){this.onLinkRemoved()};t.prototype.onScopeClick=function(e){this._sharingSectionHelper.onScopeClick(e.scope.item)};t.prototype.onShareClick=function(e,t){if(!this.disabledPermissionsPanelActions()){this._engagement.logData({name:"AddPeopleFromInfoPane.Sharing.InfoPaneSection.Click",isIntentional:!0});if(this.isAddPeopleInReactEnabled){this.shareCalloutTarget(t.target);this.shareCalloutActive(!0)}else this._sharingSectionHelper.onShareClick()}};t.prototype.onLinkRemoved=function(){this._sharingSectionHelper.onLinkRemoved()};t.prototype.onAdvancedClick=function(){this._engagement.logData({name:"AdvancedSettings.Sharing.InfoPaneSection.Click",isIntentional:!0});return!0};t.prototype.stopSharing=function(){this._sharingSectionHelper.stopSharing()};t.prototype.clickEmail=function(){this._engagement.logData({name:"EmailEveryone.Sharing.InfoPaneSection.Click",isIntentional:!0});return!0};t.prototype.moreThanOneLink=function(){return this._totalNumberOfLinks()>1};t.prototype._updateLinksData=function(){var e=this._totalNumberOfLinks();this.linksDetails(this._getLinksDetails());var t=0!==e;this.shouldShowLinks(t);var n=e>1;this.hasMultiLinks(n)};t.prototype._getLinksDetails=function(){return this._totalNumberOfLinks()>1?f.format(a.sharingLinkTitleMulti,this._totalNumberOfLinks()):a.sharingLinkTitleSingle};t.prototype._executeShowPermissionsPanel=function(e){this._showAction.execute(e).done()};t.prototype._computeIsShortcut=function(){return!!this.item().remoteItem};t.prototype._computeSparateGroupAndPeoplePersona=function(){var e=this.personaTileCollection(),t=[],n=[];if(!this.showPermissionsPanel())for(var r=0,i=e;r<i.length;r++){var s=i[r];2===s.personaParams.person().entityType?t.push(s):n.push(s)}this.groupPersonaTileCollection(t.slice());this.peoplePersonaTileCollection(n);this.numberOfGroups(t.length);this.groupsDetails(this._getGroupsDetails())};t.prototype._getGroupsDetails=function(){return this.numberOfGroups()>1?f.format(a.sharingGroupTitleMulti,this.numberOfGroups()):a.sharingGroupTitleSingle};t.prototype._getAllUsers=function(e){for(var t={},n=0,r=e;n<r.length;n++){t[(f=r[n]).personaParams.person().userId]=!0}for(var i=0,s=this.links();i<s.length;i++){var o=s[i];if(o.linkMembers)for(var u=0,a=o.linkMembers;u<a.length;u++){var f,l=a[u],c=(f=this._sharingSectionHelper.convertPersonToPersonaTile(this.createObservable(l),l.userId)).personaParams.person.peek().userId;if(!t[c]){t[c]=!0;e.push(f)}}}return e};t.prototype._calculateExternalUser=function(){for(var e=0,t=this.peoplePersonaTileCollection();e<t.length;e++){if(t[e].personaParams.person().isExternal)return!0}for(var n=0,r=this.links();n<r.length;n++){var i=r[n];if(5===i.kind||4===i.kind)return!0;for(var s=0,o=i.linkInvitees;s<o.length;s++){if(o[s].isExternal)return!0}}return!1};t.prototype._calculateExtraPersona=function(){var e=(0===this._totalNumberOfLinks()?0:1)+(0===this.numberOfGroups()?0:1),t=this._getAllUsers(this.peoplePersonaTileCollection()),n=t.length,r=0;if(1+e+t.length>7){n=7-e-2;r=6}else r=e+t.length;var i=t.length-n;this.extraPersonaNumber(i);i>=99?this.extraPersonaText(a.sharingExtraNumberOverflow):this.extraPersonaText(f.format(a.sharingExtraNumberText,i));this.extraPersonaTooltipText(f.format(a.sharingMoreTitle,i));this.infoPanePersonaTileCollection(t.slice(0,n));this.totalFacePileCount(r);this._setFacepileContent()};t.prototype._setAccessSummary=function(){var e=this._totalNumberOfLinks()+" "+f.getLocalizedCountValue(a.sharinglocTextLink,a.sharingIntervals,this._totalNumberOfLinks());e+=" "+this.numberOfGroups()+" "+f.getLocalizedCountValue(a.sharinglocTextGroup,a.sharingIntervals,this.numberOfGroups());for(var t=0,n=this.infoPanePersonaTileCollection();t<n.length;t++){e+=" "+n[t].personaParams.person().name}this.extraPersonaNumber()&&(e+=" "+f.format(a.sharingAccessSummaryMore,this.extraPersonaNumber()));this.hasGuest()?e+=" "+f.format(a.sharingAccessSummarySharedWithGuest,this.fileName()):this.privateDescription()&&(e+=" "+a.sharingAccessSummaryNotShared);return e};t.prototype._setFacepileContent=function(){var e=0,t=[],n=this.infoPanePersonaTileCollection();if(this.shouldShowLinks()){var r=f.format(a.sharingLinksScreenRead,this.linksDetails(),this.fileName()),i=new g({key:e,linkNum:this._totalNumberOfLinks(),screenReadText:this.createObservable(r)});t.push(i);e++}if(this.numberOfGroups()){var s=f.format(a.sharingGroupsScreenRead,this.groupsDetails(),this.fileName()),o=new g({key:e,groupNum:this.numberOfGroups(),screenReadText:this.createObservable(s),personaTile:this.groupPersonaTileCollection()[0]});t.push(o);e++}for(var u=0,l=n;u<l.length;u++){var c=l[u],h=c.personaParams.person().name,p=f.format(a.sharingPersonaScreenRead,h,this.fileName()),d=new g({key:e,screenReadText:this.createObservable(p),personaTile:c});t.push(d);e++}if(this.extraPersonaNumber()){var v=f.format(a.sharingExtraPeopleScreenRead,this.extraPersonaNumber().toString()),m=new g({key:e,extraPersona:this.extraPersonaNumber(),screenReadText:this.createObservable(v)});t.push(m);e++}this.permissionsFacepileCollection(t)};t.prototype._computeShareComponentProps=function(){var e,t=this.resources.consume(x.e),n=this.resources.consume(T.resourceKey),r=this.resources.consume(N.resourceKey),i=this.resources.consume(C.e);e=Object(D.isFeatureEnabled)(D.LivePersonaPickerEnabled)?new S.e({},{dataSource:this.resources.consume(U.e)}):this.resources.consume(S.t);if(this.item()){var s=this.item(),o=new H.e({item:this.item.peek(),accessChecked:!1,sharingInformation:null,defaultRecipients:[],mode:P.e.addPeople,sharingContextInformation:null},{sharingProvider:n,suiteNavProvider:r,peoplePickerProvider:e,policyTipProvider:i,graphPeoplePickerHelper:t});return{copyLinkShortcut:!1,item:s,peoplePickerProvider:e,graphPeoplePickerHelper:t,sharingInformation:null,sharingProvider:n,policyTipProvider:i,maxHeight:void 0,maxWidth:320,defaultRecipients:[],mode:P.e.addPeople,sharingStore:o}}};t.prototype._computeCalloutComponentProps=function(){var e=this;return{target:this.shareCalloutTarget(),directionalHint:_.e.leftTopEdge,gapSpace:6,onDismiss:function(){e.shareCalloutActive(!1)}}};t.prototype._computeShareCalloutComponentProps=function(){return{shareProps:this._computeShareComponentProps(),calloutProps:this._computeCalloutComponentProps()}};t.dependencies=Object(i.__assign)({},h.t.dependencies);return t})(h.t),X=n(1652),V=n(1653),$=Object(X.e)({tagName:"ms-sharing-info-pane-section",template:r,viewModel:W,synchronous:!0}),J=Object(V.t)({automationName:"ms-sharing-info-pane-section",name:"SharingSection",template:r,viewModelType:W});t.e=$},function(e,t,n){"use strict";n.d(t,"t",function(){return P});var r='<div class="InfoPane-section InfoPaneSection--information" data-bind="css:{\'is-expanded\':sectionHelper.isExpanded,\'no-arrow\':!sectionHelper.showArrow}">\x3c!--ko if:!isHeaderHidden--\x3e<div class="InfoPane-sectionHeader" data-bind="toggle:sectionHelper.isExpanded,attr:{\'aria-expanded\':sectionHelper.isExpanded(),tabindex:sectionHelper.showArrow?0:-1,role:sectionHelper.showArrow?\'button\':\'\'}">\x3c!--ko if:sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i>\x3c!--/ko--\x3e<h3 class="InfoPane-sectionHeaderText" data-bind="text:informationHeader"></h3></div>\x3c!--/ko--\x3e<div class="InfoPane-sectionContent"><dl class="InfoPaneSection-informationBody" data-bind="template:{name:getEntryType,foreach:entries}"></dl></div></div>',i=(n(2564),n(0)),s=n(1651),o=n(6),u=n(2075),a=n(1796),f=n(2820),l=n(1672),c=n(219),h=n(2141),p=n(1829),d=n(394),v=n(12),m=n(22),g=n(23),y=n(392),b=n(1007),w=n(2379),E=n(1966),S=n(1907),x=n(996),T=n(763),N=n(76),C=n(2109),k=n(1773),L=n(13);function A(e){var t=e.condition,n=e.value;return t?t():n()&&n().length>0}var O=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this,i=n.useItemsScope,s=n.itemCacheObservablesFactory;r._itemCacheObservablesFactory=s;var o=r._changeFolderTypeAction=new(r.managed(f.e))({}),c=r.resources;r._urlDataSource=c.consume(N.ve);r._itemParentHelper=c.consume(l.e);r._fileHandlerProvider=c.consume(k.e.local);r._useItemsScope=i;r._item=t.item;var h=r.observables;r._isCustomList=h.pureCompute(r._computeIsCustomList);i&&(r._itemsScopePath=r._itemCacheObservablesFactory.pureCompute(function(e){return r._computeItemsScopePath(e)}));r.strings=a;r.isHeaderHidden=!!t.isHeaderHidden;r.informationHeader=r.strings.generalInformationHeader;r.sectionHelper=new(r.managed(C.e));r.addBindingHandlers({toggle:u.e});r._audio=h.pureCompute(r._computeAudio);var p=c.consume(N.S).getIdentity().type===T.e.anonymous?h.create():h.pureCompute(r._computePath),d=h.createArray([{title:a.informationFiletype,value:h.pureCompute(r._computeFileType)},{title:a.informationFolderType,condition:h.pureCompute(r._computeIsFolderTypeVisible),value:h.pureCompute(r._computeFolderType),className:"InfoPaneSection-information-folderType",editClassName:"InfoPaneSection-information-changeFolderType",onEdit:function(e){o.execute(e);return!1},editText:a.informationFolderTypeChange},{title:a.informationVisitorViews,value:h.pureCompute(r._computeVisitorViews)},{title:a.informationDateTaken,value:h.pureCompute(r._computeDateTaken)},{title:a.informationDimensions,value:h.pureCompute(r._computeDimensions)},{title:a.informationDuration,value:h.pureCompute(r._computeDuration)},{title:a.informationBitrate,value:h.pureCompute(r._computeBitRate)},{title:a.informationCamera,value:h.pureCompute(r._computeCamera)},{title:a.informationShot,value:h.pureCompute(r._computeShot)},{title:a.informationTitle,value:h.pureCompute(r._computeTitle)},{title:a.informationAlbum,value:h.pureCompute(r._computeAlbum)},{title:a.informationAlbumArtist,value:h.pureCompute(r._computeAlbumArtist)},{title:a.informationArtist,value:h.pureCompute(r._computeArtist)},{title:a.informationTrack,value:h.pureCompute(r._computeTrack)},{title:a.informationDisc,value:h.pureCompute(r._computeDisc)},{title:a.informationComposers,value:h.pureCompute(r._computeComposers)},{title:a.informationGenre,value:h.pureCompute(r._computeGenre)},{title:a.informationYear,value:h.pureCompute(r._computeYear)},{title:a.informationCopyright,value:h.pureCompute(r._computeCopyright)},{title:a.informationLocations,value:h.pureCompute(r._computeLocations)},{title:a.informationModified,value:h.pureCompute(r._computeModified)},{title:a.informationDeleted,value:h.pureCompute(r._computeDeleted)},{title:a.informationAddedBy,value:h.pureCompute(r._computeAddedBy)},{title:a.informationDateCreated,value:h.pureCompute(r._computeCreated)},{title:a.informationDateShared,value:h.pureCompute(r._computeDateShared)},{title:a.informationPath,value:p,className:"InfoPaneSection-information-path"},{title:a.informationOriginalLocation,value:h.pureCompute(r._computeOriginalLocation)},{title:a.informationSize,value:h.pureCompute(r._computeSize)},{title:a.informationPanoramaResolution,value:h.pureCompute(r._computePanoramaResolution)},{title:a.informationPanoramaRange,value:h.pureCompute(r._computePanoramaRange)}]);r.entries=r.addDisposable(d.filter(A));return r}t.prototype.getEntryType=function(e){return e.editText?"ms-information-editableentry":Array.isArray(e.value())?"ms-information-iterableentry":"ms-information-basicentry"};t.prototype._computeAudio=function(){return this._item().audio};t.prototype._computeTitle=function(){var e=this._audio();return e&&e.title};t.prototype._computeAlbum=function(){var e=this._audio();return e&&(e.album||a.informationUnknownAlbum)};t.prototype._computeAlbumArtist=function(){var e=this._audio();return e&&e.albumArtist};t.prototype._computeArtist=function(){var e=this._audio();return e&&(e.artist||a.informationUnknownArtist)};t.prototype._computeTrack=function(){var e=this._audio(),t=e&&e.track,n=e&&e.trackCount;return t?n?m.format(a.informationTrackAndDiscFormat,t,n):""+t:""};t.prototype._computeDisc=function(){var e=this._audio(),t=e&&e.disc,n=e&&e.discCount;if(e&&(t>1||n>1))return n>=t?m.format(a.informationTrackAndDiscFormat,t,n):t&&""+t};t.prototype._computeComposers=function(){var e=this._audio();return e&&e.composers};t.prototype._computeGenre=function(){var e=this._audio();return e&&e.genre};t.prototype._computeYear=function(){var e=this._audio();return e&&e.year&&""+e.year};t.prototype._computeCopyright=function(){var e=this._audio();return e&&e.copyright};t.prototype._computeFileType=function(){var e=this._item();if(!e.isBundle&&void 0===e.virtualItemType){var t=this._fileHandlerProvider,n=e.extension,r=t&&n&&t.getFileTypeName(n);return E.t(e,this._isCustomList(),r)}};t.prototype._computeIsFolderTypeVisible=function(){var e=this._item();return e.type===c.e.Folder&&!e.isBundle&&!e.isSpecialFolder&&(!e.vault||!e.vault.isLocked)&&void 0===e.virtualItemType&&this._changeFolderTypeAction.isAvailable()};t.prototype._computeDateTaken=function(){var e=this._item(),t=(e.photo||e.video)&&e;return t?t.dateTakenTime?Object(x.n)(t.dateTakenTime,!0):t.dateTaken:""};t.prototype._computeFolderType=function(){switch(this._item().category){case h.e.documents:return a.informationFolderTypeDocuments;case h.e.photos:return a.informationFolderTypePhotos;case h.e.favorites:return a.informationFolderTypeFavorites}return""};t.prototype._computeVisitorViews=function(){var e=this._item().statistics.views;return e&&""+e};t.prototype._computeDimensions=function(){var e=this._item(),t=e.video||!e.panorama&&e.photo||{},n=t.width,r=t.height;return n&&r?m.format(a.informationDimensionsFormat,n,r):""};t.prototype._computeDuration=function(){var e=this._item().video,t=e&&e.duration;return t>0?w.e(t):""};t.prototype._computeBitRate=function(){var e=this._item().video,t=e&&e.bitrate;if(t){var n=t>1e6?"Mega":"Kilo",r=t>1e6?1e6:1e3;return m.format(a["information"+n+"BitrateFormat"],Math.floor(t/r))}};t.prototype._computeCamera=function(){var e=this._item(),t=e.photo,n=e.video;return t&&t.cameraModel||n&&n.cameraModel};t.prototype._computeShot=function(){var e=this._item().photo;if(e){var t=e.exposureNumerator,n=e.exposureDenominator,r=t&&""+t;n&&1!==n&&(r=m.format(a.informationShotExposureFormat,t,n));var i=e.focalRatio?""+e.focalRatio:"";i=i&&m.format(a.informationShotFStopFormat,i);var s=e.focalLength?""+e.focalLength:"";return[r,i,s=s&&m.format(a.informationShotFocalLengthFormat,s)].join(" ").trim()}};t.prototype._computeLocations=function(){var e=this._item().locations;if(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];i&&t.push(i)}return t}};t.prototype._computeModified=function(){var e=this._item(),t=e.dateModified&&e.dateModified.trim().length>0;if(!this._urlDataSource.isRecycleBin(e.queryType)&&t)return e.dateModifiedTime?Object(x.n)(e.dateModifiedTime):e.dateModified};t.prototype._computeDeleted=function(){var e=this._item();if(this._urlDataSource.isRecycleBin(e.queryType))return e.dateDeletedTime?Object(x.n)(e.dateDeletedTime):e.dateDeleted};t.prototype._computeAddedBy=function(){return this._item().creatorName};t.prototype._computeCreated=function(){var e=this._item();return e.dateCreatedTime?Object(x.n)(e.dateCreatedTime):e.dateCreated};t.prototype._computeDateShared=function(){var e=this._item();return e.dateSharedTime?Object(x.n)(e.dateSharedTime):e.dateShared};t.prototype._computePath=function(){var e=this._item();if(this._useItemsScope&&this._useItemsScope()&&!L.e.isActivated("360FC0DF-53A3-40D6-BBE9-DBF4AA62F9F2","2/26/2021","use itemsScope data path"))return this._itemsScopePath();if(!e.audio&&e.parent&&!this._urlDataSource.isRecycleBin(e.queryType)){for(var t=[],n=e;n;n=n.parent)t.unshift(n.name);return t}};t.prototype._computeOriginalLocation=function(){var e=this._item();if(this._urlDataSource.isRecycleBin(e.queryType)||Object(y.e)(e.queryType)||e.queryType===g.e.SharedWithMe)return e.location};t.prototype._computeSize=function(){var e=this._item();return e.size&&b.e.getDisplayString(e.size,{ignoreZero:!0})};t.prototype._computePanoramaResolution=function(){var e=this._item().panorama,t=e&&e.resolution;if(t)return m.format(a.informationPanoramaResolutionFormat,t)};t.prototype._computePanoramaRange=function(){var e=this._item().panorama||{},t=e.horizontalFov,n=e.verticalFov;if(t&&n)return m.format(a.informationPanoramaRangeFormat,Math.round(t),Math.round(n))};t.prototype._computeIsCustomList=function(){var e=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(this._item(),"list"));return!!e&&!e.list.isDocumentLibrary};t.prototype._computeItemsScopePath=function(e){for(var t,n=this._item(),r=this._urlDataSource.getKeyParams(n.key),i=e.demandItemFacet(d.e,v.f),s=d.e.evaluate(i)(e,{viewParams:r,isNavigation:!1}).itemKey,u=[];s;){var a=e.demandItemFacet(o.h,s);a&&u.unshift(a);s=null===(t=e.demandItemFacet(o.M,s))||void 0===t?void 0:t.itemKey}return u};t.dependencies=Object(i.__assign)(Object(i.__assign)({},s.t.dependencies),{itemCacheObservablesFactory:p.e,useItemsScope:S.e});return t})(s.t),M=n(1652),_=n(1653),D=Object(M.e)({tagName:"ms-information-info-pane-section",template:r,viewModel:O,synchronous:!0}),P=Object(_.t)({automationName:"ms-information-info-pane-section",name:"InformationSection",template:r,viewModelType:O});Object(M.t)("ms-information-basicentry",'<dt data-bind="text:title"></dt><dd data-bind="class:$data.className,text:value"></dd>');Object(M.t)("ms-information-editableentry",'<dt data-bind="text:title"></dt><dd><div data-bind="class:$data.className,text:value"></div><a href="javascript:;" data-bind="class:$data.editClassName,click:onEdit,text:editText"></a></dd>');Object(M.t)("ms-information-iterableentry",'<dt data-bind="text:title"></dt><dd data-bind="foreach:{data:value}"><div data-bind="class:$parent.className,text:$data"></div></dd>');t.e=D},,,function(e,t,n){"use strict";n.d(t,"t",function(){return y});var r='\x3c!--ko if:isSectionVisible--\x3e<div class="InfoPane-section InfoPaneSection--extractedText" data-bind="css:{\'is-expanded\':sectionHelper.isExpanded,\'no-arrow\':!sectionHelper.showArrow}"><div class="InfoPane-sectionHeader" data-bind="toggle:sectionHelper.isExpanded,attr:{\'aria-expanded\':sectionHelper.isExpanded(),tabindex:sectionHelper.showArrow?0:-1,role:sectionHelper.showArrow?\'button\':\'\'}">\x3c!--ko if:sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i>\x3c!--/ko--\x3e<span class="InfoPane-sectionHeaderText" data-bind="text:sectionHeader"></span></div><div class="InfoPane-sectionContent">\x3c!--ko if:currentExtractedEmail--\x3e<div class="InfoPane-extractedText-label" data-bind="text:strings.extractedTextEmailTypeName"></div><p class="InfoPane-extractedText-content" data-bind="text:extractedEmail"></p>\x3c!--/ko--\x3e\x3c!--ko if:currentExtractedUrl--\x3e<div class="InfoPane-extractedText-label" data-bind="text:strings.extractedTextUrlTypeName"></div><p class="InfoPane-extractedText-content" data-bind="text:extractedUrl"></p>\x3c!--/ko--\x3e\x3c!--ko if:currentExtractedPhone--\x3e<div class="InfoPane-extractedText-label" data-bind="text:strings.extractedTextPhoneTypeName"></div><p class="InfoPane-extractedText-content" data-bind="text:extractedPhone"></p>\x3c!--/ko--\x3e\x3c!--ko if:currentExtractedText--\x3e\x3c!--ko if:currentExtractedEmail()||currentExtractedUrl()||currentExtractedPhone()--\x3e<div class="InfoPane-extractedText-label" data-bind="text:strings.extractedTextTextTypeName"></div>\x3c!--/ko--\x3e<p class="InfoPane-extractedText-content" data-bind="text:extractedText"></p>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e',i=n(138);Object(i.n)([{rawString:".InfoPane-extractedText-content{margin-bottom:10px;display:block}.InfoPane-extractedText-label{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-DetailsPane-LegacySection .InfoPaneSection--extractedText .InfoPane-sectionHeader{border-bottom:.5px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";padding-bottom:4px}"}]);var s,o=n(0),u=n(1651),a=n(1796),f=n(2075),l=n(1499);(function(e){e[e.email=0]="email";e[e.url=1]="url";e[e.phone=2]="phone";e[e.text=3]="text";e[e.other=4]="other"})(s||(s={}));var c=s,h=n(71),p=n(2109),d=(function(e){Object(o.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.addBindingHandlers({toggle:f.e});r.strings=a;var i=r.observables;r._itemProvider=r.resources.consume(l.resourceKey);r.sectionHelper=new(r.managed(p.e));r.extractedText=i.create("");r.extractedEmail=i.create("");r.extractedPhone=i.create("");r.extractedUrl=i.create("");r.currentExtractedText=i.create("");r.currentExtractedEmail=i.create("");r.currentExtractedPhone=i.create("");r.currentExtractedUrl=i.create("");r.sectionHeader=a.extractedTextHeader;r._item=t.item;i.compute(r._computeItemChanged);r.isSectionVisible=i.pureCompute(r._computeSectionVisible);return r}t.prototype._computeSectionVisible=function(){return!!(this.currentExtractedEmail()||this.currentExtractedPhone()||this.currentExtractedText()||this.currentExtractedUrl())};t.prototype._computeItemChanged=function(){var e=this,t=this._item();if(t){var n=t.ocr&&t.ocr.entityTags;if(n)for(var r=0,i=n;r<i.length;r++){var s=i[r],o=c[s.type];if(o===c.email){this.currentExtractedEmail(s.content);this.extractedEmail(s.content)}else if(o===c.url){this.currentExtractedUrl(s.content);this.extractedUrl(s.content)}else if(o===c.phone){this.currentExtractedPhone(s.content);this.extractedPhone(s.content)}}this._itemProvider.getItemOcrTextContent(t).then(function(t){e.currentExtractedText(t);e.extractedText(t)},function(e){h.e.log(e)})}};t.dependencies=Object(o.__assign)({},u.t.dependencies);return t})(u.t),v=n(1652),m=n(1653),g=Object(v.e)({tagName:"ms-extracted-text-section",template:r,viewModel:d,synchronous:!0}),y=Object(m.t)({automationName:"ms-extracted-text-section",name:"ExtractedTextSection",template:r,viewModelType:d});t.e=g},function(e,t,n){"use strict";n.d(t,"t",function(){return D});var r='\x3c!--ko if:component--\x3e<div class="InfoPaneSection--preview" data-bind="clientRect:{size:size},component:component"></div>\x3c!--ko if:enableAnalyticsActionBar--\x3e<div class="InfoPaneSection--viewCountLink" data-bind="react:{componentType:analyticsActionBarComponent,props:analyticsActionBarProps}"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e',i=n(138);Object(i.n)([{rawString:".InfoPaneSection--preview{width:auto;height:180px;position:relative;margin-bottom:8px}.InfoPaneSection--preview .od-ImageStack-tile{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.InfoPaneSection--preview .ms-IFrameCtrl-iFrame{min-height:180px;height:180px}.InfoPaneSection--viewCountLink{font-size:14px}.InfoPaneSection--viewCountLink .AnalyticsActionBarField{padding:5px 20px}.InfoPaneSection--viewCountLink .AnalyticsActionBarField .AnalyticsActionBar--item{height:40px}.InfoPaneSection--viewCountLink .AnalyticsActionBarField .AnalyticsActionBar--notSupported{height:0}"}]);var s=n(0),o=n(1651),u=n(1789),a=n(1767),f=n(2604),l=n(1816),c=n(2029),h=n("react-lib"),p=n("knockout-lib"),d=n(3579),v=n(2541),m=n(391),g=n(23),y=n(76),b=n(888),w=n(2286),E=n(2440),S=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.getAccessToken=function(){return Object(E.e)(n.state.graphDataSource,n.props.item)};n.onView=function(e){var t,r,i;n._engagement.logData({name:"DetailsPane.AnalyticsActionBar.ViewClick",extraData:{extension:null!==(i=null===(r=null===(t=n.props)||void 0===t?void 0:t.item)||void 0===r?void 0:r.extension)&&void 0!==i?i:""}});new(n.resources.injected(n.actionMap.ShowItemAnalyticsAction))({item:p.observable(n.props.item)}).execute(e)};n.resources=t.resources;n.state={fileHoverCardStore:n.resources.consume(v.e.optional),graphDataSource:n.resources.consume(y.b.optional)};n.actionMap=n.resources.consume(m.e);n._engagement=n.resources.consume(b.e);return n}t.prototype.componentDidMount=function(){var e=this;this.resources.consumeAsync(v.e).then(function(t){e.setState({fileHoverCardStore:t})});this.resources.consumeAsync(y.b).then(function(t){e.setState({graphDataSource:t})})};t.prototype.render=function(){var e=this.state,t=e.fileHoverCardStore,n=e.graphDataSource,r=Object(E.t)(n,this.props.item),i={itemId:this.props.item.itemId,graph:this.props.item.graph,extension:this.props.item.extension,queryType:g.e[this.props.item.queryType],graphItemUrl:r,getAccessToken:this.getAccessToken};return h.createElement("div",{className:"AnalyticsActionBarField"},t&&n&&h.createElement(x,{item:i,fileHoverCardStore:t,onView:this.onView,actionBarItems:[],isViewCountClickable:!0}))};t.prototype.onShare=function(e){this._engagement.logData({name:"DetailsPane.AnalyticsActionBar.ShareClick"});new(this.resources.injected(this.actionMap.SelectAction))({item:p.observable(this.props.item),showProperties:!1}).execute(e);new(this.resources.injected(this.actionMap.ShowShareAction))({focusItemResourceKey:w.n}).execute(e)};return t})(h.Component),x=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.state={itemAnalyticsResult:n.props.fileHoverCardStore.getItemAnalytics(n.props.item)};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.item!==this.props.item&&this.setState({itemAnalyticsResult:this.props.fileHoverCardStore.getItemAnalytics(e.item)})};t.prototype.componentDidMount=function(){this._addListener()};t.prototype.componentDidUpdate=function(e){var t=this.props.fileHoverCardStore;if(this.props.item.itemId!==e.item.itemId){t.removeListener(this._storeListener,e.item);this._addListener()}};t.prototype.componentWillUnmount=function(){this.props.fileHoverCardStore.removeListener(this._storeListener,this.props.item)};t.prototype.render=function(){var e=this.state.itemAnalyticsResult,t={itemAnalytics:e&&e.data,onClick:this.props.onView,isNotSupported:!1,status:e&&e.status,isCompact:!0,disableViewerCount:this.props.isViewCountClickable,isLink:this.props.isViewCountClickable},n=t&&t.itemAnalytics;return h.createElement("div",{className:"AnalyticsActionBar--item"},n?h.createElement(d.e,{analyticsStats:t,items:this.props.actionBarItems,isLink:this.props.isViewCountClickable,showActionBar:!1,farItems:[]}):null)};t.prototype._addListener=function(){var e=this,t=this.props.fileHoverCardStore;this._storeListener=t.addListener(function(){e.setState({itemAnalyticsResult:t.getItemAnalytics(e.props.item)})},this.props.item);t.fetchItemAnalytics(this.props.item)};return t})(h.Component),T=n(2565),N=n(1663),C=n(46),k=n(219),L=n(1796),A=(function(e){Object(s.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r._item=t.item;r.addBindingHandlers({clientRect:u.e,react:N.t});var i=r.observables;r.size=i.create();r._thumbnailError=i.create();r._imageSize=i.pureCompute(r._computeImageSize);r._thumbnail=i.pureCompute(r._computeThumbnail);r._rotation=i.pureCompute(r._computeRotation);r._hasThumbnailError=i.pureCompute(r._computeHasThumbnailError);r._isImage=i.pureCompute(r._computeIsImage);r._isFolder=i.pureCompute(r._computeIsFolder);r._iframeUrl=i.pureCompute(r._computeIFrameUrl);r._isIFrame=i.pureCompute(r._computeIsIFrame);r._isItemMalicious=i.pureCompute(r._computeItemMalicious);r.component=i.pureCompute(r._computeComponent);r.analyticsActionBarComponent=S;r.analyticsActionBarProps=r.createPureComputed(r._updateAnalyticsActionBarProps);r.enableAnalyticsActionBar=r.createPureComputed(r._computeAnalyticsActionBarAvailable);r.malwareDetectedMessageComponent=T.e;r.isMalwareDetectedMessageVisible=r.createPureComputed(r._computeIsMalwareDetectedMessageVisible);return r}t.prototype._computeAnalyticsActionBarAvailable=function(){var e;return this._item().type!==k.e.Folder&&"personal"!==(null===(e=this._item().graph)||void 0===e?void 0:e.driveType)};t.prototype._updateAnalyticsActionBarProps=function(){return{item:this._item(),resources:this.resources}};t.prototype._computeComponent=function(){if(!this._isItemMalicious()){if(this._isIFrame())return{name:f.e.tagName,params:{iFrameTitle:L.previewSectionIframeTitle,title:"",url:this._iframeUrl,isExcludeFromScreenReader:!0}};if(this._isFolder())return{name:c.e.tagName,params:{item:this._item,imageRect:this._imageSize}};if(this._isImage())return{name:l.e.tagName,params:{image:this._thumbnail,rotation:this._rotation,desiredSize:this._imageSize,alignment:["fitWidth","top"],error:this._thumbnailError}}}};t.prototype._computeIsFolder=function(){var e=this._item();return!(!e||!e.folder)};t.prototype._computeIFrameUrl=function(){var e=this._item();return e&&e.previewIFrameUrl};t.prototype._computeIsIFrame=function(){return!!this._iframeUrl()};t.prototype._computeThumbnail=function(){var e=this._item();return e&&(e.orientedThumbnail||e).thumbnail};t.prototype._computeRotation=function(){var e=this._item(),t=e&&e.orientedThumbnail;return t?t.rotation:a.e.none};t.prototype._computeIsImage=function(){return!!this._thumbnail()&&!this._hasThumbnailError()};t.prototype._computeHasThumbnailError=function(){return this._hasThumbnailError.peek()||!!this._thumbnailError()};t.prototype._computeImageSize=function(){var e=this.size();return{width:e&&e.width||319,height:180}};t.prototype._computeItemMalicious=function(){var e=this._item();return e&&e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected};t.prototype._computeIsMalwareDetectedMessageVisible=function(){return!!Object(C.isFeatureEnabled)(C.EnableATPFilesListView)&&this._computeItemMalicious()};t.dependencies=Object(s.__assign)({},o.t.dependencies);return t})(o.t),O=n(1652),M=n(1653),_=O.e({tagName:"od-infoPane-preview",template:r,viewModel:A,synchronous:!0}),D=Object(M.t)({automationName:"od-infoPane-preview",name:"PreviewSection",template:r,viewModelType:A});t.e=_},,,function(e,t,n){"use strict";n.d(t,"t",function(){return y});var r='<div class="InfoPane-section InfoPaneSection--shortcutInformation" data-bind="css:{\'is-expanded\':sectionHelper.isExpanded,\'no-arrow\':!sectionHelper.showArrow}"><div class="InfoPane-sectionHeader" data-bind="toggle:sectionHelper.isExpanded,attr:{\'aria-expanded\':sectionHelper.isExpanded(),tabindex:sectionHelper.showArrow?0:-1,role:sectionHelper.showArrow?\'button\':\'\'}">\x3c!--ko if:sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i>\x3c!--/ko--\x3e<span class="InfoPane-sectionHeaderText" data-bind="text:strings.informationHeader"></span></div><div class="InfoPane-sectionContent InfoPaneSection-shortcutInformation"><table><tbody>\x3c!--ko if:targetFileType()--\x3e<tr><th data-bind="text:strings.informationFiletype"></th><td data-bind="text:targetFileType"></td></tr>\x3c!--/ko--\x3e\x3c!--ko if:targetModified()--\x3e<tr class="InfoPaneSection-information-groupPadding"><th data-bind="text:strings.informationModified"></th><td data-bind="text:targetModified"></td></tr>\x3c!--/ko--\x3e\x3c!--ko if:targetContainerPath()&&targetContainerName()--\x3e<tr><th data-bind="text:strings.informationPath"></th><td><a class="InfoPaneSection-information-targetPath" data-bind="text:targetContainerName,click:targetPathOnClick,attr:{href:targetContainerPath}" target="_blank"></a></td></tr>\x3c!--/ko--\x3e\x3c!--ko ifnot:targetContainerPath()&&targetContainerName()--\x3e<tr><th data-bind="text:strings.informationPath"></th><td><div data-bind="foreach:{data:path}"><span class="InfoPaneSection-information-path" data-bind="text:$data"></span></div></td></tr>\x3c!--/ko--\x3e</tbody></table></div></div>',i=n(138);Object(i.n)([{rawString:".InfoPaneSection-shortcutInformation table{border-spacing:0;width:100%}.InfoPaneSection-shortcutInformation tr:first-child td,.InfoPaneSection-shortcutInformation tr:first-child th{padding-top:0}.InfoPaneSection-shortcutInformation td,.InfoPaneSection-shortcutInformation th{padding:8px 0;width:50%;word-break:break-all}.InfoPaneSection-shortcutInformation th{vertical-align:top;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-weight:400}html[dir=ltr] .InfoPaneSection-shortcutInformation th{text-align:left}html[dir=rtl] .InfoPaneSection-shortcutInformation th{text-align:right}"}]);var s=n(0),o=n(1651),u=n(1796),a=n(996),f=n(888),l=n(1850),c=n(1966),h=n(76),p=n(2109),d=(function(e){Object(s.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r._item=t.item;r.strings=u;r.sectionHelper=new(r.managed(p.e));var i=r.observables,s=r.resources;r.targetItem=i.create(null);r._shortcutProvider=s.consume(l.e);r._urlDataSource=s.consume(h.ve);i.compute(r._computeTargetItem);r._fileType=i.pureCompute(r._computeFileType);r._modified=i.pureCompute(r._computeModified);r.targetFileType=i.pureCompute(r._computeTargetFileType);r.targetModified=i.pureCompute(r._computeTargetModified);r.targetContainerPath=i.pureCompute(r._computeTargetContainerPath);r.targetContainerName=i.pureCompute(r._computeTargetContainerName);r.path=i.pureCompute(r._computePath);r.targetPathOnClick=function(){r.resources.consume(f.e).logData({name:"TargetPath.ShortcutInformation.Click",isIntentional:!0});return!0};return r}t.prototype._computeTargetItem=function(){var e=this._item(),t=this._shortcutProvider,n=this.targetItem;n(null);t.getShortcutTargetData(e.id).then(function(e){return t.getFileByUrl(e.url)}).then(function(e){n(e)})};t.prototype._computeFileType=function(){var e=this._item();if(!e.isBundle&&void 0===e.virtualItemType)return c.t(e)};t.prototype._computeModified=function(){var e=this._item();if(!this._urlDataSource.isRecycleBin(e.queryType))return e.dateModifiedTime?Object(a.n)(e.dateModifiedTime):e.dateModified};t.prototype._computePath=function(){var e=this._item();if(!e.audio&&e.parent&&!this._urlDataSource.isRecycleBin(e.queryType)){for(var t=[],n=e;n;n=n.parent)t.unshift(n.name);return t}};t.prototype._computeTargetFileType=function(){var e=this.targetItem();return e?c.n(e.Name):this._fileType()};t.prototype._computeTargetModified=function(){var e=this.targetItem();return e?Object(a.n)(e.TimeLastModified):this._modified()};t.prototype._computeTargetContainerPath=function(){var e=this.targetItem();if(e){var t=e.ServerRelativeUrl,n=e.ServerUrl,r=t.lastIndexOf("/");return n+(r>0?t.slice(0,r):t)}};t.prototype._computeTargetContainerName=function(){var e=this.targetItem();if(e){var t=e.ServerRelativeUrl,n=t.lastIndexOf("/"),r=t.lastIndexOf("/",n-1);return t.slice(r+1,n)}};t.dependencies=Object(s.__assign)({},o.t.dependencies);return t})(o.t),v=n(1652),m=n(1653),g=Object(v.e)({tagName:"ms-shortcutInformation-info-pane-section",template:r,viewModel:d,synchronous:!0}),y=Object(m.t)({automationName:"ms-shortcutInformation-info-pane-section",name:"ShortcutInformationSection",template:r,viewModelType:d});t.e=g},function(e,t,n){"use strict";n.d(t,"t",function(){return x});var r='<div class="od-PolicyTipSection InfoPane-section is-expanded">\x3c!--ko if:!isPolicyTipPanelEnabled--\x3e<div class="InfoPane-sectionContent" data-bind="css:backgroundClass"><i class="od-PolicyTipSection-icon ms-Icon" data-bind="css:iconClass"></i><div class="od-PolicyTipSection-text"><span data-bind="text:text"></span>\x3c!--ko if:hasTip--\x3e<br><a href="javascript:" data-bind="click:onViewTipClick,text:viewTipLink"></a>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e\x3c!--ko if:isPolicyTipPanelEnabled&&policyTipInfo()--\x3e\x3c!--ko component:{name:policyTipMessageBarTagName,params:policyTipMessageBarParams}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko component:{name:\'ms-panel-host\'}--\x3e\x3c!--/ko--\x3e</div>',i=n(138);Object(i.n)([{rawString:".od-PolicyTipSection .InfoPane-sectionContent{padding:8px}.od-PolicyTipSection--notify{background-color:rgba(216,59,1,.2)}.od-PolicyTipSection--block{background-color:rgba(232,17,35,.2)}.od-PolicyTipSection-icon{padding-top:2px;font-size:17px}html[dir=ltr] .od-PolicyTipSection-icon{float:left}html[dir=rtl] .od-PolicyTipSection-icon{float:right}[dir=ltr] .od-PolicyTipSection-text{margin-left:25px}[dir=rtl] .od-PolicyTipSection-text{margin-right:25px}"}]);var s=n(0),o=n(1656),u=n(133),a=n(76),f=n(46),l=n(1796),c=n(1781),h=n(1820),p=n(2823),d=n(2405),v=n(890),m=n(1651),g=n(2110),y=n(25),b=(function(e){Object(s.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this,i=r._item=t.item;r.viewTipLink=l.policyTipLaunchDialogLink;var s=r.observables,d=r.resources;d.bind(c.e);r._panelProvider=d.consume(c.e.local);r._policyTipDataSource=d.consume(a.V);r.isPolicyTipPanelEnabled=Object(f.isFeatureEnabled)(f.PolicyTipPanel);r.policyTipMessageBarTagName=p.e.tagName;r.policyTipMessageBarParams={item:i.peek(),onClick:r.onViewTipClick.bind(r)};r.policyTipInfo=s.create(null);if(r.isPolicyTipPanelEnabled){var v=new o.e;s.compute(function(){var e=i();v.debounce(r.trackPromise(r._policyTipDataSource.getPolicyTip(e).then(function(e){r.policyTipInfo(e)})))})}r.backgroundClass=s.pureCompute(function(){var e=i();if(!e||!e.policyTip)return"";var t=g.r(e.policyTip,2),n=g.r(e.policyTip,1);return t?"od-PolicyTipSection--block":n?"od-PolicyTipSection--notify":void 0});r.iconClass=s.pureCompute(function(){var e=i();if(!e||!e.policyTip)return"";var t=g.r(e.policyTip,2),n=g.r(e.policyTip,1);return t?Object(y.C)("DRM")+" ms-fontColor-redDark":n?Object(y.C)("IncidentTriangle")+" ms-fontColor-orange":void 0});r.text=s.pureCompute(function(){var e=i();if(!e||!e.policyTip)return"";var t=g.r(e.policyTip,2),n=g.r(e.policyTip,1);return t?h.policyTipBlockText:n?h.policyTipNotifyText:void 0});r.hasTip=s.pureCompute(function(){return!!(1&i().policyTip)});r.subscribe(i,function(e){e.policyTip&&u.e.logData({name:"PolicyTip.InfoPaneSection.Shown"})});return r}t.prototype.onViewTipClick=function(e){var t=this,r=this._item.peek();if(!this.isPolicyTipPanelEnabled){u.e.logData({name:"PolicyTip.InfoPaneSection.ViewTip.Click"});n.ee(6,3334).then(v.e).then(function(n){new(t.resources.injected(n))({item:t.observables.create(r)}).execute(e)});return!1}var i={item:r,policyTipInfo:this.policyTipInfo.peek()};this._panelProvider.requestPanel({component:{name:d.e.tagName,params:i}})};t.dependencies=Object(s.__assign)({},m.t.dependencies);return t})(m.t),w=n(1652),E=n(1653),S=(n(1930),Object(w.e)({tagName:"ms-policy-tip-section",template:r,viewModel:b,synchronous:!0})),x=Object(E.t)({automationName:"ms-policy-tip-section",name:"PolicyTipSection",template:r,viewModelType:b});t.e=S}],Array(68),[function(e,t,n){"use strict";var r=n(0),i=n("react-lib"),s=n(3188),o=n(2134),u=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources,r=e.isScheduling;return i.createElement(o.e,{sectionControlKey:s.t,item:t,resources:n,isScheduling:r})};return t})(i.Component);t.e=u}],Array(84),[function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return l});var r=n(0),i=n(1651),s=n(1804),o=n(3541),u=n(1663),a=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.addBindingHandlers({react:u.t});r.detailsPaneComponentType=s.e;r.detailsPaneProps=r.observables.pureCompute(function(){return{resources:r.resources,specification:Object(s.t)(o.e.local,{})}});return r}t.dependencies=Object(r.__assign)({},i.t.dependencies);return t})(i.t),f=n(1653),l=Object(f.t)({automationName:"ms-legacy-details-pane-host",name:"LegacyDetailsPaneHost",template:'<div data-bind="react:{componentType:detailsPaneComponentType,props:detailsPaneProps}"></div>',viewModelType:a});t.default=l}],Array(186),[function(e,t,n){"use strict";n.d(t,"e",function(){return xn});var r=n(0),i=n("react-lib"),s=n("prop-types-lib"),o=n(218),u=n(1731),a=n(7),f=n(46),l=n(13),c=n(97),h=n(2563),p=n(326),d=n(1649),v=n(133),m=n(539),g=n(2214),y=n(1033),b=n(1687),w=n("react-dom-lib"),E=n(2403),S=n(1673),x=n(138);Object(x.n)([{rawString:".od-DetailsPaneWrapper{position:absolute;top:0;bottom:0;left:0;right:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}html[dir=ltr] .od-DetailsPaneWrapper{border-left:1px solid "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}html[dir=rtl] .od-DetailsPaneWrapper{border-right:1px solid "},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-DetailsPane{height:100%;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-DetailsPane--secondaryPaneDisabled{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}.od-DetailsPane-scrollablePane{overflow-x:hidden}.od-DetailsPane-GlobalSettingsMenu{height:unset}.od-DetailsPane-GlobalSettingsMenu .ms-Button-icon{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-DetailsPane-GlobalSettingsMenuItems{min-width:160px;padding:0}"}]);Object(x.n)([{rawString:".od-DetailsPane-PrimaryPane-wrapper{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:";overflow-x:hidden}.isFluent .od-DetailsPane-PrimaryPane-wrapper{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-DetailsPane-PrimaryPane{padding-bottom:12px}.od-DetailsPane-PrimaryPane--isCollapsed .od-DetailsPane-PrimaryPane{padding-bottom:0}.od-DetailsPane-PrimaryPane-header{padding:10px 16px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:14px;box-shadow:0 1px 3px rgba(0,0,0,.08);background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";display:flex;position:relative}.od-DetailsPane-PrimaryPane-header-icon{display:inline-block}.od-DetailsPane-PrimaryPane-header-icon .FileTypeIcon-icon{width:20px!important;height:20px!important}.od-DetailsPane-PrimaryPane-header-title{margin:0 0 0 12px;line-height:23px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;flex-grow:1;font-size:14px}.isFluent .od-DetailsPane-PrimaryPane-header-title{font-weight:600}.od-DetailsPane-PrimaryPane--isCollapsed .od-DetailsPane-PrimaryPane-body{height:0;overflow:hidden}.od-DetailsPane-PrimaryPane-header-close{height:unset}.od-DetailsPane-PrimaryPane-header-close:focus{outline:solid 1px transparent}"}]);var T=n(2272),N=n(1721),C=n(1773),k=n(22),L=n(37),A=n(1486);Object(x.n)([{rawString:".od-ParentHeightWatcher-iframe{position:absolute;top:0;bottom:0;left:0;right:0;height:100%;width:0;visibility:hidden}"}]);var O=n(156),M=new O.t(window),_=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.shouldComponentUpdate=function(e,t){return e.children!==this.props.children};t.prototype.componentDidMount=function(){var e=this;this._iframeElement&&M.on(this._iframeElement.contentWindow,"resize",function(){e.props.onHeightChange()})};t.prototype.componentWillUnmount=function(){this._iframeElement&&M.off(this._iframeElement.contentWindow,"resize")};t.prototype.render=function(){var e=this;return i.createElement("div",{className:"od-ParentHeightWatcher"},i.createElement("iframe",{ref:function(t){e._iframeElement=t},className:"od-ParentHeightWatcher-iframe"}),this.props.children)};return t})(i.Component),D=n(2442),P=n(2639),H=n(176),B=n(2933),j=(n(3023),function(e){var t,n,r=e.item,s=e.resources,o=r.peek(),u=o.key,a=null===(n=null===(t=o.comments)||void 0===t?void 0:t.settings)||void 0===n?void 0:n.isCommentDisabled,f=o.tokenNeedsRedeeming,l=i.useReducer(function(e){return e+1},0)[1];i.useEffect(function(){var e=r.subscribe(function(e){var t,n;e.key===u&&(null===(n=null===(t=e.comments)||void 0===t?void 0:t.settings)||void 0===n?void 0:n.isCommentDisabled)===a&&e.tokenNeedsRedeeming===f||l()});return function(){e.dispose()}},[r,u,a,f]);return i.createElement("div",{className:"od-DetailsPane-ItemActivityFeedSection"},i.createElement("div",{className:"od-DetailsPane-ItemActivityFeedSection-content"},i.createElement(B.default,{item:o,resources:s})))}),F=n(3185),I=n(2134),q=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return i.createElement(I.e,{sectionControlKey:F.t,item:t,resources:n})};return t})(i.Component),R=n(3195),U=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return i.createElement(I.e,{sectionControlKey:R.t,item:t,resources:n})};return t})(i.Component);Object(x.n)([{rawString:".od-Caption-textField{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";padding-top:7px;border:none}.od-Caption-textField:hover{border-bottom:1px solid "},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-Caption-textField .ms-TextField-wrapper{border:none}.od-Caption-textField .ms-TextField-field{font-size:12px}"}]);var z=n(1893),W=n(1796),X=n(391),V=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._resources=t.resources;r._actionMap=r._resources.consume(X.e);var i=(new p.e).attach(new S.e({owner:r}));r._text=i.create("");return r}t.prototype.render=function(){var e=this,t=this._text,n=this._item=this.props.item;this._updateCaptionAction=new(this._resources.injected(this._actionMap.UpdateCaptionAction))({caption:t,item:n});this._isEditable=this._updateCaptionAction.isAvailable();var r=n()&&n().caption||"";this._text(r);var s=this._getPlaceholderAndAriaLabel(),o=s.placeholder,u=s.ariaLabel;return i.createElement(z.e,{key:n()&&n().key,className:"od-Caption-textField",underlined:!0,readOnly:!this._isEditable,placeholder:this._isEditable?o:"",defaultValue:this._text(),onBlur:function(t){return e._onBlur(t)},onKeyPress:this._onKeyPress,ariaLabel:u})};t.prototype._getPlaceholderAndAriaLabel=function(){var e=this._item();return e&&e.photo?{placeholder:W.captionAddCaption,ariaLabel:W.captionAriaLabel}:{placeholder:W.captionAddDescription,ariaLabel:W.descriptionAriaLabel}};t.prototype._onBlur=function(e){var t=this._item.peek(),n=e.target.value.trim();if(this._isEditable&&n!==t.caption){this._text(n);t.caption=n;this._updateCaptionAction.execute(null)}};t.prototype._onKeyPress=function(e){if("Enter"===e.key){e.target.blur()}};return t})(i.Component),$=n(763),J=n(2820),K=n(1672),Q=n(76),G=n(996),Y=n(1007),Z=n(2379),ee=n(23),te=n(392),ne=n(2141),re=n(219),ie=n(1966),se=n(220),oe=n(1508),ue=n(653),ae=n(1547),fe=n(2787),le=(n(2564),function(e){var t=e.value,n=e.tooltip,r=e.successTooltip,s=e.ariaLabel,o=Object(i.useState)(!1),u=o[0],a=o[1],f=Object(i.useRef)(),l=Object(i.useRef)(null),h=Object(i.useRef)(new se.e);return i.createElement(ae.e,{content:u?r:n,id:Object(ue.e)("copyButtonTooltipHost"),styles:{root:{display:"inline-block"}},directionalHint:c.e.bottomAutoEdge},i.createElement(oe.e,{componentRef:l,className:"InfoPaneSection-copyButton",onClick:function(){var e;Object(fe.e)(t);null===(e=l.current)||void 0===e||e.focus();a(!0);f.current&&h.current.clearTimeout(f.current);f.current=h.current.setTimeout(function(){return a(!1)},3e3)},iconProps:{iconName:u?"CheckMark":"Copy"},"aria-label":s}))}),ce=function(e){var t=e.title,n=e.copyButtonProps;return i.createElement("dt",{className:"InfoPaneSection-entryTile"},t,n?i.createElement(le,Object(r.__assign)({},n)):null)},he=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.title,n=e.value,r=e.copyButtonProps,s=e.className;return i.createElement(i.Fragment,null,i.createElement(ce,{title:t,copyButtonProps:r}),i.createElement("dd",{className:s},n))};return t})(i.PureComponent),pe=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.title,n=e.copyButtonProps;return i.createElement(i.Fragment,null,i.createElement(ce,{title:t,copyButtonProps:n}),i.createElement("dd",null,this._createMap()))};t.prototype._createMap=function(){var e=this;return this.props.value.map(function(t,n){return i.createElement("div",{key:n,className:e.props.className},t)})};return t})(i.PureComponent);Object(x.n)([{rawString:".od-InfoPane-ReactSections .InfoPane-section{padding:12px 16px;margin:12px 0;width:auto;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-InfoPane-ReactSections .InfoPane-sectionHeader{position:relative}.od-InfoPane-ReactSections .InfoPane-sectionHeaderText{font-size:14px;font-weight:400}.isFluent .od-InfoPane-ReactSections .InfoPane-sectionHeaderText{font-size:14px;font-weight:600;margin:0 0 8px}.od-InfoPane-ReactSections .od-SharingSection-PermissionsPile{padding:12px 16px;margin:12px 0;width:auto}.od-InfoPane-ReactSections .InfoPaneSection--properties{width:auto}.od-InfoPane-ReactSections .InfoPane-sectionContent .od-ClientFormFields-field{padding:0;margin:12px 0}.od-InfoPane-ReactSections .InfoPaneSection--activitiesfeed .InfoPane-sectionContent{margin-top:12px}.od-InfoPane-ReactSections .InfoPaneSection--shortcutInformation{font-size:12px}.od-InfoPane-ReactSections .InfoPaneSection--shortcutInformation .InfoPane-sectionHeader{display:none}.od-InfoPane-ReactSections .od-PolicyTipSection.InfoPane-section{padding:0}.od-InfoPane-ReactSections .od-PolicyTipSection.InfoPane-section .od-PolicyTipMessageBar{padding:12px 16px}.od-InfoPane-ReactSections .od-PolicyTipSection.InfoPane-section .InfoPane-sectionContent{padding:12px 16px}"}]);var de=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return i.createElement("div",{className:"od-InfoPane-ReactSections"},i.createElement("div",{className:"InfoPane-section is-expanded InfoPaneSection--information"},i.createElement("div",{className:"InfoPane-sectionHeader"},i.createElement("i",{className:"InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown"}),i.createElement("h3",{className:"InfoPane-sectionHeaderText"})),i.createElement("div",{className:"InfoPane-sectionContent"},i.createElement("dl",{className:"InfoPaneSection-informationBody"},this._createMap()))))};t.prototype._createMap=function(){return this.props.allEntries.map(function(e,t){return"string"==typeof e.value?i.createElement(he,{key:t,title:e.title,value:e.value,copyButtonProps:e.copyButtonProps,condition:e.condition,className:e.className}):i.createElement(pe,{key:t,title:e.title,value:e.value,copyButtonProps:e.copyButtonProps,condition:e.condition,className:e.className})})};return t})(i.PureComponent),ve=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return i.createElement(de,{allEntries:this._computeAllEntries()})};t.prototype._computeAllEntries=function(){var e=this.props.isAnonymousUser?"":this._computePath(),t=[{title:W.informationFiletype,value:this._computeFileType()},{title:W.informationFolderType,value:this._computeFolderType(),condition:this._computeIsFolderTypeVisible(),className:"InfoPaneSection-information-folderType"},{title:W.informationVisitorViews,value:this._computeVisitorViews()},{title:W.informationDateTaken,value:this._computeDateTaken()},{title:W.informationDimensions,value:this._computeDimensions()},{title:W.informationDuration,value:this._computeDuration()},{title:W.informationBitrate,value:this._computeBitRate()},{title:W.informationCamera,value:this._computeCamera()},{title:W.informationShot,value:this._computeShot()},{title:W.informationTitle,value:this._computeTitle()},{title:W.informationAlbum,value:this._computeAlbum()},{title:W.informationAlbumArtist,value:this._computeAlbumArtist()},{title:W.informationArtist,value:this._computeArtist()},{title:W.informationTrack,value:this._computeTrack()},{title:W.informationDisc,value:this._computeDisc()},{title:W.informationComposers,value:this._computeComposers()},{title:W.informationGenre,value:this._computeGenre()},{title:W.informationYear,value:this._computeYear()},{title:W.informationCopyright,value:this._computeCopyright()},{title:W.informationLocations,value:this._computeLocations()},{title:W.informationModified,value:this._computeModified()},{title:W.informationDeleted,value:this._computeDeleted()},{title:W.informationAddedBy,value:this._computeAddedBy()},{title:W.informationDateCreated,value:this._computeCreated()},{title:W.informationDateShared,value:this._computeDateShared()},{title:W.informationPath,value:e,copyButtonProps:{value:this.props.pathCopyValue,tooltip:W.pathCopyButtonText,successTooltip:W.pathCopyButtonSuccessTooltip,ariaLabel:W.pathCopyButtonText},className:"InfoPaneSection-information-path"},{title:W.informationOriginalLocation,value:this._computeOriginalLocation()},{title:W.informationSize,value:this._computeSize()},{title:W.informationPanoramaResolution,value:this._computePanoramaResolution()},{title:W.informationPanoramaRange,value:this._computePanoramaRange()}];return this._filterEntry(t)};t.prototype._filterEntry=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];("condition"in i?i.condition:i.value&&i.value.length>0)&&t.push(i)}return t};t.prototype._computeTitle=function(){var e=this.props.item.audio;return e&&e.title};t.prototype._computeAlbum=function(){var e=this.props.item.audio;return e&&(e.album||W.informationUnknownAlbum)};t.prototype._computeAlbumArtist=function(){var e=this.props.item.audio;return e&&e.albumArtist};t.prototype._computeArtist=function(){var e=this.props.item.audio;return e&&(e.artist||W.informationUnknownArtist)};t.prototype._computeTrack=function(){var e=this.props.item.audio,t=e&&e.track,n=e&&e.trackCount;return t?n?k.format(W.informationTrackAndDiscFormat,t,n):""+t:""};t.prototype._computeDisc=function(){var e=this.props.item.audio,t=e&&e.disc,n=e&&e.discCount;if(e&&(t>1||n>1))return n>=t?k.format(W.informationTrackAndDiscFormat,t,n):t&&""+t};t.prototype._computeComposers=function(){var e=this.props.item.audio;return e&&e.composers};t.prototype._computeGenre=function(){var e=this.props.item.audio;return e&&e.genre};t.prototype._computeYear=function(){var e=this.props.item.audio;return e&&e.year&&""+e.year};t.prototype._computeCopyright=function(){var e=this.props.item.audio;return e&&e.copyright};t.prototype._computeFileType=function(){var e=this.props.item;if(!e.isBundle&&void 0===e.virtualItemType){var t=e.extension&&this.props.fileHandlerProviderFileTypeName;return ie.t(e,this.props.isCustomList,t)}};t.prototype._computeIsFolderTypeVisible=function(){var e=this.props.item;return e.type===re.e.Folder&&!e.isBundle&&!e.isSpecialFolder&&(!e.vault||!e.vault.isLocked)&&void 0===e.virtualItemType&&this.props.isChangeFolderTypeActionAvailable};t.prototype._computeDateTaken=function(){var e=this.props.item,t=(e.photo||e.video)&&e;return t?t.dateTakenTime?Object(G.n)(t.dateTakenTime,!0):t.dateTaken:""};t.prototype._computeFolderType=function(){switch(this.props.item.category){case ne.e.documents:return W.informationFolderTypeDocuments;case ne.e.photos:return W.informationFolderTypePhotos;case ne.e.favorites:return W.informationFolderTypeFavorites}return""};t.prototype._computeVisitorViews=function(){var e=this.props.item.statistics.views;return e&&""+e};t.prototype._computeDimensions=function(){var e=this.props.item,t=e.video||!e.panorama&&e.photo||{},n=t.width,r=t.height;return n&&r?k.format(W.informationDimensionsFormat,n,r):""};t.prototype._computeDuration=function(){var e=this.props.item.video,t=e&&e.duration;return t>0?Z.e(t):""};t.prototype._computeBitRate=function(){var e=this.props.item.video,t=e&&e.bitrate;if(t){var n=t>1e6?"Mega":"Kilo",r=t>1e6?1e6:1e3;return k.format(W["information"+n+"BitrateFormat"],Math.floor(t/r))}};t.prototype._computeCamera=function(){var e=this.props.item,t=e.photo,n=e.video;return t&&t.cameraModel||n&&n.cameraModel};t.prototype._computeShot=function(){var e=this.props.item.photo;if(e){var t=e.exposureNumerator,n=e.exposureDenominator,r=t&&""+t;n&&1!==n&&(r=k.format(W.informationShotExposureFormat,t,n));var i=e.focalRatio?""+e.focalRatio:"";i=i&&k.format(W.informationShotFStopFormat,i);var s=e.focalLength?""+e.focalLength:"";return[r,i,s=s&&k.format(W.informationShotFocalLengthFormat,s)].join(" ").trim()}};t.prototype._computeLocations=function(){var e=this.props.item.locations;if(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];i&&t.push(i)}return t}};t.prototype._computeModified=function(){var e=this.props.item,t=e.dateModified&&e.dateModified.trim().length>0;if(!this.props.isRecycleBin&&t)return e.dateModifiedTime?Object(G.n)(e.dateModifiedTime):e.dateModified};t.prototype._computeDeleted=function(){var e=this.props.item;if(this.props.isRecycleBin)return e.dateDeletedTime?Object(G.n)(e.dateDeletedTime):e.dateDeleted};t.prototype._computeAddedBy=function(){return this.props.item.creatorName};t.prototype._computeCreated=function(){var e=this.props.item;return e.dateCreatedTime?Object(G.n)(e.dateCreatedTime):e.dateCreated};t.prototype._computeDateShared=function(){var e=this.props.item;return e.dateSharedTime?Object(G.n)(e.dateSharedTime):e.dateShared};t.prototype._computePath=function(){var e=this.props.item;if(e.parent&&!this.props.isRecycleBin){for(var t=[],n=e;n;n=n.parent)t.unshift(n.name);return t}};t.prototype._computeOriginalLocation=function(){var e=this.props.item;if(this.props.isRecycleBin||Object(te.e)(e.queryType)||e.queryType===ee.e.SharedWithMe)return e.location};t.prototype._computeSize=function(){var e=this.props.item;return(e.size||e.totalSize)&&Y.e.getDisplayString(e.size||e.totalSize,{ignoreZero:!0})};t.prototype._computePanoramaResolution=function(){var e=this.props.item.panorama,t=e&&e.resolution;if(t)return k.format(W.informationPanoramaResolutionFormat,t)};t.prototype._computePanoramaRange=function(){var e=this.props.item.panorama||{},t=e.horizontalFov,n=e.verticalFov;if(t&&n)return k.format(W.informationPanoramaRangeFormat,Math.round(t),Math.round(n))};return t})(i.Component),me=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._scope=new p.e;n._itemParentHelper=t.resources.consume(K.e);var r=t.resources.consume(d.i);n._observables=n._scope.attach(new r({owner:n}));n.state={item:t.item.peek(),resources:t.resources,isCustomList:n._computeIsCustomList(),isChangeFolderTypeActionAvailable:!1};n._changeFolderTypeAction=new(n._managed(J.e))({});return n}t.prototype.componentDidMount=function(){var e=this;this._itemStateObservableSubscriber=this._observables.subscribe(this.props.item,function(t){e._setItemState(t)})};t.prototype.componentWillUnmount=function(){this._scope.dispose()};t.prototype.UNSAFE_componentWillUpdate=function(e){var t=this;if(e.item!==this.props.item){this._itemStateObservableSubscriber.dispose();this._itemStateObservableSubscriber=this._observables.subscribe(e.item,function(e){t._setItemState(e)});this.setState({item:e.item.peek()})}};t.prototype.render=function(){var e=this.state.item.extension,t=this.state.resources.consume(Q.ve),n={item:this.state.item,isCustomList:this.state.isCustomList,isChangeFolderTypeActionAvailable:this.state.isChangeFolderTypeActionAvailable,isRecycleBin:this.state.resources.consume(Q.ve).isRecycleBin(this.state.item.queryType),isAnonymousUser:this.state.resources.consume(Q.S).getIdentity().type===$.e.anonymous,fileHandlerProviderFileTypeName:this.state.resources.consume(C.e.local).getFileTypeName(e),pathCopyValue:t.getCanonicalUrl?t.getCanonicalUrl(this.state.item.key):null};return i.createElement(ve,Object(r.__assign)({},n))};t.prototype._setItemState=function(e){this.setState({item:e,isCustomList:this._computeIsCustomList(),isChangeFolderTypeActionAvailable:this._changeFolderTypeAction.isAvailable()})};t.prototype._computeIsCustomList=function(){var e=this._observables.unwrap(this._itemParentHelper.getFacetedAncestorOrSelf(this.props.item(),"list"));return!!e&&!e.list.isDocumentLibrary};t.prototype._managed=function(e){this.state.resources&&(e=this.state.resources.injected(e));return this._scope.attached(e)};return t})(i.PureComponent),ge=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return i.createElement(me,{item:t,resources:n})};return t})(i.Component),ye=n(26),be=n(1077);Object(x.n)([{rawString:".locationSection_913e5bc8{padding:4px}.locationSectionTitle_913e5bc8{font-size:14px;color:#605e5c}.locationSectionPlaces_913e5bc8{font-size:14px;line-height:30px}.locationSectionPlaceLink_913e5bc8{font-size:14px}.locationSectionPlaceText_913e5bc8{font-size:14px}\n"}]);var we=n(1635),Ee=n(1),Se=n(59),xe=n(6),Te=n(40),Ne=n(3659),Ce=n(27),ke=Object(Te.t)(function(e,t){var n=t.itemKey,r=e.demandItemFacet(xe.x,n),s=e.demandItemFacet(xe.m,n),o=[];if(r&&s){var u=e.demandItemFacet(Ee.Ye,t.itemKey,{suppressGetItems:!0}),a=e.demandItemFacet(Ee.pt,n),f=a&&a.itemKey;if(u){var l=e.demandItemFacet(xe.h,f),c=e.demandItemFacet(Ee.je,f),h=u.siteUrl,p=h&&h+"/"+c,d=c&&i.createElement(we.e,{className:"locationSectionPlaceLink_913e5bc8",title:l,href:p},i.createElement("div",{className:"locationSectionPlaceText_913e5bc8"},l));d&&o.push(d)}for(var v=Object(Ce.e)(e,{enableA2ODMoveShortcuts:Se.s}).enableA2ODMoveShortcuts,m=e.demandItemFacet(Ee.dt,f),g=m&&m.locationKeys||[],y=[],b=0,w=g;b<w.length;b++){var E=w[b],S=e.demandItemFacet(xe.h,E),x=k.format(Ne.r,S);(!v||y.indexOf(x)<0)&&y.push(x)}y.forEach(function(e){var t=i.createElement("div",{className:"locationSectionPlaceText_913e5bc8"},e);o.push(t)});if(v){var T=e.demandItemFacet(Ee.vt,n),N=T&&T-g.length;if(N&&N>0){var C=1===N?Ne.e:k.format(Ne.t,N),L=i.createElement("div",{className:"locationSectionPlaceText_913e5bc8"},C);o.push(L)}}}return o.length>0?i.createElement("div",{className:"locationSection_913e5bc8"},i.createElement("div",{className:"locationSectionTitle_913e5bc8"},Ne.n),i.createElement("div",{className:"locationSectionPlaces_913e5bc8"},o)):null}),Le=n(1003);Object(x.n)([{rawString:".od-InfoPane-ShortcutLocationSection{padding:0 12px}"}]);var Ae=Object(ye.s)()(Object(ye.t)()(Object(ye.r)()(ke)));function Oe(e){var t=e.resources.consume(Le.e);return e.item.remoteItem&&ke?i.createElement(be.e,{store:t},i.createElement("div",{className:"od-InfoPane-ShortcutLocationSection"},i.createElement(Ae,null))):null}var Me=n(3192),_e=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources,r=e.isHeaderHidden;return i.createElement(I.e,{sectionControlKey:Me.t,item:t,resources:n,isHeaderHidden:r})};return t})(i.Component),De='<div class="InfoPane-section InfoPaneSection--tags" data-bind="visible:isSectionVisible,css:{\'is-expanded\':sectionHelper.isExpanded,\'no-arrow\':!sectionHelper.showArrow}"><div class="InfoPane-sectionHeader" data-bind="toggle:sectionHelper.isExpanded,attr:{\'aria-expanded\':sectionHelper.isExpanded(),tabindex:sectionHelper.showArrow?0:-1,role:sectionHelper.showArrow?\'button\':\'\'}">\x3c!--ko if:sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i>\x3c!--/ko--\x3e<h2 class="InfoPane-sectionHeaderText InfoPane-tagSectionHeaderText" data-bind="text:sectionHeader"></h2>\x3c!--ko if:showTagsEditorAction.isAvailable()&&tags().length!==0--\x3e<a class="InfoPane-tag-manageTagButton" href="#" data-bind="automation:\'manageTagLink\',text:$component.manageTagLinkLabel,click:launchTagEditor"></a>\x3c!--/ko--\x3e</div><div class="od-TaggingSection-screenReaderOnly" aria-live="assertive" role="status" data-bind="attr:{\'aria-label\':liveUpdateAnnouncement}"></div>\x3c!--ko if:tags().length===0--\x3e<div class="od-TaggingSection-addTagIcon"><i class="ms-Icon ms-Icon--Tag" data-bind="icon:true"></i></div><a class="od-TaggingSection-addTagIconButton" href="#" data-bind="automation:\'addTagIconLabel\',text:$component.addTagIconLabel,click:launchTagEditor"></a>\x3c!--/ko--\x3e<div class="InfoPane-tags" data-bind="foreach:tags"><div class="InfoPane-tag"><button class="InfoPane-tagLink newTagStyling" data-bind="click:navigateAction.execute.bind(navigateAction),attr:{title:tooltip,\'aria-label\':tagLabel},css:{\'ms-font-s\':!$parent.isFluentEnabled,\'ms-font-m\':$parent.isFluentEnabled}"><div class="InfoPane-tagName" data-bind="text:name"></div></button>\x3c!--ko if:removeAction.isAvailable()&&!isDeleting()--\x3e<button class="InfoPane-removeTag newTagStyling ms-font-s" data-bind="click:removeAction.execute.bind(removeAction),attr:{\'aria-label\':deleteTagLabel}"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button>\x3c!--/ko--\x3e\x3c!--ko if:isDeleting--\x3e<span class="InfoPane-removeTag ms-font-s" data-bind="component:{name:$component.loadingSpinnerTagName,params:{loadingText:\'\'}}"></span>\x3c!--/ko--\x3e</div></div><div class="od-tagsFeedback-component" data-bind="react:imageTagFeedbackControlParams"></div></div>';Object(x.n)([{rawString:".InfoPane-tags{margin-top:10px}.InfoPane-tag,.InfoPane-tag-old{font-size:12px;line-height:32px;background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:";border:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";display:inline-block;height:32px;margin:0 8px 8px 0;white-space:nowrap}html[dir=rtl] .InfoPane-tag,html[dir=rtl] .InfoPane-tag-old{margin:0 0 8px 8px}.isFluent .InfoPane-tag,.isFluent .InfoPane-tag-old{border:0;border-radius:2px;height:28px;line-height:28px;vertical-align:top;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.InfoPane-tag{border:none;height:24px;line-height:24px}.InfoPane-tagLink{display:inline-block;overflow:hidden;cursor:pointer;height:100%}.InfoPane-tagLink.newTagStyling{border:none;background-color:inherit}.isFluent .InfoPane-tagLink{border-radius:2px;padding:4px 8px}.isFluent .InfoPane-tagLink:hover{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.InfoPane-tagName{display:inline-block;padding:0 8px;max-width:180px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.isFluent .InfoPane-tagName{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";padding:0}.InfoPane-removeTag{color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:";width:32px;text-decoration:none;display:inline-block;vertical-align:top;text-align:center}.InfoPane-removeTag.newTagStyling{border:none;background-color:inherit}.isFluent .InfoPane-removeTag{width:28px;height:28px;border-radius:2px;padding:0 8px}.isFluent .InfoPane-removeTag:hover{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.InfoPane-removeTag .od-LoadingSpinner-loadingGif{vertical-align:text-bottom}.InfoPane-removeTag:hover,.InfoPane-tagLink:hover,.od-Focus--enabled .InfoPane-removeTag:focus,.od-Focus--enabled .InfoPane-tagLink:focus{color:"},{theme:"black",defaultValue:"#000000"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";cursor:pointer}.InfoPane-tag-addTag{font-size:12px;display:inline-block;text-decoration:none;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";margin-top:5px}.InfoPane-tag-manageTagButton,.od-TaggingSection-addTagIconButton{text-decoration:none;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:12px;line-height:16px;display:block}.od-DetailsPane-LegacySection .InfoPaneSection--tags .InfoPane-sectionHeader{border-bottom:.5px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";padding-bottom:4px}.InfoPane-tagSectionHeaderText{display:contents}.od-TaggingSection-addTagIcon{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";width:32px;height:32px;border-radius:50%;position:relative;font-size:16px;box-sizing:border-box;align-content:center;border:1px solid transparent;display:inline-block;padding:7px;margin:10px 0 4px 0}html[dir=ltr] .InfoPane-tag-manageTagButton{float:right}html[dir=rtl] .InfoPane-tag-manageTagButton{float:left}.od-TaggingSection-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}]);var Pe,He=n(1744),Be=(n(1681),n(1651)),je=n(2075),Fe=n(3268);(function(e){e[e.LocationAndEventsAPI=0]="LocationAndEventsAPI";e[e.ObjectDetectors=1]="ObjectDetectors";e[e.LocationBasedPlace=2]="LocationBasedPlace";e[e.UserDefined=3]="UserDefined";e[e.SystemDefined=4]="SystemDefined"})(Pe||(Pe={}));var Ie=Pe,qe=n(888),Re=n("knockout-lib"),Ue=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._tag=t.tag;n.name="#"+(n._tag.localizedTag||n._tag.tag);n.tagLabel=n.name+" "+Fe.i;n.deleteTagLabel=Fe.t;var r=n.resources.consume(X.e),i=n.resources.consume(Q.ve);n.removeAction=new(n.managed(r.RemoveTagAction))({tag:Re.observable(n._tag)});n.navigateAction=new(n.managed(r.NavigationAction))({url:i.getTagUrl(n._tag),target:"_blank"});n.isDeleting=Re.observable(!1);n.name.length>20?n.tooltip=n.name:n.tooltip=null;n.createComputed(function(){n.removeAction.isExecuting()&&n.isDeleting(!0)});return n}return t})(Be.t),ze=n(2109),We=n(1006),Xe=n(1663),Ve=n(3),$e=Object(H.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(["263","ondemand.resx-ondemand"],4317)];case 1:return[2,e.sent().default]}})})}),Je=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.loadingSpinnerTagName=He.e.tagName;var i=r.resources.consume(X.e);r._engagement=r.resources.consume(qe.e);r.addBindingHandlers({toggle:je.e,react:Xe.t});r._item=t.item;r.sectionHelper=new(r.managed(ze.e));r._initializeTags();var s=Object(Ve.Wi)(f.EditTagsActionConsistency)?i.EditTagsAction:i.ShowTagsEditorAction;r.showTagsEditorAction=new(r.managed(s));r.addTagIconLabel=Fe.e;r.addTagLinkLabel=Fe.n;r.manageTagLinkLabel=Fe.n;r.addTagIconLabel=Fe.e;r.sectionHeader=Fe.r;r.isFluentEnabled=r.resources.consume(We.e);return r}t.prototype.launchTagEditor=function(e,t){this.showTagsEditorAction.execute(t);this._engagement.logData({name:"TagsSection.LaunchTagEditor",isIntentional:!0})};t.prototype._initializeTags=function(){var e=this,t=this.observables,n=t.createArray();t.compute(function(){n(e._item().tags||[])});var r=this.addDisposable(n.filter(function(e){var t=Ie[e.source];return t!==Ie.LocationAndEventsAPI&&t!==Ie.SystemDefined})),i=this.getTagsSet(r());this.liveUpdateAnnouncement=this.addDisposable(t.compute(function(){var t=e.getTagsSet(r()),n=e.getSetAMinusSetB(i,t),s=e.getSetAMinusSetB(t,i),o="";s.size>0&&n.size>0?o=k.format(Fe.u,e.getStringFormTagsSet(s),e.getStringFormTagsSet(n)):s.size>0?o=k.format(Fe.s,e.getStringFormTagsSet(s)):n.size>0&&(o=k.format(Fe.o,e.getStringFormTagsSet(n)));i=t;return o}));this.isSectionVisible=t.pureCompute(function(){return r().length>0||e.showTagsEditorAction.isAvailable()});this.imageTagFeedbackControlParams={componentType:$e,props:{isDetailsPane:!0,isTagsPivot:!1,isResultsOptions:!1,tags:r().map(function(e,t,n){return e.tag})}};this.tags=this.addDisposable(r.map({mappingWithDisposeCallback:function(t){var n=new(e.resources.injected(Ue))({tag:t});return{mappedValue:n,dispose:function(){return n.dispose()}}}}))};t.prototype.getTagsSet=function(e){for(var t=new Set,n=0,r=e;n<r.length;n++){var i=r[n];t.add("#"+(i.localizedTag||i.tag))}return t};t.prototype.getSetAMinusSetB=function(e,t){for(var n=new Set(e),r=0,i=Array.from(t);r<i.length;r++){var s=i[r];n.delete(s)}return n};t.prototype.getStringFormTagsSet=function(e){for(var t="",n=0,r=Array.from(e);n<r.length;n++){t=t+" "+r[n]}t.trim();t.replace(" #",", #");return t};t.dependencies=Object(r.__assign)({},Be.t.dependencies);return t})(Be.t),Ke=n(1652),Qe=n(1653),Ge=(Object(Ke.e)({tagName:"ms-tags-info-pane-section",template:De,viewModel:Je,synchronous:!0}),Object(Qe.t)({automationName:"ms-tags-info-pane-section",name:"TagsSection",template:De,viewModelType:Je})),Ye=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return i.createElement(I.e,{sectionControlKey:Ge,item:t,resources:n})};return t})(i.Component),Ze='<div class="InfoPane-section InfoPaneSection--location" data-bind="css:{\'is-expanded\':sectionHelper.isExpanded,\'no-arrow\':!sectionHelper.showArrow}"><div class="InfoPane-sectionHeader" data-bind="toggle:sectionHelper.isExpanded,attr:{\'aria-expanded\':sectionHelper.isExpanded(),tabindex:sectionHelper.showArrow?0:-1,role:sectionHelper.showArrow?\'button\':\'\'}">\x3c!--ko if:sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon:true"></i>\x3c!--/ko--\x3e<h2 class="InfoPane-sectionHeaderText InfoPane-locationSectionHeaderText" data-bind="text:sectionHeader"></h2></div><div class="InfoPane-sectionContent"><div class="InfoPane-location"><div class="InfoPane-location-area"><div data-bind="bingMap:bingMapOptions"></div><div class="InfoPane-location-text" data-bind="text:location"></div></div></div></div></div>';Object(x.n)([{rawString:".InfoPane-location-text{margin-top:10px}.od-DetailsPane-LegacySection .InfoPaneSection--location .InfoPane-sectionHeader{border-bottom:.5px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";padding-bottom:4px}.InfoPane-locationSectionHeaderText{display:contents}"}]);Object(x.n)([{rawString:".BingMap-controls{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:";border:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";box-sizing:border-box;width:213px;padding:3px}.BingMap-controls-icon{display:inline-block;cursor:pointer}.BingMap-controls-icon .ms-Icon{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:10px}[dir=ltr] .BingMap-controls-icon:first-child{margin-right:5px}[dir=rtl] .BingMap-controls-icon:first-child{margin-left:5px}.BingMap-controls-icon:last-child{display:inline-block;margin-top:2px}html[dir=ltr] .BingMap-controls-icon:last-child{float:right}html[dir=rtl] .BingMap-controls-icon:last-child{float:left}[dir=ltr] .BingMap-controls-icon:last-child{margin-right:5px}[dir=rtl] .BingMap-controls-icon:last-child{margin-left:5px}"}]);var et=n(71),tt=n(25),nt=(function(){function e(){}e.init=function(t,n){var r=this,i=Re.utils.unwrapObservable(n())||{},s=new se.e(this),o=0,u=6,a=!1,f=function(){if(!a)if(Microsoft.Maps.Location){var n=i.height||140,l=i.width||213,c={credentials:"AkQiChx2gUgMUwPYSb1Vg15L-fSor6dm_tNjKDcpIN04-6qD2eu8OlYZXvPg0yfa",enableSearchLogo:!1,enableClickableLogo:!1,showDashboard:!1,showScalebar:!1,showMapTypeSelector:!1,center:new Microsoft.Maps.Location(i.latitude(),i.longitude()),disableKeyboardInput:!0,zoom:10,height:n,width:l},h=document.createElement("div");h.style.height=n+"px";h.style.width=l+"px";t.appendChild(h);var p=new Microsoft.Maps.Map(h,c);e._addMapControls(t,p,i);Re.computed(function(){i.latitude();i.longitude();e._updateMap.call(r,p,i)},null,{disposeWhenNodeIsRemoved:t})}else if(u>0){u--;o+=500;s.setTimeout(f,o)}else t.innerHTML=W.locationMapFailedLoadLocationText};window.require(["bingmapsv8"],f.bind(this));Re.utils.domNodeDisposal.addDisposeCallback(t,function(){a=!0;s.dispose()})};e._addMapControls=function(t,n,r){var i=function(e){var t=n.getZoom()+e;n&&n.setView({zoom:t})},s=document.createElement("div");s.className="BingMap-controls";s.appendChild(e._getIcon("Remove",!0,function(e){i(-1);return!1}.bind(this)));s.appendChild(e._getIcon("Add",!0,function(e){i(1);return!1}.bind(this)));s.appendChild(e._getIcon("StackIndicator",!1,function(e){var t="http://www.bing.com/maps/?v=2&where1="+r.latitude()+", "+r.longitude();window.open(t,"_blank");return!1}.bind(this)));t.appendChild(s)};e._getIcon=function(e,t,n){var r=document.createElement("div");r.className="BingMap-controls-icon";r.onclick=n;var i=document.createElement("i");i.className=Object(tt.C)(e)+(t?" "+Object(tt.C)("Circle"):"");r.appendChild(i);return r};e._updateMap=function(e,t){try{var n=t.latitude(),r=t.longitude(),i=new Microsoft.Maps.Location(n,r);e.setView({center:i});e.entities.clear();var s=new Microsoft.Maps.Pushpin(i,null);e.entities.push(s)}catch(e){et.e.log(e)}};return e})(),rt=n(52),it=(function(){function e(){}e.fetch=function(t){return new rt.n(function(n,r){var i=rt.n.timeout(6e4).then(function(){r("JSONP call timeout, url: "+t)}),s="OneDrive_JSONPCallback_"+e._jsonpCallbackCounter++,o=document.createElement("script");window[s]=e._evalJSONP(n,r,o,s,i);t+=(-1===t.indexOf("?")?"?":"&")+"jsonp="+s;o.src=t;document.getElementsByTagName("head")[0].appendChild(o)})};e._evalJSONP=function(e,t,n,r,i){return function(s){n.parentElement.removeChild(n);delete window[r];i.cancel();if("string"==typeof s)try{JSON.parse(s)}catch(e){t(e)}else JSON.parse(JSON.stringify(s))?e(s):t("JSONP call returned invalid or empty JSON")}};e._jsonpCallbackCounter=0;return e})(),st={},ot=(function(){function e(){}e.prototype.getLocationName=function(e,t){var n=st[e+","+t]||"";if(n)return rt.n.wrap(n);var r="https://dev.virtualearth.net/REST/v1/Locations/"+e+","+t+"?entityType=adminDistrict&c="+(window.$Config&&$Config.mkt||"en-us")+"&key=AkQiChx2gUgMUwPYSb1Vg15L-fSor6dm_tNjKDcpIN04-6qD2eu8OlYZXvPg0yfa";return it.fetch(r).then(function(r){var i=r&&200===r.statusCode&&r.resourceSets,s=i&&i.length&&i[0].resources,o=s&&s.length&&s[0].address;if(o){var u=o.locality,a=o.adminDistrict,f=o.countryRegion;if(f){n=f;if(a){n=k.format(W.locationMapLocationTextWithoutCity,a,f);u&&(n=k.format(W.locationMapLocationText,u,a,f))}else u&&(n=k.format(W.locationMapLocationTextWithoutDistrict,u,f))}st[e+","+t]=n}return n})};return e})(),ut=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.addBindingHandlers({toggle:je.e,bingMap:nt});var i=r.observables;r._bingDataSource=new(r.managed(ot));r.sectionHelper=new(r.managed(ze.e));r.location=i.create("");r.bingMapOptions={latitude:i.create(0),longitude:i.create(0)};r.sectionHeader=W.locationInfoPaneHeader;r._item=t.item;i.compute(r._computeItemChanged);return r}t.prototype._computeItemChanged=function(){var e=this,t=this._item().geoLocation;if(t){var n=t.latitude,r=t.longitude;this._bingDataSource.getLocationName(n,r).then(function(t){e.location(t)});var i=this.bingMapOptions;i.latitude(n);i.longitude(r)}};t.dependencies=Object(r.__assign)({},Be.t.dependencies);return t})(Be.t),at=(Object(Ke.e)({tagName:"ms-location-section",template:Ze,viewModel:ut,synchronous:!0}),Object(Qe.t)({automationName:"ms-location-section",name:"LocationSection",template:Ze,viewModelType:ut})),ft=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return i.createElement(I.e,{sectionControlKey:at,item:t,resources:n})};return t})(i.Component),lt=n(3196);Object(x.n)([{rawString:".od-DetailsPane-ItemPreviewSection{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-DetailsPane-ItemPreviewSection .InfoPaneSection--preview{margin-bottom:0}.od-DetailsPane-ItemPreviewSection .InfoPaneSection--viewCountLink{padding:4px 16px}.od-DetailsPane-ItemPreviewSection .InfoPaneSection--viewCountLink .AnalyticsActionBarField{padding:0}.od-DetailsPane-ItemPreviewSection .InfoPaneSection--viewCountLink .AnalyticsActionBarField .AnalyticsActionBar--item{height:auto;padding:0}.od-DetailsPane-ItemPreviewSection .InfoPaneSection--viewCountLink .AnalyticsActionBarField .AnalyticsActionBar--item .ms-AnalyticsStats--stats{height:auto;padding:0}"}]);var ct=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return i.createElement("div",{className:"od-DetailsPane-ItemPreviewSection"},i.createElement(I.e,{sectionControlKey:lt.t,item:t,resources:n}))};return t})(i.Component),ht=n(3269),pt=n(3199),dt=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return i.createElement(I.e,{sectionControlKey:pt.t,item:t,resources:n})};return t})(i.Component),vt=n(3200),mt=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return i.createElement(I.e,{sectionControlKey:vt.t,item:t,resources:n})};return t})(i.Component),gt=n(3191),yt=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return i.createElement(I.e,{sectionControlKey:gt.t,item:t,resources:n})};return t})(i.Component),bt=n(993);n(3025);var wt=function(e){var t=e.items.length>1?W.externalItemsMessage:W.externalItemMessage;return i.createElement("div",{className:"od-DetailsPane-LegacySection"},i.createElement("div",{className:"InfoPane-section InfoPaneSection--itemStatus no-arrow"},i.createElement(bt.e,{className:"itemStatus-icon",iconName:"Globe"}),i.createElement("div",{className:"itemStatus-message"},t)))},Et=n(4),St=n(886),xt=n(1419),Tt=n(2060),Nt=n(3026),Ct=n(2485),kt=n(472),Lt={suggestionTextOverflow:"ms-TagItem-TextOverflow"};var At=Object(kt.e)(),Ot=Object(xt.e)(function(e){var t=e.styles,n=e.theme,r=e.children,s=At(t,{theme:n});return i.createElement("div",{className:s.suggestionTextOverflow}," ",r," ")},function(e){var t=e.className,n=e.theme;return{suggestionTextOverflow:[Object(tt.x)(Lt,n).suggestionTextOverflow,{overflow:"hidden",textOverflow:"ellipsis",maxWidth:"60vw",padding:"6px 12px 7px",whiteSpace:"nowrap"},t]}},void 0,{scope:"TagItemSuggestion"}),Mt=(function(e){Object(Et.r)(t,e);function t(t){var n=e.call(this,t)||this;Object(St.e)(n);return n}t.defaultProps={onRenderItem:function(e){return i.createElement(Ct.e,Object(Et.e)({},e),e.item.name)},onRenderSuggestionsItem:function(e){return i.createElement(Ot,null,e.name)}};return t})(Tt.e),_t=Object(xt.e)(Mt,Nt.e,void 0,{scope:"TagPicker"}),Dt=n(1845),Pt=n(2481),Ht=n(2013),Bt=n(2975),jt=n(1637);Object(x.n)([{rawString:".od-DetailsPane-ImageTagsSectionMargin{margin:20px}.od-DetailsPane-ErrorText{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}"}]);var Ft,It,qt,Rt=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._currentTags=[];n._currentTagString="";n._picker=i.createRef();n._saveChanges=function(){return Object(r.__awaiter)(n,void 0,void 0,function(){var e,t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if((e=this._buildColumnStringFromTags(this._currentTags)).length>255){this.setState({isSaving:!1,errorMessage:P.a});return[2]}if(e===this._currentTagString)return[3,5];this.setState({isSaving:!0,errorMessage:""});r.label=1;case 1:r.trys.push([1,3,,4]);return[4,this._updateColumnData(e+"\t")];case 2:r.sent();return[3,4];case 3:t=r.sent();this.setState({isSaving:!1,errorMessage:t.Message});return[3,4];case 4:n=this._currentTagString.length>e.length?"AutoGenImageTags.Delete":"AutoGenImageTags.Add";v.e.logData({name:n,isIntentional:!0});this.setState({isSaving:!1,errorMessage:""});r.label=5;case 5:return[2]}})})};n._onItemSelected=function(e){return-1!==n._currentTags.map(function(e){return e.key}).indexOf(e.key.toString())?null:e};n._onFilterChanged=function(e,t){return[{key:e,name:e}]};n._updateColumnData=function(e){return Object(r.__awaiter)(n,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:t=this;return[4,this.props.resources.consumeAsync(Bt.e)];case 1:t._itemColumnDataSource=n.sent();return[4,this._itemColumnDataSource.updateItemColumns(this.props.item,{MediaServiceAutoTags:e})];case 2:n.sent();return[4,this.props.resources.consumeAsync(Q._)];case 3:return[4,n.sent().invalidateItems(this.props.item.key)];case 4:n.sent();return[2]}})})};n.state={isSaving:!1,isEditMode:!1,itemRefresh:!1,errorMessage:""};return n}t.prototype.render=function(){var e=this,t=this.props.item;if(!this._currentItem||t.key!==this._currentItem.key){this._currentItem=t;if(t&&t.properties&&void 0!==t.properties.MediaServiceAutoTags){this._currentTagString=t.properties.MediaServiceAutoTags;var n=""===this._currentTagString?[]:this._currentTagString.split(","),s=this._currentTagString.split(" ");1===n.length&&s.length>2&&(n=s);this._currentTags=n.map(function(e){var t=e.trim().replace("\t","");return{key:t,name:t}});this._currentTagString=this._buildColumnStringFromTags(this._currentTags);this.setState({isEditMode:0===n.length,errorMessage:""})}}return i.createElement("div",{className:"od-DetailsPane-ImageTagsSectionMargin"},i.createElement(Ht.e,{gap:5},i.createElement(Dt.e,{onClick:function(){e.setState({isEditMode:!0})}},P.r),!this.state.isEditMode&&i.createElement(Pt.e,{onClick:function(){e.setState({isEditMode:!0})}},this._currentTagString),this.state.isEditMode&&i.createElement(_t,{selectedItems:this._currentTags,componentRef:this._picker,removeButtonAriaLabel:P.s,onResolveSuggestions:this._onFilterChanged,getTextFromItem:this._getTextFromItem,pickerSuggestionsProps:{suggestionsHeaderText:P.u,noResultsFoundText:P.i},itemLimit:20,onChange:function(t){return Object(r.__awaiter)(e,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:this._currentTags=t;return[4,this._saveChanges()];case 1:e.sent();return[2]}})})},onItemSelected:this._onItemSelected}),this.state.isEditMode&&i.createElement(Pt.e,{variant:"small"},P.n),this.state.isSaving&&i.createElement(jt.e,{label:P.o,ariaLive:"assertive",labelPosition:"right"}),this.state.errorMessage&&i.createElement(Pt.e,{variant:"small",className:"od-DetailsPane-ErrorText"},this.state.errorMessage)))};t.prototype._getTextFromItem=function(e){return e.name};t.prototype._buildColumnStringFromTags=function(e){return void 0===e||0===e.length?"":e.map(function(e){return e.name}).join(", ")};return t})(i.Component),Ut=n(2565),zt=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return i.createElement(i.Fragment,null,Object(Ut.e)())};return t})(i.Component),Wt=n(1972),Xt=n(1737),Vt=n(49),$t=n(1937),Jt=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._listContext=r.props.resources.consume(Vt.o);return r}t.prototype.render=function(){return this._publishingReminderText()?i.createElement(Wt.e,{messageBarType:Xt.e.warning,isMultiline:!0},this._publishingReminderText()):null};t.prototype._publishingReminderText=function(){var e=this.props.item;if(void 0!==e){var t=119===this._listContext.listTemplateType||850===this._listContext.listTemplateType,n=$t.e.getVersion(e,this._listContext),r=t?W.page:W.file,i=0===n.major?W.publish:W.republish;return!!this._listContext.isModerated?k.format(W.propertiesNotification_submitApproval,r):k.format(W.propertiesNotificaiton_publishing,i,r)}return""};return t})(i.Component),Kt=Object(H.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(["377","deferred.resx-deferred","ondemand.resx-ondemand"],4450)];case 1:return[2,e.sent().ItemPropertiesSection]}})})}),Qt=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props.sections.map(function(t){return e._renderSection(t)});return i.createElement("div",null,t)};t.prototype._renderSection=function(e){var t=this.props,n=t.items,r=t.resources,s=t.shouldHideSectionHeaders,o=n[0];return 19===e.type?i.createElement(Jt,{key:e.type,item:o.peek(),resources:r}):9===e.type?i.createElement(j,{key:e.type,item:o,resources:r}):10===e.type?i.createElement(q,{key:e.type,item:o,resources:r}):12===e.type?i.createElement(ge,{key:e.type,item:o,resources:r}):15===e.type?i.createElement(ct,{key:e.type,item:o,resources:r}):18===e.type?i.createElement(ht.e,{isScheduling:!0,key:e.type,item:o,resources:r}):7===e.type?Ve.Vi?i.createElement(Kt,{key:e.type,resources:r}):i.createElement(ht.e,{item:void 0,key:e.type,resources:r}):14===e.type?i.createElement(dt,{key:e.type,item:o,resources:r}):3===e.type?i.createElement(mt,{key:e.type,item:o,resources:r}):8===e.type?i.createElement(yt,{key:e.type,item:o,resources:r}):16===e.type?i.createElement(wt,{key:e.type,items:n.map(function(e){return e.peek()})}):17===e.type?i.createElement(zt,{key:e.type}):6===e.type?i.createElement(U,{key:e.type,item:o,resources:r}):1===e.type?i.createElement(V,{key:e.type,item:o,resources:r}):11===e.type?i.createElement(_e,{key:e.type,item:o,resources:r,isHeaderHidden:s}):5===e.type?i.createElement(Ye,{key:e.type,item:o,resources:r}):4===e.type?i.createElement(ft,{key:e.type,item:o,resources:r}):21===e.type?i.createElement(Oe,{key:e.type,item:o.peek(),resources:r}):20===e.type?i.createElement(Rt,{key:e.type,item:o.peek(),resources:r}):null};return t})(i.Component),Gt=n(1503),Yt=n(1871),Zt=n(1699),en=n(1739),tn=n(2615),nn=n(3660),rn=n(891),sn=n(1774);(function(e){e[e.HIDE=0]="HIDE";e[e.SHOW=1]="SHOW";e[e.NONE=2]="NONE"})(Ft||(Ft={}));(function(e){e.Meeting="Meeting"})(It||(It={}));(function(e){e.Teams="Teams";e.SharePoint="SharePoint"})(qt||(qt={}));var on=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._showTranscriptMenu=function(e,t){void 0===t&&(t=void 0);var n=(t||r.props).items,i=r._getSelectedItem(n);if(i&&void 0!==i.video){var s=r._itemActivityFeedHelper.getGraphItemUrl(i,e)+"?$select=media,source";r._resources.consume(rn.e).send({path:s,apiName:"metadata",apiVersion:"v2.1",requestType:"GET",allowCookies:!0}).then(function(e){e.media&&e.media.mediaSource&&e.media.mediaSource.contentCategory===It.Meeting&&e.source&&e.source.externalId&&e.source.application===qt.Teams?void 0===e.media.isTranscriptionShown||!0===e.media.isTranscriptionShown?r.setState({hideShowState:Ft.HIDE}):r.setState({hideShowState:Ft.SHOW}):r.setState({hideShowState:Ft.NONE})})}else r.setState({hideShowState:Ft.NONE})};r._getHideShowState=function(){return r.state.hideShowState};r._toggleCaptionVisiblity=function(){var e=r.props.items,t=r._getSelectedItem(e),n=r._itemActivityFeedHelper.getGraphItemUrl(t,r.state.graphDataSource),i=r._resources.consume(rn.e),s=r.state.graphDataSource.getAccessToken(t,{apiVersion:"v2.0",useDirectEndpoint:!0});i.send({path:n,apiName:"transcript",apiVersion:"v2.0",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify({media:{isTranscriptionShown:r.state.hideShowState!==Ft.HIDE}}),accessToken:s}).then(function(e){r.setState({hideShowState:r.state.hideShowState===Ft.HIDE?Ft.SHOW:Ft.HIDE})},function(e){r.setState({hideShowState:r.state.hideShowState})});r.setState({hideHideCaptionDialog:!0,hideShowCaptionDialog:!0})};r._onDeleteAllConfirm=function(){var e=r.props.items,t=r.state.currentUserEmail,n=r._getSelectedItem(e),i=r._getCommentItemWrapper(n);r._itemCommentsStore.deleteAllComments(i,t).done();r._onDismissDeleteAllDialog()};r._onDismissDeleteAllDialog=function(){r.setState({hideDeleteAlldialog:!0})};r._onDismissHideCaptionDialog=function(){r.setState({hideHideCaptionDialog:!0})};r._resources=t.resources;r._itemCommentsStore=r._resources.consume(tn.e);r._itemActivityFeedHelper=r._resources.consume(Q.C);r._engagement=r._resources.consume(qe.e);r.state={graphDataSource:r._resources.consume(Q.b.optional),hideDeleteAlldialog:!0,hideHideCaptionDialog:!0,hideShowCaptionDialog:!0,hideShowState:Ft.NONE,currentUserEmail:r._itemActivityFeedHelper.getCurrentUserEmail()};return r}t.prototype.componentDidMount=function(){var e=this,t=this.props.items,n=this._getSelectedItem(t);this.state.graphDataSource?Object(f.isFeatureEnabled)(f.TeamsMeetingRecordingPlayerCaptionSupport)&&"sharePoint"===this._itemActivityFeedHelper.getAPIEnvironment(n)&&this._showTranscriptMenu(this.state.graphDataSource):this._resources.consumeAsync(Q.b).then(function(t){e.setState({graphDataSource:t});Object(f.isFeatureEnabled)(f.TeamsMeetingRecordingPlayerCaptionSupport)&&"sharePoint"===e._itemActivityFeedHelper.getAPIEnvironment(n)&&e._showTranscriptMenu(t)})};t.prototype.componentWillReceiveProps=function(e){var t=e.items,n=this._getSelectedItem(t);Object(f.isFeatureEnabled)(f.TeamsMeetingRecordingPlayerCaptionSupport)&&"sharePoint"===this._itemActivityFeedHelper.getAPIEnvironment(n)&&e&&1===e.items.length&&this.props&&this.props.items.length>0&&(e.items[0].peek().itemId!==this.props.items[0].peek().itemId||e.items.length!==this.props.items.length)&&this._showTranscriptMenu(this.state.graphDataSource,e)};t.prototype.render=function(){var e=this.props.items,t=this._getSelectedItem(e),n=this._getMenuItems(t);return n?i.createElement(i.Fragment,null,i.createElement(ae.e,{content:nn.f},i.createElement(oe.e,{className:"od-DetailsPane-GlobalSettingsMenu",role:"button",ariaLabel:nn.f,iconProps:{iconName:"More"},onRenderMenuIcon:function(){},menuProps:{directionalHint:c.e.bottomAutoEdge,isBeakVisible:!1,gapSpace:0,shouldFocusOnMount:!0,items:n,styles:{root:"od-DetailsPane-GlobalSettingsMenuItems"}}})),i.createElement(Yt.e,{hidden:this.state.hideDeleteAlldialog,onDismiss:this._onDismissDeleteAllDialog,dialogContentProps:{type:Zt.e.normal,title:nn.t}},i.createElement(en.e,null,i.createElement(Gt.e,{disabled:!1,onClick:this._onDeleteAllConfirm,text:nn.r}),i.createElement(Gt.e,{disabled:!1,primary:!0,onClick:this._onDismissDeleteAllDialog,text:nn.n}))),i.createElement(Yt.e,{hidden:this.state.hideHideCaptionDialog,onDismiss:this._onDismissHideCaptionDialog,dialogContentProps:{type:Zt.e.normal,title:nn.s,isMultiline:!0,subText:nn.e}},i.createElement(en.e,null,i.createElement(Gt.e,{disabled:!1,primary:!0,onClick:this._toggleCaptionVisiblity,text:nn.s}),i.createElement(Gt.e,{disabled:!1,onClick:this._onDismissHideCaptionDialog,text:nn.n})))):null};t.prototype._getMenuItems=function(e){var t=this,n=this._getIsCommentDisabledSetting(e);if(e&&this._itemActivityFeedHelper.userCanManageCommentsSettings(e)){var r={key:"detailsPaneItem.enabledDisableComments",name:n?nn.a:nn.o,onClick:function(r,i){var s=!n,o=t._getCommentItemWrapper(e);t._itemCommentsStore.setCommentsDisabled(o,s,t.state.currentUserEmail);var u=e.folder?"folder":e.extension||"file",a=void 0!==e.sharingType?sn.e[e.sharingType]:void 0;t._engagement.logData({name:"GlobalSettingsMenu."+(n?"CommentingEnabled":"CommentingDisabled"),isIntentional:!0,extraData:{itemType:u,sharingType:a}})}},i={key:"detailsPaneItem.deleteAllComments",name:nn.i,onClick:function(e,n){t.setState({hideDeleteAlldialog:!1})}},s={key:"detailsPaneItem.globalHideOption",name:nn.s,onClick:function(e,n){t.setState({hideHideCaptionDialog:!1})}},o={key:"detailsPaneItem.globalShowOption",name:nn.u,onClick:function(e,n){t._toggleCaptionVisiblity()}},u=[r];n||"consumer"===this._itemActivityFeedHelper.getAPIEnvironment()||u.push(i);this._getHideShowState()===Ft.HIDE?u.push(s):this._getHideShowState()===Ft.SHOW&&u.push(o);return u}};t.prototype._getSelectedItem=function(e){var t=1===e.length&&e[0].peek();if(!t||!this._itemActivityFeedHelper.isWXPCommentingDisabled(t))return t&&this._itemActivityFeedHelper.isNonOfficeFileCommentsAvailable(t)?t:void 0};t.prototype._getCommentItemWrapper=function(e){return this._itemActivityFeedHelper.getCommentItemWrapper(e,this.state.graphDataSource)};t.prototype._getIsCommentDisabledSetting=function(e){return e&&e.comments&&e.comments.settings&&!!e.comments.settings.isCommentDisabled};return t})(i.Component),un=function(e){var t,n,r=e.items,s=e.resources,o=1===r.length?r[0]:void 0,u=null==o?void 0:o.peek(),a=null==u?void 0:u.key,f=null===(n=null===(t=null==u?void 0:u.comments)||void 0===t?void 0:t.settings)||void 0===n?void 0:n.isCommentDisabled,l=i.useReducer(function(e){return e+1},0)[1];i.useEffect(function(){var e=null==o?void 0:o.subscribe(function(e){var t,n;e.key===a&&(null===(n=null===(t=e.comments)||void 0===t?void 0:t.settings)||void 0===n?void 0:n.isCommentDisabled)===f||l()});return function(){null==e||e.dispose()}},[o,a,f]);return i.createElement(on,{items:r,resources:s})},an=n(1797),fn=n(1827),ln=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onClose=function(){r._isDetailsPaneExpanded(!1);O.t.raise(document.body,"resize",void 0,!0)};r._resources=t.resources;r._isDetailsPaneExpanded=r._resources.consume(fn.resourceKey);r.state={isCommentDisabledOnFile:!0};return r}t.prototype.componentDidMount=function(){if(this._headerDiv){this._onHeaderHeightChange();this._events.on(window,"resize",this._onHeaderHeightChange)}};t.prototype.shouldComponentUpdate=function(e,t){return e.items!==this.props.items||e.sectionGroup!==this.props.sectionGroup||e.isCollapsed!==this.props.isCollapsed||e.minHeight!==this.props.minHeight||e.onHeightChange!==this.props.onHeightChange||e.onHeaderHeightChange!==this.props.onHeaderHeightChange||e.resources!==this.props.resources||e.noStickies!==this.props.noStickies};t.prototype.componentWillUnmount=function(){this._headerDiv&&this._events.off(window,"resize",this._onHeaderHeightChange)};t.prototype.render=function(){var e=this,t=this.props,n=t.isCollapsed,r=t.minHeight,s=t.onHeightChange,o=t.noStickies;return i.createElement("div",{className:Object(L.e)("od-DetailsPane-PrimaryPane-wrapper",{"od-DetailsPane-PrimaryPane--isCollapsed":n}),style:{minHeight:!n&&r||this._headerDiv&&this._headerDiv.clientHeight}},i.createElement("div",{className:"od-DetailsPane-PrimaryPane"},i.createElement("div",{ref:function(t){e._headerDiv=t}},o?this._renderSectionsHeader():i.createElement(D.e,null,this._renderSectionsHeader())),i.createElement("div",{className:"od-DetailsPane-PrimaryPane-body"},i.createElement(_,{onHeightChange:s},this._renderSectionsBody()))))};t.prototype._renderSectionsHeader=function(){var e,t=this.props.items;if(1===t.length){var n=t[0].peek();e=n.displayName||n.name||""}else e=k.format(P.l,t.length);var r=this._renderPaneIcon();return i.createElement("div",{className:"od-DetailsPane-PrimaryPane-header",tabIndex:-1,"data-is-focusable":!1},i.createElement("div",{className:"od-DetailsPane-PrimaryPane-header-icon"},r),i.createElement("h2",{className:"od-DetailsPane-PrimaryPane-header-title"},e),i.createElement(un,{items:t,resources:this._resources}),i.createElement(oe.e,{className:"od-DetailsPane-PrimaryPane-header-close",iconProps:{iconName:"Cancel"},"aria-label":P.t,title:P.t,onClick:this._onClose}))};t.prototype._renderPaneIcon=function(){var e,t,n,r,s=this.props,o=s.items,u=s.resources;if(1===o.length){var a=o[0].peek();e=a.iconName||"genericfile";var f=a.extension,l=u.consume(C.e.optional);t=a.iconUrl||(function(e,t){return e&&e.getFileTypeIconUrl(t,!0)})(l,f)||N.e(u,e,32);n=(function(e,t){return e&&e.getFileTypeName(t,!0)})(l,f);r=an.i(a)}else{e="genericfile";t=N.e(u,e,32)}return i.createElement(T.e,{iconName:e,width:32,iconUrl:t,iconTitle:n,isDisabled:!1,tooltipText:r,ariaLabel:n,isClickable:!1,onClick:this._fileIconOnClick})};t.prototype._fileIconOnClick=function(e){};t.prototype._renderSectionsBody=function(){var e=this.props,t=e.items,n=e.sectionGroup,r=e.resources;return i.createElement(Qt,{items:t,sections:n.sections,resources:r})};t.prototype._onHeaderHeightChange=function(){if(this.props.onHeaderHeightChange){var e=this._headerDiv.clientHeight;this.props.onHeaderHeightChange(e)}};return t})(A.e);var cn=n(2069);Object(x.n)([{rawString:".od-DetailsPane-SecondaryPane-wrapper{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";overflow-x:hidden}.od-DetailsPane-SecondaryPane{padding-bottom:12px;box-shadow:0 -1px 6px rgba(0,0,0,.01)}.od-DetailsPane-SecondaryPane.od-DetailsPane-SecondaryPane--disabled{padding-bottom:0}.od-DetailsPane-SecondaryPane-header{padding:0 16px;text-align:center;height:48px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";box-shadow:0 -1px 6px rgba(0,0,0,.01);font-size:12px;border:0;width:100%;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.isFluent .od-DetailsPane-SecondaryPane-header{font-size:12px}.ms-ScrollablePane-stickyAbove .od-DetailsPane-SecondaryPane-header{box-shadow:0 -1px 3px rgba(0,0,0,.01)}.od-DetailsPane-SecondaryPane-header:hover{cursor:pointer}.od-DetailsPane-SecondaryPane-header.od-DetailsPane-SecondaryPane-header--CreateFocusIllusion{outline:1px solid transparent;box-shadow:0 0 0 1px "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:" inset}.od-DetailsPane-SecondaryPane-header.od-DetailsPane-SecondaryPane-header--nonStickyHeaderButton{position:absolute;margin-top:-48px;opacity:0}.od-DetailsPane-SecondaryPane-header.od-DetailsPane-SecondaryPane-header--nonStickyHeaderButton:focus{opacity:1}.od-DetailsPane-SecondaryPane-header--headerClickDisabled:hover{cursor:default}.od-DetailsPane-SecondaryPane-header--disabled{display:none}.od-DetailsPane-SecondaryPane-body{position:relative}.od-DetailsPane-SecondaryPane-header-icon{padding-top:3px;font-size:17px}.isFluent .od-DetailsPane-SecondaryPane-header-icon{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-DetailsPane-SecondaryPane-header-text{margin:0;font-size:12px;font-weight:400}"}]);var hn=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.state={isSecondaryPaneHeaderFocused:!1};return n}t.prototype.render=function(){var e=this,t=this.props,n=t.onHeaderClick,r=t.setHeaderDiv,s=t.isSecondaryPaneExpanded,o=t.noStickies,u=t.isHeaderDisabled,a=this.state.isSecondaryPaneHeaderFocused,f=i.createRef();return o?i.createElement("div",{ref:r},i.createElement("h2",{className:Object(L.e)("od-DetailsPane-SecondaryPane-header",{"od-DetailsPane-SecondaryPane-header--disabled":u,"od-DetailsPane-SecondaryPane-header--headerClickDisabled":!0})},i.createElement("div",{className:"od-DetailsPane-SecondaryPane-header-icon"},i.createElement(bt.e,{iconName:"GripperBarHorizontal"})),i.createElement("div",{className:"od-DetailsPane-SecondaryPane-header-text"},P.f))):i.createElement(i.Fragment,null,i.createElement("div",{ref:r},i.createElement(D.e,{stickyPosition:cn.e.Both},this.getHeaderButton(function(){var e;null===(e=f.current)||void 0===e||e.focus({preventScroll:!0});n()},a))),this.getHeaderButton(n,!1,f,function(){e.setState({isSecondaryPaneHeaderFocused:!0})},function(){e.setState({isSecondaryPaneHeaderFocused:!1})},s))};t.prototype.getHeaderButton=function(e,t,n,r,s,o){var u=this.props,a=u.isHeaderDisabled,f=u.isHeaderClickDisabled,l=!!n;return i.createElement("button",{ref:n,className:Object(L.e)("od-DetailsPane-SecondaryPane-header",{"od-DetailsPane-SecondaryPane-header--disabled":a,"od-DetailsPane-SecondaryPane-header--headerClickDisabled":f,"od-DetailsPane-SecondaryPane-header--nonStickyHeaderButton":l,"od-DetailsPane-SecondaryPane-header--CreateFocusIllusion":!!t}),tabIndex:f||!l?-1:void 0,onClick:f?void 0:e,"aria-hidden":!l,"aria-expanded":!!o||void 0,onFocus:r,onBlur:s},i.createElement("div",{className:"od-DetailsPane-SecondaryPane-header-icon"},i.createElement(bt.e,{iconName:"GripperBarHorizontal"})),i.createElement("div",{className:"od-DetailsPane-SecondaryPane-header-text"},P.f))};return t})(i.Component),pn=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.componentDidMount=function(){if(this._headerDiv){this._onHeaderHeightChange();this._events.on(window,"resize",this._onHeaderHeightChange)}};t.prototype.shouldComponentUpdate=function(e,t){return e.items!==this.props.items||e.sectionGroup!==this.props.sectionGroup||e.minHeight!==this.props.minHeight||e.onHeightChange!==this.props.onHeightChange||e.onHeaderHeightChange!==this.props.onHeaderHeightChange||e.resources!==this.props.resources||e.isSecondaryPaneExpanded!==this.props.isSecondaryPaneExpanded||e.noStickies!==this.props.noStickies};t.prototype.componentDidUpdate=function(e){e.sectionGroup.sections.length&&this.props.sectionGroup.sections.length||e.sectionGroup.sections.length===this.props.sectionGroup.sections.length||this._onHeaderHeightChange()};t.prototype.componentWillUnmount=function(){this._headerDiv&&this._events.off(window,"resize",this._onHeaderHeightChange)};t.prototype.render=function(){var e=this,t=this.props,n=t.sectionGroup,r=t.onHeightChange,s=t.minHeight,o=t.isSecondaryPaneExpanded,u=t.noStickies;return i.createElement("div",{className:"od-DetailsPane-SecondaryPane-wrapper",style:{minHeight:n.sections.length&&s||0}},i.createElement("div",{className:Object(L.e)("od-DetailsPane-SecondaryPane",{"od-DetailsPane-SecondaryPane--disabled":!n.sections.length})},i.createElement(hn,{onHeaderClick:this.props.onHeaderClick,isHeaderDisabled:!n.sections.length,isHeaderClickDisabled:!!this.props.isHeaderClickDisabled,setHeaderDiv:function(t){e._headerDiv=t},isSecondaryPaneExpanded:o,noStickies:u}),i.createElement("div",{className:"od-DetailsPane-SecondaryPane-body"},i.createElement(_,{onHeightChange:r},this._renderSectionsBody()))))};t.prototype._renderSectionsBody=function(){var e=this.props,t=e.items,n=e.sectionGroup,r=e.resources;return i.createElement(Qt,{items:t,sections:n.sections,resources:r,shouldHideSectionHeaders:1===n.sections.length})};t.prototype._onHeaderHeightChange=function(){if(this.props.onHeaderHeightChange){var e=this._headerDiv.clientHeight;this.props.onHeaderHeightChange(e)}};return t})(A.e),dn=n(774),vn=n(2443),mn=n(991),gn=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onPrimaryHeaderHeightChange=function(e){r.setState({primaryHeaderHeight:e})};r._onSecondaryHeaderHeightChange=function(e){r.setState({secondaryHeaderHeight:e})};r._onPaneHeightChange=function(){r._scrollablePane&&r._scrollablePane.forceLayoutUpdate()};r._onSecondaryPaneHeaderClick=function(){if(r._detailsPaneElement&&r._primaryPaneElement&&r._secondaryPaneElement){var e=r._detailsPaneElement.getBoundingClientRect().top;if(r._secondaryPaneElement.getBoundingClientRect().top-e<r._detailsPaneElement.clientHeight/2){r._primaryPaneElement.scrollIntoView(!0);r.setState({isSecondaryPaneExpanded:!1})}else{var t=r._scrollablePane.getScrollPosition();r._secondaryPaneElement.scrollIntoView(!0);r.setState({isSecondaryPaneExpanded:!0,scrollPosition:t});r._engagement.logData({name:"DetailsPane.ExpandSecondaryPane",isIntentional:!0})}}};r._scope=new p.e;r._observables=r._scope.attach(new S.e({owner:r}));r.state={availableSectionGroups:r._observables.ignore(function(){return r._computeSectionGroups(t)}),isSecondaryPaneExpanded:!1,detailsPaneHeight:void 0,primaryHeaderHeight:void 0,secondaryHeaderHeight:void 0,scrollPosition:0};r._engagement=r.props.resources.consume(qe.e);return r}t.prototype.componentWillMount=function(){this._returnFocusToElement=document.activeElement};t.prototype.componentDidMount=function(){this._addStoreListener(this.props);if(this._detailsPaneElement){vn.t("LaunchInfoPane");this._updateDetailsPaneHeight();this._events.on(window,"resize",this._updateDetailsPaneHeight);var e=Object(dn.i)(this._detailsPaneElement,this._primaryPaneElement,!1);e&&e.focus()}else vn.n("LaunchInfoPane")};t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this;e.allSectionGroups===this.props.allSectionGroups&&e.items===this.props.items||this.setState({availableSectionGroups:this._observables.ignore(function(){return t._computeSectionGroups(e)})})};t.prototype.shouldComponentUpdate=function(e,t){return e.items!==this.props.items||e.allSectionGroups!==this.props.allSectionGroups||e.resources!==this.props.resources||t.availableSectionGroups!==this.state.availableSectionGroups||t.isSecondaryPaneExpanded!==this.state.isSecondaryPaneExpanded||t.detailsPaneHeight!==this.state.detailsPaneHeight||t.primaryHeaderHeight!==this.state.primaryHeaderHeight||t.secondaryHeaderHeight!==this.state.secondaryHeaderHeight};t.prototype.UNSAFE_componentWillUpdate=function(e){e.allSectionGroups===this.props.allSectionGroups&&e.items===this.props.items||this._removeCurrentStoreListener()};t.prototype.componentDidUpdate=function(e){e.allSectionGroups===this.props.allSectionGroups&&e.items===this.props.items||this._addStoreListener(this.props);if(this._primaryPaneElement&&1===e.items.length&&1===this.props.items.length&&e.items[0].peek().key!==this.props.items[0].peek().key){this._primaryPaneElement.scrollIntoView(!0);this.setState({isSecondaryPaneExpanded:!1,scrollPosition:0})}};t.prototype.componentWillUnmount=function(){this._removeCurrentStoreListener();if(this._detailsPaneElement){this._events.off(window,"resize",this._updateDetailsPaneHeight);if(this._returnFocusToElement&&Object(mn.e)(document.body,this._returnFocusToElement))this._returnFocusToElement.focus();else{var e=document.querySelector('button[data-automationid="detailsPane"]');e&&e.focus()}}this._scope.dispose()};t.prototype.render=function(){var e=this,t=this.props,n=t.id,r=t.items,s=t.resources,o=this.state,u=o.availableSectionGroups,a=o.isSecondaryPaneExpanded,f=o.detailsPaneHeight,l=o.primaryHeaderHeight,c=o.secondaryHeaderHeight,h=o.scrollPosition;if(u&&u[0]){var p=0===u[0].sections.length;return i.createElement("div",{ref:function(t){e._detailsPaneElement=t},"data-automationid":"ms-info-pane",id:n,role:"region",className:Object(L.e)("od-DetailsPane",{"od-DetailsPane--secondaryPaneDisabled":!u[1]||!u[1].sections.length}),"aria-label":P.e},i.createElement(E.e,{componentRef:function(t){e._scrollablePane=t},initialScrollPosition:a?-1:h,className:"od-DetailsPane-scrollablePane"},i.createElement(ln,{ref:function(t){e._primaryPaneElement=w.findDOMNode(t)},items:r,sectionGroup:u[0],onHeightChange:this._onPaneHeightChange,onHeaderHeightChange:this._onPrimaryHeaderHeightChange,isCollapsed:a||p,minHeight:f&&f-(c||0)+1,resources:s,noStickies:!!f&&f<200}),u[1]?i.createElement(pn,{ref:function(t){e._secondaryPaneElement=w.findDOMNode(t)},items:r,sectionGroup:u[1],onHeaderClick:this._onSecondaryPaneHeaderClick,isHeaderClickDisabled:p,onHeightChange:this._onPaneHeightChange,onHeaderHeightChange:this._onSecondaryHeaderHeightChange,minHeight:f&&void 0!==l&&f-l,resources:s,isSecondaryPaneExpanded:a,noStickies:!!f&&f<200}):null))}return null};t.prototype._updateDetailsPaneHeight=function(){this.setState({detailsPaneHeight:this._detailsPaneElement.clientHeight})};t.prototype._removeCurrentStoreListener=function(){this._sectionGroupsSubscription.dispose()};t.prototype._addStoreListener=function(e){var t=this,n=this._observables.pureCompute(function(){return t._computeSectionGroups(e)});this._sectionGroupsSubscription=this._observables.subscribe(n,function(e){t.setState({availableSectionGroups:e})})};t.prototype._computeSectionGroups=function(e){return e.allSectionGroups.map(function(t){return{sections:t.sections.filter(function(t){return t.isAvailable(e.items.filter(function(e){return!!e&&!e().isPlaceholder}).map(function(e){return e.peek()}))})}})};return t})(A.e),yn=n(1674),bn=n(894),wn=new a.t({name:"KnockoutDetailsPaneHost",factory:{dependencies:{detailsPaneId:y.e,itemSelectionHelperType:yn.e},create:function(e){var t=e.detailsPaneId,n=e.itemSelectionHelperType;return{instance:function(e){var s=Object(bn.e)(function(){return new n({allowMultiSelect:!0,canFallback:!0})},[]),o=Object(b.n)(s.selection);return i.createElement(gn,Object(r.__assign)({},e,{id:t,items:o}))}}}}}),En=n(2977),Sn=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._getCoachmark=function(){if(r._allowCoachmark){var e=r._getTeachingBubbleCampaign();return r.state.showCoachmark&&r._root&&r._root.current?i.createElement(h.e,{target:r._root.current,teachingBubbleCampaign:e,directionalHint:c.e.leftCenter,onDismiss:r._onDismissTeachingBubble,onTeachingBubbleSeen:r._onTeachingBubbleSeen}):void 0}};r._onDismissTeachingBubble=function(){var e=r._coachmarkProvider;e&&e.hideCampaign();var t=r._getTeachingBubbleCampaign();r._teachingBubbleProvider&&r._teachingBubbleProvider.markBubbleAsDismissed(t);v.e.logData({name:"DocSetPropertiesCoachmark.Closed"})};r._onTeachingBubbleSeen=function(){var e=r._getTeachingBubbleCampaign();r._teachingBubbleProvider&&r._teachingBubbleProvider.markBubbleAsSeen(e);v.e.logData({name:"DocSetPropertiesCoachmark.Rendered"})};var s=r.context.dependencies.resources;r._root=Object(i.createRef)();r._scope=new p.e;r._coachmarkProvider=s.consume(g.e.optional);r._observables=r._scope.attach(new(s.consume(d.i))({owner:r}));var o=m.DOCSET_PROPERTIES_PANE.killSwitchGuid;r._allowCoachmark=Object(f.isFeatureEnabled)(m.DOCSET_PROPERTIES_PANE.flag)&&(!o||!l.e.isActivated(o));r.state={allSectionGroups:void 0,showCoachmark:!1};return r}t.prototype.componentDidMount=function(){var e=this;this._addStoreListener(this.props);this._observables.compute(function(){e._computeShowCoachmark()})};t.prototype.componentDidUpdate=function(){var e=this;this._observables.compute(function(){e._computeShowCoachmark()})};t.prototype.componentWillUnmount=function(){this._scope.dispose()};t.prototype.render=function(){var e=this.context.dependencies,t=e.detailsPane,n=e.resources,r=this.state.allSectionGroups,s=n.consume(y.e),o=!n.consume(We.e);return r?i.createElement(i.Fragment,null,i.createElement("div",{className:Object(L.e)("od-DetailsPaneWrapper",{isFluent:o}),ref:this._root},i.createElement(t,{allSectionGroups:r,id:s,resources:n})),this._getCoachmark()):null};t.prototype._getTeachingBubbleCampaign=function(){return m.DOCSET_PROPERTIES_PANE};t.prototype._addStoreListener=function(e){var t=this;this.context.dependencies.resources.consumeAsync(En.e).then(function(e){var n=t._scope.attach(new e({}));t.setState({allSectionGroups:n.getSectionGroups()})})};t.prototype._computeShowCoachmark=function(){var e=this;if(this._allowCoachmark){var t=this._coachmarkProvider;if(t){var n=this._observables.unwrap(t.getCurrentTeachingBubble());if(!n)return;if(n){var r=this._observables.unwrap(n.isVisible||!1),i=n.campaign();if(!i||i.campaignGuid!==this._getTeachingBubbleCampaign().campaignGuid){this.state.showCoachmark&&this.setState({showCoachmark:!1});return}var s=this.context.dependencies.resources;this._teachingBubbleProvider||(this._teachingBubbleProvider=s.consume(o.T.optional));this._teachingBubbleProvider&&this._teachingBubbleProvider.shouldBubbleBeAdded(i,!1).then(function(t){var n=!!(t&&r&&e._root&&e._root.current);e.state.showCoachmark!==n&&e.setState({showCoachmark:n})})}}}};t.contextTypes={dependencies:s.object.isRequired};return t})(i.Component),xn=Object(u.e)("DetailsPaneWrapper",Sn,{resources:a.o.local,detailsPane:wn})}],Array(37),[function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n("react-lib"),s=n(1423),o=n(2406),u=n(1553),a=n(267),f=n(2216),l=n(1141),c=function(e){var t=e.items,n=e.farItems,c=e.analyticsStats,h=e.isLink,p=e.showActionBar,d=void 0===p||p,v=!(!c||!c.itemAnalytics&&!c.isNotSupported&&c.status!==f.e.unsupport&&c.status!==f.e.failed),m=e.itemKey?i.createElement(l.e,{className:"analyticsActionBar_dec81559",commands:t,farCommands:n}):i.createElement(s.e,{className:"analyticsActionBar_dec81559",items:t,farItems:n});return i.createElement("div",null,i.createElement("div",{className:"analyticsActionBarStats_dec81559"},i.createElement(u.e,{width:"35%",isDataLoaded:v,shimmerElements:[{type:a.e.line,height:8}]},i.createElement(o.e,Object(r.__assign)({isLink:h,isCompact:!0},c)))),d&&(n.length>0||t.length>0)&&m)}}])]);