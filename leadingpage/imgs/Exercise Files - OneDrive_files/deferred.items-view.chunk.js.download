(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred.items-view","34"],Array(1441).concat([function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(5),i=n(370),s=new r.e("spSharedByMePage",{itemSet:Object(r.o)(i.t),after:Object(r.s)()})}],Array(73),[function(e,t,n){"use strict";n.r(t);n.d(t,"ConfirmationDialog",function(){return c});var r=n("react-lib"),i=n(1871),s=n(1699),o=n(1739),u=n(1772),a=n(1503),f=n(1944),l=n(2372),c=function(e){var t=e.onConfirm,n=e.onCancel,c=e.defaultToYes,h=void 0!==c&&c,p=e.defaultFocusToYes,d=void 0!==p&&p,v=e.yesText,m=void 0===v?l.t:v,g=e.noText,y=void 0===g?l.e:g,b=function(e){e&&e.focus()},w=h?u.e:a.e,E=h?a.e:u.e,S=d?void 0:b,x=d?b:void 0;return r.createElement(f.e,null,r.createElement(i.e,{dialogContentProps:{type:s.e.close,subText:e.prompt?e.prompt:""},onDismiss:n,hidden:!1,title:e.title,maxWidth:e.maxWidth},r.createElement(o.e,null,r.createElement(w,{"data-automationid":"confirmbutton",onClick:t,componentRef:x},m),r.createElement(E,{"data-automationid":"cancelbutton",onClick:n,componentRef:S},y))))}}],Array(20),[function(e,t,n){"use strict";n.r(t);n.d(t,"spItemUploadItemsOperationHandler",function(){return y});var r=n(0),i=n(45),s=n(120),o=n(3238),u=n(10),a=n(122),f=n(2156),l=n(2),c=n(74),h=n(8),p=n(198),d=n(3626),v=n(154),m=n(162),g=n(1),y=Object(u.i)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,n=e.itemKey,u=e.options.sourceEntries,y=i.e.deserialize(n),b=y.webAbsoluteUrl,w=y.listFullUrl,E=Object.keys(u)[0],S=u[E].progressItemKey;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u,x,T,N,C,k,L,A,O;return Object(r.__generator)(this,function(M){switch(M.label){case 0:t=i(Object(a.e)({sourceFile:f.t},E)).sourceFile;u=i(Object(m.e)({listItemUploader:g.Xe})).listItemUploader,x=void 0===u?o.e:u;return[4,i(x(e))];case 1:T=M.sent().itemKey;N=new p.e;S&&t&&N.resolveItems({items:(L={},L[S]=Object(r.__assign)(Object(r.__assign)({},c.s.pack({itemKey:T})),Object(l.n)({progressSize:c.y},{progressSize:{current:t.size}})),L)});N.invalidateItems({items:(A={},A[n]=[h.t],A)});if(y.listFullUrl){C=new v.e(y.listFullUrl+"/Forms").path;if(y.rootFolder&&(y.rootFolder+"/").slice(0,C.length+1)===C+"/"){k=s.e.serialize({webAbsoluteUrl:b,listFullUrl:w});i(Object(d.e)({items:(O={},O[k]={childItemKey:T},O)}))}}i(N.execute());return[2]}})})}})},function(e,t,n){"use strict";n.r(t);n.d(t,"spItemCreateFolderOperationHandler",function(){return x});n.d(t,"getCreateFolderUrl",function(){return T});var r=n(0),i=n(154),s=n(45),o=n(120),u=n(1),a=n(83),f=n(239),l=n(363),c=n(122),h=n(155),p=n(780),d=n(10),v=n(74),m=n(8),g=n(6),y=n(386),b=n(204),w=n(39),E=n(162),S=n(3612),x=Object(d.i)({mergeForSameItemKey:!1,maxParallelOperationCount:8})(function(e){var t=this,n=e.itemKey,d=e.options.folders;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,y,b,E,x,C,k,L,A,O,M,_,D,P,H,B,j;return Object(r.__generator)(this,function(F){switch(F.label){case 0:t=Object.keys(d)[0];y=d[t],b=y.progressItemKey,E=y.conflictResolution;x=s.e.deserialize(n);C=x.rootFolder||new i.e(x.listFullUrl).path;k=o.e.serialize({webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl});L=e(Object(c.e)({list:u.Re},k));A=Object(S.mapConflictResolutionToNameConflictBehavior)(E);O=T({webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl,parentFolderPath:C,isDocLib:!!L&&!!L.list&&L.list.isDocumentLibrary,folderName:t,nameConflictBehavior:A});return[4,e(Object(a.t)({webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl,url:O,method:"POST",qosName:"createFolder",parseResponse:function(e){var t;try{return null===(t=JSON.parse(e))||void 0===t?void 0:t.d}catch(e){}},telemetryHandler:function(e){var t=e.errorData,n=e.eventData;if(t){var i=t.code,s=i&&(i.indexOf("-2130575257")>-1||i.indexOf("-2130575245")>-1||i.indexOf("-2130247139")>-1)?w.t.expectedFailure:w.t.failure;return{eventData:Object(r.__assign)(Object(r.__assign)({},n),{resultType:s})}}return{eventData:n}}})).catch(function(t){if(t instanceof f.e&&t.message&&C){var n=C;"/"===n[0]&&(n=n.substr(1));"/"!==n[n.length-1]&&(n+="/");t.message=t.message.replace(n,"")}throw new l.e({innerError:t,facets:e(N(t))})})];case 1:M=F.sent();if(b){_=null===(j=M)||void 0===j?void 0:j.Name;D=C+"/"+_;P=s.e.serialize({webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl,rootFolder:D});e(Object(h.e)({items:(H={},H[b]=Object(r.__assign)(Object(r.__assign)({},v.s.pack({itemKey:P})),_&&t!==_?g.h.pack(_):{}),H[P]=Object(r.__assign)(Object(r.__assign)({},u.pe.pack(D)),g.M.pack({itemKey:n})),H)}))}e(Object(p.e)({items:(B={},B[n]=[m.t],B)}));return[2]}})})}});function T(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,i=e.parentFolderPath,s=e.isDocLib,o=void 0===s||s,u=e.folderName,a=e.nameConflictBehavior,f=Object(y.r)({webAbsoluteUrl:t,listOrItemFullUrl:n}),l=u?u.trim():"";return(f=o?(f=f.segment("folders")).methodWithAliases("AddUsingPath",Object(r.__assign)({DecodedUrl:i+"/"+l,overwrite:!1},2===a?{EnsureUniqueFileName:!0}:{})).oDataParameter("$Expand","ListItemAllFields/PermMask"):f.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:i}).methodWithAliases("AddSubFolderUsingPath",{DecodedUrl:l||"Folder"+(Math.floor(100*Math.random())+1)})).toString()}function N(e){return function(t){if(e instanceof f.e){switch((function(e){var t=e.errorData.code;return(void 0===t?"":t).split(",").map(function(e){return Number(e)})[0]})(e)){case Number("-2130575257"):if(t(Object(E.e)({enableRenameOnUploadConflict:u.G})).enableRenameOnUploadConflict)return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},b.m.pack({})),b.t.pack(!0)),b.n.pack(!1));break;case-2147023080:case-2130575282:return b.w.pack({})}}}}},function(e,t,n){"use strict";n.r(t);n.d(t,"spItemCreateDocumentOperationHandler",function(){return o});var r=n(0),i=n(10),s=n(3245);n.d(t,"getCreateDocumentUrl",function(){return s.e});n.d(t,"getRedirectUrlFromResponse",function(){return s.t});var o=Object(i.i)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=this;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,n.ee(["30","ondemand.resx-ondemand"],3909)];case 1:return[4,(0,t.sent().createDocumentsCore)(i,e)];case 2:t.sent();return[2]}})})}})},,,,,function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointBasicActionsAddonDeferred",function(){return re});var r=n(0),i=n(10),s=n(217),o=n(322),u=n(961),a=n(45),f=n(798),l=n(1072),c=n(1113),h=Object(i.i)({mergeForSameItemKey:!1})(function(e){return function(t){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,n.ee(["33"],4224)];case 1:return[4,(0,r.sent().renameItemCore)(t,e)];case 2:r.sent();return[2]}})})}}),p=n(939),d=n(573),v=n(120),m=n(1),g=n(62),y=n(3856),b=n(9),w=n(6),E=n(2991);function S(e){return!!e&&0===e.toLowerCase().indexOf("team.channel")}var x=n(29),T=n(75),N=Object(b.t)()(function(){return function(e){return function(e,t){var n,i,s=t.itemKey,o=e.demandItem({key:a.e,permissions:m.lt,isCheckedOut:w.w,isFolder:w.m,rowData:m.Ct},s),u=o.key,f=o.permissions,l=o.isCheckedOut,c=o.isFolder,h=o.rowData,p=u&&e.demandItemFacet(m.un,d.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl})),b=u&&v.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl}),N=(null===(n=e.demandItemFacet(m.Re,b))||void 0===n?void 0:n.templateType)===x.n.contentCenterModelLibrary,k=Object(T.e)(e,{feature:C,pageContext:p})&&N,L=void 0,A=!1,O=E.e;if(p){L=h&&l&&!!l.byOther;var M=e.demandItemFacet(m.Ye,s,{suppressGetItems:!0}),_=S(null===(i=h)||void 0===i?void 0:i.ProgId);A=!(M||p.isAnonymousGuestUser||_)&&g.e.hasItemPermission({permissions:f},g.e.deleteListItems)&&g.e.hasItemPermission({permissions:f},g.e.editListItems)&&!k;p.supportPercentStorePath&&p.supportPoundStorePath||(O=E.t)}var D={},P=u&&e.demandItemFacet(m.Re,v.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl}));if(L){D.lockedWarningMessage=y.n;D.title=y.r}else if(P&&P.isForceCheckout&&l&&!l.byYou&&!c){D.lockedWarningMessage=y.e;D.title=y.t}return Object(r.__assign)({isAvailable:A,validator:O,isFolder:!!c},D)}}}),C={ODB:1517};var k=n(627),L=n("react-lib"),A=n(83),O=n(413),M=n(3247),_=n(125),D=n(956),P=n(386),H=n(438),B=n(132),j=n(27),F=n(154),I=n(594),q=n(87),R=n(70);function U(e){var t=e.defaultRender,n=Object(r.__rest)(e,["defaultRender"]);return t?L.createElement(t,Object(r.__assign)({},n,{preferOpenInBrowser:!0})):null}function z(e){var t=e.defaultRender,n=Object(r.__rest)(e,["defaultRender"]);return t?L.createElement(t,Object(r.__assign)({},n,{preferSameWindow:!0})):null}var W=Object(b.t)()(V),X=Object(b.t)()(V);function V(){return function(e){var t=new q.e;return function(e,n){var i=n.itemKeys,s=n.authenticationMode,o=void 0===s?"optional":s,u=i[0],f=e.demandItemFacet(w.m,u),l=e.demandItemFacet(B.i,u),c=e.demandItemFacet(m.S,u);return 1!==i.length||f||l||c?i.length>0&&"required"!==o?(function(e,t){var n=t.itemKeys,i=e.demandItemFacet(a.e,n[0]);if(!i||!i.webAbsoluteUrl||!i.listFullUrl)return{};var s=i.webAbsoluteUrl,o=i.listFullUrl,u=v.e.serialize({webAbsoluteUrl:s,listFullUrl:o}),f=e.demandItem({listFacets:m.Re,downloadZipApiUrl:D.e},u),l=f.listFacets,c=f.downloadZipApiUrl;if(!l||!c||l.templateType===x.t.webPageLibrary)return{};for(var h=[],p=Object(j.e)(e,{enableOAuthTokenInDownload:m.W}).enableOAuthTokenInDownload,d=void 0!==p&&p,y=!R.e.isActivated("f87bff1b-1562-47b1-81df-2ed7023031ac","07/26/2021","Treat docset as folder for downloads"),b=!1,E=0,S=n;E<S.length;E++){var T=S[E],N=e.demandItem({name:w.h,size:w.v,itemUrl:w.I,folder:w.m,permissions:m.lt,itemComplianceStatus:H.e,isOneNote:B.i,isDocSet:m.S},T),C=N.name,k=N.size,L=N.itemUrl,M=N.folder,P=N.permissions,I=N.itemComplianceStatus,q=N.isOneNote,U=N.isDocSet;if(q)return{isAvailable:!1};var z=void 0,W=void 0,X=e.demandItemFacet(m.Ye,T,{suppressGetItems:!0});if(X){z=void 0;W=new F.e(X.siteUrl).authority+"/_api/v2.1/drives/"+X.driveId+"/items/"+X.itemId;b=!0}else{if(!L)return{};z=e.demandItemFacet(D.t,u);W=Object(O.n)(L,(z?z.accessToken:void 0)||"")}if(W){var V=!!M||y&&!!U;3!==I&&4!==I&&g.e.hasItemPermission({permissions:P},g.e.openItems)&&h.push({name:C||"",size:k||0,docId:W,isFolder:V})}}if(0===h.length)return{};return{isAvailable:!0,getDownloadData:function(){return(function(e){var t=this,n=e.zipApiUrl,i=e.itemsData,s=e.useOAuthToken;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=void 0;return s?[4,e(Object(A.e)({url:new F.e(n).authority}))]:[3,2];case 1:t=r.sent();r.label=2;case 2:o=i&&1===i.length?i[0].name+".zip":"OneDrive_"+ ++$+"_"+(new Date).toLocaleDateString().replace(/\//g,"-").replace(/[^ -~]/g,"")+".zip";u=_.e.generate();return[2,{url:n,method:"POST",postData:{zipFileName:o,guid:u,provider:"spo",files:JSON.stringify({items:i}),oAuthToken:t||""}}]}})})}})({zipApiUrl:c,itemsData:h,useOAuthToken:d||b})}}})(e,{itemKeys:i}):{}:(function(e,t){var n=t.itemKey,i=t.platformDetection,s=t.authenticationMode,o=e.demandItem({spItem:a.e,permissions:m.lt,folderPath:m.pe,uniqueId:m.bn,itemComplianceStatus:H.e,isBFile:m.Ne},t.itemKey),u=o.spItem,f=o.permissions,l=o.folderPath,c=o.uniqueId,h=o.itemComplianceStatus,p=o.isBFile,y=e.demandItemFacet(w.k,t.itemKey),b=u&&d.e.serialize(u),E=e.demandItemFacet(m.un,b);if(!E||!u||p)return{};var S=u.webAbsoluteUrl,T=u.listFullUrl,N=v.e.serialize(u),C=e.demandItemFacet(m.Re,N);if(C&&C.templateType===x.t.webPageLibrary)return{};if(3===h||4===h||!g.e.hasItemPermission({permissions:f},g.e.openItems))return{};var k=Object(j.e)(e,{spCookieDomainConfiguration:m.Bt,enableMalwareDownloadInNewWindow:m.I}),L=k.spCookieDomainConfiguration,O=k.enableMalwareDownloadInNewWindow;if(y){if(!E.allowInfectedDownload)return{};var _=e.demandItemFacet(w.i,n);return _?O?{isAvailable:!0,downloader:U,getDownloadData:function(){return J({canconicalUrl:_})}}:L?new F.e(L).authority!==new F.e(_).authority?{}:Object(r.__assign)(Object(r.__assign)({isAvailable:!!c},i.isIE?{downloader:z}:{}),{getDownloadData:function(){return J({canconicalUrl:_})}}):{}:{}}if(!l)return{};var D=E.layoutsUrl;if(!D)return{};var B=!L||new F.e(L).authority!==new F.e(S).authority,q=E&&Object(R.n)(E),W=!!q&&q.isActivated("d1181e40-8c18-49bf-bff9-efd9518c28c0","10/10/2020","Use PostBody Download"),X=Object(j.e)(e,{disableDownloadWithAspxUrlWithToken:m.E}).disableDownloadWithAspxUrlWithToken,V=void 0!==X&&X;return Object(r.__assign)(Object(r.__assign)({isAvailable:!0},i.isIE?{downloader:z}:{}),{getDownloadData:function(){return W||V||"required"===s?L&&c&&!B&&"required"!==s?(function(e){var t=this,n=e.webAbsoluteUrl,i=e.layoutsUrl,s=e.uniqueId;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,{url:n+"/"+i+"/download.aspx?"+Object(I.e)({UniqueId:s}),method:"GET"}]})})}})({webAbsoluteUrl:S,uniqueId:c,layoutsUrl:D}):(function(e){var t=this,n=e.webAbsoluteUrl,i=e.listFullUrl,s=e.folderPath;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e(Object(A.n)({webAbsoluteUrl:n,listFullUrl:i})),o=t.dataRequestor,u=t.hasDigest;if(!t.hasTokenProvider)return[3,1];f=void 0;return[3,3];case 1:return[4,e(Object(A.e)({url:n||i,disallowCookies:!u}))];case 2:f=r.sent();r.label=3;case 3:a=f;l=Object(P.r)({webAbsoluteUrl:n,listOrItemFullUrl:i});return[4,Object(M.e)({dataRequestor:o,authToken:a,serverRelativeItemUrl:s,webApiUrl:l})];case 4:return[2,{url:r.sent(),method:"GET"}]}})})}})({webAbsoluteUrl:S,listFullUrl:T,folderPath:l,layoutsUrl:D}):(function(e){var t=this,n=e.webAbsoluteUrl,i=e.listFullUrl,s=e.uniqueId,o=e.layoutsUrl,u=e.isCrossSite;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,a,f,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e(Object(A.n)({webAbsoluteUrl:n,listFullUrl:i})),a=t.hasDigest;if(!t.hasTokenProvider&&u)return[3,1];l=void 0;return[3,3];case 1:return[4,e(Object(A.e)({url:n||i,disallowCookies:!a}))];case 2:l=r.sent();r.label=3;case 3:f=l;return[2,{url:n+"/"+o+"/download.aspx?"+Object(I.e)({UniqueId:s}),method:u?"POST":"GET",postData:{oAuthToken:f||""}}]}})})}})({webAbsoluteUrl:S,listFullUrl:T,uniqueId:c||"",layoutsUrl:D,isCrossSite:B})}})})(e,{itemKey:u,platformDetection:t,authenticationMode:o})}}}var $=0;function J(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){(t=e.canconicalUrl)&&(-1===t.indexOf("?")?t+="?avcmd=1":t+="&avcmd=1");return[2,{url:t,method:"GET"}]})})}}var K=n(634),Q=n(22),G=n(40),Y=n(3857),Z=n(2986),ee=Object(b.t)()(function(){return function(e){return function(e,t){var n,r=t.itemKey,i=t.isBatchDelete,s=e.demandItemFacet(m.Ye,r,{suppressGetItems:!0}),o=e.demandItemFacet(m.lt,r,{suppressGetItems:!0}),u=S(null===(n=e.demandItemFacet(m.Ct,r,{suppressGetItems:!0}))||void 0===n?void 0:n.ProgId),a=g.e.hasItemPermission({permissions:o},g.e.deleteListItems)&&!u;if(a&&s){a=!!Object(j.e)(e,{enableDeleteCommandForMountPointConfiguration:m.C}).enableDeleteCommandForMountPointConfiguration&&i}return{isAvailable:a,deleteWizard:te}}}});var te=Object(G.t)(function(e,t){var n,i,s,o,u,f,l=t.itemKeys,c=t.defaultRender,h=Object(r.__rest)(t,["itemKeys","defaultRender"]),p=void 0,d=Object(j.e)(e,{enableDeleteCommandForMountPointConfiguration:m.C}).enableDeleteCommandForMountPointConfiguration,v=(function(e,t){if(e.demandItemFacet(a.e,t)){var n=Object(Z.e)(e,t),r=!(n&&n.isDocumentLibrary),i=n&&n.templateType===x.n.mySiteDocumentLibrary;return!(!r&&!i)}return!1})(e,l[0]);if(1===l.length){var g=e.demandItemFacet(m.Ze,l[0]);if(g){var y=g&&Object(Q.formatToArray)(Object(Q.getLocalizedCountValue)(Y.t,Y.n,g)||"",g),b=h.deleteWizardStrings.confirmText;p=Object(r.__assign)(Object(r.__assign)({},h),{deleteWizardStrings:Object(r.__assign)(Object(r.__assign)({},h.deleteWizardStrings),{confirmTitle:Y.r,confirmText:[y," ",b]})})}else v&&(p=Object(r.__assign)(Object(r.__assign)({},h),{deleteWizardStrings:Object(r.__assign)(Object(r.__assign)({},h.deleteWizardStrings),{confirmText:Y.e})}))}else if(l.length>1){var w=!1;if(d){n=0;l.forEach(function(t){e.demandItemFacet(m.Ye,t,{suppressGetItems:!0})&&n++});if(n>0){var E=l.length-n;p=Object(r.__assign)(Object(r.__assign)({},h),{deleteWizardStrings:Object(r.__assign)(Object(r.__assign)({},h.deleteWizardStrings),{confirmTitle:Y.i,confirmText:(i=n,s=E,o=Object(Q.format)(Object(Q.getLocalizedCountValue)(Y.f,Y.l,i)||"",i),u=Object(Q.format)(Object(Q.getLocalizedCountValue)(Y.u,Y.a,s)||"",s),f=Object(Q.format)(Y.s,o,u),f)})})}else w=!0}w&&v&&(p=Object(r.__assign)(Object(r.__assign)({},h),{deleteWizardStrings:Object(r.__assign)(Object(r.__assign)({},h.deleteWizardStrings),{confirmText:Y.o})}))}var S=p||h;return c?L.createElement(c,Object(r.__assign)({itemKeys:l},S)):null});var ne=Object(b.t)()(function(){return function(e){return function(e,t){var n=t.itemKeys;if(!Object(j.e)(e,{enableDeleteCommandForMountPointConfiguration:m.C}).enableDeleteCommandForMountPointConfiguration)return{};for(var r=0,i=n;r<i.length;r++){var s=i[r];if(!e.demandItemFacet(m.Ye,s,{suppressGetItems:!0}))return{}}return{isAvailable:!1}}}});var re=Object(i.t)(function(){return function(e){e(Object(s.r)(a.e,l.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(["469"],4388)];case 1:return[2,e.sent().spItemDeleteItemsOperationHandler]}})})})));e(Object(s.r)(a.e,c.t)(h));e(Object(o.e)(a.e,p.e)(N));e(Object(o.e)(a.e,k.t)(W));e(Object(o.e)(f.e,k.t)(X));e(Object(o.e)(a.e,K.t)(ee));e(Object(o.e)(a.e,u.e)(ne))}})}],Array(21),[function(e,t,n){"use strict";n.r(t);n.d(t,"getListRootFolder",function(){return o});var r=n(0),i=n(83),s=n(386);function o(e){var t=this,n=e.webAbsoluteUrl,o=e.listFullUrl,u=e.qosName;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=Object(s.e)({webAbsoluteUrl:n,listFullUrl:o}).segment("RootFolder");return[4,e(Object(i.r)({url:t.toString(),method:"GET",webAbsoluteUrl:n,listFullUrl:o,qosName:"rootFolder."+u,noRedirect:!0}))];case 1:return[2,r.sent()]}})})}}},function(e,t,n){"use strict";n.r(t);n.d(t,"fileHandlerGetItemsOperationHandler",function(){return w});n.d(t,"filehandlerPerExtensionGetItemsOperationHandler",function(){return E});n.d(t,"fetchFileHandlerData",function(){return S});var r=n(0),i=n(10),s=n(1550),o=n(71),u=n(3640),a=n(889),f=n(1790),l=n(2017),c=n(226),h=n(161),p=n(59),d=n(162),v=n(299),m=n(48),g=n(730),y=n(184),b=n(843),w=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=c.t.deserialize(n),s=i.endpoint;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u;return Object(r.__generator)(this,function(r){t=e(Object(v.e)({name:"getFileHandlersOperation"}));u={endpoint:s};return[2,e(S(i)).then(function(r){if(r){Object(b.e)({driveAppsKey:i,data:r});e(Object(b.n)(r,n));u.fileHandlerRequestEndpoint=r.signature.endpoint;u.accessTokenObtained=!0;e(t({resultType:m.e.Success,extraData:u}))}else e(t({resultType:m.e.Failure,resultCode:"NoFileHandlerData",extraData:u}))}).catch(function(n){o.e.logError(n);e(t({resultType:m.e.Failure,extraData:u}));throw n})]})})}}),E=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=c.e.deserialize(n).endpoint;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:t=c.t.serialize({endpoint:i});return[4,e(Object(s.e)(function(e){return e.demandItemFacet(h.t,t)}))];case 1:n.sent();return[2]}})})}});function S(e){var t=e.endpoint,n=e.driveId;return function(e){var i,s={endpoint:t,driveId:n},o=e(Object(v.e)({name:"fetchFileHandlerData",extraData:s})),c=e(Object(d.e)({getUserOneDriveEndpoint:p.d,useOneDriveEndpoint:p._,enableFileHandlerPrefetch:p.a,graphQLPrefetchCache:p.g})),h=c.getUserOneDriveEndpoint,b=c.useOneDriveEndpoint,w=c.enableFileHandlerPrefetch,E=c.graphQLPrefetchCache,S=Object(a.n)({endpoint:t,driveId:n}),x=new u.e({},Object(r.__assign)({dataRequestor:e(f.e).dataRequestor},w&&E?{prefetchCache:E}:{})),T=Promise.resolve(t);h&&b&&(T=e(h({endpoint:t})));return T.then(function(t){i=t;S=Object(a.n)({endpoint:i});s.fileHandlerRequestEndpoint=i;return e(Object(l.getSessionToken)(i,S,{qosExtraData:{requestor:"GetFileHandlerData",endPoint:i,driveUrl:S}}))}).then(function(t){s.accessTokenObtained=!!t;return x.getFileHandlerData({accessToken:t,endpoint:i,includePromotedApp:!0,driveId:n}).then(function(t){if(t){var r={data:t,lastModified:Date.now(),signature:{endpoint:i,includePromotedApp:!0,driveId:n}};e(o({resultType:m.e.Success,extraData:s}));return r}e(o({resultType:m.e.Failure,resultCode:"NoDataFromFileHandlerService",extraData:s}))}).catch(function(t){e(o(Object(g.e)({resultType:m.e.Failure,extraData:s},Object(y.e)(t))));throw t})}).catch(function(t){e(o(Object(g.e)({resultType:m.e.Failure,resultCode:"getSessionTokenError",extraData:s},Object(y.e)(t))));throw t})}}},function(e,t,n){"use strict";n.r(t);n.d(t,"DropTargetHook",function(){return d});n.d(t,"DragSourceHook",function(){return v});n.d(t,"DragDropHook",function(){return b});var r=n(0),i=n("react-lib"),s=n(1205),o=n(1080),u=n(750),a=n(1335),f=n(3866),l=n(523),c=n(85),h=n(127),p=n(1305);var d=function(e){return i.createElement(s.e,null,i.createElement(o.e,Object(r.__assign)({},e)))};var v=function(e){var t=e.dragSourceKey,n=e.type,o=i.useState(),a=o[0],f=o[1],l=Object(h.e)(function(t){var n;e.hookCallback(t);f(null===(n=t.collectedProps)||void 0===n?void 0:n.isDragging)});return i.createElement(s.e,null,i.createElement(u.t,Object(r.__assign)({},e,{hookCallback:l})),e.showDefaultDragPreview||!a?null:i.createElement(u.e,{dragSourceKey:t,type:n},function(e){return i.createElement(y,{draggedItem:e.draggedItem,dropEffect:e.dropEffect})}))};function m(e){var t=e.resolve,n=Object(r.__rest)(e,["resolve"]);i.useEffect(function(){return function(){t()}},[]);return i.createElement(a.e,Object(r.__assign)({},n))}function g(e){var t,n,r=e.draggedItem,o=e.resolve;return i.createElement(s.e,null,i.createElement(u.e,{dragSourceKey:null===(t=r)||void 0===t?void 0:t.dragSourceKey,type:null===(n=r)||void 0===n?void 0:n.type,as:p.e,getItemStyles:p.n},function(e){return i.createElement(m,{draggedItem:e.draggedItem,dropEffect:e.dropEffect,resolve:o})}))}function y(e){var t=Object(l.i)({scope:"global"});i.useEffect(function(){if(e.draggedItem&&t){var n=new c.e,r=n.reject,s=n.resolve,o=n.promise,u=i.createElement(g,{draggedItem:e.draggedItem,reject:r,resolve:s});t.enqueue({content:u,promise:o,scope:"global"})}},[e.draggedItem]);return null}var b=i.memo(function(e){var t=e.dragDropKey,n=e.dragType,o=i.useState(),a=o[0],l=o[1],c=Object(h.e)(function(t){var n;e.hookCallback(t);l(null===(n=t.collectedDragProps)||void 0===n?void 0:n.isDragging)});return i.createElement(s.e,null,i.createElement(f.e,Object(r.__assign)({},e,{hookCallback:c})),e.showDefaultDragPreview||!a?null:i.createElement(u.e,{dragSourceKey:t,type:n},function(e){return i.createElement(y,{draggedItem:e.draggedItem,dropEffect:e.dropEffect})}))})}],Array(222),[function(e,t,n){"use strict";n.d(t,"e",function(){return m});n.d(t,"t",function(){return g});n.d(t,"n",function(){return y});n.d(t,"r",function(){return b});n.d(t,"i",function(){return w});n.d(t,"s",function(){return E});var r=n(0),i=n(266),s=n(1430),o=n(2017),u=n(337),a=n(437),f=n(361),l=n(162),c=n(1066),h=n(59),p=n(52),d=n(2120),v=n(331),m=Object(i.e)(function(e){var t=e(a.e),n=e(Object(l.e)({graphDataRequestorConfiguration:c.e,graphTokenProvider:d.e})),r=n.graphDataRequestorConfiguration,i=n.graphTokenProvider,o=r&&r.alwaysSendContentType,h=r&&r.cookieOrigin;return{dataRequestor:new s.e({alwaysSendContentType:o},{cookieOrigin:h,apiEvent:f.e.withManager(t),sessionManagementProvider:i,isOffline:function(){return new p.n(function(t,n){try{var r=e(Object(u.n)()),i=void 0!==window.navigator.onLine&&!window.navigator.onLine;t(r||i)}catch(e){n(e)}})}}),hasTokenProvider:!!i&&!!i.getSessionToken,cookieOrigin:h}});function g(e,t){return"&orderby=folder,"+e+" "+(t?"asc":"desc")}function y(e){var t=this,n=e.url,i=e.method,s=void 0===i?"GET":i,u=e.body,a=e.qosName,f=e.endpoint,c=e.headers,p=void 0===c?{}:c,d=e.timeout,g=e.expectedErrors,y=e.driveUrl,b=e.parseResponse,w=e.allowCookies,E=e.useMultiPartIfSupported,S=e.apiVersion;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,c,x,T,N,C,k,L,A,O,M,_;return Object(r.__generator)(this,function(D){switch(D.label){case 0:t=e(m),i=t.dataRequestor,c=t.hasTokenProvider,x=t.cookieOrigin;T=void 0!==typeof u?JSON.stringify(u):void 0;N=new v.e(n).authority;C=x&&N&&x===N;return c||w&&C?[3,2]:[4,e(Object(o.getSessionToken)(f,y))];case 1:k=D.sent();D.label=2;case 2:L=e(Object(l.e)({clientName:h.t,enableUseMultiPart:h.p,isClaimsPerSiteEnabled:h.w})),A=L.clientName,O=L.isClaimsPerSiteEnabled,M=L.enableUseMultiPart;_=void 0===M||M(f);return[4,i.send({path:n,endpoint:f,driveUrl:y,requestType:s,apiName:a,accessToken:k,useAuthorizationHeaders:!0,postData:T,headers:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},p),A?{"X-ClientService-ClientTag":A}:{}),O?{"x-ms-cc":"t"}:{}),useMultiPart:_?E:void 0,expectedErrors:g,allowCookies:w,timeout:d,parseResponse:b,apiVersion:S})];case 3:return[2,D.sent()]}})})}}function b(e){var t=this,n=e.url,i=e.method,s=void 0===i?"GET":i,o=e.body,a=e.qosName,f=e.timeout,l=e.endpoint,c=e.headers,h=e.expectedErrors,p=e.driveUrl,d=e.useMultiPartIfSupported,v=e.parseResponse,m=e.allowCookies;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,g,b,w,E,S,x;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=void 0!==typeof o?JSON.stringify(o):"";i=(function(e,t,n){var r=void 0!==n?n:"";return e+"__"+t+"__"+r})(n,s,t);g=e(Object(u.n)());b=void 0!==window.navigator.onLine&&!window.navigator.onLine;w=g||b;return[4,e(Object(u.t)(i))];case 1:E=r.sent();if(w&&E)return[2,E];S=y({url:n,method:s,body:o,qosName:a,endpoint:l,headers:c,expectedErrors:h,timeout:f,driveUrl:p,useMultiPartIfSupported:d,parseResponse:v,allowCookies:m});if(!E)return[3,2];e(S).then(function(t){e(Object(u.r)(i,t))});return[2,E];case 2:return[4,e(S)];case 3:x=r.sent();return[4,e(Object(u.r)(i,x))];case 4:r.sent();return[2,x]}})})}}function w(e){return function(t){var n=t(Object(l.e)({isODCEndpoint:h.E})).isODCEndpoint;return!!n&&n(e)}}function E(e,t){return function(n){var r=n(Object(l.e)({supportsRandomAccess:h.O})).supportsRandomAccess;return!!r&&r(e,t)}}}],Array(153),[function(e,t,n){"use strict";n.d(t,"e",function(){return a});n.d(t,"t",function(){return f});var r=n("react-lib"),i=n(1037),s=n(111),o=n(95),u=0;function a(e){var t=e.isDefault,n=void 0!==t&&t,o=r.useState(""+ ++u)[0],a=r.useContext(i.e),f=r.useRef(),c=f.current||n&&a.keyboardManager||(f.current=new i.t({isDefault:!1,id:o,parent:a.keyboardManager})),h=l(c),p=h.isActive,d=h.isChildActive;r.useEffect(function(){return function(){if(!n){c.setIsActive(!1);c.dispose()}}},[]);var v=r.useMemo(function(){return{keyboardManager:c}},[c]);return r.createElement("div",{"data-keyboard-zone-id":o},r.createElement(i.e.Provider,{value:v},Object(s.t)(e.children,{isActive:p,isChildActive:d})))}function f(){return l(r.useContext(i.e).keyboardManager)}function l(e){var t=r.useState(function(){return e.getIsActive()}),n=t[0],i=t[1],s=r.useState(function(){return e.hasActiveChildren()}),u=s[0],a=s[1];r.useEffect(function(){var t=new o.e(null);t.on(e,"change",function(){i(e.getIsActive());a(e.hasActiveChildren())});return function(){t.dispose()}},[]);return{isActive:n,isChildActive:u}}}],Array(72),[function(e,t,n){"use strict";n.r(t);n.d(t,"getAuthToken",function(){return l});n.d(t,"getSessionToken",function(){return c});var r=n(0),i=n(1067),s=n(162),o=n(299),u=n(48),a=n(53),f=n(2120);function l(e,t,n,l){var c=this;return function(h){return Object(r.__awaiter)(c,void 0,void 0,function(){var c,p,d,v,m,g,y,b,w,E,S,x,T,N=this;return Object(r.__generator)(this,function(C){switch(C.label){case 0:c=(l||{}).qosExtraData;p=h(Object(s.e)({graphDataSourceConfiguration:i.e,graphTokenProviderConfiguration:f.e})),d=p.graphDataSourceConfiguration,v=p.graphTokenProviderConfiguration;m=d&&d.ensureAuthToken;g=n&&d&&d.ensureAuthTokenWithAction;y=v&&v.getSessionToken;if(!(w=y?function(){return Object(r.__awaiter)(N,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,y({endpoint:t,driveUrl:n,path:n||t})];case 1:return[2,e.sent().accessToken]}})})}:g?function(){return Object(r.__awaiter)(N,void 0,void 0,function(){return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,h(g(e,t,n))];case 1:return[2,r.sent()]}})})}:m?function(){return Object(r.__awaiter)(N,void 0,void 0,function(){return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,m(e,t)];case 1:return[2,n.sent()]}})})}:void 0))return[3,4];E=h(Object(o.e)({name:"graphDataSource.getAuthToken",extraData:c}));C.label=1;case 1:C.trys.push([1,3,,4]);return[4,w()];case 2:b=C.sent();h(E({resultType:u.e.Success,extraData:Object(r.__assign)(Object(r.__assign)({},c),{authTokenObtained:!!b})}));return[3,4];case 3:S=C.sent();x=u.e.Failure;T=void 0;if(S instanceof a.e){S.isExpected&&(x=u.e.ExpectedFailure);T=S.code}else T=S instanceof Error?S.name+"("+S.message+")":"UnknownAuthError";h(E({resultType:x,resultCode:T,error:S&&JSON.stringify(S),extraData:c}));throw S;case 4:return[2,b]}})})}}function c(e,t,n){var i=this;return function(s){return Object(r.__awaiter)(i,void 0,void 0,function(){var i,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,s(l(["Files.ReadWrite.All"],e,t,n))];case 1:(i=r.sent())&&(o={accessToken:i});return[2,o]}})})}}}],Array(14),[function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(0),i=n("react-lib"),s=n(2),o=n(78),u=n(1064),a=n(1),f=n(360),l={key:new s.e("openInOfficeOnline").id,automationId:"openInOfficeOnlineCommand",action:i.createElement(u.t,null),facets:Object(r.__assign)(Object(r.__assign)({},o.t.pack(!0)),a.Et.pack(f.a))}},function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(0),i=n("react-lib"),s=n(2),o=n(78),u=n(1057),a=n(1),f=n(360),l={key:new s.e("openInOfficeClient").id,automationId:"openInOfficeClientCommand",action:i.createElement(u.n,null),facets:Object(r.__assign)(Object(r.__assign)({},o.t.pack(!0)),a.Et.pack(f.u))}}],Array(85),[function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(352),s=new r.e("refreshItemsInSet"),o=Object(i.e)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("graphTokenProvider")}],Array(35),[function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});var r=n(2),i=new r.e("entryBatch"),s=new r.e("sourceFile")}],Array(28),[function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(352),s=new r.e("saveViewCore"),o=Object(i.e)({operationTypeFacet:s})}],Array(62),[function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n("react-lib"),s=n(993),o=n(486),u=function(e){var t=e.extension,n=e.className,u=e.isOneNote,a=e.size,f=e.brand,l=Object(o.n)({size:a,extension:u?"one":t,brand:f});return l?i.createElement(s.e,Object(r.__assign)({className:n},l)):null}}],Array(34),[function(e,t,n){"use strict";n.d(t,"t",function(){return b});n.d(t,"e",function(){return w});var r=n(0),i=n("react-lib"),s=n(2319),o=n(2),u=n(78),a=n(720),f=n(26),l=n(30),c=n(731),h=n(40),p=n(1),d=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return this.props.canOpenInOffice?i.createElement(l.e,null):i.createElement(c.t,null)};return t})(i.PureComponent);var v=Object(h.e)(function(e,t){var n=t.itemKey;return{canOpenInOffice:!!e.demandItem({appMap:p.ot},n).appMap}})(d),m=Object(f.s)()(Object(f.r)()(v)),g=n(2033),y=n(2032),b={key:a.e.key,automationId:a.e.automationId,name:a.e.name,subMenuProps:{items:[y.e,g.e],contextualMenuItemAs:s.t},facets:Object(r.__assign)({},u.t.pack(!0))},w={key:new o.e("fallbackOpen").id,automationId:"fallbackOpen",name:a.e.name,action:i.createElement(m,null),facets:Object(r.__assign)({},u.t.pack(!0))}},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("bundle")},,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(352),s=new r.e("retryProgressItemsOperation"),o=Object(i.e)({operationTypeFacet:s})}],Array(17),[function(e,t,n){"use strict";n.d(t,"t",function(){return w});n.d(t,"e",function(){return E});var r=n(0),i=n("react-lib"),s=n(993),o=n(1526),u=n(1),a=n(2335),f=n(26),l=n(40),c=n(6),h=n(2033),p=n(2032),d=n(2),v=n(2248),m=n(75),g=n(94),y=new d.e("fileHandlerOpenCommand").id,b={ODB:625,ODC:"CommandBarBrandIcons",Fallback:!1},w=Object(f.s)()(Object(f.r)()(Object(l.e)(function(e,t){var n=t.itemKey,r=t.item,i=e.demandItem({appMap:u.ot},n).appMap,s=r.name;r.key===h.e.key?s=s||(i?Object(a.o)(i,!0):a.e.Open):r.key===p.e.key&&(s=s||(i?Object(a.s)(i,!0):a.e.OpenInBrowser));return{name:s}})(function(e){return i.createElement("div",{className:"contextualMenuItemLinkContent_c258103d"},i.createElement("span",{dir:"auto",className:"contextualMenuItemTextLabel_c258103d"},e.name))}))),E=Object(f.s)()(Object(f.r)()(Object(l.e)(function(e,t){var n=t.itemKey,i=t.menuProps,s=e.demandItem({appMap:u.ot,fileName:c.d},n),o=s.appMap,f=s.fileName,l={};if(i&&i.items){var d=i.items[0];d&&-1!==d.key.indexOf(y)&&d.iconProps&&(l=d.iconProps)}var v=!!f&&!!f.extension&&".pdf"===f.extension.toLowerCase(),w={iconName:o?Object(a.t)(o):v?"PDF":"OpenFile"},E=Object(g.e)(e,n),x=Object(m.e)(e,{feature:b,pageContext:E}),T=void 0;i&&i.items&&(T=i.items.map(function(e){return e.key===h.e.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:w,name:e.name||o&&Object(a.o)(o,!0)||a.e.Open,onRenderIcon:o?S.bind(void 0,o,!0,x):void 0}):e.key===p.e.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:w,name:e.name||o&&Object(a.s)(o,!0)||(v?a.e.OpenInBrowser:a.e.Open),onRenderIcon:o?S.bind(void 0,o,!0,x):void 0}):e}));return{iconProps:l||w,onRenderIcon:o?S.bind(void 0,o,!1,x):void 0,text:a.e.Open,menuProps:T?Object(r.__assign)(Object(r.__assign)({},i),{items:T}):i}})(o.e)));function S(e,t,n){var r=e&&Object(a.n)(e),o=e&&Object(a.r)(e);return o&&n?i.createElement(v.e,{size:16,extension:"",brand:o.toLowerCase(),className:t?"menuItemBrandIcon_c258103d":"brandIcon_c258103d"}):r?i.createElement("span",{className:t?"menuItemIconContainer_c258103d":"iconContainer_c258103d"},i.createElement(s.e,{iconName:r.logoFill16,className:"logoFillIcon_c258103d"}),i.createElement(s.e,{iconName:r.logo16,className:"logoIcon_c258103d"})):null}},function(e,t,n){"use strict";n.d(t,"e",function(){return A});n.d(t,"t",function(){return O});var r=n(0),i=n("react-lib"),s=n(40),o=n(26),u=n(30),a=n(1871),f=n(1739),l=n(1772),c=n(2538),h=n(1140),p=n(2624),d=n(122),v=n(6),m=n(82),g=n(162),y=n(59),b=n(889),w=n(2875),E=n(1790),S=n(2017);function x(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a;return Object(r.__generator)(this,function(f){switch(f.label){case 0:t=e.appId,i=e.itemKeys,s=e.getPreAuthUrl,o=e.driveUrl;if(!s)return[2,i.map(function(e){var t=n(Object(d.e)({driveItemKey:m.e},e)).driveItemKey,i=n(Object(g.e)({graphEndpoint:y.v})).graphEndpoint;return t?Object(b.t)(Object(r.__assign)(Object(r.__assign)({},t),{endpoint:i||t.endpoint})):""})];u=i.map(function(e){return n(Object(d.e)({fullUrl:v.i},e)).fullUrl||""});return[4,n(Object(S.getSessionToken)(o,o))];case 1:a=f.sent();return[2,new w.e({},{dataRequestor:n(E.e).dataRequestor}).getPreAuthUrls({appId:t,items:u,accessToken:a,driveUrl:o})]}})})}}var T=n(119),N=n(3409),C=n(18),k=n(70),L=Object(s.t)(function(e,t){var n,s=t.itemKeys,o=t.action,d=t.isAvailable,v=t.itemKey,g=o.handler,y=g.appId,w=g.isPromoted,E=v,S="",L="";L=k.t.isActivated("f69e50a3-c176-4a8c-8c48-6adf2b86607b","1/23/2021","Use itemKey instead of parentItemKey.")?E||(1===s.length?s[0]:""):1===s.length?s[0]:E||"";var A=e.demandItem({controlHandler:p.e,driveItemKey:m.e},L),O=A.controlHandler,M=A.driveItemKey;(S=M&&Object(b.n)(M)||"").indexOf("/v2.1")>-1&&(S=S.replace("/v2.1","/v2.0"));var _=p.e.evaluate(O)(e,{itemKey:L}).sharedPostData;n=_;var D=e.dispatch;if(!(d&&o.url&&n&&S))return null;var P=e.demandItemFacet(p.n,v),H=p.n.evaluate(P)(e,{itemKey:v}).onInvokeCallback,B=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e,t,i;return Object(r.__generator)(this,function(u){switch(u.label){case 0:e=H?void 0:window.open("","_blank");return[4,D(x({appId:y,itemKeys:s,getPreAuthUrl:!w,driveUrl:S})).catch(function(){})];case 1:t=u.sent();i=Object(r.__assign)(Object(r.__assign)({},n),{appId:y,items:JSON.stringify(t||[])});if(H)H({url:o.url,postdata:i});else if(t&&t.length>0&&e&&e.document){e.opener=null;Object(h.e)({url:o.url,postdata:i,document:e.document})}else e&&e.close();return[2]}})})},j=w?Object(C.o)(function(e){var t=e.resolve,n=e.reject,s=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){n(new T.e);return[2]})})};return i.createElement(a.e,{dialogContentProps:{title:N.r,onDismiss:s},hidden:!1},i.createElement("p",null,N.n),i.createElement(f.e,null,i.createElement(l.e,{onClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:t();return[4,B()];case 1:e.sent();return[2]}})})}},N.t),i.createElement(c.e,{onClick:s},N.e)))}):B;return i.createElement(u.e,Object(r.__assign)({isAvailable:d,onExecute:j},t))}),A=Object(o.e)()(L);function O(e,t,n){var r=e.file,i=e.folder,s=e.file&&e.file.extensions||void 0;if(!0===n)return!!i;if(r&&t){var o=k.t.isActivated("b0dc9ce2-048d-43d2-ac18-f07fc73030c2","1/23/2021","Check if the extension includes a period")||"."===t.charAt(0)?t:"."+t;return!s||-1!==s.indexOf(o.toLowerCase())||-1!==s.indexOf("*")||-1!==s.indexOf(".*")}return!1}}],Array(15),[function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(0),i=n("react-lib"),s=n(78),o=n(720),u=n(2319),a=n(2032),f=n(2033),l={key:o.e.key,automationId:o.e.automationId,subMenuProps:{items:[a.e,f.e]},onRender:function(e){return i.createElement(u.e,Object(r.__assign)({},e,{menuProps:e.subMenuProps}))},facets:Object(r.__assign)({},s.t.pack(!0))}}],Array(32),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.Publish=0]="Publish";e[e.Republish=1]="Republish";e[e.PostNews=2]="PostNews";e[e.UpdateNews=3]="UpdateNews";e[e.SubmitForApproval=4]="SubmitForApproval";e[e.CancelApproval=5]="CancelApproval";e[e.SchedulePublish=6]="SchedulePublish"})(r||(r={}))}],Array(62),[function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n("react-lib"),i=n(1009);function s(e){var t=e.controlHandlers;return o(e.children,t)}function o(e,t){return r.createElement(i.e,{value:t},e)}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(17).e)("cancelProgressControl",{})}],Array(44),[function(e,t,n){"use strict";n.d(t,"e",function(){return F});n.d(t,"t",function(){return I});var r=n(0),i=n("react-lib"),s=n(2),o=n(640),u=n(106),a=n(2874),f=n(40),l=n(30),c=n(26),h=n(47),p=n(1095),d=n(325),v=n(2320),m=n(6),g=n(122),y=n(256),b=n(3250),w=n(155),E=new d.e("newDocument"),S=Object(y.t)()(v.e),x=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onItemOpened=function(){n.setState({fileCreated:!1,isItemOpened:!0})};n.state={newDocumentKey:E.serializeNext()};return n}t.prototype.render=function(){var e=this,t=this.state,n=t.newDocumentKey,s=t.fileCreated,o=t.isItemOpened,u=this.props,a=u.itemCacheDispatch,f=u.itemKey,c=u.parentFolderDriveItemUrl,h=u.action,d=Object(r.__rest)(u,["itemCacheDispatch","itemKey","parentFolderDriveItemUrl","action"]),v=h.availableOn,y=v&&v.file&&v.file.extensions&&v.file.extensions[0]&&v.file.extensions[0].replace(".",""),b=!!y&&!!h.handler,E=void 0;if(b&&y){var x=!h.handler.isPromoted;x&&!c||(E=function(){return Object(r.__awaiter)(e,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,a(Object(p.e)({items:(e={},e[f]={newDocumentKey:n,extension:y},e)}))];case 1:t.sent();x&&c&&a((i={newDocumentKey:n,parentFolderDriveItemUrl:c},function(e){var t,n=i.newDocumentKey,s=i.parentFolderDriveItemUrl,o=e(Object(g.e)({fileName:m.h},n));if(!o||!o.fileName)throw"FileHandler create action: fail to get file name of the new document";var u=s+":/"+o.fileName+":";e(Object(w.e)({items:(t={},t[n]=Object(r.__assign)({},m.I.pack(u)),t)}))}));this.setState({fileCreated:!0,isItemOpened:!1});return[2]}var i})})})}return s?o?null:i.createElement(S,Object(r.__assign)({},d,{onComplete:this._onItemOpened,isAvailable:!0,itemKeys:[n],action:h})):i.createElement(l.e,Object(r.__assign)({},d,{isAvailable:b,onExecute:E}))};return t})(i.Component),T=Object(c.i)()(Object(f.e)(function(e,t){var n=t.itemKey,i=t.action,s=e.demandItemFacet(b.e,n),o=b.e.evaluate(s)(e,{itemKey:n}).driveItemFullUrl,u=i.handler,a=u.appId,f=u.isPromoted?"PromotedFileHandlerCreate":"FileHandlerCreate",l={appId:a};return Object(r.__assign)(Object(r.__assign)({},Object(h.t)(e,{itemKey:n,engagement:{name:f,isIntentional:!0,extraData:l}})),{parentFolderDriveItemUrl:o||""})})(x));var N=Object(c.s)()(Object(f.e)(function(e,t){var n=t.itemKeys,i=t.action,s=i.availableOn,o=s.allowMultiSelect,u=void 0!==o&&o,a=n.length,f=u&&a>0||1===a;f&&(f=n.every(function(t){var n=e.demandItem({fileName:m.d,isFolder:m.m},t),r=n&&n.fileName,i=r&&r.extension||"",o=n&&n.isFolder||!1;return Object(v.t)(s,i,Boolean(o))}));var l=i.handler,c=l.appId,p=l.isPromoted?"PromotedFileHandlerCustom":"FileHandlerCustom",d={appId:c};return Object(r.__assign)({isAvailable:f},Object(h.t)(e,{itemKey:n[0],engagement:{name:p,isIntentional:!0,extraData:d}}))})(v.e)),C=n(3631),k=n(22),L=n(8),A=n(84),O=n(161),M=n(1204),_=n(2624),D=new s.e("fileHandlerOpenCommand").id,P=new s.e("fileHandlerCreateCommand").id,H=new s.e("fileHandlerCustomCommand").id,B=new s.e("fileHandlerAppCommand").id,j=new s.e("fileHandlerActionsCommand").id,F=function(e,t){var n=t.itemKey,r=t.collapseCustomCommands,i=e.demandItem({actions:O.t,version:O.a},n),s=i.actions,o=i.version;if(o&&4===o&&s){var u=function(t){var n=s&&s[t],r=e.demandItemFacet(L.e,n);return r&&r.itemKeys||[]};return{new:R(e,{actionKeys:u("create"),type:"create"})||[],open:R(e,{actionKeys:u("open"),type:"open"})||[],custom:R(e,{actionKeys:u("custom"),type:"custom",collapseCustomCommands:r})||[]}}},I=function(e,t,n){var r=n?t:e,i=n?e:t,s=r,o={};r.forEach(function(e){o[e.key]=!0});i.forEach(function(e){o[e.key]||s.push(e)});return s};function q(e,t){var n,r,s,f,l,c=t.itemKey,h=t.type,p=t.CustomAction,d=void 0,v=void 0;if("app"===h){d=c;if(!(_=c&&e.demandItem({displayName:m.h,appIcon:O.n},c)))return;s=B+"-"+c;f="itemsScopefileHandlerAppCommand";n=_.displayName;_.appIcon&&_.appIcon.url&&(r={iconType:o.e.Image,className:"fileHandlerCommandIcon_0cb61ef4",imageProps:{src:_.appIcon&&_.appIcon.url||"",title:_.displayName||"",imageFit:u.t.contain,className:"fileHandlerCommandIcon_0cb61ef4"}})}else{var g=e.demandItem({displayName:m.h,handlerKey:O.o,availableOn:O.e,icon:O.i,isPromoted:O.s},c),y=g.displayName,b=g.handlerKey,w=g.availableOn,E=g.icon;v=g.isPromoted;var S=b&&e.demandItemFacet(O.n,b),x="open"===h&&S||E;x&&x.url&&(r={iconType:o.e.Image,className:"fileHandlerCommandIcon_0cb61ef4",imageProps:{src:x&&x.url,title:x&&x.displayName,imageFit:u.t.contain,className:"fileHandlerCommandIcon_0cb61ef4"}});var L=Object(M.e)(e,{itemKey:c});n=y;switch(h){case"open":if(!n&&b){var _;n=(_=c&&e.demandItem({displayName:m.h},b))&&_.displayName&&k.format(C.r,_.displayName)}s=D;f="itemsScopefileHandlerOpenCommand";l=p?i.createElement(p,{action:L}):i.createElement(a.e,{action:L});break;case"create":n||(n=E&&E.displayName||w&&w.file&&w.file.extensions&&k.format(C.e,w.file.extensions[0])||"");s=P;f="itemsScopefileHandlerCreateCommand";l=i.createElement(A.e,null,i.createElement(T,{action:L}));break;case"custom":s=H;f="itemsScopefileHandlerCustomCommand";y&&(f=y.toLowerCase().replace(/\s+(.)/g,function(e,t){return t.toUpperCase()})+"Command");l=p?i.createElement(p,{action:L}):i.createElement(N,{action:L})}s+="-"+c;d=b}if(s&&n)return{key:s,automationId:f,name:n,iconProps:r,action:l,handlerKey:d,isPromoted:v,fileHandlerType:h}}function R(e,t){var n=t.actionKeys,i=t.type,s=t.collapseCustomCommands,o=void 0===s||s,u=[];if("open"===i){var f=e.demandItemFacet(_.r,n[0]),l=_.r.evaluate(f)(e,{openActionAs:a.e}).openActionAs;n.forEach(function(t){var n=q(e,{itemKey:t,type:i,CustomAction:l});n&&u.push(n)})}else if("create"===i)n.forEach(function(t){var n=q(e,{itemKey:t,type:i});n&&u.push(n)});else if("custom"===i){f=e.demandItemFacet(_.t,n[0]);var c=_.t.evaluate(f)(e,{customActionAs:N}).customActionAs,h=(function(e,t){var n=t.actionKeys,i=t.collapseCustomCommands,s=t.CustomAction,o=void 0,u=[],a={},f=function(t){return q(e,{itemKey:t,type:"custom",CustomAction:s})},l=function(t,n){var r=q(e,{itemKey:t,type:"app"});r&&n&&n.length>0&&(r.subMenuProps={items:n});return r};if(i){for(var c=0,h=n;c<h.length;c++){var p=h[c],d=f(p);if(d){var v=d.handlerKey||"";if(o){if(!o.subMenuProps){var m=Object(r.__assign)({},o),g=Object.keys(a)[0];if(E=l(g)){o=E;if(v===g){E.subMenuProps={items:[m,d]};continue}}}var y=Object.keys(a).length;if(void 0!==a[v]){var b=o.subMenuProps;if(1===y)b&&b.items.push(d);else{var w=a[v];if(b){var E;(E=b.items[w]).subMenuProps&&E.subMenuProps.items.push(d)}}}else{var S=l(v,[d]);if(!S)continue;if(1===y){var x=Object(r.__assign)({},o);o={key:""+j,automationId:"itemsScopefileHandlerActionsCommand",name:C.t,iconProps:{iconName:"SetAction",ariaLabel:C.n,className:"fileHandlerCommandIcon_0cb61ef4"},subMenuProps:{items:[x,S]}};a[v]=1}else{o.subMenuProps&&o.subMenuProps.items.push(S);a[v]=y}}}else{o=d;a[v]=0}}}o&&(u=[o])}else for(var T=0,N=function(e){var t=f(e);if(!t)return"continue";var n=t.handlerKey||"",i=l(n,[t]),s=!1;if(i){Object.keys(a).forEach(function(e){if(n===e){s=!0;var i=u[a[e]];i.subMenuProps&&(i.subMenuProps={items:Object(r.__spreadArrays)(i.subMenuProps.items,[t])})}});if(!s){a[n]=T;T++;u.push(i)}}else{a[n]=T;T++;u.push(t)}},k=0,L=n;k<L.length;k++){p=L[k];N(p)}return u})(e,{actionKeys:n,collapseCustomCommands:o,CustomAction:c});h&&u.push.apply(u,h)}return u}}],Array(63),[function(e,t,n){"use strict";n.d(t,"e",function(){return O});n.d(t,"t",function(){return M});var r=n(0),i=n(132),s=n(6),o=n(8),u=n(82),a=n(1029),f=n(2867),l=n(2987),c=n(554),h=n(1046),p=n(543),d=n(142),v=n(41),m=n(1098),g=n(2769),y=n(742),b=n(2770),w=n(3617),E=n(2988),S=n(3243),x=n(3242),T=n(165),N=n(3618),C=n(3399),k=n(737),L=new(n(2).e)("restricted"),A=n(3400);function O(e){var t,n,O=e.driveItemKey,_=e.driveItem,D=e.endpoint,P=e.parentFolderItemKey,H=e.shouldReturnShareFacets,B=void 0===H||H,j=_.coverImage,F=_.file,I=_.fileSystemInfo,q=_.name,R=_.parentReference,U=_.remoteItem,z=_.root,W=_.size,X=_.thumbnails,V=_.image,$=_.video,J=_.eTag,K=_.tags,Q=_.photo,G=_.specialFolder,Y=_.lastModifiedDateTime,Z=void 0===Y?I&&I.lastModifiedDateTime||U&&U.lastModifiedDateTime:Y,ee=_.createdDateTime||I&&I.createdDateTime||U&&U.createdDateTime,te=R&&R.driveId,ne=R&&R.driveType||U&&U.parentReference&&U.parentReference.driveType,re="personal"===ne,ie=I&&I.lastAccessedDateTime||U&&U.fileSystemInfo&&U.fileSystemInfo.lastAccessedDateTime,se=null===(t=Q)||void 0===t?void 0:t.takenDateTime,oe=_.package||U&&U.package,ue=X||U&&U.thumbnails,ae=V||U&&U.image,fe=$||U&&U.video,le=_.shared||U&&U.shared,ce={itemId:_.id,driveId:te,endpoint:D},he=I&&I.systemPath,pe=O||U&&U.parentReference&&{itemId:U.id,driveId:U.parentReference.driveId,endpoint:D}||ce,de=u.e.serialize(pe),ve=_.webDavUrl||U&&U.webDavUrl;n="business"!==ne&&"documentLibrary"!==ne&&"personal"!==ne||!z?q||U&&U.name||"":p.e;var me=_.folder||U&&U.folder,ge=W||U&&U.size,ye=me&&me.childCount,be=M(n,!!me),we=be.extension||_.package&&_.package.type,Ee=we&&Object(w.e)(we),Se=_.sharepointIds||U&&U.sharepointIds,xe=_.localItem,Te=_.webUrl||U&&U.webUrl;return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},u.e.pack(pe)),s.h.pack(n)),void 0!==ge?s.v.pack(ge):{}),I||_.folder||F||U&&U.folder?Object(r.__assign)({},s.m.pack(me?{}:void 0)):{}),Te?s.O.pack(Te):{}),y.r.pack(he)),ve?s.i.pack(decodeURIComponent(ve)):{}),s.f.pack(Z?new Date(Z).getTime():void 0)),s.u.pack(ee?new Date(ee).getTime():void 0)),d.u.pack(se?new Date(se).getTime():void 0)),ie?Object(r.__assign)({},s.o.pack(new Date(ie).getTime())):{}),i.i.pack(oe&&"oneNote"===oe.type?{}:void 0)),ue?Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f.e.pack(ue)),x.e.pack(!0)),C.e.pack(Object(k.i)(be.extension))):{}),Object(T.e)().forFacet(d.v).thenInvalidate(de,f.e).pack()),l.e.pack(_)),J?s.p.pack(J):{}),ae&&ae.width&&ae.height?d.a.pack({width:ae.width,height:ae.height}):{}),ae&&!fe?d.p.pack({}):{}),fe?d.g.pack({}):{}),o.t.pack({itemKey:a.e.serialize({driveItemKey:pe,sortBy:"",isAscending:!0})})),s.n.pack({itemKey:c.e.serialize({driveItemKey:pe})})),s.M.pack(P?{itemKey:P}:void 0)),!re&&ve?Object(r.__assign)({},s._.pack((function(e){var t=e.split("/");return t.length>2?decodeURIComponent(t[t.length-2]):void 0})(ve))):{}),m.e.pack(ne)),re?Object(r.__assign)({},g.e.pack(_.vault)):{}),re&&_.restricted?Object(r.__assign)({},L.pack(_.restricted)):{}),s.d.pack(be)),B?Object(r.__assign)(Object(r.__assign)({},s.x.pack(!!le)),h.e.pack(le)):{}),xe?y.t.pack(xe):{}),"number"==typeof ye?v.e.pack(ye):{}),N.e.pack(j)),A.e.pack(K)),y.n.pack(F&&F.mimeType)),Ee?b.e.pack(Ee):{}),Se?E.e.pack(Se):{}),G?S.e.pack(G.name):{})}function M(e,t){var n=e.lastIndexOf(".");return t||n<0?{name:e,extension:""}:{name:e.substring(0,n),extension:e.substring(n)}}},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return M});var r=n(0),i=n(10),s=n(217),o=n(198),u=n(154),a=n(244),f=n(749),l=n(761),c=n(798),h=n(120),p=n(155),d=n(349),v=n(476),m=n(45),g=n(65),y=n(573),b=n(1),w=n(6),E=n(8),S=n(301),x=n(259),T=n(297),N=n(122),C=n(398),k=n(404),L=n(306),A=n(363),O=n(756),M=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Object(p.t)({keyFacet:c.e,facets:[m.e,w.h,w.d,b.bn,w.m,b.pe,E.t,b.Ke,C.e,C.t,b.lt,w.i]}));e(Object(s.r)(c.e,d.e)(Object(i.i)({maxParallelOperationCount:8})(_)));return[2]})})}});function _(e){var t=this,n=e.itemKey,i=c.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,p,d,w,C,M,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$;return Object(r.__generator)(this,function(J){switch(J.label){case 0:t=new o.e({publisher:_});s=!1;p=new u.e(i.itemFullUrl);d=e((function(e,t,n){return function(r){var i,s=e.itemFullUrl,o=["File_x0020_Type","FileRef","FileLeafRef","_ip_UnifiedCompliancePolicyUIAction","_ComplianceFlags","CheckoutUser","CheckedOutUserId","Created_x0020_Date.ifnew"];i=[new u.e(s).path];var a=r(Object(N.e)({contentTypeId:b.d},c.e.serialize(e)));if(t&&t.length>0&&a&&a.contentTypeId)for(var f=0,l=t;f<l.length;f++){var h=l[f];if(h.contentTypeId===a.contentTypeId&&h.Fields)for(var p=0,d=h.Fields.split(",");p<d.length;p++){var v=d[p];"Modified_x0020_By"===v?o.push("Editor"):"Created_x0020_By"===v?o.push("Author"):o.push(v)}}var m=Object(T.i)({itemRefs:i,recurseInFolders:!0,pageSize:1,fieldNames:o});return{webAbsoluteUrl:"",listFullUrl:s,currentPageContext:void 0,qosName:n,viewXml:m,rootFolder:void 0,postDataContext:{needUpdatePageContext:!0,needsSchema:!0}}}})(i,void 0,"getSPItemByFullUrl"));J.label=1;case 1:J.trys.push([1,3,,4]);return[4,e(Object(S.e)({getItemContext:d}))];case 2:w=J.sent();C=w.WebUrl||v.i(decodeURIComponent(w.HttpRoot||""))||p.authority;M=""+new u.e(C).authority+(w.ListUrl||decodeURIComponent(w.listUrlDir||""));D={webAbsoluteUrl:C,listFullUrl:M,rootFolder:""};P=e(Object(x.t)({serverData:w,itemSetKey:D,currentPageContext:d.currentPageContext,contentTypes:void 0,isItemSetRequest:s})),H=P.itemResolver,B=P.childKeys,j=P.pageContext;F=B[0];I=g.e.serialize(D);F&&t.mapKeys({mappings:(V={},V[F]=c.e.serialize(i),V)});if(j){q=y.e.serialize({webAbsoluteUrl:C,listFullUrl:M});e(Object(N.e)({pageContext:b.un},q)).pageContext||e(Object(f.e)({itemKey:q,options:{pageContext:j}}))}t.merge(H);if(m.e.matches(F)){R=m.e.deserialize(F);(U=e(Object(k.t)({webAbsoluteUrl:R.webAbsoluteUrl,listFullUrl:R.listFullUrl,serverData:w,pageContext:j})))&&t.merge(U.itemResolver)}z=h.e.serialize({webAbsoluteUrl:C,listFullUrl:M});t.resolveItems({items:($={},$[m.e.serialize(D)]=Object(r.__assign)({},E.t.pack({itemKey:I})),$[n]=Object(r.__assign)({},a.n.pack(m.e)),$[z]=Object(r.__assign)({},Object(l.e)(w,j)),$)});e(t.execute());e(Object(L.e)({itemSetKey:I,serverData:w,isItemSetRequest:s}));return[3,4];case 3:W=J.sent();X=Object(O.e)(W);throw new A.e({facets:X,innerError:W});case 4:return[2]}})})}}},function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(130);function i(e){switch(e){case r.e.Word:return".docx";case r.e.Excel:case r.e.ExcelSurvey:case r.e.ExcelForm:return".xlsx";case r.e.PowerPoint:return".pptx";case r.e.OneNote:return"";case r.e.Text:return".txt";case r.e.Visio:return".vsdx";case r.e.Bohemia:return".b";case r.e.Prague:return".prague"}}function s(e,t){var n="";switch(e){case r.e.Word:n=t.CreateWord;break;case r.e.Excel:n=t.CreateExcel;break;case r.e.PowerPoint:n=t.CreatePowerPoint;break;case r.e.OneNote:n=t.CreateOneNote;break;case r.e.ExcelSurvey:n=t.CreateExcelSurvey;break;case r.e.Text:n=t.CreateText;break;case r.e.ExcelForm:n=t.CreateFormForExcel;break;case r.e.Visio:n=t.CreateVisio;break;case r.e.Bohemia:n=t.CreateBohemia;break;case r.e.Prague:n=t.CreatePrague}return n}},function(e,t,n){"use strict";n.d(t,"e",function(){return d});n.d(t,"t",function(){return v});n.d(t,"i",function(){return m});n.d(t,"r",function(){return g});n.d(t,"n",function(){return y});var r,i=n(1),s=n(6),o=n(62),u=n(1069),a=n(2369),f=n(45),l=n(120),c=n(2771),h=n(1176),p=n(1099);(function(e){e[e.publish=0]="publish";e[e.schedule=1]="schedule"})(r||(r={}));function d(e,t){var n,r,a;if(!t)return!1;var h=e.demandItem({firstItemKey:f.e,permissions:i.lt,checkoutInfo:s.w,needsPublishing:i.tt},t),d=h.firstItemKey,v=h.permissions,m=h.checkoutInfo,y=h.needsPublishing;if(!d)return!1;var b=e.demandItemFacet(i.Re,l.e.serialize({webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl}));return Boolean(y&&o.e.hasItemPermission({permissions:v},o.e.editListItems)&&(null===(n=b)||void 0===n?void 0:n.enableMinorVersions)&&(null===(r=b)||void 0===r?void 0:r.isDocumentLibrary)&&!(null===(a=m)||void 0===a?void 0:a.byOther)&&!p.e(e,t)&&!(function(e,t){var n=t.itemKey,r=t.listFacets,s=e.demandItem({moderationStatusType:i.Ge},n).moderationStatusType;if(r&&r.isModerated)return"number"==typeof s&&s!==u.e.draft&&s!==u.e.denied&&s!==u.e.pending;var o=g(e,n);return 0===o.minor&&0!==o.major})(e,{itemKey:t,listFacets:b})&&!c.t(e,{itemKey:t,includeOneNote:!0}))}function v(e){return e?""+512*(Math.floor(Number(e)/512)+1):""}function m(e){return!!e&&0===e.indexOf("0x0101009D1CB255DA76424F860D91F20E6C4118")}function g(e,t){var n=e.demandItem({uiVersion:i.gn},t).uiVersion;return Object(h.t)(n)}function y(e,t){var n,r=e.demandItem({firstItemKey:f.e,moderationStatusType:i.Ge},t),s=r.firstItemKey,o=r.moderationStatusType;return s?(null===(n=e.demandItemFacet(i.Re,l.e.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl})))||void 0===n?void 0:n.isModerated)?o===u.e.pending?a.e.CancelApproval:a.e.SubmitForApproval:p.t(e,t)?a.e.SchedulePublish:0===g(e,t).major?a.e.Publish:a.e.Republish:a.e.Publish}}],Array(55),[function(e,t,n){"use strict";n.d(t,"e",function(){return h});var r=n("react-lib"),i=n(201),s=n(18),o=n(1635),u=n(428),a=n(6),f=n(110),l=n(401),c=n(443);var h=function(e){var t=e.itemKey,n=e.action;return r.createElement(i.e,null,function(i){var h,p=i.itemCache;if(e.children)h=e.children;else{var d=p.demandItemFacet(a.h,t);h=d}var v=Object(f.e)(p),m=(n||!(function(e,t){var n=Object(l.e)(e,{itemKey:t.itemKey1}),r=Object(l.e)(e,{itemKey:t.itemKey2});return Object(c.e)(e,{itemKey:n})===Object(c.e)(e,{itemKey:r})})(p,{itemKey1:t,itemKey2:v}))&&t?r.createElement(u.e,{itemKey:t}):null;return r.createElement(s.n,{action:m},function(e){var t=e.isAvailable,n=e.execute,i=t?function(){n().catch(function(){})}:void 0;return i?r.createElement(o.e,{onClick:i},h):r.createElement("span",null,h)})})}},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(5),i=new r.e("uploadProgress",{sourceEntryKey:Object(r.s)()});function s(e){return i.serialize({sourceEntryKey:e})}},function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});n.d(t,"r",function(){return o});n.d(t,"n",function(){return u});var r=n(17),i=new r.e("fileHandlerActionControl"),s=new r.e("fileHandlerCustomActionControl"),o=new r.e("fileHandlerOpenActionControl"),u=new r.e("fileHandlerInvokeActionControl")},function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return a});var r=n(2),i=n(421),s=n(5),o=new r.e("updateItem"),u=new s.e("updateListItem",{itemDisplayName:Object(s.s)()}),a=new i.e("updateListItemProgress",function(e,t){return u.serialize({})})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(492).e)("calendarMonth")},function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n("react-lib"),i=n(1871),s=n(1699),o=n(1739),u=n(1772),a=n(1845),f=!n(70).t.isActivated("FC7D1342-F071-4F82-9DD9-667F218BE34B","09/21/2021","Fixes style issues in the Warning dialog, no dismiss X and unnecessarily bold prompt text"),l=function(e){var t=e.cancelText,n=e.onCancel;return r.createElement(i.e,{dialogContentProps:f?{type:s.e.close,subText:e.prompt?e.prompt:""}:void 0,onDismiss:n,hidden:!1,title:e.title,maxWidth:e.maxWidth},r.createElement(o.e,null,f?void 0:r.createElement(a.e,null,prompt),r.createElement(u.e,{onClick:n,componentRef:function(e){e&&e.focus()}},t)))}},,,,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"n",function(){return i});n.d(t,"r",function(){return s});n.d(t,"i",function(){return o});n.d(t,"s",function(){return u});n.d(t,"e",function(){return a});var r="socialBarList_36611a00",i="socialBarPanel_36611a00",s="socialBarPanelContent_36611a00",o="socialBarPanelPersona_36611a00",u="socialBarPanelPersonaDescription_36611a00",a="analyticsStatsLink_36611a00"}],Array(132),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("vault")},function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});var r=n(2),i=new r.e("officeApp"),s=new r.e("officeLens")},function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r=n(1),i=n(6),s=n(62),o=n(132);function u(e,t){var n=t.itemKey,r=t.includeOneNote,s=e.demandItem({folder:i.m,oneNote:o.i},n),u=s.folder,a=s.oneNote;return r?!!u||!!a:!!u&&!a}function a(e,t){var n=t.itemKey,o=t.listFacets,u=!!o&&!!o.isModerated;if(u){var a=e.demandItem({permissions:r.lt,checkoutInfo:i.w},n),f=a.permissions,l=a.checkoutInfo;u=!!(!l||!l.byOther&&!l.byYou)&&!!f&&s.e.hasItemPermission({permissions:f},s.e.editListItems)&&s.e.hasItemPermission({permissions:f},s.e.approveItems)}return u}},function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(0),i=n(45),s=n(1),o=n(1550),u=n(137),a=n(53);function f(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,f,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=n(Object(u.e)(function(t){return t.demandItemFacet(i.e,e)}));return[4,n(Object(o.e)(function(t){return t.demandItem({listItemId:s.We},e)}))];case 1:f=r.sent().listItemId;if(!t)throw new a.e({code:"MissingSPItemKeyFacetForItem",message:"Could not determine the spItemKeyFacet value for an item"});if(!(l=f||t.itemId))throw new a.e({code:"MissingListItemIdForItem",message:"Could not determine the List ItemId value for an item"});return[2,{key:t,itemId:l}]}})})}}},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(352),s=new r.e("bulkUpdateListItems"),o=Object(i.e)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(352),s=new r.e("modifyView"),o=Object(i.e)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"e",function(){return v});var r=n(0),i=n(510),s=n(10),o=n(137),u=n(198),a=n(2),f=n(131),l=n(61),c=n(74),h=n(163),p=n(801),d=n(8);function v(e,t){return Object(s.n)()(function(e){var n=this;return function(s){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,v,m,g,y,b,w,E,S,x,T;return Object(r.__generator)(this,function(N){switch(N.label){case 0:n=s(Object(o.e)(function(n){var i={operationTypeFacet:t,items:{}},s=new u.e;function o(e){var u,p=n.demandItemFacet(c.b,e),v=p&&p.itemKey,m=n.demandItemFacet(t,e),g=Object(h.r)(n,{itemKey:e}).phase;if(v&&m&&"failed"===g){i.items[v]=Object(r.__assign)(Object(r.__assign)({},m),{progressItemKey:e});s.resolveItems({items:(u={},u[e]=Object(r.__assign)({},Object(a.n)({error:f.e},{error:new l.e})),u)})}var y=n.demandItemFacet(d.e,e);if(y)for(var b=0,w=y.itemKeys;b<w.length;b++){o(w[b])}}for(var p=0,v=Object.keys(e.items);p<v.length;p++){o(v[p])}return{itemResolver:s,operationPayload:i}}));s(n.itemResolver.execute());v=s(Object(i.e)(n.operationPayload)),m=v.completed,g=v.items;for(y=0,b=Object.keys(g);y<b.length;y++){w=b[y];E=g[w],S=E.started,x=E.completed;(T=n.operationPayload.items[w].progressItemKey)&&s(Object(p.e)({progressItemKey:T,started:S,completed:x}))}return[4,m];case 1:N.sent();return[2]}})})}})}},function(e,t,n){"use strict";n.d(t,"n",function(){return g});n.d(t,"t",function(){return y});n.d(t,"e",function(){return S});var r=n(9),i=n(45),s=n(120),o=n(912),u=n(1),a=n(29),f=n(27),l=n(154),c=n(82),h=n(889),p=n(6),d=n(594),v=n(75),m=n(94),g=Object(r.t)()(w),y=Object(r.t)()(w),b={ODB:1928};function w(){return function(e){return E}}function E(e,t){var n=t.itemKey,r=t.desiredSize,f=e.demandItemFacet(i.e,n);if(!f)return{};var l=(function(e,t){var n=t.itemKey,r=t.spItem,i=t.desiredSize,s=S(e,{itemKey:n,spItem:r});if(s){var o=Math.ceil(i.width),u=Math.ceil(i.height);return{url:s(o,u),width:0,height:0}}})(e,{itemKey:n,spItem:f,desiredSize:r})||(function(e,t){var n=t.itemKey,r=t.desiredSize,i=e.demandItemFacet(o.t,n),s=i&&i(r.width,r.height);if(s)return{url:s,width:0,height:0}})(e,{itemKey:n,desiredSize:r})||(function(e,t){var n=t.spItem,r=t.itemKey,i=s.e.serialize(n),f=e.demandItemFacet(u.Re,i);if(!f)return;var l=f.templateType===a.n.publishingAsset;if(f.isPromotedLinks||l){var c=e.demandItemFacet(u.Ct,r),h=void 0;f.isPromotedLinks?h=c&&c.BackgroundImageLocation:l&&c&&c.AlternateThumbnailUrl&&(h=e.demandItemFacet(o.e,r));if(h)return{url:h,width:0,height:0}}})(e,{spItem:f,itemKey:n});return l?{thumbnail:l}:{}}function S(e,t){var n=t.itemKey,r=t.spItem,i=Object(f.e)(e,{enableSharePointDirectThumbnails:u.ee,spCookieDomainConfiguration:u.Bt}),s=i.enableSharePointDirectThumbnails,o=void 0===s||s,a=i.spCookieDomainConfiguration,g=Object(m.e)(e,n);if(o&&Object(v.e)(e,{pageContext:g,feature:b})&&g){var y=r.webAbsoluteUrl,w=r.listFullUrl,E=new l.e(y||w).authority;if(a&&a===E){var S=E+"/_api/v2.1",x=e.demandItemFacet(c.e,n),T=e.demandItemFacet(p.p,n)||"";if(x){var N=x.driveId,C=x.itemId,k=Object(h.t)({endpoint:S,driveId:N,itemId:C});return function(e,t){return k+"/thumbnails/0/c"+e+"x"+(t=t||e)+"/content?"+Object(d.e)({prefer:"noredirect,closestavailablesize",cb:T})}}}}}},function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return a});var r=n(2),i=n(421),s=n(5),o=new r.e("setItemValuesFromFormatter"),u=new s.e("setItemValuesFromFormatter",{}),a=new i.e("setItemValuesFromFormatterProgress",function(e,t){return u.serialize({})})}],Array(56),[function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(0),i=n("react-lib"),s=n(1635),o=n(2056),u=n(18),a=n(26),f=n(30),l=n(176),c=n(47),h=n(40),p=Object(l.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(["45","ondemand.resx-ondemand"],4251)];case 1:return[2,e.sent().default]}})})}),d=Object(h.t)(function(e,t){var n=t.itemKey,s=Object(u.o)(function(e){return i.createElement(p,Object(r.__assign)({},e,{itemKey:n}))},{scope:"global"});return i.createElement(f.e,Object(r.__assign)({onExecute:s},Object(c.t)(e,{itemKey:n,engagement:{name:"SocialBar",isIntentional:!0}})))}),v=(Object(a.i)()(d),n(2636)),m=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.likeLabel,n=e.itemKey,r=i.createElement(o.e,{activityDescription:t,isCompact:!0});return i.createElement(u.n,{action:i.createElement(d,{itemKey:n})},function(e){var t=e.isAvailable,n=e.execute,o=t?function(){n().catch(function(){})}:void 0;return i.createElement(s.e,{disabled:!1,className:v.e,onClick:o},r)})};return t})(i.Component)}],Array(27),[function(e,t,n){"use strict";n.d(t,"t",function(){return p});n.d(t,"e",function(){return d});var r=n(0),i=n(52),s=n(204),o=n(1777),u=n(119),a=n(2015),f=n(1062),l=n(1),c=n(2863),h=n(162);function p(e){throw new f.e({facets:Object(r.__assign)({},s.f.pack({maxFileSize:e}))})}function d(e){return function(t){if(i.n.isCanceled(e))return new u.e;if(e instanceof a.e)return new f.e({facets:t((p=e,function(e){if(p.errorType===o.e.conflict||p.errorType===o.e.similarNameExists){var t=e(Object(h.e)({enableRenameOnUploadConflict:l.G})).enableRenameOnUploadConflict;switch(p.errorType){case o.e.conflict:return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},s.m.pack({})),s.t.pack(!!t)),s.n.pack(!0)),s.s.pack({supportsRename:!!t}));case o.e.similarNameExists:return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},s.S.pack({})),s.t.pack(!0)),s.n.pack(!1))}}switch(p.errorType){case o.e.accessDenied:return Object(r.__assign)({},s.e.pack({}));case o.e.disconnected:return Object(r.__assign)({},s.y.pack({}));case o.e.emptyFileOrFolder:case o.e.emptyFileOrFolderForDocLib:return Object(r.__assign)({},s.o.pack({}));case o.e.folderUploadNotSupported:return Object(r.__assign)({},s.l.pack({}));case o.e.invalidName:return Object(r.__assign)({},s.h.pack({}));case o.e.lockMismatch:return Object(r.__assign)({},s.d.pack({}));case o.e.malwareDetected:return Object(r.__assign)({},s.v.pack({}));case o.e.overQuota:return Object(r.__assign)({},s.w.pack({}));case o.e.targetFolderMissing:return Object(r.__assign)({},s.x.pack({}));case o.e.throttled:return Object(r.__assign)({},s.T.pack({}));case o.e.versionMismatch:return Object(r.__assign)({},s.N.pack({}))}return Object(r.__assign)({},s.E.pack({}))})),innerError:e});if(Object(c.t)(e)){var n=t(Object(h.e)({enableRenameOnUploadConflict:l.G})).enableRenameOnUploadConflict;return new f.e({facets:Object(r.__assign)(Object(r.__assign)({},"-2130575257"===e.code?Object(r.__assign)({},s.s.pack({supportsRename:!!n})):Object(r.__assign)({},s.E.pack({}))),l.Rt.pack(e)),message:Object(c.e)(e)})}var p;return e}}},function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return i});function r(e){return!!e&&("status"in e||!(!e.message||"object"!=typeof e.message))}function i(e){return e&&e.message&&("object"==typeof e.message?e.message.value:e.message.toString())||""}},function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n(2),i=n(421),s=new r.e("assignItemToGroup"),o=new i.e("assignToGroup")},,function(e,t,n){"use strict";n.d(t,"n",function(){return r});n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});var r="root",i="/drive/root:",s=30},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("graphThumbnailSet")},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(5),i=new r.e("userByEmail",{email:Object(r.s)(),endpoint:Object(r.s)()})},function(e,t,n){"use strict";n.d(t,"e",function(){return l});n.d(t,"t",function(){return c});n.d(t,"n",function(){return h});n.d(t,"r",function(){return p});n.d(t,"i",function(){return d});n.d(t,"s",function(){return m});var r=n(0),i=n(1046),s=n(3397),o=n(3396),u=n(82),a=n(112),f=n(132),l=(new a.e("addToOneDrive",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.e}))}),new a.e("canCreateFolder",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.t}))})),c=(new a.e("canCreateLink",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.n}))}),new a.e("canDelete",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.r}))})),h=new a.e("canDownload",function(e,t){return!e.demandItemFacet(f.i,t.itemKey)&&v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.i}))}),p=(new a.e("canInvite",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.s}))}),new a.e("canMove",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.o}))}),new a.e("canUseOfficeLens",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.u}))}),new a.e("canRename",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.a}))})),d=new a.e("canUpload",function(e,t){return v(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:s.f}))});function v(e,t){var n=t.itemKey,r=t.commandFacet,i=e.demandItemFacet(u.e,n);if(!i)return!1;var s=i.endpoint,a=i.driveId,f=e.demandItemFacet(r,o.e.serialize({endpoint:s,driveId:a}));return!!f&&!!f.roles&&m(e,{itemKey:n,oneOfRequiredRoles:f.roles})}function m(e,t){var n=t.itemKey;return(function(e,t){var n=t.oneOfRequiredRoles,r=t.effectiveRoles;for(var i in r)if(i in n)return!0;return!1})(0,{oneOfRequiredRoles:t.oneOfRequiredRoles,effectiveRoles:(function(e,t){if((function(e,t,n){var r,s,o,u=e.demandItemFacet(i.e,t),a=null===(o=null===(s=null===(r=u)||void 0===r?void 0:r.owner)||void 0===s?void 0:s.user)||void 0===o?void 0:o.id;if(n&&a)return n.toUpperCase()===a.toUpperCase();return!u||!u.effectiveRoles||!u.owner})(e,t))return["read","write","owner"];var n=e.demandItemFacet(i.e,t);if(n&&n.effectiveRoles)return n.effectiveRoles;return[]})(e,n)})}},,function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(421),s=new r.e("updatePublishState"),o=new i.e("publish")},function(e,t,n){"use strict";n.d(t,"t",function(){return o});n.d(t,"e",function(){return u});var r,i=n(2),s=n(352);(function(e){e[e.previewColumnFormatter=0]="previewColumnFormatter";e[e.saveColumnFormatter=1]="saveColumnFormatter";e[e.previewViewFormatter=2]="previewViewFormatter";e[e.saveViewFormatter=3]="saveViewFormatter"})(r||(r={}));var o=new i.e("updateFormatter"),u=Object(s.e)({operationTypeFacet:o})},function(e,t,n){"use strict";n.d(t,"e",function(){return k});var r=n(0),i=n("react-lib"),s=n(40),o=n(30),u=n(57),a=n(26),f=n(119),l=n(65),c=n(120),h=n(1),p=n(47),d=n(2773),v=n(2771),m=n(62),g=n(1069),y=n(27),b=n(29),w=n(731),E=n(6),S=n(18),x=n(176),T=Object(x.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(["26","ondemand.resx-ondemand"],3577)];case 1:return[2,e.sent().ApproveRejectDialog]}})})}),N=Object(s.t)(function(e,t){var n=t.onContinue,s=t.onCancel,o=t.resolve,u=t.reject,a=Object(r.__rest)(t,["onContinue","onCancel","resolve","reject"]);return i.createElement(T,Object(r.__assign)({},a,{onContinue:function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return n?[4,n(e)]:[3,2];case 1:t.sent();t.label=2;case 2:o();return[2]}})})},onCancel:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return s?[4,s()]:[3,2];case 1:e.sent();e.label=2;case 2:u(new f.e);return[2]}})})}}))}),C=Object(s.t)(function(e,t){var n=t.itemKeys,s=Object(u.e)(e);if(!s)return null;var a=e.demandItem({setKey:l.e},s).setKey;if(!a||!n||!n.length)return null;if(!Object(y.e)(e,{enbableApproveRejectConfiguration:h.T}).enbableApproveRejectConfiguration)return null;var f=!0,x=e.demandItemFacet(h.Re,c.e.serialize({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl}));if(x&&x.templateType===b.n.webPageLibrary&&n.length>1)return null;for(var T,C,k=!0,L=!0,A=!1,O={},M=0,_=n;M<_.length;M++){var D=_[M];if(!v.e(e,{itemKey:D,listFacets:x}))return null;var P=e.demandItem({permissions:h.lt,moderationStatusType:h.Ge,moderationComments:h.Qe},D),H=P.permissions,B=P.moderationStatusType,j=P.moderationComments;if(x&&!x.isDocumentLibrary&&!m.t.hasItemPermission({permissions:H},m.t.layoutsPage))return null;if(void 0!==B){var F=O[g.e[B]];O[g.e[B]]=F?F+1:1}void 0===T?T=j:T!==j&&(k=!1);void 0===C?C=B:C!==B&&(L=!1);B===g.e.draft&&(A=!0);if(!(f=v.t(e,{itemKey:D,includeOneNote:!0})||B===g.e.pending||!!x&&!x.enableMinorVersions))return null}if(x&&x.templateType===b.n.webPageLibrary){if(f){return(D=t.itemKeys?t.itemKeys[0]:void 0)?i.createElement(w.e,{itemKey:t.itemKeys?t.itemKeys[0]:"",engagement:{name:"ApproveReject",isIntentional:!0}}):null}return null}var I,q=L&&C===g.e.draft&&!!x&&!!x.enableMinorVersions,R=A,U=e.dispatch,z=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(r){t=[{FieldName:"_ModerationStatus",FieldValue:e.status.toString()}];void 0!==e.comment&&t.push({FieldName:"_ModerationComments",FieldValue:e.comment});return[2,U(Object(d.e)({items:(i={},i[s]={itemKeys:n,formValues:t,qosName:"BulkApproveReject"},i)}))]})})},W=n.length,X=W>1?"BulkApproveReject":"ApproveReject";1===W&&(I=e.demandItemFacet(E.h,n[0]));var V=Object(S.o)(function(e){return i.createElement(N,Object(r.__assign)({},e,{onContinue:z,hideApproveRejectOptions:q,showDraftOption:R,initialComment:k?T:void 0,initialStatus:L?C:void 0,itemCount:n.length,itemName:I,initialStatusMapForBulkEdit:O}))});return i.createElement(o.e,Object(r.__assign)({isAvailable:f,onExecute:V},Object(p.t)(e,{itemKey:n[0],engagement:{name:X,isIntentional:!0}})))}),k=Object(a.s)()(C)},function(e,t,n){"use strict";n.d(t,"t",function(){return f});n.d(t,"e",function(){return l});var r=n(0),i=n(40),s=n(2320),o=n(26),u=n(6),a=n(47),f=Object(i.e)(function(e,t){var n=t.itemKey,i=t.action,o=!1;if(n){var f=e.demandItem({fileName:u.d,isFolder:u.m},n),l=f&&f.fileName,c=l&&l.extension||"",h=f&&f.isFolder||!1;o=Object(s.t)(i.availableOn,c,Boolean(h))}var p=i.handler,d=p.appId,v=p.isPromoted?"PromotedFileHandlerOpen":"FileHandlerOpen",m={appId:d};return Object(r.__assign)({isAvailable:o,itemKeys:n?[n]:[]},Object(a.t)(e,{itemKey:n,engagement:{name:v,isIntentional:!0,extraData:m}}))})(s.e),l=Object(o.s)()(Object(o.r)()(f))},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(492).e)("kanban")},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(40),s=n(30),o=n(120),u=n(1240),a=n(1),f=n(2774),l=n(47),c=Object(i.e)(function(e,t){var n=t.currentDerivedView,i=t.listViewSetKey,s=!1,u=i&&o.e.serialize(i);if(i&&n){var f=e.demandItemFacet(a.Re,u);s=!(!(f&&f.permissions&&f.permissions.manageLists&&n&&n.id)||n.isPersonal||n.isDefault)}return Object(r.__assign)({isAvailable:s},Object(l.t)(e,{itemKey:u,engagement:{name:"SetDefaultView",isIntentional:!0}}))},function(e,t){var n=t.currentDerivedView,i=t.listViewSetKey;return{onExecute:n?function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,s;return Object(r.__generator)(this,function(r){e(Object(f.e)({items:(t={},t[u.e.serialize(i)]={views:(s={},s[n.id]={isDefault:!0},s)},t)}));return[2]})})}:void 0}})(s.e)},function(e,t,n){"use strict";n.d(t,"e",function(){return p});n.d(t,"t",function(){return d});var r=n(0),i=n("react-lib"),s=n(1251),o=n(952),u=n(1),a=n(1679),f=n(155),l=n(10),c=n(371),h=n(130),p=Object(l.i)()(function(e){var t=this,n=e.itemKey,a=s.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(s){e(Object(f.e)({items:(t={},t[n]=Object(r.__assign)({},u.t.pack(function(){return i.createElement(c.e,{documentType:d(a.templateUrl),templateItemKey:o.e.serialize({listKey:a.listKey,templateUrl:a.templateUrl})})})),t)}));return[2]})})}});function d(e){var t=h.e.Word;if(e){var n=e.lastIndexOf(".");if(n){var r=e.substr(n+1).toLowerCase();switch(a.t[r]){case a.i:t=h.e.OneNote;break;case a.s:t=h.e.PowerPoint;break;case a.n:t=h.e.Excel;break;case a.o:t=h.e.Visio}}}return t}},function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});var r=n(2),i=new r.e("fileDownloadError"),s=new r.e("getFileDownloadUrlError")},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"n",function(){return i});n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=new r.e("shortcutExistedAlready"),s=new r.e("nestedDescendantShortcutExists"),o=new r.e("nestedAscendantShortcutExists")}],Array(50),[function(e,t,n){"use strict";n.d(t,"e",function(){return y});var r=n(170),i=n("react-lib"),s=n(1215),o=n(6),u=n(18),a=n(428),f=n(154),l=n(136);var c=n(240),h=n(60),p=n(793),d=n(794),v=n(788),m=n(789),g=n(787),y=Object(p.e)({key:c.r,name:r.a,fieldName:"",isCollapsible:!1,minWidth:445,maxWidth:445,sortProps:h.r},[d.e,g.e,function(e,t){var n=t.itemKey,r=t.renderer,c=e.demandItemFacet(o.M,n),h=c&&e.demandItemFacet(o.O,c.itemKey)||"",p=h?(function(e){for(var t=[],n=new f.e(e),r=0,i=n.segments.slice(1);r<i.length;r++){var s=i[r];try{t.push(decodeURIComponent(s))}catch(e){t.push(s)}}return t})(h):[],d=c&&h?Object(l.r)(e,i.createElement(a.e,{itemKey:c.itemKey})):null;return{renderer:function(e,t,n){var o=r?r(e,t,n):null;return i.createElement(i.Fragment,null,o?i.createElement(i.Fragment,{key:"content"},o):null,d?i.createElement(u.n,{key:"path",action:d},function(e){var t=e.execute,n=e.isAvailable?function(e){t({event:e}).catch(function(){});e.preventDefault();e.stopPropagation()}:void 0;return i.createElement(s.e,{displayPathSegments:p,parentLink:h,onClick:n})}):null)}}},v.e,m.e])}],Array(28),[function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"l",function(){return s});n.d(t,"i",function(){return o});n.d(t,"u",function(){return u});n.d(t,"o",function(){return a});n.d(t,"n",function(){return f});n.d(t,"f",function(){return l});n.d(t,"a",function(){return c});n.d(t,"e",function(){return h});n.d(t,"r",function(){return p});n.d(t,"s",function(){return d});n.d(t,"c",function(){return v});var r=n(2),i=Object(r.t)("createView"),s=Object(r.t)("switchView"),o=Object(r.t)("needsAttentionView"),u=Object(r.t)("smartTemplate"),a=Object(r.t)("setDefaultView"),f=Object(r.t)("customizeView"),l=Object(r.t)("switchToFixedGridLayoutCommand"),c=Object(r.t)("switchToDynamicGridLayoutCommand"),h=Object(r.t)("calendarMonth"),p=Object(r.t)("kanban"),d=Object(r.t)("saveView"),v=Object(r.t)("syncIssues")},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(0),i=n(150);var s=Object(i.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(["24"],2643)];case 1:return[2,e.sent().SwitchViewExecutor]}})})},function(e,t){return!0},function(e,t){var n=t.currentDerivedView,r=t.viewId;return n?r===n.id:""===r})},function(e,t,n){"use strict";n.d(t,"n",function(){return i});n.d(t,"r",function(){return s});n.d(t,"t",function(){return o});n.d(t,"e",function(){return u});var r=n(2),i=new r.e("isViewCommand"),s=new r.e("isSwitchViewCommand"),o=new r.e("isEditViewCommand"),u=new r.e("isCreateViewCommand")}],Array(13),[function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(565);function i(e,t){var n=e.demandItemFacet(r.t,t);return r.t.evaluate(n)(e,{itemKey:t}).parentList}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("driveItemResponse")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("sharepointIds")},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(5),i=n(82),s=new r.e("searchItemSet",{driveItemKey:Object(r.o)(i.e),searchTerm:Object(r.s)()})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(5),i=new r.e("thumbnailToken",{endpoint:Object(r.s)(),driveId:Object(r.s)({shouldNormalizeToEmpty:!0})})},function(e,t,n){"use strict";n.d(t,"e",function(){return u});n.d(t,"t",function(){return a});var r,i=n(22),s=n(3627);(function(e){e[e.InvalidStart=0]="InvalidStart";e[e.InvalidEnd=1]="InvalidEnd";e[e.InvalidCharacters=2]="InvalidCharacters";e[e.Empty=3]="Empty"})(r||(r={}));function o(e){return function(t){return(function(e,t){switch(e){case r.InvalidCharacters:return i.format(s.n,t.invalidCharacters);case r.InvalidStart:return i.format(s.r,t.cannotStartWith);case r.InvalidEnd:return i.format(s.t,t.cannotEndWith);case r.Empty:return s.e;case void 0:return}})((function(e,t){var n=e.trim();return 0===n.length?r.Empty:t.invalidCharactersRegex.test(n)?r.InvalidCharacters:t.cannotStartWithRegex&&t.cannotStartWithRegex.test(n)?r.InvalidStart:t.cannotEndWithRegex&&t.cannotEndWithRegex.test(n)?r.InvalidEnd:void 0})(t,e),e)}}var u=o({invalidCharactersRegex:/["\*:<>\?\/\\\|]/,invalidCharacters:'" * : < > ? / \\ |'}),a=o({invalidCharactersRegex:/["\*:<>\?\/\\\|#%]/,invalidCharacters:'" * : < > ? / \\ # %|'})},function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r=n(83),i=n(386),s=n(29),o=n(330);function u(e){return function(t){return t(Object(r.r)({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,method:"GET",url:c(e),qosName:"getViewData",additionalHeaders:e.preferredLanguage?{"Accept-Language":e.preferredLanguage}:{},parseResponse:function(t){return JSON.parse(t).d.results.map(function(t){var n=f(t,!1,e.listTemplate);t&&n&&!t.ViewData&&(t.ViewData=n.viewData);return{serverView:t,view:n}})},noRedirect:!0}))}}function a(e){return function(t){return t(Object(r.r)({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,method:"GET",url:c(e),qosName:"getViewDataById",parseResponse:function(e){var t=JSON.parse(e).d;return{serverView:t,view:f(t,!0)}},noRedirect:!0}))}}function f(e,t,n){if(e.ViewType&&e.Id){var r=o.e.isAppView(e),i=e.Hidden&&!r,u=n===s.t.pictureLibrary&&"2"===e.BaseViewId&&window.location.pathname.toLowerCase()!==e.ServerRelativeUrl.toLowerCase();if(t||!i&&!u){var a=new o.e(e);if(a.viewType)return a}}}var l=["BaseViewId","DefaultView","EditorModified","Hidden","Id","ListViewXml","PersonalView","RowLimit","Scope","ServerRelativeUrl","TabularView","Title","ViewType","VisualizationInfo","CustomFormatter"].join(",");function c(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.viewId,s=Object(i.e)({webAbsoluteUrl:t,listFullUrl:n});return(s=r?s.method("Views",r):s.segment("Views")).oDataParameter("$select",l).toString()}},,function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"n",function(){return s});n.d(t,"t",function(){return o});var r=n(2),i=new r.e("enabledForMultipleItems"),s=new r.e("isEnabledFunction"),o=new r.e("iconUrl")},function(e,t,n){"use strict";n.d(t,"t",function(){return d});n.d(t,"e",function(){return v});n.d(t,"r",function(){return m});n.d(t,"n",function(){return y});n.d(t,"i",function(){return b});var r=n(0),i=n("react-lib"),s=n(3254),o=n(3253),u=n(2),a=n(123),f=n(1),l=n(2998),c=n(2996),h=n(360),p=new u.e("moreCommands").id,d={key:new u.e("CheckOutItem").id,automationId:"checkOutItemCommand",name:o.t,iconProps:{iconName:"ArrowDownRight8"},action:i.createElement(s.e,{checkInOutType:"checkOut"}),facets:Object(r.__assign)({},f.Et.pack(h.r))},v={key:new u.e("CheckInItem").id,automationId:"checkInItemCommand",name:o.e,iconProps:{iconName:"ArrowDownRight8"},action:i.createElement(s.e,{checkInOutType:"checkIn"}),facets:Object(r.__assign)({},f.Et.pack(h.n))},m={key:new u.e("UndoCheckOutItem").id,automationId:"undoCheckoutItemCommand",name:o.i,iconProps:{iconName:"ArrowDownRight8"},action:i.createElement(s.e,{checkInOutType:"undoCheckOut"}),facets:Object(r.__assign)({},f.Et.pack(h.h))},g={key:new u.e("ViewDocumentProperties").id,name:a.O,action:i.createElement(c.e,{interactiveSave:!0}),facets:Object(r.__assign)({},f.Et.pack(h.d))},y={key:p,automationId:"moreCommands",name:"",iconProps:{iconName:"More"},subMenuProps:{items:[g,d,v,m]}};function b(e){var t=e.listFacets,n=Object(l.e)({listFacets:t}),r=!!t&&!t.isDocumentLibrary;return{key:p,automationId:"moreCommands",name:"",iconProps:{iconName:"More"},subMenuProps:{items:r?[n]:[g,d,v,m,n]}}}},function(e,t,n){"use strict";n.d(t,"e",function(){return b});var r=n(0),i=n("react-lib"),s=n(62),o=n(176),u=n(2997),a=n(40),f=n(18),l=n(169),c=n(1),h=n(47),p=n(30),d=n(45),v=n(120),m=n(29),g=n(27),y=Object(o.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(["14","ondemand.resx-ondemand"],3706)];case 1:return[2,e.sent().EditItemWizard]}})})}),b=Object(a.t)(function(e,t){var n=Object(l.e)(e),o=1===n.length?n[0]:void 0,a=Object(g.e)(e,{enableEditItemCommand:c.L}).enableEditItemCommand,b=e.demandItemFacet(u.e,o),w=u.e.evaluate(b)(e,{itemKey:o}).getPropertiesForm,E=e.demandItemFacet(c.lt,o),S=e.demandItemFacet(d.e,o),x=S&&e.demandItemFacet(c.Re,v.e.serialize(S)),T=x&&x.templateType===m.t.mySiteDocumentLibrary,N=a&&!!w&&!!E&&!T&&s.t.hasItemPermission({permissions:E},s.t.editListItems),C=o&&w?Object(f.o)(function(e){return i.createElement(y,Object(r.__assign)({},e,{itemKey:o,interactiveSave:t.interactiveSave,getPropertiesForm:w}))}):void 0;return i.createElement(p.e,Object(r.__assign)({isAvailable:N,onExecute:C},Object(h.t)(e,{itemKey:o,engagement:{name:"EditItem",isIntentional:!0}})))})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(17).e)("itemPropertiesFormControl")},function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n("react-lib"),i=n(2),s=n(123),o=n(2873),u=n(29),a=new i.e("ApproveReject").id;function f(e){var t=e.listFacets,n=t&&t.templateType===u.n.webPageLibrary&&t.isModerated?s.w:s.t;return{key:a,automationId:"approveRejectCommand",iconProps:{iconName:"DocumentApproval"},name:n,action:r.createElement(o.e,null)}}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(17).e)("saveViewActionControl")},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(65),i=n(210);function s(e,t){var n=t.itemSetKey,s=e.demandItemFacet(r.e,n);return s&&s.viewKey&&i.e.serialize(s.viewKey)}},,,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return g});n.d(t,"e",function(){return y});var r=n(0),i=n("react-lib"),s=n(26),o=n(30),u=n(18),a=n(40),f=n(110),l=n(50),c=n(176),h=n(47),p=n(758),d=Object(l.e)()(Object(c.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(4,3771)];case 1:return[2,e.sent().LaunchMoveCopyPickerWizard]}})})})),v=Object(a.t)(function(e,t){var n=t.itemKeys,s=t.isMove,a=void 0!==s&&s;if(0===n.length)return null;var l=Object(f.e)(e);if(!l)return null;var c=e.demandItemFacet(p.e,n[0]),v=p.e.evaluate(c)(e,{entryItemKey:l,sourceItemKeys:n,isMove:a,isAvailable:!1,moveCopyPickerWizard:d}),m=v.isAvailable,g=v.moveCopyPickerWizard;if(!m||!g)return null;var y=Object(u.o)(function(e){return i.createElement(g,Object(r.__assign)({isMove:a,entryItemKey:l,sourceItemKeys:n},e))},{scope:"global"});return i.createElement(o.e,Object(r.__assign)({onExecute:y},Object(h.t)(e,{itemKey:n[0],engagement:{name:a?"MoveTo":"CopyTo"}})))}),m=Object(s.s)()(v),g=Object(a.e)(function(){return{isMove:!0}})(m),y=Object(a.e)(function(){return{isMove:!1}})(m)}],Array(171),[function(e,t,n){"use strict";n.d(t,"e",function(){return pt});n.d(t,"t",function(){return dt});n.d(t,"n",function(){return vt});var r=n(0),i=n(45),s=n(65),o=n(120),u=n(1240),a=n(210),f=n(1),l=n(3197),c=n(624),h=n(2336),p=n("react-lib"),d=n(194),v=n(1260),m=n(1173),g=n(6),y=n(125),b=n(176),w=n(29),E=n(123),S=n(22),x=n(629),T=n(75),N=n(555),C=n(2626),k=n(2876),L=n(26),A=n(27),O=n(150),M=n(87),_=n(276),D=n(34),P=n(542),H=new M.e;function B(e,t){var n=Object(A.e)(e,{enableQuickEdit:f.Q}).enableQuickEdit,r=Object(D.e)(e).itemsScopeItemKey,i=r&&Object(_.e)(e,{itemsScopeItemKey:r}),s=i&&i.id===P.e.id;return!!(n&&!!s&&!H.isIE)}var j=Object(L.n)()(Object(O.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(["18"],4226)];case 1:return[2,e.sent().SwitchGridLayoutActionExecutor]}})})},B,function(e,t){var n=t.itemKey,r=t.viewType,i=e.demandItem({deserizalizedKey:s.e},n).deserizalizedKey,o=i&&i.viewKey&&a.e.serialize(i.viewKey),u=o&&e.demandItemFacet(f.Tn,o);return B(e)&&u===r})),F=n(507),I=n(40),q=n(573),R=n(47),U=n(30),z=n(594);var W=Object(I.t)(function(e,t){var n,i,u,a,l,c,h=t.viewKey,d=t.itemSetKey,v=void 0,m=d&&e.demandItemFacet(s.e,d),g=e.demandItemFacet(f.m,h);if(m&&g){var b=o.e.serialize({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl}),w=e.demandItemFacet(f.Re,b),E=e.demandItemFacet(f.un,q.e.serialize({webAbsoluteUrl:m.webAbsoluteUrl,listFullUrl:m.listFullUrl}));E&&w&&w.id&&g&&"POWER"!==g.viewType&&w.permissions&&g.canUserEdit(w.permissions)&&(v=(n={webAbsoluteUrl:m.webAbsoluteUrl,layoutsUrl:E.layoutsUrl,viewId:g.id,listId:w.id,sourceUrl:g.serverRelativeUrl||""},i=n.webAbsoluteUrl,u=n.layoutsUrl,a=n.viewId,l=n.listId,c=n.sourceUrl,i+"/"+u+"/ViewEdit.aspx?"+Object(z.e)({View:y.e.normalizeUpper(a,!0),List:y.e.normalizeUpper(l,!0),Source:c})))}var S=!!v;return p.createElement(U.e,Object(r.__assign)({isAvailable:S,onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){window.open(v);return[2]})})}},Object(R.t)(e,{itemKey:d,engagement:{name:"CustomizeView",isIntentional:!0}})))}),X=n(2971),V=n(57),$=n(2999),J=n(18),K=n(722),Q=Object(b.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(3,4040)];case 1:return[2,e.sent().ViewCreator]}})})}),G=Object(I.t)(function(e,t){var n=t.currentViewKey,i=Object(V.e)(e),u=Object(D.e)(e).itemsScopeItemKey,a=!1,l=e.demandItemFacet(s.e,i),c=e.demandItemFacet(f.m,n),h=e.demandItemFacet($.e,i),d=$.e.evaluate(h)(e,{viewKey:n}).onViewSaved;if(l&&c){var v=o.e.serialize({webAbsoluteUrl:l.webAbsoluteUrl,listFullUrl:l.listFullUrl}),m=e.demandItemFacet(f.Re,v);a=!!(m&&c&&"POWER"!==c.viewType&&m.permissions&&(m.permissions.managePersonalViews||m.permissions.manageLists))}if(!c||!i||!u)return null;var g=Object(J.o)(function(e){return p.createElement(K.e,{itemsScopeItemKey:u},p.createElement(Q,Object(r.__assign)({},e,t,{itemSetKey:i,viewTitle:c.title,isPublicView:!c.isPersonal,onViewSaved:d})))},{scope:"global"});return p.createElement(U.e,Object(r.__assign)({isAvailable:a,onExecute:g},Object(R.t)(e,{itemKey:i,engagement:{name:"SaveView",isIntentional:!0}})))}),Y=n(2877),Z=n(2970),ee=n(78),te=n(359),ne=n(1060),re=n(147),ie=n(8),se=n(2972),oe=[{ODB:1776},{ODB:1772},{ODB:60020}],ue={ODB:1484},ae={iconName:void 0,styles:{root:{display:"none!important"}}},fe=Object(b.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(3,4225)];case 1:return[2,e.sent().CreateViewAction]}})})}),le={key:Z.f,automationId:"switchToFixedGridLayoutCommand",name:E.B,action:p.createElement(j,{viewType:"GRIDFIXED"}),iconProps:{iconName:"ViewList"}},ce={key:Z.a,automationId:"switchToDynamicGridLayoutCommand",name:E.H,action:p.createElement(j,{viewType:"GRID"}),iconProps:{iconName:"DynamicList"}};function he(e,t){var n,i,s=t.viewKeys,l=t.webAbsoluteUrl,c=t.listViewSetKey,h=t.itemSetKey,b=t.currentViewKey,L=o.e.serialize({webAbsoluteUrl:c.webAbsoluteUrl,listFullUrl:c.listFullUrl}),A=Object(T.e)(e,{feature:ue})&&oe.some(function(t){return Object(T.e)(e,{feature:t})}),O=e.demandItemFacet(f.Re,L),M=!!O&&!!O.templateType&&Object(w.s)(O.templateType),_=!!O&&!!O.templateType&&O.templateType===w.n.webPageLibrary,D=!1,P=E.M,H=e.demandItem({showViewModifiedIndicator:f.Ot,currentDerivedView:f.m,currentViewBasicInfo:f.Sn},b),B=H.showViewModifiedIndicator,j=H.currentDerivedView,I=H.currentViewBasicInfo;O&&j&&"POWER"!==j.viewType&&O.permissions&&j.canUserEdit(O.permissions)&&(D=!0);j&&j.title?P=j.title:I&&I.Title&&(P=I.Title);D&&(B||j&&j.isDirty())&&(P=S.format(E.A,P));var q=s.map(function(t){var n=e.demandItemFacet(f.kt,t),r=e.demandItemFacet(f.Sn,t);return n&&!n.Hidden?pe(n,l,h,j):r?pe(r,l,h,j):void 0}).filter(function(e){return!!e}),R=(function(e,t){var n=e.demandItemFacet(f.et,t);return!(!n||!e.demandItemFacet(g.L,n))})(e,h),U=(function(e,t){var n,i,s=t.isPagesLib,o=t.isList,u=t.itemsNeedAttention,a=t.currentDerivedView,f=t.itemSetKey,l=m.e;if(s&&Object(T.e)(e,{feature:{ODB:1743}})){n=E.g;i="PagesThatNeedAttention"}else{n=o?E.m:E.p;i=o?"ItemsThatNeedAttention":"FilesThatNeedAttention"}return{key:Z.i,automationId:"needsAttentionViewCommand",name:n,iconProps:u?{iconName:"error",styles:{root:"needsAttentionIcon_9b374462"}}:ae,action:p.createElement(X.e,{viewId:l,currentDerivedView:a,itemSetKey:f}),facets:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},ee.i.pack(!0)),se.r.pack(!0)),se.n.pack(!0)),engagement:{name:i}}})(e,{isList:M,isPagesLib:_,itemsNeedAttention:R,itemSetKey:h,currentDerivedView:j}),z=(function(e,t,n){var r=o.e.serialize({webAbsoluteUrl:t,listFullUrl:n}),i=e.demandItemFacet(f.v,r),s=[];i&&i.length&&i.forEach(function(t){var n=e.demandItemFacet(f.sn,t),r=n&&n.requiredFields&&n.requiredFields.split(",");r&&r.length>0&&(s=s.concat(r))});return s.length>0})(e,l,c.listFullUrl),V=M&&Object(T.e)(e,{feature:ne.t})&&!!e.demandItemFacet(f.qt,re.e),$=v.n.serialize({webAbsoluteUrl:l,listFullUrl:c.listFullUrl}),J=null===(i=null===(n=e.demandItemFacet(ie.e,$))||void 0===n?void 0:n.itemKeys)||void 0===i?void 0:i.length,K=V&&!!J,Q=E.I,he=K?{key:Z.c,automationId:"itemsWithSyncIssuesViewCommand",name:Q,iconProps:K?{iconName:"error",styles:{root:"needsAttentionIcon_9b374462"}}:ae,engagement:{name:"nucleus.OpenSyncIssuesViewCommand",isIntentional:!0,extraData:{issueCount:J}},action:$?p.createElement(te.e,{itemKey:$}):void 0,facets:Object(r.__assign)(Object(r.__assign)({},se.n.pack(!0)),se.r.pack(!0))}:void 0,de=j?(function(e){var t=e.isCreateNewViewEnabled,n=e.currentDerivedView,i=e.listViewSetKey,s=e.itemSetKey,o=e.allowEditCurrentView,f=a.e.serialize({viewId:n.id}),l=u.e.serialize(i),c=o||t&&"MODERNCALENDAR"===n.viewType;return Object(r.__spreadArrays)(t?[{key:Z.t,automationId:"createViewCommand",name:E.r,iconProps:ae,action:p.createElement(fe,{listViewSetKey:l,currentViewKey:f,isEditing:!1}),facets:Object(r.__assign)(Object(r.__assign)({},se.n.pack(!0)),se.e.pack(!0))}]:[],[{key:Z.s,automationId:"saveCommand",name:E.E,iconProps:ae,action:p.createElement(G,{listViewSetKey:l,currentViewKey:f}),facets:Object(r.__assign)(Object(r.__assign)({},se.n.pack(!0)),se.t.pack(!0))},{key:Z.o,automationId:"setDefaultViewCommand",name:E.x,iconProps:ae,action:p.createElement(Y.e,{currentDerivedView:n,listViewSetKey:i}),facets:Object(r.__assign)(Object(r.__assign)({},se.n.pack(!0)),se.t.pack(!0))}],c?[{key:Z.n,automationId:"customizeViewCommand",name:E.i,iconProps:ae,action:"MODERNCALENDAR"===n.viewType||"KANBAN"===n.viewType?p.createElement(fe,{listViewSetKey:l,currentViewKey:f,isEditing:!0}):p.createElement(W,{viewKey:f,itemSetKey:s}),facets:Object(r.__assign)(Object(r.__assign)({},se.n.pack(!0)),se.t.pack(!0))}]:[])})({listViewSetKey:c,isCreateNewViewEnabled:A,currentDerivedView:j,itemSetKey:h,allowEditCurrentView:D}):[],ve=e.demandItemFacet(f.Tn,b),me="MODERNCALENDAR"===ve?[{key:Z.e,isPermanent:!1,automationId:"calendarMonthCommand",name:E.D,title:E._,action:p.createElement(N.e,{layoutType:C.e}),iconProps:{iconName:"calendar"}}]:[],ge="KANBAN"===ve?[{key:Z.r,isPermanent:!1,automationId:"kanbanCommand",name:E.F,title:E.j,action:p.createElement(N.e,{layoutType:k.e}),iconProps:{iconName:"Taskboard"}}]:[],ye=[];if(x.e.subMenuProps){var be=e.demandItemFacet(f.xn,b),we=be&&be.viewFormatter,Ee=we&&we.isTileDesignerTemplateApplied(),Se=we&&we.getTileProps(),xe=!!(Se&&Se.formatter&&Se.formatter);if(!M||!Ee&&xe)ye=x.e.subMenuProps.items;else for(var Te=0,Ne=x.e.subMenuProps.items;Te<Ne.length;Te++){var Ce=Ne[Te];Ce.key!==F.r?ye.push(Ce):ye.push(Object(r.__assign)(Object(r.__assign)({},Ce),{name:E.d,title:E.v,automationId:"galleryLayoutCommand"}))}}var ke=[];z&&ke.push(U);K&&he&&ke.push(he);ke.length>0&&ke.push({name:"-",key:"divider_1",itemType:d.e.Divider});var Le=Object(r.__spreadArrays)(ye,me,ge,[{name:"-",key:"divider_1",itemType:d.e.Divider}],ke,[le,ce,{name:"-",key:"divider_1",itemType:d.e.Divider}],q,[{name:"-",key:"divider_1",itemType:d.e.Divider}],de,[{name:"-",key:"divider_1",itemType:d.e.Divider}]),Ae={name:P,key:x.e.key,automationId:x.e.automationId,iconProps:x.e.iconProps,title:E.C,ariaLabel:S.format(E.N,P),postProcess:function(e){var t=e.subMenuProps&&e.subMenuProps.items,n=t&&t.filter(function(e){return e.checked})[0];return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e),t&&1===t.length?{subMenuProps:void 0,disabled:!0}:{}),n?{iconProps:Object(r.__assign)(Object(r.__assign)({},n.iconProps),R||K?{styles:{root:"needsAttentionIconOverlay_9b374462"}}:{})}:{})},subMenuProps:{items:Le},facets:Object(r.__assign)({},ee.i.pack(!0))},Oe=j?y.e.normalizeLower(j.id,!1):"";Ae.cacheKey=x.e.key+"_viewId_"+Oe;return Ae}function pe(e,t,n,i){var s=y.e.normalizeLower(e.Id,!1);return{key:Z.l+"-"+s,automationId:"switchViewCommand_"+s,name:e.Title,iconProps:ae,action:p.createElement(X.e,{viewId:s,currentDerivedView:i,itemSetKey:n}),facets:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},ee.i.pack(!0)),se.n.pack(!0)),se.r.pack(!0))}}var de=n(3349),ve=n(2),me=n(3350),ge=n(201),ye=n(2556),be=n(2369),we=new ve.e("Publish").id,Ee=new ve.e("Schedule").id,Se=new Map([[be.e.Publish,E.y],[be.e.CancelApproval,E.n],[be.e.SubmitForApproval,E.T],[be.e.SchedulePublish,E.S],[be.e.Republish,E.b]]),xe=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.defaultRender,n=e.itemKeys,i=Object(r.__rest)(e,["defaultRender","itemKeys"]),s=n[0];return p.createElement(ge.e,null,function(e){var n=e.itemCache,o=Object(ye.n)(n,s),u=Se.get(o)||E.y;return t?p.createElement(t,Object(r.__assign)({},i,{text:u})):null})};return t})(p.PureComponent),Te={key:we,automationId:"PublishCommand",iconProps:{iconName:"ReadingMode"},name:E.y,action:p.createElement(me.t,{publishType:0,source:"Command"}),commandBarButtonAs:Object(L.s)()(xe)},Ne={key:Ee,automationId:"ScheduleCommand",iconProps:{iconName:"DateTime2"},name:E.S,action:p.createElement(me.t,{publishType:1,source:"Command"}),commandBarButtonAs:Object(L.s)()(xe)},Ce=n(2995),ke=n(1211),Le=n(1127),Ae=n(3257),Oe={key:new ve.e("exitQuickEdit").id,automationId:"exitQuickEditCommand",name:E.u,action:p.createElement(Ae.e,null),iconProps:{iconName:"ViewList"}};var Me=n(9),_e=n(281),De=n(3343),Pe=n(620),He=n(744),Be=n(338),je=n(1772),Fe=n(1871),Ie=n(1699),qe=n(1739),Re=n(1944),Ue=n(127),ze=[{keys:"Ctrl + a",desc:Be.f},{keys:"Ctrl + d",desc:Be.r},{keys:"esc",desc:Be.s},{keys:"space",desc:Be.p},{keys:"enter",desc:Be.i}],We=[{keys:"F2",desc:Be.a},{keys:"Delete",desc:Be.n},{keys:"s",desc:Be.h},{keys:"alt + up",desc:Be.t},{keys:"?",desc:Be.c},{keys:"g",desc:Be.l},{keys:"i",desc:Be.d}];function Xe(e){var t=e.resolve,n=Object(Ue.e)(function(){t()}),r=[ze,We],i=-1,s=-1;return p.createElement(Re.e,null,p.createElement(Fe.e,{onDismiss:n,hidden:!1,dialogContentProps:{type:Ie.e.close,title:Be.e},styles:$e},r.map(function(e){return p.createElement("div",{className:"keyboardMapGroup_3cade36d",key:"keyMap"+ ++i},p.createElement("ul",{className:"keyboardMapTable_3cade36d",key:""+i},e.map(function(e){return p.createElement("li",{className:"keyboardMapRow_3cade36d",key:""+ ++s},p.createElement("span",{className:"keyboardMapKey_3cade36d",key:i+"."+s+".0.0"},e.keys),p.createElement("span",{className:"keyboardMapVal_3cade36d",key:i+"."+s+".1.1"},e.desc))})))}),p.createElement(qe.e,null,p.createElement(je.e,{onClick:n},Be.u))))}var Ve=Object(I.t)(function(e){var t=Object(J.o)(Xe);return p.createElement(U.e,{onExecute:t})});function $e(){return{main:{maxWidth:"700px !important"}}}var Je={key:new ve.e("ShowKeymapShortcut").id,automationId:"ShowKeymapShortcut",shortcutProps:{keySequences:["Shift/"],content:Be.c},action:p.createElement(Ve,null)},Ke=Object(I.t)(function(e,t){var n=t.itemKey,r=e.demandItemFacet(g.M,n),i=r&&r.itemKey;return p.createElement(te.e,{itemKey:i})}),Qe=Object(L.i)()(Ke),Ge={key:new ve.e("NavigateUpShortcut").id,automationId:"NavigateUpShortcut",shortcutProps:{keySequences:["AltUp"],content:Be.t},action:p.createElement(Qe,null),facets:Object(r.__assign)({},ee.i.pack(!0))},Ye=n(2478),Ze=n(1143),et=n(3339),tt=n(3256),nt=n(3360),rt=n(94),it=n(2998),st=n(70),ot=n(769),ut=n(59),at=n(3344),ft=n(760),lt={ODB:1544},ct=[Ce.t,Ce.e,Ce.r],ht=[Je,Ge],pt="658D384B-C862-48CC-986B-F1CD32B00BFE",dt=Object(Me.t)()(gt),vt=(Object(Me.t)()(gt),function(e,t){var n=Object(r.__rest)(h.e,[]);if(e&&e.open&&e.open.length>0){n.subMenuProps=n.subMenuProps||{};n.subMenuProps.items=Object(Ye.t)(n.subMenuProps&&n.subMenuProps.items||[],e.open,t);e.open.some(function(e){return e.isPromoted||!1})&&(n.engagement={name:"OpenCommand",isIntentional:!0,extraData:{hasPromotedFileHandler:!0}})}return n});function mt(e,t){var n,p,d=t.itemKey,v=t.itemSetKey,m=t.commands,g=t.overflowCommands,b=t.farCommands,E=t.shortcutCommands,S=e.demandItemFacet(i.e,d),N=e.demandItemFacet(s.e,v),C=g?Object(r.__spreadArrays)(g):[],k=!0,L=!1,O=void 0,M=void 0,H=void 0,B=m?Object(r.__spreadArrays)(m):[],j=b,F=[],I="",q=S&&o.e.serialize(S),R=e.demandItemFacet(o.e,q);N&&N.viewKey&&(I=N.viewKey.viewId);var U,z,W,X=[],V=!1,$=Object(A.e)(e,{enableDocLibsPersistentNewCommand:f.k}).enableDocLibsPersistentNewCommand;if(S&&R){V=Object(Ze.t)(e,d,S);var J=e.demandItemFacet(f.Re,q);k=!!J&&!!J.isDocumentLibrary;U=Object(rt.e)(e,d);k?F=E?Object(r.__spreadArrays)(E,ht):Object(r.__spreadArrays)(ht):B=Object(l.e)(U);if(!(L=!!J&&J.templateType===w.t.mySiteDocumentLibrary)){k&&C.push.apply(C,ct);C&&C.push(Object(it.e)({listFacets:J}));var K={webAbsoluteUrl:R.webAbsoluteUrl,listFullUrl:R.listFullUrl},Q=u.e.serialize(K),G=e.demandItemFacet(ie.e,Q);if(G&&G.itemKeys&&b){!I&&U&&U.viewId&&(I=y.e.normalizeLower(U.viewId,!1));p=e.demandItemFacet(f.rt,q);j=(z=b,W=he(e,{viewKeys:G.itemKeys,webAbsoluteUrl:S.webAbsoluteUrl,listViewSetKey:K,itemSetKey:v,currentViewKey:a.e.serialize({viewId:I})}),z.map(function(e){return e.key===x.e.key?W:e}))}}J&&R&&(X=(n=Object(nt.e)(e,{key:S,listFacets:J,listKey:R,pageContext:U,enableDocLibsPersistentNewCommand:$})).contentTypes,O=n.contentTypeCommands);var Y=e.demandItemFacet(f.pe,d);M=Object(De.t)(e,S,Y);U&&J&&(H=Object(tt.e)(e,{isODB:L,key:S,listFacets:J,pageContext:U}).fileHandlerCommands)}var Z=Object(A.e)(e,{enableQuickEdit:f.Q,enableUniversalPrint:ut.c}),ee=Z.enableQuickEdit,te=Z.enableUniversalPrint,ne=!!U&&!!ee;if(ne){var re=Object(D.e)(e).itemsScopeItemKey;if(Object(_.e)(e,{itemsScopeItemKey:re})===P.e)return{commands:[Oe],overflowCommands:[],farCommands:[],shortcutCommands:[]}}var se=(function(e,t){for(var n=t.quickEditEnabled,r=t.defaultCommands,i=t.isDocumentLibrary,s=t.isODB,o=t.contentTypeCommands,u=t.customActionCommands,a=t.fileHandlerCommands,f=t.newDocumentTemplates,l=t.contentTypes,p=t.isCreateFolderAvailable,d=t.listKey,v=t.pageContext,m=t.printEnabled,g=t.enableDocLibsPersistentNewCommand,y=[],b=!st.t.isActivated(pt,"7/5/2019","Show file handler commands before OOB commands"),w={},E=0,S=r;E<S.length;E++){var x=S[E];w[x.key]=x}for(var N=0,C=r;N<C.length;N++){if((x=C[N]).key===_e.e.key){var k=Object(et.e)(e,{contentTypes:l,newCommandMenu:x,fileHandlerCommands:a,isCreateFolderAvailable:p,newDocumentTemplates:f,contentTypeCommands:o,listKey:d,enableDocLibsPersistentNewCommand:g}).visibleNewCommands;y.push(k)}else if(x.key===ot.e.key&&n&&!w[Le.t.key])y.push(x,Le.t);else if(x.key===h.e.key){var L=vt(a,b);y.push(L)}else if(x.key===Pe.t.key&&i&&!w[ke.e.key])y.push(x,ke.e);else if(x.key===He.e.key&&i){y.push(x);s||w[c.e.key]||y.push(c.e);y.push(de.t,de.e)}else if(x.key===Pe.n.key){!i&&Object(T.e)(e,{feature:lt,pageContext:v})?y.push(Pe.e):y.push(x);y.push(Te,Ne)}else x.key===ft.e.key&&s&&m?y.push(ft.e,at.e):y.push(x)}u&&u.length>0&&y.push.apply(y,u);a&&a.custom&&a.custom.length>0&&(y=Object(Ye.t)(y,a.custom));return{overrideDefaultCommands:y}})(e,{defaultCommands:B,isDocumentLibrary:k,isODB:L,contentTypeCommands:O,customActionCommands:M,fileHandlerCommands:H,newDocumentTemplates:p,contentTypes:X,isCreateFolderAvailable:V,quickEditEnabled:ne,listKey:S,pageContext:U,printEnabled:!!te,enableDocLibsPersistentNewCommand:$});return{commands:B=se.overrideDefaultCommands,overflowCommands:C,farCommands:j,shortcutCommands:F}}function gt(){return function(e){return function(e,t){return mt(e,t)}}}}],Array(13),[function(e,t,n){"use strict";n.d(t,"t",function(){return O});n.d(t,"e",function(){return _});var r=n("react-lib"),i=n(123),s=n(744),o=n(620),u=n(58),a=n(0),f=n(26),l=n(40),c=n(30),h=n(45),p=n(573),d=n(120),v=n(1),m=n(29),g=n(1137),y=n(331),b=n(62),w=n(47),E=n(27),S=function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2]})})},x=Object(f.s)()(Object(f.r)()(Object(l.e)(function(e,t){var n=t.itemKey,r=t.isEditForm,i=!1,s=S;if(Object(E.e)(e,{enableEditOrViewItemCommandConfiguration:v.A}).enableEditOrViewItemCommandConfiguration){var o=e.demandItem({key:h.e,itemId:v.We,contentTypeId:v.d,permissions:v.lt},n),u=o.key,f=o.itemId,l=o.contentTypeId,c=o.permissions;if(u&&f&&(!r||c&&b.t.hasItemPermission({permissions:c},b.t.editListItems))){var x=u&&e.demandItemFacet(v.un,p.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl}));if(x&&!x.isAnonymousGuestUser){var T=e.demandItem({list:v.Re,listFormUrls:v.Ue},d.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl})),N=T.list,C=T.listFormUrls,k=C?r?C.editFormUrl:C.displayFormUrl:void 0;if(N&&C&&N.templateType&&N.templateType!==m.n.mySiteDocumentLibrary&&k){var L=Object(g.e)(k,u.rootFolder||new y.e(u.listFullUrl).path,f,l);i=!0;s=function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){(e=window.open(L,"_blank"))&&e.focus();return[2]})})}}}}}return Object(a.__assign)({isAvailable:i,onExecute:s},Object(w.t)(e,{itemKey:n,engagement:{name:r?"OpenItemEditForm":"OpenItemDisplayForm",isIntentional:!0}}))})(c.e))),T=n(2996),N=n(624),C=n(1121),k=n(1127),L=n(2),A=Object(L.t)("EditItem"),O={key:Object(L.t)("ViewItem"),name:u.m,action:r.createElement(x,null)},M={key:A,name:i.s,action:r.createElement(T.e,null),iconProps:{iconName:"Edit"}};function _(e){return[C.e,k.t,M,o.n,o.t,s.e,N.e]}},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return h});n.d(t,"e",function(){return p});var r=n(0),i=n("react-lib"),s=n(97),o=n(1552),u=n(741),a=n(312),f=n(3641);var l=n(40),c=n(134),h=[],p=Object(l.t)(function(e,t){var n=t.items,l=void 0===n?h:n,p=t.directionalHint,d=void 0===p?s.e.rightTopEdge:p,v=t.isBeakVisible,m=void 0!==v&&v,g=t.isOpen,y=t.contextMenuAs,b=Object(r.__rest)(t,["items","directionalHint","isBeakVisible","isOpen","contextMenuAs"]),w=y?Object(c.e)(y,o.e):o.e;return i.createElement(u.e,{commands:t.commands},function(e){var n=e.menuItems,s=Object(a.e)(l,(function e(t,n){var i=n.target,s=n.preserveIcons,o=void 0!==s&&s;return t.map(function(t){var s=t.subMenuProps,u=t.onClick,a=t.hasLaunchTarget,l=Object(r.__rest)(t,["subMenuProps","onClick","hasLaunchTarget"]);return Object(r.__assign)(Object(r.__assign)({},l),{name:t.iconProps&&"More"===t.iconProps.iconName?f.e:t.name,icon:void 0,iconProps:o?t.iconProps:void 0,subMenuProps:s?Object(r.__assign)(Object(r.__assign)({},s),{items:e(s.items,n)}):void 0,onClick:a&&u?function(e){e&&i&&(i instanceof Event?e.target=i.target:i instanceof Element&&(e.target=i));u(e)}:u})})})(n,t));return g?i.createElement(w,Object(r.__assign)({},b,{items:s,directionalHint:d,isBeakVisible:m})):null})})},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return v});var r=n("react-lib"),i=n(0),s=n(2301),o=n(115),u=n(30),a=n(163),f=n(26),l=n(40),c=Object(l.t)(function(e,t){var n=t.itemKeys.filter(function(t){return"failed"===Object(a.r)(e,{itemKey:t}).phase}),f=e.dispatch;return r.createElement(u.e,{onExecute:function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){f(Object(s.e)({items:Object(o.e)(n,function(){return{}})}));return[2]})})},isAvailable:n.length>0})}),h=Object(f.s)()(c),p=n(2),d=n(255),v={key:new p.e("retryProgressCommand").id,name:d.b,action:r.createElement(h,null)}}],Array(24),[function(e,t,n){"use strict";n.d(t,"e",function(){return E});var r=n(0),i=n(45),s=n(120),o=n(3560),u=n(83),a=n(1),f=n(207),l=n(122),c=n(2156),h=n(155),p=n(2),d=n(74),v=n(386),m=n(137),g=n(6),y=n(29),b=n(2862),w=n(53);function E(e){var t=this,n=e.itemKey,E=e.options.sourceEntries,S=i.e.deserialize(n),x=S.webAbsoluteUrl,T=S.listFullUrl,N=Object.keys(E)[0],C=E[N],k=C.progressItemKey,L=C.conflictResolution;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,E,C,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q;return Object(r.__generator)(this,function(G){switch(G.label){case 0:t=e(Object(u.n)({webAbsoluteUrl:x,listFullUrl:T})),E=t.dataRequestor,C=t.hasDigest;if(!t.hasTokenProvider)return[3,1];O=void 0;return[3,3];case 1:return[4,e(Object(u.e)({url:x||T,disallowCookies:!C}))];case 2:O=G.sent();G.label=3;case 3:A=O;M=e(Object(l.e)({sourceFile:c.t},N)).sourceFile;_=e(Object(l.e)({folderPath:a.pe},n)).folderPath,D=void 0===_?S.rootFolder:_;if(!M)throw new w.e({code:"MissingSourceFileForUpload",message:"No source file for upload."});if(!D)throw new w.e({code:"MissingTargetFolderPathForUpload",message:"No path information for target folder."});P=Object(v.r)({webAbsoluteUrl:x,listOrItemFullUrl:T});H=new f.e(void 0);B=H.debounce(function(t){var n;k&&e(Object(h.e)({items:(n={},n[k]=Object(p.n)({progressSize:d.y},{progressSize:{current:t}}),n)}))},300,{leading:!1});j=e(Object(m.e)(function(e){return e.demandItemFacet(a.Re,s.e.serialize({webAbsoluteUrl:x,listFullUrl:T}))}));F=j&&j.contentTypesEnabled&&j.templateType!==y.t.mySiteDocumentLibrary;(I=new o.e({authToken:A,dataRequestor:E,parentItemKey:"",targetItemKey:"",fileUpload:M,iconName:"",serverRelativeItemUrl:D,webApiUrl:P,onProgress:B,expandAllItemFields:F})).nameConflictBehavior="replace"===L?1:0;k&&e(Object(h.e)({items:(K={},K[k]=Object(r.__assign)({},d.y.pack({total:M.size,current:0})),K)}));q=I.start();R=e(Object(m.e)(function(e){return e.demandItemFacet(d.i,k)}));U=R?R.token.subscribe(function(){I.abort()}):void 0;G.label=4;case 4:G.trys.push([4,6,7,8]);return[4,q];case 5:G.sent();return[3,8];case 6:z=G.sent();I.abort();throw Object(b.e)(z);case 7:U&&U();I.dispose();return[7];case 8:W=I.item;X=W.properties;V=X&&X.ID||W.id;$=X&&X.uniqueId;J=i.e.serialize({webAbsoluteUrl:x,listFullUrl:T,itemId:V});e(Object(h.e)({items:(Q={},Q[J]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},g.h.pack(W.displayName)),W.id?a.pe.pack(W.id):{}),$?a.bn.pack($):{}),g.M.pack({itemKey:n})),Q)}));return[2,{itemKey:J}]}})})}}},,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("mountPoint")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("hasThumbnailAuthTokenFacet")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("specialFolder")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("thumbnailAccessToken")},function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r=n(2831),i=n(130),s=n(2555),o=n(386);function u(e){var t=e.responseText,n=e.documentType,i=e.fileName,s="",o="";if(null!=t){var u=JSON.parse(t);if(null!==u&&null!==u.d&&null!==u.d.CreateDocumentAndGetEditLink){o=u.d.CreateDocumentAndGetEditLink;s=Object(r.t)(o,n,i||"",!1)}else try{o=(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("d:CreateDocumentAndGetEditLink")[0].textContent||"";s=Object(r.t)(o,n,i||"",!1)}catch(e){}}return{originalEditLink:o,redirectUrl:s}}function a(e){var t=i.e.Visio,n=e.webAbsoluteUrl,r=e.listFullUrl,u=e.parentFolderPath,a=e.templateUrl,f=e.docName,l=e.docType;if(null!==l&&l>=i.e.Word&&l<=t&&l!==i.e.Text){if(l!==i.e.OneNote||f){if(f){f+=Object(s.t)(l)}}else f="Notebook"+Math.floor(100*Math.random())+1;f||(f="");l===i.e.ExcelForm&&(l=i.e.ExcelSurvey);return Object(o.e)({webAbsoluteUrl:n,listFullUrl:r}).methodWithAliases("CreateDocumentAndGetEditLink",{fileName:f,folderPath:u,documentTemplateType:l,templateUrl:a||""}).toString()}throw new Error("document type is not valid, here are the valid type: 1 - Word, 2 - Excel,\n    3 - PowerPoint, 4 - OneNote, 5 - Excel Survey, 7 - ExcelForm, 8 - Visio")}},function(e,t,n){"use strict";n.d(t,"t",function(){return o});n.d(t,"e",function(){return u});var r=n(2),i=n(421),s=n(679),o=new r.e("updateCheckoutState"),u=new i.e("checkout");Object(s.e)({operationTypeFacet:o,progressKeyFacet:u})},,function(e,t,n){"use strict";n.d(t,"e",function(){return u});n.d(t,"t",function(){return a});n.d(t,"n",function(){return f});var r=n(2),i=n(352),s=n(421),o=n(5),u=new r.e("editPinnedItem"),a=new o.e("editPinnedItemProgressItem",{itemKey:Object(o.s)(),editType:Object(o.i)()}),f=new s.e("editPinnedItemProgress",function(e,t){var n=Object.keys(t.itemEditTypeMap)[0],r=t.itemEditTypeMap[n].editType;return a.serialize({itemKey:n,editType:r})});Object(i.e)({operationTypeFacet:u})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(352),s=new r.e("createFreshView"),o=Object(i.e)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(17).e)("getDriveItemFullUrlControl")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){for(var t=e,n="",r=0,i=void 0,s=0,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.charAt(0|s)||(o="=",s%1);n+=o.charAt(63&r>>8-s%1*8)){if((i=t.charCodeAt(s+=3/4))>255)throw new Error("Unable to obtain default share URL: btoa failed");r=r<<8|i}return n}},function(e,t,n){"use strict";n.d(t,"n",function(){return o});n.d(t,"e",function(){return u});n.d(t,"t",function(){return a});var r=n(2),i=n(421),s=n(679),o=new r.e("removeItemsFromSharedList"),u=new i.e("removeItemsFromSharedList"),a=Object(s.e)({operationTypeFacet:o,progressKeyFacet:u})},,function(e,t,n){"use strict";n.d(t,"e",function(){return E});var r=n(0),i=n("react-lib"),s=n(1),o=n(62),u=n(6),a=n(132),f=n(40),l=n(45),c=n(573),h=n(120),p=n(29),d=n(176),v=n(18),m=n(169),g=n(47),y=n(57),b=n(30),w=Object(d.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(["12","deferred.resx-deferred"],3813)];case 1:return[2,e.sent().CheckOutItemWizard]}})})}),E=Object(f.t)(function(e,t){var n=t.checkInOutType,f=Object(y.e)(e),d=Object(m.e)(e);if(!d.length)return null;var E=e.demandItem({firstItemKey:l.e},d[0]).firstItemKey;if(!E)return null;var S=E&&e.demandItemFacet(s.un,c.e.serialize({webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl}));if(S&&(S.isAnonymousGuestUser||S.isEmailAuthenticationGuestUser))return null;for(var x=e.demandItemFacet(s.Re,h.e.serialize({webAbsoluteUrl:E.webAbsoluteUrl,listFullUrl:E.listFullUrl})),T=!!x&&x.templateType===p.t.mySiteDocumentLibrary,N=!!x&&!!x.enableMinorVersions,C=!1,k=0,L=d;k<L.length;k++){var A=L[k],O=e.demandItemFacet(u.m,A),M=e.demandItemFacet(a.i,A);if(A&&!O&&!M){var _=e.demandItem({isCheckedOut:u.w,isBFile:s.Ne},A),D=_.isCheckedOut,P=_.isBFile,H=e.demandItemFacet(s.lt,A),B=o.e.hasItemPermission({permissions:H},o.e.editListItems),j=o.e.hasItemPermission({permissions:H},o.e.cancelCheckout);"checkOut"===n?C=!P&&!T&&!(D&&(D.byYou||D.byOther))&&B:"checkIn"!==n&&"undoCheckOut"!==n||!D||(C=B&&(!!D.byYou||j&&!!D.byOther))}if(!C)break}var F=d?Object(v.o)(function(e){return i.createElement(w,Object(r.__assign)({},e,{itemSetKey:f,itemKeys:d,checkInOutType:n,enableMinorVersions:N}))}):void 0;return i.createElement(b.e,Object(r.__assign)({isAvailable:C,onExecute:F},Object(g.t)(e,{itemKey:d[0],engagement:{name:n,isIntentional:!0,extraData:{isBulk:d.length>1}}})))})},function(e,t,n){"use strict";n.d(t,"e",function(){return g});n.d(t,"t",function(){return y});var r=n(0),i=n("react-lib"),s=n(45),o=n(573),u=n(1),a=n(62),f=n(26),l=n(40),c=n(30),h=n(47),p=n(176),d=n(18),v=Object(l.e)()(Object(p.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(["13"],3707)];case 1:return[2,e.sent().ContentTypeNavigationCreator]}})})})),m=Object(l.t)(function(e,t){var n,f=t.itemKey,l=e.demandItemFacet(s.e,f),p=!1;if(l&&(n=e.demandItemFacet(u.un,o.e.serialize({webAbsoluteUrl:l.webAbsoluteUrl,listFullUrl:l.listFullUrl})))&&!n.isAnonymousGuestUser){var m=e.demandItemFacet(u.lt,f);p=a.e.hasItemPermission({permissions:m},a.e.insertListItems)}var g=Object(d.o)(function(e){return i.createElement(v,Object(r.__assign)({},e,t,{pageContext:n}))});return i.createElement(c.e,Object(r.__assign)({isAvailable:p,onExecute:g},Object(h.t)(e,{itemKey:f,engagement:{name:"ContentTypeNavigation",isIntentional:!0}})))}),g=Object(f.i)()(m),y=Object(f.e)()(m)},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(29),i=n(154),s=n(226),o=n(2478);function u(e,t){var n,u=t.pageContext,a=t.listFacets,f=t.isODB,l=t.key;if(u&&(a&&a.templateType===r.t.documentLibrary||f)){var c=new i.e(l.webAbsoluteUrl||l.listFullUrl).authority+"/_api/v2.0",h=s.t.serialize({endpoint:c});n=Object(o.e)(e,{itemKey:h})}return{fileHandlerCommands:n}}},function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(0),i=n(26),s=n(1),o=n(27),u=n(150),a=n(276),f=n(542);var l=Object(i.n)()(Object(u.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(40,3820)];case 1:return[2,e.sent().ExitQuickEditActionExecutor]}})})},function(e,t){var n=Object(o.e)(e,{enableQuickEdit:s.Q}).enableQuickEdit,r=!!n;if(n){r=Object(a.e)(e)===f.e}return r}))}],Array(81),[function(e,t,n){"use strict";n.d(t,"e",function(){return ne});var r,i=n(0),s=n(550),o=n(1114),u=n(456),a=n(130),f=n(235),l="NewFolder",c="NewDOC",h="NewXSL",p="NewPPT",d="NewONE",v="NewXSLSurvey",m="NewXSLForm",g="NewVSDX",y=((r={})[s.e.key]=l,r[f.o.key]=c,r[f.e.key]=h,r[f.i.key]=p,r[f.r.key]=d,r[f.t.key]=v,r[f.n.key]=m,r[f.s.key]=g,r);var b=n(281),w=n("react-lib"),E=n(84),S=n(2),x=n(123),T=n(775),N=n(186),C=n(563),k=n(110),L=n(61),A=n(45),O=n(120),M=n(1009),_=n(488),D=n(1),P=n(29),H=n(62),B=n(331),j=n(40),F=n(70).t.isActivated("EADE19B8-AD86-4CA2-9B13-E049A2AD37AA","07/28/2020","Use currentItemKey to check permissions"),I=Object(N.t)(function(){return{type:"file"}})(T.e),q=Object(j.e)(function(){return{fileSelector:I}})(C.e),R=Object(M.n)({uploadItemsAction:_.e},{uploadItemsAction:function(e,t){var n=Object(k.e)(e),r=e.demandItemFacet(A.e,n);if(!r)return{isAvailable:!1};var s=r.listFullUrl;if(!s)return{isAvailable:!1};var o=new B.e(s+"/Forms").path,u=A.e.serialize(Object(i.__assign)(Object(i.__assign)({},r),{rootFolder:""})),a=A.e.serialize(Object(i.__assign)(Object(i.__assign)({},r),{rootFolder:o})),f=F?u:n,l=e.demandItemFacet(D.lt,f),c=H.t.hasItemPermission({permissions:l},H.t.manageLists);return{targetItemKey:a,isAvailable:c&&z(e,r)}}}),U=Object(j.t)(function(e,t){var n=t.engagement,r=Object(k.e)(e);return r?w.createElement(R,null,w.createElement(q,{itemKey:r,engagement:Object(L.n)({name:"UploadTemplate",isIntentional:!0},n)})):null});function z(e,t){var n=t&&e.demandItemFacet(D.Re,O.e.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl}));return!!n&&!!n.isDocumentLibrary&&n.templateType!==P.t.webPageLibrary&&!!n.newWOPIDocumentEnabled}var W=n(360),X=(new S.e("UploadTemplate").id,x.L,w.createElement(E.e,null,w.createElement(U,{engagement:{name:"UploadTemplate"}})),Object(i.__assign)({},D.Et.pack(W.p)),{key:new S.e("AddTemplate").id,automationId:"AddTemplate",name:x.e,iconProps:{iconName:"Add"},action:w.createElement(E.e,null,w.createElement(U,{engagement:{name:"AddTemplate"}})),facets:Object(i.__assign)({},D.Et.pack(W.t))}),V=(Object(i.__assign)(Object(i.__assign)({},X),{action:w.createElement(U,{engagement:{name:"AddTemplate"}})}),new S.e("editNewMenu").id);var $=n(194),J=n(371),K=n(314),Q=n(618),G=n(999),Y=n(2878),Z=n(952),ee=function(e){var t=e.template,n=e.listKey,r=e.enableDocLibsPersistentNewCommand;if(!t.url)throw new Error("Cannot create a command for a template without a URL.");var i,s,o=t.url,u=Z.e.serialize({listKey:n,templateUrl:o});return{key:new S.e("createDocumentFromTemplate").id,automationId:"createDocumentFromTemplate",name:t.title,action:r?w.createElement(J.t,{documentType:Object(Y.t)(o),templateItemKey:u}):w.createElement(E.e,null,w.createElement(J.e,{documentType:Object(Y.t)(o),templateItemKey:u})),iconProps:Object(K.e)({extension:(i=o,s=Object(Q.t)(i,!0),Object(G.t)(s)),size:16})}};var te=n(2478);function ne(e,t){var n=t.contentTypes,r=t.newCommandMenu,w=t.fileHandlerCommands,E=t.isCreateFolderAvailable,S=t.newDocumentTemplates,x=t.contentTypeCommands,T=t.listKey,N=t.enableDocLibsPersistentNewCommand,C={},k={},L=[],A=new Map,O=Object(K.e)({extension:"docx",size:16}),M=N?(function(){var e;return(e={})[l]=o.e,e[c]=Object(u.e)(f.o,a.e.Word),e[h]=Object(u.e)(f.e,a.e.Excel),e[p]=Object(u.e)(f.i,a.e.PowerPoint),e[d]=Object(u.e)(f.r,a.e.OneNote),e[v]=Object(u.e)(f.t,a.e.ExcelSurvey),e[m]=Object(u.e)(f.n,a.e.ExcelForm),e[g]=Object(u.e)(f.s,a.e.Visio),e})():(function(){var e;return(e={})[l]=s.e,e[c]=f.o,e[h]=f.e,e[p]=f.i,e[d]=f.r,e[v]=f.t,e[m]=f.n,e[g]=f.s,e})(),_={},D=[],P=[];if(S&&S.length){if(x)for(var H=0,B=x;H<B.length;H++){(I=B[H]).name&&(C[I.name]=I)}if(n)for(var j=0,F=n;j<F.length;j++){var I;C[(I=F[j]).displayName]&&I.contentTypeId&&(k[I.contentTypeId]=C[I.displayName])}if(S)for(var q=0,R=S;q<R.length;q++){var U=R[q];U.smartTemplatePublishStatus&&U.contentTypeId&&A.set(U.contentTypeId,U.smartTemplatePublishStatus)}var z=r.subMenuProps&&r.subMenuProps.items;if(z)for(var W=0,J=z;W<J.length;W++){(fe=J[W]).name&&(M[fe.name]=fe);fe.automationId&&(M[fe.automationId]=fe)}for(var Q=void 0,G=0,Y=S;G<Y.length;G++){var Z=Y[G],ne=Z.smartTemplatePublishStatus;Z.isContentType&&Z.contentTypeId&&(_[Z.contentTypeId]=!0);fe=void 0;Z.isUpload&&T?fe=ee({template:Z,listKey:T,enableDocLibsPersistentNewCommand:N}):Z.isContentType&&Z.contentTypeId&&k[Z.contentTypeId]?fe=k[Z.contentTypeId]:M[Z.title]&&!N?fe=M[Z.title]:Z.templateId&&M[Z.templateId]&&(fe=M[Z.templateId]);if(fe){var re=Z.templateId||y[fe.key];re===l&&(Q=!0);P.push(Object(i.__assign)(Object(i.__assign)({},Z),{templateId:re,command:fe}));if(ne){fe.iconProps=O;Z.visible&&"Published"===ne&&L.push(Object(i.__assign)(Object(i.__assign)({},fe),{key:"PublishedSmartCT"+fe.key}))}if(Z.visible&&!ne){D.push(fe);M[Z.title]&&M[Z.title].key===s.e.key&&D.push({name:"-",key:"divider_1",itemType:$.e.Divider})}}}!Q&&E&&s.e.name&&P.unshift({command:N?o.e:s.e,templateId:y[s.e.key],title:s.e.name,visible:!1});for(var ie in k)if(k.hasOwnProperty(ie)&&!_[ie]){var se=k[ie];ne=A.get(ie);se.name&&!ne&&P.push({command:se,contentTypeId:ie,isContentType:!0,templateId:ie,title:se.name,visible:!0});ne||D.push(se)}if(L.length){D.push({name:"-",key:"divider_1",itemType:$.e.Divider});(D=D.concat(L)).push({name:"-",key:"divider_1",itemType:$.e.Divider})}}else{P=(function(e,t){var n=t.isCreateFolderAvailable,r=t.contentTypeCommands,i=void 0===r?[]:r,o=t.contentTypes,u=[];n&&s.e.name&&u.push({command:s.e,templateId:y[s.e.key],title:s.e.name,visible:!0});var a=!(!i||!i.length),f={};if(o)for(var l=0,c=o;l<c.length;l++){var h=c[l];h.contentTypeId&&(f[h.displayName]=h.contentTypeId)}if(a)for(var p=0,d=i;p<d.length;p++){if((E=d[p]).name){var v=f[E.name];u.push({command:E,contentTypeId:v,isContentType:!0,templateId:v,title:E.name||"",visible:!0})}}var m=b.e.subMenuProps&&b.e.subMenuProps.items;if(m)for(var g=0,w=m;g<w.length;g++){var E;(E=w[g]).name&&-1===[s.e.key,"divider_1","divider_2",X.key,V].indexOf(E.key)&&u.push({command:E,templateId:y[E.key],title:E.name,visible:!a})}return u})(0,{isCreateFolderAvailable:E,contentTypeCommands:x,contentTypes:n});if(x&&x.length)D.push.apply(D,Object(i.__spreadArrays)([N?o.e:s.e,{name:"-",key:"divider_1",itemType:$.e.Divider}],x));else if(N){var oe=[];if(r.subMenuProps&&r.subMenuProps.items)for(var ue=0,ae=r.subMenuProps.items;ue<ae.length;ue++){var fe;(fe=ae[ue]).automationId&&u.t[fe.automationId]?oe.push(Object(u.e)(fe,u.t[fe.automationId])):oe.push(fe)}D=Object(i.__spreadArrays)(oe)}else D=r.subMenuProps?Object(i.__spreadArrays)(r.subMenuProps.items):[]}w&&w.new&&(D=Object(te.t)(D,w.new));return{visibleNewCommands:Object(i.__assign)(Object(i.__assign)({},b.e),{subMenuProps:{items:D}}),allCommands:P}}},,,,function(e,t,n){"use strict";n.d(t,"t",function(){return B});n.d(t,"n",function(){return j});n.d(t,"e",function(){return F});var r=n("react-lib"),i=n(2),s=n(6),o=n(8),u=n(229),a=n(1256),f=n(120),l=n(1255),c=n(1),h=n(2994),p=n(0),d=n(30),v=n(26),m=n(40),g=n(45),y=n(573),b=n(2942),w=n(2993),E=n(47),S=function(e){return Object(p.__awaiter)(void 0,void 0,void 0,function(){return Object(p.__generator)(this,function(e){return[2]})})},x=Object(v.e)()(Object(v.s)()(Object(m.e)(function(e,t){var n,r,i,s=t.itemKey,o=t.itemKeys,u=t.enabledForMultipleItems,a=void 0===u?t.enabledForMultipleItems||!1:u,f=t.isEnabledFunc,l=t.url,h=!!a||1===o.length,d=void 0,v=void 0;if(h&&o[0]){var m=e.demandItem({key:g.e,permissions:c.lt,rowData:c.Ct},o[0])||void 0;if(m){v=m.key;d=m.rowData;i=m.permissions}}else if(h&&s){var x=e.demandItem({key:g.e,permissions:c.lt},s);if(x){v=x.key;i=x.permissions}}n=v&&v.webAbsoluteUrl;r=v&&v.listFullUrl;var T=n&&r&&e.demandItemFacet(c.un,y.e.serialize({webAbsoluteUrl:n,listFullUrl:r}))||void 0;if(h&&!a)if("boolean"==typeof f)h=f;else if("function"==typeof f){var N="",C="",k="";if(d){var L=d;N=L.File_x0020_Type||"";C=L.ContentTypeId||"";k=L.ProgId||""}else h=!1;h=f({permissions:i||0,extension:N,contentTypeId:C,progId:k})}if(h&&l){var A=[];o.forEach(function(t){var n=e.demandItem({itemId:c.We,itemUrl:c.pe},t);n&&A.push({id:n.itemId||"",url:n.itemUrl||""})});T&&(l=Object(b.n)(l,A,T))}var O=S;O=l&&"javascript:LaunchApp("===l.substring(0,21)&&");"===l.substring(l.length-2)?function(){return Object(p.__awaiter)(void 0,void 0,void 0,function(){return Object(p.__generator)(this,function(e){l&&T&&Object(w.e)(l,T);return[2]})})}:function(){return Object(p.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(p.__generator)(this,function(t){(e=window.open(l,"_blank"))&&e.focus();return[2]})})};return Object(p.__assign)({isAvailable:h,onExecute:O},Object(E.t)(e,{itemKey:o[0],engagement:{name:"CustomActionNavigation",isIntentional:!0}}))})(d.e))),T=n(122),N=n(155),C=function(e){return Object(p.__awaiter)(void 0,void 0,void 0,function(){return Object(p.__generator)(this,function(e){return[2]})})},k=Object(m.t)(function(e,t){var n=t.itemKeys,i=t.enabledForMultipleItems,s=void 0===i?t.enabledForMultipleItems||!1:i,o=t.isEnabledFunc,a=t.commandAdapter,f=t.actionKey,l=t.rootFolder,h=e.dispatch,v=!!s||1===n.length;if(v&&1===n.length&&"function"==typeof o){var m=e.demandItem({key:g.e,permissions:c.lt,rowData:c.Ct},n[0]),y="",b="",w="";if(m&&m.rowData){var S=m.rowData;y=S.File_x0020_Type||"";b=S.ContentTypeId||"";w=S.ProgId||""}else v=!1;v=v&&o({permissions:m&&m.permissions||0,extension:y,contentTypeId:b,progId:w})}if(v&&a){var x=[];n.forEach(function(t){var n=e.demandItemFacet(u.a,t);n&&x.push(n)});a.refresh(x,l);v=v&&a.visible}var T=C;a&&(T=function(){return Object(p.__awaiter)(void 0,void 0,void 0,function(){return Object(p.__generator)(this,function(e){return[2,a.execute()]})})});return r.createElement(r.Fragment,null,r.createElement(L,{dispatch:h,itemKeys:n}),r.createElement(d.e,Object(p.__assign)({isAvailable:v,onExecute:T},Object(E.t)(e,{itemKey:f,engagement:{name:"ClientSideCommandSet",isIntentional:!0}}))))}),L=function(e){var t=e.dispatch,n=e.itemKeys;if(n.length<1)return null;var r=n[0],i=void 0;if(g.e.matches(r)){var s=g.e.deserialize(r);if(s){var o=f.e.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl});i=t(Object(T.e)({listViewAdapter:u.u},o)).listViewAdapter}}var a={};if(i){n.forEach(function(e){var n=t(Object(T.e)({rowData:c.Ct,rowAdapter:u.a},e)),r=n.rowData;if(!n.rowAdapter&&r&&i){var s=i.createRowAdapter({values:r});s&&(a[e]=Object(p.__assign)({},u.a.pack(s)))}});Object.keys(a).length>0&&t(Object(N.e)({items:a}))}return null},A=Object(v.s)()(k),O=n(640),M=n(106),_=n(34),D=new i.e("customActionNavigationCommand").id;function P(e){var t=e.key,n=e.name,i=e.url,s=e.iconUrl,o=e.enabledForMultipleItems,u=e.isEnabledFunc,a=e.commandAdapter,f=e.actionKey,l=e.rootFolder;return{key:D+"-"+t,automationId:"customactionNavigation",name:n,iconProps:{iconType:O.e.image,className:"customActionCommandIcon_8eecbd85",imageProps:{src:s||"",imageFit:M.t.contain,className:"customActionCommandIcon_8eecbd85"}},action:a?r.createElement(A,{enabledForMultipleItems:o,isEnabledFunc:u,commandAdapter:a,actionKey:f,rootFolder:l}):i?r.createElement(x,{url:i,enabledForMultipleItems:o,isEnabledFunc:u}):void 0}}var H=new i.e("customActionGroupCommand").id;function B(e,t,n){var r=t.webAbsoluteUrl,i=t.listFullUrl,s=a.e.serialize({webAbsoluteUrl:r,listFullUrl:i}),o=F({itemCache:e,targetCustomActionSetKey:s,keys:{webAbsoluteUrl:r,listFullUrl:i}}),u=j(e,s,n);o&&(u=u.concat(j(e,o,n)));return u}function j(e,t,n){var r=[],i=e.demandItemFacet(o.e,t);i&&i.itemKeys&&i.itemKeys.forEach(function(t){var i,a,f,l,c=e.demandItem({displayName:s.h,openUrl:s.O,iconUrl:h.t,childItemKeys:o.e,enabledForMultipleItems:h.e,isEnabledFunc:h.n,commandAdapter:u.i,visible:u.s},t);if(c&&c.displayName){var p=c.displayName,d=c.openUrl,v=c.iconUrl,m=c.enabledForMultipleItems,g=c.isEnabledFunc,y=c.childItemKeys,b=c.commandAdapter;if(y&&y.itemKeys&&y.itemKeys.length>0){var w=[];y.itemKeys.forEach(function(r,i,o){var a=e.demandItem({subMenuDisplayName:s.h,openUrl:s.O,iconUrl:h.t,enabledForMultipleItems:h.e,isEnabledFunc:h.n,commandAdapter:u.i,visible:u.s},r);a&&a.subMenuDisplayName&&w.push(P({key:t+"-"+r,name:a&&a.subMenuDisplayName,url:a&&a.openUrl,iconUrl:a&&a.iconUrl,enabledForMultipleItems:a&&a.enabledForMultipleItems,isEnabledFunc:a&&a.isEnabledFunc,commandAdapter:a&&a.commandAdapter,actionKey:t,rootFolder:n}))});r.push((a=(i={key:t,name:p,subCommands:w}).key,f=i.name,l=i.subCommands,{key:H+"-"+a,automationId:"customActionGroupCommand",name:f,subMenuProps:{items:l}}))}else p&&r.push(P({key:t,name:p,url:d,iconUrl:v,enabledForMultipleItems:m,isEnabledFunc:g,commandAdapter:b,actionKey:t,rootFolder:n}))}});return r}function F(e){var t=e.keys,n=t.webAbsoluteUrl,r=t.listFullUrl,i=e.itemCache,s=e.targetCustomActionSetKey,a=void 0,h=f.e.serialize({webAbsoluteUrl:n,listFullUrl:r}),p=i.demandItemFacet(u.o,h),d=i.demandItemFacet(c.xt,s),v=!!p&&!!d,m=Object(_.e)(i).itemsScopeItemKey;if(v&&m){var g=l.e.serialize({webAbsoluteUrl:n,listFullUrl:r,isSPFXandCustomActionsAvailable:v,targetCustomActionSetKey:s,itemsScopeItemKey:m});i.demandItemFacet(o.e,g)&&(a=g)}return a}},function(e,t,n){"use strict";n.d(t,"e",function(){return Y});var r,i=n("react-lib"),s=n(2),o=n(0),u=n(40),a=n(738),f=n(90),l=n(30),c=n(47),h=n(18),p=n(785),d=n(59),v=n(27),m=n(176),g=n(26),y=n(679),b=n(764),w=n(322),E=n(9),S=n(10),x=n(217),T=n(614),N=n(74),C=n(3213),k=n(163),L=n(22),A=n(3632),O=n(131),M=n(363),_=n(204),D=n(2301),P=n(2775),H=n(2879),B=n(2433),j=((r={})[N.r.started]=function(e){return Object(L.format)(Object(L.getLocalizedCountValue)(A.c,A.h,e)||"",e)},r[N.r.completed]=function(e){return Object(L.format)(Object(L.getLocalizedCountValue)(A.n,A.r,e)||"",e)},r[N.r.failed]=function(e){return Object(L.format)(Object(L.getLocalizedCountValue)(A.o,A.u,e)||"",e)},r[N.r.canceled]=function(e){return Object(L.format)(Object(L.getLocalizedCountValue)(A.o,A.u,e)||"",e)},r),F=Object(S.t)(function(){return function(e){e(Object(w.e)(b.t,T.e)(Object(E.t)()(R)));e(Object(w.e)(b.t,B.e)(Object(E.t)()(I)));e(Object(x.r)(b.t,D.t)(Object(P.e)(b.t,b.e)))}});function I(){return function(e){return q}}function q(e,t){return{isAvailable:!1}}function R(){return function(e){return U}}function U(e,t){var n,r,i=Object(k.r)(e,t),u=i.phase,a=i.count,f=[],l=e.demandItemFacet(O.e,t.itemKey);if(u===N.r.started||u===N.r.completed){var c=null===(n=e.demandItemFacet(b.e,t.itemKey))||void 0===n?void 0:n.printerName;c&&(r=u===N.r.started?Object(L.format)(A.l,c):Object(L.format)(A.i,c))}else if(u===N.r.failed&&l){r=A.f;f.push(C.e);if(l instanceof M.e){var h=Object(s.r)({accessDenied:_.e,authFailure:_.r,offlineError:_.y,fileDownloadError:H.e,fetchFileDownloadUrlError:H.t},l.facets),p=h.accessDenied,d=h.authFailure,v=h.offlineError,m=h.fileDownloadError,g=h.fetchFileDownloadUrlError;p?r=A.e:d?r=A.t:v?r=A.s:(m||g)&&(r=A.a)}}var y=j[u](a);return Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},y&&"item"!==t.format?{title:y}:{}),r?{description:r}:{}),{commands:f})}var z=Object(y.e)({operationTypeFacet:b.e,progressKeyFacet:b.t,initializeBatch:function(){return F}}),W=n(6),X=n(737),V=Object(m.e)(function(){return Object(o.__awaiter)(void 0,void 0,void 0,function(){return Object(o.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(["6"],4227)];case 1:return[2,e.sent().UniversalPrintItemWizard]}})})}),$=Object(u.t)(function(e,t){var n=t.itemKey,r=t.getPrintFileItem,s=void 0===r?a.e:r,u=t.printFileItem,f=void 0===u?z:u;if(!n)return null;var m=e.demandItemFacet(p.e,n),g=e.demandItemFacet(W.d,n),y=Object(v.e)(e,{graphEndpoint:d.v}).graphEndpoint;if(!y||!g)return null;var b=p.e.evaluate(m)(e,{itemKey:n,isAvailable:!1}).isAvailable,w=Object(X.r)(g.extension);if(!g.name||!w)return null;var E=Object(h.o)(function(e){return i.createElement(V,Object(o.__assign)({},e,{itemKey:n,fileName:g.name+g.extension,printJobFileType:w,getPrintFileItem:s,printFileItem:f,graphEndpoint:y}))});return i.createElement(l.e,Object(o.__assign)({isAvailable:b,onExecute:E},Object(c.t)(e,{itemKey:n,engagement:{name:"PrintToUniversalPrinter",isIntentional:!0}})))}),J=Object(f.t)(function(e){return function(t){return Object(o.__awaiter)(void 0,void 0,void 0,function(){return Object(o.__generator)(this,function(n){switch(n.label){case 0:return[4,t(Object(a.e)(e))];case 1:return[2,n.sent()]}})})}}),K=Object(f.t)(function(e){return function(t){return Object(o.__awaiter)(void 0,void 0,void 0,function(){return Object(o.__generator)(this,function(n){switch(n.label){case 0:return[4,t(z(e))];case 1:return[2,n.sent()]}})})}});var Q=Object(u.e)(function(){return{getPrintFileItem:J,printFileItem:K}})(Object(g.s)()(Object(g.r)()($))),G=n(3633),Y={key:new s.e("universalPrint").id,automationId:"universalPrintCommand",action:i.createElement(Q,null),name:G.t,title:G.e,iconProps:{iconName:"CloudPrinter"}}},,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return O});n.d(t,"e",function(){return P});var r=n(0),i=n("react-lib"),s=n(26),o=n(40),u=n(8),a=n(1197),f=n(6),l=n(1),c=n(62),h=n(47),p=n(176),d=n(34),v=n(18),m=n(30),g=n(943),y=Object(o.e)()(Object(p.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(["15","ondemand.resx-ondemand"],4441)];case 1:return[2,e.sent().EditPinnedItemExecutor]}})})})),b=Object(o.t)(function(e,t){var n=t.itemKey,s=t.editType,o=Object(d.e)(e).itemsScopeItemKey,p=Object(g.e)(e),b=e.demandItem({isMalwareDetected:f.k,permissions:l.lt},n),w=b.isMalwareDetected,E=b.permissions,S=!w&&!!n&&Object(a.e)(e,t)&&!!p&&!!E&&c.e.hasItemPermission({permissions:E},c.e.manageLists)&&(function(e,t){var n=t.pinnedItemSetKey,r=t.editType,i=e.demandItemFacet(u.e,n),s=i?i.itemKeys:[],o=s.indexOf(t.itemKey),a=o>-1?0!==r:0===r;a&&(2===r?a=0!==o:3===r&&(a=o!==s.length-1));return a})(e,{itemKey:t.itemKey,pinnedItemSetKey:p,editType:s}),x=o?Object(v.o)(function(e){return i.createElement(y,Object(r.__assign)({},e,t,{itemsScopeItemKey:o,pinnedItemSetKey:p}))}):void 0;return i.createElement(m.e,Object(r.__assign)({isAvailable:S,onExecute:x},Object(h.t)(e,{itemKey:n,engagement:{name:"EditPinnedItem",isIntentional:!0}})))}),w=Object(s.s)()(Object(s.r)()(b));var E=n(633),S=n(3258),x=n(2),T=Object(x.t)("pinItem"),N=Object(x.t)("moveLeftPinnedItem"),C=Object(x.t)("moveRightPinnedItem"),k=Object(x.t)("removePinnedItem"),L=Object(x.t)("editPinnedItem"),A=n(360),O={key:T,automationId:"pinItemCommand",name:S.T,iconProps:{iconName:"Pin"},action:i.createElement(w,{editType:0}),facets:Object(r.__assign)({},l.Et.pack(A.f))},M={key:N,automationId:"moveLeftPinnedItemCommand",name:S.m,iconProps:{iconName:E.e.isRightToLeft?"Forward":"Back"},action:i.createElement(w,{editType:2})},_={key:C,automationId:"moveRightPinnedItemCommand",name:S.w,iconProps:{iconName:E.e.isRightToLeft?"Back":"Forward"},action:i.createElement(w,{editType:3})},D={key:k,automationId:"removePinnedItemCommand",name:S.N,iconProps:{iconName:"UnPin"},action:i.createElement(w,{editType:1})},P={key:L,automationId:"editPinnedItemCommand",name:S.e,iconProps:{iconName:"Pinned"},subMenuProps:{items:[M,_,D]}}},function(e,t,n){"use strict";n.d(t,"e",function(){return Q});n.d(t,"t",function(){return G});var r,i,s=n(0),o=n("react-lib"),u=n(2871),a=n(115),f=n(2369),l=n(45),c=n(120),h=n(6),p=n(1),d=n(137),v=n(780),m=n(2556),g=n(29),y=n(10),b=n(322),w=n(9),E=n(614),S=n(22),x=n(163),T=n(74),N=n(2612),C=n(8),k=n(3002),L=((r={})[T.r.started]=function(e){var t=e.count,n=e.isScheduled;return Object(S.formatToArray)(Object(S.getLocalizedCountValue)(n?k.S:k.v,k.a,t)||"",t)},r[T.r.completed]=function(e){var t=e.count,n=e.isScheduled;return Object(S.formatToArray)(Object(S.getLocalizedCountValue)(n?k.b:k.u,k.a,t)||"",t)},r[T.r.failed]=function(e){var t=e.count,n=e.isScheduled;return Object(S.formatToArray)(Object(S.getLocalizedCountValue)(n?k.E:k.c,k.h,t)||"",t)},r[T.r.canceled]=function(e){var t=e.count,n=e.isScheduled;return Object(S.formatToArray)(Object(S.getLocalizedCountValue)(n?k.E:k.c,k.h,t)||"",t)},r),A=((i={})[T.r.started]=function(e){var t=e.count,n=e.itemKey,r=e.isScheduled;return Object(S.formatToArray)(Object(S.getLocalizedCountValue)(r?k.S:k.v,k.d,t)||"",t,o.createElement(N.e,{key:"link",itemKey:n}))},i[T.r.completed]=function(e){var t=e.count,n=e.itemKey,r=e.isScheduled;return Object(S.formatToArray)(Object(S.getLocalizedCountValue)(r?k.y:k.s,k.o,t)||"",t,o.createElement(N.e,{key:"link",itemKey:n}))},i[T.r.failed]=function(e){var t=e.count,n=e.itemKey,r=e.isScheduled;return Object(S.formatToArray)(Object(S.getLocalizedCountValue)(r?k.w:k.f,k.l,t)||"",t,o.createElement(N.e,{key:"link",itemKey:n}))},i[T.r.canceled]=function(e){var t=e.count,n=e.itemKey,r=e.isScheduled;return Object(S.formatToArray)(Object(S.getLocalizedCountValue)(r?k.w:k.f,k.l,t)||"",t,o.createElement(N.e,{key:"link",itemKey:n}))},i),O=Object(y.t)(function(){return function(e){e(Object(b.e)(u.e,E.e)(Object(w.t)()(M)))}});function M(){return function(e){return _}}function _(e,t){var n,r,i=Object(x.r)(e,t),o=i.phase,a=i.count,l=(function(e,t){var n=void 0,r=e.demandItemFacet(C.e,t.itemKey);if(r)for(var i=0,s=r.itemKeys;i<s.length;i++){var o=s[i],u=e.demandItemFacet(T.b,o),a=u&&u.itemKey,f=e.demandItemFacet(h.M,a),l=f&&f.itemKey;if(l)if(n){if(l!==n)break}else n=l}return n})(e,t),c=e.demandItemFacet(C.e,t.itemKey),p=c&&c.itemKeys;p&&p.length>0&&(r=e.demandItemFacet(u.t,p[0]));var d=!!r&&r.publishActionType===f.e.SchedulePublish;n="group"===t.format&&l?A[o]({count:a,itemKey:l,isScheduled:d}):L[o]({count:a,isScheduled:d});return Object(s.__assign)(Object(s.__assign)({},n&&"item"!==t.format?{title:n}:{}),{})}var D=n(679),P=n(2119),H=n(154),B=Object(D.e)({operationTypeFacet:u.t,progressKeyFacet:u.e,initializeBatch:function(){return O}}),j=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.state={publishItemError:void 0};return n}t.prototype.componentDidMount=function(){var e=this.props,t=e.itemCacheDispatch,n=e.itemKeys,r=e.itemSetKey,i=e.resolve,s=e.reject,o=n[0],u=t(Object(d.e)(function(e){return e.demandItem({firstItemKey:l.e,displayName:h.h},n[0])})).firstItemKey,y=t(Object(d.e)(function(e){return m.n(e,o)})),b={publishActionType:y},w=!1;if(u){var E=t(Object(d.e)(function(e){return e.demandItemFacet(p.Re,c.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl}))}));w=!!E&&E.templateType===g.t.webPageLibrary}if(u&&w&&y===f.e.SubmitForApproval){var S=""+new H.e(u.webAbsoluteUrl).authority+t(Object(d.e)(function(e){return e.demandItemFacet(p.pe,n[0])}));window.location.href=S}else t(B({items:Object(a.e)(n,function(){return b})})).then(function(){var e,s;t(Object(v.e)({items:(e={},e[o]=[p.gn],e[o]=[p.tt],e)}));r&&t(Object(P.e)({items:(s={},s[r]=Object(a.e)(n,function(){return{}}),s)}));i()}).catch(function(e){s(e)})};t.prototype.render=function(){return null};return t})(o.PureComponent),F=n(26),I=n(40),q=n(119),R=n(47),U=n(2627),z=n(18),W=n(30),X=n(57),V=n(573),$=n(1099),J=Object(I.e)()(j),K=Object(I.e)(function(e,t){var n=t.onCancel,r=t.reject;return{onCancel:function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){r(new q.e);n&&n();return[2]})})},title:k.n,prompt:k.t,cancelText:k.e}})(U.e),Q=Object(I.t)(function(e,t){var n,r=t.itemKeys,i=t.publishType,u=t.source;if(!r||!r.length)return null;var a=Object(X.e)(e),c=e.demandItem({firstItemKey:l.e,hasMissingMetadata:h.L,contentTypeId:p.d},r[0]),d=c.firstItemKey,v=c.hasMissingMetadata,y=c.contentTypeId;if(!d)return null;var b=d&&e.demandItemFacet(p.un,V.e.serialize({webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl}));if(b&&(b.isAnonymousGuestUser||b.isEmailAuthenticationGuestUser))return null;var w=!1,E=m.n(e,r[0]);if(!(r.length>1&&((null===(n=b)||void 0===n?void 0:n.listBaseTemplate)!==g.n.webPageLibrary||!(E===f.e.Publish||E===f.e.Republish||E===f.e.PostNews||E===f.e.UpdateNews))))for(var S=0,x=r;S<x.length;S++){var T=x[S];if(!(w=!!m.e(e,T)&&(!(r.length>1&&!m.i(y))&&($.t(e,T)?1===i:0===i))))break}var N=Object(z.o)(function(e){if(v){return o.createElement(K,Object(s.__assign)({},e,{onCancel:function(e){}}))}return o.createElement(J,Object(s.__assign)({},e,{itemKeys:r,itemSetKey:a}))});return o.createElement(W.e,Object(s.__assign)({isAvailable:w,onExecute:N},Object(R.t)(e,{itemKey:r[0],engagement:{name:"PublishItem",isIntentional:!0,extraData:{publishSource:u}}})))}),G=Object(F.s)()(Q)},,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return b});n.d(t,"t",function(){return w});var r=n(0),i=n(1232),s=n(65),o=n(10),u=n(198),a=n(165),f=n(2),l=n(8),c=n(137),h=n(45),p=n(377),d=n(27),v=n(2623),m=n(74),g=n(155),y=n(1);var b=new f.e("projection");var w=Object(o.i)()(function(e){var t=this,n=i.e.deserialize(e.itemKey).itemSetKey;return function(o){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,f,w;return Object(r.__generator)(this,function(E){t=s.e.serialize(n);(f=new u.e).resolveItems({items:(w={},w[e.itemKey]=Object(r.__assign)(Object(r.__assign)({},b.pack({})),Object(a.e)().forFacet(b).thenInvalidate(function(){return function(){o((function(e){var t=this,n=e.itemSetKey,o=s.e.deserialize(n),u=i.e.serialize({itemSetKey:o});return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){e(Object(c.e)(function(e){var t=Object(d.e)(e,{isProjectedUploadedItemSetEnabled:y.V}).isProjectedUploadedItemSetEnabled;if(void 0!==t&&t){var n=h.e.serialize(o),r=e.demandItemFacet(y.n,n);if(r&&Object.keys(r).length>0)return!1;for(var i=e.demandItemFacet(l.e,p.e),s=0,u=i&&i.itemKeys||[];s<u.length;s++){var a=u[s];if(e.demandItemFacet(v.t,a)){var f=e.demandItemFacet(m.o,a),c=e.demandItemFacet(h.e,f&&f.itemKey);if(c&&c.rootFolder===o.rootFolder)return!1}}}return!0}))&&e(Object(g.e)({items:(t={},t[u]=Object(r.__assign)({},l.e.pack({itemKeys:[]})),t)}));return[2]})})}})({itemSetKey:t}))}}).pack()),w[t]=Object(a.e)().forFacet(l.e).thenInvalidate(e.itemKey,b).pack(),w)});o(f.execute());return[2]})})}})},function(e,t,n){"use strict";n.d(t,"e",function(){return T});n.d(t,"t",function(){return N});var r,i=n(352),s=n(679),o=n(0),u=n(22),a=n(3613),f=n(2864),l=n(10),c=n(322),h=n(9),p=n(614),d=n(336),v=n(163),m=n(8),g=n(74),y=n(6),b=((r={})[g.r.started]=function(e,t){return Object(u.format)(Object(u.getLocalizedCountValue)(a.n,a.r,e)||"",e,t)},r[g.r.completed]=function(e,t){return Object(u.format)(Object(u.getLocalizedCountValue)(a.e,a.r,e)||"",e,t)},r[g.r.failed]=function(e,t){return Object(u.format)(Object(u.getLocalizedCountValue)(a.t,a.r,e)||"",e,t)},r[g.r.canceled]=function(e,t){return Object(u.format)(Object(u.getLocalizedCountValue)(a.t,a.r,e)||"",e,t)},r),w=Object(l.t)(function(){return function(e){e(Object(c.e)(f.t,p.e)(Object(h.t)()(S)));e(Object(c.e)(f.t,d.n)(Object(h.t)()(E)))}});function E(){return function(e){return function(e,t){return{reportMode:d.e.pin}}}}function S(){return function(e){return x}}function x(e,t){var n=t.itemKey,r=Object(v.r)(e,t),i=r.phase,s=r.count,u=b,a=e.demandItemFacet(m.e,n),l=a&&a.itemKeys,c="",h="";if(l&&l.length>0){var p=e.demandItemFacet(f.e,l[0]),d=p&&p.groupKey;d&&(c=e.demandItemFacet(y.h,d)||"");h=u[i](s,c)}else{var g=e.demandItemFacet(f.t,n);if(g){var w=g.taskKey,E=w&&e.demandItemFacet(y.h,w);E&&(h=E)}}return Object(o.__assign)({},h&&"item"!==t.format?{title:h}:{})}var T=Object(i.e)({operationTypeFacet:f.e}),N=Object(s.e)({operationTypeFacet:f.e,progressKeyFacet:f.t,initializeBatch:function(){return w}})},function(e,t,n){"use strict";n.d(t,"t",function(){return E});n.d(t,"e",function(){return S});n.d(t,"n",function(){return x});var r,i,s=n(0),o=n(800),u=n(45),a=n(386);(function(e){e[e.pin=0]="pin";e[e.unpin=1]="unpin";e[e.movePrevious=2]="movePrevious";e[e.moveNext=3]="moveNext"})(r||(r={}));(function(e){e[e.success=0]="success";e[e.folderDoesNotExist=1]="folderDoesNotExist";e[e.itemDoesNotExist=2]="itemDoesNotExist";e[e.tooManyItems=3]="tooManyItems";e[e.itemNotInSpotlight=4]="itemNotInSpotlight";e[e.invalidArgument=5]="invalidArgument";e[e.serverError=6]="serverError";e[e.invalidServerJSON=7]="invalidServerJSON";e[e.unknownServerResult=8]="unknownServerResult"})(i||(i={}));var f=n(83),l=n(154),c=n(1352),h=n(10),p=n(8),d=n(155),v=n(1),m=n(137),g=n(2772),y=n(115),b=n(165),w=n(6),E=3,S=(function(e){Object(s.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.resultType,i=void 0===r?8:r;n.resultType=i;return n}return t})(c.e),x=Object(h.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.itemEditTypeMap;return function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var r,i,c,h,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q;return Object(s.__generator)(this,function(R){switch(R.label){case 0:r=Object.keys(n)[0];i=n[r].editType;return[4,e(Object(g.e)(r))];case 1:c=R.sent(),h=c.key,x=c.itemId;T=e(Object(m.e)(function(e){return e.demandItem({deserializedPinnedItemSetKey:o.e,pinnedItems:p.e},t)})),N=T.deserializedPinnedItemSetKey,C=T.pinnedItems;N||(N=o.e.deserialize(t));if(!h||!N||!x)throw new S({resultType:5});if(!(h&&N&&x))return[3,3];k="";"";N.viewKey&&(k=N.viewKey.viewId);L=N.parentItemKey.rootFolder||new l.e(N.parentItemKey.listFullUrl).path;A=void 0;(O=C&&C.itemKeys||[])&&(M=O.indexOf(r))>-1&&(2===i&&M>=2?A=O[M-2]:3===i&&M<O.length-1&&(A=O[M+1]));_=void 0;A&&(_=e(Object(m.e)(function(e){return e.demandItemFacet(v.We,A)})));D={webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:h.listFullUrl,itemId:x,editType:i,viewId:k,rootFolder:L,afterItemId:_};t&&(P=(function(e,t,n,r){var i=r.editType,s=[];(0===i||void 0===n&&1!==i)&&s.push(e);for(var o=0,u=t;o<u.length;o++){var a=u[o];a!==e&&s.push(a);a===n&&s.push(e)}return s})(r,O,A,D)).length<=E&&e(Object(d.e)({items:Object(s.__assign)((I={},I[t]=Object(s.__assign)({},p.e.pack({itemKeys:P})),I),Object(y.e)(P,function(){return Object(s.__assign)({},Object(b.e)().forFacet(w.l).thenInvalidate(t,p.e).pack())}))}));return(H=(function(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.viewId,i=e.editType,s=e.itemId,o=e.afterItemId,u=e.rootFolder,f=Object(a.e)({webAbsoluteUrl:t,listFullUrl:n});r&&(f=f.methodWithAliases("GetView",{viewGuid:r}));if(1!==i){var l=o?parseInt(o,10):-1;isNaN(l)&&(l=-1);f=f.methodWithAliases("AddToSpotlight",{itemId:s,folderPath:u||"",afterItemId:l})}else f=f.methodWithAliases("RemoveFromSpotlight",{itemId:s,folderPath:u||""});return f.toString()})(D))?[4,e(Object(f.t)({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:h.listFullUrl,url:H,method:"POST",additionalHeaders:void 0,qosName:"editPinnedItem",noRedirect:!0}))]:[3,3];case 2:B=R.sent();if(0!==(j=(function(e){try{if(e.d){var t=e.d.Order?e.d.Order.results:void 0;return{resultType:e.d.ResultCode,order:t}}return{resultType:8,order:void 0}}catch(e){return{resultType:7,order:void 0}}})(B)).resultType){F=(function(e,t){var n=[];if(e.order)for(var r=0,i=e.order;r<i.length;r++){var o=i[r];n.push(u.e.serialize(Object(s.__assign)(Object(s.__assign)({},t),{itemId:o.toString()})))}return n})(j,h);e(Object(d.e)({items:Object(s.__assign)((q={},q[t]=Object(s.__assign)({},p.e.pack({itemKeys:F})),q),Object(y.e)(F,function(){return Object(s.__assign)({},Object(b.e)().forFacet(w.l).thenInvalidate(t,p.e).pack())}))}));throw new S({resultType:j.resultType})}R.label=3;case 3:return[2]}})})}})},function(e,t,n){"use strict";n.d(t,"e",function(){return S});var r=n("react-lib"),i=n(45),s=n(952),o=n(1251),u=n(937),a=n(1252),f=n(120),l=n(1),c=n(3000),h=n(88),p=n(3001);function d(e,t,n,r,i,s,o){return{key:n+r,name:r,action:t(o),iconProps:m(e,s,i)}}function v(e,t,n,r,i,s,o,u){return{key:n+r.displayName,name:r.displayName,action:t(r.contentTypeId||""),iconProps:m(e,s,i)}}function m(e,t,n){return t?{iconName:t}:{iconName:"CustomIcon",style:{backgroundImage:"url("+(n?e+n:n)+")",width:"16px",height:"16px",backgroundRepeat:"no-repeat"}}}function g(e,t,n,r,i,s){return Object(p.e)(e,t,d.bind(void 0,t.webAbsoluteUrl,r),v.bind(void 0,t.webAbsoluteUrl,i),n,s)}var y=n(70),b=n(371),w=n(3255),E=n(2878);function S(e,t){var n,p=t.key,d=t.listKey,v=t.listFacets,m=t.pageContext,S=t.enableDocLibsPersistentNewCommand,x=[],T=(function(e,t){var n=t.listKey,r=t.listFacets,i=t.pageContext,s=f.e.serialize(n),o=e.demandItemFacet(l.v,s);return!!(i&&!Object(y.n)(i).isActivated("2DEF0213-505E-4BB3-8441-19E3AEC0D352","3/19/21a")&&o&&o.length>1&&r.contentTypesEnabled)})(e,{listFacets:v,pageContext:m,listKey:d}),N=i.e.serialize(p),C=e.demandItemFacet(l.v,N);if(C&&C.length){C.forEach(function(t){var n=e.demandItemFacet(l.Vt,t);n&&x.push(n)});if((T||!Object(c.e)(x,v))&&m){var k=new h.t({context:{webAbsoluteUrl:p.webAbsoluteUrl,listUrl:p.listFullUrl}}).getUrlParts({path:p.rootFolder});n=g(x,m,k,function(t){var n=S?r.createElement(b.t,{documentType:Object(E.t)(t),templateItemKey:s.e.serialize({listKey:d,templateUrl:t})}):e.demandItemFacet(l.t,o.e.serialize({listKey:d,templateUrl:t}));return p&&n},function(t){var n=!!v&&v.openInClient,i=u.e.serialize({listKey:{webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl},contentTypeId:t}),s=S?r.createElement(w.t,{contentTypeId:t,openInClient:n,contentTypeKey:i}):e.demandItemFacet(l.t,a.e.serialize({listKey:d,contentTypeId:t}));return p&&s},v)}}return{contentTypes:x,contentTypeCommands:n}}}],Array(16),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(17).e)("LibrariesDropdownControl",{})}],Array(16),[function(e,t,n){"use strict";n.r(t);n.d(t,"spProjectedUploadedItemSetAddon",function(){return m});var r=n(9),i=n(322),s=n(27),o=n(65),u=n(45),a=n(8),f=n(1232),l=n(6),c=n(1),h=n(3357),p=n(1193),d=n(10),v=Object(r.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=t.itemKeys,i=Object(s.e)(e,{isProjectedUploadedItemSetEnabled:c.V}).isProjectedUploadedItemSetEnabled;if(void 0!==i&&i){var p=e.demandItemFacet(o.e,n);if(p){var d=(function(e,t,n){var r=[],i=f.e.serialize({itemSetKey:t}),s=e.demandItemFacet(a.e,i);e.demandItemFacet(h.e,f.e.serialize({itemSetKey:t}));if(!s||s.itemKeys&&0===s.itemKeys.length)return;for(var o={},c={},p=0,d=s.itemKeys;p<d.length;p++){var v=d[p];r.push(v);var m=e.demandItemFacet(u.e,v);if(m){m.itemId&&(o[m.itemId]=!0);m.rootFolder&&(c[m.rootFolder]=!0)}o[v]=!0}if(n)for(var g=0,y=n;g<y.length;g++){var b=y[g],w=e.demandItemFacet(u.e,b);if(w){if(e.demandItemFacet(l.m,b)){if(w.rootFolder&&w.rootFolder in c)continue}else if(w.itemId&&w.itemId in o)continue}r.push(b)}return r})(e,p,r);return d?{itemKeys:d}:{}}}return{}}}}),m=Object(d.t)(function(){return function(e){e(Object(i.e)(o.e,p.e)(Object(r.t)()(v)))}})},,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(5),i=new r.e("commands",{endpoint:Object(r.s)(),driveId:Object(r.s)({shouldNormalizeToEmpty:!0})})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});n.d(t,"n",function(){return o});n.d(t,"r",function(){return u});n.d(t,"i",function(){return a});n.d(t,"s",function(){return f});n.d(t,"o",function(){return l});n.d(t,"u",function(){return c});n.d(t,"a",function(){return h});n.d(t,"f",function(){return p});var r=n(2),i=new r.e("addToOneDrive"),s=new r.e("createFolder"),o=new r.e("createLink"),u=new r.e("delete"),a=new r.e("download"),f=new r.e("invite"),l=new r.e("move"),c=new r.e("officeLens"),h=new r.e("rename"),p=new r.e("upload")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=n(249).e.isFeatureEnabled({ODC:"EnableDefaultSortOrderFromBackend"})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("hasPdfFacet")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("tags")},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(5),i=new r.e("topCollaboratorSetKeyFacet",{endpoint:Object(r.s)()})},,function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(352),s=new r.e("updateItemRating"),o=Object(i.e)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(352),s=new r.e("updateItemLikes"),o=Object(i.e)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(352),s=new r.e("createView"),o=Object(i.e)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(352),s=new r.e("updateView"),o=Object(i.e)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"e",function(){return m});n.d(t,"t",function(){return g});var r=n(0),i=n(65),s=n(210),o=n(1240),u=n(10),a=n(122),f=n(1),l=n(8),c=n(198),h=n(137),p=n(2185),d=n(71),v=n(120);function m(e,t){var n=t.itemSetKey;if(n){var r=e.demandItemFacet(f.Re,v.e.serialize({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl}));return!!(r&&r.permissions&&r.permissions.manageLists)}return!1}var g=Object(u.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.columnModifyTypeMap;return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var u,v,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_;return Object(r.__generator)(this,function(D){switch(D.label){case 0:if(!(u=e(Object(a.e)({setKey:i.e},t)).setKey))return[3,3];v=Object.keys(n)[0];g=n[v],y=g.modifyType,b=g.targetIndex;if(!(w=u.viewKey?s.e.serialize(u.viewKey):void 0))return[3,3];if(!(E=e(Object(a.e)({currentDerivedView:f.m},w)).currentDerivedView))return[3,3];S=E.getEffectiveFieldNames();if(!(x=e(Object(a.e)({internalName:f.Te},v)).internalName))return[3,3];if((T=S.indexOf(x))<0||1===y&&0===T||2===y&&T===S.length-1)return[2];N=E.isDirty();switch(y){case 0:E.updateField(x);break;case 1:E.updateField(x,T-1);break;case 2:E.updateField(x,T+1);break;case 3:E.updateField(x,b)}C=e(Object(h.e)(function(e){return m(e,{itemSetKey:u})}));k=!1;return C?[4,e(Object(p.e)({items:(A={},A[o.e.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl})]={views:(O={},O[w]={shouldSaveViewFieldsOnly:!0},O),qosName:"autoSaveModifyColumn"},A)})).then(function(){N||(E.baseViewXml=E.getEffectiveViewXml());k=!0},function(e){d.e.logError(e,{eventName:"ModifyColumn",feature:"ColumnFieldsAutoSave",columnFieldName:x,modifyType:y,errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status});throw e})]:[3,2];case 1:D.sent();D.label=2;case 2:L=new c.e;k||L.resolveItems({items:(M={},M[w]=Object(r.__assign)({},f.Ot.pack(!0)),M)});L.invalidateItems({items:(_={},_[t]=[l.e],_[w]=[f.m],_)});e(L.execute());D.label=3;case 3:return[2]}})})}})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(352),s=new r.e("modifyColumnAggregateType"),o=Object(i.e)({operationTypeFacet:s})},,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("universalPrintSharedPrinterListItem")},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(5),i=new r.e("userExpirationItemSet",{webAbsoluteUrl:Object(r.s)()})},,,function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(0),i=n("react-lib"),s=n(30),o=n(18),u=n(119),a=n(176),f=n(40),l=n(26),c=n(6),h=n(94),p=n(1055),d=n(1),v=Object(a.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(["368","deferred.resx-deferred","ondemand.resx-ondemand"],3762)];case 1:return[2,e.sent().RulesPanel]}})})}),m=Object(l.n)()(Object(f.t)(function(e,t){var n=t.itemKey,r=t.openManagementPanel,a=t.isAvailable,f=Object(h.e)(e,n),l=Object(p.t)(e,{mapping:{internalName:d.Te,displayName:c.h,columnFieldType:d.Je},itemSetKey:n||""});if(!f)return null;var m=Object(o.o)(function(e){return i.createElement(v,{onDismiss:function(){e.reject(new u.e)},pageContext:f,itemKey:n,columnData:l,openManagementPanel:r||!1})});return i.createElement(s.e,{onExecute:m,engagement:{name:"LaunchRulesPanel",isIntentional:!0},isAvailable:a})}))},,,,,function(e,t,n){"use strict";n.r(t);n.d(t,"QuickEditActionExecutor",function(){return w});var r=n(0),i=n("react-lib"),s=n(30),o=n(201),u=n(18),a=n(47),f=n(555),l=n(542),c=n(65),h=n(1253),p=n(210),d=n(1),v=n(85),m=n(155),g=n(3014),y=n(276),b=n(34),w=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props.itemKey;return i.createElement(o.e,null,function(n){var o=n.itemCache,w=n.dispatch,E=Object(a.t)(o,{itemKey:t,engagement:{name:"QuickEdit",isIntentional:!0}}),S=o.demandItem({deserizalizeKey:c.e},t).deserizalizeKey,x=S&&S.viewKey,T=S&&h.e.serialize({listKey:{webAbsoluteUrl:S.webAbsoluteUrl,listFullUrl:S.listFullUrl},viewKey:x}),N=x&&p.e.serialize(x),C=Object(b.e)(o).itemsScopeItemKey,k=Object(y.e)(o,{itemsScopeItemKey:C});return i.createElement(u.n,{action:i.createElement(f.e,{layoutType:l.e})},function(t){var n=t.execute;return i.createElement(s.e,Object(r.__assign)({isAvailable:!0,onExecute:function(t){return Object(r.__awaiter)(e,void 0,void 0,function(){var e,i;return Object(r.__generator)(this,function(s){switch(s.label){case 0:g.t();g.e("quickEdit.layoutManager.start");T&&w(Object(m.e)({items:(e={},e[T]=Object(r.__assign)({},d.p.pack(new v.e)),e)}));N&&w(Object(m.e)({items:(i={},i[N]=Object(r.__assign)({},d.St.pack(k)),i)}));return[4,n(t)];case 1:s.sent();g.e("quickEdit.layoutManager.end");return[2]}})})}},E))})})};return t})(i.PureComponent)},,,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(2),i=n("react-lib"),s=n(341),o=n(805),u={action:i.createElement(o.e,null),automationId:"addShortcutFromSharedWithMeCommand",title:s.t,iconProps:{iconName:"FabricFolderLink"},key:new r.e("AddShortcutFromSharedWithMe").id,name:s.e}}],Array(24),[function(e,t,n){"use strict";n.d(t,"t",function(){return p});n.d(t,"e",function(){return d});var r=n(0),i=n(363),s=n(611),o=n(204),u=n(162),a=n(331),f=n(2890),l=n(1790),c=n(82),h=n(59);function p(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,f,c,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M;return Object(r.__generator)(this,function(_){switch(_.label){case 0:t=e.name,s=e.endpoint,o=e.sharepointIds,f=e.qosName,c=e.webAbsoluteUrl;p=n(Object(u.e)({getUserOneDriveEndpoint:h.d,isTestMode:h.S})),d=p.getUserOneDriveEndpoint,v=p.isTestMode;m=new a.e(c).authority;return(y=s)?[3,3]:(b=d)?[4,n(d({endpoint:m}))]:[3,2];case 1:b=_.sent();_.label=2;case 2:y=b;_.label=3;case 3:if(g=y)return[3,4];throw new i.e({code:"A2ODAddToOneDrive_missingDriveEndpointInfo"});case 4:w=g.replace("v2.0","v2.1");E=w+"/drives/me/root/children";S=o.listId;x=o.listItemUniqueId;T=o.siteId;N=o.siteUrl;C=o.webId;k={name:t,remoteItem:{sharepointIds:{listId:S,listItemUniqueId:x,siteId:T,siteUrl:N,webId:C}},"@microsoft.graph.conflictBehavior":"rename"};L=[{code:"notAllowed"},{code:"shortcutAlreadyExists"},{code:"nestedDescendantShortcutExists"},{code:"nestedAscendantShortcutExists"}];return[4,n(Object(l.n)({url:E,qosName:f,method:"POST",body:k,expectedErrors:L,endpoint:g}))];case 5:A=_.sent();if(v&&A){O=[];try{(M=window.localStorage.getItem("TAB.AddShortcut"))&&(O=JSON.parse(M))}catch(e){}window.localStorage.setItem("TAB.AddShortcut",JSON.stringify(Object(r.__spreadArrays)(O,[{name:t,id:A.id,endpoint:g}])))}return[2,A]}})})}}function d(e,t,n){var r=Object(s.t)(e,function(r,i){var s=e.response,u=s&&s.error;if(u){var a=u["@error.fixItItemIds"],l=u["@error.fixItWebUrl"],h=u["@error.fixItItemName"],p=[];if(a&&t&&n)for(var d=0,v=a;d<v.length;d++){var m=v[d],g=c.e.serialize({endpoint:t,driveId:n,itemId:m});p.push(g)}switch(r){case"unauthenticated":case 401:return o.r.pack({});case"itemNotFound":case 404:return o.a.pack({});case"accessDenied":case 403:return o.e.pack({});case"shortcutAlreadyExists":return f.n.pack({existShortcutUrl:l,existShortcutName:h});case"nestedDescendantShortcutExists":return f.t.pack({nestDescendantItemKeys:p});case"nestedAscendantShortcutExists":return f.e.pack({existShortcutUrl:l,existShortcutName:h});default:return o.y.pack({})}}});throw new i.e({innerError:e,facets:r})}}],Array(120),[function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n("react-lib"),i=n(58),s=n(84),o=n(3011),u=n(2),a={key:Object(u.t)("launchMovePickerCommand"),automationId:"launchMovePickerCommand",name:i.v,ariaLabel:i.v,action:r.createElement(s.t,null,r.createElement(o.t,null)),iconProps:{iconName:"FabricMoveToFolder"}}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n("react-lib"),i=n(58),s=n(84),o=n(3011),u=n(2),a={key:Object(u.t)("launchCopyPickerCommand"),automationId:"launchCopyPickerCommand",name:i.t,ariaLabel:i.t,action:r.createElement(s.t,null,r.createElement(o.e,null)),iconProps:{iconName:"Copy"}}},function(e,t,n){"use strict";n.r(t);n.d(t,"getSPFilterOptionSetHandler",function(){return E});var r=n(0),i=n(1),s=n(83),o=n(1167),u=n(185),a=n(386);function f(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.fieldInternalName,i=e.viewId,s=e.rootFolder,f=e.excludeFieldFilteringHtml,l=e.filterParams,c=e.currentUserDisplayName,h=Object(a.e)({webAbsoluteUrl:t,listFullUrl:n}).segment("RenderListFilterData").parameter("FieldInternalName",r||"");i&&(h=h.parameter("ViewId",i));s&&(h=h.parameter("RootFolder",{raw:Object(o.e)(s)}));f&&(h=h.parameter("ExcludeFieldFilteringHtml",!0));if(l){var p=u.default.getFilterParams(l,!0,{replaceMeFormatFilterWithCurrentUser:!0,currentUserDisplayName:c});h=h.rawParameter(p)}return h.toString()}var l=n(2000),c=n(1249),h=n(45),p=n(573),d=n(171),v=n(32),m=n(10),g=n(122),y=n(198),b=n(162),w=n(125),E=Object(m.i)({maxParallelOperationCount:8})(function e(t){var n=this,o=t.itemKey,u=c.e.deserialize(o);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,a,c,m,E;return Object(r.__generator)(this,function(S){switch(S.label){case 0:n=t((function(e){var t=e.itemSetKey,n=e.fieldKey;return function(e){var r=e(Object(b.e)({spDataSourceConfiguration:i.It})).spDataSourceConfiguration,s=r&&r.ensureAuthToken,o=h.e.serialize(t),u=e(Object(g.e)({folderPath:i.pe},o)),a=e(Object(g.e)({internalName:i.Te,mappedColumnFieldType:i.Je,isCalculated:i.Ce},d.e.serialize(n))),f=u&&u.folderPath,l=a&&a.internalName&&a.internalName,c=a&&a.mappedColumnFieldType===v.e.Taxonomy,m=a&&a.isCalculated,y=p.e.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl}),E=e(Object(g.e)({pageContext:i.un},y)).pageContext,S=t.viewKey&&t.viewKey.viewId,x=S===w.e.Empty?E&&E.viewId:S;return{webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,rootFolder:f,ensureAuthToken:s,fieldInternalName:l,isCalculatedField:m,filterParams:t.filterParams,excludeFieldFilteringHtml:c,viewId:x,currentUserDisplayName:E&&E.userDisplayName}}})({itemSetKey:u.itemSetKey,fieldKey:u.fieldKey}));return[4,t((x=n,function(e){return e(Object(s.t)({webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl,method:"POST",url:f(x),parseResponse:function(e){return e},qosName:"getFilterData",noRedirect:!0}))}))];case 1:a=S.sent();c=l.e.getFilterData(a,n.fieldInternalName||"",n.isCalculatedField);(m=new y.e({publisher:e})).resolveItems({items:(E={},E[o]=Object(r.__assign)({},i.he.pack(c)),E)});t(m.execute());return[2]}var x})})}})},function(e,t,n){"use strict";n.d(t,"e",function(){return m});n.d(t,"t",function(){return g});var r=n(0),i=n(165),s=n(6),o=n(8),u=n(198),a=n(755),f=n(1040),l=n(5),c=new l.e("userById",{id:Object(l.s)(),endpoint:Object(l.s)()}),h=n(158),p=n(3619),d=n(2868),v=n(2542);function m(e){var t,n=e.itemKey,l=e.driveItemKey,h=e.parentFolderItemKey,y=e.setItemKey,b=e.driveItemResponse,w=e.endpoint,E=e.getDriveItemFacets,S=void 0===E?v.e:E,x=e.shouldInvalidateItemSetOnChildItemRename,T=void 0===x?void 0:x,N=new u.e({publisher:m}),C=a.e.serialize({driveItemKey:l}),k=void 0;if(y){var L=Object(i.e)().forFacet(s.l).thenInvalidate(y,o.e).forFacet(s.M).thenInvalidate(y,o.e);T&&!T(w)||(L=L.forFacet(s.h).thenInvalidate(y,o.e));k=L.pack()}var A=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},S({driveItemKey:l,driveItem:b,endpoint:w,parentFolderItemKey:h})),s.e.pack({itemKey:C})),k);N.resolveItems({items:(t={},t[n]=A,t)});if(b.lastModifiedBy){if(D=b.lastModifiedBy.user){var O=D.id&&c.serialize({id:D.id,endpoint:w});if(O=D.email&&d.e.serialize({email:D.email,endpoint:w})){var M=g({itemKey:n,personFacet:s.A,userKey:O,user:D}).itemResolver;N.merge(M)}}}if(b.createdBy){var _=void 0;if((D=b.createdBy.user)&&D.email&&(_=d.e.serialize({email:D.email,endpoint:w}))){M=g({itemKey:n,personFacet:f.r,userKey:_,user:D}).itemResolver;N.merge(M)}}if(b.remoteItem&&b.remoteItem.shared&&b.remoteItem.shared.sharedBy&&b.remoteItem.shared.sharedBy.user){var D,P=void 0;if((D=b.remoteItem.shared.sharedBy.user).email&&(P=d.e.serialize({email:D.email,endpoint:w}))){M=g({itemKey:n,personFacet:p.e,userKey:P,user:D}).itemResolver;N.merge(M)}}return{itemResolver:N}}function g(e){var t,n,i=e.itemKey,o=e.personFacet,a=e.userKey,f=e.user,l=new u.e({publisher:g});l.resolveItems({items:Object(r.__assign)((t={},t[a]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},s.h.pack(f.displayName)),h.e.pack(f.email)),h.i.pack(f.id)),t),o&&(n={},n[i]=Object(r.__assign)({},o.pack({itemKey:a,displayValue:f.displayName})),n))});return{itemResolver:l}}}],Array(39),[function(e,t,n){"use strict";n.r(t);n.d(t,"uploadListItem",function(){return M});n.d(t,"mapConflictResolutionToNameConflictBehavior",function(){return _});var r=n(0),i=n(125),s=n(45),o=n(120),u=n(62),a=n(2537),f=n(2496),l=n(83),c=n(1),h=n(207),p=n(59),d=n(122),v=n(2156),m=n(155),g=n(2),y=n(74),b=n(386),w=n(137),E=n(266),S=n(6),x=n(29),T=n(162),N=n(2862),C=n(94),k=n(1415),L=n(53),A=Object(E.e)(function(){return new f.e({maxParallelUploads:1/0})}),O=function(e){return function(t){var n=t.demandItemFacet(c.lt,e);return!(n&&!u.t.hasItemPermission({permissions:n},u.t.editListItems))}};function M(e){var t=this,n=e.itemKey,f=e.options.sourceEntries,E=s.e.deserialize(n),M=E.webAbsoluteUrl,D=E.listFullUrl,P=Object.keys(f)[0],H=f[P],B=H.progressItemKey,j=H.conflictResolution;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,f,H,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie,se,oe,ue,ae,fe,le,ce,he,pe,de,ve,me;return Object(r.__generator)(this,function(ge){switch(ge.label){case 0:t=e(Object(l.n)({webAbsoluteUrl:M,listFullUrl:D})),f=t.dataRequestor,H=t.hasDigest;if(!t.hasTokenProvider)return[3,1];I=void 0;return[3,3];case 1:return[4,e(Object(l.e)({url:M||D,disallowCookies:!H}))];case 2:I=ge.sent();ge.label=3;case 3:F=I;if(!(q=e(Object(d.e)({sourceFile:v.t},P)).sourceFile))throw new L.e({code:"MissingSourceFileForUpload",message:"No source file for upload."});R=e(Object(d.e)({folderPath:c.pe},n)).folderPath;if(!(U=void 0===R?E.rootFolder:R))throw new L.e({code:"MissingTargetFolderPathForUpload",message:"No path information for target folder."});z=e(Object(w.e)((function(e,t){return function(t){var n=Object(C.e)(t,e);return 1024*(n&&n.maximumFileSize||Number.POSITIVE_INFINITY)*1024}})(n)));q.size>z&&Object(N.t)(z);W=Object(b.r)({webAbsoluteUrl:M,listOrItemFullUrl:D});X=new h.e(void 0);V=X.debounce(function(t){var n;B&&e(Object(m.e)({items:(n={},n[B]=Object(g.n)({progressSize:y.y},{progressSize:{current:t}}),n)}))},300,{leading:!1});$=o.e.serialize({webAbsoluteUrl:M,listFullUrl:D});J=e(Object(w.e)(function(e){return e.demandItemFacet(c.Re,$)}));K=!(!J||!J.contentTypesEnabled||J.templateType===x.t.mySiteDocumentLibrary);Q=_(j);G=e(Object(T.e)({clientName:p.t,combineStartFinish:c.wn})),Y=G.clientName,Z=G.combineStartFinish;ee=new a.e({authToken:F,onProgress:V,dataRequestor:f,combineStartFinish:Z,nameConflictBehavior:Q,webApiUrl:W,fileUpload:q,destinationUrl:U,appName:Y||"Unknown",throttler:e(A),canStream:e(Object(w.e)(O(n))),itemExpansion:K?"ListItemAllFields/ContentType/Fields":"ListItemAllFields"});B&&e(Object(m.e)({items:(he={},he[B]=Object(r.__assign)({},y.y.pack({total:q.size,current:0})),he)}));te=ee.upload();ne=e(Object(w.e)(function(e){return e.demandItemFacet(y.i,B)}));re=ne?ne.token.subscribe(function(){ee.abort()}):void 0;ge.label=4;case 4:ge.trys.push([4,6,7,8]);return[4,te];case 5:ie=ge.sent();return[3,8];case 6:se=ge.sent();ee.abort();B&&e(Object(m.e)({items:(pe={},pe[B]=Object(r.__assign)({},y.y.pack({total:q.size,current:0})),pe)}));throw e(Object(N.e)(se));case 7:re&&re();X.dispose();ee.dispose();return[7];case 8:oe=ie.ServerRelativeUrl;ue=ie.ServerRedirectedUrl;ae=ie.ListItemAllFields&&ie.ListItemAllFields.Id?String(ie.ListItemAllFields.Id):ie.ServerRelativeUrl;fe=s.e.serialize({webAbsoluteUrl:M,listFullUrl:D,itemId:ae});le=ie.UniqueId?i.e.normalizeLower(ie.UniqueId):"";ce=ie.Name;B&&e(Object(m.e)({items:(de={},de[B]=Object(r.__assign)({},S.h.pack(ce)),de)}));e(Object(k.e)({items:(ve={},ve[fe]=Object(r.__assign)({},c.lt.pack(u.t.openItems)),ve)}));e(Object(m.e)({items:(me={},me[fe]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},S.h.pack(ce)),le?c.bn.pack(le):{}),oe?c.pe.pack(oe):{}),ue?S.O.pack(ue):{}),S.M.pack({itemKey:n})),me)}));return[2,{itemKey:fe}]}})})}}function _(e){switch(e){case"replace":return 1;case"rename":return 2;default:return 0}}},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(1679),i=function(e){var t=e.replace(".",""),n=Object.keys(r.e);for(var i in n)if(r.e.hasOwnProperty(n[i])){var s=n[i];if(r.e[s].indexOf(t)>-1)return s}}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("coverImage")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("sharedBy")},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r,i;(function(e){e[e.MalwareDetected=0]="MalwareDetected";e[e.ThisFileIsCheckedOut=1]="ThisFileIsCheckedOut";e[e.DLPBlocked=2]="DLPBlocked";e[e.MissingMetaData=3]="MissingMetaData";e[e.DLPWarning=4]="DLPWarning";e[e.AwaitingApproval=5]="AwaitingApproval";e[e.Trending=6]="Trending";e[e.New=7]="New";e[e.NeedsRepublishing=8]="NeedsRepublishing"})(r||(r={}));(function(e){e[e.Mail=0]="Mail";e[e.CalendarEvent=1]="CalendarEvent";e[e.Teams=2]="Teams"})(i||(i={}))},function(e,t,n){"use strict";n.d(t,"n",function(){return i});n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n(5),i=new r.e("SharedByPersonKeyFacet",{displayName:Object(r.s)(),email:Object(r.s)()}),s=new r.e("dateSharedGroupKeyFacet",{relativeTime:Object(r.s)(),sharedDateTime:Object(r.s)()}),o=new r.e("relativeTimeGroupKeyFacet",{relativeTime:Object(r.s)()})},,function(e,t,n){"use strict";n.d(t,"e",function(){return g});var r=n(0),i=n(10),s=n(198),o=n(755),u=n(889),a=n(1790),f=n(2610),l=n(1289),c=n(335),h=n(165),p=n(3572),d=n(2868),v=n(82),m=n(6),g=Object(i.n)({maxParallelOperationCount:1,maxItemCountPerBatch:20,areSameBatch:function(e,t){var n=o.e.deserialize(e.itemKey).driveItemKey,r=n.endpoint,i=n.driveId,s=o.e.deserialize(t.itemKey).driveItemKey,u=s.endpoint,a=s.driveId;return!!i&&!!a&&i===a&&r===u}})(function e(t){var n=this,i=t.items;return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,p,d,g,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$;return Object(r.__generator)(this,function(J){switch(J.label){case 0:n=Object.keys(i);p=n[0];d=o.e.deserialize(p);g=d.driveItemKey,E=g.endpoint,S=g.driveId;if(!E)throw new Error("No endpoint to determine activity items.");x=n.map(function(e){return o.e.deserialize(e).driveItemKey.itemId});T=Object(u.n)({endpoint:(K=E,K.replace("2.1","2.0")),driveId:S});N=T+"/ExtendedActivitiesForItems";C={driveItems:x,badgeOnly:!0};return[4,t(Object(a.n)({url:N,method:"POST",body:C,qosName:"ItemActivityFieldDataSource.extendedActivitiesForItems",endpoint:E}))];case 1:if((k=J.sent()).value){L=(function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n],s=i.driveItemId;if(s){(t[s]||(t[s]=[])).push(i)}}return t})(k.value);A=0;O=0;M=0;_=0;D=new s.e({publisher:e});for(P=0,H=n;P<H.length;P++){B=H[P];A++;j=o.e.deserialize(B);F=j.driveItemKey.itemId;I=F&&L[F];q=v.e.serialize(j.driveItemKey);R=void 0;if(I){U=new f.e;z=U.processResponse({item:{name:F||"",relativePath:"",absolutePath:"",isFolder:!1,graphItemUrl:N},response:{value:I,"@odata.nextLink":""}}).activities;W=y(z);if(X=b(z)){M++;O++;if(!W){_++;V=w(X,B).itemResolver;D.merge(V);R=X}}}D.resolveItems({items:($={},$[B]=Object(r.__assign)({},l.e.pack(R)),$[q]=Object(r.__assign)({},Object(h.e)().forFacet(m.e).thenInvalidate(B,l.e).pack()),$)})}t(D.execute());t(Object(c.e)({name:"ItemActivityField.View",extraData:{activityFieldProcessedItemCount:A,activityFieldEligibleItemCount:O,activityFieldActiveItemCount:M,activityFieldBadgedItemCount:_,activityFieldBadgedPercent:A?Math.round(_/A*100):0},isIntentional:!1}))}return[2]}var K})})}});function y(e){var t=e[0];return!!t&&1===t.actors.length&&t.actors[0].self&&!t.type||!1}function b(e){var t=e[0],n={};if(t)for(var i=0,s=t.actors;i<s.length;i++){(l=s[i]).id&&(n[l.id]=!0)}for(var o=Object(r.__assign)(Object(r.__assign)({},t),{actors:Object(r.__spreadArrays)(t.actors||[])}),u=1;u<e.length;u++)for(var a=0,f=e[u].actors;a<f.length;a++){var l;if("string"==typeof(l=f[a]).id&&!n[l.id]){o.actors.push(l);n[l.id]=!0}}return o||t}function w(e,t){var n=new s.e({publisher:w}),i=o.e.deserialize(t).driveItemKey,u=(function(e){var t=e.actors,n=e.action.mention&&e.action.mention.mentionees||[],i=e.action.share&&e.action.share.recipients||[],s=e.action.commentResponse&&e.action.commentResponse.commentAuthor,o=Object(r.__spreadArrays)(t,n,i);s&&o.push(s);return o})(e);if(u.length>0){var a=E(u,i).itemResolver;n.merge(a)}return{itemResolver:n}}function E(e,t){for(var n=new s.e({publisher:E}),r=0,i=e;r<i.length;r++){var o=S(i[r],t).itemResolver;n.merge(o)}return{itemResolver:n}}function S(e,t){var n=new s.e({publisher:S}),r={itemKey:v.e.serialize(t),userKey:d.e.serialize({email:e.email||"",endpoint:t.endpoint}),user:{displayName:e.displayName,email:e.email}},i=Object(p.t)(r).itemResolver;n.merge(i);return{itemResolver:n}}},function(e,t,n){"use strict";n.d(t,"t",function(){return d});n.d(t,"e",function(){return v});var r=n(0),i=n(9),s=n(57),o=n(90),u=n(82),a=n(1029),f=n(8),l=n(155),c=n(3241),h=n(241),p=n(505),d=Object(i.t)()(function(){return function(e){return function(e,t){var n,i,o=Object(s.e)(e),f={},l=e.demandItemFacet(a.e,t.itemKey),d=e.demandItemFacet(u.e,t.itemKey),m=e.demandItemFacet(c.e,t.itemKey,{suppressGetItems:!0});if(m&&t.itemKey){i={driveItemKey:m,sortBy:"",isAscending:!0};var g=a.e.serialize(i);return Object(r.__assign)(Object(r.__assign)({},v(e,{itemSetKey:g,parentItemKey:u.e.serialize(i.driveItemKey),stageItem:t.stageItem})),{itemKey:h.e.serialize({localItemKey:t.itemKey,remoteItemKey:g})})}if(l){n=v(e,{itemSetKey:a.e.serialize(l),parentItemKey:u.e.serialize(l.driveItemKey),stageItem:t.stageItem});f={itemKey:t.itemKey}}else{f=(g=(i=(function(e,t){var n=t.folderItemKey,i=t.currentItemSetKey;if(i&&n){var s=e.demandItemFacet(a.e,i),o=e.demandItemFacet(u.e,n);if(s&&o){var f=o.endpoint,l=o.driveId,c=o.itemId;return Object(r.__assign)(Object(r.__assign)({},s),{driveItemKey:{endpoint:f,driveId:l,itemId:c}})}}return})(e,{folderItemKey:t.itemKey,currentItemSetKey:o}))?a.e.serialize(i):void 0)?{itemKey:g}:{};n=i&&g&&v(e,{itemSetKey:g,parentItemKey:u.e.serialize(i.driveItemKey),stageItem:t.stageItem})}var y=Object(p.e)(e),b=y?e.demandItemFacet(u.e,y.localItemKey):void 0;if(y&&(i||f||d)){var w=b&&b.driveId,E=l&&l.driveItemKey&&l.driveItemKey.driveId||d&&d.driveId,S=i?a.e.serialize(i):l?a.e.serialize(l):d?u.e.serialize(d):void 0;if(w!==E&&S)return Object(r.__assign)({itemKey:h.e.serialize({localItemKey:y.localItemKey,remoteItemKey:S})},n?{stageItem:n}:{})}return Object(r.__assign)(Object(r.__assign)({},f),n?{stageItem:n}:{})}}});function v(e,t){var n=this,i=t.parentItemKey,s=t.itemSetKey,u=t.stageItem;if(i)return u?Object(o.t)(function(e){var t=e.itemsScopeItemKey,o=e.currentItemKey;return function(e){return Object(r.__awaiter)(n,void 0,void 0,function(){var n;return Object(r.__generator)(this,function(a){switch(a.label){case 0:e(Object(l.e)({items:(n={},n[s]=Object(r.__assign)({},f.s.pack({itemKey:i})),n)}));return[4,e(u({currentItemKey:o,itemsScopeItemKey:t}))];case 1:a.sent();return[2]}})})}}):void 0}},function(e,t,n){"use strict";n.d(t,"e",function(){return v});n.d(t,"t",function(){return g});var r=n(9),i=n(82),s=n(2867),o=n(2990),u=n(3244),a=n(3242),f=n(154),l=n(6),c=n(889),h=n(594),p=n(249),d={ODC:"EnableCropModeFolderCoverThumbnail"},v=Object(r.t)()(function(){return function(e){return m}});function m(e,t){var n=t.itemKey,r=t.desiredSize,p=t.fitMode,d=e.demandItemFacet(i.e,n);if(!d)return{};var v=e.demandItemFacet(a.e,n)?(function(e,t){var n=t.itemKey,r=t.desiredSize,i=t.fitMode,o=g(e.demandItemFacet(s.e,n));if(o&&o.large)return{url:E(o.large.url,r,i),width:0,height:0}})(e,{itemKey:n,driveItem:d,desiredSize:r,fitMode:p}):(function(e,t){var n=t.itemKey,r=t.driveItem,i=t.desiredSize;if(r.endpoint.indexOf("/_api/v2.")>-1){var s=e.demandItemFacet(l.i,n),a=e.demandItemFacet(l.p,n,{suppressGetItems:!0})||"";if(s){var p=new f.e(r.endpoint).authority+"/_api/v2.1",d=o.e.serialize({endpoint:p,driveId:r.driveId}),v=e.demandItemFacet(u.e,d);if(v){var m=Object(c.t)({endpoint:p,driveId:r.driveId,itemId:r.itemId}),g=Math.ceil(i.width),y=Math.ceil(i.height);return{url:m+"/thumbnails/0/c"+g+"x"+y+"/content?"+Object(h.e)({prefer:"noredirect,closestavailablesize",cb:a,access_token:{uriValue:v}}),width:0,height:0}}}}})(e,{itemKey:n,driveItem:d,desiredSize:r});return v?{thumbnail:v}:{}}function g(e){return e&&((t=e)&&"number"==typeof t.length)?e[0]:e;var t}var y=/width=[0-9]*/,b=/height=[0-9]*/,w=/cropmode=[a-z]*/;function E(e,t,n){if(p.e.isFeatureEnabled(d)){var r="cover"===n?"center":"none";w.test(e)?e=e.replace(w,"cropmode="+r):e+=(e.indexOf("?")>-1?"&":"?")+"cropmode="+r}var i="number"==typeof t.width?Math.ceil(t.width):t.width,s="number"==typeof t.height?Math.ceil(t.height):t.height,o=""+(i||"");y.test(e)?e=e.replace(y,"width="+o):e+=(e.indexOf("?")>-1?"&":"?")+"width="+o;var u=""+(s||"");b.test(e)?e=e.replace(b,"height="+u):e+=(e.indexOf("?")>-1?"&":"?")+"height="+u;return e}},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(352),s=new r.e("saveUploadedTemplateToView"),o=Object(i.e)({operationTypeFacet:s})},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(17).e)("getDefaultShareLinkActionControl")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(17).e)("permissionInviteActionControl")},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(352),s=new r.e("reorderListItems"),o=Object(i.e)({operationTypeFacet:s})},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return g});var r=n(0),i=n("react-lib"),s=n(9),o=n(94),u=n(24),a=n(1265),f=n(27),l=n(39),c=n(331),h=n(2120),p=n(40),d=n(4051),v=n(25),m=n(1),g=Object(s.t)()(function(){return function(e){return function(e,t){var n=t.itemKeys[0],i=Object(f.e)(e,{graphTokenProvider:h.e,spRestTokenProvider:m.pn,logger:l.o}),s=i.graphTokenProvider,p=i.spRestTokenProvider,g=i.logger,b=Object(o.e)(e,n),w=b&&(b.env2||b.env),E=g&&g.scenarioId;return{initializeShareFrame:function(e){var t=e.parentElement,n=e.calloutProps,i=e.sharingInformation,o=e.onError,f=n.defaultRecipients,h=n.itemName,m=n.locale,g=n.mode,y=n.openManageAccess,b=n.theme,S=n.getClientId,x=n.enableWiderShareDialog,T=i.authToken,N=i.isListSharing,C=i.listId,k=i.serverRelativeItemUrl,L=i.shareItemKey,A=i.webAbsoluteUrl,O=S(),M={authToken:T||"",clientId:O,defaultRecipients:f,itemName:h,mode:Number(g),theme:b||Object(v.O)(),webAbsoluteUrl:A||""},_={};if(L&&a.e.matches(L)){var D=a.e.deserialize(L);_={listId:D.listId,uniqueId:D.uniqueId,webAbsoluteUrl:D.webAbsoluteUrl}}else{var P=""+new c.e(A).authority+k;N&&O===l.e[l.e.listsHome]&&(E="list");_={isListSharing:N,itemUrl:P,listId:C,scenarioId:E}}new d.e({element:t,environment:w||u.e.prod,locale:m,context:Object(r.__assign)(Object(r.__assign)({},M),_),options:{onError:o,openManageAccess:y,graphTokenProvider:s,spRestTokenProvider:p},styles:{minWidth:x&&t.offsetWidth>=480?"480px":void 0}}).initializeUI()},sharingIFrameAs:y}}}}),y=Object(p.t)(function(e,t){var n=t.defaultRender,s=Object(r.__rest)(t,["defaultRender"]),o=s.enableWiderShareDialog,a=Object(f.e)(e,{enableWiderShareDialog:u.S}).enableWiderShareDialog,l=void 0!==a&&a;return n?i.createElement(n,Object(r.__assign)({},s,{enableWiderShareDialog:void 0===o?l:o})):null})},,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(17).e)("removeFromShardListActionControl")},,,,function(e,t,n){"use strict";n.r(t);n.d(t,"CACHE_EXPIREATION_TIME",function(){return d});n.d(t,"LICENSE_CACHE_KEY",function(){return v});n.d(t,"universalPrintLicenseCheckOperationHandler",function(){return m});var r=n(0),i=n(198),s=n(162),o=n(10),u=n(786),a=n(1138),f=n(566),l=n(59),c=n(1790),h=n(2780),p=n(2017),d=6048e5,v="licenseinfo",m=Object(o.i)()(function e(t){var n=this;return function(o){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,m,g,y,b,w,E,S,x,T,N,C,k,L,A;return Object(r.__generator)(this,function(O){switch(O.label){case 0:n=t.itemKey;m=o(Object(s.e)({universalPrintLicenseCache:a.e})).universalPrintLicenseCache;if(void 0!==(g=null===(L=m)||void 0===L?void 0:L.getValue(v))){(N=new i.e({publisher:e})).resolveItems({items:(C={},C[n]=Object(r.__assign)({},u.e.pack(g.hasValidLicense)),C)});o(N.execute())}if(!(void 0===g||!g.lastModified||!g.hasValidLicense&&Date.now()-g.lastModified>=d))return[3,3];y=o(Object(s.e)({graphEndpoint:l.v})).graphEndpoint;b=o(c.e).dataRequestor;w=new h.e({},{dataRequestor:b});E=f.e.deserialize(n);S=y||E.graphEndpoint;return[4,o(Object(p.getSessionToken)(S))];case 1:x=O.sent();return[4,w.hasValidUniversalPrintLicense({endpoint:S,accessToken:x})];case 2:T=O.sent();m&&m.setValue(v,{hasValidLicense:T,lastModified:Date.now()});if((null===(A=g)||void 0===A?void 0:A.hasValidLicense)!==T){(N=new i.e({publisher:e})).resolveItems({items:(k={},k[n]=Object(r.__assign)({},u.e.pack(T)),k)});o(N.execute())}O.label=3;case 3:return[2]}})})}})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});n.d(t,"t",function(){return f});var r=n(0),i=n(204),s=n(363),o=n(611),u=n(2879),a=function(e,t,n){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,fetch(e,{mode:"cors"})];case 1:return(i=r.sent()).ok?[4,i.blob()]:[3,3];case 2:o=r.sent();return[2,new File([o],t,{type:n})];case 3:throw new s.e({facets:u.e.pack(i.status)})}})})},f=function(e){var t=Object(o.t)(e,function(e,t){switch(e){case"unauthenticated":case"401":case 401:return i.r.pack({});case"itemNotFound":case"404":case 404:return i.p.pack({});case"accessDenied":case"403":case 403:return i.e.pack({});case"offline":return i.y.pack({})}});throw new s.e({innerError:e,facets:t})}},,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return o});n.d(t,"e",function(){return u});var r=n(2),i=n(112),s=n(8),o=new r.e("expiryDate"),u=new i.e("expiringUserCount",function(e,t){var n=t.itemKey,r=e.demandItemFacet(s.e,n);if(r){var i=new Date;i.setDate(i.getDate()+21);for(var u=i.getTime(),a=0,f=0,l=r.itemKeys;f<l.length;f++){var c=l[f],h=e.demandItemFacet(o,c);h&&h<u&&a++}return a}})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(17).e)("itemAutoRefreshControl")},,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n("react-lib"),s=n(30),o=n(40),u=Object(o.t)(function(e,t){return i.createElement(s.e,{onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(n){e=null;t.selector?e=document.querySelector(t.selector):t.elementId&&(e=document.getElementById(t.elementId));if(e){e.focus();t.shouldClick&&e.click&&e.click()}return[2]})})},engagement:{name:"SetFocus",isIntentional:!0}})})}],Array(52),[function(e,t,n){"use strict";n.d(t,"e",function(){return g});n.d(t,"t",function(){return y});var r=n(0),i=n(82),s=n(10),o=n(137),u=n(889),a=n(1790),f=n(379),l=n(780),c=n(6),h=n(132),p=n(204),d=n(363),v=n(611),m=n(2),g=Object(s.i)({mergeForSameItemKey:!1})(function(e){return function(t){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,t(y(e))];case 1:n.sent();return[2]}})})}});function y(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,g,y,w,E,S,x,T,N,C,k,L;return Object(r.__generator)(this,function(A){switch(A.label){case 0:t=e.itemKey;s=i.e.deserialize(t);g=n(Object(o.e)(function(e){return e.demandItem({folder:c.m,oneNote:h.i,driveItem:i.e},t)}));y=!!g.folder||!!g.oneNote;w=Object(u.t)(s);E={};y&&(E.Prefer="respond-async");return[4,n(Object(a.n)({url:w,method:"DELETE",qosName:"deleteItemVroom",endpoint:s.endpoint,headers:E,parseResponse:function(e){return e.getResponseHeader("Location")||""}})).catch(function(e){if(e instanceof v.e)throw new d.e({innerError:e,facets:Object(r.__assign)({},Object(v.t)(e,b)||Object(m.n)({},{}))});throw new d.e({innerError:e})})];case 1:if(""===(S=A.sent()))return[3,12];x=!1;T=!1;N=void 0;Object(f.t)(6e5).then(function(){return T=!1}).catch();A.label=2;case 2:A.trys.push([2,4,,7]);return[4,n(Object(a.n)({url:S,qosName:"getDeleteOperationStatus",endpoint:s.endpoint}))];case 3:N=A.sent();return[3,7];case 4:if(!((C=A.sent())instanceof v.e))return[3,6];k=Object(r.__assign)({},Object(v.t)(C,b)||Object(m.n)({},{}));return Object(m.r)({autoRetryError:p.i},k).autoRetryError?[4,Object(f.t)(6e3)]:[3,6];case 5:A.sent();return[3,10];case 6:throw new d.e({innerError:C});case 7:if(!N||void 0!==N.percentComplete&&"Completed"!==N.status&&"Failed"!==N.status)return[3,8];x=!0;return[3,10];case 8:return[4,Object(f.t)(3e3)];case 9:A.sent();A.label=10;case 10:if(!x&&!T)return[3,2];A.label=11;case 11:if(!x)throw new d.e({facets:Object(r.__assign)({},p.c.pack(408))});A.label=12;case 12:n(Object(l.e)({items:(L={},L[t]=[c.l],L)}));return[2]}})})}}function b(e){switch(e){case"nameAlreadyExists":case 409:return Object(r.__assign)({},p.b.pack({}));case 0:return Object(r.__assign)({},p.i.pack({}))}}}],Array(154),[function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointBasicItemDataAddonDeferred",function(){return s});var r=n(10),i=n(2554),s=Object(r.t)(function(){return function(e){e(i.e)}})}],Array(15),[function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n("react-lib"),i=n(338),s=n(2),o=n(3651),u={key:new s.e("GetNPSSurveyFocusShortcut").id,automationId:"GetNPSSurveyFocusShortcut",shortcutProps:{keySequences:["AltDown"],content:i.o},action:r.createElement(o.e,{elementId:"obf-TPromptContainer"})}}],Array(161),[function(e,t,n){"use strict";n.r(t);n.d(t,"spItemUploadItemsOperationHandler",function(){return mn.spItemUploadItemsOperationHandler});n.d(t,"spItemCreateFolderOperationHandler",function(){return gn.spItemCreateFolderOperationHandler});n.d(t,"spItemCreateDocumentOperationHandler",function(){return yn.spItemCreateDocumentOperationHandler});n.d(t,"getSPFilterOptionSetHandler",function(){return ge.getSPFilterOptionSetHandler});n.d(t,"spDataOnlyAddonDeferred",function(){return Hn});var r,i=n(0),s=n(10),o=n(217),u=n(1062),a=n(349),f=n(1095),l=n(1244),c=n(45),h=n(800),p=n(1240),d=n(65),v=n(797),m=n(1241),g=n(1256),y=n(1255),b=n(950),w=n(798),E=n(120),S=n(3248),x=n(3246),T=n(2871),N=n(3403),C=n(3404),k=n(2864),L=n(2774),A=n(2185),O=n(3405),M=n(3249),_=n(3406),D=n(322),P=n(925),H=n(2),B=n(352);(function(e){e[e.preview=0]="preview";e[e.save=1]="save"})(r||(r={}));var j=new H.e("updateColumnFormatter"),F=(Object(B.e)({operationTypeFacet:j}),n(1317)),I=n(1325),q=n(1259),R=n(1),U=n(83),z=n(198),W=n(1550),X=n(24),V=n(137),$=n(147),J=n(594),K=n(386),Q=Object(s.i)({maxParallelOperationCount:4})(function(e){var t=this,n=e.itemKey,r=q.e.deserialize(n).tenantRootUrl;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,l,c,h,p,d,v;return Object(i.__generator)(this,function(m){switch(m.label){case 0:t=b.e.serialize({webAbsoluteUrl:r});return[4,n(Object(W.e)(function(e){return e.demandItemFacet(R.ut,t)}))];case 1:s=m.sent();o=n(Object(V.e)(function(e){return e.demandItemFacet(X.T,$.e)}));u=!s;f=o&&o.language||"en-US";l=Object(J.e)({Locale:f,v:2,msajax:1,cv:2});a=u?r+"/_layouts/15/online/handlers/SpoSuiteLinks.ashx?"+l:Object(K.n)({webAbsoluteUrl:r}).segments("Microsoft.SharePoint.Portal.SuiteNavData.GetSuiteNavData").parameters({v:2,Locale:f});return[4,n(Object(U.t)({url:a.toString(),qosName:"LoadData",method:"POST",webAbsoluteUrl:r,noRedirect:!0}))];case 2:c=m.sent();h=u?c:JSON.parse(c.d.GetSuiteNavData);p=!(!h.NavBarData||!h.NavBarData.AdminLink)||void 0;(d=new z.e).resolveItems({items:(v={},v[e.itemKey]=Object(i.__assign)({},R.vn.pack(p)),v)});n(d.execute());return[2]}})})}});var G=Object(s.t)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){e(Object(o.r)(q.e,a.e)(Q));return[2]})})}}),Y=n(2872),Z=n(155),ee=n(944),te=n(8),ne=n(121),re=n(75),ie=n(1195),se={ODB:1855},oe=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.formatterMap;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c;return Object(i.__generator)(this,function(h){switch(h.label){case 0:r=Object.keys(n)[0];s=n[r],o=s.updateType,u=s.formatter;return 0!==o?[3,1]:[2,e(Object(Z.e)({items:(l={},l[r]=Object(i.__assign)({},R.g.pack(u)),l)}))];case 1:return 2!==o?[3,4]:[4,e(Object(W.e)(function(e){e.demandItemFacet(ne.e,ne.t.serialize({}))}))];case 2:h.sent();a=!1;f={};return[4,e(Object(W.e)(function(e){if(a=Object(re.e)(e,{feature:se})){var n=e.demandItem({schema:te.o},t).schema,r=n&&n.columnKeys;r&&(f=Object(ie.e)(e,r))}}))];case 3:h.sent();return[2,e(Object(Z.e)({items:(c={},c[r]=Object(i.__assign)({},R.xn.pack(Object(ee.e)({formatter:u,fieldFormatters:f,columnFormatterReferenceProps:{columnFormatterReferenceEnabled:a}}))),c)}))];case 4:return[2]}})})}}),ue=new H.e("modifyFieldProperties"),ae=(Object(B.e)({operationTypeFacet:ue}),n(122)),fe=n(458),le=n(6),ce=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.fields;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c,h;return Object(i.__generator)(this,function(p){r=Object.keys(n)[0];s=n[r],o=s.displayName,u=s.fieldDescription,a=s.showInFiltersPane;if((f=e(Object(ae.e)({setKey:d.e},t)).setKey)&&r&&(l=e(Object(ae.e)({id:R.le},r)).id)){c={__metadata:{type:"SP.Field"},Title:o,SchemaXml:u,ShowInFiltersPane:a};h=Object(K.e)({webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl}).method("Fields",l).toString();return[2,e(Object(U.t)({webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl,url:h,qosName:"modifyFieldProperties",body:JSON.stringify(c),method:"POST",additionalHeaders:{"X-HTTP-Method":"MERGE"}})).then(function(){var t;return e(Object(Z.e)({items:(t={},t[r]=Object(i.__assign)(Object(i.__assign)({},void 0!==a?fe.n.pack(a):{}),void 0!==o?le.h.pack(o):{}),t)}))})]}return[2]})})}}),he=n(190),pe=n(1173),de=n(301),ve=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=l.e.deserialize(n),s={webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,rootFolder:"",viewKey:{viewId:pe.e}};return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,o;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e(Object(he.n)({itemSetKey:s}));return[4,e(Object(he.t)({itemSetKey:s,contentTypes:t,qosName:"getNeedsAttentionFlag"}))];case 1:r=i.sent();i.label=2;case 2:i.trys.push([2,5,,7]);return[4,e(Object(de.e)({getItemContext:r}))];case 3:o=i.sent();return[4,e(me(o,n))];case 4:i.sent();return[3,7];case 5:i.sent();return[4,e(me(void 0,n))];case 6:i.sent();return[3,7];case 7:return[2]}})})}});function me(e,t){var n=this;return function(r){return Object(i.__awaiter)(n,void 0,void 0,function(){var n,s,o,u;return Object(i.__generator)(this,function(a){n=!1;(s=e&&e.ListData&&e.ListData.Row)&&s.length>0&&s[0]&&(n=!0);(o=new z.e({publisher:me})).resolveItems({items:(u={},u[t]=Object(i.__assign)({},le.L.pack(n||void 0)),u)});r(o.execute());return[2]})})}}var ge=n(3571),ye=n(363),be=n(39),we=n(125),Ee=n(1860),Se=Object(s.n)()(function(e){var t=e.items;return function(n){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,o,u,a,f,l,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O;return Object(i.__generator)(this,function(M){switch(M.label){case 0:r=void 0;o=void 0;for(u=0,a=Object.keys(t);u<a.length;u++){m=a[u];f=n(Object(ae.e)({key:c.e,folderPath:R.pe},m));l=e.items[m];if(f&&f.key&&f.folderPath){if(!r){o=f.key.listFullUrl;r={webAbsoluteUrl:f.key.webAbsoluteUrl,items:[],checkInOutType:l.checkInOutType,checkInText:l.checkInText,checkInVersionType:l.checkInVersionType};o=f.key.listFullUrl}r.items.push({key:m,itemFullUrl:f.folderPath})}}if(!(h=r)||!h.items.length)return[3,4];p=h.items.length>1;d=void 0;d="checkIn"===h.checkInOutType?p?"batchCheckInItems":"CheckInItem":"checkOut"===h.checkInOutType?p?"batchCheckOutItems":"CheckOutItem":p?"batchUndoCheckOutItems":"UndoCheckOutItem";v="checkOut"===h.checkInOutType;if(p)return[3,2];m=h.items[0].key;g=xe(h.webAbsoluteUrl,h.items[0].itemFullUrl,h.checkInOutType,h.checkInText,h.checkInVersionType);return[4,n(Object(U.t)({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:o,url:g,method:"POST",qosName:d}))];case 1:M.sent();n(Object(Z.e)({items:(A={},A[m]=Object(i.__assign)({},le.w.pack({byYou:!!v,byOther:void 0})),A)}));return[3,4];case 2:y=we.e.generate();b="multipart/mixed; boundary=batch_"+y;return[4,n(Object(U.t)({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:o,url:Ee.t.getBatchOperationUrl(h.webAbsoluteUrl),body:Te(h,y),method:"POST",additionalHeaders:void 0,contentType:b,parseResponse:function(e){return Ee.t.processBatchResponse(e,h.items)},qosName:"batch",telemetryHandler:function(e){var t=e.response,n=e.eventData;return t&&n.resultType===be.t.success?{eventData:Object(i.__assign)(Object(i.__assign)({},n),{resultType:t.hasError?be.t.failure:be.t.success})}:{eventData:n}}}))];case 3:if((w=M.sent()).hasError){N={items:{}};for(C=0,k=w.items;C<k.length;C++)(L=k[C]).error&&L.key&&(N.items[L.key]=new ye.e({message:L.error.message}));throw new s.e(N)}E=new z.e;for(S=0,x=h.items;S<x.length;S++){T=x[S];E.resolveItems({items:(O={},O[T.key]=Object(i.__assign)({},le.w.pack({byYou:!!v,byOther:void 0})),O)})}n(E.execute());M.label=4;case 4:return[2]}})})}});function xe(e,t,n,r,i){var s;s="checkIn"===n?"CheckIn":"undoCheckOut"===n?"UndoCheckOut":"CheckOut";var o=Object(K.r)({webAbsoluteUrl:e,listOrItemFullUrl:t}).methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t});return(o="checkIn"===n?o.methodWithAliases("CheckIn",{comment:r,checkintype:i||0}):o.segment(s)).toString()}function Te(e,t){var n=e.items,r=Ee.t.defaultBatchRequestPostData,i=n.map(function(t){return xe(e.webAbsoluteUrl,t.itemFullUrl,e.checkInOutType,e.checkInText,e.checkInVersionType)});return Ee.t.getBatchContentExtended(t,i,"POST",r)}var Ne=n(2369),Ce=n(2556),ke=Object(s.n)()(function(e){var t=e.items;return function(n){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,h,p,d,v,m,g,y,b,w,E,S,x,T,N;return Object(i.__generator)(this,function(C){switch(C.label){case 0:r=void 0;s=void 0;o="";u=!0;for(a=0,f=Object.keys(t);a<f.length;a++){S=f[a];l=n(Object(ae.e)({key:c.e,folderPath:R.pe},S));h=n(Object(ae.e)({key:c.e,uiVersion:R.gn,contentTypeId:R.d},S)),p=h.uiVersion,d=h.contentTypeId;o=Ce.t(p);u=Ce.i(d);v=e.items[S];m=n(Object(ae.e)({listItemId:R.We},S)).listItemId;if(l&&l.key&&l.folderPath){if(!r){s=l.key.listFullUrl;r={webAbsoluteUrl:l.key.webAbsoluteUrl,items:[],publishActionType:v.publishActionType,publishText:v.publishText};s=l.key.listFullUrl}r.items.push({key:S,itemFullUrl:l.folderPath,listItemId:m})}}if(!(g=r)||!g.items.length)return[3,4];y=g.publishActionType===Ne.e.SchedulePublish;b=y?"ScheduleItem":"PublishItem";w=0;C.label=1;case 1:if(!(w<g.items.length))return[3,4];E=g.items[w];S=E.key;x=u&&g.publishActionType!==Ne.e.CancelApproval;T=x?(function(e,t,n){return e+"/_api/sitepages/pages("+t+")/"+(n?"schedulepublish":"publish")})(g.webAbsoluteUrl,E.listItemId,y):(function(e,t,n){var r="Publish";n&&n===Ne.e.CancelApproval&&(r="UnPublish");var i=Object(K.r)({webAbsoluteUrl:e,listOrItemFullUrl:t}).methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t});return(i=i.segment(r)).toString()})(g.webAbsoluteUrl,g.items[0].itemFullUrl,g.publishActionType);return[4,n(Object(U.t)({webAbsoluteUrl:g.webAbsoluteUrl,listFullUrl:s,url:T,body:!y&&x?'{"__metadata":{"type":"SP.Publishing.SitePage"}}':"",method:"POST",qosName:b}))];case 2:C.sent();""!==o&&n(Object(Z.e)({items:(N={},N[S]=Object(i.__assign)({},R.gn.pack(o)),N)}));C.label=3;case 3:w++;return[3,1];case 4:return[2]}})})}});var Le=n(780),Ae=n(2772),Oe=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(Object(Ae.e)(t))];case 1:r=i.sent(),s=r.key,o=r.itemId;u=s.webAbsoluteUrl,a=s.listFullUrl;f=E.e.serialize({webAbsoluteUrl:u,listFullUrl:a});return(l=e(Object(V.e)(function(e){return e.demandItemFacet(R.Re,f)})))&&l.id&&o?[4,e(Object(U.t)({webAbsoluteUrl:u,listFullUrl:a,url:Object(K.n)({webAbsoluteUrl:u}).methodWithAliases("Microsoft.Office.Server.ReputationModel.Reputation.SetRating",{listID:l.id,itemID:o,rating:n.userNewRating}).toString(),method:"POST",qosName:"updateRating"}))]:[3,3];case 2:i.sent();e(Object(Le.e)({items:(c={},c[t]=[le.h],c)}));i.label=3;case 3:return[2]}})})}}),Me=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(Object(Ae.e)(t))];case 1:r=i.sent(),s=r.key,o=r.itemId;u=s.webAbsoluteUrl,a=s.listFullUrl;f=E.e.serialize({webAbsoluteUrl:u,listFullUrl:a});return(l=e(Object(V.e)(function(e){return e.demandItemFacet(R.Re,f)})))&&l.id&&o?[4,e(Object(U.t)({webAbsoluteUrl:u,listFullUrl:a,url:Object(K.n)({webAbsoluteUrl:u}).methodWithAliases("Microsoft.Office.Server.ReputationModel.Reputation.SetLike",{listID:l.id,itemID:o,like:n.liked}).toString(),method:"POST",qosName:"updateLikes"}))]:[3,3];case 2:i.sent();e(Object(Le.e)({items:(c={},c[t]=[le.h],c)}));i.label=3;case 3:return[2]}})})}}),_e=n(154),De=n(88),Pe=Object(s.i)({maxParallelOperationCount:4})(function(e){var t=this,n=e.itemKey,r=e.options,s=r.newDocumentKey,o=r.extension;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,u,a,f;return Object(i.__generator)(this,function(l){switch(l.label){case 0:t=c.e.deserialize(n);r=t.rootFolder||new _e.e(t.listFullUrl).path;u=new De.t({context:{webAbsoluteUrl:t.webAbsoluteUrl,listUrl:t.listFullUrl}});a=u.getUrlParts({path:r});f=a.fullItemUrl;return[4,e(Object(U.t)({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,url:He({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,parentFolderPath:a.listRelativeItemUrl||"",extension:o}),method:"POST",parseResponse:function(e){return JSON.parse(e)},qosName:"createCustomDocument",noRedirect:!0})).then(function(t){var r,o,u=t&&t.d&&t.d.CreateDocumentWithDefaultName;if(!u)throw"Fail to create custom document";var a=f+"/"+u;e(Object(Z.e)({items:(r={},r[s]=Object(i.__assign)(Object(i.__assign)({},le.h.pack(u)),le.i.pack(a)),r)}));e(Object(Le.e)({items:(o={},o[n]=[te.t],o)}))})];case 1:l.sent();return[2]}})})}});function He(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.extension,i=e.parentFolderPath;if(!r)throw new Error("document extension is not valid");return Object(K.e)({webAbsoluteUrl:t,listFullUrl:n}).methodWithAliases("CreateDocumentWithDefaultName",{folderPath:i,extension:r}).toString()}var Be=n(3359),je=n(210),Fe=n(330),Ie=n(2121),qe=n(556);function Re(e){var t=e.sourceView,n=e.deserializedItemSetKey,r=e.appliedFilters,i=new Fe.e(t.getEffectiveViewXml());n.sortFieldKey&&i.updateSort({fieldName:n.sortFieldKey,isAscending:n.sortAscending},{overwriteAll:!0});n.groupByFieldKey&&i.updateGroupBy({group1:{fieldName:n.groupByFieldKey,isAscending:!0}});if(r)for(var s in r)if(r.hasOwnProperty(s)){var o=r[s];Ie.updateFilter(i,o)}try{var u=Object(qe.e)(t.id,!0);if(u){i.updateColumnWidths(u);Object(qe.t)(t.id)}}catch(e){}return i}var Ue=n(162),ze=n(70),We=n(94),Xe=Object(s.i)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=e.itemKey,n=e.options.views;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c,h,v,m,g,y,b,w,E,S,x,T,N,C,k,A,O,M,_,D,P;return Object(i.__generator)(this,function(H){r=p.e.deserialize(t);s=Object.keys(n)[0];o=n[s],u=o.sourceView,a=o.isPublic,f=o.itemSetKey,l=o.progressItemKey;if(u&&r){c=e(Object(ae.e)({deserializedItemSetKey:d.e,filterableSet:R.Wt,childItems:te.e,parentItem:te.s,schema:te.o},f)),h=c.deserializedItemSetKey,v=c.filterableSet,m=c.childItems,g=c.parentItem,y=c.schema;b=h&&h.viewKey&&je.e.serialize(h.viewKey)||"";w=e(Object(ae.e)({viewType:R.Tn},b)).viewType;(E=h?Re({sourceView:u,deserializedItemSetKey:h,appliedFilters:v&&v.appliedFilters}):u).prepareForSaving();S=e(Object(V.e)(function(e){return Object(We.e)(e,f)}));x=S&&Object(ze.n)(S).isActivated("E05C14DE-D6D7-4E39-9616-2D192123BAC3","2/1/21","Include ViewTypeKind in payload");T=w&&Fe.e.getViewTypeInfo(w);N=!x&&T?T.viewTypeKind:void 0;C=T?T.viewType2:void 0;k=Object(K.e)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}).segment("Views").segment("Add");_=u.getEffectiveAggregatesFieldXml();D=u.viewData,P=u.customFormatter;return[2,e(Object(U.t)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,url:k.toString(),method:"POST",body:JSON.stringify({parameters:Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({__metadata:{type:"SP.ViewCreationInformation"},Title:s,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:u.getEffectiveFieldNames()},Query:E.getEffectiveQueryXml(!1),Paged:!0,PersonalView:!a,RowLimit:u.rowLimit},N?{ViewTypeKind:N}:{}),C?{ViewType2:w}:{}),{ViewData:D})}),qosName:"addView",noRedirect:!0})).then(function(t){var n,r,s;if(!t||!t.d)throw new Error("No view returned by /Views/Add");var o=t.d;O={viewId:we.e.normalizeLower(o.Id,!1)};A=new Fe.e(t.d);Object(qe.n)(A);var u=new z.e;u.resolveItems({items:(n={},n[je.e.serialize(O)]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},je.e.pack(O)),R.kt.pack(o)),R.m.pack(A)),R.Ot.pack(!1)),n)});if(h){M=d.e.serialize(Object(i.__assign)(Object(i.__assign)({},h),{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0,viewKey:O}));u.resolveItems({items:(r={},r[M]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},m?te.e.pack(m):{}),g?te.s.pack(g):{}),y?te.o.pack(y):{}),r)})}l&&u.resolveItems({items:(s={},s[l]=Object(i.__assign)({},je.e.pack(O)),s)});return e(u.execute())}).then(function(){var n,r;if(u.scope||_||P){var s={};u.scope&&(s.scope=u.scope);e(Object(Ue.e)({enableModernColumnTotalsSettings:R.U})).enableModernColumnTotalsSettings&&_&&(s.aggregations=_);P&&(s.customFormatter=P);return e(Object(L.e)({items:(n={},n[t]={views:(r={},r[A.id]=Object(i.__assign)({},s),r)},n)}))}}).then(function(){var n,r;return e(Object(Le.e)({items:Object(i.__assign)((n={},n[t]=[te.e],n),_?(r={},r[je.e.serialize(O)]=[R.Pt],r):{})}))})]}return[2]})})}}),Ve=Object(s.i)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=e.itemKey,n=e.options.views;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c,h,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M;return Object(i.__generator)(this,function(_){r=p.e.deserialize(t);s=Object.keys(n)[0];o=n[s],u=o.isPublic,a=o.viewType,f=o.viewFields,l=o.viewStyles,c=o.viewData,h=o.queryXml,v=o.rowLimit,m=o.itemSetKey,g=o.progressItemKey,y=o.customFormatterString;if(r){b=e(Object(ae.e)({deserializedItemSetKey:d.e,childItems:te.e,parentItem:te.s,schema:te.o},m)),w=b.deserializedItemSetKey,E=b.childItems,S=b.parentItem;x=a&&Fe.e.getViewTypeInfo(a);T=x?x.viewTypeKind:void 0;N=x?x.viewType2:void 0;C=Object(K.e)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl});k=C.segment("Views").segment("Add");return[2,e(Object(U.t)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,url:k.toString(),method:"POST",body:JSON.stringify({parameters:Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({__metadata:{type:"SP.ViewCreationInformation"},Title:s,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:f}},T?{ViewTypeKind:T}:{}),N?{ViewType2:N}:{}),{ViewData:c,CalendarViewStyles:l,Query:h,Paged:!0,PersonalView:!u,RowLimit:v})}),qosName:"CreateFreshView",noRedirect:!0})).then(function(t){var n,r,s;if(!t||!t.d)throw new Error("No view returned by /Views/Add");var o=t.d;A=we.e.normalizeLower(o.Id,!1);O={viewId:A};L=new Fe.e(o);Object(qe.n)(L);var u=new z.e;u.resolveItems({items:(n={},n[je.e.serialize(O)]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},je.e.pack(O)),R.kt.pack(o)),R.m.pack(L)),R.Ot.pack(!1)),n)});if(w){M=d.e.serialize(Object(i.__assign)(Object(i.__assign)({},w),{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0,viewKey:O}));u.resolveItems({items:(r={},r[M]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},E?te.e.pack(E):{}),S?te.s.pack(S):{}),te.o.pack({columnKeys:[]})),r)})}g&&u.resolveItems({items:(s={},s[g]=Object(i.__assign)({},je.e.pack(O)),s)});return e(u.execute())}).then(function(){if(y&&L.baseViewXml){var t=C.method("Views",A).method("SetViewXml");L.updateCustomFormatter(y);L.prepareForSaving();return e(Object(U.t)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,url:t.toString(),method:"POST",body:JSON.stringify({viewXml:L.getEffectiveViewXml()}),qosName:"saveViewXML"}))}return Promise.resolve()}).then(function(){var n;return e(Object(Le.e)({items:(n={},n[t]=[te.e],n)}))})]}return[2]})})}}),$e=n(573),Je=Object(s.i)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=e.itemKey,n=e.options.views;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c,h,d,v;return Object(i.__generator)(this,function(i){r=p.e.deserialize(t);s=Object.keys(n)[0];o=n[s],u=o.viewXml,a=o.viewTitle;if(r){f=r.webAbsoluteUrl,l=r.listFullUrl;c=Object(K.e)({webAbsoluteUrl:f,listFullUrl:l});h=c.method("Views",s);d=e(Object(V.e)(function(e){return f&&l?e.demandItemFacet(R.un,$e.e.serialize({webAbsoluteUrl:f,listFullUrl:l})):void 0}));v=!!d&&!Object(ze.n)(d).isActivated("D554A99B-07B1-4652-8A7E-940F6CD0EE85","01/08/2021","Enable updating View Title in Edit view dialog");return[2,e(Object(U.t)({webAbsoluteUrl:f,listFullUrl:l,url:h.method("SetViewXml").toString(),method:"POST",body:JSON.stringify({viewXml:u}),qosName:"saveViewXML"})).then(function(){v&&a&&e(Object(U.t)({webAbsoluteUrl:f,listFullUrl:l,url:h.toString(),method:"MERGE",body:JSON.stringify({__metadata:{type:"SP.View"},Title:a}),qosName:"updateViewTitle"}))})]}return[2]})})}}),Ke=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.views,r=p.e.deserialize(t),s=Object.keys(n)[0];return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var o,u,a;return Object(i.__generator)(this,function(f){if(r&&s){o=n[s];u=Object(K.e)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}).method("Views",s);a={__metadata:{type:"SP.View"},DefaultView:o.isDefault,Title:o.title};"number"==typeof o.scope&&(a.Scope=o.scope);if(o.aggregations){a.Aggregations=o.aggregations;a.AggregationsStatus="On"}o.customFormatter&&(a.CustomFormatter="<![CDATA["+o.customFormatter+"]]>");return[2,e(Object(U.t)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,url:u.toString(),method:"POST",body:JSON.stringify(a),additionalHeaders:{"X-HTTP-Method":"PATCH"},qosName:"modifyView"})).then(function(){var n,r,u=e(Object(ae.e)({childItems:te.e},t)).childItems;if(u){for(var a=new z.e,f=je.e.serialize({viewId:s}),l=void 0,c=void 0,h=void 0,p=0,d=u.itemKeys;p<d.length;p++){var v=d[p],m=e(Object(ae.e)({view:R.m},v)).view;if(m){if(m.isDefault){l=m;c=v}v===f&&(h=m)}}if("boolean"==typeof o.isDefault){if(o.isDefault&&l&&c){l.isDefault=!1;a.resolveItems({items:(n={},n[c]=Object(i.__assign)({},R.m.pack(l)),n)})}if(h&&f){h.isDefault=o.isDefault;a.resolveItems({items:(r={},r[f]=Object(i.__assign)({},R.m.pack(h)),r)})}}return e(a.execute())}})]}return[2]})})}}),Qe=n(1174),Ge=n(158),Ye={key:Qe.e,displayName:le.h,email:Ge.e,picture:Ge.r},Ze=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=m.e.deserialize(n),s=r&&r.spItem,o=s.webAbsoluteUrl,u=s.listFullUrl,a=s.itemId;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,s,f,l,c,h;return Object(i.__generator)(this,function(p){switch(p.label){case 0:t=a&&Object(K.e)({webAbsoluteUrl:o,listFullUrl:u}).method("GetItemById",a).segment("likedByInformation");r=new z.e;return(f=t)?[4,e(Object(U.r)({url:t.toString()+"&$expand=likedby&$top=10",method:"GET",qosName:"likedByInformation",webAbsoluteUrl:o,listFullUrl:u}))]:[3,2];case 1:f=p.sent();p.label=2;case 2:l=[];(c=(s=f)&&s.d&&s.d.likedBy&&s.d.likedBy.results)&&c.forEach(function(e){var t,n=e.email,i=Qe.e.serialize({id:String(n)});r.resolveItems({items:(t={},t[i]=Object(H.n)(Ye,{key:{id:String(n)},displayName:e.name,email:n,picture:n}),t)});l.push(i)});r.resolveItems({items:(h={},h[n]=Object(i.__assign)({},le.N.pack({personKeys:l})),h)});e(r.execute());return[2]}})})}});var et=n(2992),tt={ODB:60069},nt=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options,r=n.views,s=n.qosName;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,o,u,a,f,l,c,h,v,m,g,y,b,w,E,S,x,T,N;return Object(i.__generator)(this,function(i){switch(i.label){case 0:n=p.e.deserialize(t);o=Object.keys(r)[0];if(!n||!o)return[3,4];u=r[o],a=u.itemSetKey,f=u.shouldSaveViewFieldsOnly,l=u.newDocumentTemplatesJsonString,c=u.shouldSaveAggregationsOnly;h=e(Object(ae.e)({deserializedViewKey:je.e,currentDerivedView:R.m},o)),v=h.deserializedViewKey,m=h.currentDerivedView;g=v&&v.viewId;if(!m||!g)return[3,4];y=void 0;return f||l||c?[4,e(Object(et.e)({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl,viewId:g}))]:[3,2];case 1:if((b=i.sent())&&b.view){y=b.view;f?y.replaceFields(m.getEffectiveFieldNames()):l?y.updateNewDocumentTemplates(l):c&&y.replaceAggregates(m.getEffectiveAggregatesData())}return[3,3];case 2:w=e(Object(ae.e)({deserializedItemSetKey:d.e,filterableSet:R.Wt},a)),E=w.deserializedItemSetKey,S=w.filterableSet;if(E){y=Re({sourceView:m,deserializedItemSetKey:E,appliedFilters:S&&S.appliedFilters});(x=e(Object(ae.e)({viewType:R.Tn},o)).viewType)&&y.updateViewType(x)}i.label=3;case 3:if(y){y.prepareForSaving();T=!1;e(Object(V.e)(function(e){var t=Object(We.e)(e,a);if(Object(re.e)(e,{feature:tt,pageContext:t})){var n=d.e.matches(a)&&d.e.deserialize(a);n&&(n.filterParams||n.sortFieldKey||n.groupByFieldKey)&&m&&(T=!!m.customOrder)}}));T&&y.updateCustomOrder("");if(m.isDirty()||y.isDirty()){N=Object(K.e)({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl}).method("Views",g).method("SetViewXml");return[2,e(Object(U.t)({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl,url:N.toString(),method:"POST",body:JSON.stringify({viewXml:y.getEffectiveViewXml()}),qosName:s||"saveView"}))]}}i.label=4;case 4:return[2]}})})}}),rt=n(3407),it=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.options.columnFormatterMap;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,r,s,o,u;return Object(i.__generator)(this,function(a){n=Object.keys(t)[0];r=t[n],s=r.updateType,o=r.formatter;return 0===s?[2,e(Object(Z.e)({items:(u={},u[n]=Object(i.__assign)({},R.g.pack(o)),u)}))]:[2]})})}}),st=n(3358),ot=n(3238),ut=n(2156),at=n(74),ft=Object(s.i)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,n=e.itemKey,r=e.options.sourceEntries,s=v.e.deserialize(n),o=s&&s.itemSetKey,u=o.webAbsoluteUrl,a=o.listFullUrl,f=o.rootFolder,l=c.e.serialize({webAbsoluteUrl:u,listFullUrl:a,rootFolder:f}),h=Object.keys(r)[0],p=r[h].progressItemKey;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,c;return Object(i.__generator)(this,function(d){switch(d.label){case 0:t=e(Object(ae.e)({sourceFile:ut.t},h)).sourceFile;s=e(Object(Ue.e)({listItemUploader:R.Xe})).listItemUploader,o=void 0===s?ot.e:s;return[4,e(o({itemKey:l,options:{sourceEntries:r}}))];case 1:u=d.sent().itemKey;d.label=2;case 2:d.trys.push([2,4,,5]);return[4,e(Object(st.e)({items:(a={},a[u]={groupKey:n},a)}))];case 3:d.sent();return[3,5];case 4:d.sent();return[3,5];case 5:e(Object(Le.e)({items:(f={},f[l]=[te.t],f)}));p&&t&&e(Object(Z.e)({items:(c={},c[p]=Object(i.__assign)(Object(i.__assign)({},at.s.pack({itemKey:u})),Object(H.n)({progressSize:at.y},{progressSize:{current:t.size}})),c)}));return[2]}})})}});var lt=n(1263),ct=Object(s.i)({maxParallelOperationCount:8})(function e(t){var n=this,r=t.itemKey,s=p.e.deserialize(r),o=s.webAbsoluteUrl,u=s.listFullUrl;return function(t){return Object(i.__awaiter)(n,void 0,void 0,function(){var n,a,f,l,c,h,d,v,m,g;return Object(i.__generator)(this,function(y){switch(y.label){case 0:n=[];a=new z.e({publisher:e});f=E.e.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl});l=t(Object(ae.e)({list:R.Re},f));c=t(Object(Ue.e)({localeConfiguration:X.T})).localeConfiguration;return[4,t(Object(et.t)({webAbsoluteUrl:o,listFullUrl:u,listTemplate:l.list&&l.list.templateType,preferredLanguage:c&&c.language}))];case 1:h=y.sent();d={};v=void 0;h.filter(function(e){return!!e.view}).map(function(e){var r,s=e.serverView,f=e.view,l={viewId:f.id},c=je.e.serialize(l);if(f.isDefault){v=c;var h=f.getDomParts().newDocumentTemplates;h&&h.textContent&&a.merge(Object(lt.e)({webAbsoluteUrl:o,listFullUrl:u,newDocumentTemplatesString:h.textContent}).itemResolver)}d[c]=f;Object(qe.n)(f);var p=t(Object(V.e)(function(e){if(e.isItemFacetResolved(R.m,c))return e.demandItemFacet(R.m,c)})),m=!!p&&p.getEffectiveViewXml().replace(/ \/>/g,"/>")===f.getEffectiveViewXml().replace(/ \/>/g,"/>");a.resolveItems({items:(r={},r[c]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},je.e.pack(l)),R.kt.pack(s)),m?{}:R.m.pack(f)),R.Ot.pack(!1)),R.Tn.pack(f.viewType)),r)});n.push(c)});n.sort(function(e,t){return d[e].compareTo(d[t])});a.resolveItems({items:(m={},m[r]=Object(i.__assign)(Object(i.__assign)({},p.e.pack(s)),te.e.pack({itemKeys:n})),m)});v&&a.resolveItems({items:(g={},g[f]=Object(i.__assign)({},R.w.pack({viewKey:v})),g)});t(a.execute());return[2]}})})}});var ht=n(1254),pt=n(783),dt=n(285),vt=n(2994),mt=n(229),gt=n(41),yt=n(2942),bt=n(29);var wt=n(3858),Et=n(955),St=n(57),xt=n(1257),Tt="ClientSideExtension.ListViewCommandSet",Nt="ClientSideExtension.ListViewCommandSet.ContextMenu",Ct="ClientSideExtension.ListViewCommandSet.CommandBar";function kt(e){var t=e.customActionSetKey,n=e.customActions,r=e.context,s=g.e.deserialize(t),o=s.webAbsoluteUrl,u=s.listFullUrl;return function(e){var s=new z.e,a=xt.e.serialize({webAbsoluteUrl:o,listFullUrl:u}),f=e(Object(ae.e)({enableDebugClientSideExtensions:R.N},$.e)).enableDebugClientSideExtensions;f&&f.customActions&&(function(e,t){if(!t)return;var n=e.ContextMenu||[],r=e["Ribbon.Documents"]||[],s=e["Ribbon.List"]||[],o={"ClientSideExtension.ListViewCommandSet.ContextMenu":"ContextMenu:","ClientSideExtension.ListViewCommandSet.CommandBar":"CommandBar:"};try{var u=JSON.parse(t);if(u)for(var a=0,f=Object.keys(u);a<f.length;a++){var l=f[a];try{var c=u[l],h=c.location,p=c.properties,d={text:o[h],action:"",allowMultiSelect:!0,isEnabled:!0,clientSideComponentId:l,clientSideComponentProperties:"object"==typeof p?JSON.stringify(p):""},v=h===Tt,m=h===Ct||v;(h===Nt||v)&&n.push(d);if(m){r.push(Object(i.__assign)({},d));s.push(Object(i.__assign)({},d))}}catch(e){console.log("Error processing query parameter for "+l)}}}catch(e){console.log("error in parsing query parameter for custom actions")}})(n,f.customActions);var l=Lt({setKey:t,actions:n[r.isDocumentLibrary?"Ribbon.Documents":"Ribbon.List"]}).itemResolver,c=Lt({setKey:a,actions:n.ContextMenu}).itemResolver;s.merge(c);s.merge(l);return s}}function Lt(e){for(var t,n,r,s=e.setKey,o=e.actions,u=new z.e,a=[],f=0,l=0,c=o;l<c.length;l++){var h=c[l],p=[];if(Object(yt.e)(h))for(var d=0,v=0,m=h.children;v<m.length;v++){var g=m[v],y=g.id?g.id:g.text+f+"."+d,b=ht.e.serialize({actionId:y});At(g)||u.resolveItems({items:(t={},t[b]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},le.h.pack(g.text)),le.O.pack(g.action)),vt.e.pack(g.allowMultiSelect)),vt.n.pack(g.isEnabled||!1)),vt.t.pack(g.iconUrl)),t)});p.push(b);d++}if(Object(yt.e)(h)||!At(h)){var w=h.id?h.id:h.text+f.toString(),E=ht.e.serialize({actionId:w});u.resolveItems({items:(n={},n[E]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},le.h.pack(h.text)),te.e.pack({itemKeys:p})),le.O.pack(Object(yt.e)(h)?"":h.action)),Object(yt.e)(h)?{}:vt.e.pack(h.allowMultiSelect)),Object(yt.e)(h)?{}:vt.n.pack(h.isEnabled||!1)),Object(yt.e)(h)?{}:vt.t.pack(h.iconUrl)),n)});a.push(E)}f++}var S=a.length>0?{itemKeys:a}:void 0;u.resolveItems({items:(r={},r[s]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},gt.s.pack(!0)),te.e.pack(S)),R.xt.pack(o)),r)});return{itemResolver:u}}function At(e){return e&&(!!e.clientSideCommandAdapter||e.clientSideComponentId&&e.clientSideComponentId!==we.e.Empty)||!1}var Ot=Object(s.i)()(function(e){var t=e.itemKey,n=g.e.deserialize(t),r=n.webAbsoluteUrl,s=n.listFullUrl;return function(e){var n,o=e((function(e){var t=e.webAbsoluteUrl,n=e.listFullUrl;return function(e){var r=e(Object(ae.e)({pageContext:R.un},$e.e.serialize({webAbsoluteUrl:t,listFullUrl:n}))),i=e(Object(ae.e)({list:R.Re},E.e.serialize({webAbsoluteUrl:t,listFullUrl:n})));return{currentUserIsSiteAdmin:r.pageContext&&r.pageContext.isSiteAdmin||!1,listTemplate:i.list&&i.list.templateType||bt.n.invalidType,listId:i.list&&i.list.id||"",isDocumentLibrary:i.list&&i.list.isDocumentLibrary||!1}}})({webAbsoluteUrl:r,listFullUrl:s}));if(o.listTemplate===bt.t.mySiteDocumentLibrary){var u=new z.e;u.resolveItems({items:(n={},n[t]=Object(i.__assign)({},te.e.pack(void 0)),n)});e(u.execute());return Promise.resolve()}return e((function(e,t,n){var r=Object(K.e)({webAbsoluteUrl:e,listFullUrl:t}).segment("CustomActionElements");return function(i){return i(Object(U.r)({webAbsoluteUrl:e,listFullUrl:t,method:"POST",url:r.toString(),qosName:"getLegacyCustomActions",noRedirect:!0})).then(function(e){return Object(yt.t)(e.d.CustomActionElements.Items.results,n)})}})(r,s,o)).then(function(n){return e(kt({customActionSetKey:t,customActions:n,context:o}))}).then(function(t){return e(t.execute())})}}),Mt=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=y.e.deserialize(n),s=r.webAbsoluteUrl,o=r.listFullUrl,u=r.isSPFXandCustomActionsAvailable,a=r.targetCustomActionSetKey,f=r.itemsScopeItemKey;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,l,c,h,p,d,m,g,y,b;return Object(i.__generator)(this,function(w){switch(w.label){case 0:t=new z.e;r=E.e.serialize({webAbsoluteUrl:s,listFullUrl:o});l=e(Object(V.e)(Et.e));c=function(){var n;t.resolveItems({items:(n={},n[r]=mt.u.pack(void 0),n)});e(t.execute())};if(!u&&!l){c();return[2]}return(p=l)?[4,l()]:[3,2];case 1:p=w.sent();w.label=2;case 2:d=!1;if(!(h=p))return[3,7];m=h.createListViewAdapter();t.resolveItems({items:(b={},b[r]=Object(i.__assign)({},m?mt.u.pack(m):{}),b)});g=e(Object(ae.e)({rawCustomActions:R.xt},a)).rawCustomActions;return[4,_t({setKey:n,actions:g||[],listViewAdapter:m},e)];case 3:y=w.sent().itemResolver;t.merge(y);return[4,e(Object(W.e)(function(e){var n=Object(St.e)(e,f);if(n&&m){var r=e.demandItemFacet(te.e,n),u=r&&r.itemKeys,a=function(n){var r,s=e.isItemFacetResolved(R.Ct,n)?e.demandItemFacet(R.Ct,n):void 0;if(s&&m){var o=m.createRowAdapter({values:s});t.resolveItems({items:(r={},r[n]=Object(i.__assign)({},o?mt.a.pack(o):{}),r)})}else if(e.demandItemFacet(v.e,n)){var u=e.isItemFacetResolved(te.e,n)?e.demandItemFacet(te.e,n):void 0;if(u)for(var f=0,l=u.itemKeys;f<l.length;f++){var c=l[f];a(c)}}};if(u)for(var l=0,c=u;l<c.length;l++){var h=c[l];a(h)}var p=e.demandItemFacet(te.o,n),g=p&&p.columnKeys||[];if(g&&m)for(var y=function(n){var r,i=e.demandItem({fieldId:R.le,internalName:R.Te,realFieldName:R.Tt,fieldType:R.fe,isRequired:dt.r,displayName:le.h,clientSideComponentId:mt.e,clientSideComponentProperties:mt.t},n),u=i.fieldId,a=i.internalName,f=i.realFieldName,l=i.fieldType,c=i.isRequired,h=i.displayName,p=i.clientSideComponentId,v=i.clientSideComponentProperties;if(u&&a){d=!0;var g={listKey:{webAbsoluteUrl:s,listFullUrl:o},internalName:a},y={id:u,internalName:f||a,fieldType:l||"Text",isRequired:c||!1,isVisible:!0,displayName:h||"",clientSideComponentId:p||we.e.Empty,clientSideComponentProperties:v||"",onSetVisible:function(e){return console.log("ISpfxAdapter.IColumn.onSetVisible not implemented")},onFieldCustomizerError:function(e){console.log("Fail to load customizer for column: "+a+",\n                      componentId: "+p+", error: "+e.message)}},b=m.addColumnAdapter(y);if(p&&p!==we.e.Empty){var w=pt.e.serialize(g);t.resolveItems({items:(r={},r[w]=mt.n.pack(b),r[n]=mt.r.pack(w),r)})}}},b=0,w=g;b<w.length;b++){y(w[b])}}}))];case 4:w.sent();return d?[4,m.loadFieldCustomizers()]:[3,6];case 5:w.sent();w.label=6;case 6:return[3,8];case 7:c();w.label=8;case 8:e(t.execute());return[2]}})})}});function _t(e,t){return Object(i.__awaiter)(this,void 0,void 0,function(){var n,r,s,o,u,a,f,l,c,h,p;return Object(i.__generator)(this,function(d){switch(d.label){case 0:n=e.setKey,r=e.actions,s=e.listViewAdapter;o=new z.e;u=[];a=0;f=function(e){var r,f,l,c,h,p,d,v,m,g,y,b;return Object(i.__generator)(this,function(i){switch(i.label){case 0:r=[];if(!Object(yt.e)(e))return[3,5];f=e.children;l=0;c=0,h=f;i.label=1;case 1:if(!(c<h.length))return[3,5];p=h[c];d=p.id?p.id:p.text+a+"."+l;v=ht.e.serialize({actionId:d});return Pt(p)&&s?[4,Dt({action:p,listViewAdapter:s,setKey:n},t)]:[3,3];case 2:m=i.sent(),b=m.actionKeys,y=m.itemResolver;o.merge(y);b.forEach(function(e){r.push(e)});i.label=3;case 3:r.push(v);l++;i.label=4;case 4:c++;return[3,1];case 5:return!Object(yt.e)(e)&&Pt(e)&&s?[4,Dt({action:e,listViewAdapter:s,setKey:n},t)]:[3,7];case 6:g=i.sent(),y=g.itemResolver,b=g.actionKeys;o.merge(y);u=u.concat(b);i.label=7;case 7:a++;return[2]}})};l=0,c=r;d.label=1;case 1:if(!(l<c.length))return[3,4];h=c[l];return[5,f(h)];case 2:d.sent();d.label=3;case 3:l++;return[3,1];case 4:o.resolveItems({items:(p={},p[n]=Object(i.__assign)(Object(i.__assign)({},gt.s.pack(!0)),te.e.pack(0===u.length?void 0:{itemKeys:u})),p)});return[2,{itemResolver:o}]}})})}function Dt(e,t){return Object(i.__awaiter)(this,void 0,void 0,function(){var n,r,s,o,u,a,f,l,c,h;return Object(i.__generator)(this,function(p){switch(p.label){case 0:n=e.action,r=e.listViewAdapter,s=e.setKey;o=y.e.deserialize(s);u=o.targetCustomActionSetKey;a=new z.e;f=[];l=n.clientSideComponentId&&n.clientSideComponentId.toString()||"";c=n.clientSideComponentProperties||"";return l&&l!==we.e.Empty?[4,r.loadCommandSet(l,c).catch(function(){})]:[2,{itemResolver:a,actionKeys:[]}];case 1:if((h=p.sent())&&h.commandAdapters){ze.t.isActivated(wt.e,"09/27/2021","Fix of onExecute communication with SPFx Command Set")||(h.onChange=function(e){(function(e,t){var n=new z.e,r={};Object.keys(t).forEach(function(e){var n=t[e];r[e]=Object(i.__assign)(Object(i.__assign)({},le.h.pack(n.title)),mt.s.pack(n.visible))});n.resolveItems({items:r});e(n.execute())})(t,e)});h.commandAdapters.forEach(function(e){var t,r="";r=ze.t.isActivated("3d0eacb4-96d8-4af7-9dba-37e597ccff42")?n.clientSideComponentId+"."+e.commandId:u+"."+n.clientSideComponentId+"."+e.commandId;var s=ht.e.serialize({actionId:r});ze.t.isActivated(wt.e,"09/27/2021","Fix of onExecute communication with SPFx Command Set")||(e.itemKey=s);a.resolveItems({items:(t={},t[s]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},le.h.pack(e.title)),le.O.pack(n.action)),vt.e.pack(n.allowMultiSelect)),vt.n.pack(n.isEnabled||!1)),vt.t.pack(e.iconUrl||n.iconUrl)),mt.i.pack(e)),mt.s.pack(e.visible)),t)});f.push(s)})}return[2,{itemResolver:a,actionKeys:f}]}})})}function Pt(e){return e&&(!!e.clientSideCommandAdapter||e.clientSideComponentId&&e.clientSideComponentId!==we.e.Empty)||!1}var Ht=Object(s.i)({maxParallelOperationCount:4})(function(e){var t=this,n=e.itemKey,r=b.e.deserialize(n).webAbsoluteUrl;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,l;return Object(i.__generator)(this,function(c){switch(c.label){case 0:t=Object(K.n)({webAbsoluteUrl:r}).segments("ComponentContextInfo");return[4,n(Object(U.t)({url:t.toString(),qosName:"GetWebPageContext",method:"GET",webAbsoluteUrl:r,noRedirect:!0}))];case 1:s=c.sent();o=JSON.parse(s.d.SerializedData);u=o.isSPO,a=void 0===u||u;(f=new z.e).resolveItems({items:(l={},l[e.itemKey]=Object(i.__assign)(Object(i.__assign)({},R.ut.pack(a?void 0:{})),R.un.pack(o)),l)});n(f.execute());return[2]}})})}});var Bt=n(171),jt=n(185),Ft=n(2773),It=n(2119),qt=Object(s.n)()(function(e){var t=e.items,n=Object.keys(t),r=t[n[0]].groupKey;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var t,s,o,u,a,f,l,c,h,p,m,g,y,b,w,E,S,x,T,N;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e(Object(V.e)(function(e){return e.demandItemFacet(v.e,r)}));if(!(s=t&&t.itemSetKey&&d.e.serialize(t.itemSetKey))||n.length<1||!r)return[2];o=e(Object(ae.e)({spGroupField:R.Kt,groupValue:R.Se,parentGroupKey:R.ft,defaultCollapsed:gt.t},r)),u=o.spGroupField,a=o.groupValue,f=o.parentGroupKey,l=o.defaultCollapsed;c=[];u&&u.internalName&&a&&c.push({FieldName:u.internalName,FieldValue:a});if(f&&f.itemKey){h=e(Object(ae.e)({parentGroupField:R.Kt,parentGroupValue:R.Se},f.itemKey)),p=h.parentGroupField,m=h.parentGroupValue;p&&p.internalName&&m&&c.push({FieldName:p.internalName,FieldValue:m})}if(t&&t.itemSetKey&&t.itemSetKey.filterParams&&(g=jt.default.getFilterList(t.itemSetKey.filterParams,void 0,!0)).length>0)for(y=0;y<g.length;y++){b=g[y];w=e(Object(ae.e)({isReadOnly:R._e},Bt.e.serialize({listKey:t.itemSetKey,internalName:b.fieldName}))).isReadOnly;1===b.values.length&&!1===w&&c.push({FieldName:b.fieldName,FieldValue:b.values[0]})}return[4,e(Object(Ft.e)({items:(S={},S[s]={itemKeys:n,formValues:c,qosName:"AssignItemsToGroup"},S)}))];case 1:i.sent();E={};n.forEach(function(e){E[e]={}});return[4,e(Object(It.e)({items:(x={},x[s]=E,x)}))];case 2:i.sent();e(l?Object(Le.e)({items:(T={},T[r]=[te.e],T)}):Object(Le.e)({items:(N={},N[s]=[te.e],N)}));return[2]}})})}}),Rt=n(3628),Ut=n(9),zt=n(3251),Wt=Object(Ut.t)()(function(){return function(e){return Xt}});function Xt(e,t){var n=t.itemKey,r=e.demandItem({driveItem:c.e,canonicalLinkUrl:le.i},n),s=r.driveItem,o=r.canonicalLinkUrl;return{isAvailable:!0,getShareLink:function(){return(function(e){var t=this;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,s,o,u,a,f,l,c,h,p;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e.driveItem,r=e.canonicalLinkUrl;if(t&&r)return[3,1];throw new Error("Unable to obtain default share URL");case 1:s=void 0;if(r){o=new _e.e(r);u=o.authority;for(a=0,f=o.segments;a<f.length;a++)""!==(l=f[a])&&(u=u+"/"+encodeURIComponent(l));c=Object(zt.e)(u.toString());s="u!"+c.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-")}h=new _e.e(t.webAbsoluteUrl).authority;return[4,n(Object(U.t)({webAbsoluteUrl:h,listFullUrl:void 0,url:h+"/_api/v2.0/shares/"+s+"/driveItem/invite",body:void 0,method:"POST",additionalHeaders:{prefer:"getDefaultLink","Content-type":"application/json",Accept:"application/json"},qosName:"getDefaultShareLink",noRedirect:!0}))];case 2:return[2,{url:(p=i.sent()).value[0].link.webUrl,scope:p.value[0].link.scope}]}})})}})({driveItem:s,canonicalLinkUrl:o})}}}var Vt=n(2625),$t=n(22),Jt=Object(s.i)({mergeForSameItemKey:!0})(function(e){var t=e.itemKey,n=e.options,r=n.isNewDocumentUpdate,s=n.checkInComment,o=n.formValues,u=n.qosName;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,a,f,l,c;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return o&&o.length>0?[4,e(Object(Ae.e)(t))]:[3,3];case 1:n=i.sent(),a=n.key,f=n.itemId;l=(function(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.itemId;return Object(K.e)({webAbsoluteUrl:t,listFullUrl:n}).method("Items",r).method("ValidateUpdateListItem").toString()})({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl,itemId:f||a.itemId||""});(c={}).formValues=o;c.bNewDocumentUpdate=r;c.checkInComment=s;return[4,e(Object(U.t)({body:JSON.stringify(c),listFullUrl:a.listFullUrl,method:"POST",qosName:u||"updateItem.ValidateUpdateListItem",url:l,webAbsoluteUrl:a.webAbsoluteUrl,noRedirect:!0})).then(function(e){var t=!1,n="";e.d.ValidateUpdateListItem.results.forEach(function(e){if(e.HasException){t=!0;n+=$t.format("{0}: {1} ",e.FieldName,e.ErrorMessage)}});if(t)throw new Error(n||void 0)})];case 2:i.sent();i.label=3;case 3:return[2]}})})}});var Kt=n(297),Qt=n(1055);var Gt=n(259),Yt=n(306),Zt=Object(s.i)()(function(e){var t=e.itemKey;return function(n){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f;return Object(i.__generator)(this,function(l){switch(l.label){case 0:r=d.e.deserialize(t);s=n(Object(he.n)({itemSetKey:r}));o=Object.keys(e.options);return[4,n((h={itemSetKey:t,itemKeys:o},function(e){for(var t=h.itemSetKey,n=h.itemKeys,r=e(Object(V.e)(function(e){var n=e.demandItemFacet(d.e,t)||d.e.deserialize(t);return Object(i.__assign)(Object(i.__assign)({},n),{pageContext:Object(We.e)(e,c.e.serialize(n))})})),s=r.webAbsoluteUrl,o=r.listFullUrl,u=r.pageContext,a=[],f=0,l=n;f<l.length;f++){var p=l[f],v=c.e.deserialize(p).itemId;v||(v=e(Object(ae.e)({listItemId:R.We},p)).listItemId);v&&a.push(v)}var m=e(Object(Qt.e)({internalName:R.Te},t)),g=["Modified"];if(m)for(var y=0,b=m;y<b.length;y++){var w=b[y];w.internalName&&"Modified"!==w.internalName&&g.push(w.internalName)}return{webAbsoluteUrl:s,listFullUrl:o,currentPageContext:u,qosName:"refreshItemsInSet",viewXml:Object(Kt.i)({itemIds:a,recurseInFolders:!0,pageSize:n.length,fieldNames:g.length>0?g:void 0}),postDataContext:{needsSchema:!0}}}))];case 1:u=l.sent();return[4,n(Object(de.e)({getItemContext:u}))];case 2:a=l.sent();f=n(Object(Gt.t)({serverData:a,itemSetKey:r,currentPageContext:u.currentPageContext,contentTypes:s,isItemSetRequest:!0})).itemResolver;n(f.execute());n(Object(Yt.e)({itemSetKey:t,serverData:a,isItemSetRequest:!0}));return[2]}var h})})}}),en=n(3629),tn=Object(Ut.t)()(function(){return function(e){return nn}});function nn(e,t){var n=t.itemKey,r=t.link,s=t.recipients,o=e.demandItem({driveItem:c.e},n).driveItem;return{isAvailable:!0,permissionInvite:function(){return(function(e){var t=this;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,s,o,u,a,f,l,c,h;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e.driveItem,r=e.link,s=e.recipients;if(!t)return[3,2];void 0;u=Object(zt.e)(r);o="u!"+u.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-");a=s.map(function(e){return{email:e}});f={recipients:a,roles:["read"]};l=new _e.e(t.webAbsoluteUrl).authority;return[4,n(Object(U.t)({webAbsoluteUrl:l,listFullUrl:void 0,url:l+"/_api/v2.0/shares/"+o+"/permission/invite",body:JSON.stringify(f),method:"POST",additionalHeaders:{"Content-type":"application/json",Accept:"application/json"},qosName:"permissionInvite",noRedirect:!0}))];case 1:c=i.sent();h=c.value[0].grantedToIdentities.map(function(e){return{email:e.user.email}});return[2,{recipients:h}];case 2:throw new Error("Unable to set permissions on the sharing URL")}})})}})({driveItem:o,link:r,recipients:s})}}}var rn=n(2624),sn=Object(Ut.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItemFacet(c.e,n);if(!r)return{};var i={webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl},s=e.demandItemFacet(R.Re,E.e.serialize(i)),o=e.demandItemFacet(R.un,$e.e.serialize(i));if(!o)return{};var u=s&&s.templateType===bt.t.mySiteDocumentLibrary||!1;return{sharedPostData:{cultureName:o.currentUICultureName||o.currentCultureName||"en-US",client:u?"OneDrive":"SharePoint",domainHint:"organizations",userId:o.userLoginName}}}}});var on=n(3250),un=n(82),an=n(889),fn=n(398),ln=Object(Ut.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=void 0,i=e.demandItem({key:c.e,driveItemKey:un.e},n),s=i.key,o=i.driveItemKey;if(o)return{driveItemFullUrl:Object(an.t)(o)};if(s){var u={webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl},a=e.demandItem({listMediaFacets:fn.t},E.e.serialize(u)).listMediaFacets;if(a&&a[".driveUrl"]){var f=a[".driveUrl"],l=s.rootFolder||"",h="";if(l){var p=new De.t({context:{webAbsoluteUrl:s.webAbsoluteUrl,listUrl:s.listFullUrl}}).getUrlParts();p.serverRelativeListUrl&&"/"!==(h=l.replace(p.serverRelativeListUrl,"")).charAt(0)&&(h="/"+h)}return{driveItemFullUrl:r=f+"/items/root"+(h?":":"")+h}}}return{driveItemFullUrl:r}}}});var cn=n(509),hn=n(71),pn=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options,r=n.aggregateType,s=n.columnKey;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,o,u,a,f,l,c,h,v,m,g,y,b;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(!(n=e(Object(ae.e)({setKey:d.e},t)).setKey))return[3,2];if(!(o=n.viewKey?je.e.serialize(n.viewKey):void 0))return[3,2];if(!(u=e(Object(ae.e)({currentDerivedView:R.m},o)).currentDerivedView))return[3,2];a=e(Object(ae.e)({internalName:R.Te,fieldType:R.ce,fieldFieldType:R.fe},s)),f=a.internalName,l=a.fieldType,c=a.fieldFieldType;if(!f)return[3,2];h=e(Object(ae.e)({spFolderAggregates:R.c},t)).spFolderAggregates;v=u.isDirty();if(!(m=h&&h[s]?h[s].aggregateFunctionType:void 0)&&0===r||m===cn.e[r])return[2];g=0===r?void 0:cn.e[r];u.updateColumnAggregateType(f,g);return[4,e(Object(A.e)({items:(y={},y[p.e.serialize({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl})]={views:(b={},b[o]={shouldSaveAggregationsOnly:!0},b),qosName:"SaveModifyColumnAggregateType"},y)})).then(function(){var n,r=u.getEffectiveViewXml(),i=new Fe.e(u.baseViewXml||"");i.replaceAggregates(u.getEffectiveAggregatesData());u.baseViewXml=i.getEffectiveViewXml();u.setDom(r);u.setIsDirty(v);var s=new z.e;s.invalidateItems({items:(n={},n[t]=[te.e],n[o]=[R.Pt],n)});e(s.execute())},function(e){hn.e.logError(e.errorData,{eventName:"ModifyColumnAggregateType",feature:"ModernColumnTotalsSettings",fieldType:l,fieldFieldType:c,currentAggregateType:m||"None",newAggregateType:g||"None",errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status});u.updateColumnAggregateType(f,m);u.setIsDirty(v);throw e})];case 1:i.sent();i.label=2;case 2:return[2]}})})}}),dn=n(3408),vn=Object(s.i)()(function(e){var t=e.itemKey,n=e.options,r=n.itemKeys,s=n.bNewDocumentUpdate,o=n.checkInComment,u=n.formValues,a=n.qosName;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,f,l,c,h,p,v,m,g,y,b,w,E,S,x;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(!(u&&u.length&&r&&r.length))return[2];n=d.e.deserialize(t),f=n.viewKey,l=n.rootFolder,c=n.webAbsoluteUrl,h=n.listFullUrl;p=l||"";f&&(!(v=e(Object(ae.e)({currentDerivedView:R.m},je.e.serialize(f))).currentDerivedView)||1!==v.scope&&2!==v.scope||(p=""));m=[];g={};y=0,b=r;i.label=1;case 1:if(!(y<b.length))return[3,4];w=b[y];return[4,e(Object(Ae.e)(w))];case 2:E=i.sent().itemId;m.push(parseInt(E,10));g[E]=w;i.label=3;case 3:y++;return[3,1];case 4:S=Object(K.e)({webAbsoluteUrl:c,listFullUrl:h}).method("BulkValidateUpdateListItems").toString();x={itemIds:m,formValues:u,folderPath:p,bNewDocumentUpdate:s,checkInComment:o};return[4,e(Object(U.t)({body:JSON.stringify(x),listFullUrl:h,method:"POST",qosName:a,url:S,webAbsoluteUrl:c,noRedirect:!0})).then(function(n){for(var r,i="",s={},o=0,u=n.d.BulkValidateUpdateListItems.results;o<u.length;o++){var a=u[o];if(a.HasException)i=a.ErrorMessage+"\n"+i;else{g[a.ItemId]&&(s[g[a.ItemId]]={})}}Object.keys(s).length>0&&e(Object(It.e)({items:(r={},r[t]=s,r)}));if(i)throw new Error(i)})];case 5:i.sent();return[2]}})})}}),mn=n(1536),gn=n(1537),yn=n(1538),bn=n(1291),wn=n(3252),En=n(490),Sn=n(645),xn=n(223),Tn=n(331),Nn=Object(s.n)()(kn),Cn=Object(s.n)()(kn);function kn(e){var t=this,n=e.items,r=n[Object.keys(n)[0]].itemSetKey;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,l,c,h,p,d,v,m;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=[];return[4,e(Ln({itemSetKey:r}))];case 1:o=i.sent();u=function(n){var r=e(Object(V.e)(function(e){return e.demandItemFacet(le.i,n)}))||"",i={DecodedUrl:decodeURIComponent(r)};i&&t.push(i)};for(a=0,f=Object.keys(n);a<f.length;a++){l=f[a];u(l)}s=JSON.stringify({itemPaths:t});c="RemoveItemsFromSharedWithMeViewByPath";h=Object(K.n)({webAbsoluteUrl:o}).segment("SP.Sharing.DocumentSharingManager."+c);return[4,e(Object(U.t)({url:h.toString(),qosName:"RemoveFromSharedList",method:"POST",webAbsoluteUrl:o,body:s,noRedirect:!0}))];case 2:if((p=i.sent())&&p.d&&p.d[c]&&p.d[c].results){if((d=p.d[c].results).length<1)throw new ye.e({message:En.e});d.forEach(function(e){if(!e.Success&&-3!==e.ErrorCode)throw new ye.e({message:e.ErrorMessage||void 0})})}(v=new z.e).invalidateItems({items:(m={},m[r]=[te.e],m)});e(v.execute());return[2]}})})}}function Ln(e){var t=this,n=e.itemSetKey;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,s;return Object(i.__generator)(this,function(i){switch(i.label){case 0:"";t=e(Object(V.e)(function(e){return e.demandItemFacet(xn.e,n)}));r=t&&t.driveItemKey.endpoint||"";return[4,e(Object(W.e)(function(e){return e.demandItemFacet(c.e,Sn.e.serialize({tenantRootUrl:new Tn.e(r).authority}))}))];case 1:s=i.sent();return[2,s&&s.webAbsoluteUrl||""]}})})}}var An=n(1543),On=n(3859),Mn=Object(s.i)()(function(e){var t=e.itemKey,n=e.options,r=n.itemKeys,s=n.relativeItemKey,o=n.insertAfter,u=void 0!==o&&o,a=[];r.forEach(function(e){if(c.e.matches(e)){var t=c.e.deserialize(e).itemId;void 0===t||isNaN(Number(t))||a.push(Number(t))}});var f=d.e.deserialize(t),l=f.webAbsoluteUrl,h=f.listFullUrl,p=f.viewKey,v=!!p&&p.viewId,m=void 0;if(s&&c.e.matches(s)){var g=c.e.deserialize(s);g&&(m=g.itemId&&!isNaN(Number(g.itemId))?Number(g.itemId):void 0)}var y=p&&je.e.serialize(p);if(!v||a.length<1||!s||!m||!y)throw new Error("Invalid parameters to reorderListItemsOperationHandler");var b=Object(K.e)({webAbsoluteUrl:l,listFullUrl:h}).method("AddCustomOrderToView").toString();return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,r,s,o,f,c,p,d;return Object(i.__generator)(this,function(g){switch(g.label){case 0:n={viewId:v,itemIds:a,relativeItemId:m,insertAfter:u};r=e(Object(ae.e)({currentDerivedView:R.m},y)).currentDerivedView;return[4,e(Object(U.t)({webAbsoluteUrl:l,listFullUrl:h,url:b,body:JSON.stringify(n),method:"POST",qosName:"ReorderListItems",noRedirect:!0}))];case 1:if(s=g.sent()){o=s.d&&s.d.AddCustomOrderToView||"";f=!r;if(r){r.updateCustomOrder(o);e(Object(Z.e)({items:(c={},c[y]=Object(i.__assign)({},R.m.pack(r)),c)}))}e(Object(Le.e)({items:Object(i.__assign)((p={},p[t]=[te.e],p),f?(d={},d[y]=[R.kt,R.m],d):{})}))}return[2]}})})}}),_n=n(3630),Dn=n(421),Pn=new H.e("addContentTypesToList"),Hn=(new Dn.e("addContentTypesToList"),Object(s.t)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){e(Object(o.r)(l.e,a.e)(ve));e(Object(o.r)(c.e,x.t)(Se));e(Object(o.r)(c.e,T.t)(ke));e(Object(o.r)(c.e,N.t)(Oe));e(Object(o.r)(c.e,C.t)(Me));e(An.sharePointBasicActionsAddonDeferred);e(Object(o.r)(c.e,f.t)(Pe));e(Object(o.r)(h.e,S.e)(Be.n));e(Object(o.r)(c.e,k.e)(qt));e(Object(o.r)(p.e,O.t)(Xe));e(Object(o.r)(p.e,M.t)(Ve));e(Object(o.r)(p.e,_.t)(Je));e(Object(o.r)(p.e,L.t)(Ke));e(Object(o.r)(p.e,A.t)(nt));e(Object(o.r)(d.e,P.t)(rt.t));e(Object(o.r)(d.e,dn.t)(pn));e(Object(o.r)(d.e,j)(it));e(Object(o.r)(d.e,It.t)(Zt));e(Object(o.r)(d.e,Ft.t)(vn));e(Object(o.r)(v.e,u.t)(ft));e(Object(o.r)(m.e,a.e)(Ze));e(Object(o.r)(p.e,a.e)(ct));e(Object(o.r)(g.e,a.e)(Ot));e(Object(o.r)(y.e,a.e)(Mt));e(Object(o.r)(b.e,a.e)(Ht));e(Object(o.r)(d.e,Y.t)(oe));e(Object(o.r)(d.e,ue)(ce));e(Object(D.e)(c.e,rn.e)(sn));e(Object(D.e)(c.e,on.e)(ln));e(On.sharePointBasicItemDataAddonDeferred);e(bn.e);e(F.e);e(I.e);e(G);e(Object(D.e)(c.e,Rt.e)(Wt));e(Object(o.r)(c.e,Vt.e)(Jt));e(Object(D.e)(c.e,en.e)(tn));e(Object(o.r)(c.e,wn.n)(Nn));e(Object(o.r)(w.e,wn.n)(Cn));e(Object(o.r)(d.e,_n.t)(Mn));e(Object(o.r)(E.e,Pn)(Object(s.r)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(["38"],4223)];case 1:return[2,e.sent().spListAddContentTypesToListOperationHandler]}})})})));return[2]})})}}))},function(e,t,n){"use strict";n.r(t);n.d(t,"graphAddonDataOnlyDeferred",function(){return nt});var r=n(0),i=n(10),s=n(217),o=n(322),u=n(82),a=n(1120),f=n(1072),l=n(1113),c=n(1062),h=n(648),p=n(939),d=n(634),v=n(488),m=n(627),g=n(922),y=n(204),b=n(363),w=n(611),E=n(2),S=n(889),x=n(1790),T=n(74),N=n(8),C=n(2542),k=n(198);function L(e){switch(e){case"rename":return"rename";case"replace":return"replace";default:return"fail"}}var A=Object(i.i)({mergeForSameItemKey:!1})(function e(t){var n=this,i=t.itemKey,s=t.options.folders,o=u.e.deserialize(i),a=o.endpoint,f=o.driveId,l=o.itemId,c=Object.keys(s)[0],h=s[c],p=h.progressItemKey,d=h.conflictResolution,v=void 0===d?"fail":d,m=Object(S.n)(o);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,h,d,g,y,A,M,_;return Object(r.__generator)(this,function(D){switch(D.label){case 0:n=Object(S.t)(o)+"/children";s=L(v);h={name:c,folder:{},"@microsoft.graph.conflictBehavior":s};f&&l&&(h.parentReference={driveId:f,id:l});return[4,t(Object(x.n)({url:n,driveUrl:m,method:"POST",body:h,qosName:"createFolder",endpoint:a})).catch(function(e){throw new b.e({innerError:e,facets:Object(r.__assign)({},Object(w.t)(e,O)||Object(E.n)({},{}))})})];case 1:d=D.sent();g=u.e.serialize({endpoint:a,driveId:f,itemId:d.id});y=new k.e({publisher:e});p&&y.resolveItems({items:(A={},A[p]=Object(r.__assign)({},T.s.pack({itemKey:g})),A)});y.invalidateItems({items:(M={},M[i]=[N.t],M)});y.resolveItems({items:(_={},_[g]=Object(r.__assign)({},Object(C.e)({driveItem:d,parentFolderItemKey:i,endpoint:a})),_)});t(y.execute());return[2]}})})}});function O(e){switch(e){case"nameAlreadyExists":case 409:return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},y.m.pack({supportsRename:!0})),y.t.pack(!0)),y.n.pack(!1))}}var M=n(3704),_=n(6),D=n(122),P=Object(i.i)({mergeForSameItemKey:!1})(function e(t){var n=this,i=t.itemKey,s=t.options.names,o=u.e.deserialize(i);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,u,a,f,l,c,h,p;return Object(r.__generator)(this,function(d){switch(d.label){case 0:n=Object.keys(s)[0];u=s[n],a=u.newName,f=u.newExtension;l=Object(S.t)(o);c=Object(S.n)(o);h=t(Object(D.e)({fileName:_.d},i)).fileName;p="string"==typeof f?f:h&&h.extension||"";return[4,t(Object(x.n)({url:l,driveUrl:c,method:"PATCH",body:{name:""+a+p},qosName:"renameItem",endpoint:o.endpoint})).then(function(n){var s,o,u=new k.e({publisher:e});u.invalidateItems({items:(s={},s[i]=[_.h],s)});u.resolveItems({items:(o={},o[i]=Object(r.__assign)(Object(r.__assign)({},_.h.pack(n.name)),_.d.pack(Object(C.t)(n.name||"",!!n.folder))),o)});t(u.execute())}).catch(function(e){if(e instanceof w.e&&e.status===b.t)throw new b.e({facets:Object(r.__assign)({},y.y.pack({})),innerError:e});throw e})];case 1:d.sent();return[2]}})})}});var H=n(3430),B=n(3428),j=n(3905),F=n(3429),I=n(3427),q=n(2017),R=n(207),U=n(266),z=n(137),W=n(2156),X=n(155),V=n(52),$=n(119),J=Object(U.e)(function(){return new j.e({},{})}),K=Object(U.e)(function(e){var t=e(x.e).dataRequestor,n=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t,{performanceNow:I.t})||this}return t})(I.e),i=new B.e({},{dataRequestor:t}),s=new F.e({},{activityBandwidthVerifierType:n,uploadService:i});return new H.e({},{uploadService:i,uploadStateMachine:s})}),Q=0;function G(e){var t=this,n=e.itemKey,i=e.options.sourceEntries,s=u.e.deserialize(n),o=s.endpoint,a=s.driveId,f=Object.keys(i)[0],l=i[f],c=l.progressItemKey,h=l.conflictResolution,p=void 0===h?"fail":h;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,l,h,d,v,m,g,y,b;return Object(r.__generator)(this,function(w){switch(w.label){case 0:if(!(t=e(Object(D.e)({sourceFile:W.t},f)).sourceFile))throw new Error("No source file for Graph upload.");i=Object(S.t)(s)+":";l=Object(S.n)(s);c&&e(Object(X.e)({items:(m={},m[c]=Object(r.__assign)({},T.y.pack({total:t.size,current:0})),m)}));return[4,e(Y({progressItemKey:c,sourceFile:t,itemUrl:i,driveUrl:l,conflictResolution:p,endpoint:o}))];case 1:h=w.sent();d=u.e.serialize({endpoint:o,driveId:a,itemId:h.id});v=new k.e({publisher:G});c&&v.resolveItems({items:(g={},g[c]=Object(r.__assign)(Object(r.__assign)({},T.s.pack({itemKey:d})),Object(E.n)({progressSize:T.y},{progressSize:{current:t.size}})),g)});v.invalidateItems({items:(y={},y[n]=[N.t],y)});v.resolveItems({items:(b={},b[d]=Object(r.__assign)({},Object(C.e)({driveItem:h,parentFolderItemKey:n,endpoint:o})),b)});return[2,{itemResolver:v,driveItem:h,itemKey:d}]}})})}}function Y(e){var t=this,n=e.progressItemKey,i=e.sourceFile,s=e.itemUrl,o=e.driveUrl,u=e.endpoint,a=L(e.conflictResolution);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,f,l,h,p,d,v,m,g,b;return Object(r.__generator)(this,function(S){switch(S.label){case 0:t=e(K);f=e(J);return[4,e(Object(q.getSessionToken)(u,o))];case 1:l=S.sent();h=new R.e;p=0;d=h.debounce(function(t){var r;if(t>p){n&&e(Object(X.e)({items:(r={},r[n]=Object(E.n)({progressSize:T.y},{progressSize:{current:t}}),r)}));p=t}},300,{leading:!1});v=e(Object(z.e)(function(e){return e.demandItemFacet(T.i,n)}));m=t.upload({conflictBehavior:a,qosData:{uploadId:""+ ++Q},accessToken:l,fileName:i.name,content:i,itemUrl:s,onProgress:d,onPromptForConfictBehavior:function(e){return Promise.reject(e)},onWait:function(e){return f.wait(e)},select:"*,sharepointIds"});g=v?v.token.subscribe(function(){m.cancel()}):void 0;S.label=2;case 2:S.trys.push([2,4,5,6]);return[4,m];case 3:return[2,S.sent()];case 4:b=S.sent();if(V.n.isCanceled(b))throw new $.e;throw new c.e({facets:Object(r.__assign)({},Object(w.t)(b,function(e){switch(e){case"authFailure":case"unauthenticated":case 401:return y.e.pack({});case"nameAlreadyExists":case 409:return y.s.pack({supportsRename:!0})}})||Object(E.n)({},{})),innerError:b});case 5:g&&g();h.dispose();return[7];case 6:return[2]}})})}}var Z=Object(i.i)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,n(G(e))];case 1:t=r.sent().itemResolver;n(t.execute());return[2]}})})}});var ee=n(9),te=n(2869),ne=Object(ee.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(te.e,n)}}}});var re=n(2991),ie=Object(ee.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(te.r,n),validator:re.e}}}});var se=n("react-lib"),oe=n(3241),ue=n(40),ae=n(3906),fe=Object(ee.t)()(function(){return function(){return function(e,t){var n=t.itemKey,r=e.demandItemFacet(te.t,n),i=e.demandItemFacet(oe.e,n);return{isAvailable:r&&!i,deleteWizard:le}}}});var le=Object(ue.t)(function(e,t){var n=t.itemKeys,i=t.defaultRender,s=Object(r.__rest)(t,["itemKeys","defaultRender"]),o=void 0;1===n.length?o=Object(r.__assign)(Object(r.__assign)({},s),{deleteWizardStrings:Object(r.__assign)(Object(r.__assign)({},s.deleteWizardStrings),{confirmText:ae.e})}):n.length>0&&(o=Object(r.__assign)(Object(r.__assign)({},s),{deleteWizardStrings:Object(r.__assign)(Object(r.__assign)({},s.deleteWizardStrings),{confirmText:ae.t})}));var u=o||s;return i?se.createElement(i,Object(r.__assign)({itemKeys:n},u)):null}),ce=Object(ee.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(te.i,n)}}}});var he=Object(ee.t)()(function(){return function(e){return pe}});function pe(e,t){if(1!==t.itemKeys.length)return{};var n=t.itemKeys[0];if(e.demandItemFacet(_.m,n))return{};var i=e.demandItemFacet(u.e,n),s=i?Object(S.t)(i):void 0,o=i?Object(S.n)(i):void 0,a=i&&i.endpoint||"";return{isAvailable:e.demandItemFacet(te.n,n),getDownloadData:s&&o?function(){return(function(e){var t=this,n=e.itemUrl,i=e.driveUrl,s=e.endpoint;return function(o){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u,a,f;return Object(r.__generator)(this,function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,o(Object(x.n)({url:e.itemUrl,driveUrl:i,method:"GET",qosName:"getItemDownloadUrl",endpoint:s}))];case 1:t=r.sent();if(!(u=(function(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)})(n)?t["@microsoft.graph.downloadUrl"]:t["@content.downloadUrl"]))throw new Error("Unable to obtain download URL.");return[2,{method:"GET",url:u}];case 2:if((a=r.sent())instanceof w.e){f=Object(w.t)(a,function(e,t){switch(e){case"unauthenticated":case 401:return y.r.pack({});case"itemNotFound":case 404:return y.a.pack({});case"accessDenied":case 403:return y.e.pack({});default:return y.y.pack({})}});throw new b.e({innerError:a,facets:f})}throw a;case 3:return[2]}})})}})({itemUrl:s,driveUrl:o,endpoint:a})}:void 0}}var de=Object(ee.t)()(function(){return function(e){return ve}});function ve(e,t){var n=t.itemKey,i=e.demandItemFacet(u.e,n);return{isAvailable:!0,getShareLink:function(){return(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!(t=e.driveItem))return[3,2];i=Object(S.t)(t)+"/invite";s=Object(S.n)(t);return[4,n(Object(x.r)({url:i,driveUrl:s,method:"POST",qosName:"getDefaultShareLink",endpoint:t.endpoint,headers:{prefer:"getDefaultLink","Content-type":"application/json"}}))];case 1:if(!(o=r.sent()))throw new Error("Unable to obtain default share URL");return[2,{url:o.value[0].link.webUrl,scope:o.value[0].link.scope}];case 2:throw new Error("Unable to obtain default share URL")}})})}})({driveItem:i})}}}var me=Object(ee.t)()(function(){return function(){return function(){return{}}}});var ge=Object(ee.t)()(function(){return function(e){return ye}});function ye(e,t){var n=t.itemKey,i=t.link,s=t.recipients,o=e.demandItemFacet(u.e,n);return{isAvailable:!0,permissionInvite:function(){return(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,c,h,p,d;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e.driveItem,i=e.link,s=e.recipients;if(!t||!i)throw new Error("Unable to obtain default share URL");o=t.endpoint;a=btoa(i);u="u!"+a.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-");f=s.map(function(e){return{email:e}});l={recipients:f,roles:["read"]};c=o.replace("v1.0","beta");h=c+"/shares/"+u+"/permission/grant";return[4,n(Object(x.r)({url:h,method:"POST",qosName:"permissionGrant",endpoint:t.endpoint,headers:{"Content-type":"application/json",Accept:"application/json"},body:l}))];case 1:p=r.sent();d=p.value[0].grantedToIdentities.map(function(e){return{email:e.user.email}});return[2,{recipients:d}]}})})}})({driveItem:o,link:i,recipients:s})}}}var be=n(3628),we=n(3629),Ee=n(553),Se=n(59),xe=n(162),Te=Object(i.i)({mergeForSameItemKey:!1})(function e(t){var n=this,i=t.itemKey,s=t.options,o=s.isFollowed,a=s.progressItemKey,f=Ee.e.deserialize(i),l=f.driveItemKey,c=l.itemId,h=void 0===c?"":c,p=Object(S.n)(l);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,i,s,c,d,v,m,g,y;return Object(r.__generator)(this,function(b){switch(b.label){case 0:n=t(Object(xe.e)({saveForLaterGraphEndpoint:Se.L})).saveForLaterGraphEndpoint;i=new k.e({publisher:e});s=Ee.e.serialize(f);c=n||l.endpoint;a&&t(Object(X.e)({items:(m={},m[a]=Object(r.__assign)({},T.b.pack({itemKey:u.e.serialize(l)})),m)}));d=o?{url:c+"/drives/"+l.driveId+"/items/"+h+"/follow",method:"POST",qosName:"followItem"}:{url:c+"/drives/"+l.driveId+"/following/"+h,method:"DELETE",qosName:"unfollowItem"};b.label=1;case 1:b.trys.push([1,3,,4]);return[4,t(Object(x.n)({url:d.url,driveUrl:p,method:d.method,qosName:d.qosName,endpoint:c}))];case 2:b.sent();i.invalidateItems({items:(g={},g[s]=[_.E],g)});i.resolveItems({items:(y={},y[s]=Object(r.__assign)({},_.E.pack(o||void 0)),y)});t(i.execute());return[3,4];case 3:v=b.sent();throw new Error(v.message);case 4:return[2]}})})}});var Ne=n(517),Ce=n(954),ke=n(1029),Le=n(2989);function Ae(e,t){return Le.e.serialize(Object(r.__assign)({driveItemKey:e.driveItemKey},t?{searchTerm:t}:{searchTerm:void 0}))}var Oe=Object(ee.t)()(_e),Me=Object(ee.t)()(_e);function _e(){return function(e){return function(e,t){var n,r=t.itemKey,i=e.demandItemFacet(ke.e,r);if(i)n=function(e){return i?Ae(i,e):void 0};else{var s=e.demandItemFacet(Le.e,r);n=function(e){return s?Ae(s,e):void 0}}return{isAvailable:!0,getSearchItemKey:n}}}}var De=n(548),Pe=n(747),He=n(402),Be=Object(ee.t)()(function(){return function(e){return je}});function je(e,t){var n=t.handlers,i=t.itemKey,s=e.demandItemFacet(ke.e,i),o=e.demandItemFacet(Le.e,i);if(n&&(s||o)){for(var u=[],a=0,f=n;a<f.length;a++){var l=f[a];if(l.key===He.u.key)u.push("photo");else if(l.key===He.a.key)u.push("video");else if(l.key===He.t.key)u.push("folder");else if(l.key===He.o.key)u.push("onenote");else if(l.key===He.i.key)u.push("!photo");else if(l.key===He.s.key)u.push("!video");else if(l.key===He.n.key)u.push("!folder");else if(l.key===He.r.key)u.push("!onenote");else{var c=Object(Pe.e)(l);c&&u.push(c)}}if(s)return{itemKey:ke.e.serialize(Object(r.__assign)(Object(r.__assign)({},s),{extFilters:u}))}}return{}}var Fe=n(1108),Ie=n(1550),qe=n(2866),Re=Object(i.i)({mergeForSameItemKey:!1})(function e(t){var n=this,i=t.itemKey,s=t.options,o=Object.keys(s)[0];return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,a,f,l,c,h,p,d,v,m,g,E,T,C;return Object(r.__generator)(this,function(L){switch(L.label){case 0:if(!t(Object(z.e)(function(e){return e.demandItemFacet(u.e,o)})))throw new Error("Source item does not have a driveItem key");n=s[o],a=n.isMove,f=n.conflictBehavior,l=n.progressItemKey;c=u.e.deserialize(i);return[4,t(Object(Ie.e)(function(e){return e.demandItemFacet(u.e,o)}))];case 1:if(!(h=L.sent()))throw new Error("Unable to get metadata for destination item.");p=Object(S.t)(h);d=Object(S.n)(h);v=h.endpoint;L.label=2;case 2:L.trys.push([2,4,,5]);return[4,t(Object(x.n)({url:p+(a?"":"/copy"),driveUrl:d,method:a?"PATCH":"POST",body:{parentReference:{id:c.itemId||qe.n,driveId:c.driveId||""},"@microsoft.graph.conflictBehavior":f},qosName:a?"moveItem":"copyItem",endpoint:v}))];case 3:m=L.sent();(g=new k.e({publisher:e})).invalidateItems({items:(T={},T[o]=a?[_.M,_.l]:[],T[i]=[N.t],T)});l&&!a&&m.name&&g.resolveItems({items:(C={},C[l]=Object(r.__assign)({},_.h.pack(m.name)),C)});t(g.execute());return[3,5];case 4:if((E=L.sent())instanceof w.e&&E.status===b.t)throw new Fe.e({innerError:E,facets:Object(r.__assign)({},y.c.pack(E.status))});throw E;case 5:return[2]}})})}});var Ue=n(1144),ze=Object(ee.t)()(function(){return function(){return function(e,t){return{validator:re.e}}}});var We=n(43),Xe=n(81),Ve=n(755),$e=n(349),Je=n(3623),Ke=n(885),Qe=n(766),Ge=n(2988),Ye=n(223),Ze=n(3448),et=Object(i.i)()(function(e){var t=e.itemKey,n=e.options.itemSetKey;return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,s,o,a,f,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!Ye.e.matches(n))throw new b.e({code:"invalidItemSetForAddToOneDrive"});i=Ye.e.deserialize(n).driveItemKey.endpoint;s=e(Object(z.e)(function(e){return{fileName:e.demandItemFacet(_.d,t),sharepointIds:e.demandItemFacet(Ge.e,t),remoteDriveInfo:e.demandItemFacet(u.e,t)}})),o=s.fileName,a=s.sharepointIds,f=s.remoteDriveInfo;if(!(i&&o&&f&&a))throw new b.e({code:"missingItemInfoForAddToOneDrive"});r.label=1;case 1:r.trys.push([1,3,,4]);return[4,e(Object(Ze.t)({name:o.name,sharepointIds:a,qosName:"AddToOneDrive_SWM",endpoint:i}))];case 2:r.sent();return[3,4];case 3:if(!((l=r.sent())instanceof w.e))throw l;Object(Ze.e)(l);return[3,4];case 4:return[2]}})})}}),tt=Object(Xe.e)(function(){return n.ee(0,4275)},{chunkName:"addon-graph-deferredoperations"}),nt=Object(i.t)(function(){return function(e){var t=e(Object(xe.e)({useBatchedDeleteConfiguration:Se.M})).useBatchedDeleteConfiguration;e(Object(Ke.e)(function(){e(Object(o.e)(ke.e,Ce.e)(Oe));e(Object(o.e)(Le.e,Ce.e)(Me));e(Object(o.e)(ke.e,De.e)(Be));e(Object(s.r)(u.e,a.t)(A));e(t?Object(s.r)(u.e,f.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object(We.o)())];case 1:t.sent();return[4,tt()];case 2:return[2,t.sent().driveItemDeleteItemsBatchedOperationHandler]}})})})):Object(s.r)(u.e,f.t)(M.e));e(Object(s.r)(u.e,l.t)(P));e(Object(s.r)(u.e,c.t)(Z));e(Object(s.r)(u.e,Fe.t)(Re));e(Object(s.r)(u.e,Qe.t)(et));e(Object(o.e)(u.e,h.e)(ne));e(Object(o.e)(u.e,Ue.e)(ze));e(Object(o.e)(u.e,p.e)(ie));e(Object(o.e)(u.e,d.t)(fe));e(Object(o.e)(u.e,v.e)(ce));e(Object(o.e)(u.e,be.e)(de));e(Object(o.e)(u.e,we.e)(ge));e(Object(o.e)(u.e,m.t)(he));e(Object(o.e)(u.e,g.e)(me));e(Object(s.r)(Ee.e,Ne.e)(Te));e(Object(s.r)(Ve.e,$e.e)(Je.e))}))}})}],Array(21),[function(e,t,n){"use strict";n.d(t,"e",function(){return w});var r=n(0),i=n(10),s=n(217),o=n(885),u=n(155),a=n(349),f=n(1134),l=n(1133),c=n(52),h=n(137),p=n(198),d=n(157),v=n(1181),m=n(83),g=n(1),y=n(951);var b=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=l.e.deserialize(n).webAbsoluteUrl;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,l,b,w;return Object(r.__generator)(this,function(E){switch(E.label){case 0:t=new d.t({webAbsoluteUrl:i}).build().segments("Site","ReadOnly").toString();s=e((function(e){return function(t){var n=t(Object(h.e)(function(t){var n=y.e.serialize({webAbsoluteUrl:e.webAbsoluteUrl});return t.demandItemFacet(g.an,n)}));return new v.e({id:"SiteReadOnlyCache"},{pageContext:n})}})({webAbsoluteUrl:i}));o=s.getRequestKey(t,"POST");u=function(){return c.n.resolve(e(Object(m.t)({url:t,webAbsoluteUrl:i,method:"GET",needsRequestDigest:!0,qosName:"SiteReadOnly"})))};return[4,s.getDataUtilizingCache({cacheRequestKey:o,cachingStrategy:1,getData:u})];case 1:a=E.sent();l=-2;a&&a.d&&(a.d.ReadOnly?l=0:!1===a.d.ReadOnly&&(l=-1));(b=new p.e).resolveItems({items:(w={},w[n]=Object(r.__assign)({},f.e.pack(l)),w)});e(b.execute());return[2]}})})}});var w=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Object(o.e)(function(){e(Object(u.t)({keyFacet:l.e,facets:[l.e,f.e]}));e(Object(s.r)(l.e,a.e)(b))}));return[2]})})}})},function(e,t,n){"use strict";n.d(t,"e",function(){return N});var r=n(0),i=n(10),s=n(217),o=n(8),u=n(885),a=n(155),f=n(349),l=n(3412),c=n(52),h=n(137),p=n(158),d=n(6),v=n(198),m=n(157),g=n(1181),y=n(83),b=n(1174),w=n(3648),E=n(1),S=n(951);var x=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=l.e.deserialize(n).webAbsoluteUrl;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,u,a,f,l,x,N;return Object(r.__generator)(this,function(C){switch(C.label){case 0:t=new m.t({webAbsoluteUrl:i}).build().segments("web","SiteUserInfoList","GetItems").parameters({$top:50,$orderby:{raw:"UserExpiration desc"},$select:{raw:"Title,ID,Name,UserExpiration,IsSiteAdmin,EMail"}}).toString();s=e((function(e){return function(t){var n=t(Object(h.e)(function(t){var n=S.e.serialize({webAbsoluteUrl:e.webAbsoluteUrl});return t.demandItemFacet(E.an,n)}));return new g.e({id:"UserExpirationCache"},{pageContext:n})}})({webAbsoluteUrl:i}));u=s.getRequestKey(t,"POST",T);a=function(){return c.n.resolve(e(Object(y.t)({url:t,body:T,webAbsoluteUrl:i,method:"POST",needsRequestDigest:!0,qosName:"GetUsersWithExpirations"})))};return[4,s.getDataUtilizingCache({cacheRequestKey:u,cachingStrategy:1,getData:a})];case 1:f=C.sent();l=[];x=new v.e;f.d.results.forEach(function(e){var t,n=b.e.serialize({id:String(e.ID)});l.push(n);x.resolveItems({items:(t={},t[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},d.h.pack(e.Name)),p.e.pack(e.EMail)),w.t.pack(new Date(e.UserExpiration).getTime())),t)})});x.resolveItems({items:(N={},N[n]=Object(r.__assign)({},o.e.pack({itemKeys:l})),N)});e(x.execute());return[2]}})})}}),T=JSON.stringify({query:{__metadata:{type:"SP.CamlQuery"},ViewXml:"<View><Query><Where><IsNotNull><FieldRef Name='UserExpiration'/></IsNotNull></Where></Query></View>"}});var N=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Object(u.e)(function(){e(Object(a.t)({keyFacet:l.e,facets:[l.e,o.e]}));e(Object(s.r)(l.e,f.e)(x))}));return[2]})})}})}],Array(53),[function(e,t,n){"use strict";n.r(t);n.d(t,"getNeedsAttentionView",function(){return p});var r=n(0),i=n(330),s=n(621),o=n(29),u=n(123),a=n(122),f=n(1),l=n(120),c=n(249),h=n(1173);function p(e,t,n){var p=l.e.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl}),d=n(Object(a.e)({list:f.Re},p)),v=d&&d.list&&d.list.templateType&&Object(o.s)(d.list.templateType),m=v?"LinkTitle":"LinkFilename",g={},y=[];if(e)for(var b=0,w=e;b<w.length;b++){var E=w[b];if(E.contentTypeId&&E.requiredFields&&E.requiredLookups){for(var S={fieldName:"ContentTypeId",operator:"Eq",values:[E.contentTypeId]},x=s.e(S),T=[],N=E.requiredFields.split(","),C=E.requiredLookups.split(","),k=0;k<N.length;k++){var L=N[k],A="True"===C[k];void 0===g[L]&&(g[L]=A);var O={fieldName:L,lookupId:!!A||void 0,operator:"Eq",values:[""]};T.push(O)}var M=s.t(T,"Or");if(M){var _=s.t([x,M],"And");y.push(_)}}}0===y.length&&y.push(s.e({fieldName:"FileLeafRef",operator:"Eq",values:[""]}));var D=Object.keys(g),P=D.map(function(e){return g[e]}),H=Object(r.__spreadArrays)(["DocIcon",m,"Editor","Modified"],D,["FileDirRef"]),B=Object(r.__spreadArrays)([void 0,void 0,void 0,void 0],P,[void 0]),j=!!d&&!!d.list&&!!d.list.templateType&&d.list.templateType===o.n.webPageLibrary,F=new i.e("<View Scope='Recursive'/>");j&&c.e.isFeatureEnabled({ODB:1743})?F.title=u.g:F.title=v?u.m:u.p;F.isReadOnly=!0;F.id=h.e;F.replaceFields(H,B);F.updateSort({fieldName:"ID",isAscending:!0});F.updateRowLimit({rowLimit:30,isPerPage:!0});var I=s.t(y,"Or");F.addFilters([I]);return F}},function(e,t,n){"use strict";n.r(t);n.d(t,"getSPFollowedSitesItemSet",function(){return b});var r=n(0),i=n(10),s=n(6),o=n(1227),u=n(342),a=n(1226),f=n(407),l=n(513),c=n(953),h=n(515),p=n(8),d=n(405),v=n(1),m=n(198),g=n(165),y=n(162),b=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,d,y,b,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B;return Object(r.__generator)(this,function(j){switch(j.label){case 0:t=o.e.deserialize(e.itemKey).tenantRootUrl;i=new m.e;return[4,n(w(t))];case 1:d=j.sent();y=[];b=u.e.serialize({tenantRootUrl:t});E=a.e.serialize({tenantRootUrl:t});for(S=0,x=d.Items;S<x.length;S++){T=x[S];N=f.e.serialize({webAbsoluteUrl:T.Url});C=l.e.serialize({webAbsoluteUrl:T.Url});k=T.ItemReference||{},L=k.SiteId,A=void 0===L?void 0:L,O=k.WebId,M=void 0===O?void 0:O,_=k.GroupId,D=void 0===_?void 0:_;P=c.e.serialize({rootItemKey:b,itemKey:N});i.resolveItems({items:(H={},H[N]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},s.h.pack(T.Title)),v.e.pack(T.Acronym)),v.o.pack(T.BannerColor)),v.u.pack(T.BannerImageUrl)),v.Be.pack(!0)),s.m.pack({})),f.e.pack({webAbsoluteUrl:T.Url})),v.Mt.pack(A)),v.Nn.pack(M)),v.be.pack(D)),p.t.pack({itemKey:C})),H[P]=Object(r.__assign)(Object(r.__assign)({},v.ht.pack(T.PinOrder)),Object(g.e)().forFacet(v.ht).thenInvalidate(E,p.e).forFacet(v.ht).thenInvalidate(e.itemKey,p.e).pack()),H[C]=Object(r.__assign)({},p.s.pack({itemKey:N})),H)});y.push(N)}i.resolveItems({items:(B={},B[e.itemKey]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},s.h.pack(h.e)),p.e.pack({itemKeys:y})),v.ft.pack({itemKey:b})),B)});n(i.execute());return[2]}})})}});function w(e){var t=this;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return!1!==i(Object(y.e)({enableSPHomeServiceConfiguration:v.Z})).enableSPHomeServiceConfiguration?[3,3]:[4,n.ee(29,3865)];case 1:t=r.sent().getFollowedSitesData;return[4,i(t(e))];case 2:return[2,r.sent()];case 3:return[4,i(Object(d.n)(e))];case 4:return[2,r.sent()]}})})}}},function(e,t,n){"use strict";n.r(t);n.d(t,"universalPrintPrinterShareListOperationHandler",function(){return c});var r=n(0),i=n(198),s=n(10),o=n(3411),u=n(1790),a=n(2780),f=n(1179),l=n(2017),c=Object(s.i)()(function e(t){var n=this;return function(s){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,c,h,p,d,v,m,g,y,b,w;return Object(r.__generator)(this,function(E){switch(E.label){case 0:n=t.itemKey;c=s(u.e).dataRequestor;h=new a.e({},{dataRequestor:c});p=f.e.deserialize(n);d=p.endpoint,v=p.printSearchStr,m=p.fileType;return[4,s(Object(l.getSessionToken)(d))];case 1:g=E.sent();return[4,h.getPrinterSharesList({endpoint:d,accessToken:g,printSearchStr:v,fileType:m,topQueryOption:100})];case 2:y=E.sent();(b=new i.e({publisher:e})).resolveItems({items:(w={},w[n]=Object(r.__assign)({},o.e.pack(y)),w)});s(b.execute());return[2]}})})}})},function(e,t,n){"use strict";n.r(t);n.d(t,"itemGetPrintFileUrlOperationHandler",function(){return v});var r=n(0),i=n(10),s=n(82),o=n(738),u=n(137),a=n(198),f=n(737),l=n(889),c=n(1790),h=n(3399),p=n(3625),d=n(2867),v=Object(i.i)()(function e(t){var n=this;return function(i){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,v,m,g,y,b,w,E,S,x,T,N,C,k,L;return Object(r.__generator)(this,function(A){switch(A.label){case 0:n=t.itemKey;v=i(Object(u.e)(function(e){return{hasPdf:e.demandItemFacet(h.e,n),thumbnailSet:e.demandItemFacet(d.e,n)}})),m=v.hasPdf,g=v.thumbnailSet;y=Object(p.t)(g);if(!m||!y)return[3,1];w=Object(f.n)(y.large.url);b={fileUrl:w};return[3,3];case 1:if(!(E=i(Object(u.e)(function(e){return e.demandItem({driveItemKey:s.e},n)})).driveItemKey))return[2];S=Object(l.t)(E);x=Object(l.n)(E);T=E.endpoint;return[4,i(Object(c.n)({url:S,driveUrl:x,method:"GET",qosName:"getItemPrintFileDataUrl",endpoint:T}))];case 2:N=A.sent();if(!(C=(function(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)})(S)?N["@microsoft.graph.downloadUrl"]:N["@content.downloadUrl"]))throw new Error("Unable to obtain Print file URL.");b={fileUrl:C};A.label=3;case 3:(k=new a.e({publisher:e})).resolveItems({items:(L={},L[n]=Object(r.__assign)({},o.n.pack(b)),L)});i(k.execute());return[2]}})})}})},function(e,t,n){"use strict";n.r(t);n.d(t,"printToUniversalPrinterOperationHandler",function(){return y});var r=n(0),i=n(10),s=n(6),o=n(162),u=n(137),a=n(363),f=n(611),l=n(2780),c=n(737),h=n(59),p=n(2879),d=n(738),v=n(2017),m=n(1790),g=n(3643),y=Object(i.i)()(function(e){var t=e.itemKey,n=e.options,i=n.printerId,y=n.config;return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var n,b,w,E,S,x,T,N,C,k,L,A,O;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!(n=e(Object(o.e)({graphEndpoint:h.v})).graphEndpoint))throw new a.e({code:"missingendpointinfoforprinttoup"});return[4,e(Object(v.getSessionToken)(n))];case 1:b=r.sent();w=e(m.e).dataRequestor;E=new l.e({},{dataRequestor:w});r.label=2;case 2:r.trys.push([2,11,,12]);r.label=3;case 3:r.trys.push([3,5,,6]);return[4,e(Object(d.e)({items:(O={},O[t]={},O)}))];case 4:r.sent();return[3,6];case 5:S=r.sent();throw new a.e({facets:p.t.pack({}),innerError:S});case 6:x=e(Object(u.e)(function(e){return{fileName:e.demandItemFacet(s.d,t),printFileData:e.demandItemFacet(d.n,t)}})),T=x.fileName;if(!(N=x.printFileData)||!T||!N.file&&!N.fileUrl)throw new a.e({code:"missingfileinforprinttoup"});C=void 0;if(!N.fileUrl)return[3,8];k=Object(c.i)(T.extension)?c.e:c.t;return[4,Object(g.e)(N.fileUrl,T.name,k)];case 7:C=r.sent();return[3,9];case 8:if(!N.file)throw new a.e({code:"missingfileinforprinttoup"});C=N.file;r.label=9;case 9:L={endpoint:n,printerId:i,file:C,contentType:C.type,config:y,accessToken:b};return[4,E.submitPrintJob(L)];case 10:r.sent();return[3,12];case 11:if(!((A=r.sent())instanceof f.e))throw A;Object(g.t)(A);return[3,12];case 12:return[2]}})})}})},function(e,t,n){"use strict";n.r(t);n.d(t,"printToUniversalPrinterOperationHandler",function(){return y});var r=n(0),i=n(10),s=n(6),o=n(137),u=n(363),a=n(611),f=n(2780),l=n(738),c=n(2017),h=n(1790),p=n(3643),d=n(162),v=n(59),m=n(2879),g=n(737),y=Object(i.i)()(function(e){var t=e.itemKey,n=e.options,i=n.printerId,y=n.config;return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var n,b,w,E,S,x,T,N,C,k,L,A,O;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!(n=e(Object(d.e)({graphEndpoint:v.v})).graphEndpoint))throw new u.e({code:"missinggraphendpointinfoforprinttoup"});return[4,e(Object(c.getSessionToken)(n))];case 1:b=r.sent();w=e(h.e).dataRequestor;E=new f.e({},{dataRequestor:w});r.label=2;case 2:r.trys.push([2,11,,12]);r.label=3;case 3:r.trys.push([3,5,,6]);return[4,e(Object(l.e)({items:(O={},O[t]={},O)}))];case 4:r.sent();return[3,6];case 5:S=r.sent();throw new u.e({facets:m.t.pack({}),innerError:S});case 6:x=e(Object(o.e)(function(e){return{fileName:e.demandItemFacet(s.d,t),printFileData:e.demandItemFacet(l.n,t)}})),T=x.fileName,N=x.printFileData;if(!T||!N||!N.file&&!N.fileUrl)throw new u.e({code:"missingfileinforprinttoup"});C=void 0;if(!N.fileUrl)return[3,8];k=Object(g.i)(T.extension)?g.e:g.t;return[4,Object(p.e)(N.fileUrl,T.name,k)];case 7:C=r.sent();return[3,9];case 8:if(!N.file)throw new u.e({code:"missingfileinforprinttoup"});C=N.file;r.label=9;case 9:L={endpoint:n,printerId:i,file:C,contentType:C.type,config:y,accessToken:b};return[4,E.submitPrintJob(L)];case 10:r.sent();return[3,12];case 11:if(!((A=r.sent())instanceof a.e))throw A;Object(p.t)(A);return[3,12];case 12:return[2]}})})}})}],Array(20),[function(e,t,n){"use strict";n.r(t);n.d(t,"ItemAutoRefresh",function(){return a});n.d(t,"CurrentItemAutoRefresh",function(){return f});var r=n("react-lib"),i=n(26),s=n(40),o=n(3649);function u(e){var t=e.subscribe;r.useLayoutEffect(function(){return t()},[t]);return null}var a=Object(s.t)(function(e,t){var n=t.itemKey,i=e.demandItemFacet(o.e,n),s=o.e.evaluate(i)(e,{itemKey:n,itemSubscriber:null}),a=s.isAvailable,f=s.itemSubscriber,l=s.subscribe;return a?f||(l?r.createElement(u,{subscribe:l}):null):null}),f=Object(i.n)()(a)}],Array(17),[function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointWebBasicActionsAddonDeferred",function(){return f});var r=n(10),i=n(322),s=n(45),o=n(3635),u=n(444),a=n(1543),f=Object(r.t)(function(){return function(e){e(Object(i.e)(s.e,u.e)(o.e));e(a.sharePointBasicActionsAddonDeferred)}})}],Array(115),[function(e,t,n){"use strict";n.r(t);n.d(t,"driveItemDeleteItemsBatchedOperationHandler",function(){return g});var r,i=n(0),s=n(363),o=n(10),u=n(379),a=n(115),f=n(74),l=n(155),c=n(780),h=n(6),p=n(82),d=n(889),v=n(1790),m=n(204);(function(e){e.Completed="completed";e.Failed="failed";e.InProgress="inProgress"})(r||(r={}));var g=Object(o.n)({maxParallelOperationCount:4,timeout:3e5,areSameBatch:function(e,t){var n=p.e.deserialize(e.itemKey).driveId,r=p.e.deserialize(t.itemKey).driveId;return!!n&&!!r&&n===r}})(function(e){var t=this,n=e.items,g=Object.keys(n),y=g.map(function(e){return p.e.deserialize(e)});return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,p,b,w,E,S,x;return Object(i.__generator)(this,function(T){switch(T.label){case 0:e(Object(l.e)({items:Object(a.t)(n,function(e){e.progressItemKey;return Object(i.__assign)(Object(i.__assign)({},f.y.pack({total:1,current:0})),f.p.pack(!0))},function(e,t){return t.progressItemKey})}));t={value:y.map(function(e){return{id:e.itemId,deleted:{}}})};p="";b=Object(d.n)(y[0]);return[4,e(Object(v.n)({url:b+"/items",method:"PATCH",body:t,qosName:"deleteItems",endpoint:y[0].endpoint,parseResponse:function(e){p=e.getResponseHeader("Location")||""}}))];case 1:T.sent();w=0;E=!1;S=!1;Object(u.t)(3e5).then(function(){return S=!0});x=function(){var t;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(Object(v.n)({url:p,qosName:"getOperationStatus",endpoint:y[0].endpoint}))];case 1:t=i.sent();g.forEach(function(){e(Object(l.e)({items:Object(a.t)(n,function(e){e.progressItemKey;return f.y.pack({total:1,current:t.percentageComplete/g.length})},function(e,t){return t.progressItemKey})}))});if(t.status!==r.Completed&&t.status!==r.Failed)return[3,2];E=!0;w=t.summary.failed;return[3,4];case 2:return[4,Object(u.t)(500)];case 3:i.sent();i.label=4;case 4:return[2]}})};T.label=2;case 2:return[5,x()];case 3:T.sent();T.label=4;case 4:if(!E&&!S)return[3,2];T.label=5;case 5:if(S)throw new s.e({facets:Object(i.__assign)({},m.c.pack(408))});e(Object(c.e)({items:Object(a.e)(g,function(){return[h.l]})}));if(w>0)throw new o.e({items:Object(a.e)(g.slice(0,w),function(){return new s.e({facets:Object(i.__assign)({},m.c.pack(500))})})});return[2]}})})}})}],Array(24),[function(e,t,n){"use strict";n.r(t);n.d(t,"graphAddon",function(){return Ds});var r=n(0),i=n(10),s=n(217),o=n(223),u=n(43),a=n(322),f=n(9),l=n(399),c=n(551),h=n(280),p=Object(r.__assign)(Object(r.__assign)({},c.e),{key:h.n,minWidth:32,maxWidth:32}),d=n(2941),v=n(996),m=n(1188),g=n(60),y=n(1046),b=n(632),w=n(24),E=n(147),S=Object(g.i)({name:m.t,key:h.e,fieldName:"",minWidth:g.e.regularMin,maxWidth:g.e.regularMax,isCollapsable:!0,sortProps:g.t},b.e)(function(e,t){var n=e.demandItemFacet(y.e,t),r=n&&new Date(n.sharedDateTime).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(w.T,E.e);return i&&i.language||window.navigator.language?{text:Object(v.r)(new Date(r),!1)}:{dateValue:r}}),x=n(650),T=n(158),N=n(3619),C=n(2868),k=n(3401),L=n("react-lib"),A=n(1486),O=n(993),M=n(22),_=n(1547),D=n(3853),P=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.userName,n=e.isPlaceholder,r=L.createElement(O.e,{className:"topCollaboratorIcon_7990aeb5",iconName:"TeamFavorite"}),i=L.createElement("span",{className:"topCollaboratorUserName_7990aeb5"},t),s=L.createElement("div",{className:"topCollaboratorTooltip_7990aeb5"},M.formatToArray(D.e,i));return L.createElement("div",{className:"topCollaPlaceHolder_7990aeb5"},n?null:t?L.createElement(_.e,{content:s},r):r)};return t})(A.e),H=n(8),B=Object(g.i)({name:m.n,key:h.i,fieldName:"",minWidth:g.e.regularMin,maxWidth:g.e.regularMax,isCollapsable:!0,sortProps:g.r,headerClassName:"columnHeader_7990aeb5"},x.e)(function(e,t){var n=e.demandItem({shareByPerson:N.e},t).shareByPerson,r=e.demandItem({sharedBy:y.e},t).sharedBy,i=n&&n.itemKey,s=n&&n.displayValue||r&&r.sharedBy&&r.sharedBy.user&&r.sharedBy.user.displayName,o=!1;if(i&&C.e.matches(i)){var u=C.e.deserialize(i).email,a=e.demandItemFacet(H.e,k.e.serialize({endpoint:"https://graph.microsoft.com/beta"}));a&&(o=a.itemKeys.slice(0,3).some(function(t){var n=e.demandItemFacet(T.e,t);return!!n&&n===u}))}return i||s?{people:[{itemKey:i||"",displayValue:s}],onRenderUser:function(e,t){if(!e||!t)return null;var n=t(e),r=e.user;return L.createElement("div",{className:"userWithTopCollaborator_7990aeb5"},L.createElement(P,{userName:r.title,isPlaceholder:!o}),n)}}:{people:[]}},function(e,t){return""+e.demandItemFacet(T.e,t)}),j=Object(f.t)()(function(){return function(e){return I}});var F=[p,d.e,S,B];function I(e,t){return{columns:F}}var q=n(6),R=n(742),U=n(155),z=n(349),W=n(162),X=n(82),V=n(889),$=n(1790),J=n(2542),K=n(3572),Q=n(2866),G=n(5),Y=new G.e("driveItem",{endpoint:Object(G.s)(),driveId:Object(G.s)({shouldNormalizeToEmpty:!0}),canonicalUrl:Object(G.s)()}),Z=n(154);function ee(e){var t,n,i,s,o=e.driveItemResponse,u=e.endpoint,a=e.getDriveItemFacets,f=void 0===a?J.e:a,l=o.remoteItem,c=l&&l.parentReference,h=o.parentReference,p=h||c,d=p&&p.driveId,v=p&&p.id,m="personal"===(p&&p.driveType),g=!!o.root;if(l){s=l.id;c&&(d=c.driveId)}else s=m&&o.root?Q.n:o.id;var y={endpoint:u,driveId:d,itemId:s},b=X.e.serialize(y),w=o&&(o.webDavUrl||o.webUrl),E=m&&p&&p.path===Q.e?Q.n:v||void 0,S=p&&E?X.e.serialize({endpoint:u,driveId:p.driveId||d,itemId:E}):void 0,x=[],T="";if(w){var N=new Z.e(w);x.push.apply(x,N.path.split("/").slice(1,-1).map(function(e){return decodeURIComponent(e)}));x.unshift(N.authority);T=x.join("/")}p&&!g&&!E&&T&&(S=Y.serialize({endpoint:u,driveId:p.driveId,canonicalUrl:T}));var C=Object(K.e)(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:b,driveItemKey:y,parentFolderItemKey:S})).itemResolver;C.resolveItems({items:Object(r.__assign)({},S&&(t={},t[S]=Object(r.__assign)({},T?q.O.pack(T):{}),t))});if(l&&c){var k=X.e.serialize({endpoint:u,driveId:h&&h.driveId,itemId:o.id}),L=X.e.serialize({endpoint:u,driveId:c.driveId,itemId:l.id});C.mapKeys({mappings:(n={},n[k]=L,n)});C.resolveItems({items:(i={},i[L]=Object(r.__assign)({},f({driveItem:o,endpoint:u})),i)})}return{itemResolver:C,actualDriveItemKey:y,actualItemKey:b}}var te=n(132),ne=n(1029),re=n(2867),ie=n(2987),se=n(3241),oe=n(554),ue=n(543),ae=n(142),fe=n(41),le=n(1098),ce=n(2769),he=n(2770),pe=n(3617),de=n(2988),ve=n(3243),me=n(3242),ge=n(165),ye=n(2295),be=n(3618),we=n(3399),Ee=n(737),Se=n(3400);function xe(e){var t,n,i,s,o,u,a,f=e.driveItemKey,l=e.driveItem,c=e.endpoint,p=e.parentFolderItemKey,d=e.shouldReturnShareFacets,v=void 0===d||d,m=l.bundle,g=l.coverImage,b=l.file,w=l.fileSystemInfo,E=l.name,S=l.parentReference,x=l.lenses,T=l.remoteItem,N=l.root,C=l.size,k=l.thumbnails,L=l.image,A=l.video,O=l.eTag,M=l.photo,_=l.tags,D=l.specialFolder,P=l.lastModifiedDateTime,B=void 0===P?w&&w.lastModifiedDateTime:P,j=l.createdDateTime||w&&w.createdDateTime,F=(new Date).getTime(),I=j?new Date(j).getTime():void 0,U=I?F-I<1728e5:void 0,z=S&&S.driveId,W=S&&S.driveType,V="personal"===W,$=w&&w.lastAccessedDateTime,J=null===(t=M)||void 0===t?void 0:t.takenDateTime,K=l.package,Q=k,G=L,Y=A,Z=l.shared||(null===(n=l.remoteItem)||void 0===n?void 0:n.shared),ee={itemId:l.id,driveId:z,endpoint:c},xe=w&&w.systemPath,Te=void 0;T&&(Te={itemId:T.id,driveId:T.parentReference&&T.parentReference.driveId||"",endpoint:c});var Ne,Ce=f||ee,ke=X.e.serialize(Ce),Le=l.webDavUrl;Ne="business"!==W&&"documentLibrary"!==W&&"personal"!==W||!N?E||"":ue.e;var Ae,Oe=l.folder||(null===(i=T)||void 0===i?void 0:i.folder);Oe&&(Ae=Z?T?12:5:2);var Me=(null===(o=null===(s=Oe)||void 0===s?void 0:s.folderView)||void 0===o?void 0:o.sortBy)||"",_e="descending"===(null===(a=null===(u=Oe)||void 0===u?void 0:u.folderView)||void 0===a?void 0:a.sortOrder),De=Me&&{columnKey:Object(h.s)(Me),isAscending:!_e},Pe=C,He=Oe&&Oe.childCount,Be=(function(e,t){var n=e.lastIndexOf(".");if(t||n<0)return{name:e,extension:""};return{name:e.substring(0,n),extension:e.substring(n)}})(Ne,!!Oe),je=Be.extension||l.package&&l.package.type,Fe=je&&Object(pe.e)(je),Ie=l.sharepointIds,qe=l.localItem,Re=l.webUrl,Ue=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},void 0!==Pe?q.v.pack(Pe):{}),Re?q.O.pack(Re):{}),De?H.u.pack(De):{}),Te?se.e.pack(Te):{}),Le?q.i.pack(decodeURIComponent(Le)):{}),qe?R.t.pack(qe):{}),"number"==typeof He?fe.e.pack(He):{}),Fe?he.e.pack(Fe):{}),Ie?de.e.pack(Ie):{}),D?ve.e.pack(D.name):{});return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},X.e.pack(Ce)),q.h.pack(Ne)),R.r.pack(xe)),q.f.pack(B?new Date(B).getTime():void 0)),q.u.pack(I)),ae.u.pack(J?new Date(J).getTime():void 0)),q.S.pack(U)),te.i.pack(K&&"oneNote"===K.type?{}:void 0)),Object(ge.e)().forFacet(ae.v).thenInvalidate(ke,re.e).pack()),ie.e.pack(l)),H.t.pack({itemKey:ne.e.serialize({driveItemKey:Ce,sortBy:Me,isAscending:!_e})})),q.n.pack({itemKey:oe.e.serialize({driveItemKey:Ce})})),q.M.pack(p?{itemKey:p}:void 0)),le.e.pack(W)),q.d.pack(Be)),ye.e.pack(m)),be.e.pack(g)),R.n.pack(b&&b.mimeType)),he.t.pack(x&&x.length>0?x:void 0)),Se.e.pack(_)),w||Oe||b?Object(r.__assign)({},q.m.pack(Oe?{}:void 0)):{}),$?Object(r.__assign)({},q.o.pack(new Date($).getTime())):{}),Q?Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.e.pack(Q)),me.e.pack(!0)),we.e.pack(Object(Ee.i)(Be.extension))):{}),O?q.p.pack(O):{}),G&&G.width&&G.height?ae.a.pack({width:G.width,height:G.height}):{}),G&&!Y?ae.p.pack({}):{}),Y?ae.g.pack({}):{}),V?Object(r.__assign)({},ce.e.pack(l.vault)):{}),v?Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.x.pack(!!Z)),y.e.pack(Z)),Ae?te.e.pack(Ae):{}):{}),Ue)}function Te(e){var t=e.driveItemResponse,n=e.endpoint,i=t.parentReference,s=i&&i.driveId,o=i&&i.id,u=t.id;t.root&&(u=Q.n);var a={endpoint:n,driveId:s,itemId:u},f=X.e.serialize(a),l=i&&i.path===Q.e?Q.n:o||void 0,c=i&&l?X.e.serialize({endpoint:n,driveId:i.driveId,itemId:l}):void 0;return{itemResolver:Object(K.e)(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:f,driveItemKey:a,getDriveItemFacets:xe,parentFolderItemKey:c})).itemResolver,actualDriveItemKey:a,actualItemKey:f}}var Ne=n(131),Ce=n(59);function ke(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e.endpoint;i=n(Object(W.e)({getUserOneDriveEndpoint:Ce.d,graphEndpoint:Ce.v})),s=i.getUserOneDriveEndpoint;return(o=i.graphEndpoint)&&t!==o&&s?[4,n(s({endpoint:t}))]:[3,2];case 1:u=r.sent();t=u;r.label=2;case 2:return[2,t]}})})}}var Le=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=X.e.deserialize(n);return function(s){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l,c,h,p,d,v,m;return Object(r.__generator)(this,function(g){switch(g.label){case 0:t=i;return i.driveId&&"me"!==i.driveId?[3,2]:[4,s(ke({endpoint:i.endpoint}))];case 1:(o=g.sent())!==i.endpoint&&(t=Object(r.__assign)(Object(r.__assign)({},i),{endpoint:o}));g.label=2;case 2:u=Object(V.n)(t);a=s(Object(W.e)({disableRemoteItemInPlace:Ce.r})).disableRemoteItemInPlace;f=a?Te:ee;return[4,s(Object($.r)({url:Object(V.t)(t)+"?$expand=thumbnails",driveUrl:u,qosName:"getItem",endpoint:t.endpoint}))];case 3:l=g.sent();c=f({driveItemResponse:l,endpoint:t.endpoint}),h=c.itemResolver,p=c.actualItemKey;h.resolveItems({items:(d={},d[e.itemKey]=Object(r.__assign)({},Ne.r.pack(X.e)),d)});h.mapKeys({mappings:(v={},v[p]=n,v)});i.driveId&&"me"!==i.driveId||h.mapKeys({mappings:(m={},m[X.e.serialize(Object(r.__assign)(Object(r.__assign)({},i),{driveId:"me"}))]=X.e.serialize(Object(r.__assign)(Object(r.__assign)({},i),{driveId:""})),m[n]=X.e.serialize(t),m)});s(h.execute());return[2]}})})}});var Ae=n(1040),Oe=n(4052),Me=n(3620),_e=n(815),De=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=oe.e.deserialize(n).driveItemKey,s=i.endpoint;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l,c,h=this;return Object(r.__generator)(this,function(p){t={Caller:"HoverCard"};o=e(Object(W.e)({enableCookiesForAnalyticsRequests:Ce.u})).enableCookiesForAnalyticsRequests,u=void 0!==o&&o;"GetItemAnalytics_addon-graph";a=Object(r.__awaiter)(h,void 0,void 0,function(){var o,a,f,l,c,h;return Object(r.__generator)(this,function(p){switch(p.label){case 0:return[4,e(Object($.r)({url:(d=Object(V.t)(i),v=Pe(d),m="$expand=analytics($expand=allTime($expand=activities))",g="$select=*,id,reactions,trending",y=g+"&"+m+",insights($expand=keyPoints)",b=v+"?"+y,b),qosName:"GetItemAnalytics_addon-graph_GetAnalyticsSections",endpoint:s,timeout:6e3,headers:t,driveUrl:Pe(Object(V.n)(i)),allowCookies:u}))];case 1:o=p.sent();a=Object(Oe.t)(o);if(f=a.createdBy){l=C.e.serialize({email:f.email,endpoint:s});e(Object(U.e)({items:(c={},c[l]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.h.pack(f.displayName)),T.e.pack(f.email)),T.r.pack(f.image)),T.i.pack(f.id)),c[n]=Object(r.__assign)({},Ae.r.pack({itemKey:l,displayValue:f.displayName})),c)}))}e(Object(U.e)({items:(h={},h[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Ae.h.pack(a.viewCount)),Ae.p.pack(a.viewerCount)),Ae.o.pack(a.isTrending)),Ae.e.pack(a.activities)),Ae.f.pack(a.likeCount)),Ae.t.pack(a.commentCount)),Ae.a.pack(a.lifeCycleStatus)),Ae.u.pack(a.keyPointsData)),Ae.s.pack(a.incompleteData)),Ae.i.pack(a.createdDateTime)),h)}));return[2]}var d,v,m,g,y,b})});f=[a];l=Object(r.__awaiter)(h,void 0,void 0,function(){var o,a,f,l;return Object(r.__generator)(this,function(c){switch(c.label){case 0:return[4,e(Object($.r)({url:(h=Object(V.t)(i),p=Pe(h),p+"?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities)),conversationSet($expand=emailConversations($expand=participants),meetingConversations($expand=participants),teamsConversations($expand=participants))"),qosName:"GetItemAnalytics_addon-graph_GetRecommendedActionsAndConversations",endpoint:s,timeout:6e3,headers:t,driveUrl:Pe(Object(V.n)(i)),allowCookies:u}))];case 1:o=c.sent();a=(function(e){var t=e.recommendedActionSet,n=t.nonAggregatedRecommendedActions;t.aggregatedEditRecommendedAction&&t.aggregatedEditRecommendedAction.recentEditorCount&&(n=n.concat(t.aggregatedEditRecommendedAction));return n})(o);f=(function(e){var t=e.conversationSet,n=t.emailConversations.concat(t.meetingConversations,t.teamsConversations),r={},i=[];n.forEach(function(e){var t=e.teamsMessageThreadId||e.conversationInstance.conversationId;if(!r.hasOwnProperty(t)){r[t]=!0;i.push({activityTimestamp:e.conversationInstance.sharedByTime,context:e.conversationInstance.subject,conversationType:Me.e[e.conversationInstance.referenceType],deepLink:e.conversationInstance.deepLink,referencePreview:e.conversationInstance.referencePreview,isSharedByMe:e.conversationInstance.isSharedByMe,sharedByUserDisplayName:e.sharedByUser.displayName,sharedByUserEmail:e.sharedByUser.email,participants:e.participants})}});return i.sort(function(e,t){return Date.parse(t.activityTimestamp)-Date.parse(e.activityTimestamp)})})(o);e(Object(U.e)({items:(l={},l[n]=Object(r.__assign)(Object(r.__assign)({},Ae.l.pack(a)),Ae.n.pack(f)),l)}));return[2]}var h,p})});f.push(l);e(Object(U.e)({items:(c={},c[n]=Object(r.__assign)({},Ae.c.pack([])),c)}));return[2,Object(_e.e)(f)]})})}});function Pe(e){return e.replace("2.0","2.1")}var He=new G.e("specialDriveItem",{endpoint:Object(G.s)(),driveId:Object(G.s)({shouldNormalizeToEmpty:!0}),name:Object(G.s)()}),Be=n(198),je=n(244),Fe=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=He.deserialize(i),o=s.driveId,u=s.endpoint,a=Object(V.n)(s);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,f,l,c,h,p,d,v,m;return Object(r.__generator)(this,function(g){switch(g.label){case 0:return[4,t(Object($.n)({url:Object(V.i)(s),driveUrl:a,qosName:"getItem",endpoint:u}))];case 1:n=g.sent();f=new Be.e({publisher:e});l=n&&n.parentReference;c=l&&l.driveId;h={endpoint:u,driveId:c||o,itemId:n.id};p=X.e.serialize(h);d=l&&l.id?X.e.serialize({endpoint:u,driveId:c,itemId:l.id}):void 0;f.resolveItems({items:(v={},v[p]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Object(J.e)({driveItem:n,endpoint:u,parentFolderItemKey:d})),je.n.pack(X.e)),H.t.pack({itemKey:ne.e.serialize({driveItemKey:h,sortBy:"",isAscending:!0})})),v)});f.mapKeys({mappings:(m={},m[p]=i,m)});t(f.execute());return[2]}})})}});var Ie=new G.e("driveItemPage",{endpoint:Object(G.s)(),setItemKey:Object(G.s)(),token:Object(G.s)()}),qe=n(211);function Re(e){return e.reduce(function(e,t){return e&&t?"("+e+" or "+t+")":t||e})}function Ue(e){return e.reduce(function(e,t){return e&&t?"("+e+" and "+t+")":t||e})}function ze(e){return function(t){for(var n=void 0,r=void 0,i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}if("."===u[0])if(t.name){var a=new RegExp(u.toLocaleLowerCase()+"$"),f=t.name.toLocaleLowerCase().split(a),l=2===f.length&&""===f[1]||!1;o?n=void 0!==n?n&&!l:l:r=r||l}else{n=!1;r=!1}else if("folder"===u){var c=void 0!==t.folder||void 0!==t.remoteItem&&void 0!==t.remoteItem.folder||!1;o?n=void 0!==n?n&&!c:c:r=r||c}else if("onenote"===u){var h=t.package&&"oneNote"===t.package.type||t.remoteItem&&t.remoteItem.package&&"oneNote"===t.remoteItem.package.type||!1;o?n=void 0!==n?n&&!h:h:r=r||h}}return void 0===r?void 0!==n&&n:(void 0===n||n)&&!r}}var We=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=Ie.deserialize(i),o=s.setItemKey,u=s.endpoint,a=s.token,f=G.e.get(o).deserialize(o),l=f.extFilters,c=f.driveItemKey,h=Object(V.n)(c),p=ne.e.matches(o);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,f,c,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_;return Object(r.__generator)(this,function(D){switch(D.label){case 0:return[4,t(Object($.n)({endpoint:u,url:a,driveUrl:h,qosName:"getChildrenPage"}))];case 1:n=D.sent();s=l&&l.length>0?ze(l):void 0;f=new Be.e({publisher:e});c=[];d=0,v=n.value;D.label=2;case 2:if(!(d<v.length))return[3,5];m=v[d];if(!!s&&s(m))return[3,4];g=m&&(m.parentReference||m.remoteItem&&m.remoteItem.parentReference);y=g&&g.driveId;b=X.e.serialize({itemId:m.id,driveId:y,endpoint:u});w=null===(M=g)||void 0===M?void 0:M.id;E=(null===(_=g)||void 0===_?void 0:_.path)===Q.e?Q.n:w||void 0;S=g?X.e.serialize({itemId:E,driveId:y,endpoint:u}):void 0;x=t(Object(W.e)({allowDisableRemoteItemInPlace:Ce.r,processDriveItemFromSharePoint:Ce.T})),T=x.allowDisableRemoteItemInPlace,N=x.processDriveItemFromSharePoint;C=p&&T?xe:J.e;c.push(b);f.resolveItems({items:(O={},O[b]=Object(r.__assign)(Object(r.__assign)({},C({driveItem:m,endpoint:u,parentFolderItemKey:S})),Object(ge.e)().forFacet(q.h).thenInvalidate(i,H.e).forFacet(q.l).thenInvalidate(i,H.e).pack()),O)});return N?[4,t(N.process({itemKey:b,driveItem:m}))]:[3,4];case 3:k=D.sent().itemResolver;f.merge(k);D.label=4;case 4:d++;return[3,2];case 5:if(L=n["@odata.nextLink"]){A=Ie.serialize({setItemKey:o,endpoint:u,token:L});f.merge(Object(qe.t)({itemKey:A}).itemResolver);c.push(A)}f.merge(Object(qe.e)({itemKey:i,itemSetKey:o,childItemKeys:c}).itemResolver);t(f.execute());return[2]}})})}});var Xe=n(365),Ve=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=Xe.e.deserialize(i);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,u;return Object(r.__generator)(this,function(a){(n=new Be.e({publisher:e})).resolveItems({items:(u={},u[i]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},H.t.pack({itemKey:o.e.serialize({driveItemKey:s,sortBy:"",isAscending:!0})})),q.h.pack(ue.i)),q.m.pack({})),q.M.pack(void 0)),u)});t(n.execute());return[2]})})}});var $e=n(337),Je=n(299),Ke=n(48),Qe=n(137),Ge=n(2),Ye=new Ge.e("itemSetEngagementExtraData");function Ze(e){return function(t){var n,i,s,o,u,a=e.itemKey,f=e.parentItemKey,l=e.itemSetKeyFacet,c=e.filterChildItems,h=e.onProcessResponse,p=e.groupChildItems,d=e.response,v=e.skip,m=void 0===v?0:v,g=e.enableRandomAccess,y=void 0!==g&&g,b=e.disableRemoteItem,w=e.totalChildCount,E=e.getDriveItemFacets,S=l.deserialize(a),x=S.driveItemKey.endpoint,T=new Be.e({publisher:Ze}),N=t(Object(Je.e)({name:"remoteItemsMissingParentRef"})),C="number"==typeof d["@odata.count"]?d["@odata.count"]:w||d.value.length,k=d["@odata.nextLink"],L=!!k,A=t(Object(Qe.e)(function(e){return{childItemsFacetResolved:e.isItemFacetResolved(H.e,a),prevChildKeys:e.demandItemFacet(H.e,a)}})),O=A.childItemsFacetResolved,M=A.prevChildKeys,_=M&&M.itemKeys,D=0,P=0;y&&(O&&_?u=_.slice(0):"number"==typeof C&&(u=new Array(C+(L&&C<=d.value.length?1:0))));u||(u=new Array(d.value.length+(L?1:0)));for(var B=m,j=0,F=0,I=d.value;F<I.length;F++){var q=I[F],R=c&&c(q),U=q.remoteItem,z=!(q.remoteItem&&q.remoteItem.parentReference&&q.remoteItem.parentReference.driveId),X=U&&z;X&&j++;if(R||X){u.splice(B,1);C--}else{var V=t(Object(W.e)({graphEndpoint:Ce.v,graphRecentEndpoint:Ce.y,processDriveItemSet:Ce.N,allowDisableRemoteItemInPlace:Ce.r})),$=V.graphEndpoint,J=V.graphRecentEndpoint,K=V.processDriveItemSet,Q=V.allowDisableRemoteItemInPlace&&b,G=Q?Te:ee,Y=q.webDavUrl||!Q&&q.remoteItem&&q.remoteItem.webDavUrl||q.webUrl,te=x.indexOf("/_api/v2.0")>-1||x.indexOf("/_api/v2.1")>-1,ne=$||J;if(Y&&te){var re=Y&&decodeURIComponent(Y);x=ne?new Z.e(re).authority+"/_api/v2.0":""+new Z.e(re).authority+new Z.e(x).path}var ie=G({shouldInvalidateItemSetOnChildItemRename:K&&K.shouldInvalidateItemSetOnChildItemRename,setItemKey:a,driveItemResponse:q,endpoint:x,getDriveItemFacets:E}),se=ie.itemResolver,oe=ie.actualItemKey,ue=ie.actualDriveItemKey,ae=q.thumbnails,le=q.remoteItem;D++;(ae||!Q&&le&&le.thumbnails)&&P++;u[B]=oe;T.merge(se);if(h){var ce=h({itemKey:a,driveItemKey:ue,item:q});ce&&T.merge(ce.itemResolver)}var he=t(Object(W.e)({processDriveItemFromSharePoint:Ce.T})).processDriveItemFromSharePoint;if(he&&(te||ne)){var pe=t(he.process({itemKey:oe,driveItem:q})).itemResolver;T.merge(pe)}B++}}t(N(Object(r.__assign)({resultType:j<1?Ke.e.Success:Ke.e.Failure},j>0?{extraData:{count:j}}:{})));if(L){var de=Ie.serialize({setItemKey:a,endpoint:x,token:k});T.merge(Object(qe.t)({itemKey:de}).itemResolver);u[B]=de}if(p){var ve=p(S);ve&&T.merge(ve.itemResolver)}else T.resolveItems({items:(n={},n[a]=Object(r.__assign)({},H.e.pack({itemKeys:u})),n)});T.resolveItems({items:(i={},i[a]=Object(r.__assign)({},Ye.pack({childCount:D,childCount_withThumbnail:P})),i)});C!==w&&T.resolveItems({items:(s={},s[f]=Object(r.__assign)({},fe.e.pack(C)),s)});T.resolveItems({items:(o={},o[a]=Object(r.__assign)(Object(r.__assign)({},H.s.pack({itemKey:f})),Object(ge.e)().forFacet(H.e).thenInvalidate($e.e).pack()),o)});return{itemResolver:T}}}var et=n(179),tt=n(116);function nt(e){var t=e.itemKey,n=e.itemSetKeyFacet,i=e.parentItemKeyFacet,s=e.childItemsResponse,o=e.disableRemoteItem,u=e.parentItemResponse,a=e.mapItemSetKey,f=n.deserialize(t),l=i.serialize(f.driveItemKey),c=f.driveItemKey.endpoint;return function(n){var i,f;tt.n(et.e.processData.start);var h=n(Ze(Object(r.__assign)(Object(r.__assign)({},e),{response:s,disableRemoteItem:o,parentItemKey:l}))).itemResolver;if(a){var p=a().itemResolver;h.merge(p)}var d=n(Object(W.e)({allowDisableRemoteItemInPlace:Ce.r})).allowDisableRemoteItemInPlace;if(u){var v=(d&&o?Te:ee)({setItemKey:t,driveItemResponse:u,endpoint:c}),m=v.itemResolver,g=v.actualItemKey;h.mapKeys({mappings:(i={},i[g]=l,i)});h.merge(m)}h.resolveItems({items:(f={},f[l]=Object(r.__assign)({},Object(ge.e)().forFacet(H.t).thenInvalidate(e.itemKey,H.e).pack()),f)});tt.n(et.e.processData.end);return{itemResolver:h}}}var rt=n(363);function it(e){var t=this,n=e.itemKey,i=e.itemSetKeyFacet,s=e.getUrl,o=e.sortChildItems,u=e.qosName,a=e.preprocessResponse,f=e.expectedErrors,l=e.disableRemoteItem,c=void 0!==l&&l,h=i.deserialize(n),p=h.driveItemKey.endpoint;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,l,d,v,m;return Object(r.__generator)(this,function(g){switch(g.label){case 0:t=Object(V.n)(h.driveItemKey);g.label=1;case 1:g.trys.push([1,4,,5]);return[4,n(Object($.r)({url:s(h),driveUrl:t,qosName:"getChildren"+(u?"."+u:""),endpoint:p,headers:e.additionalHeaders,expectedErrors:f}))];case 2:i=g.sent();l=Object(r.__spreadArrays)(i.value);d=a&&a(l)||i.value;v=o&&o(d)||d;return[4,n(nt(Object(r.__assign)(Object(r.__assign)({},e),{disableRemoteItem:c,childItemsResponse:Object(r.__assign)(Object(r.__assign)({},i),{value:v})})))];case 3:return[2,{itemResolver:g.sent().itemResolver}];case 4:m=g.sent();throw new rt.e(Object(r.__assign)({code:"UnknownError"},m instanceof Error?{innerError:m}:{message:JSON.stringify(m)}));case 5:return[2]}})})}}var st=n(92),ot=n(618),ut=n(999),at=n(212);function ft(e,t){var n=new Date(e.valueOf());n.setDate(n.getDate()-t);return n}var lt=n(1908),ct="fileName",ht="sharedByName",pt="dateModified";var dt=new Map([["code",st.e.text],["csv",st.e.excel],["docx",st.e.word],["dotx",st.e.word],["one",st.e.onenote],["onepkg",st.e.onenote],["onetoc",st.e.onenote],["pdf",st.e.pdf],["photo",st.e.media],["potx",st.e.powerpoint],["ppsx",st.e.powerpoint],["pptx",st.e.powerpoint],["rtf",st.e.text],["txt",st.e.text],["video",st.e.media],["xlsx",st.e.excel],["xltx",st.e.excel],["zip",st.e.zip]]);function vt(e,t){var n,r,i=(n=e,r=Object(ot.t)(n,!0),Object(ut.t)(r)),s=dt.get(i);return!!s&&Object(st.t)(t.filters,s)}function mt(e,t){void 0===t&&(t=[]);return t.every(function(t){var n,r=!(t.type===ht)||(function(e,t){var n=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName;return!!n&&t.indexOf(n)>-1})(e,t.values),i=!(t.type===ct)||(function(e,t){return!!e.name&&vt(e.name,t)})(e,Object(at.t)(t.values)),s=!(t.type===pt)||(function(e,t){var n=e.lastModifiedDateTime||"";return(n&&new Date(n))>=t})(e,(function(e){var t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());switch(e){case lt.e.today:return n;case lt.e.yesterday:return ft(n,1);case lt.e.last7Days:return ft(n,7);case lt.e.last30Days:return ft(n,30);case lt.e.last3Months:return ft(n,90);default:return new Date(0)}})((n=t.values).length<1||-1===Object.keys(lt.e).indexOf(n[0])?lt.e.none:lt.e[n[0]]));return r&&i&&s})}var gt=n(240);function yt(e,t,n){var r=e.lastModifiedDateTime,i=t.lastModifiedDateTime,s=r&&i&&new Date(r).getTime()-new Date(i).getTime()||0,o=r&&i&&new Date(i).getTime()-new Date(r).getTime()||0;return n?s:o}function bt(e,t,n){var r=e&&e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedDateTime,i=t&&t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedDateTime,s=r&&i&&new Date(r).getTime()-new Date(i).getTime()||0,o=r&&i&&new Date(i).getTime()-new Date(r).getTime()||0;return n?s:o}function wt(e,t,n){var r=e.name,i=t.name,s=r&&i&&r.localeCompare(i)||0,o=r&&i&&i.localeCompare(r)||0;return n?s:o}function Et(e,t,n){var r=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName,i=t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedBy&&t.remoteItem.shared.sharedBy.user&&t.remoteItem.shared.sharedBy.user.displayName,s=r&&i&&r.localeCompare(i)||0,o=r&&i&&i.localeCompare(r)||0;return n?s:o}function St(e,t,n,i){return(function(e,t){return Object(r.__spreadArrays)(e).sort(t)})(e,function(e,r){var s=e.folder,o=r.folder;return n&&s&&!o?-1:n&&!s&&o?1:i(e,r,t)})}var xt=n(3621),Tt=n(3850),Nt=n(536),Ct=n(38),kt=n(3622);function Lt(e){if(o.e.matches(e)){var t=o.e.deserialize(e).groupBy;if(t===h.t[h.i])return(function(e){var t={},n=function(i){for(var s,o,u=new Be.e({publisher:n}),a=(function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];if(!xt.n.matches(i))return e;var s=xt.n.deserialize(i);t.push(s)}return t.sort(function(e,t){return e&&t&&e.displayName.localeCompare(t.displayName)}).map(function(e){return xt.n.serialize(e)})})(Object.keys(t)),f=[],l=0,c=a;l<c.length;l++){var h=c[l];if(xt.n.matches(h)){var p=xt.n.deserialize(h);u.resolveItems({items:(s={},s[h]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.h.pack(p.displayName)),fe.s.pack(!0)),H.e.pack({itemKeys:t[h]})),s)});f.push(h)}}u.resolveItems({items:(o={},o[e]=Object(r.__assign)(Object(r.__assign)({},H.e.pack({itemKeys:f})),Ct.e.pack(!0)),o)});return{itemResolver:u}};return{onProcessResponse:function(e){var n,r=e.driveItemKey,i=e.item;if(i&&r){var s=i.remoteItem,o=s&&s.shared&&s.shared.sharedBy,u=o&&o.user,a=X.e.serialize(r);if(u&&u.email){var f=xt.n.serialize({displayName:u.displayName,email:u.email});if(n=f,t.hasOwnProperty(n))t[f].push(a);else{t[f]=[];t[f].push(a)}}}},groupChildItems:n}})(e);if(t===h.t[h.e])return(function(e){var t={},n=function(i){for(var s,o,u=new Be.e({publisher:n}),a=(function(e){for(var t={},n=(function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];if(!xt.e.matches(i))return e;var s=xt.e.deserialize(i);t.push(s)}return t.sort(function(e,t){return e&&t&&new Date(t.sharedDateTime).getTime()-new Date(e.sharedDateTime).getTime()}).map(function(e){return xt.e.serialize(e)})})(Object.keys(e)),r=function(e){return t.hasOwnProperty(e)},i=0,s=n;i<s.length;i++){var o=s[i];if(xt.e.matches(o)){var u=xt.e.deserialize(o).relativeTime,a=xt.t.serialize({relativeTime:u});if(r(a))for(var f=e[o],l=0,c=f;l<c.length;l++){var h=c[l];t[a].push(h)}else{t[a]=[];f=e[o];for(var p=0,d=f;p<d.length;p++){h=d[p];t[a].push(h)}}}}return t})(t),f=[],l=0,c=Object.keys(a);l<c.length;l++){var h=c[l];if(xt.t.matches(h)){var p=xt.t.deserialize(h).relativeTime;u.resolveItems({items:(s={},s[h]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.h.pack(p)),fe.s.pack(!0)),H.e.pack({itemKeys:a[h]})),s)});f.push(h)}}u.resolveItems({items:(o={},o[e]=Object(r.__assign)(Object(r.__assign)({},H.e.pack({itemKeys:f})),Ct.e.pack(!0)),o)});return{itemResolver:u}};return{onProcessResponse:function(e){var n,r=e.driveItemKey,i=e.item;if(i&&r){var s=i.remoteItem,o=s&&s.shared&&s.shared.sharedDateTime,u=X.e.serialize(r);if(o){var a=(function(e,t){if(!e)return Tt.n;var n=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=n)return Nt.today;n.setDate(n.getDate()-1);if(e>=n)return Nt.yesterday;n.setDate(t.getDate()-t.getDay());if(e>=n)return Tt.i;n.setDate(n.getDate()-7);if(e>n)return Tt.t;var r=new Date(t.getFullYear(),t.getMonth(),1),i=new Date(t.getFullYear(),t.getMonth()-1,1);if(e>=i&&e<r)return Tt.e;n.setDate(n.getDate()-7);if(e>n)return Tt.o;n.setDate(n.getDate()-7);if(e>n)return Tt.s;if(e>=r)return Tt.r;var s=t.getFullYear()===e.getFullYear(),o=kt.e[e.getMonth()];if(s)return o;return M.format(Nt.MonthAndYear,o,e.getFullYear())})(new Date(o),new Date),f=xt.e.serialize({relativeTime:a,sharedDateTime:o});if(n=f,t.hasOwnProperty(n))t[f].push(u);else{t[f]=[];t[f].push(u)}}}},groupChildItems:n}})(e)}return{onProcessResponse:void 0,groupChildItems:void 0}}var At=Object(i.i)()(function(e){var t=this,n=o.e.deserialize(e.itemKey),i=n.filters,s=n.sortBy,u=n.isAscending;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,a,f,l,c,p,d,v;return Object(r.__generator)(this,function(m){switch(m.label){case 0:t=Lt(e.itemKey),a=t.onProcessResponse,f=t.groupChildItems;l=o.e.deserialize(e.itemKey);c=l.driveItemKey.endpoint;p=n(Object(W.e)({graphSharedWithMeEndpoint:Ce.b})).graphSharedWithMeEndpoint;c=p||c;d=n(Object($.i)(c));return[4,n(it(Object(r.__assign)(Object(r.__assign)({},e),{qosName:"sharedWithMe",itemSetKeyFacet:o.e,parentItemKeyFacet:Xe.e,getUrl:function(e){return d?c+"/drive/oneDrive.sharedWithMe":c+"/me/drive/sharedWithMe?expand=formats&allowExternal=true&$top=500"},filterChildItems:function(e){return!mt(e,i)},sortChildItems:function(e){return(function(e,t,n,r){void 0===r&&(r=!1);var i=h.t[h.e],s=h.t[h.i],o=h.t[gt.t],u=h.t[h.r],a=h.t[gt.r];switch(t){case i:return St(e,n,r,bt);case s:return St(e,n,r,Et);case o:case a:return St(e,n,r,wt);case u:return St(e,n,r,yt);default:return e}})(e,s,u,!0)},onProcessResponse:a,groupChildItems:f})))];case 1:v=m.sent().itemResolver;n(v.execute());return[2]}})})}});var Ot=new G.e("sharedByMeRootItem",{endpoint:Object(G.s)()}),Mt=new G.e("sharedByMeItemSet",{driveItemKey:Object(G.o)(X.e)}),_t=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=Ot.deserialize(i);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,o;return Object(r.__generator)(this,function(u){(n=new Be.e({publisher:e})).resolveItems({items:(o={},o[i]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},H.t.pack({itemKey:Mt.serialize({driveItemKey:s})})),q.h.pack(ue.r)),q.m.pack({})),q.M.pack(void 0)),o)});t(n.execute());return[2]})})}});var Dt=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(i){switch(i.label){case 0:return[4,n(it(Object(r.__assign)(Object(r.__assign)({},e),{qosName:"sharedByMe",itemSetKeyFacet:Mt,parentItemKeyFacet:Ot,getUrl:function(e){return e.driveItemKey.endpoint+"/drive/shared"}})))];case 1:t=i.sent().itemResolver;n(t.execute());return[2]}})})}});var Pt=n(368),Ht=n(224),Bt=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=Ht.e.deserialize(i);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,o,u;return Object(r.__generator)(this,function(a){n=t(Object(W.e)({groupBy:Ce.k})).groupBy;(o=new Be.e({publisher:e})).resolveItems({items:(u={},u[i]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},H.t.pack({itemKey:Pt.e.serialize({driveItemKey:s,sortBy:"",isAscending:!0,groupBy:n||""})})),q.h.pack(ue.t)),q.m.pack({})),q.M.pack(void 0)),u)});t(o.execute());return[2]})})}});var jt=n(754),Ft=n(302),It=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=Ft.e.deserialize(i);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,o;return Object(r.__generator)(this,function(u){(n=new Be.e({publisher:e})).resolveItems({items:(o={},o[i]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},H.t.pack({itemKey:jt.e.serialize({driveItemKey:s,sortBy:"",isAscending:!0})})),q.h.pack(ue.n)),q.m.pack({})),q.M.pack(void 0)),o)});t(n.execute());return[2]})})}});var qt,Rt=n(118),Ut=new G.e("recentGroup",{recentItemSet:Object(G.o)(Pt.e),relativeTime:Object(G.r)({today:"today",yesterday:"yesterday",thisWeek:"thisWeek",lastWeek:"lastWeek",twoWeeksAgo:"twoWeeksAgo",threeWeeksAgo:"threeWeeksAgo",thisMonth:"thisMonth",lastMonth:"thisMonth",twoMonthsAgo:"twoMonthsAgo",older:"older"})});(function(e){e.today="today";e.yesterday="testerday";e.thisWeek="thisWeek";e.lastWeek="lastWeek";e.twoWeeksAgo="twoWeeksAgo";e.threeWeeksAgo="threeWeeksAgo";e.thisMonth="thisMonth";e.lastMonth="lastMonth";e.twoMonthsAgo="twoMonthsAgo";e.older="older"})(qt||(qt={}));function zt(e){var t=new Date;return(function(e,t){return Wt(t,e)})(e,t)?qt.today:(function(e,t){return Wt(new Date(t.getTime()-864e5),e)})(e,t)?qt.yesterday:(function(e,t){var n=t.setHours(0,0,0,0)-864e5*t.getDay();return e.getTime()>n})(e,t)?qt.thisWeek:(function(e,t){var n=t.setHours(0,0,0,0)-864e5*(t.getDay()+7);return e.getTime()>n})(e,t)?qt.lastWeek:(function(e,t){var n=t.setHours(0,0,0,0)-12096e5;return e.getTime()>n})(e,t)?qt.twoWeeksAgo:(function(e,t){var n=t.setHours(0,0,0,0)-18144e5;return e.getTime()>n})(e,t)?qt.threeWeeksAgo:(function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()})(e,t)?qt.thisMonth:(function(e,t){var n=t.getMonth(),r=e.getMonth();return n-r==11||t.getFullYear()===e.getFullYear()&&t.getMonth()-e.getMonth()==1})(e,t)?qt.lastMonth:(function(e,t){var n=t.getFullYear(),r=e.getFullYear(),i=t.getMonth(),s=e.getMonth(),o=n-r==1&&i-s==-10;return n===r&&i-s==2||o})(e,t)?qt.twoMonthsAgo:qt.older}function Wt(e,t){return e.toDateString()===t.toDateString()}var Xt=n(3852);var Vt=function(e,t){var n=new RegExp("^"+t+"\\/","i");return e.filter(function(e){var t=e&&e.remoteItem||e;return!(!t||!t.file)&&n.test(t.file.mimeType)})},$t=Object(i.i)()(function(e){var t=this,n=Pt.e.deserialize(e.itemKey),i=n.filters,s=void 0===i?[]:i,o=n.groupBy,u=void 0===o?"":o,a=n,f=Object(at.e)({extFilters:Object(at.t)(s),allowedMediaTypes:[st.e.photo,st.e.video],fileTypeIconMap:Rt.e}),l=Object(at.e)({extFilters:Object(at.t)(s),allowedMediaTypes:[st.e.photo],fileTypeIconMap:Rt.e}),c=Object(at.e)({extFilters:Object(at.t)(s),allowedMediaTypes:[st.e.video],fileTypeIconMap:Rt.e});return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,o,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,B,j,F,I,R,U;return Object(r.__generator)(this,function(z){switch(z.label){case 0:t=n(Object(W.e)({graphRecentEndpoint:Ce.y,enableOverflowRecentGroup:Ce.l})),i=t.graphRecentEndpoint,o=t.enableOverflowRecentGroup;if(!i)return[3,1];a=Object(r.__assign)(Object(r.__assign)({},a),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},a.driveItemKey),{endpoint:i})});return[3,3];case 1:return[4,n(ke({endpoint:a.driveItemKey.endpoint}))];case 2:(h=z.sent())!==a.driveItemKey.endpoint&&(a=Object(r.__assign)(Object(r.__assign)({},a),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},a.driveItemKey),{endpoint:h})}));z.label=3;case 3:p=Pt.e.serialize(a);d=Ut.serialize({recentItemSet:a,relativeTime:"today"});v=Ut.serialize({recentItemSet:a,relativeTime:"yesterday"});m=Ut.serialize({recentItemSet:a,relativeTime:"thisWeek"});g=Ut.serialize({recentItemSet:a,relativeTime:"lastWeek"});y=Ut.serialize({recentItemSet:a,relativeTime:"twoWeeksAgo"});b=Ut.serialize({recentItemSet:a,relativeTime:"threeWeeksAgo"});w=Ut.serialize({recentItemSet:a,relativeTime:"lastMonth"});E=Ut.serialize({recentItemSet:a,relativeTime:"twoMonthsAgo"});S=Ut.serialize({recentItemSet:a,relativeTime:"older"});x=[];T=[];N=[];C=[];k=[];L=[];A=[];O=[];M=[];_="";D="date"===u;P=function(e){var t,n=e.driveItemKey,i=e.item,s=new Be.e({publisher:P});if(i&&n){var o=i.remoteItem,u=o&&o.fileSystemInfo,a=u&&u.lastAccessedDateTime,f=X.e.serialize(n);if(D&&a){var l=new Date(a);switch(zt(l)){case qt.today:x.push(f);break;case qt.yesterday:T.push(f);break;case qt.thisWeek:N.push(f);break;case qt.lastWeek:C.push(f);break;case qt.twoWeeksAgo:k.push(f);break;case qt.threeWeeksAgo:L.push(f);break;case qt.lastMonth:A.push(f);break;case qt.twoMonthsAgo:O.push(f);_=kt.e[l.getMonth()];break;case qt.older:default:M.push(f)}}s.resolveItems({items:(t={},t[f]=Object(r.__assign)({},q.m.pack(void 0)),t)});return{itemResolver:s}}};B=!f&&D?function(t){var n,i,s=new Be.e({publisher:B});s.resolveItems({items:(n={},n[d]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.h.pack(Xt.s)),fe.s.pack(!0)),H.e.pack({itemKeys:x})),n[v]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.h.pack(Xt.u)),fe.s.pack(!0)),H.e.pack({itemKeys:T})),n[m]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.h.pack(Xt.r)),fe.s.pack(!0)),H.e.pack({itemKeys:N})),n[g]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.h.pack(Xt.t)),fe.s.pack(!0)),H.e.pack({itemKeys:C})),n[y]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.h.pack(Xt.o)),fe.s.pack(!0)),H.e.pack({itemKeys:k})),n[b]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.h.pack(Xt.i)),fe.s.pack(!0)),H.e.pack({itemKeys:L})),n[w]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.h.pack(Xt.e)),fe.s.pack(!0)),H.e.pack({itemKeys:A})),n[E]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.h.pack(_)),fe.s.pack(!0)),H.e.pack({itemKeys:O})),n[S]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.h.pack(Xt.n)),fe.s.pack(!0)),H.e.pack({itemKeys:M})),n)});var u=[];x.length>0&&u.push(d);T.length>0&&u.push(v);N.length>0&&u.push(m);C.length>0&&u.push(g);k.length>0&&u.push(y);L.length>0&&u.push(b);A.length>0&&u.push(w);O.length>0&&u.push(E);M.length>0&&o&&u.push(S);s.resolveItems({items:(i={},i[e.itemKey]=Object(r.__assign)({},H.e.pack({itemKeys:u})),i)});return{itemResolver:s}}:void 0;j=n(Object($.i)(a.driveItemKey.endpoint));F=[{code:"notAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"notAllowed",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"notAllowed",message:"Operation not allowed"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}];return[4,n(it(Object(r.__assign)(Object(r.__assign)({},e),{qosName:f?"recentMedia":j?"ODC-recent":"recent",itemKey:p,itemSetKeyFacet:Pt.e,parentItemKeyFacet:Ht.e,getUrl:function(e){var t=Object(V.n)({endpoint:e.driveItemKey.endpoint,driveId:"me"})+"/recent?";if(j)t=e.driveItemKey.endpoint+"/drive/view.recent?";else if(f){return t+="$filter=(remoteItem/image ne null or remoteItem/video ne null)&$expand=thumbnails"}return""+t+(function(e){if(!e||0===e.length)return"";for(var t=[],n=[],i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}"folder"===u?!o&&t.push("folder ne null"):"onenote"===u?o?n.push("(remoteItem/package/type ne 'oneNote' and package/type ne 'oneNote')"):t.push("(remoteItem/package/type eq 'oneNote' or package/type eq 'oneNote')"):"."!==u[0]||!o&&t.push("(endsWith(name, '"+u.toLowerCase()+"') or endsWith(remoteItem/name, '"+u.toLowerCase()+"'))")}return t.length>0||n.length>0?"&$filter="+(0===n.length?Re(t):0===t.length?Ue(n):Ue(Object(r.__spreadArrays)([Re(t)],n))):""})(s)},getDriveItemFacets:function(e){var t=Object(J.e)(e),n=e.driveItem,i=n.thumbnails,s=n.remoteItem,o=i||s&&s.thumbnails;return Object(r.__assign)(Object(r.__assign)({},t),o?Object(r.__assign)({},me.e.pack(!1)):{})},expectedErrors:F,preprocessResponse:function(e){l?e=Vt(e,"image"):c&&(e=Vt(e,"video"));return(function(e){if(!e)return e;return e.filter(function(e,t,n){return n.map(function(e){return e.id}).indexOf(e.id)===t})})(e.sort(function(e,t){var n=e.remoteItem&&e.remoteItem.fileSystemInfo&&e.remoteItem.fileSystemInfo.lastAccessedDateTime,r=t.remoteItem&&t.remoteItem.fileSystemInfo&&t.remoteItem.fileSystemInfo.lastAccessedDateTime;return n||r?n?r?n>r?-1:1:-1:1:0}))},additionalHeaders:f?{Prefer:"ApiVersion=2.1,RecentOnlyMediaApp,NoPreAuthThumbnailUrls"}:{Prefer:"ApiVersion=2.1;ODC,returnparentresource,returnowner"},onProcessResponse:P,groupChildItems:B})))];case 4:I=z.sent().itemResolver;f&&I.resolveItems({items:(R={},R[e.itemKey]=Object(r.__assign)({},fe.u.pack({})),R)});I.mapKeys({mappings:(U={},U[p]=e.itemKey,U)});n(I.execute());return[2]}})})}});var Jt=n(553);function Kt(e){var t,n,r=e.name&&(t=e.name,n=".aspx",t.substr(t.length-n.length)===n),i=e.package||e.remoteItem&&e.remoteItem.package,s=i&&"oneNote"===i.type;return r||s||!1}var Qt=Object(i.i)()(function e(t){var n=this;return function(i){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,o,u,a,f;return Object(r.__generator)(this,function(l){switch(l.label){case 0:n=i(Object(W.e)({saveForLaterGraphEndpoint:Ce.L})).saveForLaterGraphEndpoint;s=jt.e.deserialize(t.itemKey);if(!n||n===s.driveItemKey.endpoint)return[3,1];s=Object(r.__assign)(Object(r.__assign)({},s),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},s.driveItemKey),{endpoint:n})});return[3,3];case 1:return[4,i(ke({endpoint:s.driveItemKey.endpoint}))];case 2:(o=l.sent())!==s.driveItemKey.endpoint&&(s=Object(r.__assign)(Object(r.__assign)({},s),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},s.driveItemKey),{endpoint:o})}));l.label=3;case 3:u=jt.e.serialize(s);a=[{code:"provisioningNotAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Unable to retrieve user's mysite URL."},{code:"InvalidAuthenticationToken",message:"Access token has expired."},{code:"resourceBeingProvisioned",message:"The requested resource is being automatically provisioned. Please try again in a few minutes."}];return[4,i(it(Object(r.__assign)(Object(r.__assign)({},t),{itemKey:u,qosName:"savedForLater",itemSetKeyFacet:jt.e,parentItemKeyFacet:Ft.e,getUrl:function(e){if(e.driveItemKey.endpoint===n){return e.driveItemKey.endpoint+"/me/drive/following?top=5000&select="+["followed","name","parentReference","webDavUrl","webUrl","id","size","lastModifiedBy","lastModifiedDateTime","sharepointIds"].join(",")}return e.driveItemKey.endpoint+"/drives/me/followed?top=5000&select=*,webDavUrl"},onProcessResponse:function(t){var n,i,s=t.itemKey,o=t.driveItemKey,u=t.item,a=new Be.e({publisher:e});if(o&&u){var f=X.e.serialize(o),l=Jt.e.serialize({driveItemKey:o}),c=u&&(u.webDavUrl||u.webUrl);a.resolveItems({items:(n={},n[f]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},q.g.pack({itemKey:l})),q.i.pack(c)),q.v.pack(u.size)),n[l]=Object(r.__assign)(Object(r.__assign)({},q.E.pack(!0)),Object(ge.e)().forFacet(q.E).thenInvalidate(s,H.e).pack()),n)});a.invalidateItems({items:(i={},i[s]=[H.e],i)})}return{itemResolver:a}},filterChildItems:Kt,getDriveItemFacets:function(e){var t=e.driveItem,n=t.root,i=t.remoteItem,s=t.name,o=n?ue.e:s||i&&i.name||"",u=!t.webDavUrl,a=t.followed&&t.followed.followedDateTime;return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Object(J.e)(Object(r.__assign)(Object(r.__assign)({},e),{shouldReturnShareFacets:!1}))),q.d.pack(Object(J.t)(o,u))),a?q.a.pack(new Date(a).getTime()):{}),q.m.pack(u?{}:void 0))},mapItemSetKey:function(){var n,r=new Be.e({publisher:e});r.mapKeys({mappings:(n={},n[u]=t.itemKey,n)});return{itemResolver:r}},expectedErrors:a})))];case 4:f=l.sent().itemResolver;i(f.execute());return[2]}})})}});var Gt=n(3623),Yt=n(1550),Zt=Object(i.n)()(function e(t){var n=this,i=t.items;return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,S;return Object(r.__generator)(this,function(x){switch(x.label){case 0:return[4,t(Object(Qe.e)(function(e){return e.demandItemFacet(w.h,E.e)}))];case 1:if(!x.sent())return[2];n=Object.keys(i);s=n[0];o=Jt.e.deserialize(s);if(!(u=o.driveItemKey.endpoint))throw new Error("No endpoint to determine followed items.");a=jt.e.serialize({driveItemKey:{endpoint:u},sortBy:"",isAscending:!0});return[4,t(Object(Yt.e)(function(e){return e.demandItemFacet(H.e,a)}))];case 2:f=x.sent();l=f&&f.itemKeys||[];c=new Be.e({publisher:e});h={};for(p=0,d=l;p<d.length;p++){y=d[p];h[y]=!0}for(v=0,m=n;v<m.length;v++){g=m[v];y=Jt.e.deserialize(g).driveItemKey;b=!!h[X.e.serialize(y)];c.resolveItems({items:(S={},S[g]=Object(r.__assign)(Object(r.__assign)({},q.E.pack(b||void 0)),Object(ge.e)().forFacet(q.E).thenInvalidate(a,H.e).pack()),S)})}t(c.execute());return[2]}})})}});var en=n(2989),tn=new G.e("searchRootItem",{endpoint:Object(G.s)()}),nn=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(s){switch(s.label){case 0:t=[{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}];return[4,n(it(Object(r.__assign)(Object(r.__assign)({},e),{qosName:"search",itemSetKeyFacet:en.e,parentItemKeyFacet:tn,getUrl:function(e){var t,n=e.driveItemKey,r=e.searchTerm;r&&(t=encodeURIComponent(r));return Object(V.t)(n)+"/search(q='"+t+"')?$expand=thumbnails&select=*,webDavUrl"},expectedErrors:t})))];case 1:i=s.sent().itemResolver;n(i.execute());return[2]}})})}});var rn=new Ge.e("convergenceConfigurationFacet"),sn=n(204),on=n(611);var un=n(3398);function an(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,B,j,F,I,q,R,U,z,J,K,Q,G;return Object(r.__generator)(this,function(Y){switch(Y.label){case 0:t=e.itemKey,i=e.top,s=e.skip,o=e.disableRemoteItemInPlace;u=ne.e.deserialize(t);a=u.driveItemKey,f=u.extFilters;l=u.sortBy,c=u.isAscending;h=u;p=a;return a.driveId&&"me"!==a.driveId?[3,2]:[4,n(ke({endpoint:a.endpoint}))];case 1:if((d=Y.sent())!==a.endpoint){p=Object(r.__assign)(Object(r.__assign)({},a),{endpoint:d});h=Object(r.__assign)(Object(r.__assign)({},u),{driveItemKey:p})}Y.label=2;case 2:v=X.e.serialize(p);m=Object(V.n)(p);return[4,n(Object(Qe.e)(function(e){return{isParentItemResolved:e.isItemFacetResolved(X.e,v),totalChildCount:e.isItemFacetResolved(fe.e,v)?e.demandItemFacet(fe.e,v):void 0,driveType:e.isItemFacetResolved(le.e,v)?e.demandItemFacet(le.e,v):void 0}}))];case 3:g=Y.sent(),y=g.isParentItemResolved,b=g.totalChildCount,w=g.driveType;E=n(Object($.i)(p.endpoint));S=n(Object(W.e)({convergenceConfiguration:rn})).convergenceConfiguration;x=S&&S.canHandleUserMigration;T=Promise.resolve(void 0);y||(T=n(Object($.r)({url:Object(V.t)(p),driveUrl:m,useMultiPartIfSupported:E,qosName:"getItem",endpoint:p.endpoint,headers:E&&x?{Prefer:"Migration=EnableRedirect;FailOnMigratedFiles"}:void 0})));N=[{code:"notAllowed",message:"You do not have access to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"ItemNotFound"},{code:"503"},{code:"userContentMigrated"}];C=Object(V.t)(a);k=s?"&skiptoken="+(s+1)+"/"+b+"&skip="+s:"";L=un.e?"&orderby=folder,savedSortFieldValue":"";A=l&&void 0!==c?Object($.t)(l,c):L;O=(function(e){if(!e||0===e.length)return"";for(var t=[],n=[],i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}if("folder"===u&&1===e.length)!o&&t.push("folder ne null");else if("."!==u[0]);else{t=[];n=[]}}return t.length>0||n.length>0?"&$filter="+(0===n.length?Re(t):0===t.length?Ue(n):Ue(Object(r.__spreadArrays)([Re(t)],n))):""})(f);M="thumbnails"+(E?",lenses,tags":"");_=n(Object($.r)({url:C+"/children?$top="+i+k+A+"&$expand="+M+"&select=*,ocr,webDavUrl"+O,driveUrl:m,qosName:"getChildren.folder",useMultiPartIfSupported:E,endpoint:p.endpoint,headers:E&&x?{Prefer:"Migration=EnableRedirect;FailOnMigratedFiles"}:void 0,expectedErrors:N})).catch(function(t){throw n((function(e,t){var n=e.error;return function(i){var s,o=(function(e,t){var n=Object(Ge.n)({},{});e instanceof on.e&&(n=Object(on.t)(e,function(e){switch(e){case 404:return sn.p.pack({});case 401:return sn.e.pack({});case 0:return sn.g.pack({domain:new Z.e(t).domain})}})||Object(Ge.n)({},{}));return n})(n,t),u=Object(Ge.r)({itemNotFoundError:sn.p,accessDeniedError:sn.e,networkBlockedError:sn.g},o),a=u.itemNotFoundError,f=u.accessDeniedError,l=u.networkBlockedError,c=new rt.e({facets:o,innerError:new rt.e(n)});if(a||f||l){var h=new Be.e;h.updateItems({items:(s={},s[e.itemKey]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},H.e.pack(void 0)),H.o.pack(void 0)),Ne.e.pack(c)),s)});i(h.execute())}return c}})(Object(r.__assign)(Object(r.__assign)({},e),{error:t}),p.endpoint))});D=[_,T];P=!1;if(!tt.t(et.e.dataFetch.start)){tt.n(et.e.dataFetch.start);P=!0}return[4,Promise.all(D)];case 4:B=Y.sent(),j=B[0],F=B[1];P&&tt.n(et.e.dataFetch.end);if(F){F.folder&&(b=F.folder.childCount);F.parentReference&&F.parentReference.driveType&&(w=F.parentReference.driveType)}I=n(Object($.s)(p.endpoint,w));(q=new Be.e({publisher:an})).mapKeys({mappings:(z={},z[ne.e.serialize(h)]=e.itemKey,z[v]=X.e.serialize(u.driveItemKey),z)});if(!u.driveItemKey.driveId||"me"===u.driveItemKey.driveId){(null===(G=null===(Q=F)||void 0===Q?void 0:Q.parentReference)||void 0===G?void 0:G.driveId)&&q.mapKeys({mappings:(J={},J[ne.e.serialize(Object(r.__assign)(Object(r.__assign)({},h),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},h.driveItemKey),{driveId:F.parentReference.driveId})}))]=e.itemKey,J)});q.mapKeys({mappings:(K={},K[X.e.serialize(Object(r.__assign)(Object(r.__assign)({},u.driveItemKey),{driveId:"me"}))]=X.e.serialize(Object(r.__assign)(Object(r.__assign)({},u.driveItemKey),{driveId:""})),K)})}U=(R=q).merge;return[4,n(nt({itemKey:t,itemSetKeyFacet:ne.e,parentItemKeyFacet:X.e,parentItemResponse:F,childItemsResponse:j,disableRemoteItem:o,filterChildItems:f&&f.length>0?ze(f):void 0,skip:s,enableRandomAccess:I,totalChildCount:b,onProcessResponse:function(e){var t,n=e.driveItemKey,i=new Be.e({publisher:an});n&&i.resolveItems({items:(t={},t[X.e.serialize(n)]=Object(r.__assign)({},Ne.r.pack(X.e)),t)});return{itemResolver:i}}}))];case 5:U.apply(R,[Y.sent().itemResolver]);return[2,q]}})})}}var fn=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(s){switch(s.label){case 0:t=n(Object(W.e)({pageSize:Ce.i})).pageSize;return[4,n(an(Object(r.__assign)(Object(r.__assign)({},e),{disableRemoteItemInPlace:!0,skip:0,top:t||Q.t})))];case 1:i=s.sent();tt.n(et.e.resolveData.start);n(i.execute());tt.n(et.e.resolveData.end);return[2]}})})}});var ln=n(885),cn=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Object(ln.e)(function(){e(Object(U.t)({keyFacet:ne.e,facets:[ne.e,H.e]}));e(Object(s.r)(ne.e,z.e)(fn))}));return[2]})})}}),hn=n(755),pn=n(3397),dn=n(3396),vn=Object(i.i)()(function e(t){var n=this;return function(i){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,o,u,a,f,l;return Object(r.__generator)(this,function(c){switch(c.label){case 0:n=t.itemKey;s=dn.e.deserialize(n);o=s.endpoint;u=Object(V.n)(s);return[4,i(mn({url:Object(V.e)(s),driveUrl:u,qosName:"commands",endpoint:o}))];case 1:a=c.sent();(f=new Be.e({publisher:e})).resolveItems({items:(l={},l[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},pn.e.pack(a.addToOneDrive)),pn.t.pack(a.createFolder)),pn.n.pack(a.createLink)),pn.r.pack(a.delete)),pn.i.pack(a.download)),pn.s.pack(a.invite)),pn.o.pack(a.move)),pn.u.pack(a.officeLens)),pn.a.pack(a.rename)),pn.f.pack(a.upload)),l)});i(f.execute());return[2]}})})}});function mn(e){var t=this;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,{addToOneDrive:{roles:["write"]},createFolder:{roles:["owner","write"]},createLink:{defaultScope:"anonymous",linkTypes:["view","edit"],scopes:["anonymous","application"]},delete:{roles:["owner","write"]},download:{roles:["owner","write","read"]},invite:{roles:["owner","write"]},move:{roles:["owner","write"]},officeLens:{extensions:["jpeg","jpg","jpe"],lensNames:["officeLens"],roles:["owner"]},rename:{roles:["owner","write"]},upload:{roles:["owner","write"]}}]})})}}var gn=n(3624),yn=n(238),bn=n(3625),wn=n(1049),En=n(548),Sn=n(747),xn=n(402),Tn=Object(f.t)()(function(){return function(e){return Nn}});function Nn(e,t){var n=t.handlers,i=t.itemKey,s=e.demandItemFacet(Pt.e,i);if(n&&s){for(var o=[],u=0,a=n;u<a.length;u++){var f=a[u];if(f.key===xn.u.key)o.push("photo");else if(f.key===xn.a.key)o.push("video");else if(f.key===xn.t.key)o.push("folder");else if(f.key===xn.o.key)o.push("onenote");else if(f.key===xn.i.key)o.push("!photo");else if(f.key===xn.s.key)o.push("!video");else if(f.key===xn.n.key)o.push("!folder");else if(f.key===xn.r.key)o.push("!onenote");else{var l=Object(Sn.e)(f);l&&o.push(l)}}return{itemKey:Pt.e.serialize(Object(r.__assign)(Object(r.__assign)({},s),{filters:o}))}}return{}}var Cn=n(732),kn=n(403),Ln=n(208),An=Object(f.t)()(Mn),On=Object(f.t)()(Mn);function Mn(){return function(e){return function(e,t){var n=t.itemKey;if(n){var r=e.demandItemFacet(Pt.e,n);if(r&&r.filters&&Object(at.e)({extFilters:Object(at.t)(r.filters),allowedMediaTypes:[st.e.photo,st.e.video],fileTypeIconMap:Rt.e}))return{defaultLayout:Ln.e,isLayoutResolved:!0}}return{}}}}var _n=n(473),Dn=new G.e("sharesItem",{endpoint:Object(G.s)(),shareId:Object(G.s)()}),Pn=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=Dn.deserialize(i),o=s.endpoint;return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,u,a,f,l,c,h,p,d;return Object(r.__generator)(this,function(v){switch(v.label){case 0:return[4,t(Object($.n)({url:Object(V.r)(s)+"?$expand=thumbnails&select=*,webDavUrl",qosName:"getSharesItem",endpoint:o,headers:{Prefer:"redeemSharingLinkIfNecessary"}}))];case 1:n=v.sent();u=new Be.e({publisher:e});a=n&&n.parentReference;f=a&&a.driveId;l={endpoint:o,driveId:f,itemId:n.id};c=X.e.serialize(l);h=a&&a.id?X.e.serialize({endpoint:o,driveId:f,itemId:a.id}):void 0;u.resolveItems({items:(p={},p[c]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Object(J.e)({driveItem:n,endpoint:o,parentFolderItemKey:h})),je.n.pack(X.e)),H.t.pack({itemKey:ne.e.serialize({driveItemKey:l,sortBy:"",isAscending:!0})})),p)});u.mapKeys({mappings:(d={},d[c]=i,d)});t(u.execute());return[2]}})})}});var Hn=n(1266),Bn=new G.e("driveItemVirtualizedPage",{endpoint:Object(G.s)(),setItemKey:Object(G.s)(),skip:Object(G.i)(),top:Object(G.i)()}),jn=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Bn.deserialize(n),s=i.setItemKey,o=i.top,u=i.skip;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(a){switch(a.label){case 0:return[4,n(an(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:s,disableRemoteItemInPlace:!1,skip:u,top:o})))];case 1:(t=a.sent()).resolveItems({items:(i={},i[s]=Object(r.__assign)({},Object(ge.e)().forFacet(H.e).thenInvalidate(e.itemKey,H.e).pack()),i)});n(t.execute());return[2]}})})}});var Fn=n(81),In=n(1349),qn=Object(Fn.e)(function(){return n.ee(0,4038)},{chunkName:"graphaddondeferred"}),Rn=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:e(Object(ln.e)(function(){e(Object(U.t)({keyFacet:X.e,facets:[X.e,q.h,q.v,q.m,se.e,q.O,q.f,H.t,q.M,q.i,q.p,R.r]}));e(Object(U.t)({keyFacet:Ie,facets:[Ie,H.e,H.r]}));e(Object(U.t)({keyFacet:Xe.e,facets:[Xe.e,q.h,q.v,q.m,q.O,q.i,q.f,H.t,q.M,R.r]}));e(Object(U.t)({keyFacet:o.e,facets:[o.e,H.e]}));e(Object(U.t)({keyFacet:Ot,facets:[Ot,q.h,q.v,q.m,q.O,q.i,q.f,H.t,q.M,R.r]}));e(Object(U.t)({keyFacet:Mt,facets:[Mt,H.e]}));e(Object(U.t)({keyFacet:Ht.e,facets:[Ht.e,q.h,q.v,q.m,q.O,q.f,H.t,q.M,R.r]}));e(Object(U.t)({keyFacet:Pt.e,facets:[Pt.e,H.e]}));e(Object(U.t)({keyFacet:Ft.e,facets:[Ft.e,q.h,q.v,q.m,q.O,q.f,H.t,q.M]}));e(Object(U.t)({keyFacet:dn.e,facets:[pn.e,pn.t,pn.n,pn.r,pn.i,pn.s,pn.o,pn.u,pn.a,pn.f]}));e(Object(U.t)({keyFacet:oe.e,facets:[Ae.h]}));e(cn);e(Object(s.r)(X.e,z.e)(Le));e(Object(s.r)(Bn,z.e)(jn));e(Object(s.r)(oe.e,z.e)(De));e(Object(s.r)(He,z.e)(Fe));e(Object(s.r)(Dn,z.e)(Pn));e(Object(s.r)(Ie,z.e)(We));e(Object(s.r)(Xe.e,z.e)(Ve));e(Object(s.r)(o.e,z.e)(At));e(Object(s.r)(Ot,z.e)(_t));e(Object(s.r)(Mt,z.e)(Dt));e(Object(s.r)(Ht.e,z.e)(Bt));e(Object(s.r)(Ft.e,z.e)(It));e(Object(s.r)(Pt.e,z.e)($t));e(Object(s.r)(jt.e,z.e)(Qt));e(Object(s.r)(en.e,z.e)(nn));e(Object(U.t)({keyFacet:Jt.e,facets:[q.E]}));e(Object(s.r)(Jt.e,z.e)(Zt));e(Object(s.r)(hn.e,z.e)(Gt.e));e(Object(s.r)(dn.e,z.e)(vn));e(Object(a.e)(X.e,yn.e)(gn.t));e(Object(a.e)(ne.e,yn.e)(gn.t));e(In.e);e(Object(a.e)(Pt.e,En.e)(Tn));e(Object(a.e)(Pt.e,Cn.e)(An));e(Object(a.e)(Pt.e,kn.e)(On));e(Object(a.e)(X.e,wn.e)(bn.e));e(Hn.e)}));return[4,e(Object(u.o)({waitIndefinitely:!0}))];case 1:r.sent();r.label=2;case 2:r.trys.push([2,4,,5]);return[4,qn()];case 3:if(!(t=r.sent().graphAddonDataOnlyDeferred))throw new Error("Couldn't load extended Microsoft Graph features.");e(t);return[3,5];case 4:n=r.sent();e(Object(_n.e)({error:n}));return[3,5];case 5:return[2]}})})}}),Un=n(1300),zn=n(559),Wn=n(926),Xn=Object(f.t)()(function(){return function(){return function(e,t){var n=t.setItemKey,r=e.demandItemFacet(ne.e,n);if(!n||!r)return{};var i=r.driveItemKey.endpoint,s=X.e.serialize(r.driveItemKey),o=e.demandItemFacet(le.e,s),u=e.demandItemFacet(Ce.i,E.e)||Q.t,a=e.demandItemFacet(Ce.O,E.e);if(a&&a(i,o)){return{totalItemCount:e.demandItemFacet(fe.e,s),getPageKey:function(e,t){return Bn.serialize({setItemKey:n,endpoint:r.driveItemKey.endpoint,skip:e,top:t-e})},pageSize:u}}return{}}}});var Vn=n(445),$n=n(918),Jn=n(170),Kn=n(1123),Qn=Object(g.i)({key:new Ge.e("dateTakenColumn").id,name:Jn.t,fieldName:"",minWidth:g.e.regularMin,maxWidth:g.e.regularMax,isCollapsable:!0,sortProps:g.t},Kn.t)(function(e,t){return function(){return{itemKey:t}}},function(e,t){return""+e.demandItemFacet(ae.u,t,{suppressGetItems:!0})}),Gn=n(795),Yn=n(967),Zn=n(924),er=n(401),tr=Object(f.t)()(function(){return function(e){return ir}});var nr=[c.e,Vn.e,$n.e,Zn.e,Gn.e,Yn.e],rr=[c.e,Vn.e,$n.e,Qn,Gn.e,Yn.e];function ir(e,t){var n,r,i=t.itemSetKey;if(i){var s=Object(er.e)(e,{itemKey:i});if("photo"===(null===(r=null===(n=e.demandItemFacet(ie.e,s))||void 0===n?void 0:n.folder)||void 0===r?void 0:r.folderType))return{columns:rr}}return{columns:nr}}var sr=n(657),or=Object(i.t)(function(){return function(e){e(Object(a.e)(X.e,sr.e)(Object(f.n)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object(u.o)())];case 1:t.sent();return[4,n.ee(59,4158)];case 2:return[2,t.sent().driveItemActivityFieldControlHandler]}})})})))}}),ur=n(286),ar=n(27),fr=Object(f.t)()(function(){return function(e){return lr}});function lr(e,t){return(function(e,t,n){var i,s,o=n.itemSetKey,u=n.handler,a=u.columnKey,f=u.isAscending,l=e.demandItemFacet(t,o);if(!l)return{};var c=X.e.serialize(Object(r.__assign)({},l.driveItemKey)),p=e.demandItemFacet(le.e,c);if(!p||"business"===p||"documentLibrary"===p)return{};if(!l.sortBy)if(un.e){var d=e.demandItemFacet(H.u,c);if(a===(null===(i=d)||void 0===i?void 0:i.columnKey)&&(null===(s=d)||void 0===s?void 0:s.isAscending)===f)return{newItemSetKey:o}}else if(a===Vn.e.key&&!0===f)return{newItemSetKey:o};var v=Object(ar.e)(e,{customColumnKeysToFieldNamesConfiguration:Ce.n}).customColumnKeysToFieldNamesConfiguration,m=Object(r.__assign)(Object(r.__assign)({},h.t),v),g=m?m[a]:void 0;if(!g)return{};return{newItemSetKey:t.serialize(Object(r.__assign)(Object(r.__assign)({},l),{sortBy:g,isAscending:f}))}})(e,ne.e,t)}var cr=n(495),hr=Object(f.t)()(function(){return function(e){return function(e,t){return{isAvailable:!0}}}});var pr=n(2990),dr=n(2017),vr=n(3244),mr=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=pr.e.deserialize(i),o=s.endpoint,u=s.driveId;return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,a,f,l;return Object(r.__generator)(this,function(c){switch(c.label){case 0:n=Object(V.n)({endpoint:o,driveId:u});return[4,t(Object(dr.getSessionToken)(o,n))];case 1:s=c.sent();a=s&&s.accessToken;(f=new Be.e({publisher:e})).resolveItems({items:(l={},l[i]=Object(r.__assign)({},vr.e.pack(a)),l)});t(f.execute());return[2]}})})}});var gr,yr=n(640),br=n(106),wr=n(40),Er=n(250),Sr=n(272);(function(e){e.vaultOpen="vaultopen";e.vaultClosed="vaultclosed"})(gr||(gr={}));var xr={small:{vaultclosed:"vaultCoverSmallVaultClosed",vaultopen:"vaultCoverSmallVaultOpen"},large:{vaultclosed:"VaultCoverLargeVaultClosed",vaultopen:"VaultCoverLargeVaultOpen"}},Tr=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e,t=this.props,n=t.vaultCoverSize,i=void 0===n?"large":n,s=t.vaultCoverType,o=void 0===s?"vaultclosed":s,u=(t.ref,t.children,t.isFluent),a=Object(r.__rest)(t,["vaultCoverSize","vaultCoverType","ref","children","isFluent"]),f=xr[i][o];"small"===i?e="vaultCoverIsSmall_0b1cee7d":"large"===i&&(e="vaultCoverIsLarge_0b1cee7d");return L.createElement("div",Object(r.__assign)({},a,{className:"root_0b1cee7d "+e+" "+(u?"isFluent":"")}),L.createElement(O.e,{"aria-hidden":!0,className:"ms-VaultCover cover_0b1cee7d",iconName:f}))};return t})(L.Component);var Nr=Object(f.t)()(function(){return function(e){return function(e,t){var n,i,s,o,u=t.itemKey,a=e.demandItemFacet(ce.e,u);if(a&&a.root){var f=e.demandItemFacet(q.h,u),l=a.isLocked?gr.vaultClosed:gr.vaultOpen,c={iconType:yr.e.Image,ariaLabel:f,imageProps:{src:(n=l,"https://spoprod-a.akamaihd.net/files/fabric-cdn-prod_20201207.001//assets/item-types/"+(i||"20")+(o&&"png"===s?"_2x":"")+"/"+n+"."+(s||"png")),imageFit:br.t.contain,className:"fileHandlerFileTypeIcon_7f11123a"}};return{iconAs:function(e){return L.createElement(O.e,Object(r.__assign)({},e,c))}}}return{fileTypeIconAs:Cr}}}});var Cr=Object(wr.t)(function(e,t){var n=t.defaultRender,i=Object(r.__rest)(t,["defaultRender"]),s=i.isFolder,o=i.itemKey,u=i.type,a=u;if(s&&void 0===u){var f=e.demandItemFacet(ve.e,o);void 0!==f&&("desktop"===f?a=Er.e.desktopFolder:"documents"===f?a=Er.e.documentsFolder:"pictures"===f&&(a=Er.e.picturesFolder))}return n?L.createElement(n,Object(r.__assign)({},i,{type:a})):null}),kr=n(344),Lr=n(1070),Ar=n(187),Or=n(136);(function(e,t){void 0===e&&(e="https://spoprod-a.akamaihd.net/files/fabric/office-ui-fabric-react-assets/foldericons");Object(Sr.n)({fontFace:{},style:{width:78,height:58,overflow:"hidden"},icons:{vaultCoverSmallVaultClosed:L.createElement("img",{src:e+"/vault-sm.svg"}),vaultCoverSmallVaultOpen:L.createElement("img",{src:e+"/vault-sm-open.svg"})}},t);Object(Sr.n)({fontFace:{},style:{width:118,height:86,overflow:"hidden"},icons:{VaultCoverLargeVaultClosed:L.createElement("img",{src:e+"/vault-lg.svg"}),VaultCoverLargeVaultOpen:L.createElement("img",{src:e+"/vault-lg-open.svg"})}},t)})("https://spoprod-a.akamaihd.net/files/fabric/office-ui-fabric-react-assets/foldericons",{disableWarnings:!0});var Mr=Object(f.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,i=e.demandItemFacet(ce.e,n);return Object(r.__assign)(Object(r.__assign)({},i&&i.root?{tileAs:Dr}:{}),{folderCoverControlHandler:function(t,n){var r=n.signalData;if(r&&r.signal)return{};var i=e.demandItem({specialFolder:ve.e},n.itemKey).specialFolder;if(!i)return{};var s=(function(e){var t=null;"desktop"===e?t=L.createElement(Ar.n,null):"documents"===e?t=L.createElement(Ar.r,null):"pictures"===e&&(t=L.createElement(Ar.c,null));return{signal:t,key:e||""}})(i);return s&&s.signal?{signalData:s}:{}}})}}});var _r=Object(wr.t)(function(e,t){var n=t.itemKey,i=Object(r.__rest)(t,["itemKey"]),s=e.demandItemFacet(ce.e,n),o=s&&s.isLocked?gr.vaultClosed:gr.vaultOpen;return L.createElement(Tr,Object(r.__assign)({},i,{vaultCoverSize:i.folderCoverSize,vaultCoverType:o}))}),Dr=Object(wr.t)(function(e,t){var n=t.defaultRender,i=t.foreground,s=Object(r.__rest)(t,["defaultRender","foreground"]),o=t.itemKey,u=i,a=e.demandItemFacet(ce.e,o);a&&a.root&&(u=Object(Or.r)(e,L.createElement(_r,Object(r.__assign)({},s,{folderCoverSize:s.tileSize,itemKey:o}))));return n?L.createElement(n,Object(r.__assign)({},s,{foreground:u})):null}),Pr=n(720),Hr=n(78),Br=n(1526),jr=n(2335),Fr=n(26),Ir=n(1490),qr=n(30),Rr=n(47),Ur=n(17),zr=new Ur.e("openInOfficeOnlineActionControl"),Wr=Object(wr.e)(function(e,t){var n=t.itemKey,i=e.demandItem({openUrl:q.O,appFacet:he.e,isMalwareDetected:q.k},n),s=i.openUrl,o=i.appFacet,u=i.isMalwareDetected,a=e.dispatch,f=!u&&!!o&&!!s,l=e.demandItemFacet(zr,n);return Object(r.__assign)({isAvailable:f,onExecute:s?function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e,t;return Object(r.__generator)(this,function(r){e=(new Date).getTime().toString();t=Ir.e.AddWopiPerfMarkToTargetUrl(e,"ItemsView",s);a(Object(Qe.e)(function(e){return zr.evaluate(l)(e,{itemKey:n,forceInSameWindow:!1})})).forceInSameWindow?window.location.href=t:window.open(t);return[2]})})}:void 0},Object(Rr.t)(e,{itemKey:n,engagement:{name:"OpenInOfficeOnline",isIntentional:!0}}))})(qr.e),Xr=Object(Fr.s)()(Object(Fr.r)()(Wr)),Vr={key:new Ge.e("openInOfficeOnline").id,automationId:"openInOfficeOnlineCommand",action:L.createElement(Xr,null),facets:Object(r.__assign)({},Hr.t.pack(!0))},$r=n(87),Jr=n(1203),Kr=new Ur.e("openInOfficeClientActionControl"),Qr=n(2869),Gr=new $r.e,Yr=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2]})})},Zr=Object(wr.e)(function(e,t){var n=t.itemKey,i=e.demandItem({key:X.e,appMap:he.e,fileName:q.d,openUrl:q.O,canonicalUrl:q.i,isMalwareDetected:q.k},n),s=i.key,o=i.appMap,u=i.fileName,a=i.openUrl,f=i.canonicalUrl,l=i.isMalwareDetected,c=!1,h=Yr,p=Object(Qr.s)(e,{itemKey:n,oneOfRequiredRoles:["write","owner"]});if(n){var d=!l&&!!o&&!!a&&(Gr.isMac||Gr.isWindows||Gr.isIOS||Gr.isWinPhone||Gr.isAndroid),v=e.demandItemFacet(Kr,n),m=Kr.evaluate(v)(e,{itemKey:n,isAvailable:d,protocolCallback:ti}),g=m.protocolCallback,y=m.isAvailable;c=d&&y;s&&c&&(h=(function(e){var t=this,n=e.key,i=e.openUrl,s=e.canonicalUrl,o=e.canEdit,u=e.appMap,a=e.fileName,f=e.isNew,l=e.defaultLocation,c=e.protocolCallback;return function(){return Object(r.__awaiter)(t,void 0,void 0,function(){var e,t;return Object(r.__generator)(this,function(r){if(!n)return[2];e=!!o;t=function(){i&&window.open(i)};Object(Jr.e)({app:u||"",itemUrl:s||"",extension:a&&a.extension||"",shouldEdit:e,isNew:Boolean(f),defaultLocation:l||"",platformDetection:Gr,onNavigate:c,onFailureCallback:t});return[2]})})}})({key:s,openUrl:a,canonicalUrl:f,canEdit:p,appMap:o,fileName:u,protocolCallback:g}))}return Object(r.__assign)({isAvailable:c,onExecute:h},Object(Rr.t)(e,{itemKey:n,engagement:{name:"OpenInOfficeClient",isIntentional:!0}}))})(qr.e),ei=Object(Fr.s)()(Object(Fr.r)()(Zr));function ti(e){window.location.href=e}var ni={key:new Ge.e("openInOfficeClient").id,automationId:"openInOfficeClientCommand",action:L.createElement(ei,null),facets:Object(r.__assign)({},Hr.t.pack(!0))},ri=new Ge.e("fileHandlerOpenCommand").id,ii=(Object(Fr.s)()(Object(Fr.r)()(Object(wr.e)(function(e,t){var n=t.itemKey,r=t.item,i=e.demandItem({appMap:he.e},n).appMap,s=r.name;r.key===Vr.key?s=s||(i?Object(jr.s)(i,!1):jr.e.OpenInBrowser):r.key===ni.key&&(s=s||(i?Object(jr.o)(i,!0):jr.e.Open));return{name:s}})(function(e){return L.createElement("div",{className:"contextualMenuItemLinkContent_e78d58c6"},L.createElement("span",{dir:"auto",className:"contextualMenuItemTextLabel_e78d58c6"},e.name))}))),Object(Fr.s)()(Object(Fr.r)()(Object(wr.e)(function(e,t){var n=t.itemKey,i=t.menuProps,s=e.demandItem({appMap:he.e,fileName:q.d},n),o=s.appMap,u=s.fileName,a={};if(i&&i.items){var f=i.items[0];f&&-1!==f.key.indexOf(ri)&&f.iconProps&&(a=f.iconProps)}var l=!!u&&!!u.extension&&".pdf"===u.extension.toLowerCase(),c=o&&Object(jr.n)(o),h={iconName:o?Object(jr.t)(o):l?"PDF":"OpenFile"},p=void 0;i&&i.items&&(p=i.items.map(function(e){return e.key===Vr.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:h,name:e.name||o&&Object(jr.s)(o,!0)||(l?jr.e.OpenInBrowser:jr.e.Open),onRenderIcon:c?si.bind(void 0,c,!0):void 0}):e.key===ni.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:h,name:e.name||o&&Object(jr.i)(o),onRenderIcon:c?si.bind(void 0,c,!0):void 0}):e}));return{iconProps:a||h,onRenderIcon:c?si.bind(void 0,c,!1):void 0,text:jr.e.Open,menuProps:p?Object(r.__assign)(Object(r.__assign)({},i),{items:p}):i}})(Br.e))));function si(e,t){return e?L.createElement("span",{className:t?"menuItemIconContainer_e78d58c6":"iconContainer_e78d58c6"},L.createElement(O.e,{iconName:e.logoFill16,className:"logoFillIcon_e78d58c6"}),L.createElement(O.e,{iconName:e.logo16,className:"logoIcon_e78d58c6"})):null}var oi={key:Pr.e.key,automationId:Pr.e.automationId,subMenuProps:{items:[Vr,ni]},onRender:function(e){return L.createElement(ii,Object(r.__assign)({},e,{menuProps:e.subMenuProps}))},facets:Object(r.__assign)({},Hr.t.pack(!0))},ui=(Pr.e.key,Pr.e.automationId,Pr.e.name,Object(r.__assign)({},Hr.t.pack(!0)),Object(f.t)()(function(){return function(e){return function(e,t){var n=t.commands,i=t.overflowCommands,s=t.farCommands,o=i?Object(r.__spreadArrays)(i):[],u=n?Object(r.__spreadArrays)(n):[],a=s;return{commands:u=ai(e,{defaultCommands:u}).overrideDefaultCommands,overflowCommands:o,farCommands:a}}}}));function ai(e,t){for(var n=[],r=0,i=t.defaultCommands;r<i.length;r++){var s=i[r];s.key===Pr.e.key?n.push(oi):n.push(s)}return{overrideDefaultCommands:n}}var fi=n(362),li=n(489),ci=n(1298),hi=n(18),pi=n(452),di={key:new Ge.e("openInOfficeOnlineDefaultClickHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItem({openUrl:q.O,appMap:he.e},n),i=r.openUrl,s=r.appMap;return{action:!!i&&!!s?L.createElement(pi.e,{itemKey:n,action:Object(hi.i)(e,L.createElement(Wr,{itemKey:n}))}):void 0}}},vi={key:new Ge.e("openInOfficeClientDefaultClickHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItem({openUrl:q.O,appMap:he.e},n),i=r.openUrl,s=r.appMap;return{action:!!i&&!!s?L.createElement(pi.e,{itemKey:n,action:Object(hi.i)(e,L.createElement(Zr,{itemKey:n}))}):void 0}}},mi=Object(f.t)()(function(){return function(e){return function(e,t){var n=t.handlers,i=void 0===n?[]:n;return{handlers:Object(r.__spreadArrays)([ci.e,di,vi],i)}}}});var gi=n(586),yi=n(300),bi=Object(g.i)({key:new Ge.e("dateAccessedColumn").id,name:Jn.e,fieldName:"",minWidth:g.e.regularMin,maxWidth:g.e.regularMax,isCollapsable:!0},b.e)(function(e,t){var n=e.demandItemFacet(q.o,t,{suppressGetItems:!0}),r=n&&new Date(n).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(w.T,E.e),s=i&&i.language||window.navigator.language;return s?{text:Object(yi.n)(new Date(r),s)}:{dateValue:r}},function(e,t){return""+e.demandItemFacet(q.o,t)}),wi=Object(f.t)()(function(){return function(e){return Si}});var Ei=[p,d.e,bi];function Si(e,t){return{columns:Ei}}var xi=n(620),Ti=n(428),Ni=Object(Fr.s)()(Object(Fr.r)()(Object(wr.t)(function(e,t){var n=t.itemKey,r=e.demandItemFacet(q.M,n);return r?L.createElement(Ti.e,{itemKey:r.itemKey}):null}))),Ci=n(341),ki={key:"OpenFileLocation",name:Ci.i,title:Ci.i,action:Ni,iconProps:{iconName:"FabricFolder"}},Li=Object(f.t)()(function(){return function(e){return Oi}});var Ai=[Pr.e,ki,xi.n,xi.t];function Oi(e,t){return{commands:ai(0,{defaultCommands:Ai}).overrideDefaultCommands}}var Mi=n(194),_i=Object(f.t)()(function(){return function(e){return Hi}});var Di={name:"-",key:"divider_1",itemType:Mi.e.Divider},Pi=[Pr.e,ki,Di,xi.n,xi.t];function Hi(e,t){return{commands:Pi}}var Bi=n(1034),ji=Object(f.t)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var Fi=n(260),Ii=n(57),qi=Object(f.t)()(function(){return function(e){return function(e,t){var n=t.itemsScopeItemKey,i=t.engagement,s=i&&i.name;return{engagement:{datasource:"Recent",extraData:Object(r.__assign)({},"ItemsView.Load"===s?Ri(e,{itemsScopeItemKey:n}):{})}}}}});function Ri(e,t){var n=t.itemsScopeItemKey,i=Object(Ii.e)(e,n),s=e.demandItemFacet(Ye,i);return Object(r.__assign)({},s)}var Ui=Object(i.t)(function(){return function(e){e(Object(a.e)(Ht.e,Fi.e)(qi))}}),zi=n(385),Wi=n(372),Xi=Object(f.t)()(function(){return function(){return Vi}});function Vi(e,t){var n,i=t.layouts,s=e.demandItemFacet(fe.u,t.itemKey);if(i){n=[];for(var o=0,u=i;o<u.length;o++){var a=u[o];a.layoutType!==zi.t.layoutType?a.layoutType!==zi.e.layoutType?a.layoutType!==Wi.t.layoutType?n.push(a):n.push(Wi.t):n.push(zi.e):n.push(zi.t)}}return Object(r.__assign)(Object(r.__assign)({},n?{layouts:n}:{}),s?{defaultLayout:Wi.t.layoutType,isLayoutResolved:!0}:{})}var $i=Object(i.t)(function(){return function(e){e(Object(a.e)(Pt.e,l.e)(wi));e(Object(a.e)(Ht.e,fi.e)(Li));e(Object(a.e)(Ht.e,Bi.e)(_i));e(Object(a.e)(Ut,yn.e)(ji));e(Object(a.e)(Pt.e,kn.e)(Xi));e(Ui)}}),Ji=n(549),Ki=Object(g.i)({key:new Ge.e("dateFollowedColumn").id,name:Jn.l,fieldName:"",minWidth:g.e.regularMin,maxWidth:g.e.regularMax,isCollapsable:!0},b.e)(function(e,t){var n=e.demandItemFacet(q.a,t),r=n&&new Date(n).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(w.T,E.e),s=i&&i.language||window.navigator.language;return s?{text:Object(yi.n)(new Date(r),s)}:{dateValue:r}},function(e,t){return""+e.demandItemFacet(q.a,t)}),Qi=n(1288),Gi=Object(f.t)()(function(){return function(e){return Zi}});var Yi=[p,d.e,Ki,Qi.e];function Zi(e,t){return{columns:Yi}}var es=n(313),ts=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return this.props.group?L.createElement("div",{className:"root_de13c386"},this.props.group.name):null};return t})(L.PureComponent),ns=n(1534),rs=n(2432),is=n(449),ss=n(312),os=n(751);function us(e,t){var n=t.signals;if(n){var i=Object(ss.t)(n,function(e){return e.key===os.n});if(i&&i.index>-1){var s=i.index;return{signals:Object(r.__spreadArrays)(n.slice(0,s),n.slice(s+1))}}}return{}}var as=Object(f.t)()(function(){return function(e){return ls}});var fs=function(e){var t=e.defaultRender,n=Object(r.__assign)({},is.e.pack(us));return t?L.createElement(rs.e,{controlHandlers:n},L.createElement(t,Object(r.__assign)({},e))):null};function ls(){return{groupHeaderRenderer:ts,rowRenderer:fs,groupProps:{collapseAllVisibility:ns.e.hidden}}}var cs=Object(f.t)()(function(){return function(e){return ds}});function hs(e,t){var n=t.itemKey,r=e.demandItemFacet(q.a,n,{suppressGetItems:!0}),i=r&&new Date(r).getTime();if("number"==typeof i&&!isNaN(i)){var s=e.demandItemFacet(w.T,E.e),o=s&&s.language||window.navigator.language,u=Object(yi.n)(new Date(i),o);return{itemActivity:u&&L.createElement(b.e,{text:u})||null}}return{}}var ps=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.defaultRender,n=Object(r.__rest)(e,["defaultRender"]),i=Object(r.__assign)(Object(r.__assign)({},is.e.pack(us)),Lr.e.pack(hs));return t?L.createElement(rs.e,{controlHandlers:i},L.createElement(t,Object(r.__assign)({},n))):null};return t})(L.PureComponent);function ds(){return{tileRenderer:ps}}var vs=n(450),ms=n(3854),gs=Object(f.t)()(function(){return function(e){return function(e,t){return{emptyFolderIconUrl:"https://static2.sharepointonline.com/files/fabric/onedrive-assets/images/empty_state_sfl.svg",emptyFolderTitle:ms.e}}}});var ys=Object(i.t)(function(){return function(e){e(Object(a.e)(jt.e,es.e)(as));e(Object(a.e)(jt.e,Ji.e)(cs));e(Object(a.e)(jt.e,l.e)(Gi));e(Object(a.e)(jt.e,vs.e)(gs));e(Object(a.e)(Ft.e,fi.e)(ui))}}),bs=n(1348),ws=n(579),Es=n(159),Ss=n(706),xs=function(e,t){return n=e,Object(r.__assign)(((i={version:2})[0]="",i[1]="",i[3]="",i[6]="",i[16]="",i),n);var n,i},Ts=function(e,t){var n=t.queryType,r=t.layoutType,i=r&&(function(e){return e===Es.e?Ss.e:e===Ln.e?Ss.n:Ss.t})(r),s=xs(e);"number"==typeof n&&i&&(s[n]=i);return s},Ns=n(90),Cs=n(1628),ks=Object(Ns.t)(function(e){e.itemsScopeItemKey;var t=e.localStorageKey,n=Object(r.__rest)(e,["itemsScopeItemKey","localStorageKey"]);return function(e){var i,s=e(Object(Qe.e)(function(e){return Object(Cs.e)(e,{name:t})}))||{},o=s&&Ts(s,Object(r.__assign)({},n));e(Object(Cs.n)({values:(i={},i[t]=o,i)}))}}),Ls=Object(f.t)()(function(){return function(){return Os}}),As=new G.e("itemsScopeList",{driveId:Object(G.s)(),itemsScopeItemKey:Object(G.s)()});function Os(e,t){var n=Object(ar.e)(e,{isLayoutResolvedEnabled:w.x,isLocalStorageForLayoutEnabled:Ce.x}),i=n.isLayoutResolvedEnabled,s=n.isLocalStorageForLayoutEnabled;if(!i||!s)return{};var o,u,a,f,l=t.itemsScopeItemKey,c=Object(Ii.e)(e),h=e.demandItemFacet(ne.e,c),p=void 0;if(c&&h&&l){var d=h.driveItemKey;if(d){var v=d.endpoint,m=d.driveId;if(!m||!v)return{};var g,y,b=As.serialize({driveId:m,itemsScopeItemKey:l}),S=e.demandItemFacet(Ce.m,E.e),x=S&&S(e,{itemSetKey:c}),T=x&&x.queryType||0;g="ItemsStore"+(o={endpoint:v,driveId:m,queryType:T},u=o.endpoint,a=o.driveId,f="Graph.Files.FilesQueryType."+u,f=a?f+"."+a:f).toLocaleLowerCase();var N=Object(Cs.e)(e,{name:g});p=Object(Cs.t)(e,{name:g});var C=N&&N[T]||"";y=p?(function(e){switch(e){case Ss.t:return Es.t;case Ss.e:return Es.e;default:return Ln.e}})(C):void 0;var k=e.demandItemFacet(Ct.l,b);return{preferredLayoutType:e.demandItemFacet(Ct.f,b)||y,preferredLayoutVersion:k,setPreferredLayout:function(e){var t=e.layoutType;return function(n){g&&m&&v&&n(ks({endpoint:v,driveId:m,itemsScopeItemKey:l,queryType:T,localStorageKey:g,layoutType:t}));n(Object(ln.e)(function(){var t,i;n(Object(U.e)({items:(t={},t[b]=Object(r.__assign)({},Ct.f.pack(e.layoutType)),t)}));n(Object(U.e)({items:(i={},i[b]=Object(r.__assign)({},Ct.l.pack((k||0)+1)),i)}))}))}}}}}return{}}var Ms=n(960),_s=Object(Fn.e)(function(){return n.ee(0,4313)},{chunkName:"graphaddondeferred"}),Ds=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(c){switch(c.label){case 0:e(Object(ln.e)(function(){e(Rn);e(Object(a.e)(ne.e,l.e)(tr));e(Object(a.e)(ne.e,Ms.e)(Object(f.n)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object(u.o)())];case 1:t.sent();return[4,n.ee(["7"],4222)];case 2:return[2,t.sent().driveItemSortActionControlHandler]}})})})));e(Object(a.e)(ne.e,ur.e)(fr));e(Object(a.e)(o.e,l.e)(j));e(Object(a.e)(X.e,zn.e)(Un.e));e(Object(a.e)(ne.e,Wn.e)(Xn));e(Object(a.e)(X.e,cr.e)(hr));e(Object(s.r)(pr.e,z.e)(mr));e(Object(a.e)(X.e,kr.e)(Nr));e(Object(a.e)(He,kr.e)(Nr));e(Object(a.e)(X.e,Lr.e)(Mr));e(Object(a.e)(He,Lr.e)(Mr));e(Object(a.e)(X.e,li.e)(mi));e(Object(a.e)(Ht.e,fi.e)(ui));e(Object(a.e)(X.e,gi.e)(bs.e));e(Object(a.e)(ne.e,ws.e)(Ls));e(or);e($i);e(ys)}));return[4,e(Object(u.o)({waitIndefinitely:!0}))];case 1:c.sent();c.label=2;case 2:c.trys.push([2,4,,5]);return[4,_s()];case 3:if(!(t=c.sent().graphAddonDeferred))throw new Error("Couldn't load extended Microsoft Graph features.");e(t);return[3,5];case 4:i=c.sent();e(Object(_n.e)({error:i}));return[3,5];case 5:return[2]}})})}})},,,function(e,t,n){"use strict";n.r(t);n.d(t,"spProjectedUploadedItemSetAddon",function(){return Ar.spProjectedUploadedItemSetAddon});n.d(t,"SpAddonDeferred",function(){return Wr});var r=n(0),i=n(10),s=n(217),o=n(322),u=n(488),a=new(n(17).e)("itemsBreadcrumbControl"),f=n(238),l=n(362),c=n(1034),h=n(652),p=n(45),d=n(797),v=n(1251),m=n(1252),g=n(1136),y=n(120),b=n(65),w=n(407),E=n(1232),S=n(772),x=n(4037),T=n(3183),N=n(573),C=n(1257),k=n(1),L=n(3197),A=n(624),O=n(2336),M=n(2283),_=n(3349),D=n(2995),P=n(9),H=n(3343),B=n(154),j=n(226),F=n(940),I=n(1294),q=n(2478),R=n(75),U=n(29),z=n(70),W=n(744),X=n(760),V=n(620),$=n(409),J=n(162),K=n(39),Q=n(3344),G=n(59),Y=n(27),Z={ODB:1544},ee=Object(P.t)()(function(){return function(e){return function(t,n){var i,s=n.itemKey,o=n.commands,u=t.demandItemFacet(p.e,s);if(u){var a=y.e.serialize(u);i=t.demandItemFacet(k.Re,a)}var f=o?Object(r.__spreadArrays)(o):[];f.push(_.t,_.e);var l=void 0;if(u){var c=u.listFullUrl,h=u.webAbsoluteUrl,d=Object(D.i)({listFacets:i}),v=t.demandItemFacet(k.un,N.e.serialize({webAbsoluteUrl:h,listFullUrl:c}));if(i&&!i.isDocumentLibrary){f=[L.t];for(var m=0,g=Object(L.e)(v);m<g.length;m++){var b=g[m];b.key===V.n.key&&Object(R.e)(t,{feature:Z,pageContext:v})?f.push(V.e):b.key!==A.e.key&&f.push(b)}}f.push(d);var w=C.e.serialize({webAbsoluteUrl:h,listFullUrl:c}),E=Object(H.e)({itemCache:t,targetCustomActionSetKey:w,keys:{webAbsoluteUrl:h,listFullUrl:c}}),S=t.demandItemFacet(k.pe,s);f=f.concat(Object(H.n)(t,w,S));E&&(f=f.concat(Object(H.n)(t,E,S)));if(v&&i&&(i.templateType===U.t.documentLibrary||i.templateType===U.t.mySiteDocumentLibrary)){var x=new B.e(h||c).authority+"/_api/v2.0",O=j.t.serialize({endpoint:x});l=Object(q.e)(t,{itemKey:O})}}var M=!z.t.isActivated(T.e,"7/5/2019","Show file handler commands before OOB commands"),P=!!Object(Y.e)(t,{enableUniversalPrint:G.c}).enableUniversalPrint;return{commands:te(f,l,i&&i.templateType===U.t.mySiteDocumentLibrary,M,P),onMenuOpened:function(){e(function(e){var t=(e(Object(J.e)({spLoggerConfiguration:K.o})).spLoggerConfiguration||{}).scenarioId,n=void 0===t?"":t;e($.t(n))})}}}}});function te(e,t,n,r,i){for(var s=[],o=0,u=e;o<u.length;o++){var a=u[o],f=a.key;if(f===O.e.key){var l=t&&t.open||[];l.length>0&&M.t.subMenuProps&&(M.t.subMenuProps.items=Object(q.t)(M.t.subMenuProps.items,l,r));s.push(M.t)}else{s.push(a);if(f===W.e.key)s.push(I.e);else if(f===X.e.key){s.push(F.e);i&&n&&s.push(Q.e)}}}return t&&t.custom&&t.custom.length>0?Object(q.t)(s,t.custom):s}var ne=n(57),re=n(8),ie=n(90),se=n(155),oe=n(564),ue=Object(P.t)()(function(){return function(e){return function(e,t){var n=Object(ne.e)(e),i=(function e(t,n,i){var s=n,o=i;if(n&&i){var u=t.demandItem({spGroupField:k.Kt,groupValue:k.Se,parentGroupKey:k.ft,groupFilterByValue:k.ye,groupValueDisplayValue:k.Ee},n),a=u.spGroupField,f=u.groupValue,l=u.parentGroupKey,c=u.groupFilterByValue,h=u.groupValueDisplayValue;l&&(o=e(t,l.itemKey,i));var p=t.demandItemFacet(b.e,o);if(p){var v=t.demandItemFacet(d.e,n),m=Object(oe.e)(Object(r.__assign)(Object(r.__assign)({},p),v?{viewKey:v.viewKey}:{})),g=c||f;if(void 0!==g&&a&&a.internalName&&a.fieldType){var y=!z.t.isActivated("b53559e1-298d-4488-a512-60e0d8b8b827","09/15/2020","Include fitler displays for group that has raw value for filterByValue")&&"DateTime"===a.fieldType,w=!z.t.isActivated("e278b853-095c-41f6-a0b9-8ad603442ce7","2/22/2021","Use group display value as the filterDisplays");s=m({filterField:a.internalName,filterValues:[g],filterDisplays:w&&!!h&&[h]||y&&[f||g]||[],filterType:a.fieldType,useLookupId:!1})}}}return s})(e,t.itemKey,n),s=e.demandItem({parentItem:re.s},n).parentItem,o=(function(e){var t=this,n=e.stageItem,i=e.parentItemKey;return n?Object(ie.t)(function(e){var s=e.itemsScopeItemKey,o=e.currentItemKey;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(u){switch(u.label){case 0:i&&e(Object(se.e)({items:(t={},t[o]=Object(r.__assign)({},re.s.pack({itemKey:i})),t)}));return[4,e(n({currentItemKey:o,itemsScopeItemKey:s}))];case 1:u.sent();return[2]}})})}}):void 0})({parentItemKey:s&&s.itemKey,stageItem:t.stageItem});return i?Object(r.__assign)({itemKey:i},o?{stageItem:o}:{}):{}}}});var ae=n(513),fe=n(112),le=n(110),ce=new fe.e("siteTargetDocumentLibraryItem",function(e,t){var n=t.itemKey,r=e.demandItemFacet(re.t,n),i=r&&r.itemKey,s=e.demandItemFacet(re.e,i),o=s&&s.itemKeys;if(o&&1===o.length)return{itemKey:o[0]};if(o&&Object(R.e)(e,{feature:{ODB:60127}})){if(Object(Y.e)(e,{enableLibrariesDropdown:k.F}).enableLibrariesDropdown)for(var u=0,a=o;u<a.length;u++){var f=a[u];if(e.demandItemFacet(k.Le,f))return{itemKey:f}}}}),he=Object(P.t)()(function(){var e=this;return function(){return function(t,i){var s,o=i.itemKey,u=i.stageItem,a=Object(le.e)(t),f=Object(ne.e)(t),l=t.demandItemFacet(w.e,o);if(l){var c=t.demandItemFacet(p.e,a),h=t.demandItemFacet(ae.e,f);c?l.webAbsoluteUrl===c.webAbsoluteUrl&&(s={isToggled:!0}):h&&l.webAbsoluteUrl===h.webAbsoluteUrl&&(s={isToggled:!0})}var d=t.demandItemFacet(ce,o,{suppressGetItems:!0});return Object(r.__assign)(Object(r.__assign)({},s||{}),d?{itemKey:d.itemKey}:{stageItem:function(t){return function(i){return Object(r.__awaiter)(e,void 0,void 0,function(){var e,s,o,a,f,l;return Object(r.__generator)(this,function(c){switch(c.label){case 0:o=[Object(r.__assign)({},t)];return(a=u)?[4,i(u(t))]:[3,2];case 1:a=c.sent();c.label=2;case 2:e=r.__assign.apply(void 0,o.concat([a||{}])).currentItemKey,s=void 0===e?t.currentItemKey:e;return[4,n.ee(8,609)];case 3:f=c.sent().demandItems;return[4,i(f(function(e){return e.demandItemFacet(ce,s)}))];case 4:return(l=c.sent())?[2,{currentItemKey:l.itemKey}]:[2]}})})}}})}}});var pe=n(185),de=n(957),ve=n(191),me=n(6),ge=Object(P.t)()(function(){return function(e){return function(e,t){var n=t.createOpenItem,r=t.rootItemKey,i=t.itemKey,s=Object(ne.e)(e),o=void 0;if(r){var u=e.demandItemFacet(p.e,r);u&&(o=p.e.serialize(u))}return{getBreadcrumbItems:function(){var t=[],u={},a=e.demandItemFacet(b.e,s),f=a&&a.filterParams,l=e.demandItemFacet(k.Wt,s),c=l&&l.filterList;!l&&f&&(c=pe.default.getFilterList(f,void 0,!0));if(c&&c.length&&f)for(var h=c.length-1;h>=0;h--){var p=c[h],d=(p.displays&&p.displays.length?p.displays:p.values).map(function(e){return e||ve.EmptyFilterOptionLabel}),v=pe.default.formatBreadcrumbFilterValues(d,p.type||"",{booleanFalse:ve.booleanFalse,booleanTrue:ve.booleanTrue}),m=ye(f,c,h+1),g=(y=Object(de.e)(e,{folderItemKey:i,currentItemSetKey:s,newFilterParams:m}))?b.e.serialize(y):i;t.unshift({key:p.fieldName,text:v,onClick:n&&g?n(g):void 0})}for(;i&&!u[i];){u[i]=!0;var y,w=e.demandItem({displayName:me.h,parentFolder:me.M},i),E=w.displayName,S=w.parentFolder;g=(y=Object(de.e)(e,{folderItemKey:i,currentItemSetKey:s,newFilterParams:""}))?b.e.serialize(y):i;t.unshift({key:i,text:E||"",onClick:n&&g?n(g):void 0});if(r&&(r===i||o===i))break;i=S&&S.itemKey||""}return t}}}}});function ye(e,t,n){for(var r=n=n||0;r<t.length;r++){var i=t[r];e=pe.default.addFilterInfo(e,i.fieldName,"",!0)}return e}var be=n("react-lib"),we=n(41),Ee=n(1234),Se=n(345),xe=n(2),Te=n(231),Ne=n(143),Ce=Te.t.serialize({}),ke={key:new xe.e("uploadToGroupDefaultDropActionHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItemFacet(Te.n,Ce),i=r&&r.draggedItem,s=!i||i.type===Ne.t,o=e.demandItemFacet(we.s,n);return{action:s&&o?be.createElement(Ee.e,{itemKey:n}):void 0}},canHandleEvent:function(e){return function(t){return e.event&&e.event&&Object(Se.n)(e.event)||!1}}},Le=n(40),Ae=n(30),Oe=n(47),Me=n(115),_e=n(3358),De={isAvailable:!1,onExecute:void 0},Pe=Object(Le.e)(function(e,t){var n=t.itemKeys,i=t.groupKey;if(!(!!e.demandItemFacet(d.e,i)&&n&&n.length>0))return De;var s=e.demandItem({childItems:re.e},i).childItems,o=s&&s.itemKeys||[],u=!!e.demandItemFacet(d.e,o[0]);if(0===o.length||u)return De;var a=n.filter(function(e){return!o.some(function(t){return t===e})});if(0===a.length)return De;var f=a[0],l=e.dispatch;return Object(r.__assign)({isAvailable:!0,onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){e={groupKey:i};return[2,l(Object(_e.t)({items:Object(Me.e)(n,function(){return e})}))]})})}},Object(Oe.t)(e,{itemKey:f,engagement:{name:"Move",isIntentional:!0}}))})(Ae.e),He=Te.t.serialize({}),Be={key:new xe.e("moveToGroupDefaultDropActionHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItemFacet(we.s,n),i=e.demandItemFacet(Te.n,He),s=i&&i.draggedItem;return{action:(!s||s.type===Ne.e)&&r?be.createElement(Pe,{itemKeys:s&&s.itemKeys||[],groupKey:n}):void 0}},canHandleEvent:function(e){return function(t){if(e&&e.event){var n=e.event.dataTransfer.draggedItem;return n&&n.type===Ne.e||!1}return!1}}},je=n(18),Fe=n(34),Ie=n(572),qe=n(50),Re=n(176),Ue=n(323),ze=n(3634),We=n(104),Xe=n(133),Ve=Object(qe.e)()(Object(Re.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(["21"],4228)];case 1:return[2,e.sent().ResetViewWizard]}})})})),$e=Object(qe.e)()(Object(Le.e)()(Object(Re.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(["20"],4229)];case 1:return[2,e.sent().ReorderListItemsActionExecutor]}})})}))),Je=Object(Le.t)(function(e,t){var n=t.itemKeys,i=t.targetItemKey,s=t.targetItemIndex,o=Object(ne.e)(e)||"",u=e.demandItemFacet(k.s,o),a=!!u&&u.viewNotSupportedReason||Ue.e.None,f=u&&!!o&&n.length>0&&!!i&&void 0!==s,l=a===Ue.e.FilterInQueryParam||a===Ue.e.SortFieldInQueryParam||a===Ue.e.GroupFieldInQueryParam,c=e.dispatch,h=Object(Fe.e)(e).itemsScopeItemKey,p=Object(We.n)(e).telemetry,d=l&&!!h&&function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e,t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:if(!(e=b.e.matches(o)&&b.e.deserialize(o)))return[3,2];t=b.e.serialize(Object(r.__assign)(Object(r.__assign)({},e),{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0}));if(!h)return[3,2];p(Xe.e).logData({name:"ReorderListItems.ResetView",extraData:{CannotReorderReason:a}});return[4,c(Object(Ie.e)({itemsScopeItemKey:h,currentItemKey:t}))];case 1:n.sent();n.label=2;case 2:return[2]}})})}||void 0,v=d&&ze.t||"",m=a!==Ue.e.None?Object(je.o)(function(e){return be.createElement(Ve,Object(r.__assign)({},e,{reason:a,bodyMessage:v,onResetView:d}))}):Object(je.o)(function(e){return be.createElement($e,Object(r.__assign)({itemSetKey:o},t,e))});return be.createElement(Ae.e,Object(r.__assign)({isAvailable:f,onExecute:m},Object(Oe.t)(e,{itemKey:n[0],engagement:{name:"ReorderListItems",isIntentional:!0,extraData:{CannotReorderReason:a,ReorderItemsCount:n.length}}})))}),Ke=Te.t.serialize({}),Qe={key:new xe.e("reorderListItemsDefaultDropActionHandler").id,evaluate:function(e,t){var n=t.itemKey,r=t.itemIndex,i=e.demandItemFacet(k.We,n),s=e.demandItemFacet(me.m,n),o=e.demandItemFacet(Te.n,Ke),u=o&&o.draggedItem,a=u&&u.itemKeys||[],f=a.length>1||1===a.length&&a[0]!==n;return{action:(!u||u.type===Ne.e)&&!!i&&f&&!s&&void 0!==r?be.createElement(Je,{itemKeys:a,targetItemKey:n,targetItemIndex:r}):void 0}},canHandleEvent:function(e){return function(t){var n,r,i,s,o=null===(n=e.event)||void 0===n?void 0:n.dataTransfer,u=null===(r=o)||void 0===r?void 0:r.dropToPosition;return(null===(s=null===(i=o)||void 0===i?void 0:i.draggedItem)||void 0===s?void 0:s.type)===Ne.e&&void 0!==u||!1}}},Ge=Object(P.t)()(function(){return function(e){return function(e,t){var n=t.handlers;return{handlers:Object(r.__spreadArrays)([ke,Be],n||[])}}}});var Ye=Object(P.t)()(function(){return function(e){return function(e,t){var n=Object(ne.e)(e)||"",i=e.demandItemFacet(k.s,n),s=t.handlers;return i?{handlers:Object(r.__spreadArrays)([Qe],s||[])}:Object(r.__assign)({},t)}}});var Ze=n(62),et=Object(P.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItem({key:d.e,isDropEnabled:we.i},n),i=r.key,s=r.isDropEnabled,o=i&&i.itemSetKey&&p.e.serialize(i.itemSetKey),u=o&&e.demandItemFacet(k.lt,o),a=Ze.e.hasItemPermission({permissions:u},Ze.e.insertListItems);if(a){var f=i&&i.itemSetKey&&e.demandItemFacet(k.Re,y.e.serialize({webAbsoluteUrl:i.itemSetKey.webAbsoluteUrl,listFullUrl:i.itemSetKey.listFullUrl}));a=!!s&&!!f&&!!f.isDocumentLibrary&&f.templateType!==U.t.webPageLibrary}return{isAvailable:a}}}});var tt=n(2878),nt=n(937),rt=n(3255),it=n(122),st=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=m.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,u;return Object(r.__generator)(this,function(a){t=e(Object(it.e)({listFacets:k.Re},y.e.serialize(i.listKey))).listFacets;s=nt.e.serialize({listKey:{webAbsoluteUrl:i.listKey.webAbsoluteUrl,listFullUrl:i.listKey.listFullUrl},contentTypeId:i.contentTypeId});o=!!t&&t.openInClient;e(Object(se.e)({items:(u={},u[n]=Object(r.__assign)({},k.t.pack(function(){return be.createElement(rt.e,{contentTypeId:i.contentTypeId,openInClient:o,contentTypeKey:s})})),u)}));return[2]})})}});var ot=n(349),ut=n(83),at=n(1814),ft=n(198),lt=Object(i.i)()(function(e){var t=this,n=g.e.deserialize(e.itemKey),i=n.webAbsoluteUrl,s=n.listFullUrl;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l;return Object(r.__generator)(this,function(c){t=n(Object(it.e)({pageContext:k.un},N.e.serialize({webAbsoluteUrl:i,listFullUrl:s}))).pageContext;o=n(Object(ut.n)({webAbsoluteUrl:i,listFullUrl:s})).hasTokenProvider;if(t){u=o?void 0:function(e){return n(Object(ut.e)({url:e}))};a=new at.e({},{pageContext:t,getAuthToken:u});(f=new ft.e).resolveItems({items:(l={},l[e.itemKey]=Object(r.__assign)({},k.ln.pack(a)),l)});n(f.execute())}return[2]})})}});var ct=n(3626),ht=n(352),pt=new xe.e("saveTemplatesToView"),dt=(Object(ht.e)({operationTypeFacet:pt}),n(952)),vt=n(1240),mt=n(2185),gt=n(3339),yt=n(281),bt=n(94),wt=n(1143),Et=n(3360),St=n(3256),xt=new fe.e("newCommands",function(e,t){var n=t.itemKey,i=e.demandItemFacet(y.e,n);if(i){var s=p.e.serialize(Object(r.__assign)(Object(r.__assign)({},i),{rootFolder:""})),o=e.demandItemFacet(p.e,s);if(o){var u=Object(bt.e)(e,s),a=e.demandItemFacet(k.Re,n);if(u&&a){var f=a.templateType===U.t.mySiteDocumentLibrary,l=e.demandItemFacet(k.rt,n),c=Object(wt.t)(e,s,o);Object(z.n)(u).isActivated("97F46AEC-F105-436C-9A00-8268455640F0","11/19/20","Folder always available")||(c=!0);var h=Object(Et.e)(e,{key:o,listFacets:a,listKey:i,pageContext:u}),d=h.contentTypes,v=h.contentTypeCommands,m=Object(St.e)(e,{isODB:f,key:o,listFacets:a,pageContext:u}).fileHandlerCommands,g=yt.e;return Object(gt.e)(e,{contentTypes:d,newCommandMenu:g,fileHandlerCommands:m,isCreateFolderAvailable:c,newDocumentTemplates:l,contentTypeCommands:v,listKey:i}).allCommands}}}}),Tt=Object(i.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.childItemKey;return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,s,o,u,a,f,l,c,h,d,v,m,g,b,w,E,S,x,T;return Object(r.__generator)(this,function(N){i=e(Object(it.e)({deserializedItemKey:p.e,displayName:me.h},n)),s=i.deserializedItemKey,o=i.displayName;if(s&&o){u=e(Object(it.e)({contentTypeKeys:k.v},t)).contentTypeKeys;a=[];u&&u.length&&u.forEach(function(t){var n=e(Object(it.e)({contentType:k.sn},t)).contentType;n&&a.push(n)});f=a.length?a[0].contentTypeId:void 0;l=o.replace(/\.[^.]+$/,"");if(!(c={contentTypeId:f,isUpload:!0,templateId:l,title:l,url:s.itemId,visible:!0}).url)throw new Error("No template URL to save.");if((h=e(Object(it.e)({defaultView:k.w},t)).defaultView)&&h.viewKey){d=h.viewKey;v=e(Object(it.e)({existingTemplates:k.rt},t)).existingTemplates,m=void 0===v?[]:v;(g=Object(r.__spreadArrays)(m)).length||(b=e(Object(it.e)({newCommands:xt},t)).newCommands)&&b.forEach(function(e){var t=e.contentTypeId,n=e.isContentType,r=e.templateId,i=e.title,s=e.visible;g.push({contentTypeId:t,isContentType:n,templateId:r,title:i,visible:s})});g.filter(function(e){return e.url===c.url}).length>0||g.push(Object(r.__assign)({},c));w=y.e.deserialize(t);E=dt.e.serialize({templateUrl:c.url,listKey:w});e(Object(se.e)({items:(S={},S[t]=Object(r.__assign)({},k.rt.pack(g)),S[E]=Object(r.__assign)({},k.nt.pack(c)),S)}));return[2,e(Object(mt.e)({items:(x={},x[vt.e.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl})]={views:(T={},T[d]={newDocumentTemplatesJsonString:JSON.stringify(g)},T),qosName:"saveNewTemplatesToDefaultView"},x)}))]}}return[2]})})}}),Nt=n(1341),Ct=Object(i.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.templates;return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i;return Object(r.__generator)(this,function(s){e(Object(se.e)({items:(i={},i[t]=Object(r.__assign)({},k.rt.pack(n)),i)}));return[2]})})}}),kt=n(944),Lt=n(121),At=n(335),Ot=n(3003),Mt=n(2432),_t=n(1070),Dt=n(1055),Pt=n(37),Ht=n(701),Bt=n(129),jt=n(1195),Ft=n(1648),It=n(287),qt=n(109),Rt=n(48),Ut=n(3860),zt=n(2105);function Wt(e,t){return{enableItemHoverCard:!1}}var Xt=Object(Le.e)(function(e,t){var n=$t(e,t.itemSetKey),r=n.viewFormatter,i=n.isGenerated,s=n.isTileDesignerTemplateApplied,o=n.qosEndPayload;return{customFormatterFeature:r&&e.demandItemFacet(Lt.n,Lt.t.serialize({})),viewFormatter:r,isGenerated:i,qosEndPayload:o,telemetry:Object(We.n)(e).telemetry,isTileDesignerTemplateApplied:s,dispatch:e.dispatch,isDefaultCardEnabled:Object(R.e)(e,{feature:{ODB:1615}})}})(function(e){var t=be.useMemo(function(){var t=e.telemetry,n=e.qosEndPayload,i=function(){};if(0===e.selectionIndex){var s=new(t(qt.e))({name:"customItemTileRenderQoS"}),o=new zt.e({scenario:"ModernViewsRender"});if(n&&n.resultType===Rt.e.Failure){var u=Object(r.__assign)(Object(r.__assign)({},n),{extraData:Object(r.__assign)(Object(r.__assign)({},n.extraData||{}),{error:n.error||"Something went wrong with rendering Gallery view.",isOOTB:m||g.isTileDesignerTemplateApplied,errorStage:"JSON generation"})});s.end(u);o.end(u)}else i=function(e){var t=e?{resultType:Rt.e.Failure,error:e.errorString||"Something went wrong with rendering Gallery view.",extraData:Object(r.__assign)(Object(r.__assign)({},e.extraData),{isOOTB:m||g.isTileDesignerTemplateApplied,errorStage:"internal components"})}:{resultType:Rt.e.Success};s&&s.end(t);o&&o.end(t)}}return{customItemTileRenderQoSEnd:i}},[]).customItemTileRenderQoSEnd;Object(be.useEffect)(function(){if(d&&d.isTileFormatterAvailable()&&0===b){document.querySelectorAll(".sp-card-defaultClickButton")&&t();m||g.isTileDesignerTemplateApplied?e.dispatch(Object(At.e)({name:"GalleryViewRender",isIntentional:!0})):e.dispatch(Object(At.e)({name:"CustomFormatterTileLoad",isIntentional:!0}));d.hasFormatterReferences()&&e.dispatch(Object(At.e)({name:"FormatterReferenceTile",isIntentional:!0}))}},[]);var n=be.useState(!1),i=n[0],s=n[1],o=be.useState([]),u=o[0],a=o[1],f=be.useState(-1),l=f[0],c=f[1],h=e.defaultRender,p=e.customFormatterFeature,d=e.viewFormatter,v=e.isDefaultCardEnabled,m=e.isGenerated,g=Object(r.__rest)(e,["defaultRender","customFormatterFeature","viewFormatter","isDefaultCardEnabled","isGenerated"]);if(!h)return null;var y=p&&p.tileRenderer,b=g.selectionIndex,w=g.itemKey,E=g.itemSetKey,S=void 0===E?"":E;if(d&&d.isTileFormatterAvailable()&&y){var x=d.shouldHideSelectionInTiles(),T=d.getTileFormatter(),N=be.createElement(Ut.e,{qosEvent:t},be.createElement(h,Object(r.__assign)({},g,{href:void 0,invokeSelection:!1},{className:Object(Pt.e)(g.className,"customTile_7196c80e"),itemName:null,itemActivity:null,foreground:null,isSelectable:!x,selection:x?void 0:g.selection,selectionIndex:x?-1:g.selectionIndex,background:be.createElement(Ft.e,{handleTabKey:It.t.all,direction:It.e.domOrder,tabIndex:i?0:-1,onKeyDown:function(e){if(e.which===Bt.e.tab){var t=l+1;if(t<u.length&&u[t]){u[t].focus();c(t);e.stopPropagation();e.preventDefault()}}else c(-1)},className:"customTileFocusZone_7196c80e"},be.createElement(y,{rowIndex:b,itemKey:w,itemSetKey:S,formatter:T,qosEvent:t})),onFocus:function(e){s(!0);var t=e.currentTarget.querySelectorAll(".sp-card-keyboard-focusable");a(t)},onBlur:function(e){s(!1);a([]);c(-1)}})));return v&&T?be.createElement(Mt.e,{controlHandlers:_t.e.pack(Wt)},N):N}return be.createElement(h,Object(r.__assign)({},g))}),Vt=new fe.e("generatedViewFormatter",function(e,t){var n,r=t.itemKey;if(e.isItemFacetResolved(k.Ve,r)&&r){var i=Object(Ot.e)(e,{itemSetKey:r}),s=e.demandItemFacet(Lt.n,Lt.t.serialize({})),o=e.demandItemFacet(b.e,r);if(o&&i&&s){var u=e.demandItemFacet(k.Re,y.e.serialize(o)),a=Object(Dt.t)(e,{mapping:{fieldData:k.ue},itemSetKey:r}),f=Object(R.e)(e,{feature:{ODB:522}}),l=Object(R.e)(e,{feature:{ODB:1822}}),c=a.map(function(e){return e.fieldData}),h={};if(l){var p=e.demandItem({schema:re.o},r).schema,d=p&&p.columnKeys;d&&f&&(h=Object(jt.e)(e,d))}var v=u&&u.templateType||U.n.invalidType,m=void 0;if(c&&c.length>0&&v===U.n.genericList){var g=Object.keys(h).length>0?{fieldFormatters:h}:void 0;n=void 0===(m=s.tileDesigner.createDefaultTileProps(c,g))?{resultType:Rt.e.Failure,error:"Error generating defaultTileProps",extraData:{fields:JSON.stringify(c)}}:{resultType:Rt.e.Success}}var w=Object(kt.e)({formatter:void 0,fieldFormatters:h,generatedTileProps:m,columnFormatterReferenceProps:{columnFormatterReferenceEnabled:l}});if(w)return{viewFormatter:w.viewFormatter,qosEndPayload:n}}}});function $t(e,t){var n,r=!1;if(!t)return{viewFormatter:void 0,isGenerated:r,isTileDesignerTemplateApplied:!1,qosEndPayload:n};var i=e.demandItemFacet(k.xn,Object(Ot.e)(e,{itemSetKey:t})),s=i&&i.viewFormatter,o=s&&s.getTileProps(),u=Boolean(s&&s.isTileDesignerTemplateApplied());u&&(s=e.demandItemFacet(Jt,t));if(!(o&&o.formatter&&o.formatter)){var a=e.demandItemFacet(Vt,t);s=a&&a.viewFormatter;n=a&&a.qosEndPayload;r=!0}return{viewFormatter:s,isGenerated:r,isTileDesignerTemplateApplied:u,qosEndPayload:n}}var Jt=new fe.e("postColumnDeleteViewFormatterFacet",function(e,t){var n=t.itemKey,r=e.demandItemFacet(k.xn,Object(Ot.e)(e,{itemSetKey:n})),i=r&&r.viewFormatter;if(n){for(var s=Object(Dt.t)(e,{mapping:{fieldData:k.ue},itemSetKey:n}),o=[],u={},a=0;a<s.length;a++){var f=s[a],l=f.fieldData?f.fieldData.RealFieldName:"";if(l){o.push(f.fieldData);u[l]=f.fieldData}}var c=i&&i.getTileFormatterDesignerConfig(),h=e.demandItemFacet(Lt.n,Lt.t.serialize({})),p=e.demandItemFacet(b.e,n),d=p&&e.demandItemFacet(k.Re,y.e.serialize(p)),v=d&&d.templateType||U.n.invalidType,m=Object(R.e)(e,{feature:{ODB:522}}),g=Object(R.e)(e,{feature:{ODB:1822}});if(h){var w=h.tileDesigner,E=w.encodeTileDesignerConfig,S=w.decodeTileDesignerConfig,x=w.createJSONFromConfig,T=w.shouldExcludeColumnInCards,N=w.encodeTileDesignerConfigForDocLib,C=c&&S(c),L=[],A={};if(m){var O=e.demandItem({schema:re.o},n).schema,M=O&&O.columnKeys;M&&(A=Object(jt.e)(e,M))}if(C){var _=!1;for(a=0;a<C.columns.length;a++){var D=C.columns[a],P=void 0;switch(D.id){case"LinkTitle":P="Title";break;case"LinkFilename":P="FileLeafRef";break;default:P=D.id}T(u[P],P)?_=!0:L.push(D)}C.columns=L;var H=v===U.n.documentLibrary?N(C,!0):E(C);if(_||m){var B=x(o,H,Object.keys(A).length>0?{fieldFormatters:A}:void 0,v),j=Object(kt.e)({formatter:JSON.stringify({tileProps:B}),fieldFormatters:A,columnFormatterReferenceProps:{columnFormatterReferenceEnabled:g}});return j&&j.viewFormatter}}}}return i});function Kt(e){return function(){return Object(r.__assign)(Object(r.__assign)({},e?{headerRenderer:e}:{}),{maxItemCount:30})}}var Qt=n(1297),Gt=Object(P.t)()(function(){return function(e){return function(e,t){var n,r=t.itemSetKey;if("3a867b4a-7429-0e1a-b02e-bf4b240ff1ce"===(null===(n=Object(bt.e)(e,r))||void 0===n?void 0:n.listTemplateId))return{};if(r)return(function(e,t){var n=$t(e,t).viewFormatter,r=n&&n.isTileFormatterAvailable(),i=Object(Ht.t)(e)?Object(Ht.e)(t,"TILES"):void 0;if(!r)return i?{groupControlHandler:Kt(i)}:{};var s=(function(e){var t=254,n=340,r=e&&e.getTileProps(),i=r&&r.width&&r.width>=0?r.width:t;return{height:r&&r.height&&r.height>=0?r.height:n,width:i,disableMarqueeSelection:r&&r.hideSelection}})(n),o=s.height,u=s.width,a=s.disableMarqueeSelection,f=n&&n.fillCardsHorizontally()?3:1;return{tileRenderer:Xt,grid:{minRowHeight:o,mode:f},className:"sp-gallery-listContainer",disableMarqueeSelection:a,tileControlHandler:function(){return{desiredSize:{width:u,height:o}}},groupControlHandler:Kt(i)}})(e,r);var i=Object(Y.e)(e,{enableMediaTilesInDocumentGroup:k.R}).enableMediaTilesInDocumentGroup;return void 0===i||i?{tileControlHandler:Qt.e}:{}}}});var Yt=n(549),Zt=n(444),en=n(3635),tn=n(1074),nn=n(3637),rn=n(66),sn=n(3254),on=Object(P.t)()(function(){return function(e){return function(t,n){var r=n.itemKey,i=t.demandItemFacet(p.e,r),s=i&&N.e.serialize(i),o=t.demandItemFacet(k.un,s),u=t.demandItemFacet(k.bn,r),a=t.demandItemFacet(me.i,r),f=i&&i.listFullUrl,l=i&&i.webAbsoluteUrl,c=t.demandItemFacet(me.d,r);return{checkInAction:be.createElement(sn.e,{checkInOutType:"checkIn"}),undoCheckOutAction:be.createElement(sn.e,{checkInOutType:"undoCheckOut"}),onDismiss:function(t,n){var r=e(Object(ut.n)({webAbsoluteUrl:l||"",listFullUrl:f})).dataRequestor,i={ListId:o&&o.listId,ListItemUniqueId:u,Operation:"RecommendationActedOn",AffectedResourceUrl:a,ItemType:"File",json:JSON.stringify({FileName:c&&c.name,Scenario:"RecommendedActions",SourceRelativeUrl:f,DismissRecommendationsCategory:"FocusedTask",PositionNumber:(n+1).toString(),TotalRecommendationsPresented:"3",RecommendationAlgorithmVersion:"1",ReferringCorrelationId:t,Canvas:"Web",Workload:"SharePoint",WebId:o&&o.webId,SiteId:o&&o.siteId,SiteUrl:o&&o.siteAbsoluteUrl,ClientLocalTime:(new Date).toISOString(),SourceFileName:c&&c.name,SourceFileExtension:c&&c.extension,ClientUTCOffsetInMinutes:(new Date).getTimezoneOffset().toString(),RecommendationId:t,ActionType:"Dismiss"})},s=new rn.t(l+"/_api/web/ActivityLogger/FeedbackDirect");r.getData({url:s.toString(),qosName:"DismissActions",method:"POST",needsRequestDigest:!0,additionalPostData:JSON.stringify(i),timeout:6e3,qosExtraData:{Caller:"HoverCard"}})}}}}});var un=n(3350),an=n(964),fn=n(3002),ln=n(1099),cn=Object(P.t)()(function(){return function(e){return function(e,t){var n=t.signalData,i=t.itemKey;if(n&&i&&n.key===an.t.key){var s=e.demandItemFacet(k.tt,i),o=e.demandItemFacet(p.e,i),u=o&&N.e.serialize(o),a=e.demandItemFacet(k.un,u);if(!s||!a||a.listBaseTemplate!==U.n.webPageLibrary)return{};var f=a&&Object(z.n)(a);if(!(!!f&&f.isActivated("eccf828d-ab98-4d4e-b9dd-25467f4f2f10","9/7/2020","Remove file card flight"))){var l=e.demandItemFacet(k.gn,i),c=e.demandItemFacet(k.Ge,i),h=Object(ln.t)(e,i),d=fn.p,v=0,m=an.t.signal,g=fn.r;if(c)d=fn.x;else if(h){d=fn.g;v=1;m=an.e.signal;g=fn.i}else if(l){var y=Math.floor(Number(l)/512);d=0===y?fn.p:fn.m}return{onRenderLifeCycleSignal:function(e,t){return t?be.createElement(je.n,{action:be.createElement(un.e,{itemKeys:[i],publishType:v,source:"FileCard"})},function(n){var i=n.isAvailable,s=n.execute,o=i?function(){s()}:void 0,u=Object(r.__assign)(Object(r.__assign)({},e),{actionName:d,action:o,content:g,signal:m});return t(u)}):null}}}return{}}return{}}}});var hn=n(1332),pn=n(720),dn=n(305),vn=n(568),mn=n(58),gn=n(84),yn=n(78),bn={key:new xe.e("manageAccess").id,automationId:"manageAccessCommand",name:mn.p,title:mn.d,action:be.createElement(gn.t,null,be.createElement(vn.ManageAccessAction,null)),iconProps:{iconName:"PlayerSettings"},facets:Object(r.__assign)({},yn.r.pack(!0))},wn=!z.t.isActivated(T.e,"7/5/2019","Show file handler commands before OOB commands"),En=Object(P.t)()(function(){return function(e){return xn}});var Sn=[pn.e,V.n,V.t,bn];function xn(e,t){var n=Tn(e,t.itemKey);return{commands:(function(e,t){return e.map(function(e){return e.key===pn.e.key?Object(T.n)(t,wn):e})})(Sn,n)}}function Tn(e,t){var n,r=e.demandItemFacet(dn.t,t);if(r){var i=new B.e(r.tenantRootUrl).authority+"/_api/v2.0",s=j.t.serialize({endpoint:i});n=Object(q.e)(e,{itemKey:s})}return n}var Nn=!z.t.isActivated(T.e,"7/5/2019","Show file handler commands before OOB commands"),Cn=[pn.e,V.n,V.t],kn=Object(P.t)()(function(){return function(e){return Ln}});function Ln(e,t){var n=Tn(e,t.itemKey);return{commands:te(Cn,n,!0,Nn,!1)}}var An=n(551),On=n(2941),Mn=n(924),_n=Object(P.t)()(function(){return function(e){return Pn}});var Dn=[An.e,On.e,Mn.e];function Pn(e,t){return{columns:Dn}}var Hn=n(399),Bn=n(363),jn=n(370),Fn=n(3862),In=n(386),qn=n(204),Rn=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=dn.t.deserialize(n).tenantRootUrl;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f;return Object(r.__generator)(this,function(l){switch(l.label){case 0:t=Object(In.n)({webAbsoluteUrl:i}).segments("SP.Directory.DirectorySession","me").rawParameter("$select=mySite");return[4,e(Object(ut.t)({url:t.toString(),qosName:"GetMyOneDriveUrl",method:"POST",webAbsoluteUrl:i,noRedirect:!0}))];case 1:if(!((s=l.sent())&&s.d&&s.d.mySite))throw new Bn.e({facets:Object(r.__assign)({},qn.p.pack({}))});o=s.d.mySite.replace(/\/$/,"");u=jn.t.serialize({webAbsoluteUrl:o||i});(a=new ft.e).resolveItems({items:(f={},f[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},re.t.pack({itemKey:u})),me.h.pack(Fn.e)),me.m.pack({})),f)});e(a.execute());return[2]}})})}});var Un=n(2424),zn=n(165),Wn=n(158),Xn=n(132),Vn=n(929),$n=n(798),Jn=n(1174),Kn=n(250),Qn=n(755),Gn=n(494),Yn=n(554),Zn=n(553),er=n(82),tr=n(145);function nr(e,t){var n=[];e.d.results.forEach(function(e){var i,s,o,u,a=""+new B.e(e.SiteUrl).authority+e.UrlPath,f=e.LinkingUrl?e.LinkingUrl:a,l=$n.e.serialize({itemFullUrl:a});n.push(l);var c=Object(Un.t)(e.Modified),h=(function(e){var t=Object(Vn.e)(e),n={itemFullUrl:t};return{parentItemUrl:t,parentItemKey:$n.e.serialize(n)}})(a),p=h.parentItemKey,d=h.parentItemUrl;t.mapKeys({mappings:(i={},i[$n.e.serialize({itemFullUrl:d})]=p,i)});var v=(function(e,t){var n=void 0!==t?t:3,r=!1,i=!1;if(e.IsContainer){n=Kn.e.folder;i=!0}"OneNote.Notebook"===e.ProgId&&(r=!0);return{isOneNote:r,isDocSet:!1,fileIconType:n,isFolder:i}})(e),m=e.SpItemUrl?Object(Gn.e)(e.SpItemUrl):void 0;if(m)for(var g=0,y=Object(Gn.t)(m);g<y.length;g++){var b=y[g];t.mapKeys({mappings:(s={},s[b]=l,s)})}var w,E,S,x,T=e.Editor;if(T&&T.email&&T.name){var N=Jn.e.serialize({id:T.email});w={itemKey:N,displayValue:T.name};t.resolveItems({items:(o={},o[N]=Object(r.__assign)(Object(r.__assign)({},me.h.pack(T.name)),Wn.e.pack(T.email)),o)})}t.resolveItems({items:(u={},u[l]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},me.h.pack(e.FileLeafRef)),me.x.pack(!0)),me.d.pack((E=e.FileLeafRef,S=e.IsContainer,x=E.lastIndexOf("."),S||x<0?{name:E,extension:""}:{name:E.substring(0,x),extension:E.substring(x)}))),Xn.e.pack(v.fileIconType)),me.f.pack(c.getTime())),me.i.pack(a)),me.M.pack({itemKey:p})),w?me.A.pack(w):{}),Xn.i.pack(v.isOneNote?{}:void 0)),me.m.pack(v.isFolder?{}:void 0)),me.O.pack(f)),er.e.pack(m)),k.We.pack(e.ListItemId.toString())),e.UniqueId?k.bn.pack(Object(tr.normalizeLower)(e.UniqueId,!1)):{}),e.ListId?k.ze.pack(Object(tr.normalizeLower)(e.ListId,!1)):{}),m?Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},me.n.pack({itemKey:Yn.e.serialize({driveItemKey:m})})),me.g.pack({itemKey:Zn.e.serialize({driveItemKey:m})})),me.e.pack({itemKey:Qn.e.serialize({driveItemKey:m})})):{}),Object(zn.e)().forFacet(me.h).thenInvalidate(l,re.e).pack()),u[p]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},me.m.pack({})),me.i.pack(d)),me.O.pack(d)),u)})});return n}var rr=n(1441),ir=n(211),sr=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=jn.t.deserialize(n).webAbsoluteUrl;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,l,c,h;return Object(r.__generator)(this,function(p){switch(p.label){case 0:t=(t=Object(In.r)({webAbsoluteUrl:i,listOrItemFullUrl:""})).segment("OneDriveSharedItems").parameter("$top",100).parameter("$expand",{raw:"SpItemUrl,DriveAccessToken,DriveAccessTokenV21,DriveUrl"});s=t.toString();return[4,e(Object(ut.t)({url:s,method:"GET",qosName:"getSharedByMeDocs",webAbsoluteUrl:i}))];case 1:o=p.sent();u=new ft.e;a=nr(o,u);f=""+new B.e(i).authority;l=dn.t.serialize({tenantRootUrl:f});if(o.d.__next){c=rr.e.serialize({itemSet:jn.t.deserialize(n),after:o.d.__next});a.push(c);u.merge(Object(ir.t)({itemKey:c}).itemResolver)}u.resolveItems({items:(h={},h[n]=Object(r.__assign)(Object(r.__assign)({},re.e.pack({itemKeys:a})),re.s.pack({itemKey:l})),h[l]=Object(r.__assign)({},Object(zn.e)().forFacet(re.t).thenInvalidate(n,re.e).pack()),h)});e(u.execute());return[2]}})})}});var or=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=rr.e.deserialize(i).after,o=rr.e.deserialize(i).itemSet;return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,u,a,f,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,t(Object(ut.t)({url:s,method:"GET",qosName:"getSharedByMeDocs",webAbsoluteUrl:o.webAbsoluteUrl}))];case 1:n=r.sent();u=jn.t.serialize(o);a=new ft.e({publisher:e});f=nr(n,a);if(n.d.__next){l=rr.e.serialize({itemSet:o,after:n.d.__next});f.push(l);a.merge(Object(ir.t)({itemKey:l}).itemResolver)}a.merge(Object(ir.e)({itemKey:i,itemSetKey:u,childItemKeys:f}).itemResolver);t(a.execute());return[2]}})})}});var ur=n(3357),ar=n(1344),fr=n(1293),lr=n(632),cr=n(1210),hr=n(136),pr=Object(P.t)()(function(){return function(e){return function(e,t){return(function(e,t){var n=t.itemKey,i=Object(Y.e)(e,{enableItemActivityField:k.B}).enableItemActivityField,s=e.demandItemFacet(k.de,n),o=i&&Object(hr.r)(e,be.createElement(cr.e,{itemKey:n,isCompact:!0,hideDate:!0}))||s&&be.createElement(lr.e,{text:s}),u=e.demandItemFacet(k.Ye,n);return Object(r.__assign)(Object(r.__assign)({},o?{itemActivity:o}:{}),{folderCoverControlHandler:function(e,t){return u?{folderCoverAs:dr}:{}}})})(e,t)}}});function dr(e){var t=e.defaultRender,n=Object(r.__rest)(e,["defaultRender"]);return t?be.createElement(t,Object(r.__assign)({},n,{folderCoverType:"linked"})):null}var vr=n(1333),mr=n(1049),gr=n(2776),yr=n(1196),br=n(1550),wr=n(398),Er=n(594),Sr=n(724);function xr(e){var t=e.listMediaTransformSchema,n=e.itemMediaTransformSchema;if(t&&n){var i=t[".transformUrl"],s=n[".hasThumbnail"],o=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},t),n),{".method":"thumbnail"});if("True"===s&&i)return function(e,t){var n=t?{width:e,height:t}:{width:e};return Object(Sr.n)(i,o)+"&"+Object(Er.e)(n)}}}var Tr=Object(i.i)({maxParallelOperationCount:16})(function(e){var t=this,n=yr.e.deserialize(e.itemKey).itemKey;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,u;return Object(r.__generator)(this,function(a){switch(a.label){case 0:return[4,i(Object(br.e)(function(e){var t=e.demandItemFacet(p.e,n),r=t&&y.e.serialize(t);return{generator:xr({listMediaTransformSchema:e.demandItemFacet(wr.t,r),itemMediaTransformSchema:e.demandItemFacet(wr.e,n)})}}))];case 1:t=a.sent().generator;(s=new ft.e).resolveItems(((o={items:(u={},u[e.itemKey]=Object(r.__assign)({},wr.r.pack(t)),u)})[n]=Object(r.__assign)({},Object(zn.e)().forFacet(wr.e).thenInvalidate(e.itemKey,wr.r).pack()),o));i(s.execute());return[2]}})})}});var Nr=Object(i.t)(function(){return function(e){e(Object(s.r)(yr.e,ot.e)(Tr));e(Object(o.e)(p.e,mr.e)(gr.n));e(Object(o.e)($n.e,mr.e)(gr.t))}}),Cr=Object(i.t)(function(){return function(e){e(Object(o.e)(p.e,_t.e)(pr));e(Nr);e(vr.e)}}),kr=n(3638),Lr=Object(P.t)()(function(){return function(e){return function(e,t){var n=t.itemKey;return{isAvailable:!!e.demandItemFacet(p.e,n)}}}});var Ar=n(3394),Or=n(497),Mr=n(790),_r=n(3863),Dr=n(1503),Pr=n(53),Hr=n(22),Br=n(505),jr=Object(P.t)()(function(){return function(e){return function(e,t){return{errorRenderer:Fr}}}});var Fr=Object(Le.t)(function(e,t){var n=t.defaultRender,i=(t.itemKey,t.title,Object(r.__rest)(t,["defaultRender","itemKey","title"])),s=i.error;if(s instanceof Pr.e&&s.extraData&&404===s.extraData.status){var o=Object(Br.e)(e),u=o&&o.localItemKey,a=void 0,f=_r.e;if(u){var l=e.demandItemFacet(me.h,u);l&&(f=Hr.format(_r.t,l));a=be.createElement("div",null,be.createElement(je.n,{action:be.createElement(Mr.e,{itemKeys:[u]})},function(e){var t=e.execute;return be.createElement(Dr.e,{onClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,t().then(function(){window.location.href="#"}).catch()];case 1:e.sent();return[2]}})})}},_r.r)}))}return be.createElement(be.Fragment,null,n?be.createElement(n,Object(r.__assign)({key:"error"},i,{title:_r.n,subText:f,actions:a})):null)}return n?be.createElement(n,Object(r.__assign)({},t)):null}),Ir=n(1177),qr=n(1790),Rr={key:Jn.e,displayName:me.h,email:Wn.e},Ur=Object(i.i)()(function(e){var t=e.itemKey,n=Ir.e.deserialize(t);return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,s,o,u,a,f,l,c,h,p;return Object(r.__generator)(this,function(d){switch(d.label){case 0:i=n.siteUrl||"";s=n.listId||"";o=n.uniqueId||"";u=i+"/_api/web/Lists('"+s+"')/GetPlacesInformation('"+o+"')?$expand=places";d.label=1;case 1:d.trys.push([1,3,,4]);return[4,e(Object(qr.n)({url:u,qosName:"GetPlacesInformation",method:"GET",endpoint:i}))];case 2:a=d.sent();f=new ft.e;l=[];(c=a&&a.places)&&c.forEach(function(e){var t,n=e.userEntity.email,r=Jn.e.serialize({id:String(n)});f.resolveItems({items:(t={},t[r]=Object(xe.n)(Rr,{key:{id:String(n)},displayName:e.userEntity.name,email:n}),t)});l.push(r)});h=a.placesCount&&parseInt(a.placesCount,10);f.resolveItems({items:(p={},p[t]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},k.dt.pack({locationKeys:l})),h&&!isNaN(h)?Object(r.__assign)({},k.vt.pack(h)):{}),k.je.pack(a.itemSourcePath)),me.h.pack(a.itemSourceSiteTitle)),p)});e(f.execute());return[3,4];case 3:throw d.sent();case 4:return[2]}})})}}),zr=n(2777),Wr=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Nt.e);e(hn.e);e(ar.e);e(x.spDataOnlyAddonDeferred);e(Object(o.e)(p.e,fr.e)(T.t));e(Object(o.e)(p.e,c.e)(ee));e(Object(o.e)(d.e,f.e)(ue));e(Object(o.e)(p.e,a)(ge));e(Object(o.e)(d.e,h.e)(Ge));e(Object(o.e)(p.e,h.e)(Ye));e(Object(o.e)(d.e,u.e)(et));e(Cr);e(Object(s.r)(v.e,ot.e)(tt.e));e(Object(s.r)(m.e,ot.e)(st));e(Object(s.r)(g.e,ot.e)(lt));e(Object(s.r)(y.e,ct.t)(Tt));e(Object(s.r)(y.e,pt)(Ct));e(Object(o.e)(b.e,Yt.e)(Gt));e(Object(o.e)(p.e,Zt.e)(en.e));e(Object(o.e)(p.e,tn.e)(on));e(Object(o.e)(dn.t,l.e)(En));e(Object(o.e)(jn.t,Hn.e)(_n));e(Object(o.e)(dn.t,c.e)(kn));e(Object(s.r)(dn.t,ot.e)(Rn));e(Object(s.r)(jn.t,ot.e)(sr));e(Object(s.r)(rr.e,ot.e)(or));e(Object(s.r)(Ir.e,ot.e)(Ur));e(Object(o.e)(w.e,f.e)(he));e(Object(o.e)(p.e,nn.e)(cn));e(Object(s.r)(E.e,ot.e)(ur.t));e(Object(o.e)(S.e,Or.e)(jr));e(Object(o.e)(p.e,kr.e)(Lr));e(Object(s.r)(p.e,zr.e)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(41,4421)];case 1:return[2,e.sent().setItemValuesFromFormatter]}})})})));return[2]})})}})},,,,,,,,,,function(e,t,n){"use strict";n.r(t);n.d(t,"graphAddonDeferred",function(){return Xe});var r,i=n(10),s=n(217),o=n(362),u=n(1034),a=n(322),f=n(9),l=n(720),c=n(620),h=n(3423),p=n(84),d=n(2),v=n("react-lib"),m=n(341),g=n(790),y={action:v.createElement(p.t,null,v.createElement(g.t,null)),automationId:"removeShortcutFromSharedWithMeCommand",title:m.a,iconProps:{iconName:"FabricFolderLink"},key:new d.e("RemoveShortcutFromSWM").id,name:m.u},b=n(0),w=n(119),E=n(201),S=n(1515),x=n(679),T=n(3252),N=n(6),C=n(40),k=n(57),L=n(115),A=n(18),O=n(30),M=n(26),_=n(3638),D=n(47),P=n(223),H=n(70),B=Object(C.t)(function(e,t){var n=t.itemKeys,r=t.removeFromSharedListWizard,i=t.removeItemsFromSharedList,s=void 0===i?T.t:i,o=Object(k.e)(e)||"",u=e.demandItemFacet(P.e,o);if(0===n.length)return null;for(var a=u&&n.length<=200,f=r,l=0,c=n;l<c.length;l++){var h=c[l],p=e.demandItemFacet(_.e,h),d=!H.t.isActivated("6c28a705-1f14-4f06-97c7-ee39b2d66e9e","11/5/2020","Action should be available unless otherwise stated in control handler");_.e.evaluate(p)(e,{itemKey:h,isAvailable:d}).isAvailable||(a=!1)}var m=e.dispatch,g=function(){return Object(b.__awaiter)(void 0,void 0,void 0,function(){var e,t;return Object(b.__generator)(this,function(r){switch(r.label){case 0:e={itemSetKey:o};t=Object(L.e)(n,function(){return e});return[4,m(s({items:t}))];case 1:r.sent();return[2]}})})},y=Object(A.o)(function(e){return v.createElement(f,Object(b.__assign)({},e,{onItemRemoved:g,itemKeys:n}))});return v.createElement(O.e,Object(b.__assign)({isAvailable:a,onExecute:y},Object(D.t)(e,{itemKey:void 0,engagement:{name:"RemoveFromSharedList",isIntentional:!0,extraData:{itemCount:n.length}}})))}),j=Object(M.s)()(B),F=n(3907),I=n(3705),q=n(22),R=n(74),U=n(614),z=n(163),W=((r={})[R.r.started]=function(e){return Object(q.formatToArray)(Object(q.getLocalizedCountValue)(I.s,I.t,e)||"",e)},r[R.r.completed]=function(e){return Object(q.formatToArray)(Object(q.getLocalizedCountValue)(I.e,I.t,e)||"",e)},r[R.r.failed]=function(e){return Object(q.formatToArray)(Object(q.getLocalizedCountValue)(I.n,I.r,e)||"",e)},r[R.r.canceled]=function(e){return Object(q.formatToArray)(Object(q.getLocalizedCountValue)(I.n,I.r,e)||"",e)},r),X=Object(i.t)(function(){return function(e){e(Object(a.e)(T.e,U.e)(Object(f.t)()(V)))}});function V(){return function(e){return $}}function $(e,t){var n,r=Object(z.r)(e,t),i=r.phase,s=r.count;n=W[i](s);return Object(b.__assign)({},n&&"item"!==t.format?{title:n}:{})}var J=(function(e){Object(b.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,n=t.resolve,r=t.reject,i=t.onItemRemoved,s=t.itemKeys,o=function(){return Object(b.__awaiter)(e,void 0,void 0,function(){return Object(b.__generator)(this,function(e){switch(e.label){case 0:n();return[4,i()];case 1:e.sent();return[2]}})})},u=function(){return Object(b.__awaiter)(e,void 0,void 0,function(){return Object(b.__generator)(this,function(e){r(new w.e);return[2]})})};return v.createElement(E.e,null,function(e){var t=e.itemCache,n=K(t,s),r=n.title,i=n.prompt;return v.createElement(S.ConfirmationDialog,{onCancel:u,onConfirm:o,yesText:I.i,noText:F.o,defaultToYes:!0,title:r,prompt:i})})};return t})(v.PureComponent),K=function(e,t){if(t.length>1)return{title:F.s,prompt:F.i};if(1===t.length){var n=e.demandItemFacet(N.m,t[0]);return{title:n?F.r:F.t,prompt:n?F.n:F.e}}return{title:"",prompt:""}},Q=Object(x.e)({operationTypeFacet:T.n,progressKeyFacet:T.e,initializeBatch:function(){return X}});var G=Object(C.e)(function(){return{removeFromSharedListWizard:J,removeItemsFromSharedList:Q}})(j),Y={key:new d.e("removeFromSharedList").id,automationId:"removeFromSharedListCommand",name:m.f,title:m.l,action:v.createElement(p.t,null,v.createElement(G,null)),iconProps:{iconName:"Cancel"}},Z=Object(f.t)()(function(){return function(e){return te}});var ee=[l.e,c.n,c.t,h.e,y,Y];function te(e,t){return{commands:ee}}var ne=n(4038),re=n(365),ie=Object(f.t)()(function(){return function(e){return oe}});var se=[l.e,c.n,c.t,h.e,y,Y];function oe(e,t){return{commands:se}}var ue,ae=n(286),fe=n(280),le=n(240),ce=((ue={})[le.t]=!0,ue[le.r]=!0,ue[fe.i]=!0,ue[fe.e]=!0,ue[fe.r]=!0,ue),he=Object(f.t)()(function(){return function(e){return pe}});function pe(e,t){var n=t.itemSetKey,r=t.handler,i=r.columnKey,s=r.isAscending;if(!ce[i])return{};var o=e.demandItemFacet(P.e,n);if(!o)return{};var u=fe.t[i];return u?{newItemSetKey:P.e.serialize(Object(b.__assign)(Object(b.__assign)({},o),{sortBy:u,isAscending:s}))}:{}}var de,ve=n(238),me=n(466),ge=n(3624),ye=Object(f.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItemFacet(P.e,n),i=r&&r.driveItemKey.endpoint,s=i&&r&&Object(ge.e)(e,{itemSetKey:P.e.serialize(r),parentItemKey:re.e.serialize({endpoint:i}),stageItem:t.stageItem});return Object(b.__assign)({},s?{stageItem:s}:{})}}});var be=((de={})[fe.i]=!0,de[fe.e]=!0,de),we=Object(f.t)()(function(){return function(e){return Ee}});function Ee(e,t){var n=t.itemSetKey,r=t.handler.columnKey;if(!be[r])return{};var i=e.demandItemFacet(P.e,n);if(!i)return{};var s=fe.t[r];return s?{newItemSetKey:P.e.serialize(Object(b.__assign)(Object(b.__assign)({},i),{groupBy:s}))}:{}}var Se=Object(f.t)()(function(){return function(e){return xe}});function xe(e,t){var n=t.itemSetKey,r=e.demandItemFacet(P.e,n);return r?{newItemSetKey:P.e.serialize(Object(b.__assign)(Object(b.__assign)({},r),{groupBy:void 0}))}:{}}var Te=n(3621),Ne=Object(f.t)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var Ce=Object(f.t)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var ke=n(885),Le=n(3401),Ae=n(349),Oe=n(198),Me=n(162),_e=n(59),De=n(1790),Pe=n(5),He=new Pe.e("topCollaboratorItemKeyFacet",{id:Object(Pe.s)()}),Be=n(155),je=n(158),Fe=n(8),Ie=Object(i.i)()(function e(t){var n=this,r=t.itemKey;return function(i){return Object(b.__awaiter)(n,void 0,void 0,function(){var n,s,o,u,a,f,l,c,h,p,d,v,m,g,y,w;return Object(b.__generator)(this,function(E){switch(E.label){case 0:n=new Oe.e({publisher:e});s=i(Object(Me.e)({graphEndpoint:_e.v})).graphEndpoint;o=Le.e.deserialize(r);u=s||o.endpoint;a=u+"/me/people/";return[4,i(Object(De.n)({url:a,qosName:"getTopCollaborator",endpoint:u}))];case 1:f=E.sent();l=[];for(c=0,h=f.value;c<h.length;c++){p=h[c];d=p.id,v=p.displayName,m=p.userPrincipalName;g=He.serialize({id:d});i(Object(Be.e)({items:(y={},y[g]=Object(b.__assign)(Object(b.__assign)({},N.h.pack(v)),je.e.pack(m)),y)}));l.push(g)}n.resolveItems({items:(w={},w[t.itemKey]=Object(b.__assign)({},Fe.e.pack({itemKeys:l})),w)});i(n.execute());return[2]}})})}});var qe=n(403),Re=n(385),Ue=n(372),ze=Object(f.t)()(function(){return function(){return We}});function We(e,t){var n,r=t.layouts;if(r){n=[];for(var i=0,s=r;i<s.length;i++){var o=s[i];o.layoutType!==Re.t.layoutType?o.layoutType!==Re.e.layoutType?o.layoutType!==Ue.t.layoutType?n.push(o):n.push(Ue.t):n.push(Re.e):n.push(Re.t)}}return Object(b.__assign)({},n?{layouts:n}:{})}var Xe=Object(i.t)(function(){return function(e){e(Object(ke.e)(function(){e(ne.graphAddonDataOnlyDeferred);e(Object(a.e)(re.e,o.e)(ie));e(Object(a.e)(re.e,u.e)(Z));e(Object(a.e)(P.e,ae.e)(he));e(Object(a.e)(P.e,ve.e)(ye));e(Object(a.e)(P.e,me.e)(we));e(Object(a.e)(P.e,me.t)(Se));e(Object(a.e)(Te.n,ve.e)(Ne));e(Object(a.e)(Te.t,ve.e)(Ce));e(Object(s.r)(Le.e,Ae.e)(Ie));e(Object(a.e)(P.e,qe.e)(ze))}))}})}],Array(13),[function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointAddonAutoRefresh",function(){return Le});var r,i=n(10),s=n(322),o=n(65),u=n(3649),a=n(0),f=n("react-lib"),l=n(299),c=n(9),h=n(27),p=n(8),d=n(6),v=n(198),m=n(220),g=n(249),y=n(70),b=n(1175),w=n(3650),E=n(611),S=n(109),x=n(48);(function(e){e[e.New=0]="New";e[e.Update=1]="Update";e[e.Delete=2]="Delete"})(r||(r={}));var T={ODB:819,ODC:"EnablePushChannelLogging"},N={ODB:459},C=(function(){function e(e){var t=this;this.subscribe=function(){t._log("Subscribe");if(0===t._subscribers){t._async=new m.e;y.t.isActivated("90f6bcb1-03a0-4a02-9370-1e6807d6763a","7/22/2021","Fix Item Auto Refresh Bug")||(t._syncToken="latest");var e=t._async.debounce(function(){return t._onNotification()},1e4,{leading:!0,maxWait:1e4});t._pushChannelService.setupNotificationHandler({source:w.t.WebhookSubscription},function(){t._log("PushChannelMessageSource",w.t.WebhookSubscription);e()});t._pushChannelService.setupNotificationHandler({source:w.t.EventHub},function(){t._log("PushChannelMessageSource",w.t.EventHub);e()});t._pushChannelService.addConnectionHandler(t._id,function(e){return t._onPushChannelConnection(e)})}t._subscribers++;t._pushChannelService.isConnected()||t._pushChannelService.connect(t._getNotification(),{methodInvoker:"ItemAutoRefreshHelper.subscribe"});return t._unsubscribe.bind(t)};this._id=e.id;this._driveUrlParts=e.driveUrl?Object(b.e)(e.driveUrl):void 0;this._dispatch=e.dispatch;this._template=e.template;this._itemScopeItemKey=e.itemsScopeItemKey||"";this._pushChannelService=e.pushChannelService;this._onUnsubscribe=e.onUnsubscribe;this._isTestMode=e.isTestMode;this._onPushChannelConnected=e.onPushChannelConnected;this._onNotificationReceived=e.onNotificationReceived;this._subscribers=0;this._syncToken="latest";this._getChangesAttempts=0}e.prototype._unsubscribe=function(){this._log("Unsubscribe");this._subscribers--;this._template.onUnsubscribe(this._subscribers);if(0===this._subscribers){if(this._async){this._async.dispose();this._async=void 0;this._refreshSubscriptionTimeoutId=void 0}this._pushChannelService.setupNotificationHandler({source:w.t.WebhookSubscription},function(){});this._pushChannelService.removeConnectionHandler(this._id);this._pushChannelService.disconnect()}this._onUnsubscribe(this._subscribers);return this._subscribers};e.prototype._onPushChannelConnection=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(a.__generator)(this,function(r){switch(r.label){case 0:if(!e){this._log("Disconnected");this._clearRefreshSubscriptionTimeout();return[2]}this._log("Connected");this._isTestMode&&this._onPushChannelConnected&&this._onPushChannelConnected();if(y.t.isActivated("90f6bcb1-03a0-4a02-9370-1e6807d6763a","7/22/2021","Fix Item Auto Refresh Bug"))return[3,5];r.label=1;case 1:r.trys.push([1,3,,4]);return[4,this._resolveChangeMessages()];case 2:r.sent();return[3,4];case 3:t=r.sent();this._handleError(t);return[2];case 4:return[3,9];case 5:if("latest"!==this._syncToken)return[3,9];r.label=6;case 6:r.trys.push([6,8,,9]);return[4,this._getChangeMessages()];case 7:r.sent();return[3,9];case 8:n=r.sent();this._handleError(n);return[2];case 9:this._refreshSubscriptionHandler();return[2]}})})};e.prototype._handleError=function(e){var t=this;this._getChangesAttempts++;if(!(this._getChangesAttempts>10)){var n=!1;if(Object(E.s)(e))switch(e.status){case 404:case 410:n=!0;this._syncToken="latest"}n&&this._async&&this._async.setTimeout(function(){return t._onPushChannelConnection(t._pushChannelService.isConnected())},500+Math.pow(2,this._getChangesAttempts))}};e.prototype._getNotification=function(){return this._template.getSubscription&&this._template.getSubscription(this._dispatch)};e.prototype._refreshSubscriptionHandler=function(){var e=this;if(this._async){var t=this._pushChannelService.getSocketIoSubscription();if(t){var n=105001*Math.random()+15e3,r=Date.parse(t.expirationDateTime),i=Date.now(),s=r-i-n;if(s<12e4){if(g.e.isFeatureEnabled(N)){var o={refreshDelay:s,expirationDateTime:t.expirationDateTime,expirationDateTimeinMS:r,dateTimeNow:i,recreateBufferRandom:n};new S.e({name:"ItemAutoRefreshHelper.refreshSubscription",extraData:o}).end({resultType:x.e.Failure,extraData:o})}s=12e4}this._clearRefreshSubscriptionTimeout();this._refreshSubscriptionTimeoutId=this._async.setTimeout(function(){return Object(a.__awaiter)(e,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:this._log("Refreshing subscription");this._refreshSubscriptionTimeoutId=void 0;return[4,this._pushChannelService.refreshSubscription()];case 1:!0===e.sent()&&this._refreshSubscriptionHandler();return[2]}})})},s)}}};e.prototype._clearRefreshSubscriptionTimeout=function(){if(this._async&&void 0!==this._refreshSubscriptionTimeoutId){this._async.clearTimeout(this._refreshSubscriptionTimeoutId);this._refreshSubscriptionTimeoutId=void 0}};e.prototype._getChangeMessages=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,this._template.getChangeMessages(this._dispatch,this._syncToken,this._driveUrlParts)];case 1:e=t.sent();this._syncToken=e.syncToken?e.syncToken:"latest";this._getChangesAttempts=0;return[2,e]}})})};e.prototype._onNotification=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:t.trys.push([0,2,,3]);if(this._template.hasPendingRequest())return[2];this._isTestMode&&this._onNotificationReceived&&this._onNotificationReceived();return[4,this._resolveChangeMessages()];case 1:t.sent();return[3,3];case 2:e=t.sent();this._log("onNotification error",e);return[3,3];case 3:return[2]}})})};e.prototype._resolveChangeMessages=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,i,s,o,u,f,l,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:t=new v.e({publisher:e});return[4,this._getChangeMessages()];case 1:n=a.sent();this._log("Change messages",n);i=this._processMessages(n.messages);this._log("Changes",i);t.merge(n.itemResolver);for(s=0,o=i;s<o.length;s++)switch((u=o[s]).type){case r.New:t.invalidateItems({items:(f={},f[u.invalidateKey]=[p.t],f)});break;case r.Update:u.hasSelection&&this._itemScopeItemKey?this._updateItems(u.invalidateKey):t.invalidateItems({items:(l={},l[u.invalidateKey]=[u.invalidateFacet],l)});break;case r.Delete:t.invalidateItems({items:(c={},c[u.invalidateKey]=[d.l],c)})}this._dispatch(t.execute());return[2]}})})};e.prototype._processMessages=function(e){var t=[];e.sort(function(e,t){return e.parentItemKey?0:1});for(var n=0;n<e.length;n++){var r=e[n],i=this._template.processMessage(this._dispatch,r,this._itemScopeItemKey);if(void 0!==i){this._log("Change",i.invalidateKey,i.reason);t.push(i)}else if(r.parentItemKey)for(var s=n+1;s<e.length;s++){if(e[s].itemKey===r.parentItemKey){e.splice(s,1);break}}}return t};e.prototype._updateItems=function(e){this._template.updateItems(this._dispatch,e)};e.prototype._log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];g.e.isFeatureEnabled(T)&&console.log.apply(console,Object(a.__spreadArrays)(["ItemAutoRefreshHelper"],e))};return e})(),k=n(1790),L=n(2017),A=n(59),O=n(3872),M=n(3871),_=n(29),D=n(398),P=n(75),H=n(1),B=n(45),j=n(573),F=n(120),I=n(122),q=n(137),R=n(162),U=n(82),z=n(494),W=n(476),X=n(798),V=n(53),$=(function(){function e(e){this._dataRequestor=e.dataRequestor;this._rootItemKey=e.rootItemKey;this._pendingRequest=!1}e.prototype.onUnsubscribe=function(e){};e.prototype.getSubscription=function(e){var t,n,r,i,s,o,u,a,f,l=this,c=e(Object(q.e)(function(e){return{spItem:e.demandItemFacet(B.e,l._rootItemKey)}})).spItem;if((null===(t=c)||void 0===t?void 0:t.webAbsoluteUrl)&&c.listFullUrl){var h=F.e.serialize({webAbsoluteUrl:null===(n=c)||void 0===n?void 0:n.webAbsoluteUrl,listFullUrl:null===(r=c)||void 0===r?void 0:r.listFullUrl}),p=e(Object(q.e)(function(e){return e.demandItemFacet(H.$e,h)}));if((null===(i=p)||void 0===i?void 0:i.notificationUrl)&&(null===(s=p)||void 0===s?void 0:s.expirationDateTime)&&(null===(o=p)||void 0===o?void 0:o.subscribeID))return{notificationUrl:null===(u=p)||void 0===u?void 0:u.notificationUrl,expirationDateTime:null===(a=p)||void 0===a?void 0:a.expirationDateTime,id:null===(f=p)||void 0===f?void 0:f.subscribeID}}};e.prototype.hasPendingRequest=function(){return this._pendingRequest};e.prototype.getChangeMessages=function(e,t,n){var r;return Object(a.__awaiter)(this,void 0,void 0,function(){var i,s,o,u,f,l,c,h,p,d,m,g,b,w,E,S,x,T,N,C,k,O,M,_,D,P,j,$,J,K,Q,G=this;return Object(a.__generator)(this,function(Y){switch(Y.label){case 0:if(void 0===n||void 0===n.endpoint||void 0===n.driveId)throw"Invalid drive url parts";i=n.endpoint+"/drives/"+n.driveId;s=e(Object(R.e)({isTAB:A.S})).isTAB;o=e(Object(q.e)(function(e){return{spItem:e.demandItemFacet(B.e,G._rootItemKey)}})).spItem;u=new v.e;if("latest"===t&&o){f=F.e.serialize({webAbsoluteUrl:o.webAbsoluteUrl,listFullUrl:o.listFullUrl});l=e(Object(q.e)(function(e){return e.demandItemFacet(H.Re,f)}));if(c=null===(r=l)||void 0===r?void 0:r.tick){h=c-621355968e9;h/=1e4;p=new Date(h);if(!y.t.isActivated("90f6bcb1-03a0-4a02-9370-1e6807d6763a","7/22/2021","Fix Item Auto Refresh Bug")){t=""+p.toISOString();d=new Date;if((d.getTime()-p.getTime())/1e3<30)return[2,{syncToken:t,messages:[],itemResolver:u}]}return[2,{syncToken:""+p.toISOString(),messages:[],itemResolver:u}]}}return(b=n.endpoint)?[4,e(Object(L.getSessionToken)(n.endpoint,i))]:[3,2];case 1:b=Y.sent();Y.label=2;case 2:if(void 0===(m=(g=b)&&g.accessToken))throw new V.e({code:"authFailure"});this._pendingRequest=!0;w=i+"/root/view.delta?token="+encodeURIComponent(t);return[4,this._dataRequestor.send({apiName:"viewDelta",path:w,accessToken:{accessToken:m,tokenUrl:i},useAuthorizationHeaders:!0,headers:Object(a.__assign)({"X-RestrictedReadCapabilities":"ForceCheckOut,RequiredColumn,ContentApproval,Irm,ExcludeFromOfflineClient,DocumentParser,DraftItemSecurity,ItemLevelPermissions"},s?{}:{ScenarioType:"BGO"})})];case 3:E=Y.sent();S=[];if(E&&E.value)for(x=0,T=E.value;x<T.length;x++){N=T[x];C=void 0;k={endpoint:n.endpoint,driveId:n.driveId,itemId:N.id};if(N.root){P=Object(z.t)(k);for(O=0,M=P;O<M.length;O++){J=M[O];u.mapKeys({mappings:(K={},K[J]=this._rootItemKey,K)})}}else if(N.webUrl&&(_=Object(W.n)(N.webUrl))){D=X.e.serialize({itemFullUrl:_});if(e(Object(I.e)({spItemKey:B.e},D)).spItemKey){P=Object(z.t)(k);for(j=0,$=P;j<$.length;j++){J=$[j];u.mapKeys({mappings:(Q={},Q[J]=D,Q)})}}}if(!N.root){N.parentReference&&(C=N.parentReference.id);S.push({itemKey:U.e.serialize(k),parentItemKey:C&&U.e.serialize({endpoint:n.endpoint,driveId:n.driveId,itemId:C}),isDeleted:!!N.deleted,isShared:!!N.shared,name:N.name,dateModified:N.lastModifiedDateTime,eTag:N.eTag})}}this._pendingRequest=!1;return[2,{syncToken:E["@delta.token"],messages:S,itemResolver:u}]}})})};e.prototype.updateItems=function(e,t,n){};e.prototype.processMessage=function(e,t,n){if(t.isDeleted){if(e(Object(I.e)({deleted:d.l},t.itemKey)).deleted)return;return{type:r.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}var i=e(Object(I.e)({spItemKey:B.e,mediaTransformSchema:D.e,displayName:d.h},t.itemKey)),s=i.spItemKey,o=i.mediaTransformSchema,u=i.displayName;if(void 0===s){if(!t.parentItemKey)return;return{type:r.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(o&&t.eTag){var a=o[".etag"];if(a&&t.eTag&&t.eTag!==a)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:D.e,reason:"eTag changed from "+a+" to "+t.eTag}}if(void 0!==t.name&&u!==t.name)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:d.h,reason:"Name changed from "+u+" to "+t.name}};return e})(),J=n(330),K=n(32),Q=n(39),G=n(723),Y=n(125),Z=n(471),ee=n(83),te=n(386),ne={ODB:819,ODC:"EnablePushChannelLogging"},re=(function(){function e(e){this._dispatch=e.dispatch;this._webAbsoluteUrl=e.webAbsoluteUrl;this._listFullUrl=e.listFullUrl;this._listId=e.listId}e.prototype.getSocketIoSubscription=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,r,i,s,o,u,f,c,h,p,d,v,m,g;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(e.existingSubscription)return[3,5];n=Object(te.n)({webAbsoluteUrl:this._webAbsoluteUrl}).segments("microservicemanager","getserviceurls").parameter("service","push");return[4,this._dispatch(Object(ee.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:n.toString(),method:"GET",qosName:"GetServiceUrls",noRedirect:!0})).catch(function(e){Z.n.isFeatureEnabled(ne)&&console.log("Error getting service url: ",e)})];case 1:r=a.sent();i=this._dispatch(Object(R.e)({isTest:A.S})).isTest;if(!(s=r&&r.d&&r.d.GetServiceUrls&&r.d.GetServiceUrls.results&&r.d.GetServiceUrls.results[0])&&!i)throw new Error("Unable to retrieve PushChannel base url");i&&(s="https://northcentralus0-pushs.svc.ms");o=s+"/notifications/register";u=Y.e.generate();f=this._dispatch(Object(l.e)({name:"SubscriptionServiceGenericList.Register"}));c={correlationId:u};a.label=2;case 2:a.trys.push([2,4,,5]);return[4,G.e.start({url:o,method:"GET",headers:{"X-Correlation-Id":u},requestTimeoutInMS:1e4})];case 3:(h=a.sent())&&h.responseText&&h.responseText.length>0&&(p=JSON.parse(h.responseText))&&p.serverUrl&&p.webhookUrl&&(t=p.webhookUrl);if(void 0===t)throw new Error("Unable to retireve PushChannel notification url");this._dispatch(f({resultType:Q.t.success,extraData:c}));return[3,5];case 4:d=a.sent();this._dispatch(f({resultType:Q.t.failure,extraData:c}));throw d;case 5:v=Object(te.r)({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId);if(e.existingSubscription){v=v.method("Subscriptions",{guid:e.existingSubscription.id}).segment("Update");t=e.existingSubscription.notificationUrl}else v=v.segments("Subscriptions","Add");m={parameters:{resource:this._listId,notificationUrl:t,expirationDateTime:new Date(Date.now()+3e5).toISOString(),clientState:""}};return[4,this._dispatch(Object(ee.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:v.toString(),body:JSON.stringify(m),qosName:"SubscriptionServiceGenericList.getSocketIoSubscription",method:"POST",noRedirect:!0}))];case 6:if((g=a.sent())&&g.d){delete g.d.__metadata;if(e.existingSubscription){g.d.id=e.existingSubscription.id;g.d.notificationUrl=e.existingSubscription.notificationUrl;g.d.expirationDateTime=m.parameters.expirationDateTime}return[2,g.d]}throw new Error("Invalid subscription object")}})})};e.prototype.deleteSocketIoSubscription=function(e){var t=Object(te.r)({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId).method("Subscriptions",e.id);return this._dispatch(Object(ee.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:t.toString(),qosName:"SubscriptionServiceGenericList.deleteSocketIoSubscription",method:"DELETE",noRedirect:!0}))};return e})(),ie=n(301),se=n(94),oe=n(169),ue=n(259),ae=n(190),fe=(function(){function e(e){this._pushChannelService=e.pushChannelService;this._subscriptionService=e.subscriptionService;this._webAbsoluteUrl=e.webAbsoluteUrl;this._listFullUrl=e.listFullUrl;this._itemSetKey=e.itemSetKey;this._serverResponse=void 0;this._pendingRequest=!1}e.prototype.onUnsubscribe=function(e){if(0===e&&this._subscriptionService instanceof re){var t=this._pushChannelService.getSocketIoSubscription();t&&this._subscriptionService&&this._subscriptionService.deleteSocketIoSubscription(t)}};e.prototype.getSubscription=function(e){var t,n,r,i,s,o;if(this._webAbsoluteUrl&&this._listFullUrl){var u=F.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),a=e(Object(q.e)(function(e){return e.demandItemFacet(H.$e,u)}));if((null===(t=a)||void 0===t?void 0:t.notificationUrl)&&(null===(n=a)||void 0===n?void 0:n.expirationDateTime)&&(null===(r=a)||void 0===r?void 0:r.subscribeID))return{notificationUrl:null===(i=a)||void 0===i?void 0:i.notificationUrl,expirationDateTime:null===(s=a)||void 0===s?void 0:s.expirationDateTime,id:null===(o=a)||void 0===o?void 0:o.subscribeID}}};e.prototype.getChangeMessages=function(e,t,n){var r;return Object(a.__awaiter)(this,void 0,void 0,function(){var n,i,s,o,u,f,l,c,h,p,d,m,g,y,b,w,E,S,x,T,N,C,k,L,O,M,_,D,P,j,I,U,z,W=this;return Object(a.__generator)(this,function(X){switch(X.label){case 0:if("latest"===t){n=F.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl});i=e(Object(q.e)(function(e){return e.demandItemFacet(H.Re,n)}));if(s=null===(r=i)||void 0===r?void 0:r.lastItemModifiedTime){o=new v.e;return[2,{syncToken:"SPO_LIST,"+s,messages:[],itemResolver:o}]}}this._pendingRequest=!0;if(l=!!t&&"SPO_LIST,"===t.substr(0,9)){c=t.split(",");h=c[1];p='<Gt><FieldRef Name="Modified" />';p+='<Value Type="DateTime" IncludeTimeValue="True" StorageTZ="True">'+h+"</Value>";u=p+="</Gt>";f=["ID","FileRef","Modified","Title"];d=this._getListColumns(e);for(m=0,g=d;m<g.length;m++)"ID"!==(y=g[m]).internalName&&"FileRef"!==y.internalName&&"Modified"!==y.internalName&&"Title"!==y.internalName&&f.push(y.internalName)}else f=["ID","FileRef","Modified"];"ID";b=l;w=l?200:1;E=new J.e("<View></View>");u&&E.addFilters([u]);f&&E.replaceFields(f);E.updateSort({fieldName:"ID",isAscending:b});E.updateRowLimit({rowLimit:w,isPerPage:!1});S=e(Object(q.e)(function(e){return Object(se.e)(e,B.e.serialize({webAbsoluteUrl:W._webAbsoluteUrl,listFullUrl:W._listFullUrl}))}));return[4,e(Object(R.e)({isTAB:A.S}))];case 1:x=X.sent().isTAB;this._requestDatesInUtc=!S;return[4,e(Object(ie.e)({getItemContext:Object(a.__assign)(Object(a.__assign)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,qosName:"ItemAutoRefreshGenericList.GetChanges",viewXml:E.getEffectiveViewXml()},x?{}:{isBackground:!0}),{postDataContext:{requestDatesInUtc:this._requestDatesInUtc,needsSchema:!0},currentPageContext:S})}))];case 2:T=X.sent();this._serverResponse=T;N=T.ListData;C=N&&N.Row||[];k=[];L=l?this._getLastModifiedTimeInList(C,S):(new Date).toISOString();for(O=0,M=C;O<M.length;O++)if(void 0!==(_=M[O]).FileRef){D={};P=Object.keys(_);for(j=0,I=P;j<I.length;j++){U=I[j];z=0===U.indexOf("OData_")?U.substr(6):U;D[z]=_[U]}k.push(Object(a.__assign)(Object(a.__assign)({itemKey:B.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,itemId:_.ID}),parentItemKey:B.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1,name:_.Title||""},_.Modified?{dateModified:""+_.Modified}:{}),{fields:D}))}0===k.length&&k.push({itemKey:B.e.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1});this._pendingRequest=!1;return[2,{syncToken:"SPO_LIST,"+L,messages:k,itemResolver:new v.e}]}})})};e.prototype.hasPendingRequest=function(){return this._pendingRequest};e.prototype.updateItems=function(e,t){if(t&&o.e.matches(this._itemSetKey)&&this._serverResponse){var n=o.e.deserialize(this._itemSetKey),r={webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl,rootFolder:n.rootFolder||""},i=e(Object(ae.n)({itemSetKey:r})),s=e(Object(ae.e)(n,i,"getSPItem")),u=e(Object(ue.t)({serverData:this._serverResponse,itemSetKey:r,contentTypes:i,currentPageContext:s.currentPageContext,isItemSetRequest:!1})).itemResolver;e(u.execute())}this._serverResponse=void 0};e.prototype.processMessage=function(e,t,n){var i=e(Object(q.e)(function(e){return e.isItemFacetResolved(B.e,t.itemKey)?{rowData:e.demandItemFacet(H.Ct,t.itemKey),spItemKey:e.demandItemFacet(B.e,t.itemKey),title:e.demandItemFacet(H.mn,t.itemKey),selectedItemKeys:Object(oe.e)(e,{itemsScopeItemKey:n})}:{rowData:void 0,spItemKey:void 0,title:void 0,selectedItemKeys:void 0}})),s=i.rowData,o=i.spItemKey,u=i.title,a=i.selectedItemKeys,f=a&&a.length>0;if(void 0===t.parentItemKey){if(f)return;return{type:r.New,invalidateKey:t.itemKey,reason:"Deleted an unknown item"}}if(t.isDeleted){if(e(Object(I.e)({deleted:d.l},t.itemKey)).deleted||f)return;return{type:r.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}if(void 0===o||void 0===s){if(!t.parentItemKey)return;if(void 0===e(Object(I.e)({spParentItemKey:B.e},t.parentItemKey)).spParentItemKey)return;return f?void 0:{type:r.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(void 0!==u&&void 0!==t.name&&u!==t.name)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:H.mn,reason:'Item title changed from "'+u+'" to '+t.name+")"};if(t.fields){f||(this._serverResponse=void 0);for(var l=this._getListColumns(e),c=function(e){for(var n=e.internalName,i=0,o=Object.keys(t.fields).filter(function(e){return e!==n+".COUNT"&&0===e.indexOf(n)});i<o.length;i++){var u=o[i],a=s&&s[u],l=t.fields[u];try{"object"==typeof a&&(a=JSON.stringify(a));"object"==typeof l&&(l=JSON.stringify(l));if(h._requestDatesInUtc&&"DateTime"===e.fieldType){var c=Date.parse(a),p=Date.parse(l);if(!isNaN(c)&&!isNaN(p)){a=c;l=p}}}catch(e){continue}if(a!==l)return{value:{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:H.Ct,hasSelection:f,reason:'Item field "'+n+'" changed from "'+a+'" ('+typeof a+') to "'+l+'" ('+typeof l+")"}}}},h=this,p=0,v=l;p<v.length;p++){var m=c(v[p]);if("object"==typeof m)return m.value}}};e.prototype._getLastModifiedTimeInList=function(e,t){var n=(new Date).toISOString();if(e&&e.length>0)for(var r=void 0,i=0,s=e;i<s.length;i++){var o=s[i];if(this._requestDatesInUtc){var u=o.Modified;if(u){f=new Date(u);if(void 0===r||r<f){r=f;n=""+u}}}else{var a=o["Modified."];if(a){var f=new Date(a),l=t&&t.webTimeZoneData?t.webTimeZoneData.Bias-f.getTimezoneOffset():0;l&&f.setTime(f.getTime()+6e4*l);if(void 0===r||r<f){r=f;n=f.toISOString()}}}}return n};e.prototype._getListColumns=function(e){var t=[],n=e(Object(I.e)({schema:p.o},this._itemSetKey)).schema,r=n&&n.columnKeys;if(r)for(var i=0,s=r;i<s.length;i++){var o=s[i],u=e(Object(I.e)({internalName:H.Te,fieldType:H.ce,mappedFieldType:H.Je},o)),a=u.internalName,f=u.fieldType,l=u.mappedFieldType;void 0!==a&&void 0!==f&&void 0!==l&&l!==K.t.Title&&t.push({internalName:a,fieldType:f,mappedFieldType:l})}return t};return e})(),le=n(216),ce=n(266),he=n(34),pe=n(5),de=n(276),ve=n(542),me=n(147),ge=n(3012),ye=(function(){function e(e){this._connectionCallbacks={};this._notificationCallback=void 0;this._notificationId=void 0;this._siteId=e.siteId;this._listId=e.listId;this._isConnected=!1;this._client=e.dataSyncClient}e.prototype.isConnected=function(){return this._isConnected};e.prototype.getSocketIoSubscription=function(){};e.prototype.addConnectionHandler=function(e,t){this._connectionCallbacks[e]=t};e.prototype.removeConnectionHandler=function(e){this._connectionCallbacks[e]&&delete this._connectionCallbacks[e]};e.prototype.setupNotificationHandler=function(e,t){this._notificationCallback=t;return!0};e.prototype.disconnect=function(){this._notificationCallback=void 0;this._connectionCallbacks={};this._notificationId&&this._client&&this._client.removeListStatusCallback(this._notificationId);this._isConnected=!1};e.prototype.refreshSubscription=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2,!0]})})};e.prototype.connect=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,r,i,s;return Object(a.__generator)(this,function(o){switch(o.label){case 0:t=(e=this)._client,n=e._siteId,r=e._listId;i={siteId:n,listId:r};return[4,t.isListDataSyncEnabledAsync(i)];case 1:if(!o.sent())return[3,3];s=this;return[4,t.addListStatusCallbackAsync(this._onNotification.bind(this),i,{sendConnectionNotifications:!0})];case 2:s._notificationId=o.sent();return[2,!0];case 3:return[2,!1]}})})};e.prototype._onNotification=function(e){if(1===e.length){var t=e[0];t.dataRefreshNeeded?this._notificationCallback&&this._notificationCallback(void 0):t.state===ge.e.ListStatusConnected?this._notifyConnectionHandlers(!0):t.state===ge.e.ListStatusConnectionLost&&this._notifyConnectionHandlers(!1)}};e.prototype._notifyConnectionHandlers=function(e){this._isConnected=e;for(var t in this._connectionCallbacks)this._connectionCallbacks.hasOwnProperty(t)&&this._connectionCallbacks[t](e)};return e})(),be=n(1060),we={ODB:860},Ee={ODB:818},Se=new pe.e("itemAutoRefreshHelper",{itemsScopeItemKey:Object(pe.s)(),spPageContextKey:Object(pe.s)()}),xe=Object(ce.e)(function(e){return{}});function Te(e){var t=e.spPageContextKey,n=e.pageContext,r=e.listId,i=e.webAbsoluteUrl,s=e.listFullUrl,o=e.isTAB,u=e.itemKey,a=e.driveUrl,f=e.itemsScopeItemKey,c=e.getDataSyncClient;return function(h){var p=h(xe),d=Se.serialize({itemsScopeItemKey:f,spPageContextKey:t}),v=p[d];if(!v){var m,g=void 0,b=void 0,w=!n||!Object(y.n)(n).isActivated("f3c67c53-3465-4927-924d-963e1011836b","09/29/2020","Skip checking the subscription service");if(c&&e.pushChannelService&&(w||e.subscriptionService)){g=e.pushChannelService;b=e.subscriptionService}else{if(n){var E=h(k.e).dataRequestor;b=new O.e({listId:r,webAbsoluteUrl:i},{dataRequestor:E})}else b=new re({dispatch:h,webAbsoluteUrl:i,listFullUrl:s,listId:r});g=new M.e({disableWebSockets:!0},{subscriptionService:b})}m=new fe({pushChannelService:g,subscriptionService:b,webAbsoluteUrl:i,listFullUrl:s,itemSetKey:u});v=p[d]=new C({id:d,isTestMode:o,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},onNotificationReceived:function(){return window._tabPushNotification=!0},driveUrl:a,dispatch:h,template:m,itemsScopeItemKey:f,pushChannelService:g,logQoS:function(e){var t=h(Object(l.e)(e));return function(e){return h(t(e))}},onUnsubscribe:function(e){0===e&&delete p[d]}})}return v}}function Ne(e){var t=Object(le.t)();f.useLayoutEffect(function(){if(e.getDataSyncClient){var n=new Promise(function(n){(function(e){var t=this,n=e.pageContext,r=e.listId,i=e.getDataSyncClient;return i?i.then(function(i){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,s,o;return Object(a.__generator)(this,function(u){switch(u.label){case 0:t=void 0;s=void 0;return(o=i&&n&&r&&n.siteId)?[4,i.isListDataSyncEnabledAsync({listId:r,siteId:n.siteId})]:[3,2];case 1:o=u.sent();u.label=2;case 2:if(o){t=new ye({listId:r,siteId:n.siteId,dataSyncClient:i});s=void 0;return[2,Te(Object(a.__assign)(Object(a.__assign)({},e),{subscriptionService:s,pushChannelService:t}))]}return[2,Te(e)]}})})}):Promise.resolve(Te(e))})(e).then(function(e){var r=t(e);n(r.subscribe())})});return function(){n.then(function(e){return e()})}}return t(Te(e)).subscribe()},[]);return null}function Ce(e){var t=Object(le.t)();f.useLayoutEffect(function(){return t((function(e){var t=this,n=e.spPageContextKey,r=e.webAbsoluteUrl,i=e.listFullUrl,s=e.isTAB,o=e.driveUrl,u=e.endpoint,f=e.itemsScopeItemKey;return function(e){var c=e(xe),h=Se.serialize({itemsScopeItemKey:f,spPageContextKey:n}),p=c[h];if(!p){var d,v,m=e(k.e).dataRequestor;v=new $({dataRequestor:m,rootItemKey:B.e.serialize({webAbsoluteUrl:r,listFullUrl:i,rootFolder:""})});d=new M.e({disableWebSockets:!0},{subscriptionService:new O.e({},{dataRequestor:m}),sessionTokenFetcher:function(){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,n,r;return Object(a.__generator)(this,function(i){switch(i.label){case 0:return(n=u)?[4,e(Object(L.getSessionToken)(u,o))]:[3,2];case 1:n=i.sent();i.label=2;case 2:if(!(r=(t=n)&&t.accessToken))throw new V.e({code:"authFailure"});return[2,{accessToken:r,tokenUrl:o}]}})})}});p=c[h]=new C({id:h,isTestMode:s,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},onNotificationReceived:function(){return window._tabPushNotification=!0},driveUrl:o,dispatch:e,itemsScopeItemKey:f,template:v,pushChannelService:d,logQoS:function(t){var n=e(Object(l.e)(t));return function(t){return e(n(t))}},onUnsubscribe:function(e){0===e&&delete c[h]}})}return p}})(e)).subscribe()},[]);return null}var ke=Object(c.t)()(function(){return function(e){return function(e,t){var n,r=t.itemKey;if(!r)return{};var i=e.demandItem({key:o.e},r).key;if(!i||!i.webAbsoluteUrl||!i.listFullUrl)return{};var s=i.webAbsoluteUrl,u=i.listFullUrl,a=j.e.serialize({webAbsoluteUrl:s,listFullUrl:u}),l=e.demandItemFacet(H.un,a);if(!Object(P.e)(e,{feature:we,pageContext:l})||!Object(P.e)(e,{feature:Ee,pageContext:l}))return{};var c=Object(be.o)(function(t){return Object(P.e)(e,{feature:t})},be.e.SharePointList)?null===(n=e.demandItemFacet(H.qt,me.e))||void 0===n?void 0:n.dataSyncClient:void 0,p=F.e.serialize({webAbsoluteUrl:s,listFullUrl:u}),d=e.demandItem({listFacets:H.Re,listMediaTransformSchema:D.t},p),v=d.listFacets,m=d.listMediaTransformSchema;if(!v||void 0===v.id||void 0===v.templateType)return{};var g=v.isDocumentLibrary,y=_.s(v.templateType);if(!g&&!y)return{};var w,E=Object(h.e)(e,{isTAB:A.S}).isTAB,S=m&&m[".driveUrl"],x=S&&Object(b.e)(S),T=x&&x.endpoint,N=Object(he.e)(e).itemsScopeItemKey||"itemsSCopeItemKey";if(g&&!S)return{};var C=Object(de.e)(e,{itemsScopeItemKey:N});if(C&&C.id===ve.e.id)return{};if(g){if(!m)return{};if(!S)return{};if(E){var k=m[".driveAccessToken"];w=k&&k.replace("access_token=","")}if(!x)return{};var L=x.driveId;return T&&L?{isAvailable:!0,itemSubscriber:f.createElement(Ce,{spPageContextKey:a,driveUrl:S,isTAB:E,listFullUrl:u,endpoint:T,driveAccessToken:w,webAbsoluteUrl:s,pageContext:l,itemsScopeItemKey:N})}:{}}return{isAvailable:!0,itemSubscriber:f.createElement(Ne,{spPageContextKey:a,isTAB:E,itemKey:r,listFullUrl:u,webAbsoluteUrl:s,listId:v.id,pageContext:l,driveUrl:S,itemsScopeItemKey:N,getDataSyncClient:c})}}}});var Le=Object(i.t)(function(){return function(e){e(Object(s.e)(o.e,u.e)(ke))}})}],Array(28),[function(e,t,n){"use strict";n.r(t);n.d(t,"QuickEditActionExecutor",function(){return T.QuickEditActionExecutor});n.d(t,"sharePointAddonQuickEdit",function(){return N});var r=n(10),i=n(322),s=n(65),o=n(585),u=n("react-lib"),a=n(0),f=n(176),l=n(26),c=n(622),h=n(40),p=n(542),d=n(1214),v=Object(f.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(42,4322)];case 1:return[2,e.sent().ItemSetQuickEditList]}})})}),m=Object(c.t)(p.e)(v),g=Object(l.n)()(Object(h.e)(function(e,t){return{isAvailable:Object(d.e)(e,t),allowEmptyFolder:!1,allowPinnedItems:!1}})(m)),y=n(57),b=Object(f.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(42,4322)];case 1:return[2,e.sent().ItemSetQuickEditList]}})})}),w=function(e){var t=e&&e.itemKey;return t?u.createElement(b,Object(a.__assign)({},e,{itemKey:t})):null},E={layoutType:p.e,layoutHandler:function(e,t){var n=Object(y.e)(e);return{isAvailable:Object(d.e)(e,t),allowEmptyFolder:!1,itemKey:n,onRender:w}}},S=n(9),x=Object(S.t)()(function(){return function(e){return function(e,t){return{quickEditLayout:E,quickEditLegacyLayout:u.createElement(g,null)}}}});var T=n(3420),N=Object(r.t)(function(){return function(e){e(Object(i.e)(s.e,o.e)(x))}})}],Array(25),[function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointHomeAddonDeferred",function(){return E});var r=n(0),i=n(10),s=n(322),o=n(1034),u=n(9),a=n("react-lib"),f=n(2),l=n(26),c=n(57),h=n(342),p=n(1267),d=n(958),v=n(40),m=Object(l.s)()(Object(l.r)()(p.e)),g=Object(v.t)(function(e,t){var n=Object(c.e)(e)||"";return e.demandItemFacet(h.e,n)?a.createElement(m,{rootItemKey:n,pinOperationType:t.pinOperationType}):null}),y={key:new f.e("pinSiteCommand").id,automationId:"pinSiteCommand",name:d.e,ariaLabel:d.e,action:a.createElement(g,{pinOperationType:"pin"})},b={key:new f.e("unpinSiteCommand").id,automationId:"unpinSiteCommand",name:d.t,ariaLabel:d.t,action:a.createElement(g,{pinOperationType:"unpin"})},w=Object(u.t)()(function(){return function(e){return function(e,t){var n=t.commands;return{commands:Object(r.__spreadArrays)([y,b],n||[])}}}});var E=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Object(s.e)(h.e,o.e)(w));return[2]})})}})}],Array(31),[function(e,t,n){"use strict";n.r(t);n.d(t,"spItemPdfGetItemsOperationHandler",function(){return d});var r=n(0),i=n(1550),s=n(198),o=n(398),u=n(10),a=n(45),f=n(120),l=n(724);function c(e){var t=e.listMediaTransformSchema,n=e.itemMediaTransformSchema;if(t&&n){var i=t[".transformUrl"],s=n[".hasPdf"],o=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},t),n),{".method":"pdf"});if("True"===s&&i)return function(){return""+Object(l.n)(i,o)}}}var h=n(165),p=n(1180),d=Object(u.i)({maxParallelOperationCount:16})(function(e){var t=this,n=p.e.deserialize(e.itemKey).itemKey;return function(u){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,l,p,d;return Object(r.__generator)(this,function(v){switch(v.label){case 0:return[4,u(Object(i.e)(function(e){var t=e.demandItemFacet(a.e,n),r=t&&f.e.serialize(t);return{generator:c({listMediaTransformSchema:e.demandItemFacet(o.t,r),itemMediaTransformSchema:e.demandItemFacet(o.e,n)})}}))];case 1:t=v.sent().generator;(l=new s.e).resolveItems(((p={items:(d={},d[e.itemKey]=Object(r.__assign)({},o.n.pack(t)),d)})[n]=Object(r.__assign)({},Object(h.e)().forFacet(o.e).thenInvalidate(e.itemKey,o.n).pack()),p));u(l.execute());return[2]}})})}})},function(e,t,n){"use strict";n.r(t);n.d(t,"spItemGetPrintFileUrlOperationHandler",function(){return w});var r=n(0),i=n(10),s=n(45),o=n(573),u=n(1),a=n(137),f=n(386),l=n(3247),c=n(83),h=n(738),p=n(198),d=n(6),v=n(112),m=n(398),g=n(1180),y=new v.e("pdfUrlGenerator",function(e,t){var n=t.itemKey;return n&&e.demandItemFacet(m.n,g.e.serialize({itemKey:n}))||void 0}),b=n(1550),w=Object(i.i)()(function e(t){var n=this;return function(i){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,f,l,c,v,m,g,w,S,x,T,N,C,k,L;return Object(r.__generator)(this,function(A){switch(A.label){case 0:n=t.itemKey;f=i(Object(a.e)(function(e){return e.demandItem({spItemKey:s.e,folderPath:u.pe,fileName:d.d},n)})),l=f.spItemKey,c=f.folderPath,v=f.fileName;return[4,i(Object(b.e)(function(e){return e.demandItem({pdfUrlGenerator:y},n)}))];case 1:m=A.sent().pdfUrlGenerator;g=l&&o.e.serialize(l);if(!((w=i(Object(a.e)(function(e){return{pageContext:e.demandItemFacet(u.un,g)}})).pageContext)&&l&&v&&c))return[2];S=l.webAbsoluteUrl,x=l.listFullUrl;T=w.layoutsUrl;N=v.extension;return[4,i(E({webAbsoluteUrl:S,listFullUrl:x,folderPath:c,layoutsUrl:T,extension:N,pdfGenerator:m}))];case 2:C=A.sent();(k=new p.e({publisher:e})).resolveItems({items:(L={},L[n]=Object(r.__assign)({},h.n.pack(C)),L)});i(k.execute());return[2]}})})}});function E(e){var t=this,n=e.webAbsoluteUrl,i=e.listFullUrl,s=e.folderPath,o=e.extension,u=e.pdfGenerator;return".oxps"===o||".pdf"===o?function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,h,p;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e(Object(c.n)({webAbsoluteUrl:n,listFullUrl:i})),o=t.dataRequestor,u=t.hasDigest;if(!t.hasTokenProvider)return[3,1];h=void 0;return[3,3];case 1:return[4,e(Object(c.e)({url:n||i,disallowCookies:!u}))];case 2:h=r.sent();r.label=3;case 3:a=h;p=Object(f.r)({webAbsoluteUrl:n,listOrItemFullUrl:i});return[4,Object(l.e)({dataRequestor:o,authToken:a,serverRelativeItemUrl:s,webApiUrl:p})];case 4:return[2,{fileUrl:r.sent()}]}})})}:function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,{fileUrl:u&&u()}]})})}}},,,,,,,,function(e,t,n){"use strict";n.r(t);n.d(t,"ItemLibrariesDropdown",function(){return A});n.d(t,"LibrariesDropdown",function(){return O});var r=n("react-lib"),i=n(97),s=n(3882),o=n(201),u=n(65),a=n(120),f=n(513),l=n(37),c=n(8),h=n(6),p=n(45),d=n(1),v=n(993),m=n(127),g=n(29),y=n(359),b=n(27),w=n(505),E=n(26),S=n(3208),x=n(3377),T=n(104),N=n(133),C=n(186),k={component:"LibrariesDropdown;"},L=Object(T.t)({withContext:k}),A=Object(C.n)(L)(function(e){var t=r.useRef(null),n=r.useState(!1),E=n[0],C=n[1],k=Object(m.e)(function(){return C(!1)}),L=Object(l.e)("librariesDropdown_6ac370b8",e.className,E?"librariesDropdownOpen_6ac370b8":"librariesDropdownNotOpen_6ac370b8");return r.createElement(o.e,null,function(n){var o,m=n.itemCache,A=(n.dispatch,null===(o=Object(T.n)(m))||void 0===o?void 0:o.telemetry),O=e.itemKey,M=m.demandItemFacet(p.e,O),_=m.demandItemFacet(u.e,O),D=Object(w.e)(m);if(M||_){var P=Object(b.e)(m,{enableLibrariesDropdown:d.F}).enableLibrariesDropdown,H=void 0,B=void 0,j=void 0;if(M){H=M.webAbsoluteUrl;B=M.rootFolder;j=a.e.serialize(M)}else{if(!_)return null;H=_.webAbsoluteUrl;B=_.rootFolder;j=a.e.serialize(_)}var F=m.demandItemFacet(d.Re,j),I=!(D||!P||!F||F.templateType!==g.n.documentLibrary||""!==B),q=m.demandItemFacet(x.e,O);if(!x.e.evaluate(q)(m,{itemKey:O,isAvailable:I}).isAvailable)return null;var R=[],U=null;if(E){var z=m.demandItemFacet(c.e,f.e.serialize({webAbsoluteUrl:H}));if(z&&z.itemKeys&&z.itemKeys.length){U=function(){A&&A(N.e).logData({name:"LibrariesDropdown.Load",component:"LibrariesDropdown;",objectType:"Libraries",extraData:{numberOfLibraries:z.itemKeys.length},isIntentional:!0})};R=z.itemKeys.map(function(e){return{key:e,name:m.demandItemFacet(h.h,e)||"",action:r.createElement(y.e,{itemKey:e})}})}}return r.createElement(r.Fragment,null,r.createElement("button",{className:L,onClick:E?k:function(){A&&A(N.e).logData({name:"LibrariesDropdown.OpenDropdown",component:"LibrariesDropdown;",isIntentional:!0});C(!0)},ref:t,"aria-label":s.e,title:s.e},r.createElement(v.e,{iconName:"Library",className:Object(l.e)("librariesDropdownIcon_6ac370b8")}),r.createElement(v.e,{iconName:"ChevronDown",className:Object(l.e)("librariesDropdownChevron_6ac370b8")})),E?r.createElement(S.e,{commands:R,target:t.current,directionalHint:i.e.bottomLeftEdge,alignTargetEdge:!0,onDismiss:k,isOpen:!0,onMenuOpened:U||void 0}):null)}return null})}),O=Object(E.e)()(A)}])]);