(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred.odsp-datasources","49"],{1705:function(e,t,n){"use strict";n(1780);var r,i=n(52),s=n(109),o=n(48);(function(e){e[e.InteractionRequired=10013]="InteractionRequired"})(r||(r={}));var u=(function(){function e(e,t){void 0===e&&(e={});this._dataSource=t.oAuthTokenDataSource}e.prototype.getToken=function(e,t){var n=new s.e({name:"getToken"});return this._dataSource.getToken(e,t).then(function(e){n.end({resultType:o.e.Success});return e},function(e){n.end({resultType:o.e.Failure});return i.n.reject(e)})};e.prototype.getInstrumentedToken=function(e,t){var n=new s.e({name:"getToken"});return this._dataSource.getInstrumentedToken(e,t).then(function(e){n.end({resultType:o.e.Success});return e},function(e){n.end({resultType:o.e.Failure});return i.n.reject(e)})};return e})();t.e=u},1709:function(e,t,n){"use strict";var r;(function(e){e[e.none=0]="none";e[e.user=1]="user";e[e.distributionList=2]="distributionList";e[e.securityGroup=4]="securityGroup";e[e.sharePointGroup=8]="sharePointGroup";e[e.all=15]="all"})(r||(r={}));t.e=r},1741:function(e,t,n){"use strict";n.d(t,"e",function(){return l});n.d(t,"t",function(){return h});var r=n(52),i=n(109),s=n(48),o=n(1430),u=n(103),a=n(63),f=n(471),l="https://outlook.office.com/search",c={ODB:1286},h=(function(){function e(e,t){this._dataRequestor=new o.e({},{});this._pageContext=t.pageContext;this._oAuthTokenProvider=t.oAuthTokenProvider;this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._substrateToken=this._sharingContextInformation.additionalTokens.substrateToken);this.initializeDataStore()}e.prototype.canUseSubstrate=function(){if(this._substrateToken)return!0;var e=!1;if(this._pageContext&&!this._pageContext.isSPO)return e;if(this._pageContext&&this._pageContext.authToken)return e;this._pageContext&&this._oAuthTokenProvider&&f.n.isFeatureEnabled(c)&&(e=!0);this._dataStore&&(e=e&&!this._dataStore.getValue("DisableSubstrateSearch",a.e.session));return e};e.prototype.disableSubstrateCallsForPicker=function(){this.initializeDataStore();this._dataStore.setValue("DisableSubstrateSearch",!0,a.e.session)};e.prototype.getSubstrateToken=function(){var e=this;if(this._substrateToken)return r.n.resolve(this._substrateToken);if(this._oAuthTokenProvider){var t=new i.e({name:"PeoplePicker.GetSubstrateToken"});return this._oAuthTokenProvider.getToken(l).then(function(e){t.end({resultType:s.e.Success});return e},function(n){if(r.n.isCanceled(n)){t.end({resultType:s.e.ExpectedFailure,resultCode:"Canceled"});return r.n.reject(n)}t.end({resultCode:"PeoplePicker.GetSubstrateTokenError",resultType:s.e.Failure,extraData:{serverErrorCode:n._serverErrorCode,message:n.message}});e.disableSubstrateCallsForPicker();return null})}return null};e.prototype.init=function(e){var t=l+"/api/v1/init?scenario=documentshare";this._dataRequestor.send({apiName:"Substrate.PeopleSearch.Init",path:t,headers:{Authorization:"Bearer "+e},needsAuthorization:!1})};e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new u.e("PeoplePicker",a.e.session))};return e})()},1748:function(e,t,n){"use strict";var r,i=n(0),s=(function(){function e(){}e.tokenCacheSessionStorageId="tokenCache";e.aboutToExpireIntervalSeconds=600;e.apiUrl="/_api/SP.OAuth.Token/Acquire";e.retries=3;e.retriableErrorCodes=[10006,10008];e.unexpectedErrorCodeFormat="Expected error code format is <numericCode>, <exception class name>";e.unexpectedTokenMessageFormat="Your token request succeedeed but the token could not be parsed from the response.This is most probably caused by a change in the server response format";e.npmPackageVersion="0.1.5";return e})();(function(e){e[e.unknownError=0]="unknownError";e[e.malformedResponseBody=1]="malformedResponseBody";e[e.serverError=2]="serverError"})(r||(r={}));var o=(function(e){Object(i.__extends)(t,e);function t(n,r){var i=e.call(this,r.message)||this;i.__proto__=t.prototype;i._type=n;i._httpResponseStatus=r.httpResponseStatus;i._cultureName=r.cultureName;i._message=r.message;i._serverErrorCode=r.serverErrorCode;i._correlationId=r.correlationId;i._redirectUrl=r.redirectUrl;return i}Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"serverErrorCode",{get:function(){if(this.type!==r.serverError)throw new Error("ServerErrorCode can only be obtained for errors of type serverError");return this._serverErrorCode},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"httpResponseStatus",{get:function(){return this._httpResponseStatus},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"message",{get:function(){return this._message},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"cultureName",{get:function(){return this._cultureName},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"correlationId",{get:function(){return this._correlationId},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"redirectUrl",{get:function(){return this._redirectUrl},enumerable:!0,configurable:!0});return t})(Error),u=(function(){function e(e){var t=this;this._context=e;this._dispose=this._dispose.bind(this);window.addEventListener("unload",this._dispose);window._spPageOnMediaTokenReceived=function(){t._receiveMediaServiceFlushedToken()};window._spMSBTLoaded=function(){t._receiveMediaServiceFlushedToken()}}e._getCorrelationId=function(e){return e.headers.get("sprequestguid")};e._extractRealError=function(e){return e.hasOwnProperty("error")?e.error:e};e.prototype.getOAuthToken=function(e,t){return this.getInstrumentedOAuthToken(e,t).then(function(e){if(e)return e.tokenInfo})};e.prototype.getInstrumentedOAuthToken=function(e,t){var n=this;this._receiveMediaServiceFlushedToken();var r=this._getCachedTokenData(e);if(r&&!this._isExpiring(r)){var i={token:r.accessToken,isGuest:!1,expirationTimeMs:r.expiresOn};return Promise.resolve({tokenInfo:i,spRequestId:r.correlationId,spRequestTimestamp:r.requestTimestamp})}return this._retriableFetchWithDigest(e,s.retries,t).then(function(t){n._storeTokenData(e,t);return{tokenInfo:{token:t.accessToken,isGuest:!1,expirationTimeMs:t.expiresOn},spRequestId:t.correlationId,spRequestTimestamp:t.requestTimestamp}})};e.prototype.clearCachedToken=function(e){var t=this._getCacheKey(e);window.sessionStorage.removeItem(t);var n=this._resourceKeys.indexOf(t);!isNaN(n)&&n>-1&&this._resourceKeys.splice(n)};Object.defineProperty(e.prototype,"_resourceKeys",{get:function(){this._keysToDispose||(this._keysToDispose=new Array);return this._keysToDispose},enumerable:!0,configurable:!0});e.prototype._retriableFetchWithDigest=function(t,n,i){var s=this,u=this._context.qosMonitor(),a=Date.now();return this._context.fetchWithDigest(this._buildTokenRequest(t,i)).then(function(f){if(200!==f.status){s._context.logger.logError("fetchWithDigest failed. Server responded with "+f.statusText);var l=new o(r.unknownError,{httpResponseStatus:f.status,message:f.statusText,correlationId:e._getCorrelationId(f)});if(400!==f.status){u.writeUnexpectedFailure("UnknownError",l);return Promise.reject(l)}return f.json().then(function(r){var o=e._extractRealError(r),a=s._getErrorCodeFromResponseCode(o);if(!s._isRetriableError(a)||0===n){var f=s._buildErrorFromResponse(o);u.writeUnexpectedFailure("SharepointServerError",f);return Promise.reject(f)}s._context.logger.logError("fetchWithDigest failed. Retrying. Retries left: "+n);return s._retriableFetchWithDigest(t,n-1,i)})}return s._instrumentedParseResponseData(f,u,a)})};e.prototype._getCachedTokenData=function(e){return JSON.parse(window.sessionStorage.getItem(this._getCacheKey(e)))};e.prototype._storeTokenData=function(e,t){window.sessionStorage.setItem(this._getCacheKey(e),JSON.stringify(t))};e.prototype._getCacheKey=function(e){var t=["sp-client-shared",s.npmPackageVersion,"OAuthUtility",e].join(";");-1===this._resourceKeys.indexOf(t)&&this._resourceKeys.push(t);return t};e.prototype._isExpiring=function(e){return e.expiresOn-Date.now()/1e3<s.aboutToExpireIntervalSeconds};e.prototype._isRetriableError=function(e){return-1!==s.retriableErrorCodes.indexOf(e)};e.prototype._buildTokenRequest=function(e,t){var n=new Headers;n.append("Content-Type","application/json; charset=utf-8");n.append("Odata-Version","4.0");n.append("Accept","application/json;odata.metadata=minimal");var r={method:"POST",headers:n,body:JSON.stringify(this._buildRequestBody(e))},i=t;i&&i.lastIndexOf("/")===i.length-1&&(i=i.substr(0,i.length-1));return new Request(i+s.apiUrl,r)};e.prototype._buildRequestBody=function(e){return{resource:e}};e.prototype._buildErrorFromResponse=function(e){var t,n,i=this._getErrorCodeFromResponseCode(e);if(void 0===i)return new o(r.malformedResponseBody,{httpResponseStatus:400,message:s.unexpectedErrorCodeFormat,correlationId:e.correlationId});if(e.message)if("string"==typeof e.message)t=e.message;else{t=e.message.value;n=e.message.lang}return new o(r.serverError,{httpResponseStatus:400,message:t,cultureName:n,serverErrorCode:i,correlationId:e.correlationId,redirectUrl:e["error.redirectUrl"]||e["@error.redirectUrl"]})};e.prototype._getErrorCodeFromResponseCode=function(e){var t=e.code,n=Number(t);if(isNaN(n)&&"string"==typeof e.message){var r=t.indexOf(",");-1!==r&&(n=Number(t.substr(0,r)))}return n};e.prototype._instrumentedParseResponseData=function(t,n,i){try{return t.json().then(function(r){n.writeSuccess();return{accessToken:r.access_token,expiresOn:Number(r.expires_on),notBefore:Number(r.not_before),resource:r.resource,tokenType:r.token_type,correlationId:e._getCorrelationId(t),requestTimestamp:i}})}catch(i){n.writeUnexpectedFailure("ResponseParseError",i);return Promise.reject(new o(r.malformedResponseBody,{httpResponseStatus:200,message:s.unexpectedTokenMessageFormat,correlationId:e._getCorrelationId(t)}))}};e.prototype._dispose=function(e){window.removeEventListener("unload",this._dispose);for(var t=0,n=this._resourceKeys;t<n.length;t++){var r=n[t];window.sessionStorage.removeItem(r)}};e.prototype._receiveMediaServiceFlushedToken=function(){if(window._spMSBT){var e={tokenType:window._spMSBT.TokenType,expiresOn:window._spMSBT.ExpiresOn,notBefore:void 0,resource:window._spMSBT.Resource,accessToken:window._spMSBT.AccessToken};this._storeTokenData(e.resource,e);window._spMSBT=void 0}};return e})(),a=n(997),f=n(52),l=n(289),c=n(109),h=n(48),p=(function(){function e(){this._qos=new c.e({name:"OAuthTokenDataSource"})}e.prototype.writeSuccess=function(){this._qos.end({resultType:h.e.Success})};e.prototype.writeUnexpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:h.e.Failure,error:JSON.stringify(t)})};e.prototype.writeExpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:h.e.ExpectedFailure,error:JSON.stringify(t)})};return e})(),d=(function(){function e(){}e.prototype.logWarning=function(e){};e.prototype.logError=function(e){};return e})(),v=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,{},{pageContext:t})||this;r.logger=new d;if(n){n.logger&&(r.logger=n.logger);n.useAbsoluteUrlForOAuth&&(r._useAbsoluteUrlForOAuth=n.useAbsoluteUrlForOAuth)}r._oAuthUtility=new u(r);return r}t.prototype.qosMonitor=function(){return new p};Object.defineProperty(t.prototype,"webUrl",{get:function(){return this._useAbsoluteUrlForOAuth?this._pageContext.webAbsoluteUrl:Object(l.n)(this._pageContext)},enumerable:!0,configurable:!0});t.prototype.fetchWithDigest=function(e){var t=this;return e.text().then(function(n){var r=e.headers.get("Content-Type");e.headers.delete("Content-Type");return t._odspPromiseToEs6Promise(t.getData(function(){return e.url},function(e,t){return new Response(e,{status:t.getStatus(),headers:t.getResponseHeadersDictionary()})},"DelegationTokenDataSource",function(){return n},"POST",t._getRequestHeadersDictionary(e),r,void 0,!0).then(function(e){return e},function(e){return new Response(JSON.stringify(e),{status:e.status})}))})};t.prototype.getToken=function(e,t){t&&this._oAuthUtility.clearCachedToken(e);return this._es6PromiseToOdspPromise(this._oAuthUtility.getOAuthToken(e,this.webUrl).then(function(e){return e.token}))};t.prototype.getInstrumentedToken=function(e,t){t&&this._oAuthUtility.clearCachedToken(e);return this._es6PromiseToOdspPromise(this._oAuthUtility.getInstrumentedOAuthToken(e,this.webUrl))};t.prototype._getRequestHeadersDictionary=function(e){var t=e.headers,n={};t.forEach(function(e,t){n[t]=e});return n};t.prototype._odspPromiseToEs6Promise=function(e){return new Promise(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})};t.prototype._es6PromiseToOdspPromise=function(e){return new f.n(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})};return t})(a.t);t.e=v},1760:function(e,t,n){"use strict";n.d(t,"e",function(){return l});n.d(t,"t",function(){return c});var r=n(52),i=n(471),s=n(109),o=n(48),u=n(103),a=n(63),f={ODB:387},l="https://graph.microsoft.com",c=(function(){function e(e,t){this._pageContext=t.pageContext;this._sharingContextInformation=t.sharingContextInformation;this._oAuthTokenProvider=t.oAuthTokenProvider;this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._graphToken=this._sharingContextInformation.additionalTokens.graphToken);this.initializeDataStore()}e.prototype.canUseGraph=function(){if(this._graphToken)return!0;if(this._pageContext&&!this._pageContext.isSPO)return!1;if(this._pageContext&&this._pageContext.authToken)return!1;var e=this._pageContext&&this._oAuthTokenProvider&&i.n.isFeatureEnabled(f);this._dataStore&&(e=e&&!this._dataStore.getValue("DisableGraph",a.e.session));return e};e.prototype.disableGraphCallsForPicker=function(){this.initializeDataStore();this._dataStore.setValue("DisableGraph",!0,a.e.session)};e.prototype.getGraphToken=function(){var e=this;if(this._graphToken)return r.n.resolve(this._graphToken);if(this._oAuthTokenProvider){var t=new s.e({name:"PeoplePicker.GetGraphToken"});return this._oAuthTokenProvider.getToken(l).then(function(e){t.end({resultType:o.e.Success});return e},function(n){if(r.n.isCanceled(n)){t.end({resultType:o.e.ExpectedFailure,resultCode:"Canceled"});return r.n.reject(n)}t.end({resultCode:"PeoplePicker.GetGraphTokenError",resultType:o.e.Failure,extraData:{serverErrorCode:n._serverErrorCode,message:n.message}});e.disableGraphCallsForPicker();return null})}return null};e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new u.e("PeoplePicker",a.e.session))};return e})()},1777:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r,i;(function(e){e[e.queued=0]="queued";e[e.started=1]="started";e[e.completed=2]="completed";e[e.aborted=3]="aborted";e[e.failed=4]="failed";e[e.none=5]="none"})(r||(r={}));(function(e){e[e.none=0]="none";e[e.other=1]="other";e[e.general=2]="general";e[e.conflict=3]="conflict";e[e.similarNameExists=4]="similarNameExists";e[e.invalidName=5]="invalidName";e[e.fileSize=6]="fileSize";e[e.emptyFileOrFolder=7]="emptyFileOrFolder";e[e.emptyFileOrFolderForDocLib=8]="emptyFileOrFolderForDocLib";e[e.overQuota=9]="overQuota";e[e.accessDenied=10]="accessDenied";e[e.lockMismatch=11]="lockMismatch";e[e.overQuotaSharedFolder=12]="overQuotaSharedFolder";e[e.folderUploadNotSupported=13]="folderUploadNotSupported";e[e.versionMismatch=14]="versionMismatch";e[e.authFailure=15]="authFailure";e[e.targetFolderMissing=16]="targetFolderMissing";e[e.itemNotFound=17]="itemNotFound";e[e.malwareDetected=18]="malwareDetected";e[e.throttled=19]="throttled";e[e.pathTooLong=20]="pathTooLong";e[e.disconnected=21]="disconnected";e[e.unlockRequired=22]="unlockRequired";e[e.insufficientVaultQuota=23]="insufficientVaultQuota"})(i||(i={}))},1814:function(e,t,n){"use strict";n.d(t,"e",function(){return b});var r=n(0),i=n(289),s=n(471),o=n(997),u=n(1709),a=n(52),f=n(1741),l=n(532),c=n(144),h=n(1854),p=n(1430),d=n(611),v=n(70),m=n(1825),g=n(66),y={ODB:60307},b=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=this,i=w(t)?t:n.pageContext;r=e.call(this,{},{pageContext:i})||this;var s=w(t)?t.apiUrlHelper:n.apiUrlHelper;r._apiUrlHelper=s||new l.e({},{itemUrlHelper:new c.e({},{pageContext:i}),pageContext:i});r._capabilities={supportsMruCaching:!0};if(n){r._dataRequestor=n.dataRequestor;r._graphPeoplePickerHelper=n.graphPeoplePickerHelper;r._substratePeoplePickerHelper=n.substratePeoplePickerHelper;r._livePeoplePickerHelper=n.livePeoplePickerHelper;r._getAuthToken=n.getAuthToken}r._webAbsoluteUrl=i.webAbsoluteUrl;return r}t.prototype.getCapabilities=function(){return this._capabilities};t.prototype.getPersonaDetails=function(e){var t=this;return a.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("sp.publishing.personmagazine.GetPersonMagazineUserProfileDataForUser").parameter("accountName",e).toString(),qosName:"GetPersonaDetails",authToken:n,parseResponse:function(e){var n=function(e){return{name:e.DisplayName,email:e.Email,userId:e.AccountName,office:e.Office,image:e.PictureUrl,job:e.Title,department:e.DepartmentName,phone:e.Phone,sip:e.Lync}},r=JSON.parse(e).d.GetPersonMagazineUserProfileDataForUser,s={personDetails:n(r.Primary),managerChain:r.ManagerChain.results.map(n),directReports:r.DirectReports.results.map(n)};s.personDetails.profilePage=Object(i.r)(t._pageContext)+"/_layouts/15/me.aspx?p="+encodeURIComponent(s.personDetails.sip)+"&origin=ProfileODBCard";return s}})})};t.prototype.getPickerEntityInformation=function(e){var t=this,n=0;e.principalType===u.e.sharePointGroup&&(n=Number(e.rawPersonData.EntityData.SPGroupID));var r=JSON.stringify({entityInformationRequest:{PrincipalType:e.principalType,EmailAddress:e.email,GroupId:n}});return a.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.GetPickerEntityInformation").toString(),additionalPostData:r,qosName:"getPickerEntityInformation",authToken:n,noRedirect:!0,parseResponse:function(t){return{totalMemberCount:JSON.parse(t).d.TotalMemberCount,person:e}}})})};t.prototype.resolve=function(e,t){var n=this;return a.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(r){return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerResolveUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Resolve",authToken:r,parseResponse:function(e){var r=JSON.parse(e),i=JSON.parse(r.d.ClientPeoplePickerResolveUser),s=[];s[0]=i;i.IsResolved||i.EntityData.IsBlockedOnODB&&"true"===i.EntityData.IsBlockedOnODB.toLowerCase()||(s[0].DisplayText=i.Key);var o=(s=n._transformData(s,t.filterExternalUsers))[0];if(t.filterExternalUsers&&o&&1===o.entityType){o.isResolved=!1;o.entityType=0}else if(t.blockViaPolicy&&!t.filterExternalUsers&&o&&!o.isResolved&&0===o.multipleMatches.length){o.isResolved=!0;o.isExternal=!0;o.entityType=1}if(t.isGraphDistributionList&&t.useGraph&&o.isExternal){o.entityType=2;o.principalType=u.e.distributionList}return o}})})};t.prototype.canUseGraph=function(e){var t=e&&e.useGraph&&this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();t&&!this._dataRequestor&&(this._dataRequestor=new p.t({},{}));return t};t.prototype.canUseSubstrate=function(e){var t=e.useSubstrate&&this._substratePeoplePickerHelper&&this._substratePeoplePickerHelper.canUseSubstrate();t&&!this._dataRequestor&&(this._dataRequestor=new p.t({},{}));return t};t.prototype.getLivePersonaPickerHelper=function(){return this._livePeoplePickerHelper};t.prototype.search=function(e,t){return this.canUseSubstrate(t)?this._substrateSearch(e,t):this.canUseGraph(t)?this._graphSearch(e,t):this.sharePointSearch(e,t)};t.prototype.sharePointSearch=function(e,t){var n=this;t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!1);return a.n.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(r){return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerSearchUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Search",authToken:r,parseResponse:function(r){var i=t.allowSharePointGroups,s=void 0===i||i,o=t.filterExternalUsers,a=JSON.parse(r),f=JSON.parse(a.d.ClientPeoplePickerSearchUser),l=n._transformData(f,o);o&&(l=l.filter(function(e){return 1!==e.entityType}));l=l.filter(function(e){return e.principalType===u.e.sharePointGroup?s:e.principalType===u.e.securityGroup?s||n._isValidEmail(e.email,!0):n._isValidEmail(e.email,!1)});if(!1!==t.resolveEmailIfNoResults&&0===l.length&&n._isValidEmail(e,!1)){var c={Key:e,IsResolved:!1};l.push({email:e,entityType:1,isResolved:!1,job:!1===t.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:c,rawPersonData:c,isExternal:!0})}return l}})})};t.prototype.subscribePresence=function(e,t){var n=this;try{this._ensureSkypePresence();if(!O365Shell_Shim.SkypeIntegration.isAvailable())return null;var r=function(e){try{switch(e){case 0:t(0);break;case 1:t(1);break;case 2:t(2);break;case 3:t(3);break;case 4:t(4);break;case 5:t(5);break;case 6:t(6);break;case 8:t(7);break;default:t(0)}}catch(e){}};this._skypeIntegration.TrackPresence(e,r);return{dispose:function(){try{n._skypeIntegration.UntrackPresence(e,r)}catch(e){}}}}catch(e){}return null};t.prototype.sendSourceName=function(){return"PeoplePickerDataSource"};t.prototype._constructPostBody=function(e,t){var n={queryParams:{QueryString:e,MaximumEntitySuggestions:t.maximumEntitySuggestions,AllowEmailAddresses:t.allowEmailAddresses,AllowOnlyEmailAddresses:t.allowOnlyEmailAddresses,PrincipalType:t.principalType,PrincipalSource:t.principalSource,UseSubstrateSearch:t.useSubstrateSearch,SharePointGroupID:t.groupID,QuerySettings:t.querySettings}};return JSON.stringify(n)};t.prototype._ensureSkypePresence=function(){var e=this;try{if(!Boolean(this._skypeIntegration)){var t=new O365Shell_Shim.SkypeIntegration;t.OnApiReady(function(){e._skypeIntegration=t})}}catch(e){}};t.prototype._graphSearch=function(e,n){var r=this;return this._graphPeoplePickerHelper.getGraphToken().then(function(i){if(!i)return r.sharePointSearch(e,n);var s=new g.t("https://graph.microsoft.com/v1.0/me/people");if(e){s.setQueryFromObject({$search:'"'+e+'"',$top:"30",$select:"displayName,scoredEmailAddresses,personType,department,jobTitle,userPrincipalName"});if(v.t.isActivated("08c31a2f-5109-4dd9-b6ab-d6ea8fec0d9f","09/29/2020","Fix bug: Should correctly handle PrincipalType in Graph query filter."))!1!==n.filterPublicDistributionList&&s.setQueryParameter("$filter","personType/subclass ne 'PublicDistributionList'");else{var o=t._getPersonTypeFilter(n);o&&s.setQueryParameter("$filter",o)}}return r._dataRequestor.send({apiName:"Graph.PeopleSearch",path:s.toString(),headers:{Authorization:"Bearer "+i,"X-PeopleQuery-QuerySources":"Mailbox,Directory"},needsAuthorization:!1}).then(function(t){n.onToggleGetMoreResults&&n.onToggleGetMoreResults(!0);if(!t||!t.value||0===t.value.length)return r.sharePointSearch(e,n);var i=t.value,s=[];i.forEach(function(e){if(!e.personType.subclass||!r._isIgnorablePeopleSubType(e.personType.subclass)){var t=e.scoredEmailAddresses[0]?e.scoredEmailAddresses[0].address:"",i=e.userPrincipalName&&r._isValidEmail(e.userPrincipalName,!1)?e.userPrincipalName:t,o={Key:i,IsResolved:!1},a="ImplicitContact"===e.personType.subclass,f="OrganizationUser"===e.personType.subclass,l="Group"===e.personType.class&&"UnifiedGroup"===e.personType.subclass,c="PublicDistributionList"===e.personType.subclass,p=Object(h.n)(r._webAbsoluteUrl,t),d={department:e.department,email:t,image:a?void 0:p,job:!1===n.fallbackToEmailIfNoJob?e.jobTitle:e.jobTitle||t,name:e.displayName,providerName:f?"Provider":void 0,userId:i,rawData:o,rawPersonData:o,isExternal:!f,aadObjectId:e.id};if(f){d.entityType=0;d.principalType=u.e.user;d.isResolved=!0}else if(l){d.entityType=2;d.principalType=u.e.securityGroup;d.isResolved=!1;d.userId=e.id}else{d.principalType=c?u.e.distributionList:u.e.none;d.entityType="Group"===e.personType.class?2:1;d.isResolved=!1;d.providerName=void 0}d.userId&&s.push(d)}});if(!1!==n.resolveEmailIfNoResults&&0===s.length&&r._isValidEmail(e,!1)){var o={Key:e,IsResolved:!1};s.push({email:e,entityType:1,isResolved:!1,job:!1===n.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:o,rawPersonData:o,isExternal:!0})}return s},function(t){if(Object(d.s)(t))switch(t.status){case 400:case 401:case 403:case 404:r._graphPeoplePickerHelper.disableGraphCallsForPicker();return r.sharePointSearch(e,n);default:return r.sharePointSearch(e,n)}else"Canceled"!==t.name&&r._graphPeoplePickerHelper.disableGraphCallsForPicker();return"Canceled"===t.name?null:r.sharePointSearch(e,n)})})};t.prototype._substrateSearch=function(e,t){var n=this;return this._substratePeoplePickerHelper.getSubstrateToken().then(function(r){if(!r)return n.sharePointSearch(e,t);var i=null;t.siteIBSegmentIDs&&t.siteIBSegmentIDs.length>0&&(i=t.siteIBSegmentIDs);var o=["Mailbox","Directory"],a={Authorization:"Bearer "+r},l="";l=s.n.isFeatureEnabled(y)&&!v.t.isActivated("0576d3d3-42b4-4c60-a920-0e10e34a19a0","05/13/2021","Pass SiteIBMode to 3S.")?JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:o,Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],InformationBarrierMode:t.siteIBMode,Filter:i?{Or:i.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}}):JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:o,Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],Filter:i?{Or:i.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}});return n._dataRequestor.send({apiName:"Substrate.PeopleSearch",path:f.e+"/api/v1/suggestions",headers:a,needsAuthorization:!1,requestType:"POST",postData:l}).then(function(r){t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!0);var i=r.Groups[0]?r.Groups[0].Suggestions:[],s=[];i.forEach(function(e){if(!e.PeopleSubtype||!n._isIgnorablePeopleSubType(e.PeopleSubtype)){var r=e.EmailAddresses[0]||e.QueryText||"",i=e.UserPrincipalName&&n._isValidEmail(e.UserPrincipalName,!1)?e.UserPrincipalName:r,o={Key:i,IsResolved:!1},a="ImplicitContact"===e.PeopleSubtype,f="OrganizationUser"===e.PeopleSubtype,l="LinkedIn"===e.PeopleSubtype,c="Group"===e.PeopleType&&"UnifiedGroup"===e.PeopleSubtype,p="PublicDistributionList"===e.PeopleSubtype,d=Object(h.n)(n._webAbsoluteUrl,r),v={department:e.Department,office:e.OfficeLocation,email:r,image:a?void 0:d,job:!1===t.fallbackToEmailIfNoJob?e.JobTitle:e.JobTitle||r,name:e.DisplayName,providerName:"Provider",userId:i,rawData:o,rawPersonData:o,isExternal:!f};if(f){v.entityType=0;v.principalType=u.e.user;v.isResolved=!0}else if(c){v.entityType=2;v.principalType=u.e.securityGroup;v.isResolved=!1;v.providerName=void 0}else if(l)v.entityType=4;else{v.principalType=p?u.e.distributionList:u.e.none;v.entityType="Group"===e.PeopleType?2:1;v.isResolved=!1;v.providerName=void 0}v.userId&&s.push(v)}});if(!1!==t.resolveEmailIfNoResults&&0===s.length&&n._isValidEmail(e,!1)){var o={Key:e,IsResolved:!1};s.push({email:e,entityType:1,isResolved:!1,job:!1===t.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:o,rawPersonData:o,isExternal:!0})}return s},function(r){if("Canceled"!==r.name){n._substratePeoplePickerHelper.disableSubstrateCallsForPicker();n.sharePointSearch(e,t)}return null})})};t.prototype._isValidEmail=function(e,t){return e?!(e.indexOf(" ")>-1||e.indexOf(";")>-1)&&m.e.isValidEmailSyntax(e,!1):!t};t._getPersonTypeFilter=function(e){if(e.principalType===u.e.user)return"personType/class ne 'Group'";var t="";e.principalType&u.e.distributionList||(t+="personType/subclass ne 'PublicDistributionList'");if(!(e.principalType&u.e.securityGroup)){t&&(t+=" and ");t+="personType/subclass ne 'UnifiedGroup'"}return t||(!1!==e.filterPublicDistributionList?"personType/subclass ne 'PublicDistributionList'":"")};t.prototype._isIgnorablePeopleSubType=function(e){if(!e)return!1;return["PersonalDistributionList","ImplicitGroup","Unknown"].some(function(t){return t===e})};t.prototype._transformData=function(e,t){var n=this;return e.map(function(e){var r=e.EntityData,i={name:e.DisplayText,email:r.Email,userId:e.Key,job:r.Title,department:r.Department,phone:r.MobilePhone,providerName:e.ProviderDisplayName,entityType:e.EntityType,isResolved:e.IsResolved,multipleMatches:e.MultipleMatches,rawPersonData:e,rawData:e};if(i.multipleMatches.length>0){i.multipleMatches=n._transformData(i.multipleMatches,t);t&&(i.multipleMatches=i.multipleMatches.filter(function(e){return 1!==e.entityType}))}var s=i.email;i.isResolved&&(i.image=s?Object(h.n)(n._webAbsoluteUrl,s):null);var o=r.PrincipalType||e.EntityType;switch(o){case"UNVALIDATED_EMAIL_ADDRESS":case"GUEST_USER":i.entityType=1;i.principalType=u.e.user;i.isExternal=!0;break;case"SecGroup":case"SharePointGroup":case"FormsRole":i.entityType=2;i.principalType="SharePointGroup"===o?u.e.sharePointGroup:u.e.securityGroup;break;default:i.entityType=0;i.principalType=u.e.user}return i})};return t})(o.t);function w(e){return!!e.webAbsoluteUrl}},1854:function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return s});n.d(t,"n",function(){return o});var r,i=n(1002);(function(e){e.Small="S";e.Medium="M";e.Large="L"})(r||(r={}));function s(e){var t;switch(e.size){case r.Large:t=3;break;case r.Medium:t=2;break;default:t=1}return Object(i.getUserPhotoUrl)(e.userLoginName,t)}function o(e,t){var n=Object(i.getUserPhotoUrl)(t);if(!e||!n||n.startsWith("http"))return n;try{return new URL(e).origin+n}catch(e){return n}}},1860:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(125),i=n(157),s=n(154),o=(function(){function e(){}e.getBatchOperationUrl=function(e,t){return new i.t({webAbsoluteUrl:!e&&t?new s.e(t).authority:e}).build().segment("$batch").toString()};e.processErrorResponse=function(e,t){var n={id:t};if((e=e.error?e.error:e)&&e.code){var r=e.code?e.code.split(","):e.error.code.split(","),i=Number(r[0]),s=e.message.value;n.error={code:i,message:s}}return{items:[n]}};e.getBatchResponseText=function(e){var t,n,r,i=[];e.split("\n").length>0&&(t=e.split("\n")[0]);if(t){n=(e=e.replace(t.trim()+"--","")).split(t);for(var s=1;s<n.length;s++)(r=n[s].split("\n\r")).length>2&&i.push(r[2])}return i};e.processBatchResponse=function(e,t,n){var r,i,s,o,u=[],a=!1;e&&e.split("\n").length>0&&(r=e.split("\n")[0]);if(r){i=(e=e.replace(r.trim()+"--","")).split(r);for(var f=1;f<i.length;f++)if((s=i[f].split("\n\r")).length>2){try{o=JSON.parse(s[2])}catch(e){o=s[2]}var l=t&&t[f-1],c=l?{key:l.key,id:l.id,newId:n?n+"/"+l.name:null}:{};if((o=o.error?o.error:o)&&o.code){var h=o.code?o.code.split(","):o.error.code.split(","),p=Number(h[0]),d=o.message.value;c.error={code:p,message:d};a=!0}u.push(c)}}return{items:u,hasError:a}};e.getBatchContent=function(e,t,n,i){for(var s=[],o=0;o<t.length;o++){for(var u=t[o],a=r.e.generate(),f=[],l=0;l<u.length;l++){var c=u[l];f.push("--changeset_"+a);f.push("Content-Type: application/http");f.push("Content-Transfer-Encoding: binary");f.push("");f.push(n+" "+c+" HTTP/1.1");f.push(i);f.push("")}f.push("--changeset_"+a+"--");var h=f.join("\r\n");s.push("--batch_"+e);s.push('Content-Type: multipart/mixed; boundary="changeset_'+a+'"');s.push("Content-Length: "+h.length);s.push("Content-Transfer-Encoding: binary");s.push("");s.push(h);s.push("")}s.push("--batch_"+e+"--");return s.join("\r\n")};e.getBatchContentExtended=function(e,t,n,i,s,o,u){var a=r.e.generate(),f=[];s&&s.length!==t.length&&(s=null);for(var l=0;l<t.length;l++){var c=t[l];f.push("--changeset_"+a);f.push("Content-Type: application/http");f.push("Content-Transfer-Encoding: binary");f.push("");u?f.push(u[l]+" "+c+" HTTP/1.1"):f.push(n+" "+c+" HTTP/1.1");f.push(i);o&&f.push(o);if(s){f.push("");f.push(s[l])}f.push("")}f.push("--changeset_"+a+"--");var h=f.join("\r\n");(f=[]).push("--batch_"+e);f.push('Content-Type: multipart/mixed; boundary="changeset_'+a+'"');f.push("Content-Length: "+h.length);f.push("Content-Transfer-Encoding: binary");f.push("");f.push(h);f.push("");f.push("--batch_"+e+"--");return f.join("\r\n")};e.defaultBatchRequestPostData="Content-Type: application/json;odata=verbose";e.defaultBatchAcceptData="accept: application/json;odata=verbose";return e})();t.t=o},1861:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(282),i=Object(r.e)({eventName:"SuiteNavError,",shortEventName:"SuiteNavError",requiresParent:!1},{message:1,stack:1,type:1})},1865:function(e,t,n){"use strict";n.d(t,"e",function(){return m});var r=n(1946),i=n(52),s=n(1973),o=n(164),u=n(1713),a=n(1945),f=(function(){function e(e){this._pageContext=e.pageContext?e.pageContext:window._spPageContextInfo;this._getThemeDataSource=e.getThemeDataSource;this._themeProvider=new s.e(this._loadTheme.bind(this))}e.prototype.loadThemeSlotsMap=function(e){var t=this._getThemeCacheToken();return t?this._themeProvider.loadThemeTokenMap(t,e):i.n.resolve()};e.prototype.loadFullFormattedThemeData=function(e){var t=this;return this.loadFullThemeData(e).then(function(e){if(e){var n={},r=e.palette;for(var i in r){var o=r[i];o&&(n[i]=u.e.toHtmlString(o))}e.backgroundImageUri&&(n.backgroundImageUri=s.e.getBackgroundUrl(e));var f={palette:n,isInverted:e.isInverted};return f=Object(a.e)(f,t._pageContext)}})};e.prototype.loadFullThemeData=function(e){var t=this._getThemeCacheToken();if(t)return this._themeProvider.loadThemeData(t,e);return i.n.resolve(void 0)};e.prototype._getThemeCacheToken=function(){var e,t=this._pageContext;if(t){var n=Number(t.webTemplate),r=n===o.e.teamSite||n===o.e.group?t.groupColor:void 0,i=r?r+";web#"+t.webTemplate:null;e=t.themedCssFolderUrl||i||null}return e};e.prototype._loadTheme=function(e){if(!!this._getThemeCacheToken()){this._themeDataSource||(this._themeDataSource=this._getThemeDataSource());return this._themeDataSource.then(function(t){return t?t.loadTheme(e):i.n.resolve()})}return i.n.resolve()};return e})(),l=n(289),c=n(356),h=n(1866),p=n(1967),d=n(1008).r?"#0078d4":"#03787c",v=(function(){function e(e){this._pageContext=e;this._dataRequestor=new c.e({qosName:"WebThemeDataSource"},{pageContext:e})}e.prototype.getCacheToken=function(){var e="",t=this._pageContext;if(t){var n=Number(t.webTemplate),r=n!==o.t.mySite&&n!==o.t.mySiteHost?t.groupColor:d;e=t.themedCssFolderUrl||r}return e};e.prototype.loadTheme=function(e){if(!e&&this._dataPromise)return this._dataPromise;if(!this.getCacheToken())return this._dataPromise=i.n.resolve();this._dataPromise=this._pageContext.themedCssFolderUrl?this.loadServerTheme():this.loadGeneratedTheme();return this._dataPromise};e.prototype.needsRequestDigest=function(e){return!1};e.prototype.loadGeneratedTheme=function(){var e=this._pageContext.groupColor||d,t=u.e.fromHtmlColor(e);if(t){var n={backgroundImageUri:null,cacheToken:e,isDefault:!1,isInverted:!1,palette:h.e.generateFabricColors(t),version:"1"};return i.n.resolve(n)}return i.n.resolve()};e.prototype.loadServerTheme=function(){var e=this,t=Object(l.n)(this._pageContext),n=this._pageContext.currentUICultureName,r=this._pageContext.themedCssFolderUrl,i=this.getCacheToken()===r&&r||void 0,s=p.e.makeWebThemeRestUrl(t,n,i),o=this._dataRequestor.getData({url:s,parseResponse:function(t){e._data=p.e.processWebThemeRestResponse(t);return e._data},qosName:"WebThemeDataSource.LoadData",method:"GET"});o.done(null,function(){e._dataPromise=null});return o};return e})();function m(e){var t=e||window._spPageContextInfo,n={webThemeProvider:function(){return new f({pageContext:t,getThemeDataSource:function(){return i.n.resolve(new v(t))}})}};return Object(r.e)(n,t)}},1902:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.Html5file=0]="Html5file";e[e.Folder=1]="Folder"})(r||(r={}));t.t=r},1908:function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return i});var r,i,s={applyPanel:"filtersPane-applyInPanel",pinnedToFiltersPaneChanged:"filtersPane-pinnedToFiltersPaneChanged",showInFiltersPaneChanged:"filtersPane-showInFiltersPaneChangedChanged",sectionInfosChanged:"filtersPane-sectionInfosChanged"};(function(e){e[e.user=0]="user";e[e.date=1]="date";e[e.fileType=2]="fileType";e[e.choice=3]="choice";e[e.hierarchy=4]="hierarchy"})(r||(r={}));(function(e){e[e.none=0]="none";e[e.last3Months=1]="last3Months";e[e.last30Days=2]="last30Days";e[e.last7Days=3]="last7Days";e[e.yesterday=4]="yesterday";e[e.today=5]="today";e[e.tomorrow=6]="tomorrow";e[e.next7Days=7]="next7Days";e[e.next30Days=8]="next30Days";e[e.next3Months=9]="next3Months";e[e.nextYear=10]="nextYear"})(i||(i={}))},1920:function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return i});n.d(t,"n",function(){return s});var r={neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8"},i={elevation4:"0 0 5px 0 rgba(0,0,0,.4)",elevation8:"0 0 5px 0 rgba(0,0,0,.4)",elevation16:"0 0 5px 0 rgba(0,0,0,.4)",elevation64:"0 0 5px 0 rgba(0,0,0,.4)",roundedCorner2:"0px",roundedCorner4:"0px",roundedCorner6:"0px"},s={tiny:{fontSize:10,fontWeight:600},xSmall:{fontSize:11,fontWeight:400},small:{fontSize:12,fontWeight:400},smallPlus:{fontSize:13,fontWeight:400},medium:{fontSize:14,fontWeight:400},mediumPlus:{fontSize:15,fontWeight:400},large:{fontSize:17,fontWeight:300},xLarge:{fontSize:21,fontWeight:100},xLargePlus:{fontSize:21,fontWeight:100},xxLarge:{fontSize:28,fontWeight:100},xxLargePlus:{fontSize:28,fontWeight:100},superLarge:{fontSize:42,fontWeight:100},mega:{fontSize:72,fontWeight:100}}},1933:function(e,t,n){"use strict";n.r(t);n.d(t,"getItemName",function(){return f});n.d(t,"updateListContext",function(){return l});n.d(t,"updateListContextGroupInfo",function(){return c});var r=n(0),i=n(141),s=n(70),o=n(330),u=n(357),a=n(29);function f(e,t,n){return n&&!n.isDocLib&&t!==i.t.Folder&&(e.Title||e["URL.desc"])||e.FileLeafRef}function l(e,t){if(Number(e.ListTemplateType)){t.listTemplateType=Number(e.ListTemplateType);t.isDocLib=Object(a.i)(t.listTemplateType)}"boolean"==typeof e.ContentTypesEnabled&&(t.contentTypesEnabled=e.ContentTypesEnabled);if(e.ListSchema){t.listId=e.listName;t.rawListSchema=e.ListSchema;t.viewTitle=e.viewTitle;t.openInClient="0"===t.rawListSchema.DefaultItemOpen}e.ListTitle&&(t.listTitle=e.ListTitle);e.listUrlDir&&(t.listUrl=decodeURIComponent(e.listUrlDir));e.EnableAttachments&&(t.enableAttachments="true"===e.EnableAttachments);e.Flags2&&(t.flags2=e.Flags2);e.Icon&&(t.icon=e.Icon);e.Color&&(t.color=e.Color);var n=e.BasePermissions;n&&(t.permissions={manageLists:n.ManageLists,managePersonalViews:n.ManagePersonalViews,openItems:n.OpenItems});"boolean"!=typeof e.ExcludeFromOfflineClient&&"boolean"!=typeof e.WebExcludeFromOfflineClient||(t.excludeFromOfflineClient=!(!e.ExcludeFromOfflineClient&&!e.WebExcludeFromOfflineClient));"boolean"==typeof e.TenantTagPolicyEnabled&&(t.tenantTagPolicyEnabled=e.TenantTagPolicyEnabled);"boolean"==typeof e.verEnabled&&(t.enableVersions=e.verEnabled);"boolean"==typeof e.checkPowerAppState&&(t.checkPowerAppState=e.checkPowerAppState);"boolean"==typeof e.EnableMinorVersions&&(t.enableMinorVersions=e.EnableMinorVersions);"boolean"==typeof e.NewWOPIDocumentEnabled&&(t.newWOPIDocumentEnabled=e.NewWOPIDocumentEnabled);"number"==typeof e.NewWOPIDocumentTypes&&(t.newWOPIDocumentTypes=e.NewWOPIDocumentTypes);"boolean"==typeof e.isForceCheckout&&(t.isForceCheckout=e.isForceCheckout);"boolean"==typeof e.isModerated&&(t.isModerated=e.isModerated);"boolean"==typeof e.EnableRequestSignOff&&(t.enableRequestSignOff=e.EnableRequestSignOff);"boolean"==typeof e.AllowCreateFolder&&(t.allowCreateFolder=e.AllowCreateFolder);s.t.isActivated("F5795B0F-8820-4A74-9281-EC1C68E4929C","2/9/2021","Implement list level comment setting")||"boolean"!=typeof e.DisableCommenting||(t.disableCommenting=e.DisableCommenting);"boolean"==typeof e.AllowGridMode?t.allowGridMode=e.AllowGridMode:"boolean"!=typeof t.allowGridMode&&(t.allowCreateFolder=!0);e.displayFormUrl&&(t.displayFormUrl=e.displayFormUrl);e.editFormUrl&&(t.editFormUrl=e.editFormUrl);e.newFormUrl&&(t.newFormUrl=e.newFormUrl);e.metadataNavFeatureEnabled&&(t.metadataNavFeatureEnabled=e.metadataNavFeatureEnabled);e.AvailableContentTypes&&(t.availableContentTypes=e.AvailableContentTypes);if(e.ViewMetadata){var i=void 0;i=Object(r.__assign)({},e.ViewMetadata);if(e.VisualizationInfo)try{i.VisualizationInfo=JSON.parse(e.VisualizationInfo)}catch(e){}i.CustomFormatter=e.ListSchema&&e.ListSchema.CustomFormatter;t.viewResult=new o.e(i)}t.isPlaceholder=!1}function c(e){var t=void 0;if(e.groupByOverride)t=[e.groupByOverride];else if(e.rawListSchema&&e.rawListSchema.group1){(t=[]).push(e.rawListSchema.group1);e.rawListSchema.group2&&t.push(e.rawListSchema.group2)}var n=-1,r=e.rawListSchema&&"TRUE"===e.rawListSchema.Collapse;if(t&&t.length>0){n=0;if(e.filterParams&&!r){var i=Boolean(Object(u.getFilterFieldByName)(e.filterParams,t[0])),s=!(!i||!t[1])&&Boolean(Object(u.getFilterFieldByName)(e.filterParams,t[1]));(i&&1===t.length||s&&2===t.length)&&(n=-1)}}e.groupLevel=n;e.groupBy=n>-1?t:void 0;e.isGrouped=Boolean(e.groupBy)}},1945:function(e,t,n){"use strict";n.d(t,"t",function(){return l});n.d(t,"e",function(){return c});var r=n(0),i=n(254),s=n(430),o=n(249),u=n(471),a=n(1920),f=n(1008);function l(e,t,n){var r;i.e.applyBatchedUpdates(function(){r=Object(s.n)(c(e,t))});return r}function c(e,t){t&&o.e.initSPExpFeatures(t.ExpFeatures);u.n.evaluateCanOverride();if(!f.r){e=h({palette:{themePrimary:"#03787c",themeLighterAlt:"#f0f9fa",themeLighter:"#c5e9ea",themeLight:"#98d6d8",themeTertiary:"#49aeb1",themeSecondary:"#13898d",themeDarkAlt:"#026d70",themeDark:"#025c5f",themeDarker:"#014446"}},e)}f.n&&!u.n.isFeatureEnabled(f.e)&&(e=h({effects:a.t},e));f.n&&!u.n.isFeatureEnabled(f.e)&&(e=h({fonts:a.n},e));var n=e.palette;n&&(n.black||n.neutralPrimary||n.white||n.neutralQuaternary)&&!(n.black&&n.white&&n.neutralPrimary&&n.neutralQuaternary&&0===n.black.indexOf("#000")&&0===n.white.toLowerCase().indexOf("#fff")&&0===n.neutralPrimary.indexOf("#333")&&0===n.neutralQuaternary.toLowerCase().indexOf("#d0d0d0"))||(e.palette=Object(r.__assign)(Object(r.__assign)({},e.palette),a.e));return e}function h(e,t){return e=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e),t),{effects:Object(r.__assign)(Object(r.__assign)({},e.effects),t.effects),fonts:Object(r.__assign)(Object(r.__assign)({},e.fonts),t.fonts),palette:Object(r.__assign)(Object(r.__assign)({},e.palette),t.palette)})}},1946:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r,i;function s(e,t){if(!r||i!==e){r=(function(e,t){var n,r=t||window._spPageContextInfo;r&&(n=e.webThemeProvider(r));return n})(e,t);i=e}return r}},1965:function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"r",function(){return i});n.d(t,"n",function(){return s});n.d(t,"t",function(){return o});var r="role:1073741827",i="role:1073741826",s="role:1073741829",o="role:1073741830"},1968:function(e,t,n){"use strict";n.d(t,"e",function(){return N});var r=n(0),i=n(197),s=n(103),o=n(63),u=n(2249),a=n(1861),f=n(164),l=n(1017),c=n(156),h=n(471),p=n(70),d=n(1865),v=n(1008),m=n(52),g=n(994),y=n(133),b=n(109),w=n(48),E=n(1036),S={ODB:556,ODC:null,Fallback:!1},x={ODB:1302,ODC:null,Fallback:!1},T={ODB:1836,ODC:null,Fallback:!1},N=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,{engagementEvent:y.e,qosEvents:{"SuiteNavProvider.GetO365Shell":new b.e({name:"SuiteNavProvider.GetO365Shell"})}},n)||this;r._dataSource=n.dataSource;r._cssLoaded=!1;r._isSuiteNavBootstrapperLoadingFlowEnabled=h.n.isFeatureEnabled(x);return r}t.prototype.clearCachedPromise=function(){this._modelPromise=void 0};t.prototype.loadData=function(e){return this._loadModel(e).then(function(e){return e.data})};t.prototype.getO365Shell=function(){if(this._isSuiteNavBootstrapperLoadingFlowEnabled)return e.prototype.getO365Shell.call(this);if(!this._capabilities.supportsRealSuiteNav)throw new Error("getO365Shell is only supported if supportsRealSuiteNav capability is true.");var t=new i.e,n=new b.e({name:"SuiteNavProvider.GetO365Shell"});this._getSuiteNavShell(t);t.getPromise().then(function(){n.end({resultType:w.e.Success})},function(e){n.end(Object(E.n)({error:e}))});return t.getPromise()};t.prototype.getMailUrl=function(){return this._loadModel().then(function(e){var t=e&&e.data&&e.data.WorkloadLinks;if(t)for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i&&i.Id===l.e.MAIL)return i.Url}})};t.prototype.updateWorkloadSettingsLinks=function(e){var t,n=this;return this.getO365Shell().then(function(r){return(t=r)&&t.Settings?n.loadData(e):void 0}).then(function(e){e&&e.CurrentWorkloadSettingsSubLinks&&e.CurrentWorkloadSettingsSubLinks.length>0&&t.Settings.SetWorkloadSettingsLinks(e.CurrentWorkloadSettingsSubLinks)}).catch(function(e){y.e.logData({name:"SuiteNavProvider.UpdateWorkloadSettingsLinksError"})})};t.prototype.trySetDataAfterInitialRender=function(e,t){var n=this,i=this._dataSource.getSuiteNavContext();if(i&&i.isConsumer){if(!p.t.isActivated("0461c2e7-c91a-4038-b591-09477f3f84a6","09/27/2021","Extra SuiteNav configuration for Consumer")&&e.NFD){i.helpNamespace&&e.NFD.UpdateHelpNamespace(i.helpNamespace);e.NFD.OnFeedbackMetadataRequested(function(e,t){return e=n._dataSource.setFeedbackMetadata(e,t)});this._addFeedbackButton(e)}this._logEngagementData({name:"SuiteNavProvider.SetDataNotNeededInConsumer"});return m.n.wrap(!0)}y.e.logData({name:"SuiteNavProvider.SetDataAfterInitialRender"});var s=t.actionContext,o=t.bundleLoader;return this.loadData().then(function(t){if(!t){y.e.logData({name:"SuiteNavProvider.NoSuiteNavData"});return!1}if(!e){y.e.logData({name:"SuiteNavProvider.NoO365Shell"});return!1}var i=h.n.isFeatureEnabled(T)&&!!e.NFD,u=i&&n._shouldAddFeedbackButton(e);if(u){var a=JSON.parse(t.ClientData);if(a.OCVFeedbackMAXEnabled){if(!p.t.isActivated("7897BF84-323B-4580-95D2-A14836FE65F6","09/15/2021","Stop modifying OCVFeedbackMAXEnabled")){a.OCVFeedbackMAXEnabled=!1;t.ClientData=JSON.stringify(a)}}else i=u=!1}try{e.SetData(t)}catch(e){y.e.logData({name:"SuiteNavProvider.SetDataFail"});b.e.instrumentPromise({name:"SuiteNav.RefreshCacheAfterInvalidShellData"},function(){return n.loadData(!0)});return!1}t.ActionsMap&&e.Navigation.OnLinkClick(function(e){var n=t.ActionsMap[e.Id];n&&(e.Cancel=!n(Object(r.__assign)(Object(r.__assign)({},e),s||{})))});e.OnHasMember("OnDataChanged",function(){e.OnDataChanged(function(){return b.e.instrumentPromise({name:"SuiteNav.RefreshCacheForShellDataChanged"},function(){return n.loadData(!0)}).done()})});if(i){e.NFD.OnFeedbackMetadataRequested(function(e,t){return e=n._dataSource.setFeedbackMetadata(e,t)});u&&n._addFeedbackButton(e)}o&&o.pageRenderingIsComplete();return!0},function(e){y.e.logData({name:"SuiteNavProvider.LoadDataError"});return!1})};t.prototype._getSuiteNavShell=function(e,t){var n=this;this._loadModel().then(function(r){if(!n._cssLoaded&&r.cssUrl){g.e.loadStylesheet(r.cssUrl);n._dataSource.onCssLoad&&n._dataSource.onCssLoad(r);n._cssLoaded=!0}y.e.logData({name:"SuiteNavProvider.GetO365ShellByS2S"});n._requestShellCore(r.jsUrl,t,C).then(function(t){e.complete(t)},function(t){n._modelPromise=void 0;if((t=Object(E.n)({error:t}))&&"LoadScriptError"===t.resultCode&&n._isDataFromCache){y.e.logData({name:"SuiteNavProvider.O365ShellCacheFailed"});n._clearCache();n._getSuiteNavShell(e)}else if(n._hasRetriedShell)e.error(t);else{n._hasRetriedShell=!0;n._cssLoaded=!1;y.e.logData({name:"SuiteNavProvider.O365ShellRetry"});n._getSuiteNavShell(e,!0)}})})};t.prototype._loadModel=function(e){var t=this;if(!e&&this._modelPromise)return this._modelPromise;var n,r,s=new i.e,o=this._capabilities.supportsCaching,u=this._dataSource,a=w.e.Failure,f=b.e.instrumentPromise({name:"SuiteNavProvider.LoadData"},function(){return new m.n(function(r,i){var s;!e&&o&&t._isCacheValid()&&(s=t._cache.getValue(t._cacheDataKey));if(s&&s.data){y.e.logData({name:"SuiteNavProvider.DataFromCache"});u.updateDataForCurrentPage&&(s.data=u.updateDataForCurrentPage(s.data));if(o&&t._isCacheOutdated()){y.e.logData({name:"SuiteNavProvider.RefreshCache"});u.loadData().then(function(e){t._updateCache(e)})}t._isDataFromCache=!0;r(s)}else{t._isDataFromCache=!1;e&&y.e.logData({name:"SuiteNavProvider.ForceUpdateData"});y.e.logData({name:"SuiteNavProvider.DataFromServer"});u.loadData().done(function(e){if(e)if(e.data){o&&!(function(e){var t=e&&e.data&&e.data.WorkloadLinks;return!!t&&t.some(function(e){return e&&!e.Url})})(e)&&t._updateCache(e);r(e)}else{n="NoModelData";i("Model with no data returned")}else{n="NoModel";i("No model returned")}},function(e){if(m.n.isCanceled(i)){n="Canceled";a=w.e.ExpectedFailure}else n="ServerLoadFailure";i(e)})}})},null,function(e){if(m.n.isCanceled(e)){a=w.e.ExpectedFailure;n="Canceled"}return{resultType:a,resultCode:n||"Other",error:e}});(r=Object(d.e)())?this._modelPromise=m.n.all({suiteNavModel:f,theme:r.loadThemeSlotsMap()}).then(function(e){var t=e.suiteNavModel,n=e.theme,r=t&&t.data,i=t&&t.hasCobranding,s=r&&r.UseSPOBehaviors,o=h.n.isFeatureEnabled(S),u=n&&n.suiteBarBackground;!(u&&r&&s)||i&&o||(r.ThemeColors=[u,n.primaryText,u,n.suiteBarText,n.suiteBarDisabledText,n.topBarBackground,n.topBarText,n.topBarHoverText,n.primaryBackground,n.themeLighterAlt,n.dialogBorder]);return t}):this._modelPromise=f;this._modelPromise.then(function(e){return s.complete(e)},function(e){return s.error(e)});return s.getPromise()};t.prototype._shouldAddFeedbackButton=function(e){var t=!1;if(h.n.isFeatureEnabled({ODB:v.r?-1246:1246,ODC:null,Fallback:!1})){var n=this._dataSource.getWebTemplateType?this._dataSource.getWebTemplateType():f.t.invalid,r=/\/_layouts\/15\/Lists.aspx$/i;t=p.t.isActivated("9BCCA26C-EC25-44FF-A395-2D6D04734F76","09/15/2021","More specific ODB check for Feedback button")?n!==f.t.mySiteHost&&n!==f.t.mySite&&n!==f.t.tenantAdmin||r.test(window.location.pathname):n!==f.t.mySiteHost&&!v.r&&n!==f.t.tenantAdmin||r.test(window.location.pathname)}return t};t.prototype._addFeedbackButton=function(e){var t;null===(t=e.Extensibility)||void 0===t||t.AddOrUpdateCustomHeaderButton({affordanceMenuItemText:u.e,ariaLabel:u.e,iconFontFamily:"FabricMDL2Icons",iconFontName:"",id:"GiveFeedbackButton",onShow:function(){var t;if(e.FlexPane){e.FlexPane.OpenFlexPaneForProvider("Feedback");c.e.raise(document.body,"resize",void 0,!0)}null===(t=e.Extensibility)||void 0===t||t.UpdateButtonState("GiveFeedbackButton",!0)},onHide:function(){var t;null===(t=e.FlexPane)||void 0===t||t.CloseFlexPaneForProvider("Feedback");c.e.raise(document.body,"resize",void 0,!0)}})};t.prototype._clearCache=function(){this._cache.remove(this._cacheDataKey);this._cache.remove(this._cacheThemeDataKey);this._cache.remove(this._cacheDateKey);this._cache.remove(this._cacheVersionKey);this._cache.remove(this._cacheSessionKey,o.e.session)};t.prototype._updateCache=function(e,t){this._cache.setValue(this._cacheDataKey,e);this._cache.setValue(this._cacheDateKey,new Date);this._cache.setValue(this._cacheVersionKey,this._cacheVersion);this._cache.setValue(this._cacheSessionKey,!0,o.e.session)};t.prototype._isCacheOutdated=function(){var e=this._cache.getValue(this._cacheSessionKey,o.e.session),t=Date.parse(this._cache.getValue(this._cacheDateKey));return s.e.hasStorageType(o.e.session)&&!e||Date.now()-t>=60*this._cacheRenew*60*1e3};return t})(E.e);function C(){var e=window._o365su;if(e&&e.b)for(var t=0,n=["ThrowOnNull","ThrowOnUndefined","ThrowOnNullOrUndefined","ThrowOnNullOrEmpty","ThrowOnNullOrEmptyArray"];t<n.length;t++){var r=n[t];k(e.b,r)}}function k(e,t){var n=e[t];"function"==typeof n&&(e[t]=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];try{return n.apply(this,e)}catch(e){a.e.logData({message:e&&e.message||"",stack:e&&e.stack||"",type:t})}})}},2000:function(e,t,n){"use strict";var r,i=n(357);(function(e){e.getFilterData=function(e,t,r,s){var o=[];e=e.split("<br>")[0];var u=document.createElement("DIV");u.innerHTML=e;var a=u.querySelector("#diidFilter"+t);if(null!=a)for(var f=a.childNodes.length,l=a.childNodes,c=1;c<f;c++){var h=Object(i.getText)(l[c]),p=l[c].value.toString(),d={display:null!=s&&s?p:h,value:p};if(r){var v=n(p);if(v.filterType){d.value=v.value;d.calculatedFieldOriginFilterValue=p;d.calculatedFieldFilterType=v.filterType;o.push(d)}}else o.push(d)}for(var m={},g=0,y=o;g<y.length;g++){(E=y[g]).display in m?m[E.display]++:m[E.display]=1}for(var b=0,w=o;b<w.length;b++){var E;m[(E=w[b]).display]>1&&(E.display=E.value)}return o};var t=["Text","Text","Text","Text","Text","Number","Text","DateTime","Text","Text","Error","Boolean"];function n(e){var n=e.indexOf("_"),r=e,i=void 0;if(n>0){r=e.substring(n+1);var s=Number(e.substring(0,n));!isNaN(s)&&s<t.length&&(i=t[s])}return{value:r,filterType:i}}e.getCalculatedFieldFilterValueAndType=n})(r||(r={}));t.e=r},2015:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(0),i=n(1777),s=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,Object(r.__assign)(Object(r.__assign)({},t),{isExpected:o(t.errorType)}))||this;n.message=t.message;n.errorType=t.errorType||i.e.other;n.maxSizeInBytes=t.maxSizeInBytes;n.allowRename=t.allowRename||!1;n.allowMerge=t.allowMerge||!1;n.supportsVersioning=t.supportsVersioning||!1;n.extraData=t.extraData;n.libraryName=t.libraryName;n.isFolder=t.isFolder;n.fixItUrl=t.fixItUrl;return n}return t})(n(53).e);function o(e){switch(e){case i.e.conflict:case i.e.similarNameExists:case i.e.emptyFileOrFolder:case i.e.emptyFileOrFolderForDocLib:case i.e.fileSize:case i.e.folderUploadNotSupported:case i.e.insufficientVaultQuota:case i.e.invalidName:case i.e.lockMismatch:case i.e.malwareDetected:case i.e.overQuota:case i.e.overQuotaSharedFolder:case i.e.pathTooLong:case i.e.targetFolderMissing:case i.e.throttled:case i.e.unlockRequired:case i.e.versionMismatch:return!0;case i.e.accessDenied:case i.e.itemNotFound:case i.e.disconnected:case i.e.authFailure:case i.e.general:return!1;case i.e.none:case i.e.other:return}}},2070:function(e,t,n){"use strict";n.d(t,"n",function(){return o});n.d(t,"t",function(){return a});n.d(t,"e",function(){return c});var r=n(28),i=n(393),s=n(80);function o(e){var t="string"==typeof e?Object(i.t)(e):e;return{filters:l(t.where),sorts:u(t.orderBy),groupBy:a(t.groupBy),fieldNames:Object(i.s)(t.viewFields),rowLimit:f(t.rowLimit),associatedContentTypeId:Object(i.i)(t.associatedContentTypeId)}}function u(e){if(e){var t=Array.prototype.slice.call(e.childNodes).map(function(e){return h(e)}).filter(function(e){return!!e});return t.length?t:void 0}}function a(e){if(e){var t=Array.prototype.slice.call(e.childNodes).map(function(e){return h(e)}).filter(function(e){return!!e});if(t.length){var n={isCollapsed:p(e,r.e.collapse,!0),group1:t[0]};t[1]&&(n.group2=t[1]);return n}}}function f(e){if(e&&e.textContent)return{rowLimit:Number(e.textContent),isPerPage:p(e,r.e.paged,!1)}}function l(e){if(e&&e.childElementCount){var t=c(e.firstElementChild);return t&&t.length?t:void 0}}function c(e){if(e){var t;switch(e.tagName){case r.n.and:t=(function(e){if(!e||!e.childElementCount)return;var t=e.firstElementChild,n=c(t);if(!t.nextElementSibling)return n;var r=c(t.nextElementSibling);if(!n&&!r)return;return(n||[]).concat(r||[])})(e);break;case r.n.or:t=(function(e){var t=(function e(t){if(!t.childElementCount)return;var n;switch(t&&t.tagName){case r.n.or:var i=t.firstElementChild,s=e(i);if(s&&i.nextElementSibling){var o=e(i.nextElementSibling);n=o?s.concat(o):void 0}else n=s;break;case r.n.eq:n=d(t);break;case r.n.isNull:n=v(t)}if(n)return Array.isArray(n)?n:[n];return})(e);if(t&&t.length&&!t.some(function(e){return!e})){if(t.every(function(e){return e.fieldName===t[0].fieldName&&e.lookupId===t[0].lookupId})){var n=!1,i=t.reduce(function(e,t){if(!n)if(e.type&&t.type&&e.type!==t.type){n=!0;e.type=void 0}else e.type=e.type||t.type;e.values.push(t.values[0]);return e});i.operator=r.n.eq;i.id=e&&s.t(e,r.e.id);return i}}return null})(e);break;case r.n.isNull:case r.n.isNotNull:case r.n.membership:t=v(e);break;case r.n.beginsWith:case r.n.contains:case r.n.eq:case r.n.greaterEq:case r.n.greater:case r.n.includes:case r.n.lessEq:case r.n.less:case r.n.notEq:case r.n.notIncludes:t=d(e);break;case r.n.inTag:t=(function(e){var t=m(e),n=Array.prototype.filter.call(e.childNodes,function(e){return e.tagName===r.n.values})[0];if(!t||!n)return;var i=!1,s=Array.prototype.map.call(n.childNodes,function(e){var n=g(e);if(n&&n.type&&!i){var r=n.type,s=t.type;i=!(!s||!r||s===r);t.type=s||r}return n&&n.value});if((s=s.filter(function(e){return!!e})).length){t.values=s;i&&(t.type=void 0)}return s.length?t:void 0})(e)}return t?Array.isArray(t)?t.length?t:void 0:[t]:void 0}}function h(e){if(e&&e.tagName===r.n.fieldRef){var t=s.t(e,r.e.name);if(t)return{fieldName:t,isAscending:p(e,r.e.ascending,!0)}}}function p(e,t,n){switch((s.t(e,t)||"").toLowerCase()){case"true":return!0;case"false":return!1;default:return n}}function d(e){var t=m(e),n=Array.prototype.filter.call(e.childNodes,function(e){return e.tagName===r.n.value})[0];if(t&&n){var i=g(n);if(i){t.type=i.type;t.values=[i.value];return t}}}function v(e){var t=m(e);if(t)if(e.tagName===r.n.isNull)t.values=[""];else if(e.tagName===r.n.membership){var n=s.t(e,r.e.type);n?t.values=[n]:t=void 0}return t}function m(e){var t=Array.prototype.filter.call(e.childNodes,function(e){return e.tagName===r.n.fieldRef})[0],n=t&&s.t(t,r.e.name),i=e&&s.t(e,r.e.id);if(n)return{fieldName:n,id:i,type:void 0,lookupId:p(t,r.e.lookupId),operator:e.tagName,values:void 0}}function g(e){var t=e&&e.childElementCount&&e.firstElementChild.tagName!==r.n.today&&e.firstElementChild.tagName!==r.n.me;if(e&&e.tagName===r.n.value&&!t){var n,i={value:e.textContent,type:s.t(e,r.e.type)};if(e.childElementCount)if(e.firstElementChild.tagName===r.n.today){var o=e.firstElementChild,u=s.t(o,r.e.offset)||s.t(o,r.e.offsetDays),a=parseInt(u,10)||0;i.value=s.s(a);i.type=i.type||"DateTime"}else if(e.firstElementChild.tagName===r.n.me){i.value=s.r();i.type=i.type||"Integer"}i.value&&"DateTime"===i.type&&!0!==p(e,r.e.includeTimeValue)&&(n=i.value.match(r.t.datetimeNoTimeRegex))&&(i.value=n[1]);return i}}},2090:function(e,t,n){"use strict";n.d(t,"t",function(){return s});var r;(function(e){e[e.unknown=1]="unknown";e[e.odb=2]="odb";e[e.sharePoint=3]="sharePoint";e[e.ngsc=4]="ngsc";e[e.word=5]="word";e[e.powerpoint=6]="powerpoint";e[e.excel=7]="excel";e[e.onenoteWeb=8]="onenoteWeb";e[e.wac=9]="wac";e[e.visio=10]="visio";e[e.officecom=11]="officecom";e[e.listPart=12]="listPart";e[e.outlookWeb=13]="outlookWeb";e[e.odIos=14]="odIos";e[e.odAndroid=15]="odAndroid";e[e.teams=16]="teams";e[e.sample=17]="sample";e[e.odc=18]="odc";e[e.wordAndroid=19]="wordAndroid";e[e.excelAndroid=20]="excelAndroid";e[e.powerpointAndroid=21]="powerpointAndroid";e[e.wordIos=22]="wordIos";e[e.excelIos=23]="excelIos";e[e.powerpointIos=24]="powerpointIos";e[e.onenote=25]="onenote";e[e.teamsIos=26]="teamsIos";e[e.teamsAndroid=27]="teamsAndroid";e[e.onenoteIos=28]="onenoteIos";e[e.visioIos=29]="visioIos";e[e.onenoteAndroid=30]="onenoteAndroid";e[e.visioAndroid=31]="visioAndroid";e[e.outlookWindows=32]="outlookWindows";e[e.outlookMac=33]="outlookMac";e[e.onenoteUWP=34]="onenoteUWP";e[e.officemobileIos=35]="officemobileIos";e[e.officemobileAndroid=36]="officemobileAndroid";e[e.odcWac=37]="odcWac";e[e.outlookGroupsWeb=38]="outlookGroupsWeb";e[e.fluid=39]="fluid";e[e.modernFileExplorer=40]="modernFileExplorer";e[e.listsHome=41]="listsHome";e[e.listsIos=42]="listsIos";e[e.edgeEnterpriseNtp=43]="edgeEnterpriseNtp";e[e.officeFeed=44]="officeFeed";e[e.searchUx=45]="searchUx";e[e.consumerList=46]="consumerList";e[e.shareDemo=47]="shareDemo";e[e.onePlayer=48]="onePlayer"})(r||(r={}));var i=void 0;function s(e){if(void 0===i){i={};for(var t in r){var n=parseInt(t);if(!isNaN(n)){var s=r[n].toLowerCase();i[s]=n}}}var o=e?e.toLowerCase():"";return i[o]||r.unknown}t.e=r},2121:function(e,t,n){"use strict";n.r(t);n.d(t,"getFilter",function(){return a});n.d(t,"updateFilter",function(){return f});n.d(t,"removeFilter",function(){return l});n.d(t,"getAllSmartFilters",function(){return c});n.d(t,"removeSmartFilters",function(){return h});n.d(t,"getEffectiveFilterParams",function(){return p});var r=n(153),i=n(2070),s=n(621),o=n(80),u=n(357);function a(e,t){var n=d(e,t);if(n){var r=i.e(n);if(r&&1===r.length&&r[0]){var s=r[0];s.id=t;return s}}}function f(e,t){if(!t.id)throw new Error("Must provide a filter with an id to use updateFilter");var n=s.e(t);if(!n)throw new Error("Filter could not be serialized");var i=d(e,t.id);if(i){var u=void 0;try{u=o.c(n).documentElement}catch(e){throw new Error("Generated filter was not valid XML!")}i.parentNode.replaceChild(u,i);e.setIsDirty(!0,r.e.filters)}else e.addFilters([n])}function l(e,t){var n=d(e,t);if(n){var i=n.parentNode;if("Where"===i.tagName)e.clearFilters();else{i.removeChild(n);"Or"!==i.tagName&&"And"!==i.tagName||i.parentNode.replaceChild(i.firstElementChild,i);e.setIsDirty(!0,r.e.filters)}}}function c(e){var t=e.getDomParts();if(t&&t.where){var n=t.where.querySelectorAll("[id]"),r=[];if(n)for(var s=0;s<n.length;s++){var o=i.e(n[s]);o&&r.push.apply(r,o)}return r}}function h(e){var t=c(e);if(t)for(var n=0,r=t;n<r.length;n++){l(e,r[n].id)}}function p(e,t){var n=e,r=c(t);r&&r.length>0&&r.forEach(function(e){n=Object(u.updateFilterInfoInQueryString)(n,{filterField:e.fieldName,filterValues:e.values,filterType:e.type,useLookupId:e.lookupId})});return n}function d(e,t){var n=e.getDomParts();if(n&&n.where){var r=n.where.querySelectorAll('[id="'+t+'"]');if(r.length>1)throw new Error("More than one filter found with id "+t);return r[0]}}},2163:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r,i=n(0),s=n(289),o=n(1004),u=n(52),a=n(72);(function(e){e[e.lightBlue=0]="lightBlue";e[e.blue=1]="blue";e[e.darkBlue=2]="darkBlue";e[e.teal=3]="teal";e[e.lightGreen=4]="lightGreen";e[e.green=5]="green";e[e.darkGreen=6]="darkGreen";e[e.lightPink=7]="lightPink";e[e.pink=8]="pink";e[e.magenta=9]="magenta";e[e.purple=10]="purple";e[e.black=11]="black";e[e.orange=12]="orange";e[e.red=13]="red";e[e.darkRed=14]="darkRed"})(r||(r={}));var f=["#0078d7","#088272","#107c10","#881798","#b4009e","#e81123","#da3b01","#006f94","#005e50","#004e8c","#a80000","#4e257f"],l=(function(e){Object(i.__extends)(t,e);function t(t){return e.call(this,{dataSourceName:"SiteHeaderLogoAcronym",id:"acronymAndColors"},{pageContext:t})||this}t.decodeAcronymColor=function(e){return f.indexOf(e)+1};t.prototype.getAcronymData=function(e){return this.getAcronyms([e]).then(function(e){return e[0]},function(){return{acronym:void 0,color:void 0,text:void 0}})};t.prototype.getAcronyms=function(e,t){var n=this;void 0===t&&(t={});if(this._pageContext.webServerRelativeUrl){var r=t.qosName,i=void 0===r?"GetSiteHeaderLogoAcronym":r;return this.getDataUtilizingPersistentCache({getUrl:function(){var t=e.map(function(e){return"{Text: "+a.e.encodeURIComponent('"'+e+'"')+"}"}).join(",");return Object(s.n)(n._pageContext)+"/_api/sphome/GetAcronymsAndColors?labels=["+t+"]"},parseResponse:function(e){return JSON.parse(e).d.GetAcronymsAndColors.results.map(function(e){return{acronym:e.Acronym,color:e.Color,text:e.Text}})},method:"GET",qosName:i})}return u.n.reject(new Error("No web URL specified for request."))};return t})(o.e);t.t=l},2268:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(1004),s=n(289),o=n(52),u=n(66),a=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,{dataSourceName:"SiteDataSource",id:"SiteDataSource("+(t?t.siteId:"")+")"},{pageContext:t})||this;r.getOAuthToken=n;return r}t.prototype.getReadOnlyState=function(){var e=this,t=this.getFullSiteReadOnlyState();return-2===t?this.getDataUtilizingPersistentCache({getUrl:function(){return Object(s.n)(e._pageContext)+"/_api/Site/ReadOnly"},parseResponse:function(e){var t=JSON.parse(e);return t&&t.d&&t.d.ReadOnly},qosName:"SiteReadOnly",method:"GET",noRedirect:!0}):o.n.resolve(-1!==t)};t.prototype.getFullSiteReadOnlyState=function(){return void 0===this._pageContext.readOnlyState?-2:null===this._pageContext.readOnlyState?-1:this._pageContext.readOnlyState};t.prototype.getStatusBarInfo=function(){var e=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return Object(s.n)(e._pageContext)+"/_api/Site?$select=StatusBarLink,StatusBarText"},parseResponse:function(e){var t=JSON.parse(e);if(!t||!t.d)return{StatusBarText:void 0,StatusBarLinkText:void 0,StatusBarLinkTarget:void 0};var n=t.d.StatusBarLink,r=void 0,i=void 0;if(n){var s=n.split("|");r=s[0];var o=1===s.length?s[0]:s[1];if(0===o.lastIndexOf("http",0)){var a=new u.t(o);i=encodeURI(a.toString())}}return{StatusBarText:t.d.StatusBarText,StatusBarLinkText:r,StatusBarLinkTarget:i}},qosName:"SiteStatusBar",method:"GET",noRedirect:!0})};t.prototype.setClassificationProperty=function(e){var t=Object(s.n)(this._pageContext)+"/_api/Site",n=JSON.stringify({__metadata:{type:"SP.Site"},Classification:e});return this.dataRequestor.getData({url:t,qosName:"SetClassificationProperty",additionalPostData:n,method:"PATCH"})};t.prototype.setClassificationPropertyAndId=function(e,t){var n=Object(s.n)(this._pageContext)+"/_api/Site",r=JSON.stringify({__metadata:{type:"SP.Site"},Classification:e,SensitivityLabelId:t});return this.dataRequestor.getData({url:n,qosName:"SetClassificationProperty",additionalPostData:r,method:"PATCH"})};t.prototype.getCanSyncHubSitePermissionsProperty=function(e){var t=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return Object(s.n)(t._pageContext)+"/_api/Site/CanSyncHubSitePermissions"},parseResponse:function(e){var t=JSON.parse(e);return t&&t.d&&t.d.CanSyncHubSitePermissions},qosName:"GetCanSyncHubSitePermissionsProperty",method:"GET",cachingStrategy:e?3:0,noRedirect:!0})};t.prototype.SyncTeamSiteSettings=function(){var e=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return e._pageContext.webAbsoluteUrl+"/_api/sp.TeamChannelManager.SyncTeamSiteSettings"},qosName:"SyncTeamSiteSettings",method:"POST",noRedirect:!0,cachingStrategy:3})};t.prototype.GetTeamSiteData=function(){return this.getDataUtilizingPersistentCache({url:this._pageContext.webAbsoluteUrl+"/_api/sp.TeamChannelManager.GetTeamSiteData",qosName:"GetTeamSiteData",parseResponse:function(e){var t;return null===(t=JSON.parse(e))||void 0===t?void 0:t.d},cachingStrategy:0,cacheRequestKey:""+this._pageContext.relatedGroupId,method:"POST",noRedirect:!0})};t.prototype.setCanSyncHubSitePermissionsProperty=function(e){var t=Object(s.n)(this._pageContext)+"/_api/Site",n=JSON.stringify({__metadata:{type:"SP.Site"},CanSyncHubSitePermissions:e});return this.dataRequestor.getData({url:t,qosName:"SetCanSyncHubSitePermissionsProperty",additionalPostData:n,method:"PATCH",noRedirect:!0})};t.prototype.isSiteFeatureEnabled=function(e,t){var n=this,r=t||Object(s.n)(this._pageContext),i=r+"/_api/site/Features/GetById('"+e.toString()+"')";return this.getOAuthToken(r).then(function(e){return n.dataRequestor.getData({url:i,qosName:"GetSPSiteFeatureEnabled",method:"GET",authToken:null!=e?e:void 0,parseResponse:function(e){try{var t=JSON.parse(e);if(t&&t.d&&t.d.DefinitionId)return!0}catch(e){return!1}return!1}})})};return t})(i.t);t.t=a},2298:function(e,t,n){"use strict";var r;(function(e){e[e.specificPeople=0]="specificPeople";e[e.organization=1]="organization";e[e.anyone=2]="anyone";e[e.existing=3]="existing";e[e.specificPeopleFlex=4]="specificPeopleFlex";e[e.customLabeledSpecificPeople=5]="customLabeledSpecificPeople"})(r||(r={}));t.e=r},2366:function(e,t,n){"use strict";var r=n(476),i=(function(){function e(e){this._itemUrlHelper=e.itemUrlHelper;this._sharingContextInformation=e.sharingContextInformation}e.prototype.getApiRoot=function(e,t,n){if(this._sharingContextInformation){var i=this._sharingContextInformation,s=i.isFolder,o=i.isListSharing,u=i.itemUrl,a=i.listId,f=i.listItemId,l=i.listUrl,c=i.resourceId,h=i.serverRelativeItemUrl,p=i.uniqueId,d=i.webAbsoluteUrl;if(o)return e.build().webByUrl({webUrl:d}).method("Lists",a);if(p){if(a)return e.build().webByUrl({webUrl:d}).segment("lists").method("getbyid",a).method("GetItemByUniqueId",p);var v=s?"GetFolderById":"GetFileById",m={guid:p};return e.build().webByUrl({webUrl:d}).method(v,m).segment("ListItemAllFields")}return l?e.build().webByUrl({listUrl:l}).method("GetListItem",h):u?e.build().webByUrl({webUrl:d}).method("GetFileByUrl",r.t(u)).segment("ListItemAllFields"):a&&f?e.build().webByUrl({webUrl:d}).method("Lists",a).method("GetItemById",f):e.build().webByUrl({webUrl:d}).method("GetListItemByResourceId",c)}var g;g=t.properties.path?this._itemUrlHelper.getUrlParts({path:t.properties.path}):this._itemUrlHelper.getItemUrlParts(t.key);var y=e.build().webByItemUrl(g).method("Lists",n);t.isRootFolder||(y=t.properties.ID?y.method("GetItemById",t.properties.ID):y.method("GetItemByUniqueId",t.properties.uniqueId));return y};e.prototype.getFileUrl=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl};e.prototype.canUseSecurable=function(e){var t=e.properties;return!!t&&(e.isRootFolder?!!e.list&&!!e.list.id:!!t.ID||!!t.uniqueId)};e.getUniqueSharingPrincipals=function(e){if(e){var t=new Set;return e.filter(function(e){if(t.has(e.loginName))return!1;t.add(e.loginName);return!0})}};return e})();t.e=i},2367:function(e,t,n){"use strict";var r;(function(e){e[e.share=1]="share";e[e.copy=2]="copy";e[e.atMention=3]="atMention";e[e.linkSettings=4]="linkSettings";e[e.manageAccess=5]="manageAccess";e[e.notify=6]="notify";e[e.addPeople=7]="addPeople"})(r||(r={}));t.e=r},2429:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.none=0]="none";e[e.view=1]="view";e[e.edit=2]="edit";e[e.owner=3]="owner";e[e.review=6]="review";e[e.restrictedview=7]="restrictedview";e[e.submit=8]="submit";e[e.manageList=9]="manageList"})(r||(r={}))},2496:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(220),i=n(197),s=n(52),o=n(1746),u={enqueue:function(e){return e()}},a=(function(){function e(e){void 0===e&&(e={});this.async=new r.e;this.uploaderCount=0;this.throttledSignals=[];var t=e.maxParallelUploads,n=void 0===t?3:t,i=e.maxUploadsPerSecond,s=void 0===i?8:i,a=e.throttleBarrier,f=void 0===a?1e3:a;this.uploadQueue=n===1/0?u:new o.e(n);this.maxUploads=s;this.throttleBarrier=f}e.prototype.throttle=function(e){var t=this;return this.uploadQueue.enqueue(function(){if(!t.isReady&&t.uploaderCount>=t.throttleBarrier){t.uploaderCount=0;t.isReady=!0}if(t.batchStartTime&&t.uploaderCount>=t.maxUploads)return t.throttleUploader(e);t.isReady&&!t.batchStartTime&&(t.batchStartTime=Date.now());return t.startUploader(e)})};e.prototype.addThrottleTimer=function(e){this.isReady=!0;this.setTimeout(e);return this.addUploaderCallback(function(){return s.n.resolve()})};e.prototype.dispose=function(){if(this.timeout){this.async.clearTimeout(this.timeout);this.timeout=void 0}this.async.dispose()};e.prototype.startUploader=function(e){this.uploaderCount+=1;return e()};e.prototype.addUploaderCallback=function(e){var t=this,n=new i.e;this.throttledSignals.push(n);return n.getPromise().then(function(){return t.startUploader(e)})};e.prototype.throttleUploader=function(e){if(this.timeout)return this.addUploaderCallback(e);var t=1e3-(Date.now()-this.batchStartTime);if(t>0){this.setTimeout(t);return this.addUploaderCallback(e)}this.uploaderCount=0;this.batchStartTime=Date.now();return this.startUploader(e)};e.prototype.setTimeout=function(e){var t=this;if(this.timeout){this.async.clearTimeout(this.timeout);this.timeout=void 0}this.timeout=this.async.setTimeout(function(){t.timeout=void 0;t.uploaderCount=0;t.batchStartTime=Date.now();for(var e=0,n=t.throttledSignals;e<n.length;e++){n[e].complete()}t.throttledSignals=[]},e)};return e})()},2537:function(e,t,n){"use strict";n.d(t,"e",function(){return M});var r,i=n(0),s=n(125),o=n(220),u=n(197),a=n(52),f=n(70),l=n(730),c=n(109),h=n(48),p=n(184),d=n(2105),v=n(1777),m=n(53),g=n(2015),y=n(239),b=n(343),w=(function(e){Object(i.__extends)(t,e);function t(n){var r=e.call(this,n)||this;r.name="FileHasherError";r.__proto__=t.prototype;return r}return t})(Error),E="UNKNOWN_UPLOAD_ERROR",S="UPLOAD_TIMEOUT_ERROR",x="UPLOAD_TOO_SLOW_ERROR";(function(e){e[e.singleChunk=0]="singleChunk";e[e.start=1]="start";e[e.continue=2]="continue";e[e.startFinish=3]="startFinish";e[e.finish=4]="finish";e[e.status=5]="status";e[e.cancel=6]="cancel"})(r||(r={}));var T=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,Object(i.__assign)(Object(i.__assign)({},t),{extraData:Object(i.__assign)(Object(i.__assign)({},t.extraData||{}),"number"==typeof t.statusCode?{status:t.statusCode}:{})}))||this;n.errorType=t.errorType;n.displayString=t.displayString;try{n.serverError=JSON.stringify(t.serverError)}catch(e){n.serverError=""}return n}return t})(m.e);function N(e){if(e&&e.code){return e.code.split(",")[0]||e.code}return e&&e.number?""+e.number:E}function C(e,t){return 404===e&&(t===r.start||t===r.startFinish||t===r.singleChunk)}function k(e,t){if(!e)return new T({errorType:v.e.general,code:"Unknown",statusCode:0,message:"Unknown upload error",serverError:e});var n,r,i=!1,s=N(e);(e instanceof y.e||e instanceof Error&&"GetDataError"===e.name)&&(e=e.errorData);if("string"==typeof e)n=e;else{var o=e.message;if("string"==typeof o)n=o;else if(o&&o.value){n=o.value;i=!0}}r=s===b.r?v.e.disconnected:"-2130575257"===s?v.e.conflict:"-2130245249"===s?v.e.similarNameExists:s===S?v.e.general:"-2147024891"===s?v.e.accessDenied:C(e.status,t)?v.e.targetFolderMissing:i?v.e.other:v.e.general;return new T({errorType:r,code:s,statusCode:e.status,displayString:i?n:"",message:n||"Unhandled client error",correlationId:e.correlationId,serverError:e})}var L="ServerRelativeUrl,UniqueId,Name,VroomItemID,VroomDriveID,ServerRedirectedUrl",A=!f.t.isActivated("B1726BAE-6860-4FE3-937B-2A8768F26044","01/08/2021","Include the full server response for errors without status codes"),O=!f.t.isActivated("D5DDFDFE-0CAB-48F0-8407-1BC0A5595ACE","06/21/2021","Handle throttled failures for streaming uploads"),M=(function(){function e(e){var t=e.hasher,n=e.throttler,r=e.dataRequestor,i=e.appName,u=e.webApiUrl,a=e.authToken,f=e.canStream,l=e.fileUpload,h=e.itemExpansion,p=e.destinationUrl,d=e.combineStartFinish,v=e.qosEvent,m=void 0===v?c.e:v,g=e.nameConflictBehavior,y=void 0===g?0:g,b=e.onStart,w=e.onAbort,E=e.onProgress;this._hasher=t;this._dataRequestor=r;this._throttler=n;this._chunkNumber=0;this._uploadedBytes=0;this._qosEvent=m;this._id=s.e.generate();this._authToken=a;this._canStream=f;this._webApiUrl=u;this._fileUpload=l;this._async=new o.e(this);this._itemExpansion=h;this._destinationUrl=p;this._combineStartFinish=d;this._nameConflictBehavior=y;this._chunkSize=Math.min(l.size,262144e3);this._trackingHeaders={Application:i,Scenario:"UploadFile",ScenarioType:"AUO"};this._onStart=b;this._onAbort=w;this._onProgress=E}e.prototype.upload=function(){var e=this,t=this._throttler.throttle(function(){var t=e._id,n=e._fileUpload.size,r=e._canStream&&n>25165824,s={fileUploadId:t,fileSize:n},o=new e._qosEvent({name:"Upload.h5",extraData:s}),u=r?"SharePointUploader.stream":"SharePointUploader.create",f=new e._qosEvent({name:u,extraData:s}),c=new d.e({scenario:"SharePointUpload",extraData:s});e._fileName=e._fileUpload.name;e._onStart&&e._onStart();return e.start(r).then(function(e){o.end({resultType:h.e.Success});f.end({resultType:h.e.Success});c.end({resultType:h.e.Success});return e},function(t){if(a.n.isCanceled(t)){o.end({resultType:h.e.ExpectedFailure,resultCode:"Aborted"});f.end({resultType:h.e.ExpectedFailure,resultCode:"Aborted"});c.end({resultType:h.e.ExpectedFailure,errorCode:"Aborted"});e._onAbort&&e._onAbort();return a.n.reject(t)}var n=(function(e){return e instanceof T?e:new T(e instanceof w?{errorType:v.e.other,code:"FileHasher",statusCode:0,innerError:e}:{errorType:v.e.general,code:"Unknown",statusCode:0,innerError:e})})(t),r=(function(e){return new g.e({message:e.displayString,errorType:e.errorType,innerError:e,supportsVersioning:!0})})(n),s=(function(e){switch(e.errorType){case v.e.disconnected:case v.e.conflict:case v.e.similarNameExists:case v.e.targetFolderMissing:return!0}switch(e.code){case"-2147023080":case"-2130575245":case b.r:case b.n:case b.i:case S:case"-2130245249":return!0}return!1})(n)?h.e.ExpectedFailure:h.e.Failure;o.end(Object(l.e)(Object(p.e)(r),{resultType:s,resultCode:v.e[r.errorType]}));var u=A&&!n.extraData.status&&n.serverError,d=Object(l.e)(Object(p.e)(n),{resultType:s,extraData:Object(i.__assign)(Object(i.__assign)({},u?{serverError:u}:{}),{uploadedBytes:e._uploadedBytes})});f.end(d);var m=d.extraData,y=d.resultCode;c.end({resultType:s,extraData:m,errorCode:y});return a.n.reject(r)})});this._uploadPromise=t;return t};e.prototype.abort=function(){var e=this,t=this._uploadPromise;this._uploadPromise=void 0;if(!this._hasCompleted&&t){t.cancel();t.then(function(){},function(){}).done(function(){e._hasher&&e._hasher.dispose();return e.cancelUpload()})}};e.prototype.restart=function(e){var t=e.nameConflictBehavior,n=void 0===t?this._nameConflictBehavior:t;this._nameConflictBehavior=n;var r=this._uploadPromise;this._uploadPromise=void 0;r&&r.cancel();this._hasher&&this._hasher.reset();return this.upload()};e.prototype.dispose=function(){this._async.dispose();this._hasher&&this._hasher.dispose()};e.prototype.start=function(e){var t=this;this._uploadedBytes=0;var n=this._fileUpload.size;return(e?this.streamFile():this.uploadFile()).then(function(e){t.updateProgress(n);return e})};e.prototype.updateProgress=function(e){if(this._uploadedBytes!==e){this._uploadedBytes=e;this._onProgress&&this._onProgress(e)}};e.prototype.getUploadUrl=function(e){var t=this._webApiUrl;t=(t=t.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:this._destinationUrl})).segment("Files");var n={};n.DecodedUrl=this._fileName;1===this._nameConflictBehavior||3===this._nameConflictBehavior?n.overwrite=!0:2===this._nameConflictBehavior&&(n.EnsureUniqueFileName=!0);n.AutoCheckoutOnInvalidData=!0;e&&(n.XorHash=e);t=t.methodWithAliases("AddUsingPath",n).oDataParameter("$Select",L);this._itemExpansion&&(t=t.oDataParameter("$Expand",this._itemExpansion));return t.toString()};e.prototype.uploadFile=function(e){var t=this;void 0===e&&(e=3);var n=this._fileUpload.slice(0,this._fileUpload.size);return(this._hasher&&!this._hasher.hasFullHash()?this._hasher.computeHash(n,0,n.size):a.n.resolve()).then(function(){var i=t._hasher?t._hasher.getFullHash(n.size):void 0;return t.uploadChunk({trackSpeed:!1,url:t.getUploadUrl(i),qosName:"SharePointUploader.UploadFile",data:n,offset:0,length:n.size}).then(function(e){return t.parseItemResponse(e)}).catch(function(n){if(a.n.isCanceled(n))return a.n.wrapError(n);if(n&&n.retryAfter&&e>0){var i=1e3*n.retryAfter;return t._throttler.addThrottleTimer(i).then(function(){t._uploadedBytes=0;return t.uploadFile(e-1)})}return a.n.wrapError(k(n,r.singleChunk))})})};e.prototype.getUploadStage=function(e){var t,n=this._fileUpload.size,i="SharePointUploader.",s=Math.min(this._chunkSize+e,n);if(0===this._chunkNumber)if(this._combineStartFinish&&n<=s){i+="StartFinish";t=r.startFinish}else{s=0;i+="Start";t=r.start}else if(n<=s){i+="Finish";t=r.finish}else{i+="Continue";t=r.continue}return{endByte:s,qosName:i,uploadStage:t}};e.prototype.getStreamingUrl=function(e,t,n){var i,s=this._webApiUrl,o=this._fileName,u={uploadId:{guid:this._requestId}};i=t===r.start?"StartUploadFile":t===r.startFinish?"Upload":t===r.continue?"ContinueUpload":this._hasher?"FinishUploadWithChecksum":"FinishUpload";if(t===r.start||t===r.startFinish){s=(s=s.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:this._destinationUrl})).segment("Files");s=1===this._nameConflictBehavior||3===this._nameConflictBehavior?s.methodWithAliases("GetByPathOrAddStub",{DecodedUrl:o}):2===this._nameConflictBehavior?s.methodWithAliases("AddStubUsingPath",{DecodedUrl:o,EnsureUniqueFileName:!0}):s.methodWithAliases("AddStubUsingPath",{DecodedUrl:o})}if(t===r.continue||t===r.finish){s=s.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:this._destinationUrl+"/"+o});u.fileOffset=e;n&&t===r.finish&&(u.checksum=n)}s=s.methodWithAliases(i,u);if(t===r.finish||t===r.startFinish){s=s.oDataParameter("$Select",L);this._itemExpansion&&(s=s.oDataParameter("$Expand",this._itemExpansion))}return s.toString()};e.prototype.streamFile=function(e,t){var n=this;void 0===e&&(e=0);void 0===t&&(t=3);this._requestId||(this._requestId=s.e.generate());var i=this.getUploadStage(e),o=i.endByte,f=i.qosName,l=i.uploadStage,c=this._fileUpload.slice(e,o),h=this._fileUpload.size,p=l===r.finish,d=this._hasher&&l!==r.start&&!this._hasher.hasFullHash()&&this._hasher?this._hasher.computeHash(c,e,o):a.n.resolve();return(p?d:a.n.resolve()).then(function(){var i=void 0;n._hasher&&p&&(i=n._hasher.getFullHash(h));return n.uploadChunk({trackSpeed:!0,url:n.getStreamingUrl(e,l,i),qosName:f,data:c,offset:e,length:c.size}).then(function(e){n.updateProgress(o);var i=n.parseItemResponse(e);l===r.start&&2==n._nameConflictBehavior&&i.Name&&(n._fileName=i.Name);if(o<h){n._chunkNumber++;return d.then(function(){return n.streamFile(o,t)})}return i},function(i){if(a.n.isCanceled(i)){l!==r.start&&n.cancelUpload();return a.n.reject(i)}if(O&&i&&i.retryAfter&&t>0){var s=1e3*i.retryAfter;return n._throttler.addThrottleTimer(s).then(function(){return n.streamFile(e,t-1)})}if((f=N(o=i))===x||f===S||o&&0===o.status){if(n._chunkSize<=1048576){n.cancelUpload();return a.n.reject(k(i,l))}n._chunkSize=Math.floor(n._chunkSize/2);return n.streamFile(e,t)}var o,f;if(t>0&&(function(e,t){if(429===e.status)return!1;if(C(e.status,t))return!1;switch(N(e)){case b.i:case"-1":case"-2130575257":case"-2130245249":case"-2130575142":case"-2130209002":case"-2130209003":case"-2147023080":case"-2130575245":case"-2147024891":return!1;default:return!0}})(i,l)){var c,h=new u.e(function(){c&&n._async.clearTimeout(c)});c=n._async.setTimeout(function(){return h.complete()},1e3);return h.getPromise().then(function(){return n.getUploadStatus().then(function(e){e>0&&!n._chunkNumber&&(n._chunkNumber=1);return n.streamFile(e,t-1)},function(){return n.streamFile(e,t-1)})})}(function(e,t){if(t===r.startFinish){switch(N(e)){case"-2130575257":case"-2130245249":case"-2147024891":case"-2130575245":return!1;default:return!0}}return t!==r.start})(i,l)&&n.cancelUpload();return a.n.reject(k(i,l))})},function(e){l!==r.start&&n.cancelUpload();return a.n.reject(e)})};e.prototype.getUploadStatus=function(){var e=this._webApiUrl.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:this._destinationUrl+"/"+this._fileName}).methodWithAliases("GetUploadStatus",{uploadId:{guid:this._requestId}}).toString();return this._dataRequestor.getData({url:e,method:"GET",noRedirect:!0,authToken:this._authToken,qosName:"SharePointUploader.GetUploadStatus",additionalHeaders:this._trackingHeaders,qosExtraData:{fileUploadId:this._id},telemetryHandler:function(e){var t=e.eventData,n=e.response;if(t.resultType===h.e.Success){if(!n||!n.d||!n.d.ExpectedContentRange)return{eventData:Object(i.__assign)(Object(i.__assign)({},t),{resultCode:"NoContentRange",resultType:h.e.Failure})};var r=parseInt(n.d.ExpectedContentRange.split("-")[0],10);if(isNaN(r))return{eventData:Object(i.__assign)(Object(i.__assign)({},t),{resultCode:"NaNContentRange",resultType:h.e.Failure,error:n.d.ExpectedContentRange})}}return{eventData:t}}}).then(function(e){if(e.d&&e.d.ExpectedContentRange){var t=parseInt(e.d.ExpectedContentRange.split("-")[0],10);return isNaN(t)?a.n.reject(""):t}return a.n.reject("")})};e.prototype.cancelUpload=function(){if(!this._requestId)return a.n.resolve();var e=this._webApiUrl.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:this._destinationUrl+"/"+this._fileName}).methodWithAliases("CancelUpload",{uploadId:{guid:this._requestId}}).toString();this._requestId="";this._chunkNumber=0;return this._dataRequestor.getData({url:e,noRedirect:!0,authToken:this._authToken,qosName:"SharePointUploader.CancelUploadSession",additionalHeaders:this._trackingHeaders,qosExtraData:{fileUploadId:this._id}}).then(function(){})};e.prototype.uploadChunk=function(e){var t,n,r,i,s=this,o=e.url,a=e.qosName,f=e.data,l=e.offset,c=e.length,h=!1,p=new u.e(function(){h=!0;t.cancel()}),d=function(e){var t=s._chunkNumber>0&&l+c>=s._fileUpload.size?3e5:1e4,r=Math.min(Math.max(.08*e,t),2147483647);n&&s._async.clearTimeout(n);e&&(n=s._async.setTimeout(function(){p.error({code:""+S,message:""})},r))},v=Date.now(),m=Date.now(),g=0,y=0,b=0,w=this._async.debounce(function(e){e>s._uploadedBytes&&s.updateProgress(e)},100,{leading:!1});t=this._dataRequestor.getData({url:o,qosName:a,noRedirect:!0,authToken:this._authToken,additionalHeaders:this._trackingHeaders,qosExtraData:{fileUploadId:this._id,wasHashed:!!this._hasher},parseResponse:function(e){return e},contentType:"application/octet-stream",additionalPostData:f,onUploadProgress:function(e){if(e.lengthComputable){var t=Date.now();y+=(e.loaded-g)/(t-m);b++;r=e.loaded/(t-v);m=t;g=e.loaded;s._onProgress&&w(l+e.loaded);d(c-e.loaded)}}});d(c);e.trackSpeed&&(i=this._async.setInterval(function(){if(b){Date.now()-v+(c-g)/((y+r)/(b+1))>15e4&&g<c&&p.error({code:""+x,message:""})}},1e4));var E=function(){n&&s._async.clearTimeout(n);i&&s._async.clearInterval(i)},T=p.getPromise();t.done(function(e){p.complete(e)},function(e){h||p.error(e)});T.done(function(){return E()},function(){h||t.cancel();E()});return T};e.prototype.parseItemResponse=function(e){try{return JSON.parse(e).d}catch(e){}};return e})()},2654:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(356),s=n(52),o=n(289),u=n(1860),a=n(125),f=n(1004),l=n(70),c=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{dataSourceName:"UserExpirationDataSource",id:"UserExpirationDataSource"},{pageContext:t.pageContext})||this;n._dataRequestor=new i.t({qosName:"UserExpirationDataSource",pageContext:t.pageContext});var r=Object(o.n)(t.pageContext);n._getExpiringUsersUrl=r+"/_api/web/SiteUserInfoList/GetItems";n._setUserExpirationUrl=r+"/_api/web/SiteUsers/GetById(@a)";n._expireUserUrl=r+"/_api/web/SiteUsers/GetById(@a)/Expire";n._externalUserExpirationPolicyUrl=r+"/_api/Site/ExternalUserExpirationInDays";return n}t.prototype.setUserExpiration=function(e,t){var n=this;if(!e||e.length<1)return s.n.reject([!1]);if(e.length>1){var r=a.e.generate(),i="multipart/mixed; boundary=batch_"+r,o=[],f=[],l=[];e.forEach(function(e){o.push(n._setUserExpirationUrl+"?@a="+e.id);f.push(JSON.stringify({__metadata:{type:"SP.User"},Expiration:t?t.toISOString():""}));l.push("PATCH")});var c=this._dataRequestor.getData({url:u.t.getBatchOperationUrl(this._pageContext.webAbsoluteUrl),parseResponse:function(e){return e},qosName:"SetUserExpirations",additionalPostData:u.t.getBatchContentExtended(r,o,"PATCH",u.t.defaultBatchRequestPostData,f,u.t.defaultBatchAcceptData,l),method:"POST",contentType:i,noRedirect:!0,needsRequestDigest:!0});this.flushCache();return c.then(function(e){var t=u.t.processBatchResponse(e);return t.hasError?s.n.reject(t):t}).then(function(e){return e.items.map(function(){return!0})},function(e){return e.items.map(function(e){return!e.error})})}var h=this._setUserExpirationUrl+"?@a="+e[0].id,p={__metadata:{type:"SP.User"},Expiration:t?t.toISOString():""};this.flushCache();return this._dataRequestor.getData({url:h,parseResponse:function(e){return[!e]},qosName:"SetUserExpiration",additionalPostData:JSON.stringify(p),method:"POST",additionalHeaders:{"X-HTTP-Method":"PATCH"},noRedirect:!0,needsRequestDigest:!0})};t.prototype.expireUser=function(e){var t=this;if(!e||e.length<1)return s.n.reject([!1]);if(e.length>1){var n=a.e.generate(),r="multipart/mixed; boundary=batch_"+n,i=[],o=[];e.forEach(function(e){i.push(t._expireUserUrl+"?@a="+e.id);o.push("POST")});var f=this._dataRequestor.getData({url:u.t.getBatchOperationUrl(this._pageContext.webAbsoluteUrl),parseResponse:function(e){return e},qosName:"BatchExpireUser",additionalPostData:u.t.getBatchContentExtended(n,i,"POST",u.t.defaultBatchRequestPostData,[],u.t.defaultBatchAcceptData,o),method:"POST",contentType:r});this.flushCache();return f.then(function(e){var t=u.t.processBatchResponse(e);return t.hasError?s.n.reject(t):t}).then(function(e){return e.items.map(function(){return!0})},function(e){return e.items.map(function(e){return!e.error})})}var l=this._expireUserUrl+"?@a="+e[0].id;this.flushCache();return this._dataRequestor.getData({url:l,parseResponse:function(e){if(e){var t=JSON.parse(e);if(t&&t.d)return[!0]}return[!1]},qosName:"ExpireUser",method:"POST"})};t.prototype.getUsersWithExpirationsWithCache=function(e,t,n,r,i,s){var o=[];n&&o.push("$top="+n);r&&o.push("$skip="+r);e&&o.push("$orderby="+e+" "+(t?"asc":"desc"));i&&o.push("$filter="+i);o.push("$select=Title,ID,Name,UserExpiration,IsSiteAdmin,EMail");var u=this._getExpiringUsersUrl;o.length>0&&(u+="?"+o.join("&"));return this.getDataUtilizingPersistentCache({url:u,parseResponse:function(e){var t=JSON.parse(e);return t&&t.d&&t.d.results?t.d.results.map(function(e){return{id:e.ID,loginName:e.Name,email:e.EMail,expiration:new Date(e.UserExpiration),title:e.Title,isSiteAdmin:e.IsSiteAdmin}}):e},qosName:"GetUsersWithExpirations",additionalPostData:JSON.stringify({query:{__metadata:{type:"SP.CamlQuery"},ViewXml:"<View><Query><Where><IsNotNull><FieldRef Name='UserExpiration'/></IsNotNull></Where></Query></View>"}}),method:"POST",cachingStrategy:s})};t.prototype.getUsersWithExpirations=function(e,t,n,r,i){var s=this;return this.getUsersWithExpirationsWithCache(e,t,n,r,i,1).then(function(o){var u=s.hasSiteUsersExpiringSoon(o),a=s._pageContext.HasSiteUsersExpiringSoon===u;return l.t.isActivated("8A69325A-D039-420F-A576-FA103612FAD5","7/29/2021","Bypass cache to match pageContext expiringUser count")||0!==r||a?o:s.getUsersWithExpirationsWithCache(e,t,n,r,i,3)})};t.prototype.hasSiteUsersExpiringSoon=function(e){var t=new Date;t.setDate(t.getDate()+21);return e&&e.some(function(e){return e.expiration&&e.expiration<t})};t.prototype.getExternalUserExpirationPolicy=function(){return this._dataRequestor.getData({url:this._externalUserExpirationPolicyUrl,parseResponse:function(e){if(e){var t=JSON.parse(e);if(t&&t.d&&t.d.ExternalUserExpirationInDays)return t.d.ExternalUserExpirationInDays}return 0},qosName:"GetExternalUserExpirationPolicy",method:"GET",needsRequestDigest:!0})};return t})(f.t);t.t=c},2831:function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});var r=n(296),i=n(22);function s(e,t,n){var r=e.replace("&action=edit",""),i=n?"forms.officeppe.com":"forms.office.com",s="Action=Create&Host=OneDrive&XlWorkbookId="+encodeURIComponent(r)+"&Title="+encodeURIComponent(t);return"https://"+i+"/Pages/DesignPage.aspx?Action=Create&Fragment="+encodeURIComponent(s)}function o(e,t,n){var r=void 0;"string"==typeof e?0===(e=e.trim()).length?r=t.emptyNameError:/["\*:<>\?\/\\\|]/.test(e)&&(r=i.format(n?t.invalidNameError2:t.invalidNameError,e)):r=t.emptyNameError;return r}function u(e,t,n,i){var o="";null!==e&&""!==e&&(o=t===r.e.ExcelSurvey?e.replace("action=edit","action=formedit"):t===r.e.ExcelForm?s(e,n,i):e.replace("action=edit","action=editnew"));return o}},2942:function(e,t,n){"use strict";n.d(t,"t",function(){return v});n.d(t,"e",function(){return m});n.d(t,"n",function(){return g});var r,i,s=n(0);(function(e){e[e.ContextMenu=0]="ContextMenu";e[e.RibbonDocuments=1]="RibbonDocuments";e[e.RibbonList=2]="RibbonList"})(r||(r={}));(function(e){e[e.None=0]="None";e[e.List=1]="List";e[e.ContentType=2]="ContentType";e[e.ProgId=3]="ProgId";e[e.FileType=4]="FileType"})(i||(i={}));var o="ClientSideExtension.ListViewCommandSet",u="ClientSideExtension.ListViewCommandSet.ContextMenu",a="ClientSideExtension.ListViewCommandSet.CommandBar",f=n(62),l=n(28),c=n(2993),h=n(125),p=n(22),d=n(72);function v(e,t){var n=[],r=[],f=[];if("undefined"==typeof DOMParser)throw new Error("Cannot parse custom actions on this platform");for(var c=new DOMParser,d=function(e){var d=e.Location,v=e.RegistrationType;if(d&&0===d.lastIndexOf(o,0)){if(!v||v!==i.List)return"continue";var m=d===o,g=d===u||m,S=d===a||m,N={text:e.Title,isEnabled:function(){return T({registrationId:e.RegistrationId,registrationType:e.RegistrationType,requireSiteAdministrator:e.RequireSiteAdministrator,rights:e.Rights},t)},allowMultiSelect:!0,clientSideComponentId:e.ClientSideComponentId,clientSideComponentProperties:e.ClientSideComponentProperties};g&&f.push(N);S&&(t.isDocumentLibrary?n.push(Object(s.__assign)({},N)):r.push(Object(s.__assign)({},N)))}else{if(!y(e.UrlAction))return"continue";if(e.CommandUIExtension&&p.doesStringStartWith(e.Location,"CommandUI.Ribbon")&&e.UrlAction){var C=b(e,t,!0),k=b(e,t,!1),L=void 0;try{L=c.parseFromString(e.CommandUIExtension,l.t.doctype)}catch(e){}if(!L)return"continue";var A=L.getElementsByTagName("Tab");A&&0!==A.length||(A=L.getElementsByTagName("Group"));if(A&&A.length>0){var O=w(A,!0),M=w(A,!1),_={};if(O||M)for(var D=0,P=L.getElementsByTagName("CommandUIHandlers");D<P.length;D++)for(var H=P[D].firstElementChild;H;){_[H.getAttribute("Command")]=H.getAttribute("CommandAction");H=H.nextElementSibling}if(O){var B=E(O,_,e,C);n.push(B)}if(M){B=E(M,_,e,k);r.push(B)}}else{var j=L.getElementsByTagName("Button"),F=x(j,!0,e,C);F&&n.push(F);var I=x(j,!1,e,k);I&&r.push(I)}}else if("EditControlBlock"===e.Location&&e.Title){var q={text:e.Title,isEnabled:b(e,t),allowMultiSelect:!!e.CommandUIExtension&&!e.EnabledScript,action:e.UrlAction,clientSideComponentId:h.e.Empty,clientSideComponentProperties:""};f.push(q)}}},v=0,m=e;v<m.length;v++){d(m[v])}return{"Ribbon.Documents":n,"Ribbon.List":r,ContextMenu:f}}function m(e){return"children"in e}function g(e,t,n){var r=n.webAbsoluteUrl+"/",i=n.layoutsUrl+"/",s=""+r+i,o=n.siteAbsoluteUrl+"/",u=""+o+i,a="",f=n.listId,l=n.listUrl;0===e.toLowerCase().lastIndexOf("javascript:launchapp(",0)&&(f=f.replace(/{/g,"%7B").replace(/-/g,"%2D").replace(/}/g,"%7D"));a=e.replace(/{SiteUrl}/g,r).replace(/~site\//g,r).replace(/~layouts\//g,i).replace(/~siteLayouts\//g,s).replace(/~siteCollection\//g,o).replace(/~siteCollectionLayouts\//g,u).replace(/{ListId}/g,f).replace(/{SelectedListId}/g,f).replace(/{ListUrlDir}/g,l).replace(/{Source}/g,d.e.encodeURIComponent(window.location.href)).replace(/{ModernUX}/g,"true");if(t.length>0){var c=t.map(function(e){return e.id}).join(","),h=t[0].id,p=t[0].url;a=a.replace(/{ItemUrl}/g,d.e.encodeURIComponent(p)).replace(/{ItemId}/g,h).replace(/{SelectedItemId}/g,c)}else a=a.replace(/{ItemUrl}/g,null).replace(/{ItemId}/g,null).replace(/{SelectedItemId}/g,null);return a}function y(e){return!e||("javascript:"!==e.substring(0,11).toLowerCase()||Object(c.t)(e,!1))}function b(e,t,n){var r=void 0===n||n===t.isDocumentLibrary;if(e.CommandUIExtension&&e.EnabledScript)return r||!0;var i=T({registrationId:e.RegistrationId,registrationType:e.RegistrationType,requireSiteAdministrator:e.RequireSiteAdministrator,rights:{High:Number(e.Rights.High),Low:Number(e.Rights.Low)}},t);return!!i&&("function"==typeof i?"function"==typeof r?function(e){return i(e)&&r}:i:r)}function w(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n],s=i.getAttribute("Id");if(!s)return i;if((t||!p.doesStringStartWith(s,"Ribbon.Documents"))&&!(t&&p.doesStringStartWith(s,"Ribbon.List")||p.doesStringStartWith(s,"Ribbon.Calendar")))return i}return null}function E(e,t,n,r){for(var i=[],s=e.getElementsByTagName("Button"),o=0,u=s.length;o<u;o++){var a=s[o],f=a.getAttribute("Command"),l=f&&t[f]||n.UrlAction;if(y(l)){var c={text:a.getAttribute("LabelText"),iconUrl:S(a),isEnabled:r,allowMultiSelect:!n.EnabledScript,action:l,clientSideComponentId:h.e.Empty,clientSideComponentProperties:""};i.push(c)}}return{text:e.getAttribute("Title"),tooltip:e.getAttribute("Description"),children:i}}function S(e){return e.getAttribute("Image32by32")||e.getAttribute("Image16by16")}function x(e,t,n,r){if("boolean"!=typeof r||r){var i;e&&e.length>0&&(i=w(e,t));if(i){var s=i.getAttribute("LabelText")||n.Title;if(s){var o={text:s,allowMultiSelect:!n.EnabledScript,action:n.UrlAction,isEnabled:r,clientSideComponentId:h.e.Empty,clientSideComponentProperties:""},u=S(e[0]);u&&(o.iconUrl=u);return o}}}}function T(e,t){var n=(function(e,t){return e.requireSiteAdministrator?t.currentUserIsSiteAdmin:function(t){return f.e.hasItemPermission(t,e.rights)}})(e,t),r=(function(e,t){var n=e.registrationType,r=e.registrationId;if(!r)return n===i.List;switch(n){case i.List:return parseInt(r,10)===t.listTemplate||r===t.listId;case i.FileType:var s="."+r;return function(e){return p.equalsCaseInsensitive(e.extension,s)};case i.ContentType:return function(e){var t="contentTypeId"in e&&e.contentTypeId||"properties"in e&&e.properties.ContentTypeId;return t&&p.doesStringStartWith(t,r)};case i.ProgId:return function(e){return("progId"in e&&e.progId||"properties"in e&&e.properties.ProgId)===r}}return!1})(e,t);return!(!n||!r)&&function(e){return!!e&&(!("function"==typeof n&&!n({permissions:e.permissions}))&&!("function"==typeof r&&!r(e)))}}},2978:function(e,t,n){"use strict";n.d(t,"e",function(){return T});n.d(t,"t",function(){return N});var r=n(0),i=n(2424),s=n(144),o=n(532),u=n(997),a=n(2429),f=n(2090),l=n(2298),c=n(2367),h=n(289),p=n(141),d=n(2366),v=n(164),m=n(1002),g=n(1854),y=n(249),b=n(70),w=n(1168),E=n(1965),S={ODB:1657},x=!b.t.isActivated("f8f5a253-cc95-4903-8f09-41053f644db1","10/13/2020","Deactivate Trackable Anyone Link, disable anyoneLinkAbility"),T=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===n&&(n={pageContext:t.pageContext});var r=e.call(this,{dataSourceName:"SharingDataSource"},n)||this;r._getParentListId=t.getParentListId;r._itemUrlHelper=t.itemUrlHelper||new s.e({},{pageContext:t.pageContext});r._apiUrlHelper=t.apiUrlHelper||new o.e({},{pageContext:t.pageContext,itemUrlHelper:r._itemUrlHelper});r._sharingContextInformation=t.sharingContextInformation||void 0;r._sharingDataSourceHelper=new d.e({itemUrlHelper:r._itemUrlHelper,sharingContextInformation:r._sharingContextInformation,isItemUrlEncoded:t.isItemUrlEncoded});var i=Object(h.n)(r._pageContext);r._shareUrl=i+"/_api/SP.Web.ShareObject";r._userPhotoUrlKSActivated=b.t.isActivated("d819fbd9-3200-4eab-aa09-689adffcf674","06/04/2021","Fixing UserPhotoUrl in iframe.");return r}t.parsePeople=function(e){return e.map(function(e){var n={role:t.parseSharingRole(e.CurrentRole),statusCode:Number(!e.Status),errorMessage:e.Message||null};return{name:e.DisplayName,email:e.Email,userId:e.UserId,sharingInfo:n}})};t.parseSharingRole=function(e){switch(e){case 0:return 5;case 1:return 1;case 2:return 2;case 6:return 6;default:return 1}};t.prototype.getSharingInformation=function(e,t,n,r,i,s){var o,u=this,a=(r=r||this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e))).segment("GetSharingInformation"),f="pickerSettings";t&&(f+=",permissionsInformation");n&&(f+=",sharingLinkTemplates");i&&(f+=",addressBarLinkSettings");o=a.oDataParameter("$Expand",f).toString();return this.getData(function(){return o},function(t){var n=JSON.parse(t);return u._parseGetSharingInformationResponse(n,e)},"GetSharingInformation",null,"POST",null,null,null,!0,void 0,void 0,this._getExtraData(),s)};t.prototype.emailWithoutPermissioning=function(e,n,r,i){var s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,n,this._getParentListId(n)).segment("ForwardObjectLink").toString();return this.getData(function(){return s},function(e){var r=JSON.parse(e).d,i=[];r.UniquelyPermissionedUsers&&r.UniquelyPermissionedUsers.results&&(i=r.UniquelyPermissionedUsers.results);var s=[];r.InvitedUsers&&r.InvitedUsers.results&&(s=r.InvitedUsers.results);var o={};o.statusCode=r.StatusCode;o.errorMessage=r.ErrorMessage;o.people=t.parsePeople(i);o.invitedUsers=t.parsePeople(s);o.itemId=n&&n.id;s.length>0&&(o.invitationLink=s[0].InvitationLink);o.invalidEmails=[];if(r.UsersWithInvalidEmails&&r.UsersWithInvalidEmails.results)for(var u=0,a=r.UsersWithInvalidEmails.results;u<a.length;u++){var f=a[u];o.invalidEmails.push(f.User)}return o},"ForwardObjectLink",function(){for(var t=[],n=0,s=e;n<s.length;n++){var o=s[n];t.push(o.rawPersonData)}var u={peoplePickerInput:JSON.stringify(t),emailBody:r,emailSubject:i};return JSON.stringify(u)})};t.prototype.checkPermissions=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("CheckPermissions").toString();return this.getData(function(){return n},function(e){var t=JSON.parse(e);if(t.d){return t.d.CheckPermissions.results}return null},"CheckPermissions",function(){var t={recipients:e};return JSON.stringify(t)})};t.prototype.share=function(e,n){var r,i=this,s=!!this._sharingContextInformation||this._sharingDataSourceHelper.canUseSecurable(n.items[0]);if(9===n.linkType||6===n.linkType||5===n.linkType)return this._shareLink(e,n);if(s){var o=n.items[0],u=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,o,this._getParentListId(o));r=u.segment("ShareObject").toString()}else r=this._shareUrl;return this.getData(function(){return r},function(e){var r=JSON.parse(e).d,i=[];r.UniquelyPermissionedUsers&&r.UniquelyPermissionedUsers.results&&(i=r.UniquelyPermissionedUsers.results);var s=[];r.InvitedUsers&&r.InvitedUsers.results&&(s=r.InvitedUsers.results);var o={};o.statusCode=r.StatusCode;o.errorMessage=r.ErrorMessage;o.people=t.parsePeople(i);o.invitedUsers=t.parsePeople(s);o.itemId=n.items[0]&&n.items[0].id;s.length>0&&(o.invitationLink=s[0].InvitationLink);o.invalidEmails=[];if(r.UsersWithInvalidEmails&&r.UsersWithInvalidEmails.results)for(var u=0,a=r.UsersWithInvalidEmails.results;u<a.length;u++){var f=a[u];o.invalidEmails.push(f.User)}return o},"Share",function(){for(var t=[],r=0;r<e.length;r++){var o=e[r];t.push(o.rawPersonData)}n.roleValue===2..toString()?n.roleValue=E.e:n.roleValue===1..toString()&&(n.roleValue=E.r);var u={peoplePickerInput:JSON.stringify(t),roleValue:n.roleValue,sendEmail:n.sendEmail,emailBody:n.message,emailSubject:n.subject,includeAnonymousLinkInEmail:!n.requireSignIn,propagateAcl:n.propagateSharing,useSimplifiedRoles:!0};s||(u.url=i._sharingDataSourceHelper.getFileUrl(n.items[0]));return JSON.stringify(u)})};t.prototype.updatePermissions2=function(e,t,n){var r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole}:null},"UpdatePermissions2",function(){var t;switch(n){case a.e.none:case a.e.view:case a.e.review:case a.e.edit:case a.e.owner:t=n;break;default:t=a.e.view}var r={userRoleAssignments:[{UserId:e.loginName,Role:t}],validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:!1,customMessage:null,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(r)})};t.prototype.updatePermissionsMultiple=function(e,t,n,r,i){var s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return s},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole,success:t.UpdateDocumentSharingInfo.results.map(function(e){return e.Status}).reduce(function(e,t){return e&&t},!0)}:null},"UpdatePermissionsMultiple",function(){var t;switch(n){case a.e.none:t=0;break;case a.e.view:t=1;break;case a.e.review:t=6;break;case a.e.edit:t=2;break;default:t=1}var s={userRoleAssignments:e.map(function(e){return{UserId:e.userId,Role:t}}),validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:r,customMessage:i,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(s)})};t.prototype.parseRawSharingInformation=function(e){return this._parseGetSharingInformationResponse(e,void 0)};t.prototype.unshareLink=function(e){var t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.item,this._getParentListId(e.item)).segment("UnshareLink").toString();return this.getData(function(){return t},function(e){return!!JSON.parse(e).d},"UnshareLink",function(){var t={linkKind:e.kind,shareId:e.shareId};return JSON.stringify(t)})};t.prototype.shareLink=function(e){var t=e.settings,n=e.items[0],r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.items[0],this._getParentListId(n)).segment("ShareLink").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e);return t.d?N(t):t.error?{error:5,errorMessage:t.error.message}:void 0},"ShareLink",function(){var n=null;t.expiration&&(n=Object(i.e)(t.expiration.toString()));var r=null;if(e.recipients&&e.recipients.length>0){r=[];for(var s=0,o=e.recipients;s<o.length;s++){var u=o[s];u.rawPersonData&&r.push(u.rawPersonData)}}var a=null;if(t.inviteesToRemove&&t.inviteesToRemove.length>0){a=[];for(var f=0,l=t.inviteesToRemove;f<l.length;f++){var c=l[f];a.push({id:c.id,loginName:c.loginName,name:c.primaryText,isExternal:c.isExternal,principalType:c.type,email:c.email})}}var h={request:{createLink:!!t.createLink,settings:{allowAnonymousAccess:t.allowAnonymousAccess,trackLinkUsers:t.trackLinkUsers,linkKind:t.sharingLinkKind,expiration:n,role:t.role,restrictShareMembership:t.restrictShareMembership,updatePassword:t.updatePassword,password:t.password,shareId:t.shareId,description:t.description,scope:t.scope}}};a&&(h.request.settings.inviteesToRemove={results:a});if(r&&r.length>0){h.request.peoplePickerInput=JSON.stringify(r);var p=e.emailData,d=e.emailSubject;void 0!==p&&void 0===d&&(h.request.emailData={body:e.emailData,subject:""});void 0===p&&void 0!==d&&(h.request.emailData={body:"",subject:e.emailSubject});void 0!==p&&void 0!==d&&(h.request.emailData={body:e.emailData,subject:e.emailSubject})}var v=e.settings.shareId;if(v){h.request.settings.shareId=v;h.request.emailData={body:""}}return JSON.stringify(h)},"POST",null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){var t="";try{t=JSON.stringify(e)}catch(e){}return{error:5,debugErrorMessage:t}})};t.prototype.setAddressBarLinkCapability=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e)).segment("SetAddressBarLinkCapability").toString();return this.getData(function(){return n},function(e){return!!JSON.parse(e).d},"SetAddressBarLinkCapability",function(){var e={enable:t};return JSON.stringify(e)})};t.prototype.shareLinkExpress=function(e,t,n){var r=this._apiUrlHelper.build().webByUrl({webUrl:this._pageContext.webAbsoluteUrl}).method("Lists",e).method("GetItemById",t).segment("ShareLinkExpress").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e);return t.d?C(t.d.ShareLinkExpress.sharingLinkInfo):t.error?{error:5,errorMessage:t.error.message}:void 0},"ShareLinkExpress",function(){var e={expressOption:n};return JSON.stringify(e)},"POST",null,null,null,!0,void 0,void 0,this._getExtraData()).catch(function(e){var t="";try{t=JSON.stringify(e)}catch(e){}return{error:5,debugErrorMessage:t}})};t.prototype.getClientId=function(){var e=Number(this._pageContext.webTemplate);if(Object(w.e)(this._pageContext))return f.e.sharePoint;switch(e){case v.t.teamSite:case v.t.group:case v.t.subgroup:case v.t.sitePagePublishing:return f.e.sharePoint;case v.t.mySite:return f.e.odb;default:return f.e.sharePoint}};t.prototype._shareLink=function(e,t){var n=this,r=t.items[0],s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,r,this._getParentListId(r)).segment("ShareLink").toString();return this.getData(function(){return s},function(n){return{statusCode:0,errorMessage:"",people:e,itemId:t.items[0].id}},"ShareLink",function(){for(var r=[],s=0,o=e;s<o.length;s++){var u=o[s];r.push(u.rawPersonData)}var a=null;t.expiration&&(a=Object(i.e)(t.expiration));var f={request:{peoplePickerInput:JSON.stringify(r),emailData:{body:t.message,subject:t.subject},linkKind:n._getSharingLinkKind(t.linkType,t.roleValue),createLink:!0,expiration:a}};return JSON.stringify(f)})};t.prototype._getSharingLinkKind=function(e,t){var n=1;6===e?n=5:5===e?n=4:9===e&&(n=t===2..toString()?3:2);return n};t.prototype._parseGetSharingInformationResponse=function(e,t){if(e.error)return{error:5,anonymousLinkExpirationRestrictionDays:void 0,anyoneLinkTrackUsers:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharedObjectType:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,userRole:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,outlookEndpointHostUrl:void 0,webUrl:void 0,userPhotoCdnBaseUrl:void 0};var n=e.d,r=!!n.permissionsInformation,i=!!n.sharingLinkTemplates,s=y.e.isFeatureEnabled(S)&&r,o=!!n.addressBarLinkSettings,u=r?this._parseSharingLinks(n.permissionsInformation.links.results,n.directUrl):[],a=i?this._parseSharingLinkTemplates(n.sharingLinkTemplates.templates.results):[],f=o?n.addressBarLinkSettings:null,c=[];if(r){var h=n.permissionsInformation.siteAdmins.results,d=n.permissionsInformation.principals.results,v=this._parseSharingPrincipals(h);v.forEach(function(e){return e.isSiteAdmin=!0});var m=this._parseSharingPrincipals(d);c=v.concat(m)}var g=this._getDefaultSharingLink(n.defaultLinkKind,u,n.sharingAbilities),w={name:this._sharingContextInformation?this._sharingContextInformation.itemName:void 0,childCount:this._sharingContextInformation?this._sharingContextInformation.itemCount:void 0,hasDlpPolicy:this._sharingContextInformation?this._sharingContextInformation.hasDlpPolicy:void 0,extension:this._sharingContextInformation&&this._sharingContextInformation.itemExtension?this._sharingContextInformation.itemExtension:n.fileExtension,appmap:this._sharingContextInformation?this._sharingContextInformation.itemAppmap:void 0,itemType:this._sharingContextInformation?this._sharingContextInformation.itemType:void 0};if(t){var E=t.properties,x=E.ItemChildCount?parseInt(E.ItemChildCount,10):0,T=E.FolderChildCount?parseInt(E.FolderChildCount,10):0,N=t.type===p.t.OneNote?0:x+T,C=this._isPolicyTipFlagSet(t.policyTip,4);w={name:t.name,childCount:N,hasDlpPolicy:C,extension:t.extension,appmap:t.appMap,itemType:t.type}}var k=n.canRequestAccessForGrantAccess||n.canAddInternalPrincipal||u.length>1;return{anonymousLinkExpirationRestrictionDays:0===n.anonymousLinkExpirationRestrictionDays?-1:n.anonymousLinkExpirationRestrictionDays,anyoneLinkTrackUsers:n.anyoneLinkTrackUsers,canAddExternalPrincipal:n.canAddExternalPrincipal,canAddInternalPrincipal:n.canAddInternalPrincipal,defaultShareLinkToExistingAccess:n.defaultShareLinkToExistingAccess,canManagePermissions:k,defaultSharingLink:g,fileExtension:n.fileExtension,sharedObjectType:n.sharedObjectType,hasInheritedLinks:!!s&&n.permissionsInformation.hasInheritedLinks,isShared:this._computeIsShared(u,c),item:w,sharingLinks:u,sharingPrincipals:c,peoplePickerSettings:n.pickerSettings,userDisplayName:this._pageContext.userDisplayName,blockPeoplePickerAndSharing:n.blockPeoplePickerAndSharing,requiresAccessApproval:!n.canAddInternalPrincipal&&n.canRequestAccessForGrantAccess,canRequestAccessForGrantAccess:n.canRequestAccessForGrantAccess,userRole:n.currentRole,defaultShareLinkPermission:n.defaultShareLinkPermission,sharingAbilities:n.sharingAbilities,defaultLinkKind:n.defaultLinkKind,directLink:{allowsAnonymousAccess:!1,audience:l.e.existing,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:1,url:n.directUrl,updatePassword:!1,password:"",passwordLastModifiedBy:null},hasPermissionsInformation:!!n.permissionsInformation,sharingLinkTemplates:a,addressBarLinkSettings:f,webTemplateId:n.webTemplateId,itemUniqueId:n.itemUniqueId,customizedExternalSharingServiceUrl:n.customizedExternalSharingServiceUrl||"",siteIBSegmentIDs:n.siteIBSegmentIDs?n.siteIBSegmentIDs.results:null,siteIBMode:b.t.isActivated("e5511a64-99f4-4992-ac8c-181c083a4d38","04/26/2021","Pass SiteIBMode to 3S.")?"":n.siteIBMode,enforceIBSegmentFiltering:!!n.enforceIBSegmentFiltering,enforceSPOSearch:!!n.enforceSPOSearch,outlookEndpointHostUrl:n.outlookEndpointHostUrl?n.outlookEndpointHostUrl:null,webUrl:n.webUrl?n.webUrl:null,isStubFile:!!n.isStubFile&&n.isStubFile,userPhotoCdnBaseUrl:n.userPhotoCdnBaseUrl}};t.prototype._computeIsShared=function(e,t){for(var n=!1,r=0,i=e;r<i.length;r++){var s=i[r];s.isActive&&1!==s.sharingLinkKind&&(n=!0)}n||(n=t.length>0);return n};t.prototype._parseSharingLinks=function(e,t){var n=this,r=(e=e.filter(function(e){return!e.isInherited})).map(function(e){var t,r=e.linkDetails;t=x&&void 0!==r.Scope&&-1!==r.Scope?L(r.LinkKind,r.Scope):k(r.LinkKind,r.AllowsAnonymousAccess,r.RestrictedShareMembership);return{allowsAnonymousAccess:r.AllowsAnonymousAccess,hasPassword:r.RequiresPassword,blockDownload:r.BlocksDownload,description:r.Description,audience:t,expiration:r.Expiration?new Date(r.Expiration):null,isActive:r.IsActive,isEdit:A(r.LinkKind)||r.IsEditLink,isReview:r.IsReviewLink,isManageList:r.IsManageListLink,principals:n._parseSharingPrincipals(e.linkMembers.results,r.LinkKind),invitees:n._parseLinkInvitees(r),shareId:r.ShareId,sharingLinkKind:r.LinkKind,url:r.Url,updatePassword:r.UpdatePassword,password:r.Password,passwordLastModifiedBy:n._parseSharingPrincipal(r.PasswordLastModifiedBy),isCreateOnlyLink:r.IsCreateOnlyLink,isAddressBarLink:r.IsAddressBarLink,isUnhealthy:r.IsUnhealthy,status:r.SharingLinkStatus,created:r.Created,trackLinkUsers:r.TrackLinkUsers}});(r=r.sort(function(e,t){return n._getLinkRanking(t)-n._getLinkRanking(e)})).push({allowsAnonymousAccess:!1,audience:l.e.specificPeople,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:1,url:t,updatePassword:!1,password:"",passwordLastModifiedBy:null});return r};t.prototype._getLinkRanking=function(e){var t=0;switch(e.audience){case l.e.anyone:t+=30;break;case l.e.organization:t+=20;break;case l.e.specificPeopleFlex:t+=10}e.isEdit?t+=3:e.isReview?t+=2:e.isEdit||e.isReview||e.blockDownload||(t+=1);return t};t.prototype._getSharingLinkTemplateRanking=function(e){var t=0;if(e&&e.linkDetails&&e.linkDetails.shareId){switch(e.scope){case 0:t+=30;break;case 1:t+=20;break;case 2:t+=10}switch(e.role){case a.e.edit:t+=3;break;case a.e.review:t+=2;break;case a.e.view:t+=1}}return t};t.prototype._parseSharingLinkTemplates=function(e){var t=this,n=e.map(function(e){var n,r=e.linkDetails;if(null!==r){var i=void 0;i=x&&void 0!==r.Scope&&-1!==r.Scope?L(r.LinkKind,r.Scope):k(r.LinkKind,r.AllowsAnonymousAccess,r.RestrictedShareMembership);n={allowsAnonymousAccess:r.AllowsAnonymousAccess,hasPassword:r.RequiresPassword,blockDownload:r.BlocksDownload,audience:i,expiration:r.Expiration?new Date(r.Expiration):null,description:r.Description,isActive:r.IsActive,isEdit:A(r.LinkKind)||r.IsEditLink,isReview:r.IsReviewLink,principals:void 0,invitees:t._parseLinkInvitees(r),shareId:r.ShareId,sharingLinkKind:r.LinkKind,url:r.Url,updatePassword:r.UpdatePassword,password:r.Password,passwordLastModifiedBy:t._parseSharingPrincipal(r.PasswordLastModifiedBy)}}return{linkDetails:n,passwordProtected:e.passwordProtected,role:e.role,scope:e.scope,shareKind:e.shareKind}});return n=n.sort(function(e,n){return t._getSharingLinkTemplateRanking(n)-t._getSharingLinkTemplateRanking(e)})};t.prototype._parseLinkInvitees=function(e){var t=this,n=e.Invitations;if(!n)return[];for(var r=[],i=0,s=n.results;i<s.length;i++){var o=s[i];o&&o.invitee&&r.push(o.invitee)}return r.map(function(e){return{id:e.id,email:e.email,primaryText:e.name,isExternal:e.isExternal,loginName:e.loginName,role:null,secondaryText:e.jobTitle,type:e.principalType,imageUrl:t._userPhotoUrlKSActivated?Object(m.getUserPhotoUrl)(n.email):Object(g.n)(t._pageContext.webAbsoluteUrl,n.email)}})};t.prototype._parseSharingPrincipals=function(e,t){var n=this,r=e.map(function(e){var r=e.principal;r||(r=e);var i={id:r.id,isExternal:r.isExternal,loginName:r.loginName,primaryText:r.name,role:e.role,secondaryText:r.jobTitle,type:r.principalType,imageUrl:n._userPhotoUrlKSActivated?Object(m.getUserPhotoUrl)(r.email):Object(g.n)(n._pageContext.webAbsoluteUrl,r.email),email:r.email};t&&(i.sharingLinkKind=t);return i});return d.e.getUniqueSharingPrincipals(r)};t.prototype._getExtraData=function(){var e;this._sharingContextInformation&&(e={clientId:this._sharingContextInformation.clientId,mode:c.e[this._sharingContextInformation.mode]});return e};t.prototype._parseSharingPrincipal=function(e){if(e){var t=e.principal;t||(t=e);return{id:t.id,isExternal:t.isExternal,loginName:t.loginName,primaryText:t.name,role:e.role,secondaryText:t.jobTitle,type:t.principalType,imageUrl:this._userPhotoUrlKSActivated?Object(m.getUserPhotoUrl)(t.email):Object(g.n)(this._pageContext.webAbsoluteUrl,t.email),email:t.email}}return null};t.prototype._getDefaultSharingLink=function(e,t,n){n.peopleSharingLinkAbilities&&(n.peopleSharingLinkAbilities.canManageEditLink.enabled||n.peopleSharingLinkAbilities.canManageReadLink.enabled)&&1===e&&(e=6);var r=e;if(x&&n.anyoneLinkAbilities){5!==r||n.anyoneLinkAbilities.canManageEditLink.enabled||(r=4);4!==r||n.anyoneLinkAbilities.canManageReadLink.enabled||(r=3)}else{5!==r||n.anonymousLinkAbilities.canManageEditLink.enabled||(r=4);4!==r||n.anonymousLinkAbilities.canManageReadLink.enabled||(r=3)}if(n.organizationLinkAbilities){3!==r||n.organizationLinkAbilities.canManageEditLink.enabled||(r=2);2!==r||n.organizationLinkAbilities.canManageReadLink.enabled||(r=1)}var i=void 0;5===e||4===e?i=l.e.anyone:3===e||2===e?i=l.e.organization:1===e?i=l.e.specificPeople:6===e&&(i=l.e.specificPeopleFlex);return{allowsAnonymousAccess:void 0,audience:i,expiration:void 0,description:void 0,isActive:!0,isEdit:void 0,principals:void 0,shareId:void 0,sharingLinkKind:r,url:void 0,invitees:void 0,updatePassword:!1,password:"",passwordLastModifiedBy:void 0}};t.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t};return t})(u.t);function N(e){if(e.d){return C(e.d.ShareLink.sharingLinkInfo)}}function C(e){var t;t=x&&void 0!==e.Scope&&-1!==e.Scope?L(e.LinkKind,e.Scope):k(e.LinkKind,e.AllowsAnonymousAccess,e.RestrictedShareMembership);var n=e.Expiration?new Date(e.Expiration):void 0;return{link:{allowsAnonymousAccess:e.AllowsAnonymousAccess,audience:t,expiration:n,description:e.Description,isActive:e.IsActive,isEdit:A(e.LinkKind)||e.IsEditLink,principals:null,invitees:null,hasPassword:e.RequiresPassword,shareId:e.ShareId,sharingLinkKind:e.LinkKind,url:e.Url,updatePassword:e.UpdatePassword,password:e.Password,passwordLastModifiedBy:e.PasswordLastModifiedBy,shareTokenString:e.ShareTokenString,isAddressBarLink:e.IsAddressBarLink,isUnhealthy:e.IsUnhealthy,status:e.SharingLinkStatus,created:e.Created}}}function k(e,t,n){return 5===e||4===e?l.e.anyone:3===e||2===e?l.e.organization:1===e?l.e.specificPeople:6===e?t?l.e.anyone:!1===n?l.e.organization:l.e.specificPeopleFlex:void 0}function L(e,t){return 5===e||4===e?l.e.anyone:3===e||2===e?l.e.organization:1===e?l.e.specificPeople:6===e?0==t?l.e.anyone:1===t?l.e.organization:l.e.specificPeopleFlex:void 0}function A(e){return 5===e||3===e||4!==e&&2!==e&&null}},2993:function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(52),i=n(72);function s(e,t){if(t)return!0;if("javascript:LaunchApp("===e.substring(0,21)&&");"===e.substring(e.length-2)){var n=u(e);try{JSON.parse(n);return!0}catch(e){return!1}}return!1}function o(e,t){var n=u(e);try{var s=JSON.parse(n);(function(e){var t=e.pageContext,n=e.appInstanceId,r=e.appOAuthId,s=e.launchUrl,o=e.isTenantApp,u=i.e.escapeUrlForCallback(t.webAbsoluteUrl),a=i.e.escapeUrlForCallback(t.layoutsUrl),f=u+"/"+a+"/appredirect.aspx";if(r&&s)f+="?client_id="+i.e.encodeURIComponent(r)+"&redirect_uri="+i.e.encodeURIComponent(s);else{if(!n)throw"appOAuthId, launchUrl, appInstanceId are null";f+="?instance_id="+i.e.encodeURIComponent(n)}o&&(f+="&tsapp=1");window.location.href=f})({pageContext:t,appInstanceId:s[0],appOAuthId:s[1],launchUrl:s[2],isTenantApp:s[4]});return r.n.wrap()}catch(e){return r.n.wrapError(e)}}function u(e){return e.replace("javascript:LaunchApp(","[").replace(");","]").replace(/'/g,'"').replace(/(width|height|title):/g,'"$1":')}},3247:function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){var t=e.serverRelativeItemUrl,n=e.dataRequestor,r=e.webApiUrl,i=e.duration,s=void 0===i?1:i,o=e.authToken,u=r;u=(u=u.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t})).method("GetPreAuthorizedAccessUrl",s);return n.getData({url:u.toString(),method:"GET",authToken:o,qosName:"ItemDataSource.getDownloadUrl"}).then(function(e){return e.d.GetPreAuthorizedAccessUrl})}},3446:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(7).t)("metadataSearchDataSource")},3560:function(e,t,n){"use strict";n.d(t,"e",function(){return w});var r=n(0),i=n(52),s=n(220),o=n(1746),u=n(197),a=n(125),f=n(72),l=n(141),c=n(618),h=n(70),p=n(1777),d=n(2015),v=n(156),m=n(326),g=(function(){function e(){var e=this.scope=new m.e;this._events=e.attach(new v.t(this))}e.prototype.start=function(){};e.prototype.abort=function(){};e.prototype.dispose=function(){this.scope.dispose()};e.prototype.updateState=function(e){if(e!==this.state){this.state=e;this._events.raise("upload_state_change",e)}};return e})(),y=new o.e(3),b=!h.t.isActivated("72E63389-0C1B-4876-8C80-5F244AD63320","10/15/2020","Restrict retries on streaming uploads"),w=(function(e){Object(r.__extends)(t,e);function t(t){var n=this,r=t.fileUpload;(n=e.call(this)||this)._fileUpload=r;n._authToken=t.authToken;n._uploadId=null;n._chunkNumber=0;n._streamingChunkNumber=0;n._currentChunkSize=8388608;n._currentStreamingChunkSize=262144e3;n._onProgress=t.onProgress;n._dataRequestor=t.dataRequestor;n._async=n.scope.attach(new s.e(n));n.totalBytes=r.size;n.uploadedBytes=0;n.fileName=r.name;n.iconName=t.iconName;n.state=0;n.error=null;n.nameConflictBehavior=0;n.allowRename=!1;n.supportsVersioning=!0;n._expandAllItemFields=t.expandAllItemFields;n._uniqueId=t.uniqueId;n._parentItemKey=t.parentItemKey;n._targetItemKey=t.targetItemKey;n._serverRelativeItemUrl=t.serverRelativeItemUrl;n._webApiUrl=t.webApiUrl;return n}t.prototype.start=function(){var e=this;this.updateState(0);var t=y.enqueue(function(){e.error=void 0;e.updateState(1);return e._upload().then(function(){e.updateState(2)},function(t){var n;n=t instanceof d.e?t:new d.e({message:t&&t.message||"",errorType:p.e.general});e.error=n;e.updateState(4);return i.n.reject(t)})});this._uploadPromise=t;return t};t.prototype.abort=function(){var e=this;if(2!==this.state){this.error=null;this.updateState(3);var t=this._uploadPromise;this._uploadPromise=void 0;if(t){t.cancel();t.then(function(){},function(){}).done(function(){return e._cancelChunkUpload()})}}};t.prototype.restart=function(){var e,t=this,n=this._uploadPromise;this._uploadPromise=void 0;if(n){n.cancel();e=n.catch(function(){return t._cancelChunkUpload().catch(function(){})})}else e=i.n.resolve();e.done(function(){t.start()})};t.prototype._upload=function(){var e,t=this;this.uploadedBytes=0;var n=this._fileUpload.size;if(n<=25165824)e=this._sendSingleRequestUpload();else{this._maxUploadRequestDuration=15e4;e=this._sendStreamingUpload()}return e.then(function(e){t.uploadedBytes=n;t.item=e})};t.prototype._createUploadError=function(e){var t,n,r,i;if("string"==typeof e)r=String(e);else{t=this._getErrorCode(e);n=e.status;r="string"==typeof e.message?String(e.message):e.message.value}switch(t){case-2130575257:i=p.e.conflict;break;case-1:i=p.e.disconnected;break;case-2130575245:i=p.e.invalidName;break;case-2130246326:i=p.e.versionMismatch;break;case-2147023080:case-2130575282:i=p.e.overQuota;break;default:switch(n){case 401:i=p.e.authFailure;break;case 404:i=p.e.targetFolderMissing;break;case 403:case 429:i=p.e.accessDenied;break;case 409:i=p.e.conflict;break;case 412:i=p.e.versionMismatch;break;case 415:i=p.e.emptyFileOrFolder;break;case 423:i=p.e.lockMismatch;break;case 507:i=p.e.overQuota;break;default:r?i||(i=p.e.other):i=p.e.general}}return new d.e({message:r,errorType:i,allowRename:this.allowRename,supportsVersioning:this.supportsVersioning})};t.prototype._getErrorCode=function(e){var t=e.code;return(void 0===t?"":t).split(",").map(function(e){return Number(e)})[0]};t.prototype._getUploadFileUrl=function(){var e=this._uniqueId,t=this._serverRelativeItemUrl,n=this._webApiUrl;n=e?n.method("GetFolderById",e):E(n,{serverRelativeItemUrl:t,isFolder:!0});var r=this._fileUpload.name,i=1===this.nameConflictBehavior;n=n.segment("Files").methodWithAliases("AddUsingPath",{DecodedUrl:r,overwrite:i,AutoCheckoutOnInvalidData:!0});var s="ListItemAllFields";this._expandAllItemFields&&(s+="/ContentType/Fields");s&&(n=n.oDataParameter("$Expand",s));return n.toString()};t.prototype._isConflictFile=function(){var e=this;if(1===this.nameConflictBehavior)return i.n.resolve(!1);var t=this._serverRelativeItemUrl,n=this._webApiUrl;n=(n=E(n,{serverRelativeItemUrl:t,isFolder:!0})).segment("Files").oDataParameter("$filter","Name eq '"+f.e.encodeRestUriStringToken(this._fileUpload.name)+"'");return this._dataRequestor.getData({noRedirect:!0,url:n.toString(),qosName:"SingleFileUploader.GetFile",authToken:this._authToken,parseResponse:function(t){var n=JSON.parse(t);return!!(n&&n.d&&n.d.results&&n.d.results.length>0)&&!(n.d.results[0].Exists&&e._streamingChunkNumber>0)}}).then(function(e){return e},function(e){return!!i.n.isCanceled(e)&&i.n.reject(e)})};t.prototype._processUploadCompleteResponse=function(e){return this._getItemFromResponse(e)};t.prototype._getItemFromResponse=function(e){var t;try{var n=JSON.parse(e).d,r=this._targetItemKey,i=void 0;n.ListItemAllFields&&n.ListItemAllFields.Id&&(i=String(n.ListItemAllFields.Id));var s=!1;if(n.ListItemAllFields&&n.ListItemAllFields.ContentType&&n.ListItemAllFields.ContentType.Fields&&n.ListItemAllFields.ContentType.Fields.results){var o=n.ListItemAllFields.ContentType.Fields.results.filter(function(e){return e.Required});if(o.length>0)for(var u=0,f=o;u<f.length;u++){var h=f[u];if(!n.ListItemAllFields[h.InternalName]){s=!0;break}}}var p=void 0;n.UniqueId&&(p=a.e.normalizeLower(n.UniqueId));var d=n.Name,v=c.t(d);t={key:r,parentKey:this._parentItemKey,type:l.t.File,id:n.ServerRelativeUrl,name:d,displayName:d,extension:v,properties:{ID:i,uniqueId:p},itemFromServer:n,hasMissingMetadata:s}}catch(e){}return t};t.prototype._generateChunkPostUrl=function(e,t){var n,i=this._fileUpload,s=this._uniqueId,o=i.size<=t,u=this._serverRelativeItemUrl,a=this._webApiUrl,f={uploadId:{guid:this._uploadId}};if(0===this._chunkNumber&&0===this._streamingChunkNumber){n="StartUpload";a=(a=s?a.method("GetFolderById",s):E(a,{serverRelativeItemUrl:u,isFolder:!0})).segment("Files");a=1===this.nameConflictBehavior?a.methodWithAliases("GetByPathOrAddStub",{DecodedUrl:i.name}):a.methodWithAliases("AddStubUsingPath",{DecodedUrl:i.name})}else{n=o?"FinishUpload":"ContinueUpload";a=E(a,{serverRelativeItemUrl:u+"/"+i.name,isFolder:!1});f=Object(r.__assign)(Object(r.__assign)({},f),{fileOffset:e})}return(a=a.methodWithAliases(n,f)).toString()};t.prototype._getUploadStatus=function(){var e=this._fileUpload,t=this._uploadId,n=this._serverRelativeItemUrl,r=this._webApiUrl;r=r.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:n+"/"+e.name}).methodWithAliases("GetUploadStatus",{uploadId:{guid:t}});return this._dataRequestor.getData({noRedirect:!0,url:r.toString(),authToken:this._authToken,qosName:"SingleFileUploader.GetUploadStatus",method:"GET"}).then(function(e){if(e.d&&e.d.ExpectedContentRange){return parseInt(e.d.ExpectedContentRange.split("-")[0],10)}return i.n.reject(new Error("No expected range from server response."))})};t.prototype._uploadFragment=function(e,t){var n=this;void 0===e&&(e=0);void 0===t&&(t=3);var r=this._fileUpload.size,s=Math.min(this._currentChunkSize+e,r);this._uploadId||(this._uploadId=a.e.generate());var o=Date.now();return this._sendFileData({url:this._generateChunkPostUrl(e,s),qosName:"SingleFileUploader.SendFileRequest",data:this._fileUpload.slice(e,s),offset:e,length:s-e}).then(function(e){n.uploadedBytes=s;if(s<r){n._chunkNumber++;Date.now()-o<6e4&&(n._currentChunkSize=Math.min(Math.floor(n._currentChunkSize*Math.pow(2,1/4)),62914560));return n._uploadFragment(s)}return n._processUploadCompleteResponse(e)},function(r){if(i.n.isCanceled(r))return i.n.reject(r);if(-2===n._getErrorCode(r)){if(n._currentChunkSize>262144){n._currentChunkSize=Math.max(Math.floor(n._currentChunkSize/2),262144);var s=void 0;0===n._chunkNumber&&(s=n._cancelChunkUpload());return i.n.resolve(s).then(function(){return n._uploadFragment(e)})}}else if(t>0&&n._canRetry(r)){var o,a=new u.e(function(){o&&n._async.clearTimeout(o)});o=n._async.setTimeout(function(){return a.complete()},1e3);return a.getPromise().then(function(){return n._uploadFragment(e,t-1)})}return i.n.reject(n._createUploadError(r))})};t.prototype._sendSingleRequestUpload=function(){var e=this;return this._isConflictFile().then(function(t){if(t){var n=new d.e({message:"",errorType:p.e.conflict});return i.n.reject(n)}return e._fileUpload.slice(0,e._fileUpload.size)}).then(function(t){return e._sendFileData({url:e._getUploadFileUrl(),qosName:"SingleFileUploader.UploadFile",data:t,offset:0,length:t.size}).then(function(t){return e._processUploadCompleteResponse(t)}).then(function(e){return e},function(t){if(i.n.isCanceled(t))return i.n.reject(t);if(-2===e._getErrorCode(t)){e.nameConflictBehavior=1;return e._uploadFragment()}return i.n.reject(e._createUploadError(t))})})};t.prototype._sendStreamingUpload=function(e,t){var n=this;void 0===e&&(e=0);void 0===t&&(t=3);this._uploadId||(this._uploadId=a.e.generate());var r=this._fileUpload.size,s=this._streamingChunkNumber>0?Math.min(this._currentStreamingChunkSize+e,r):0;return this._isConflictFile().then(function(t){if(t){var r=new d.e({message:"",errorType:p.e.conflict});return i.n.reject(r)}return n._fileUpload.slice(e,s)}).then(function(o){return n._sendFileData({url:n._generateChunkPostUrl(e,s),qosName:"SingleFileUploader.SendFileRequest",data:o,offset:e,length:o.size}).then(function(e){n.uploadedBytes=s;if(s<r){n._streamingChunkNumber++;return n._sendStreamingUpload(s,t)}return n._processUploadCompleteResponse(e)},function(r){if(i.n.isCanceled(r))return i.n.reject(r);if(-2===n._getErrorCode(r)){if(n._currentStreamingChunkSize<=1048576)return i.n.reject(n._createUploadError(r));n._currentStreamingChunkSize=n._currentStreamingChunkSize/2;return n._sendStreamingUpload(e,t)}return n._getUploadStatus().then(function(e){return n._sendStreamingUpload(e,b?t-1:3)},function(e){if(t>0&&n._canRetry(r)){var s,o=new u.e(function(){s&&n._async.clearTimeout(s)});s=n._async.setTimeout(function(){return o.complete()},1e3);return o.getPromise().then(function(){return n._sendStreamingUpload(0,t-1)})}return i.n.reject(n._createUploadError(r))})})})};t.prototype._canRetry=function(e){var t;switch(this._getErrorCode(e)){case-2130575257:case-2130575142:t=!1;break;default:t=!0}return t};t.prototype._cancelChunkUpload=function(){var e=this._uploadId;this._uploadId=void 0;this._chunkNumber=0;if(e){var t=this._fileUpload,n=this._serverRelativeItemUrl,r=this._webApiUrl;r=(r=E(r,{serverRelativeItemUrl:n+"/"+t.name,isFolder:!1})).methodWithAliases("CancelUpload",{uploadId:{guid:e}});return this._dataRequestor.getData({noRedirect:!0,url:r.toString(),authToken:this._authToken,qosName:"SingleFileUploader.CancelUploadSession"}).then(function(){})}return i.n.resolve()};t.prototype._sendFileData=function(e){var t,n,r,i=this,s=e.url,o=e.qosName,a=e.data,f=e.offset,l=e.length,c=new u.e(function(){t.cancel()}),h=function(e){var t=i._chunkNumber>0&&f+l>=i._fileUpload.size?3e5:1e4,r=Math.max(.08*e,t);n&&i._async.clearTimeout(n);e&&(n=i._async.setTimeout(function(){c.error({code:"-1",message:""})},r))},p=Date.now(),d=Date.now(),v=0,m=0,g=0,y=this._async.debounce(function(e){if(e>i.uploadedBytes){i.uploadedBytes=e;i._onProgress&&i._onProgress(e)}},100,{leading:!1});t=this._dataRequestor.getData({url:s,noRedirect:!0,authToken:this._authToken,qosName:o,parseResponse:function(e){return e},contentType:"application/octet-stream",additionalPostData:a,onUploadProgress:function(e){if(e.lengthComputable){var t=Date.now();m+=(e.loaded-v)/(t-d);g++;r=e.loaded/(t-p);d=t;v=e.loaded;y(f+e.loaded);h(l-e.loaded)}}});h(l);var b=this._async.setInterval(function(){if(g){Date.now()-p+(l-v)/((m+r)/(g+1))>i._maxUploadRequestDuration&&v<l&&c.error({code:"-2",message:""})}},1e4);t.done(function(e){c.complete(e)},function(e){c.error(e)});c.getPromise().done(function(){n&&i._async.clearTimeout(n);b&&i._async.clearInterval(b)},function(){t.cancel();n&&i._async.clearTimeout(n);b&&i._async.clearInterval(b)});return c.getPromise()};return t})(g);function E(e,t){var n=t.serverRelativeItemUrl,r=t.isFolder;return e=e.methodWithAliases(r?"GetFolderByServerRelativePath":"GetFileByServerRelativePath",{DecodedUrl:n})}},3606:function(e,t,n){"use strict";var r=n(1933);n.d(t,"e",function(){return r})},3607:function(e,t,n){"use strict";n.d(t,"e",function(){return g});var r=n(0),i=n(289),s=n(62),o=n(3848),u=n(72),a=n(471),f=n(1008),l=n(70),c=n(1231),h=n(997),p=n(29),d=n(164),v=n(1221),m={ODB:60222,ODC:null,Fallback:!1},g=(function(e){Object(r.__extends)(t,e);function t(n,r){var i=e.call(this,{dataSourceName:"SuiteNavDataSource"},r)||this;i._suiteNavContext=n.suiteNavContext;i._suiteNavDataUpdater=n.suiteNavDataUpdater;i._suiteNavDataSourceBasic=n.suiteNavDataSourceBasic?n.suiteNavDataSourceBasic:new c.e(n,r);i._prefetchCache=r.prefetchCache;if(i._useDeadTabDetection()){i._signInTimeAtPageLoad=t._getSignInTime();i._signInTimeAtPageLoad&&window.addEventListener("focus",function(){if("undefined"!=typeof MastInteraction&&MastInteraction.ShowPrompt){var e=t._getSignInTime();if(e&&e>i._signInTimeAtPageLoad){MastInteraction.SignOutPage();MastInteraction.ShowPrompt("SwitchAccount")}}})}return i}t.prototype.getCapabilities=function(){return this._suiteNavDataSourceBasic.getCapabilities()};t.prototype.getReactShellBootstrapperUrl=function(){return this._suiteNavDataSourceBasic.getReactShellBootstrapperUrl()};t.prototype.getInitialRenderNavBarData=function(){return this._suiteNavDataSourceBasic.getInitialRenderNavBarData()};t.prototype.getCacheToken=function(){return this._suiteNavDataSourceBasic.getCacheToken()};t.prototype.getUserIdentifier=function(){return this._suiteNavDataSourceBasic.getUserIdentifier()};t.prototype.getWebTemplateType=function(){var e;return Number((null===(e=this._pageContext)||void 0===e?void 0:e.webTemplate)||d.t.invalid)};t.prototype.setFeedbackMetadata=function(e,t){var r=this,i=this._suiteNavContext.feedbackOptions;if(i&&i.appId){e=e||{contentLanguage:void 0,source:"OneShell",options:{telemetryGroup:{}}};var s=a.n.isFeatureEnabled({ODB:f.r?-1246:1246,ODC:null,Fallback:!1});!l.t.isActivated("88d7a955-6ccc-4b35-b8ff-342a6bb08f3b","9/27/2021","Add Lists Freemium feature area")&&this._pageContext.isSiteListsHost&&(s=!0);var o=e.options;o.appId=i.appId;o.disableIncludeScreenshot=!s;o.userVoiceEnabled=i.userVoiceEnabled;o.userVoiceLink=i.userVoiceLink;if(!l.t.isActivated("A12253B9-7F27-4C11-BFC9-3E7688B5CE1E","9/14/20","Ensure appData in feedback options")){o.applicationGroup||(o.applicationGroup={});o.applicationGroup.appData||(o.applicationGroup.appData="{}")}var u=o.telemetryGroup;u.audienceGroup=this._getAudienceGroup();u.featureArea=this._getFeatureArea();u.processSessionId=this._pageContext.CorrelationId;s&&t&&n.ee(["458"],3904,7).then(function(e){var n=e.default||e;if(!l.t.isActivated("88d7a955-6ccc-4b35-b8ff-342a6bb08f3b","9/27/2021","Add Lists Freemium feature area")&&r._pageContext.isSiteListsHost){var i=document.body;try{window.frames.length>0&&(i=window.frames[0].document.body)}catch(e){}n(i).then(function(e){t(e.toDataURL("image/jpeg"))})}else n(document.body).then(function(e){t(e.toDataURL("image/jpeg"))})})}return e};t.prototype.loadData=function(e){var t=this;if(!e&&this._dataPromise)return this._dataPromise;var n,r=u.e.escapeUrlForCallback(this._pageContext.currentUICultureName),s=Object(i.n)(this._pageContext),o=s?u.e.escapeUrlForCallback(s):"",a=Object(v.e)({baseUrl:o,cultureName:r}),f=o+"/_api/Microsoft.SharePoint.Portal.SuiteNavData.GetSuiteNavData?v=2&Locale="+r,l=function(e){var n={suiteNavData:e.NavBarData,suiteNavContext:t._suiteNavContext,pageContext:t._pageContext},r=t._suiteNavDataUpdater?t._suiteNavDataUpdater.updateSuiteNavData(n):e.NavBarData,i=!(!r.HasTenantBranding||!e.TenantPrimaryColorShades&&!r.TenantLogoUrl);r.AppBrandTheme=Object(c.n)(t._suiteNavContext);return{data:r,jsUrl:e.JsUrl,cssUrl:e.CssUrl,hasCobranding:i,userIdentifier:t.getUserIdentifier(),cacheToken:t.getCacheToken()}},h=function(e){return t.getData(function(){return e},function(e){return JSON.parse(e)},"LoadData",null,"POST",null,null,1).then(function(t){var n=e===a?t:JSON.parse(t.d.GetSuiteNavData);return l(n)})},p=function(){return h(a).catch(function(){return h(f)})};if(this._pageContext.isSPO){var d=!1;if(this._prefetchCache){var m=this._prefetchCache.getData({url:a,body:"",qosName:"SpoSuiteLinks"});if(m){n=m.then(l,p);d=!0}}d||(n=p())}else n=h(f);this._dataPromise=n;n.catch(function(){t._dataPromise=null});return n};t.prototype.getSuiteNavContext=function(){return this._suiteNavContext};t.prototype.onCssLoad=function(e){if(e.data&&e.data.ClientData)try{var t=JSON.parse(e.data.ClientData);t&&t.IsFallbackShell&&Object(o.e)()}catch(e){}};t.prototype.updateDataForCurrentPage=function(e){var t={suiteNavData:e,suiteNavContext:this._suiteNavContext,pageContext:this._pageContext};return this._suiteNavDataUpdater.updateSuiteNavData(t)};t.prototype._getAudienceGroup=function(){var e,t=this._pageContext;"prodbubble"===t.env&&"MSIT_SPDF_1_Content"===t.farmLabel?e="Dogfood":"prodbubble"===t.env?e="Microsoft":("prod"===t.env||"dprod"===t.env||!l.t.isActivated("88d7a955-6ccc-4b35-b8ff-342a6bb08f3b","9/27/2021","Add Lists Freemium feature area")&&t.isSiteListsHost)&&(e="Production");return e};t.prototype._getFeatureArea=function(){var e=this._pageContext;return!l.t.isActivated("88d7a955-6ccc-4b35-b8ff-342a6bb08f3b","9/27/2021","Add Lists Freemium feature area")&&e.isSiteListsHost?"Lists Freemium":e.listBaseTemplate===p.t.genericList?"List":e.listBaseTemplate===p.t.documentLibrary?"Libraries":e.listBaseTemplate===p.t.webPageLibrary?"Modern Pages and News Authoring (Floodgate)":"Site"};t.prototype._useDeadTabDetection=function(){return!l.t.isActivated("8FE233B6-3394-4918-A449-B5808E8B40BD","9/8/21","Dead tab detection")&&a.n.isFeatureEnabled(m)};t._getCookieValue=function(e){var t;return(null===(t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)"))||void 0===t?void 0:t.pop())||""};t._getSignInTime=function(){var e=t._getCookieValue("SIMI");return e?Number(JSON.parse(atob(e)).st):0};t.siteSettingsPermissions=[s.e.enumeratePermissions,s.e.manageWeb,s.e.manageSubwebs,s.e.addAndCustomizePages,s.e.applyThemeAndBorder,s.e.manageAlerts,s.e.manageLists,s.e.viewUsageData];return t})(h.e)},3858:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r="f726d58b-8913-43cb-99c3-9d155105fbc6"},3861:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(2978),i=(function(){function e(e){this._dataSource=e.sharingDataSource||new r.e({getParentListId:e.getParentListId,pageContext:e.pageContext});this._itemProvider=e.itemProvider}e.prototype.getSharingInformation=function(e,t,n,r,i){return this._dataSource.getSharingInformation(e,t,n,r,i)};e.prototype.shareLink=function(e){var t=this;return this._dataSource.shareLink(e).then(function(n){t._invalidateItem(e.items[0]);return n})};e.prototype.unshareLink=function(e){var t=this;return this._dataSource.unshareLink(e).then(function(n){t._invalidateItem(e.item);return n})};e.prototype.updatePermissions2=function(e,t,n){var r=this;return this._dataSource.updatePermissions2(e,t,n).then(function(e){r._invalidateItem(t);return e})};e.prototype.updatePermissionsMultiple=function(e,t,n,r,i){var s=this;return this._dataSource.updatePermissionsMultiple(e,t,n,r,i).then(function(e){s._invalidateItem(t);return e})};e.prototype.getClientId=function(){return this._dataSource.getClientId()};e.prototype.parseRawSharingInformation=function(e){return this._dataSource.parseRawSharingInformation(e)};e.prototype.emailWithoutPermissioning=function(e,t,n,r){return this._dataSource.emailWithoutPermissioning(e,t,n,r).then(function(e){return e})};e.prototype.checkPermissions=function(e,t){return this._dataSource.checkPermissions(e,t)};e.prototype.share=function(e,t,n){return this._dataSource.share(e,t).then(function(e){return e})};e.prototype.setAddressBarLinkCapability=function(e,t){return this._dataSource.setAddressBarLinkCapability(e,t)};e.prototype._invalidateItem=function(e){this._itemProvider&&e&&e.parent&&e.parent.key&&this._itemProvider.invalidateItem(e.parent.key)};return e})()}}]);